# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md](../2022/CVE-2022-22963-G01d3nW01f_CVE-2022-22963.md)

# CVE-2022-22963

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md](../2022/CVE-2022-22963-AayushmanThapaMagar_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #2

**来源**: [CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md](../2022/CVE-2022-22963-BearClaw96_CVE-2022-22963-Poc-Bearcules.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标系统运行Spring Cloud Function，并且启用了路由功能，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是一个存在于 Spring Cloud Function 中的远程代码执行漏洞。当使用路由功能时，攻击者可以构造一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和本地资源访问。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞是有效的，并且利用的细节已经被公开。POC代码可以复现漏洞。

**投毒风险：**
POC代码主要包含一个bash脚本和一个README。bash脚本的功能是发送一个包含恶意SpEL表达式的POST请求，从而在目标服务器上执行命令。虽然该脚本可能会被用于恶意目的，但是其中并不包含明显的投毒代码。脚本中读取LHOST和LPORT的方式可能存在风险，攻击者可以借此诱导使用者输入错误的参数，但这不是脚本本身投毒，而是使用者的误操作。README 包含免责声明。
因此，投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者准备一个恶意的SpEL表达式，该表达式能够执行任意命令。
2.  攻击者通过HTTP POST请求的Header，将构造好的SpEL表达式传递给目标服务器。
3.  目标服务器的Spring Cloud Function路由功能解析并执行该SpEL表达式，从而导致远程代码执行。
4.  POC代码利用`curl`命令发送精心构造的HTTP POST请求，请求的header中包含恶意的SpEL表达式，该表达式使用`T(java.lang.Runtime).getRuntime().exec()`执行命令。命令将执行反向shell连接到攻击者的机器上。
5.  攻击者需要提前监听指定端口(`nc -lvnp $LPORT`)，等待目标服务器连接。

**项目地址:** [BearClaw96/CVE-2022-22963-Poc-Bearcules](https://github.com/BearClaw96/CVE-2022-22963-Poc-Bearcules)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #3

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #4

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---



---

## POC #4

**来源**: [CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md](../2022/CVE-2022-22963-J0ey17_CVE-2022-22963_Reverse-Shell-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标系统使用Spring Cloud Function且开启了路由功能，允许用户提供的SpEL表达式作为路由规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的 SpEL 表达式作为路由规则，从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定该漏洞利用代码是有效的。搜索引擎结果显示该漏洞是可被利用的，并且无需身份验证即可远程利用。提供的Python脚本尝试通过 `functionRouter` 端点注入恶意SpEL表达式来执行命令。

**投毒风险：**
分析漏洞利用代码，主要功能是发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 端点，并使用 `java.lang.Runtime.getRuntime().exec()` 执行命令。代码中没有发现明显的投毒代码。脚本首先会测试目标是否易受攻击，然后在得到用户确认后才会尝试获取反向Shell。创建监听线程的部分是预期行为，用于接收反向shell。base64编码是为了绕过某些字符过滤。
因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者首先需要确定目标系统是否运行着受影响版本的 Spring Cloud Function，并且使用了路由功能。
2.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求，该表达式会执行攻击者想要执行的命令。
3.  将该请求发送到 `/functionRouter` 端点。
4.  Spring Cloud Function 将会解析 SpEL 表达式，并在服务器上执行该表达式，从而导致远程代码执行。
5.  该POC提供反向shell，在目标服务器上执行反向shell的bash命令。

**项目地址:** [J0ey17/CVE-2022-22963_Reverse-Shell-Exploit](https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #5

**来源**: [CVE-2022-22963-Mustafa1986_CVE-2022-22963.md](../2022/CVE-2022-22963-Mustafa1986_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未授权的攻击者执行任意代码，完全控制受影响的服务器。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能，同时允许用户可控的SpEL表达式作为路由。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供精心设计的 SpEL 表达式来执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Spring Cloud Function 的路由功能允许开发者根据某些条件将请求路由到不同的函数。如果路由表达式的控制权落在攻击者手中，攻击者就可以注入恶意 SpEL 表达式。

2.  **利用方式：** 攻击者可以通过构造包含恶意 SpEL 表达式的 HTTP 请求，利用 `/functionRouter` endpoint 触发漏洞。该 SpEL 表达式会被 Spring Cloud Function 执行，从而导致远程代码执行。

3.  **POC 代码分析：** 提供的 Python 脚本 `spring_exploit.py` 实现了 CVE-2022-22963 的漏洞利用。该脚本接受目标 URL 作为参数，并发送一个包含恶意 SpEL 表达式的 POST 请求到 `/functionRouter` endpoint。该表达式执行系统命令。脚本首先尝试执行 `touch /tmp/pwned` 来验证漏洞是否存在，如果存在，则允许用户输入攻击者 IP 地址，并尝试获取反向 Shell。

4.  **有效性：** 根据漏洞信息和 POC 代码，该 POC 代码是有效的，可以用于利用 CVE-2022-22963 漏洞。

5. **投毒风险：** POC 代码的主要功能是利用漏洞，没有明显的恶意行为。虽然执行任意命令具有潜在风险，但这是漏洞利用的固有特性。`nc_listener()` 函数只是为了方便接收反向 shell，本身没有投毒行为。

6.  **搜索引擎结果确认：** 搜索结果表明该漏洞是关键漏洞，无需身份验证即可远程利用，允许执行任意代码。这些结果进一步确认了漏洞的严重性和 POC 代码的有效性。

综合分析，该漏洞的利用方式简单，危害巨大。POC 代码能够有效利用该漏洞。虽然POC代码本身是为了利用漏洞进行验证和攻击，但存在被滥用的风险，使用者应遵守法律法规。

**项目地址:** [Mustafa1986/CVE-2022-22963](https://github.com/Mustafa1986/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #6

**来源**: [CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md](../2022/CVE-2022-22963-SealPaPaPa_SpringCloudFunction-Research.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** Spring Cloud Function 启用了路由功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。攻击者可以利用 `spring.cloud.function.routing-expression` 请求头，注入恶意的 SpEL 表达式，从而执行任意代码。根据漏洞库信息，CVSS 3.1 评分为 9.8，属于危急漏洞。搜索结果显示，该漏洞允许未经身份验证的远程攻击，攻击者可以完全控制受影响的服务器。提供的 POC 代码通过设置 `spring.cloud.function.routing-expression` 头来执行 `touch /tmp/pwned` 命令，如果成功执行，则表明漏洞存在且可利用。

**有效性:**  POC 代码通过构造包含恶意 SpEL 表达式的请求头，发送到 `/functionRouter` 路径，利用了路由表达式解析的缺陷，达到了远程代码执行的效果，因此有效。

**投毒风险:**  提供的 POC 代码主要功能是在目标服务器上创建 `/tmp/pwned` 文件，以验证漏洞的存在。`README.md` 文件提供了漏洞的描述和参考链接，`poc.py` 文件包含了利用代码。没有发现隐藏的、超出漏洞验证范围的恶意代码，因此投毒风险较低，估计为0%。

**利用方式:**
1.  **目标确认:** 确认目标系统使用了存在漏洞的 Spring Cloud Function 版本，且启用了路由功能。
2.  **构造请求:** 构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求。
3.  **注入 SpEL:** 在 `spring.cloud.function.routing-expression` 中嵌入恶意的 SpEL 表达式，用于执行系统命令。
4.  **发送请求:** 将构造好的请求发送到 `/functionRouter` 路径。
5.  **验证执行:** 检查命令是否成功执行，例如检查是否创建了预期的文件或执行了其他操作。例如本例使用`touch /tmp/pwned` 创建文件,验证漏洞.

**项目地址:** [SealPaPaPa/SpringCloudFunction-Research](https://github.com/SealPaPaPa/SpringCloudFunction-Research)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #7

**来源**: [CVE-2022-22963-Shayz614_CVE-2022-22963.md](../2022/CVE-2022-22963-Shayz614_CVE-2022-22963.md)

## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #8

**来源**: [CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md](../2022/CVE-2022-22963-SourM1lk_CVE-2022-22963-Exploit.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 和所有旧版本

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Function，且开启了routing功能，攻击者需要能够访问到functionRouter endpoint.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当使用routing功能时，攻击者可以通过提供特制的SpEL表达式作为routing-expression，导致远程代码执行和访问本地资源。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞库信息中提到该漏洞允许远程代码执行，搜索结果也确认了这一点，并指出可以在未经身份验证的情况下通过网络利用该漏洞。漏洞利用代码提供了一个Rust实现的PoC，可以发送任意命令到目标服务器执行。

**投毒风险：**
该POC代码的投毒风险较低，约为10%。代码主要功能是利用SpEL表达式执行命令。虽然可以执行任意命令，但作者在代码中隐藏恶意Payload可能性较低。
1.  代码结构清晰，主要功能是发送包含SpEL表达式的HTTP请求。
2.  代码中存在`<shell_code>` 占位符，暗示用户需要自行替换shellcode，存在被替换成恶意shellcode的风险
3.  依赖项`reqwest`, `tokio`, `colored` 都是比较常见的库，被植入恶意代码的可能性较低。

**利用方式：**
1.  攻击者通过构造包含恶意SpEL表达式的`spring.cloud.function.routing-expression` header，发送到目标系统的`/functionRouter` endpoint。
2.  目标系统在处理routing-expression时，SpEL表达式被执行，从而导致远程代码执行。
3.  提供的POC代码允许攻击者发送任意命令到目标系统执行，可以通过修改`touch_command`、`shellcode_command`、`custom_command`变量的值，执行不同的命令或shellcode。

**项目地址:** [SourM1lk/CVE-2022-22963-Exploit](https://github.com/SourM1lk/CVE-2022-22963-Exploit)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #9

**来源**: [CVE-2022-22963-charis3306_CVE-2022-22963.md](../2022/CVE-2022-22963-charis3306_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function SpEL RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用Spring Cloud Function，并且开启了routing功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个 SpEL 表达式注入导致的远程代码执行漏洞。当应用使用了 routing 功能时，攻击者可以通过构造恶意的 SpEL 表达式作为 routing-expression，发送到服务器端，服务器在处理该 SpEL 表达式时会执行其中的代码，从而导致 RCE。\n\n**有效性：**\n根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞的POC代码有效。搜索结果中许多文章都提到了该漏洞的远程代码执行能力，并且漏洞利用代码提供了一个可以执行命令和反弹shell的工具。\n\n**投毒风险：**\n漏洞利用代码（Spring-cloud-function-spel.py）主要功能是发送包含恶意SpEL表达式的HTTP请求。代码逻辑相对简单，主要集中在构建payload和发送请求上。\n*   **风险点分析：**
    * 反弹shell和执行命令的功能本身就具有潜在的风险，如果被恶意利用，可以直接控制目标服务器。
    *  该仓库中是否存在作者隐藏的投毒代码的可能性较低。代码比较简单，主要是构建恶意SPEL 表达式，然后发送请求，所以分析给出较低的投毒百分比。\n\n**利用方式：**\n1.  **确定目标应用使用了Spring Cloud Function，并且启用了routing功能。**
2.  **使用POC工具（Spring-cloud-function-spel.py 或 编译好的exe）。**
3.  **通过 `--check` 参数选择GET或POST请求方式检测漏洞是否存在。工具通过判断返回状态码是否为500来判断漏洞是否存在。
4.  **如果漏洞存在，可以使用 `--cmd` 参数执行任意命令，或者使用 `--ip` 和 `--port` 参数反弹shell。**
5.  **POC工具会构造一个包含恶意SpEL表达式的HTTP请求，并将该请求发送到目标应用的`/functionRouter`（默认路由，可以通过`--route`参数修改）路径。**
6.  **目标应用在处理该请求时，会解析并执行SpEL表达式，从而导致RCE。**

**项目地址:** [charis3306/CVE-2022-22963](https://github.com/charis3306/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #10

**来源**: [CVE-2022-22963-darryk10_CVE-2022-22963.md](../2022/CVE-2022-22963-darryk10_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，无需身份验证即可远程执行代码，完全控制服务器

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 目标应用程序使用了 Spring Cloud Function 并且开启了路由功能，对外暴露了 `/functionRouter` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，导致远程代码执行。根据漏洞描述和提供的POC代码，攻击者通过向 `/functionRouter` 端点发送POST请求，并在 `spring.cloud.function.routing-expression` 头中注入恶意的SpEL表达式来实现远程代码执行。

**有效性分析：**
提供的Dockerfile文件构建了一个包含漏洞版本的Spring Cloud Function应用。README.md中给出的curl命令可以直接利用该漏洞，验证了其有效性。该命令通过设置`spring.cloud.function.routing-expression`头来注入SpEL表达式，执行`touch /tmp/test`命令，成功后会在目标服务器上创建/tmp/test文件。

**投毒风险分析：**
虽然POC本身旨在展示漏洞利用，但仔细分析Dockerfile和利用代码，投毒的风险较低。Dockerfile主要用于构建易受攻击的应用程序，其中没有发现任何恶意代码。攻击代码仅通过SpEL表达式注入命令，并且该命令是标准shell命令。存在的少量风险可能来自以下几个方面：
1.  镜像作者可能在基础镜像（`FROM ubuntu`）中植入恶意代码（风险极低）。
2.  Maven构建过程中，某些依赖项可能包含恶意代码(通过mvn package自动下载的依赖，该场景风险较低).
3. 配置文件中存在恶意后门webshell（未提供配置文件，此处风险为0）。
因此,综合考虑，投毒风险评估为 **5%**。

**利用方式：**
1.  攻击者向目标应用程序的 `/functionRouter` 端点发送POST请求。
2.  在请求头中设置 `spring.cloud.function.routing-expression`，并注入包含恶意代码的SpEL表达式。
3.  服务器解析SpEL表达式，执行攻击者注入的恶意代码，实现远程代码执行。
4.  攻击者可以执行任意系统命令，例如创建文件、反弹shell等，从而完全控制服务器。

**项目地址:** [darryk10/CVE-2022-22963](https://github.com/darryk10/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #11

**来源**: [CVE-2022-22963-gunzf0x_CVE-2022-22963.md](../2022/CVE-2022-22963-gunzf0x_CVE-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 表达式注入 RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2, 以及所有旧的和不受支持的版本

**利用条件:** 目标系统使用了 Spring Cloud Function，且开启了路由功能。 攻击者需要能够发送带有恶意 SpEL 表达式的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中一个严重的安全漏洞，允许未经授权的攻击者通过构造恶意的 SpEL 表达式执行任意代码。漏洞存在于路由功能中，攻击者可以利用此功能将恶意 SpEL 表达式作为路由表达式的一部分发送到服务器。 鉴于漏洞的严重性和易利用性，该漏洞被评为高危。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2022-22963 漏洞是一个经过确认的远程代码执行漏洞。多个安全厂商和机构都发布了相关的安全公告和分析报告。 提供的漏洞利用代码（POC）旨在利用该漏洞在受影响的 Spring Cloud Function 实例上执行任意代码，可以判定该POC有效。

**利用方式：**

该漏洞的利用方式是向 Spring Cloud Function 应用发送一个特制的 HTTP 请求，其中包含一个恶意的 SpEL 表达式作为路由表达式。当 Spring Cloud Function 处理该请求时，会执行该 SpEL 表达式，从而允许攻击者在服务器上执行任意代码。PoC代码通过指定目标URL、端口、攻击者IP和监听端口，利用目标服务器反弹shell到攻击者机器，达到远程代码执行的目的。

**投毒风险分析：**

查看提供的PoC代码，该代码主要包含以下几个部分：
1.  **参数解析：** 使用 `go-flags` 库解析命令行参数，包括目标 URL、端口、攻击者 IP 和监听端口。
2.  **IP 地址验证：** `isValidIP` 函数验证攻击者提供的 IP 地址是否有效。
3.  **构建 Payload：**  根据提供的参数，构建包含恶意 SpEL 表达式的 HTTP 请求体。
4.  **发送请求：** 使用 `net/http` 库发送 HTTP 请求到目标服务器。
5.  **错误处理：** `check_error` 函数用于处理程序执行过程中可能出现的错误。

代码本身相对简单，主要功能是构造和发送包含 SpEL 表达式的 HTTP 请求。没有发现明显的恶意代码或后门。

**潜在的投毒风险分析：**
*   **依赖项风险：**  `go.mod` 文件中列出了 `github.com/jessevdk/go-flags` 作为依赖项。 虽然该库本身很常用，但始终存在供应链攻击的风险。 但是，鉴于该库的广泛使用，这种风险较低。
*   **隐蔽的 Payload：**  虽然代码中没有明显的后门，但攻击者可能会在生成的 SpEL 表达式中插入难以察觉的恶意代码。 然而，分析代码表明，SpEL 表达式的生成是基于用户提供的参数，因此这种风险也相对较低。
*   **其他风险：** 由于代码会主动发起网络请求，存在被中间人攻击或嗅探的风险。

**总结：**

PoC代码的主要风险来自于对目标系统的攻击利用，而非代码本身包含恶意后门。 但是，用户需要意识到供应链攻击和隐蔽 Payload 的潜在风险。

根据以上分析，判断此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。这个百分比主要是基于依赖库被投毒的可能性，以及SpEL表达式中可以嵌入混淆代码的风险，整体代码逻辑比较清晰。


**项目地址:** [gunzf0x/CVE-2022-22963](https://github.com/gunzf0x/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #12

**来源**: [CVE-2022-22963-hktalent_spring-spel-0day-poc.md](../2022/CVE-2022-22963-hktalent_spring-spel-0day-poc.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 应用程序使用了Spring Cloud Function的路由功能，并且允许用户控制`routing-expression`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963 存在于 Spring Cloud Function 中，当使用路由功能时，攻击者可以通过提供特制的 SpEL 表达式作为 `routing-expression` 来执行任意代码并访问本地资源。 

**有效性：**

提供的 POC 代码有效。它演示了如何通过设置 `spring.cloud.function.routing-expression` header来执行任意命令。例如，`T(java.lang.Runtime).getRuntime().exec("open -a /System/Applications/Calculator.app")`  会在目标系统上打开计算器应用程序。另一个POC通过DNS请求验证命令执行.

**投毒风险：**

该仓库主要包含漏洞利用代码和演示。虽然代码的功能是执行任意命令，但就该仓库本身而言，直接的、明显的投毒代码的风险较低，接近1%。需要防范的是通过该POC进入后，攻击者植入的后门。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的 Spring Cloud Function 应用程序的服务器。
2.  **构造恶意请求：** 创建一个 HTTP POST 请求，其中包含 `spring.cloud.function.routing-expression` header，并将值设置为包含恶意 SpEL 表达式的字符串。
3.  **发送请求：** 将请求发送到应用程序的路由端点 (如 `/functionRouter`)。
4.  **执行代码：** 服务器将解析 SpEL 表达式并执行其中包含的命令。

通过搜索引擎结果,得知此漏洞为未授权远程代码执行漏洞，CVSS评分为9.8分，危害巨大。利用过程简单，构造恶意header即可。

**项目地址:** [hktalent/spring-spel-0day-poc](https://github.com/hktalent/spring-spel-0day-poc)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #13

**来源**: [CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md](../2022/CVE-2022-22963-iliass-dahman_CVE-2022-22963-POC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 使用了Spring Cloud Function的路由功能，且允许用户提供路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 框架中的一个远程代码执行漏洞。当应用程序使用路由功能，并且允许用户提供 SpEL 表达式作为路由条件时，攻击者可以构造恶意的 SpEL 表达式，从而在服务器上执行任意代码。从提供的漏洞利用代码可以看出，该漏洞利用的有效性较高，因为该代码提供了一个docker环境，模拟了攻击者与服务器。其中exploit.py 脚本构造包含反弹shell命令的payload，然后通过设置 `spring.cloud.function.routing-expression` 请求头将其注入到 `/functionRouter` 路径。服务器收到请求后，会将 SpEL 表达式解析执行，从而实现远程代码执行。该仓库中存在作者隐藏的投毒代码的可能性较低，因为Dockerfile文件中使用的镜像源都是官方源。exploit.py的逻辑较为简单，没有发现恶意代码，主要是构造payload和发送请求。 run.sh 脚本只是辅助执行docker命令，也没有发现恶意代码。因此可以判断投毒风险较低。

**利用方式：**

1.  **确定目标：** 找到运行着受影响版本 Spring Cloud Function 的应用程序。
2.  **构造恶意 SpEL 表达式：** 构造一个包含恶意代码的 SpEL 表达式，例如执行系统命令的反弹shell命令。
3.  **发送请求：**  通过构造包含 `spring.cloud.function.routing-expression` 请求头的 HTTP POST 请求，将恶意 SpEL 表达式发送到 `/functionRouter` 路径。
4.  **执行代码：**  服务器解析并执行恶意 SpEL 表达式，从而在服务器上执行任意代码。
5.  **反弹 Shell:** 攻击者使用 netcat 监听端口，等待目标服务器反弹 shell。

搜索引擎结果和漏洞库信息也确认了该漏洞的存在和危害，并且公开可用exp的存在也佐证了该漏洞的可利用性。

**项目地址:** [iliass-dahman/CVE-2022-22963-POC](https://github.com/iliass-dahman/CVE-2022-22963-POC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #14

**来源**: [CVE-2022-22963-jrbH4CK_CVE-2022-22963.md](../2022/CVE-2022-22963-jrbH4CK_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和访问本地资源

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 以及所有旧的和不受支持的版本

**利用条件:** 需要目标应用使用Spring Cloud Function的路由功能，且对外开放网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中存在的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供一个特制的 SpEL 表达式作为路由表达式，导致远程代码执行和访问本地资源。\n\n**有效性：** 提供的POC代码看起来是有效的。它通过发送包含恶意SpEL表达式的POST请求到 `/functionRouter` 路径来利用此漏洞。这个SpEL表达式用于执行命令，首先下载一个反弹shell脚本，然后赋予执行权限，最后执行该脚本。搜索结果也表明此漏洞可以被远程利用且无需身份验证。\n\n**投毒风险：**  代码中存在轻微的投毒风险。`springCloud.sh` 脚本从攻击者的服务器下载 `rs.sh` 文件，这意味着攻击者可以随时更改 `rs.sh` 的内容，从而在不知情的情况下执行恶意代码。虽然提供的PoC本身只是反弹shell，但攻击者可以轻易地替换为更具破坏性的命令。例如，脚本可以被修改为删除文件或安装后门。但由于脚本功能相对简单且目标明确，主要风险在于下载的 `rs.sh` 文件内容可变，因此投毒风险估计为 10%。\n\n**利用方式：** 漏洞利用方式如下：\n1.  攻击者构造一个包含恶意 SpEL 表达式的 HTTP POST 请求。\n2.  该请求被发送到启用了 Spring Cloud Function 路由功能的应用程序的 `/functionRouter` 路径。\n3.  SpEL 表达式被解析和执行，从而允许攻击者执行任意命令。\n4.  POC代码中，攻击者使用SpEL表达式下载、赋予执行权限并执行一个反弹shell脚本，从而获得对目标系统的shell访问权限。

**项目地址:** [jrbH4CK/CVE-2022-22963](https://github.com/jrbH4CK/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #15

**来源**: [CVE-2022-22963-k3rwin_spring-cloud-function-rce.md](../2022/CVE-2022-22963-k3rwin_spring-cloud-function-rce.md)

## CVE-2022-22963-Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 3.0.0.RELEASE <= Spring Cloud Function <= 3.2.2

**利用条件:** 应用程序使用了Spring Cloud Function，并且启用了路由功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用路由功能时，攻击者可以通过提供特制的SpEL表达式作为路由表达式，从而执行任意代码并访问本地资源。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果表明该漏洞存在已知公开的利用程序，漏洞利用代码也提供了利用该漏洞的脚本。

**投毒风险：**
该POC代码存在一定的投毒风险，风险约为10%。主要风险点在于:

*   漏洞利用脚本可能被修改以包含恶意代码，例如下载和执行其他恶意程序。目前的shellcode执行都是明文,如果植入其他的shellcode不易被发现
*   反弹shell时，vps的地址存在不确定性

**利用方式：**
漏洞的利用方式如下：

1.  攻击者构造一个包含恶意SpEL表达式的HTTP请求头，该请求头中的`spring.cloud.function.routing-expression`参数包含SpEL表达式。
2.  攻击者将构造的HTTP请求发送到受影响的Spring Cloud Function应用程序的`/functionRouter`端点。
3.  Spring Cloud Function框架在处理请求时，会将`spring.cloud.function.routing-expression`参数作为SpEL表达式进行解析和执行。
4.  如果SpEL表达式包含恶意代码，则会在服务器上执行，从而导致远程代码执行。

利用代码提供了以下功能：

*   DNSLog测试：通过发送包含DNS查询的SpEL表达式，可以验证目标是否存在漏洞。
*   反弹Shell：通过发送包含反弹shell命令的SpEL表达式，可以在目标服务器上执行任意命令，并获得shell访问权限。
*   支持Linux和Windows目标。

**优先级排序：**

1.  **搜索引擎结果：** 提供漏洞的总体风险评估和利用概况，有助于了解漏洞的严重性和影响。
2.  **漏洞利用代码：** 提供了实际可用的攻击Payload，以及详细的利用步骤和参数。
3.  **漏洞库信息：** 提供漏洞的官方描述和受影响的版本范围。

**项目地址:** [k3rwin/spring-cloud-function-rce](https://github.com/k3rwin/spring-cloud-function-rce)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #16

**来源**: [CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md](../2022/CVE-2022-22963-lemmyz4n3771_CVE-2022-22963-PoC.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.1.6 (for 3.1.x) and <= 3.2.2 (for 3.2.x)

**利用条件:** 需要目标系统运行存在漏洞版本的Spring Cloud Function，并且开启了routing功能。需要网络访问目标/functionRouter接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963 漏洞存在于 Spring Cloud Function 中，当使用了 routing 功能时，攻击者可以通过构造特殊的 SpEL 表达式作为路由表达式，导致远程代码执行。根据提供的漏洞信息、搜索结果和漏洞利用代码，进行以下分析：

**1. 有效性：**

提供的 PoC 代码 `exploit.py` 针对 CVE-2022-22963 漏洞，利用了 Spring Cloud Function 的路由表达式注入漏洞。代码通过设置 `spring.cloud.function.routing-expression` 头，将包含恶意 SpEL 表达式的 payload 发送到 `/functionRouter` 接口，从而执行任意命令。代码结构清晰，逻辑简单，经验证是有效的。

**2. 投毒风险：**

浏览了 `LICENSE`、`README.md` 和 `exploit.py` 三个文件。`LICENSE` 采用 MIT 许可，较为宽松。`README.md` 提供了漏洞描述和使用示例。`exploit.py` 实现了漏洞利用的功能。  虽然没有明显的恶意代码，但考虑到以下几点，仍然存在极低的投毒风险：

*   **隐蔽性投毒：** 攻击者可能在 SpEL 表达式中进行二次编码或混淆，使其难以检测。例如，将恶意命令拆分成多个字符串，然后使用 SpEL 表达式拼接。
*   **依赖项投毒：** 虽然PoC本身没有引入其他的依赖，但存在后期被投毒的风险。

因此，综合评估，投毒风险较低，估计为 5%。

**3. 利用方式：**

利用方式如下：

1.  **确定目标：** 确定目标系统是否运行存在漏洞版本的 Spring Cloud Function，并且开启了 routing 功能。
2.  **构造 Payload：** 构造包含恶意 SpEL 表达式的 payload。payload 的关键在于 `spring.cloud.function.routing-expression` 头，该头的值会被 Spring Cloud Function 作为 SpEL 表达式执行。
3.  **发送请求：** 发送 POST 请求到 `/functionRouter` 接口，并将 payload 放在请求头中。
4.  **执行命令：** 如果目标系统存在漏洞，SpEL 表达式会被执行，从而导致远程代码执行。
5.  **验证：** 命令执行后，可以通过多种方式验证漏洞是否成功利用，例如，查看目标系统上是否生成了指定的文件，或者通过 LFI 漏洞读取命令执行的结果。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

这个优先级排序是因为搜索引擎结果提供了更广泛的漏洞信息和分析，包括漏洞描述、影响范围、修复方案等。漏洞利用代码提供了实际的漏洞利用方法，可以帮助研究人员验证漏洞。漏洞库信息提供了漏洞的官方描述和 CVE 编号，可以作为参考。

**项目地址:** [lemmyz4n3771/CVE-2022-22963-PoC](https://github.com/lemmyz4n3771/CVE-2022-22963-PoC)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #17

**来源**: [CVE-2022-22963-me2nuk_CVE-2022-22963.md](../2022/CVE-2022-22963-me2nuk_CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户输入路由表达式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞是由于当使用路由功能时，攻击者可以提供特制的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**漏洞利用分析：**

1.  **漏洞原理：** Spring Cloud Function 允许开发者使用 SpEL（Spring Expression Language）定义函数路由。当路由表达式由用户输入控制时，攻击者可以通过构造恶意的 SpEL 表达式来执行任意代码。
2.  **POC 有效性：** 提供的 POC 代码有效。Dockerfile 部署了一个存在漏洞的 Spring Cloud Function 应用，README.md 提供了利用该漏洞的步骤。POC 使用 `curl` 命令，通过设置 `spring.cloud.function.routing-expression` 头为恶意的 SpEL 表达式，来触发远程代码执行。示例中，`T(java.lang.Runtime).getRuntime().exec("touch /tmp/pwned")` 会在服务器上创建一个名为 `/tmp/pwned` 的文件，验证了 RCE。
3.  **投毒风险：** 检查了 Dockerfile 和 README.md，没有发现明显的投毒代码。Dockerfile 主要用于构建存在漏洞的环境，README.md 主要用于演示如何利用漏洞。尽管POC可以执行任意命令，但那是在利用漏洞，并非代码本身包含恶意后门。
4.  **利用方式总结：**
    *   攻击者向 Spring Cloud Function 应用发送 POST 请求。
    *   在请求头中设置 `spring.cloud.function.routing-expression`，值为恶意的 SpEL 表达式。
    *   服务器解析并执行该 SpEL 表达式，导致远程代码执行。

**漏洞修复建议：**

*   升级到 Spring Cloud Function 的安全版本。
*   禁用或限制路由功能。
*   对用户输入的路由表达式进行严格的过滤和验证。

**项目地址:** [me2nuk/CVE-2022-22963](https://github.com/me2nuk/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #18

**来源**: [CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md](../2022/CVE-2022-22963-nikn0laty_RCE-in-Spring-Cloud-CVE-2022-22963.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #19

**来源**: [CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md](../2022/CVE-2022-22963-randallbanner_Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE.md)

## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <=3.1.6 (for 3.1.x) and <=3.2.2 (for 3.2.x)

**利用条件:** Spring Cloud Function 启用了路由功能，且攻击者可以发送恶意SpEL表达式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当启用了路由功能时，攻击者可以通过构造恶意的SpEL（Spring Expression Language）表达式，通过`spring.cloud.function.routing-expression`请求头注入，从而在服务器上执行任意代码。漏洞利用代码显示，该PoC通过以下步骤利用漏洞：

1.  在本地创建一个包含反向shell命令的shell脚本（shell.sh）。
2.  启动一个简单的HTTP服务器，用于向目标服务器提供shell脚本。
3.  利用漏洞，通过SpEL表达式在目标服务器上执行wget命令，将shell脚本下载到/dev/shm/目录。
4.  利用漏洞，通过SpEL表达式执行chmod命令，为shell脚本赋予执行权限。
5.  利用漏洞，通过SpEL表达式执行shell脚本，从而建立反向shell连接。
6.  停止HTTP服务器。

**有效性：** 提供的PoC代码是有效的，能够实现远程代码执行，搜索结果也表明该漏洞的严重性以及存在可利用性。

**投毒风险：** 该仓库的投毒风险极低，接近于0%。主要原因是：

*   代码逻辑清晰： PoC代码的逻辑很明确，功能是利用漏洞执行反向shell，没有隐藏的恶意代码。
*   反向 Shell：虽然反向shell本身具有一定的攻击性，但它的目的明确，是为漏洞验证提供的。
*    小概率投毒风险：作者可能使用非标准的Bash语法或者在shell.sh脚本中添加不易察觉的命令来收集受害者信息，概率估计为1%。

**利用方式：**

1.  **确定目标：** 确认目标系统运行着受影响版本的Spring Cloud Function，且启用了路由功能。
2.  **构造恶意请求：** 构造包含恶意SpEL表达式的HTTP请求，通常通过`spring.cloud.function.routing-expression`请求头。
3.  **执行命令：** SpEL表达式会被解析并执行，从而在目标服务器上执行攻击者指定的命令，实现远程代码执行。

**项目地址:** [randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE](https://github.com/randallbanner/Spring-Cloud-Function-Vulnerability-CVE-2022-22963-RCE)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #20

**来源**: [CVE-2022-22963-twseptian_cve-2022-22963.md](../2022/CVE-2022-22963-twseptian_cve-2022-22963.md)

## CVE-2022-22963 - Spring Cloud Function SpEL 远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧的和不受支持的版本

**利用条件:** 使用 Spring Cloud Function 路由功能，且允许用户提供 SpEL 表达式作为路由表达式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963 是 Spring Cloud Function 中的一个远程代码执行漏洞。该漏洞源于当使用路由功能时，用户可以提供精心构造的 SpEL 表达式作为路由表达式，从而导致远程代码执行和访问本地资源。

**有效性：**

提供的 PoC 代码有效。根据漏洞库信息和搜索引擎结果，此漏洞允许未经身份验证的远程代码执行。PoC 代码展示了如何通过 `spring.cloud.function.routing-expression` 头注入 SpEL 表达式，从而执行任意命令，例如 `ping` 命令。 tcpdump 结果证实了命令已成功执行。

**投毒风险：**

分析提供的 Dockerfile 和 README.md 文件，虽然 PoC 本身没有直接的恶意代码（即利用漏洞执行命令的部分是合法的漏洞利用），但仍然存在一定的投毒风险。Dockerfile 指向 `openjdk:17-alpine`，该镜像本身较为安全。`COPY ./jar/*.jar /app/spring-cloud-function-routing.jar`命令从本地复制 jar 包,这个jar包可能是被篡改过的恶意jar包,如果原作者上传了恶意jar包,则会存在投毒风险。因此投毒风险评估为10%。

**利用方式：**

1.  攻击者利用 `spring.cloud.function.routing-expression` HTTP Header 注入恶意的 SpEL 表达式。
2.  Spring Cloud Function 的路由逻辑会解析并执行该 SpEL 表达式。
3.  攻击者可以使用 SpEL 表达式执行任意代码，例如通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令。
4.  该漏洞可以通过网络远程利用，无需任何身份验证，风险极高。

**参考资料：**

*   CVE 漏洞库信息表明该漏洞的严重性评分为 9.8 (Critical)，易于利用，且已被 CISA 列入已知被利用漏洞目录。
*   搜索引擎结果也确认了该漏洞的存在和潜在危害，并提供了缓解措施的建议。

**项目地址:** [twseptian/cve-2022-22963](https://github.com/twseptian/cve-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

## POC #21

**来源**: [CVE-2022-22963-xmqaq_CVE-2022-22963.md](../2022/CVE-2022-22963-xmqaq_CVE-2022-22963.md)

## CVE-2022-22963 Spring Cloud Function SpEL表达式注入

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and all old and unsupported versions

**利用条件:** 需要目标应用使用了Spring Cloud Function的路由功能，并且对外暴露了`/functionRouter`端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22963是Spring Cloud Function框架中的一个远程代码执行漏洞。当使用了路由功能时，攻击者可以通过构造恶意的SpEL表达式，通过`spring.cloud.function.routing-expression` header进行注入，从而在目标服务器上执行任意代码。

**漏洞利用方式：**

1.  **检测：** 通过发送带有恶意SpEL表达式的POST请求到`/functionRouter`端点，如果服务器返回500错误并且包含`Internal Server Error`，则可能存在漏洞。
2.  **命令执行：** 利用`T(java.lang.Runtime).getRuntime().exec("command")` SpEL表达式执行任意命令。
3.  **DNSLog验证：** 使用`ping`命令和DNSLog服务验证漏洞。
4.  **反弹Shell：** 构造反弹shell命令，并进行Base64编码，然后通过SpEL表达式执行。

**关于投毒风险的分析：**

提供的Python脚本中，反弹shell的功能需要将shell命令进行Base64编码, 有可能存在将特定IP地址或者恶意代码植入到Base64编码中的风险, 但是整体代码逻辑是为了验证漏洞的存在. 投毒风险较低，初步评估为10%。

**项目地址:** [xmqaq/CVE-2022-22963](https://github.com/xmqaq/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)

---

