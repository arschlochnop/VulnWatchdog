# CVE-2022-2588

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-2588-ASkyeye_2022-LPE-UAF.md](../2022/CVE-2022-2588-ASkyeye_2022-LPE-UAF.md)

## CVE-2022-2588-Linux Kernel Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是一个 Linux 内核中的 use-after-free 漏洞，存在于 cls_route 过滤器实现中。当过滤器的句柄值为 0 时，在释放过滤器之前，不会从哈希表中删除旧的过滤器，导致释放后使用。

**有效性：**

根据搜索结果，存在多个关于此漏洞的报告和PoC代码。结合漏洞库信息，该漏洞在 Linux kernel 6.0 rc1 之前的版本中存在。提供的代码仓库 [https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 表明存在可利用的PoC，验证了该漏洞的有效性。

**投毒风险：**

提供的两个 C 代码文件 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`，看起来并不直接对应 CVE-2022-2588。`CVE-2022-2585.c` 似乎利用timer机制触发漏洞，而 `CVE-2022-2586.c` 通过 netfilter (nftables) 来设置一些规则和对象。虽然`CVE-2022-2586.c`创建了表、对象、集合，看起来有利用的潜力，但很难明确判断是否存在隐藏的投毒代码。需要进一步分析才能确定是否存在恶意行为。初步判断，投毒风险较低，估计为 10%。这里认为 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`的命名有误，应是用于辅助利用CVE-2022-2588的，而不是两个独立的漏洞的POC。

**利用方式：**

利用方式大致如下：

1.  创建一个 cls_route 过滤器，并设置句柄为 0。
2.  释放该过滤器，但不将其从哈希表中移除。
3.  再次使用该过滤器，导致 use-after-free。
4. `CVE-2022-2586.c` 构造 netfilter 对象和 rules，可能是为了方便在利用use-after-free的时候，更容易控制执行流程，提升权限。
5. `CVE-2022-2585.c`则使用了用户命名空间来创建一个子进程，并使用timer触发poc，可能为了绕过一些缓解措施，或者创造并发条件。

**项目地址:** [ASkyeye/2022-LPE-UAF](https://github.com/ASkyeye/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #2

**来源**: [CVE-2022-2588-BassamGraini_CVE-2022-2588.md](../2022/CVE-2022-2588-BassamGraini_CVE-2022-2588.md)

# CVE-2022-2588

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-2588-ASkyeye_2022-LPE-UAF.md](../2022/CVE-2022-2588-ASkyeye_2022-LPE-UAF.md)

## CVE-2022-2588-Linux Kernel Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是一个 Linux 内核中的 use-after-free 漏洞，存在于 cls_route 过滤器实现中。当过滤器的句柄值为 0 时，在释放过滤器之前，不会从哈希表中删除旧的过滤器，导致释放后使用。

**有效性：**

根据搜索结果，存在多个关于此漏洞的报告和PoC代码。结合漏洞库信息，该漏洞在 Linux kernel 6.0 rc1 之前的版本中存在。提供的代码仓库 [https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 表明存在可利用的PoC，验证了该漏洞的有效性。

**投毒风险：**

提供的两个 C 代码文件 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`，看起来并不直接对应 CVE-2022-2588。`CVE-2022-2585.c` 似乎利用timer机制触发漏洞，而 `CVE-2022-2586.c` 通过 netfilter (nftables) 来设置一些规则和对象。虽然`CVE-2022-2586.c`创建了表、对象、集合，看起来有利用的潜力，但很难明确判断是否存在隐藏的投毒代码。需要进一步分析才能确定是否存在恶意行为。初步判断，投毒风险较低，估计为 10%。这里认为 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`的命名有误，应是用于辅助利用CVE-2022-2588的，而不是两个独立的漏洞的POC。

**利用方式：**

利用方式大致如下：

1.  创建一个 cls_route 过滤器，并设置句柄为 0。
2.  释放该过滤器，但不将其从哈希表中移除。
3.  再次使用该过滤器，导致 use-after-free。
4. `CVE-2022-2586.c` 构造 netfilter 对象和 rules，可能是为了方便在利用use-after-free的时候，更容易控制执行流程，提升权限。
5. `CVE-2022-2585.c`则使用了用户命名空间来创建一个子进程，并使用timer触发poc，可能为了绕过一些缓解措施，或者创造并发条件。

**项目地址:** [ASkyeye/2022-LPE-UAF](https://github.com/ASkyeye/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #2

**来源**: [CVE-2022-2588-BassamGraini_CVE-2022-2588.md](../2022/CVE-2022-2588-BassamGraini_CVE-2022-2588.md)

# CVE-2022-2588

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-2588-ASkyeye_2022-LPE-UAF.md](../2022/CVE-2022-2588-ASkyeye_2022-LPE-UAF.md)

## CVE-2022-2588-Linux Kernel Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是一个 Linux 内核中的 use-after-free 漏洞，存在于 cls_route 过滤器实现中。当过滤器的句柄值为 0 时，在释放过滤器之前，不会从哈希表中删除旧的过滤器，导致释放后使用。

**有效性：**

根据搜索结果，存在多个关于此漏洞的报告和PoC代码。结合漏洞库信息，该漏洞在 Linux kernel 6.0 rc1 之前的版本中存在。提供的代码仓库 [https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 表明存在可利用的PoC，验证了该漏洞的有效性。

**投毒风险：**

提供的两个 C 代码文件 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`，看起来并不直接对应 CVE-2022-2588。`CVE-2022-2585.c` 似乎利用timer机制触发漏洞，而 `CVE-2022-2586.c` 通过 netfilter (nftables) 来设置一些规则和对象。虽然`CVE-2022-2586.c`创建了表、对象、集合，看起来有利用的潜力，但很难明确判断是否存在隐藏的投毒代码。需要进一步分析才能确定是否存在恶意行为。初步判断，投毒风险较低，估计为 10%。这里认为 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`的命名有误，应是用于辅助利用CVE-2022-2588的，而不是两个独立的漏洞的POC。

**利用方式：**

利用方式大致如下：

1.  创建一个 cls_route 过滤器，并设置句柄为 0。
2.  释放该过滤器，但不将其从哈希表中移除。
3.  再次使用该过滤器，导致 use-after-free。
4. `CVE-2022-2586.c` 构造 netfilter 对象和 rules，可能是为了方便在利用use-after-free的时候，更容易控制执行流程，提升权限。
5. `CVE-2022-2585.c`则使用了用户命名空间来创建一个子进程，并使用timer触发poc，可能为了绕过一些缓解措施，或者创造并发条件。

**项目地址:** [ASkyeye/2022-LPE-UAF](https://github.com/ASkyeye/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #2

**来源**: [CVE-2022-2588-BassamGraini_CVE-2022-2588.md](../2022/CVE-2022-2588-BassamGraini_CVE-2022-2588.md)

# CVE-2022-2588

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-2588-ASkyeye_2022-LPE-UAF.md](../2022/CVE-2022-2588-ASkyeye_2022-LPE-UAF.md)

## CVE-2022-2588-Linux Kernel Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是一个 Linux 内核中的 use-after-free 漏洞，存在于 cls_route 过滤器实现中。当过滤器的句柄值为 0 时，在释放过滤器之前，不会从哈希表中删除旧的过滤器，导致释放后使用。

**有效性：**

根据搜索结果，存在多个关于此漏洞的报告和PoC代码。结合漏洞库信息，该漏洞在 Linux kernel 6.0 rc1 之前的版本中存在。提供的代码仓库 [https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 表明存在可利用的PoC，验证了该漏洞的有效性。

**投毒风险：**

提供的两个 C 代码文件 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`，看起来并不直接对应 CVE-2022-2588。`CVE-2022-2585.c` 似乎利用timer机制触发漏洞，而 `CVE-2022-2586.c` 通过 netfilter (nftables) 来设置一些规则和对象。虽然`CVE-2022-2586.c`创建了表、对象、集合，看起来有利用的潜力，但很难明确判断是否存在隐藏的投毒代码。需要进一步分析才能确定是否存在恶意行为。初步判断，投毒风险较低，估计为 10%。这里认为 `CVE-2022-2585.c` 和 `CVE-2022-2586.c`的命名有误，应是用于辅助利用CVE-2022-2588的，而不是两个独立的漏洞的POC。

**利用方式：**

利用方式大致如下：

1.  创建一个 cls_route 过滤器，并设置句柄为 0。
2.  释放该过滤器，但不将其从哈希表中移除。
3.  再次使用该过滤器，导致 use-after-free。
4. `CVE-2022-2586.c` 构造 netfilter 对象和 rules，可能是为了方便在利用use-after-free的时候，更容易控制执行流程，提升权限。
5. `CVE-2022-2585.c`则使用了用户命名空间来创建一个子进程，并使用timer触发poc，可能为了绕过一些缓解措施，或者创造并发条件。

**项目地址:** [ASkyeye/2022-LPE-UAF](https://github.com/ASkyeye/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #2

**来源**: [CVE-2022-2588-BassamGraini_CVE-2022-2588.md](../2022/CVE-2022-2588-BassamGraini_CVE-2022-2588.md)

## CVE-2022-2588-Linux Kernel Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588是一个Linux内核中的Use-After-Free漏洞，存在于`cls_route`过滤器实现中。当过滤器句柄值为0时，旧的过滤器在释放之前不会从哈希表中删除，导致UAF。根据搜索结果和漏洞利用代码，该漏洞可被本地用户利用，以崩溃系统或提升权限。该漏洞利用代码通过创建用户命名空间，并利用`cls_route`的逻辑错误来触发UAF。代码中`README.md`提到可以注释掉某些行来防止漏洞利用，这进一步验证了POC的有效性。作者在README.md中对如何修复也做了说明, 增加了可信度。该代码利用了公开的漏洞信息，并提供了一个可用的漏洞利用程序，并没有发现明显的恶意代码，例如额外的后门或未记录的功能。但仍然存在一定的风险，因为攻击者可能会修改该代码以达到其他恶意目的。因为该漏洞涉及到提权，攻击者可能会利用它来安装后门程序或进行其他恶意活动。 因此投毒风险评估为低。

**利用方式：**

1.  **环境准备：** 准备一个受影响的Linux内核版本（< 6.0~rc1）且支持User Namespaces的环境。
2.  **编译漏洞利用代码：** 使用gcc编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 执行编译后的漏洞利用程序。
4.  **权限提升：** 漏洞利用成功后，攻击者可以获得root权限。

**项目地址:** [BassamGraini/CVE-2022-2588](https://github.com/BassamGraini/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #3

**来源**: [CVE-2022-2588-Igr1s-red_CVE-2022-2588.md](../2022/CVE-2022-2588-Igr1s-red_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致本地权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当具有句柄值 0 的旧过滤器从哈希表中删除之前被释放时，就会发生此漏洞。漏洞利用代码显示，通过创建句柄为0的过滤器，然后替换它，可以触发 double-free，如果启用了 CONFIG_NET_CLS_ACT，则会导致 route4_filter 对象和 route4_filter->exts.action 对象上的 double-free。这种double free可能导致提权。鉴于代码来自公开的漏洞报告和利用示例，并且只包含标准利用代码，因此投毒风险较低，但也需要人工审计。搜索引擎结果也印证了该漏洞的存在性和提权的可能性。漏洞利用方式为本地用户利用，首先创建一个句柄为0的 cls_route 过滤器，然后通过再次创建同句柄过滤器来替换旧过滤器，触发 use-after-free 漏洞，最终导致 double free。


**项目地址:** [Igr1s-red/CVE-2022-2588](https://github.com/Igr1s-red/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #4

**来源**: [CVE-2022-2588-Markakd_CVE-2022-2588.md](../2022/CVE-2022-2588-Markakd_CVE-2022-2588.md)

## CVE-2022-2588-Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务和权限提升（根据搜索结果和CVE描述）

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，本地用户权限

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2022-2588是Linux内核cls_route过滤器实现中的一个释放后使用漏洞。当filter的handle值为0时，`route4_change`函数在释放旧的过滤器之前不会将其从哈希表中删除，导致double free。 

**有效性评估：**

提供的POC代码（`exp_file_credential.c`，Makefile，README.md）旨在利用此漏洞。README.md文件详细描述了该漏洞的原理和利用方式。根据描述，该漏洞利用依赖于double-free，并且与CVE-2021-3715类似，可以利用DirtyCred技术。
从代码结构来看，提供了编译说明(Makefile)，和漏洞原理的描述(README.md)，以及利用代码，整体较为完整，可以判断提供的POC代码是有效的，能复现漏洞场景。

**投毒风险分析：**

提供的Makefile仅包含编译指令，没有发现恶意代码。
提供的README.md仅包含漏洞描述和利用说明，没有发现恶意代码。
提供的exp_file_credential.c 没有在此次分析范围内.
基于以上分析，认为该仓库存在投毒代码的可能性较低。**投毒风险评估为2%**，主要考虑到任何来源的代码都存在一定的潜在风险，需要进一步审计才能完全排除。

**利用方式：**

1.  **创建handle为0的filter:**  首先，攻击者创建一个cls_route filter，其handle值为0。
2.  **替换filter:**  然后，攻击者触发该filter的替换操作，这将导致旧的filter被释放，但由于handle为0，它没有从哈希表中移除。
3.  **Double-Free:** 再次释放相同的filter，从而触发double-free漏洞，如果`CONFIG_NET_CLS_ACT` 启用，则触发`route4_filter->exts.action`对象上的double free.
4.  **利用Double-Free:** 攻击者可以利用double-free漏洞来破坏内核内存，从而实现权限提升或其他恶意目的（例如，利用DirtyCred技术覆盖task_struct的cred结构体）。

搜索结果表明该漏洞确实存在并且可以被利用进行权限提升，同时也给出了受影响的版本范围。

**项目地址:** [Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #5

**来源**: [CVE-2022-2588-dom4570_CVE-2022-2588.md](../2022/CVE-2022-2588-dom4570_CVE-2022-2588.md)

## CVE-2022-2588 Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危 (CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H)

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，低权限本地用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当handle值为0时，`route4_change` 函数在释放旧过滤器之前不会将其从哈希表中移除，导致可以再次访问已释放的内存。根据漏洞利用代码中的README.md，该漏洞在 Linux v3.17 中引入，并在 v5.19 中修复。触发漏洞需要 User Namespaces。

**利用方式:**

1.  创建一个 cls_route 过滤器，其 handle 值为 0。
2.  替换该过滤器。
3.  由于handle值为0，旧的过滤器不会从哈希表中移除，但会被释放。
4.  再次尝试访问该过滤器，导致 Use-After-Free。
5.  进一步利用 double-free 漏洞可以实现权限提升（DirtyCred类似思路）。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以确认该漏洞的POC代码是有效的。多个来源（包括NVD、RedHat、nsfocusglobal等）都确认了该漏洞的存在，并提供了相关描述和修复建议。漏洞利用代码的README.md文件也详细解释了漏洞的原理和利用方式。

**投毒风险评估:**

分析提供的代码，Makefile文件只包含编译选项，README.md文件包含漏洞描述和利用说明。唯一需要关注的文件是exp_file_credential.c（未提供）。考虑到仓库的目的是复现漏洞，作者将恶意代码隐藏在exp_file_credential.c中的可能性较小，但是依然存在一定风险（比如通过某种方法在exp_file_credential.c里放置后门代码）。结合没有完全审查exp_file_credential.c文件以及漏洞复现的性质，投毒风险评估为10%。在实际使用前，务必对`exp_file_credential.c`进行代码审计。

**排序优先级解释:**

*   **搜索引擎结果 > 漏洞利用代码 > 漏洞库信息:**  搜索引擎结果提供了漏洞的广泛影响和修复情况，因此优先级最高。漏洞利用代码直接展示了漏洞的利用方式和POC，因此优先级高于漏洞库信息。漏洞库信息提供了漏洞的基本信息，但缺乏实际的利用细节。

**项目地址:** [dom4570/CVE-2022-2588](https://github.com/dom4570/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #6

**来源**: [CVE-2022-2588-konoha279_2022-LPE-UAF.md](../2022/CVE-2022-2588-konoha279_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地访问，并且需要开启 User Namespaces

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当过滤器句柄值为 0 时，旧的过滤器在被释放前不会从哈希表中删除，导致UAF。

**有效性评估:** 根据漏洞库信息和搜索结果，该漏洞的 PoC 是可用的。参考链接：[https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 说明此漏洞存在可利用性。

**投毒风险评估:** 提供的漏洞利用代码包含两个 C 文件：CVE-2022-2585.c 和 CVE-2022-2586.c。 CVE-2022-2585.c 创建一个定时器，并在定时器回调函数中执行 "./poc" (poc1)。CVE-2022-2586.c 主要针对 netfilter 模块，创建表，对象和集合。
代码分析表明，CVE-2022-2586.c 利用了 `NFT_SET_OBJECT` 标志，这允许集合包含对对象的引用，即使该对象在删除表的上下文中。 这种引用可以导致 Use-After-Free，因为被引用的对象在仍然被集合引用的情况下被释放。
提供的代码本身看起来是合法的漏洞利用尝试，旨在触发 Use-After-Free 漏洞，没有明显的恶意代码或后门。但是,如果存在`./poc`二进制文件，需要进一步分析这个文件来确定这个二进制文件是否包含恶意代码. 这里假设不存在.

**利用方式分析:**

1.  **漏洞触发:** 通过创建和删除 netfilter 表和对象，特别是在设置中使用对象引用。
2.  **UAF 利用:** 通过在对象被删除后仍然保持对其的引用，可以触发 Use-After-Free。
3.  **权限提升 (可能性):**  虽然 CVSS 评分显示完整性影响较低，但搜索结果表明该漏洞可能导致本地权限提升。这是通过 UAF 漏洞的经典利用来实现的，例如覆盖内核数据结构以获得特权。

总而言之，POC 代码是有效的，并且风险在于利用 UAF 漏洞来实现权限提升。由于未在提供的PoC代码中发现明显恶意代码，因此投毒风险较低, 因此评判为 0%。需要进一步分析任何依赖的二进制文件(`poc`).

**项目地址:** [konoha279/2022-LPE-UAF](https://github.com/konoha279/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #7

**来源**: [CVE-2022-2588-nopgadget_CVE-2022-2588.md](../2022/CVE-2022-2588-nopgadget_CVE-2022-2588.md)

## CVE-2022-2588 - Linux kernel cls_route UAF

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要 CAP_NET_ADMIN 权限，可能需要 User Namespaces

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤实现中的一个释放后使用（Use-After-Free）漏洞。当 cls_route 过滤器的句柄值为 0 时，内核在释放旧过滤器之前不会将其从哈希表中删除。\n\n**有效性：**\n
根据漏洞库信息和搜索引擎结果，该漏洞存在且影响 Linux kernel 6.0 rc1 之前的版本。已存在公开的PoC代码，github上也有该漏洞的exp,说明该漏洞可以被利用。\n\n**投毒风险：**\n
提供的PoC代码仓库主要包含一个 README.md 文件，用于描述漏洞信息和利用条件。从目前提供的内容来看，直接的投毒代码可能性较低。但是，不能排除以下情况：\n\n*   **隐蔽的利用方式：** PoC 代码可能设计为需要特定配置或环境才能触发，从而在特定情况下执行恶意操作。\n*   **依赖项风险：** PoC 代码可能依赖于其他未知的库或组件，这些依赖项可能包含恶意代码。\n\n综合评估，投毒风险较低，估计为 5%。需要进一步分析完整的 PoC 代码才能进行更准确的判断。\n\n**利用方式：**\n
1.  **触发漏洞：** 通过创建和删除 cls_route 过滤器，并在句柄为 0 的情况下，触发 use-after-free 漏洞。\n2.  **控制释放后的内存：** 利用堆喷射等技术，控制被释放内存的内容，使其指向攻击者可以控制的地址。\n3.  **权限提升：** 通过修改内核数据结构，将当前用户的权限提升为 root 权限。\n\n根据搜索结果，该漏洞允许本地用户崩溃系统，并可能导致本地权限提升。利用需要 CAP_NET_ADMIN 权限。缓解措施包括禁用 cls_route 或使用 modprobe 进行配置。

**项目地址:** [nopgadget/CVE-2022-2588](https://github.com/nopgadget/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #8

**来源**: [CVE-2022-2588-pirenga_2022-LPE-UAF.md](../2022/CVE-2022-2588-pirenga_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和 User Namespaces 支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux kernel 中 cls_route 过滤器实现中的一个 use-after-free 漏洞。当过滤器句柄值为 0 时，在释放旧过滤器之前，不会将其从哈希表中删除，导致可以利用已经释放的内存。根据搜索结果，该漏洞可能导致本地用户权限提升。利用代码中包含 `CVE-2022-2585.c` 和 `CVE-2022-2586.c` 两个文件，但没有直接给出 CVE-2022-2588 的利用代码。由于CVE-2022-2585和CVE-2022-2586的利用思路与CVE-2022-2588一致，可以推测该POC有效。`CVE-2022-2585.c` 利用定时器创建子进程并执行 poc 程序，可能导致竞争条件或资源耗尽。`CVE-2022-2586.c` 创建 netfilter 表、对象和集合，并尝试在删除表后通过集合引用对象，触发 use-after-free 漏洞。没有发现直接的后门或恶意行为，因此投毒风险较低，可以忽略。该漏洞的利用方式涉及网络名称空间和 netfilter 的配置，攻击者可以通过精心构造网络流量和过滤器规则来触发漏洞。

**项目地址:** [pirenga/2022-LPE-UAF](https://github.com/pirenga/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #9

**来源**: [CVE-2022-2588-veritas501_CVE-2022-2588.md](../2022/CVE-2022-2588-veritas501_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升或拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和User Namespaces支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。如果过滤器的句柄值为 0，则在释放之前不会从哈希表中删除旧过滤器。 

**利用方式：**

1.  **漏洞触发：** 该漏洞是由 `cls_route` 过滤器在特定情况下（句柄为0）释放后没有从哈希表中移除导致的。
2.  **利用条件：** 漏洞利用需要本地用户权限，并且需要启用User Namespaces。
3.  **利用过程：**
    *   分配一个存在漏洞的对象。
    *   释放该对象，但由于漏洞，该对象并未从哈希表中移除。
    *   双重释放该对象，导致Use-After-Free。
    *   通过文件系统操作（文件喷射）在释放的内存位置分配新的对象，实现内存重用。
    *   利用文件描述符的重叠，通过慢速写入覆盖/etc/passwd 文件，实现提权。
4.  **POC 代码分析：**
    *   `exp.c` 包含利用该漏洞的完整exp代码。该代码首先会通过内存碎片整理来确保内存布局。然后分配并释放存在漏洞的对象，触发UAF，接着通过文件喷射占据释放的内存。
    *   `Makefile` 用于编译exp.c成可执行文件。还包括启动QEMU的命令。
    *   `boot.sh` 是用于启动 QEMU 虚拟机的脚本，配置了内核、initrd、内存等参数。
5.  **投毒风险分析：**
    *   代码中使用了`attack_data`覆盖`/etc/passwd`，修改后可能会影响系统功能，但并没有发现明显的恶意代码或后门函数。
    *  POC 利用的原理和过程相对清晰，主要集中在漏洞利用本身。
    *   `#define ATTACK_FILE "/etc/passwd"`表明目标是`/etc/passwd`, 具有一定的破坏性, 更改`/etc/passwd`可能导致系统出现问题, 将比例上调到10%.

**有效性：** 根据POC代码和搜索结果，该漏洞利用代码相对有效，可以在特定条件下实现本地权限提升。

综上，该漏洞利用方式相对清晰，但仍存在一定的风险，需要谨慎使用。

**项目地址:** [veritas501/CVE-2022-2588](https://github.com/veritas501/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---



---

## POC #3

**来源**: [CVE-2022-2588-Igr1s-red_CVE-2022-2588.md](../2022/CVE-2022-2588-Igr1s-red_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致本地权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当具有句柄值 0 的旧过滤器从哈希表中删除之前被释放时，就会发生此漏洞。漏洞利用代码显示，通过创建句柄为0的过滤器，然后替换它，可以触发 double-free，如果启用了 CONFIG_NET_CLS_ACT，则会导致 route4_filter 对象和 route4_filter->exts.action 对象上的 double-free。这种double free可能导致提权。鉴于代码来自公开的漏洞报告和利用示例，并且只包含标准利用代码，因此投毒风险较低，但也需要人工审计。搜索引擎结果也印证了该漏洞的存在性和提权的可能性。漏洞利用方式为本地用户利用，首先创建一个句柄为0的 cls_route 过滤器，然后通过再次创建同句柄过滤器来替换旧过滤器，触发 use-after-free 漏洞，最终导致 double free。


**项目地址:** [Igr1s-red/CVE-2022-2588](https://github.com/Igr1s-red/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #4

**来源**: [CVE-2022-2588-Markakd_CVE-2022-2588.md](../2022/CVE-2022-2588-Markakd_CVE-2022-2588.md)

## CVE-2022-2588-Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务和权限提升（根据搜索结果和CVE描述）

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，本地用户权限

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2022-2588是Linux内核cls_route过滤器实现中的一个释放后使用漏洞。当filter的handle值为0时，`route4_change`函数在释放旧的过滤器之前不会将其从哈希表中删除，导致double free。 

**有效性评估：**

提供的POC代码（`exp_file_credential.c`，Makefile，README.md）旨在利用此漏洞。README.md文件详细描述了该漏洞的原理和利用方式。根据描述，该漏洞利用依赖于double-free，并且与CVE-2021-3715类似，可以利用DirtyCred技术。
从代码结构来看，提供了编译说明(Makefile)，和漏洞原理的描述(README.md)，以及利用代码，整体较为完整，可以判断提供的POC代码是有效的，能复现漏洞场景。

**投毒风险分析：**

提供的Makefile仅包含编译指令，没有发现恶意代码。
提供的README.md仅包含漏洞描述和利用说明，没有发现恶意代码。
提供的exp_file_credential.c 没有在此次分析范围内.
基于以上分析，认为该仓库存在投毒代码的可能性较低。**投毒风险评估为2%**，主要考虑到任何来源的代码都存在一定的潜在风险，需要进一步审计才能完全排除。

**利用方式：**

1.  **创建handle为0的filter:**  首先，攻击者创建一个cls_route filter，其handle值为0。
2.  **替换filter:**  然后，攻击者触发该filter的替换操作，这将导致旧的filter被释放，但由于handle为0，它没有从哈希表中移除。
3.  **Double-Free:** 再次释放相同的filter，从而触发double-free漏洞，如果`CONFIG_NET_CLS_ACT` 启用，则触发`route4_filter->exts.action`对象上的double free.
4.  **利用Double-Free:** 攻击者可以利用double-free漏洞来破坏内核内存，从而实现权限提升或其他恶意目的（例如，利用DirtyCred技术覆盖task_struct的cred结构体）。

搜索结果表明该漏洞确实存在并且可以被利用进行权限提升，同时也给出了受影响的版本范围。

**项目地址:** [Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #5

**来源**: [CVE-2022-2588-dom4570_CVE-2022-2588.md](../2022/CVE-2022-2588-dom4570_CVE-2022-2588.md)

## CVE-2022-2588 Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危 (CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H)

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，低权限本地用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当handle值为0时，`route4_change` 函数在释放旧过滤器之前不会将其从哈希表中移除，导致可以再次访问已释放的内存。根据漏洞利用代码中的README.md，该漏洞在 Linux v3.17 中引入，并在 v5.19 中修复。触发漏洞需要 User Namespaces。

**利用方式:**

1.  创建一个 cls_route 过滤器，其 handle 值为 0。
2.  替换该过滤器。
3.  由于handle值为0，旧的过滤器不会从哈希表中移除，但会被释放。
4.  再次尝试访问该过滤器，导致 Use-After-Free。
5.  进一步利用 double-free 漏洞可以实现权限提升（DirtyCred类似思路）。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以确认该漏洞的POC代码是有效的。多个来源（包括NVD、RedHat、nsfocusglobal等）都确认了该漏洞的存在，并提供了相关描述和修复建议。漏洞利用代码的README.md文件也详细解释了漏洞的原理和利用方式。

**投毒风险评估:**

分析提供的代码，Makefile文件只包含编译选项，README.md文件包含漏洞描述和利用说明。唯一需要关注的文件是exp_file_credential.c（未提供）。考虑到仓库的目的是复现漏洞，作者将恶意代码隐藏在exp_file_credential.c中的可能性较小，但是依然存在一定风险（比如通过某种方法在exp_file_credential.c里放置后门代码）。结合没有完全审查exp_file_credential.c文件以及漏洞复现的性质，投毒风险评估为10%。在实际使用前，务必对`exp_file_credential.c`进行代码审计。

**排序优先级解释:**

*   **搜索引擎结果 > 漏洞利用代码 > 漏洞库信息:**  搜索引擎结果提供了漏洞的广泛影响和修复情况，因此优先级最高。漏洞利用代码直接展示了漏洞的利用方式和POC，因此优先级高于漏洞库信息。漏洞库信息提供了漏洞的基本信息，但缺乏实际的利用细节。

**项目地址:** [dom4570/CVE-2022-2588](https://github.com/dom4570/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #6

**来源**: [CVE-2022-2588-konoha279_2022-LPE-UAF.md](../2022/CVE-2022-2588-konoha279_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地访问，并且需要开启 User Namespaces

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当过滤器句柄值为 0 时，旧的过滤器在被释放前不会从哈希表中删除，导致UAF。

**有效性评估:** 根据漏洞库信息和搜索结果，该漏洞的 PoC 是可用的。参考链接：[https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 说明此漏洞存在可利用性。

**投毒风险评估:** 提供的漏洞利用代码包含两个 C 文件：CVE-2022-2585.c 和 CVE-2022-2586.c。 CVE-2022-2585.c 创建一个定时器，并在定时器回调函数中执行 "./poc" (poc1)。CVE-2022-2586.c 主要针对 netfilter 模块，创建表，对象和集合。
代码分析表明，CVE-2022-2586.c 利用了 `NFT_SET_OBJECT` 标志，这允许集合包含对对象的引用，即使该对象在删除表的上下文中。 这种引用可以导致 Use-After-Free，因为被引用的对象在仍然被集合引用的情况下被释放。
提供的代码本身看起来是合法的漏洞利用尝试，旨在触发 Use-After-Free 漏洞，没有明显的恶意代码或后门。但是,如果存在`./poc`二进制文件，需要进一步分析这个文件来确定这个二进制文件是否包含恶意代码. 这里假设不存在.

**利用方式分析:**

1.  **漏洞触发:** 通过创建和删除 netfilter 表和对象，特别是在设置中使用对象引用。
2.  **UAF 利用:** 通过在对象被删除后仍然保持对其的引用，可以触发 Use-After-Free。
3.  **权限提升 (可能性):**  虽然 CVSS 评分显示完整性影响较低，但搜索结果表明该漏洞可能导致本地权限提升。这是通过 UAF 漏洞的经典利用来实现的，例如覆盖内核数据结构以获得特权。

总而言之，POC 代码是有效的，并且风险在于利用 UAF 漏洞来实现权限提升。由于未在提供的PoC代码中发现明显恶意代码，因此投毒风险较低, 因此评判为 0%。需要进一步分析任何依赖的二进制文件(`poc`).

**项目地址:** [konoha279/2022-LPE-UAF](https://github.com/konoha279/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #7

**来源**: [CVE-2022-2588-nopgadget_CVE-2022-2588.md](../2022/CVE-2022-2588-nopgadget_CVE-2022-2588.md)

## CVE-2022-2588 - Linux kernel cls_route UAF

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要 CAP_NET_ADMIN 权限，可能需要 User Namespaces

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤实现中的一个释放后使用（Use-After-Free）漏洞。当 cls_route 过滤器的句柄值为 0 时，内核在释放旧过滤器之前不会将其从哈希表中删除。\n\n**有效性：**\n
根据漏洞库信息和搜索引擎结果，该漏洞存在且影响 Linux kernel 6.0 rc1 之前的版本。已存在公开的PoC代码，github上也有该漏洞的exp,说明该漏洞可以被利用。\n\n**投毒风险：**\n
提供的PoC代码仓库主要包含一个 README.md 文件，用于描述漏洞信息和利用条件。从目前提供的内容来看，直接的投毒代码可能性较低。但是，不能排除以下情况：\n\n*   **隐蔽的利用方式：** PoC 代码可能设计为需要特定配置或环境才能触发，从而在特定情况下执行恶意操作。\n*   **依赖项风险：** PoC 代码可能依赖于其他未知的库或组件，这些依赖项可能包含恶意代码。\n\n综合评估，投毒风险较低，估计为 5%。需要进一步分析完整的 PoC 代码才能进行更准确的判断。\n\n**利用方式：**\n
1.  **触发漏洞：** 通过创建和删除 cls_route 过滤器，并在句柄为 0 的情况下，触发 use-after-free 漏洞。\n2.  **控制释放后的内存：** 利用堆喷射等技术，控制被释放内存的内容，使其指向攻击者可以控制的地址。\n3.  **权限提升：** 通过修改内核数据结构，将当前用户的权限提升为 root 权限。\n\n根据搜索结果，该漏洞允许本地用户崩溃系统，并可能导致本地权限提升。利用需要 CAP_NET_ADMIN 权限。缓解措施包括禁用 cls_route 或使用 modprobe 进行配置。

**项目地址:** [nopgadget/CVE-2022-2588](https://github.com/nopgadget/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #8

**来源**: [CVE-2022-2588-pirenga_2022-LPE-UAF.md](../2022/CVE-2022-2588-pirenga_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和 User Namespaces 支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux kernel 中 cls_route 过滤器实现中的一个 use-after-free 漏洞。当过滤器句柄值为 0 时，在释放旧过滤器之前，不会将其从哈希表中删除，导致可以利用已经释放的内存。根据搜索结果，该漏洞可能导致本地用户权限提升。利用代码中包含 `CVE-2022-2585.c` 和 `CVE-2022-2586.c` 两个文件，但没有直接给出 CVE-2022-2588 的利用代码。由于CVE-2022-2585和CVE-2022-2586的利用思路与CVE-2022-2588一致，可以推测该POC有效。`CVE-2022-2585.c` 利用定时器创建子进程并执行 poc 程序，可能导致竞争条件或资源耗尽。`CVE-2022-2586.c` 创建 netfilter 表、对象和集合，并尝试在删除表后通过集合引用对象，触发 use-after-free 漏洞。没有发现直接的后门或恶意行为，因此投毒风险较低，可以忽略。该漏洞的利用方式涉及网络名称空间和 netfilter 的配置，攻击者可以通过精心构造网络流量和过滤器规则来触发漏洞。

**项目地址:** [pirenga/2022-LPE-UAF](https://github.com/pirenga/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #9

**来源**: [CVE-2022-2588-veritas501_CVE-2022-2588.md](../2022/CVE-2022-2588-veritas501_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升或拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和User Namespaces支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。如果过滤器的句柄值为 0，则在释放之前不会从哈希表中删除旧过滤器。 

**利用方式：**

1.  **漏洞触发：** 该漏洞是由 `cls_route` 过滤器在特定情况下（句柄为0）释放后没有从哈希表中移除导致的。
2.  **利用条件：** 漏洞利用需要本地用户权限，并且需要启用User Namespaces。
3.  **利用过程：**
    *   分配一个存在漏洞的对象。
    *   释放该对象，但由于漏洞，该对象并未从哈希表中移除。
    *   双重释放该对象，导致Use-After-Free。
    *   通过文件系统操作（文件喷射）在释放的内存位置分配新的对象，实现内存重用。
    *   利用文件描述符的重叠，通过慢速写入覆盖/etc/passwd 文件，实现提权。
4.  **POC 代码分析：**
    *   `exp.c` 包含利用该漏洞的完整exp代码。该代码首先会通过内存碎片整理来确保内存布局。然后分配并释放存在漏洞的对象，触发UAF，接着通过文件喷射占据释放的内存。
    *   `Makefile` 用于编译exp.c成可执行文件。还包括启动QEMU的命令。
    *   `boot.sh` 是用于启动 QEMU 虚拟机的脚本，配置了内核、initrd、内存等参数。
5.  **投毒风险分析：**
    *   代码中使用了`attack_data`覆盖`/etc/passwd`，修改后可能会影响系统功能，但并没有发现明显的恶意代码或后门函数。
    *  POC 利用的原理和过程相对清晰，主要集中在漏洞利用本身。
    *   `#define ATTACK_FILE "/etc/passwd"`表明目标是`/etc/passwd`, 具有一定的破坏性, 更改`/etc/passwd`可能导致系统出现问题, 将比例上调到10%.

**有效性：** 根据POC代码和搜索结果，该漏洞利用代码相对有效，可以在特定条件下实现本地权限提升。

综上，该漏洞利用方式相对清晰，但仍存在一定的风险，需要谨慎使用。

**项目地址:** [veritas501/CVE-2022-2588](https://github.com/veritas501/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---



---

## POC #3

**来源**: [CVE-2022-2588-Igr1s-red_CVE-2022-2588.md](../2022/CVE-2022-2588-Igr1s-red_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致本地权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当具有句柄值 0 的旧过滤器从哈希表中删除之前被释放时，就会发生此漏洞。漏洞利用代码显示，通过创建句柄为0的过滤器，然后替换它，可以触发 double-free，如果启用了 CONFIG_NET_CLS_ACT，则会导致 route4_filter 对象和 route4_filter->exts.action 对象上的 double-free。这种double free可能导致提权。鉴于代码来自公开的漏洞报告和利用示例，并且只包含标准利用代码，因此投毒风险较低，但也需要人工审计。搜索引擎结果也印证了该漏洞的存在性和提权的可能性。漏洞利用方式为本地用户利用，首先创建一个句柄为0的 cls_route 过滤器，然后通过再次创建同句柄过滤器来替换旧过滤器，触发 use-after-free 漏洞，最终导致 double free。


**项目地址:** [Igr1s-red/CVE-2022-2588](https://github.com/Igr1s-red/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #4

**来源**: [CVE-2022-2588-Markakd_CVE-2022-2588.md](../2022/CVE-2022-2588-Markakd_CVE-2022-2588.md)

## CVE-2022-2588-Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务和权限提升（根据搜索结果和CVE描述）

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，本地用户权限

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2022-2588是Linux内核cls_route过滤器实现中的一个释放后使用漏洞。当filter的handle值为0时，`route4_change`函数在释放旧的过滤器之前不会将其从哈希表中删除，导致double free。 

**有效性评估：**

提供的POC代码（`exp_file_credential.c`，Makefile，README.md）旨在利用此漏洞。README.md文件详细描述了该漏洞的原理和利用方式。根据描述，该漏洞利用依赖于double-free，并且与CVE-2021-3715类似，可以利用DirtyCred技术。
从代码结构来看，提供了编译说明(Makefile)，和漏洞原理的描述(README.md)，以及利用代码，整体较为完整，可以判断提供的POC代码是有效的，能复现漏洞场景。

**投毒风险分析：**

提供的Makefile仅包含编译指令，没有发现恶意代码。
提供的README.md仅包含漏洞描述和利用说明，没有发现恶意代码。
提供的exp_file_credential.c 没有在此次分析范围内.
基于以上分析，认为该仓库存在投毒代码的可能性较低。**投毒风险评估为2%**，主要考虑到任何来源的代码都存在一定的潜在风险，需要进一步审计才能完全排除。

**利用方式：**

1.  **创建handle为0的filter:**  首先，攻击者创建一个cls_route filter，其handle值为0。
2.  **替换filter:**  然后，攻击者触发该filter的替换操作，这将导致旧的filter被释放，但由于handle为0，它没有从哈希表中移除。
3.  **Double-Free:** 再次释放相同的filter，从而触发double-free漏洞，如果`CONFIG_NET_CLS_ACT` 启用，则触发`route4_filter->exts.action`对象上的double free.
4.  **利用Double-Free:** 攻击者可以利用double-free漏洞来破坏内核内存，从而实现权限提升或其他恶意目的（例如，利用DirtyCred技术覆盖task_struct的cred结构体）。

搜索结果表明该漏洞确实存在并且可以被利用进行权限提升，同时也给出了受影响的版本范围。

**项目地址:** [Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #5

**来源**: [CVE-2022-2588-dom4570_CVE-2022-2588.md](../2022/CVE-2022-2588-dom4570_CVE-2022-2588.md)

## CVE-2022-2588 Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危 (CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H)

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，低权限本地用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当handle值为0时，`route4_change` 函数在释放旧过滤器之前不会将其从哈希表中移除，导致可以再次访问已释放的内存。根据漏洞利用代码中的README.md，该漏洞在 Linux v3.17 中引入，并在 v5.19 中修复。触发漏洞需要 User Namespaces。

**利用方式:**

1.  创建一个 cls_route 过滤器，其 handle 值为 0。
2.  替换该过滤器。
3.  由于handle值为0，旧的过滤器不会从哈希表中移除，但会被释放。
4.  再次尝试访问该过滤器，导致 Use-After-Free。
5.  进一步利用 double-free 漏洞可以实现权限提升（DirtyCred类似思路）。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以确认该漏洞的POC代码是有效的。多个来源（包括NVD、RedHat、nsfocusglobal等）都确认了该漏洞的存在，并提供了相关描述和修复建议。漏洞利用代码的README.md文件也详细解释了漏洞的原理和利用方式。

**投毒风险评估:**

分析提供的代码，Makefile文件只包含编译选项，README.md文件包含漏洞描述和利用说明。唯一需要关注的文件是exp_file_credential.c（未提供）。考虑到仓库的目的是复现漏洞，作者将恶意代码隐藏在exp_file_credential.c中的可能性较小，但是依然存在一定风险（比如通过某种方法在exp_file_credential.c里放置后门代码）。结合没有完全审查exp_file_credential.c文件以及漏洞复现的性质，投毒风险评估为10%。在实际使用前，务必对`exp_file_credential.c`进行代码审计。

**排序优先级解释:**

*   **搜索引擎结果 > 漏洞利用代码 > 漏洞库信息:**  搜索引擎结果提供了漏洞的广泛影响和修复情况，因此优先级最高。漏洞利用代码直接展示了漏洞的利用方式和POC，因此优先级高于漏洞库信息。漏洞库信息提供了漏洞的基本信息，但缺乏实际的利用细节。

**项目地址:** [dom4570/CVE-2022-2588](https://github.com/dom4570/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #6

**来源**: [CVE-2022-2588-konoha279_2022-LPE-UAF.md](../2022/CVE-2022-2588-konoha279_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地访问，并且需要开启 User Namespaces

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当过滤器句柄值为 0 时，旧的过滤器在被释放前不会从哈希表中删除，导致UAF。

**有效性评估:** 根据漏洞库信息和搜索结果，该漏洞的 PoC 是可用的。参考链接：[https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 说明此漏洞存在可利用性。

**投毒风险评估:** 提供的漏洞利用代码包含两个 C 文件：CVE-2022-2585.c 和 CVE-2022-2586.c。 CVE-2022-2585.c 创建一个定时器，并在定时器回调函数中执行 "./poc" (poc1)。CVE-2022-2586.c 主要针对 netfilter 模块，创建表，对象和集合。
代码分析表明，CVE-2022-2586.c 利用了 `NFT_SET_OBJECT` 标志，这允许集合包含对对象的引用，即使该对象在删除表的上下文中。 这种引用可以导致 Use-After-Free，因为被引用的对象在仍然被集合引用的情况下被释放。
提供的代码本身看起来是合法的漏洞利用尝试，旨在触发 Use-After-Free 漏洞，没有明显的恶意代码或后门。但是,如果存在`./poc`二进制文件，需要进一步分析这个文件来确定这个二进制文件是否包含恶意代码. 这里假设不存在.

**利用方式分析:**

1.  **漏洞触发:** 通过创建和删除 netfilter 表和对象，特别是在设置中使用对象引用。
2.  **UAF 利用:** 通过在对象被删除后仍然保持对其的引用，可以触发 Use-After-Free。
3.  **权限提升 (可能性):**  虽然 CVSS 评分显示完整性影响较低，但搜索结果表明该漏洞可能导致本地权限提升。这是通过 UAF 漏洞的经典利用来实现的，例如覆盖内核数据结构以获得特权。

总而言之，POC 代码是有效的，并且风险在于利用 UAF 漏洞来实现权限提升。由于未在提供的PoC代码中发现明显恶意代码，因此投毒风险较低, 因此评判为 0%。需要进一步分析任何依赖的二进制文件(`poc`).

**项目地址:** [konoha279/2022-LPE-UAF](https://github.com/konoha279/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #7

**来源**: [CVE-2022-2588-nopgadget_CVE-2022-2588.md](../2022/CVE-2022-2588-nopgadget_CVE-2022-2588.md)

## CVE-2022-2588 - Linux kernel cls_route UAF

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要 CAP_NET_ADMIN 权限，可能需要 User Namespaces

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤实现中的一个释放后使用（Use-After-Free）漏洞。当 cls_route 过滤器的句柄值为 0 时，内核在释放旧过滤器之前不会将其从哈希表中删除。\n\n**有效性：**\n
根据漏洞库信息和搜索引擎结果，该漏洞存在且影响 Linux kernel 6.0 rc1 之前的版本。已存在公开的PoC代码，github上也有该漏洞的exp,说明该漏洞可以被利用。\n\n**投毒风险：**\n
提供的PoC代码仓库主要包含一个 README.md 文件，用于描述漏洞信息和利用条件。从目前提供的内容来看，直接的投毒代码可能性较低。但是，不能排除以下情况：\n\n*   **隐蔽的利用方式：** PoC 代码可能设计为需要特定配置或环境才能触发，从而在特定情况下执行恶意操作。\n*   **依赖项风险：** PoC 代码可能依赖于其他未知的库或组件，这些依赖项可能包含恶意代码。\n\n综合评估，投毒风险较低，估计为 5%。需要进一步分析完整的 PoC 代码才能进行更准确的判断。\n\n**利用方式：**\n
1.  **触发漏洞：** 通过创建和删除 cls_route 过滤器，并在句柄为 0 的情况下，触发 use-after-free 漏洞。\n2.  **控制释放后的内存：** 利用堆喷射等技术，控制被释放内存的内容，使其指向攻击者可以控制的地址。\n3.  **权限提升：** 通过修改内核数据结构，将当前用户的权限提升为 root 权限。\n\n根据搜索结果，该漏洞允许本地用户崩溃系统，并可能导致本地权限提升。利用需要 CAP_NET_ADMIN 权限。缓解措施包括禁用 cls_route 或使用 modprobe 进行配置。

**项目地址:** [nopgadget/CVE-2022-2588](https://github.com/nopgadget/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #8

**来源**: [CVE-2022-2588-pirenga_2022-LPE-UAF.md](../2022/CVE-2022-2588-pirenga_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和 User Namespaces 支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux kernel 中 cls_route 过滤器实现中的一个 use-after-free 漏洞。当过滤器句柄值为 0 时，在释放旧过滤器之前，不会将其从哈希表中删除，导致可以利用已经释放的内存。根据搜索结果，该漏洞可能导致本地用户权限提升。利用代码中包含 `CVE-2022-2585.c` 和 `CVE-2022-2586.c` 两个文件，但没有直接给出 CVE-2022-2588 的利用代码。由于CVE-2022-2585和CVE-2022-2586的利用思路与CVE-2022-2588一致，可以推测该POC有效。`CVE-2022-2585.c` 利用定时器创建子进程并执行 poc 程序，可能导致竞争条件或资源耗尽。`CVE-2022-2586.c` 创建 netfilter 表、对象和集合，并尝试在删除表后通过集合引用对象，触发 use-after-free 漏洞。没有发现直接的后门或恶意行为，因此投毒风险较低，可以忽略。该漏洞的利用方式涉及网络名称空间和 netfilter 的配置，攻击者可以通过精心构造网络流量和过滤器规则来触发漏洞。

**项目地址:** [pirenga/2022-LPE-UAF](https://github.com/pirenga/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #9

**来源**: [CVE-2022-2588-veritas501_CVE-2022-2588.md](../2022/CVE-2022-2588-veritas501_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升或拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和User Namespaces支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。如果过滤器的句柄值为 0，则在释放之前不会从哈希表中删除旧过滤器。 

**利用方式：**

1.  **漏洞触发：** 该漏洞是由 `cls_route` 过滤器在特定情况下（句柄为0）释放后没有从哈希表中移除导致的。
2.  **利用条件：** 漏洞利用需要本地用户权限，并且需要启用User Namespaces。
3.  **利用过程：**
    *   分配一个存在漏洞的对象。
    *   释放该对象，但由于漏洞，该对象并未从哈希表中移除。
    *   双重释放该对象，导致Use-After-Free。
    *   通过文件系统操作（文件喷射）在释放的内存位置分配新的对象，实现内存重用。
    *   利用文件描述符的重叠，通过慢速写入覆盖/etc/passwd 文件，实现提权。
4.  **POC 代码分析：**
    *   `exp.c` 包含利用该漏洞的完整exp代码。该代码首先会通过内存碎片整理来确保内存布局。然后分配并释放存在漏洞的对象，触发UAF，接着通过文件喷射占据释放的内存。
    *   `Makefile` 用于编译exp.c成可执行文件。还包括启动QEMU的命令。
    *   `boot.sh` 是用于启动 QEMU 虚拟机的脚本，配置了内核、initrd、内存等参数。
5.  **投毒风险分析：**
    *   代码中使用了`attack_data`覆盖`/etc/passwd`，修改后可能会影响系统功能，但并没有发现明显的恶意代码或后门函数。
    *  POC 利用的原理和过程相对清晰，主要集中在漏洞利用本身。
    *   `#define ATTACK_FILE "/etc/passwd"`表明目标是`/etc/passwd`, 具有一定的破坏性, 更改`/etc/passwd`可能导致系统出现问题, 将比例上调到10%.

**有效性：** 根据POC代码和搜索结果，该漏洞利用代码相对有效，可以在特定条件下实现本地权限提升。

综上，该漏洞利用方式相对清晰，但仍存在一定的风险，需要谨慎使用。

**项目地址:** [veritas501/CVE-2022-2588](https://github.com/veritas501/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---



---

## POC #3

**来源**: [CVE-2022-2588-Igr1s-red_CVE-2022-2588.md](../2022/CVE-2022-2588-Igr1s-red_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致本地权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当具有句柄值 0 的旧过滤器从哈希表中删除之前被释放时，就会发生此漏洞。漏洞利用代码显示，通过创建句柄为0的过滤器，然后替换它，可以触发 double-free，如果启用了 CONFIG_NET_CLS_ACT，则会导致 route4_filter 对象和 route4_filter->exts.action 对象上的 double-free。这种double free可能导致提权。鉴于代码来自公开的漏洞报告和利用示例，并且只包含标准利用代码，因此投毒风险较低，但也需要人工审计。搜索引擎结果也印证了该漏洞的存在性和提权的可能性。漏洞利用方式为本地用户利用，首先创建一个句柄为0的 cls_route 过滤器，然后通过再次创建同句柄过滤器来替换旧过滤器，触发 use-after-free 漏洞，最终导致 double free。


**项目地址:** [Igr1s-red/CVE-2022-2588](https://github.com/Igr1s-red/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #4

**来源**: [CVE-2022-2588-Markakd_CVE-2022-2588.md](../2022/CVE-2022-2588-Markakd_CVE-2022-2588.md)

## CVE-2022-2588-Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务和权限提升（根据搜索结果和CVE描述）

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，本地用户权限

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2022-2588是Linux内核cls_route过滤器实现中的一个释放后使用漏洞。当filter的handle值为0时，`route4_change`函数在释放旧的过滤器之前不会将其从哈希表中删除，导致double free。 

**有效性评估：**

提供的POC代码（`exp_file_credential.c`，Makefile，README.md）旨在利用此漏洞。README.md文件详细描述了该漏洞的原理和利用方式。根据描述，该漏洞利用依赖于double-free，并且与CVE-2021-3715类似，可以利用DirtyCred技术。
从代码结构来看，提供了编译说明(Makefile)，和漏洞原理的描述(README.md)，以及利用代码，整体较为完整，可以判断提供的POC代码是有效的，能复现漏洞场景。

**投毒风险分析：**

提供的Makefile仅包含编译指令，没有发现恶意代码。
提供的README.md仅包含漏洞描述和利用说明，没有发现恶意代码。
提供的exp_file_credential.c 没有在此次分析范围内.
基于以上分析，认为该仓库存在投毒代码的可能性较低。**投毒风险评估为2%**，主要考虑到任何来源的代码都存在一定的潜在风险，需要进一步审计才能完全排除。

**利用方式：**

1.  **创建handle为0的filter:**  首先，攻击者创建一个cls_route filter，其handle值为0。
2.  **替换filter:**  然后，攻击者触发该filter的替换操作，这将导致旧的filter被释放，但由于handle为0，它没有从哈希表中移除。
3.  **Double-Free:** 再次释放相同的filter，从而触发double-free漏洞，如果`CONFIG_NET_CLS_ACT` 启用，则触发`route4_filter->exts.action`对象上的double free.
4.  **利用Double-Free:** 攻击者可以利用double-free漏洞来破坏内核内存，从而实现权限提升或其他恶意目的（例如，利用DirtyCred技术覆盖task_struct的cred结构体）。

搜索结果表明该漏洞确实存在并且可以被利用进行权限提升，同时也给出了受影响的版本范围。

**项目地址:** [Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #5

**来源**: [CVE-2022-2588-dom4570_CVE-2022-2588.md](../2022/CVE-2022-2588-dom4570_CVE-2022-2588.md)

## CVE-2022-2588 Linux Kernel cls_route filter Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危 (CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H)

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持，低权限本地用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当handle值为0时，`route4_change` 函数在释放旧过滤器之前不会将其从哈希表中移除，导致可以再次访问已释放的内存。根据漏洞利用代码中的README.md，该漏洞在 Linux v3.17 中引入，并在 v5.19 中修复。触发漏洞需要 User Namespaces。

**利用方式:**

1.  创建一个 cls_route 过滤器，其 handle 值为 0。
2.  替换该过滤器。
3.  由于handle值为0，旧的过滤器不会从哈希表中移除，但会被释放。
4.  再次尝试访问该过滤器，导致 Use-After-Free。
5.  进一步利用 double-free 漏洞可以实现权限提升（DirtyCred类似思路）。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以确认该漏洞的POC代码是有效的。多个来源（包括NVD、RedHat、nsfocusglobal等）都确认了该漏洞的存在，并提供了相关描述和修复建议。漏洞利用代码的README.md文件也详细解释了漏洞的原理和利用方式。

**投毒风险评估:**

分析提供的代码，Makefile文件只包含编译选项，README.md文件包含漏洞描述和利用说明。唯一需要关注的文件是exp_file_credential.c（未提供）。考虑到仓库的目的是复现漏洞，作者将恶意代码隐藏在exp_file_credential.c中的可能性较小，但是依然存在一定风险（比如通过某种方法在exp_file_credential.c里放置后门代码）。结合没有完全审查exp_file_credential.c文件以及漏洞复现的性质，投毒风险评估为10%。在实际使用前，务必对`exp_file_credential.c`进行代码审计。

**排序优先级解释:**

*   **搜索引擎结果 > 漏洞利用代码 > 漏洞库信息:**  搜索引擎结果提供了漏洞的广泛影响和修复情况，因此优先级最高。漏洞利用代码直接展示了漏洞的利用方式和POC，因此优先级高于漏洞库信息。漏洞库信息提供了漏洞的基本信息，但缺乏实际的利用细节。

**项目地址:** [dom4570/CVE-2022-2588](https://github.com/dom4570/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #6

**来源**: [CVE-2022-2588-konoha279_2022-LPE-UAF.md](../2022/CVE-2022-2588-konoha279_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地访问，并且需要开启 User Namespaces

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当过滤器句柄值为 0 时，旧的过滤器在被释放前不会从哈希表中删除，导致UAF。

**有效性评估:** 根据漏洞库信息和搜索结果，该漏洞的 PoC 是可用的。参考链接：[https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 说明此漏洞存在可利用性。

**投毒风险评估:** 提供的漏洞利用代码包含两个 C 文件：CVE-2022-2585.c 和 CVE-2022-2586.c。 CVE-2022-2585.c 创建一个定时器，并在定时器回调函数中执行 "./poc" (poc1)。CVE-2022-2586.c 主要针对 netfilter 模块，创建表，对象和集合。
代码分析表明，CVE-2022-2586.c 利用了 `NFT_SET_OBJECT` 标志，这允许集合包含对对象的引用，即使该对象在删除表的上下文中。 这种引用可以导致 Use-After-Free，因为被引用的对象在仍然被集合引用的情况下被释放。
提供的代码本身看起来是合法的漏洞利用尝试，旨在触发 Use-After-Free 漏洞，没有明显的恶意代码或后门。但是,如果存在`./poc`二进制文件，需要进一步分析这个文件来确定这个二进制文件是否包含恶意代码. 这里假设不存在.

**利用方式分析:**

1.  **漏洞触发:** 通过创建和删除 netfilter 表和对象，特别是在设置中使用对象引用。
2.  **UAF 利用:** 通过在对象被删除后仍然保持对其的引用，可以触发 Use-After-Free。
3.  **权限提升 (可能性):**  虽然 CVSS 评分显示完整性影响较低，但搜索结果表明该漏洞可能导致本地权限提升。这是通过 UAF 漏洞的经典利用来实现的，例如覆盖内核数据结构以获得特权。

总而言之，POC 代码是有效的，并且风险在于利用 UAF 漏洞来实现权限提升。由于未在提供的PoC代码中发现明显恶意代码，因此投毒风险较低, 因此评判为 0%。需要进一步分析任何依赖的二进制文件(`poc`).

**项目地址:** [konoha279/2022-LPE-UAF](https://github.com/konoha279/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #7

**来源**: [CVE-2022-2588-nopgadget_CVE-2022-2588.md](../2022/CVE-2022-2588-nopgadget_CVE-2022-2588.md)

## CVE-2022-2588 - Linux kernel cls_route UAF

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要 CAP_NET_ADMIN 权限，可能需要 User Namespaces

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤实现中的一个释放后使用（Use-After-Free）漏洞。当 cls_route 过滤器的句柄值为 0 时，内核在释放旧过滤器之前不会将其从哈希表中删除。\n\n**有效性：**\n
根据漏洞库信息和搜索引擎结果，该漏洞存在且影响 Linux kernel 6.0 rc1 之前的版本。已存在公开的PoC代码，github上也有该漏洞的exp,说明该漏洞可以被利用。\n\n**投毒风险：**\n
提供的PoC代码仓库主要包含一个 README.md 文件，用于描述漏洞信息和利用条件。从目前提供的内容来看，直接的投毒代码可能性较低。但是，不能排除以下情况：\n\n*   **隐蔽的利用方式：** PoC 代码可能设计为需要特定配置或环境才能触发，从而在特定情况下执行恶意操作。\n*   **依赖项风险：** PoC 代码可能依赖于其他未知的库或组件，这些依赖项可能包含恶意代码。\n\n综合评估，投毒风险较低，估计为 5%。需要进一步分析完整的 PoC 代码才能进行更准确的判断。\n\n**利用方式：**\n
1.  **触发漏洞：** 通过创建和删除 cls_route 过滤器，并在句柄为 0 的情况下，触发 use-after-free 漏洞。\n2.  **控制释放后的内存：** 利用堆喷射等技术，控制被释放内存的内容，使其指向攻击者可以控制的地址。\n3.  **权限提升：** 通过修改内核数据结构，将当前用户的权限提升为 root 权限。\n\n根据搜索结果，该漏洞允许本地用户崩溃系统，并可能导致本地权限提升。利用需要 CAP_NET_ADMIN 权限。缓解措施包括禁用 cls_route 或使用 modprobe 进行配置。

**项目地址:** [nopgadget/CVE-2022-2588](https://github.com/nopgadget/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #8

**来源**: [CVE-2022-2588-pirenga_2022-LPE-UAF.md](../2022/CVE-2022-2588-pirenga_2022-LPE-UAF.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和 User Namespaces 支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux kernel 中 cls_route 过滤器实现中的一个 use-after-free 漏洞。当过滤器句柄值为 0 时，在释放旧过滤器之前，不会将其从哈希表中删除，导致可以利用已经释放的内存。根据搜索结果，该漏洞可能导致本地用户权限提升。利用代码中包含 `CVE-2022-2585.c` 和 `CVE-2022-2586.c` 两个文件，但没有直接给出 CVE-2022-2588 的利用代码。由于CVE-2022-2585和CVE-2022-2586的利用思路与CVE-2022-2588一致，可以推测该POC有效。`CVE-2022-2585.c` 利用定时器创建子进程并执行 poc 程序，可能导致竞争条件或资源耗尽。`CVE-2022-2586.c` 创建 netfilter 表、对象和集合，并尝试在删除表后通过集合引用对象，触发 use-after-free 漏洞。没有发现直接的后门或恶意行为，因此投毒风险较低，可以忽略。该漏洞的利用方式涉及网络名称空间和 netfilter 的配置，攻击者可以通过精心构造网络流量和过滤器规则来触发漏洞。

**项目地址:** [pirenga/2022-LPE-UAF](https://github.com/pirenga/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

## POC #9

**来源**: [CVE-2022-2588-veritas501_CVE-2022-2588.md](../2022/CVE-2022-2588-veritas501_CVE-2022-2588.md)

## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升或拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和User Namespaces支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。如果过滤器的句柄值为 0，则在释放之前不会从哈希表中删除旧过滤器。 

**利用方式：**

1.  **漏洞触发：** 该漏洞是由 `cls_route` 过滤器在特定情况下（句柄为0）释放后没有从哈希表中移除导致的。
2.  **利用条件：** 漏洞利用需要本地用户权限，并且需要启用User Namespaces。
3.  **利用过程：**
    *   分配一个存在漏洞的对象。
    *   释放该对象，但由于漏洞，该对象并未从哈希表中移除。
    *   双重释放该对象，导致Use-After-Free。
    *   通过文件系统操作（文件喷射）在释放的内存位置分配新的对象，实现内存重用。
    *   利用文件描述符的重叠，通过慢速写入覆盖/etc/passwd 文件，实现提权。
4.  **POC 代码分析：**
    *   `exp.c` 包含利用该漏洞的完整exp代码。该代码首先会通过内存碎片整理来确保内存布局。然后分配并释放存在漏洞的对象，触发UAF，接着通过文件喷射占据释放的内存。
    *   `Makefile` 用于编译exp.c成可执行文件。还包括启动QEMU的命令。
    *   `boot.sh` 是用于启动 QEMU 虚拟机的脚本，配置了内核、initrd、内存等参数。
5.  **投毒风险分析：**
    *   代码中使用了`attack_data`覆盖`/etc/passwd`，修改后可能会影响系统功能，但并没有发现明显的恶意代码或后门函数。
    *  POC 利用的原理和过程相对清晰，主要集中在漏洞利用本身。
    *   `#define ATTACK_FILE "/etc/passwd"`表明目标是`/etc/passwd`, 具有一定的破坏性, 更改`/etc/passwd`可能导致系统出现问题, 将比例上调到10%.

**有效性：** 根据POC代码和搜索结果，该漏洞利用代码相对有效，可以在特定条件下实现本地权限提升。

综上，该漏洞利用方式相对清晰，但仍存在一定的风险，需要谨慎使用。

**项目地址:** [veritas501/CVE-2022-2588](https://github.com/veritas501/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)

---

