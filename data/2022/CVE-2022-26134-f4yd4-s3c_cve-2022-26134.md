## CVE-2022-26134 - Atlassian Confluence 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** from 1.3.0 before 7.4.17, from 7.13.0 before 7.13.7, from 7.14.0 before 7.14.3, from 7.15.0 before 7.15.2, from 7.16.0 before 7.16.4, from 7.17.0 before 7.17.4, from 7.18.0 before 7.18.1

**利用条件:** 需要网络访问，无需身份验证即可利用。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2022-26134是Atlassian Confluence中的一个严重的OGNL注入漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞存在于多个Confluence版本中，包括1.3.0到7.4.17之前的版本，7.13.0到7.13.7之前的版本，7.14.0到7.14.3之前的版本，7.15.0到7.15.2之前的版本，7.16.0到7.16.4之前的版本，7.17.0到7.17.4之前的版本，以及7.18.0到7.18.1之前的版本。 

POC分析：提供的POC是一个Python脚本，利用了该漏洞。该脚本首先检查目标Confluence实例是否易受攻击，通过访问/login.action并检查返回的版本信息来确定。如果目标版本易受攻击，该脚本将发送一个包含恶意OGNL表达式的HTTP请求，该表达式将在服务器上执行任意命令。该POC代码结构清晰，依赖库明确（requests, termcolor），易于使用，只需提供目标URL即可。

利用步骤：
1. 安装依赖库：pip3 install termcolor
2. 运行exploit.py脚本，提供目标Confluence URL作为参数：python3 exploit.py http://example.com:8081
3. 脚本将尝试利用漏洞，允许执行任意命令。可以通过修改payload来执行不同的命令。

投毒风险分析：
此POC的投毒风险较低，约为20%。主要原因如下：
1. 代码清晰易懂，没有明显的混淆或隐藏的恶意行为。
2. 脚本只使用了标准的Python库（requests, termcolor），降低了引入恶意依赖的风险。
3. 脚本的目的是利用已知的漏洞执行命令，而不是植入后门或窃取数据。
4. 脚本中包含漏洞作者的信息，增加了可信度。
尽管如此，仍存在一些潜在的风险：
1. 攻击者可能会修改该脚本，添加恶意功能，例如植入后门或窃取数据。
2. 攻击者可能会将该脚本与其他恶意软件捆绑在一起，诱骗用户下载和执行。
3. 用户在使用该脚本时，可能会不小心将其暴露在公共网络上，从而导致安全风险。
为了降低投毒风险，建议用户：
1. 从可信的来源下载该脚本。
2. 在运行该脚本之前，仔细阅读代码，确保没有恶意行为。
3. 限制该脚本的权限，只允许其执行必要的操作。
4. 定期扫描系统，检查是否存在恶意软件。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
