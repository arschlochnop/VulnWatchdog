## CVE-2022-26134 - Atlassian Confluence OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 受影响版本范围未知，需要进一步分析Confluence的版本信息。

**利用条件:** 需要网络访问，具体是否需要认证取决于Confluence的配置。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-26134是Atlassian Confluence中的一个OGNL注入漏洞。通过构造恶意的OGNL表达式，攻击者可以在Confluence服务器上执行任意代码。该漏洞的POC利用代码（/tmp/vulnwatchdog_615c2cd3e638e8f6b57092c3b9ff2604/CVE-2022-26134.py）提供了一个完整的利用链，允许攻击者发送包含恶意OGNL表达式的HTTP请求，并在目标服务器上执行命令。

**POC有效性分析：**
POC代码首先定义了一个banner函数，用于显示漏洞信息。然后，定义了addHttps和addHttp函数，用于为URL添加http或https头。openFile函数用于批量处理漏洞地址，getHtmlResult函数用于发送包含恶意OGNL表达式的HTTP请求，并获取返回头。createXlsx函数用于创建Excel文件，main_file函数是漏洞利用的核心函数，它首先构造包含恶意OGNL表达式的URL，然后发送HTTP请求，并获取返回头。如果返回头中包含X-Qualys-Response字段，则说明漏洞存在，并将结果写入Excel文件。

**利用步骤：**
1. 运行POC代码，指定目标URL和要执行的命令。
2. POC代码构造包含恶意OGNL表达式的URL。
3. POC代码发送HTTP请求到目标URL。
4. 目标服务器执行OGNL表达式，执行指定的命令。
5. POC代码获取返回头，并检查是否包含X-Qualys-Response字段。
6. 如果返回头中包含X-Qualys-Response字段，则说明漏洞存在。

**投毒风险分析：**
该POC的投毒风险较低，因为代码相对清晰，主要使用了requests库和标准库，没有发现明显的恶意行为。POC代码尝试从目标服务器获取返回头中的X-Qualys-Response字段，验证漏洞是否存在。如果POC的目的是在目标服务器上执行任意代码，那么这本身就存在一定的风险，因为攻击者可以利用该漏洞植入后门或执行其他恶意操作。但是，该POC代码本身并没有包含恶意代码，因此投毒风险较低。该POC可能会被修改以包含更具破坏性的payload，例如删除文件或窃取敏感数据。因此，在使用该POC时，需要谨慎评估其风险，并采取相应的安全措施。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
