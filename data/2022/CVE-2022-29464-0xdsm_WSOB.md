## CVE-2022-29464 - WSO2 API Manager, Identity Server, Enterprise Integrator等多个产品 RCE (远程代码执行)

**漏洞编号:** CVE-2022-29464

**漏洞类型:** RCE (远程代码执行)

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator等多个产品

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** API Manager 2.2.0-4.0.0; Identity Server 5.2.0-5.11.0; Identity Server Analytics 5.4.0-5.6.0; IS as Key Manager 5.3.0-5.10.0; Enterprise Integrator 6.2.0-6.6.0

**利用条件:** 无需认证，可通过网络直接访问/fileupload接口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC（WSOB）是一个基于Python编写的完整利用工具，旨在自动化利用WSO2产品中的CVE-2022-29464漏洞。通过分析代码结构，项目包含清晰的模块化设计：main.py负责参数解析，src模块处理核心逻辑。其核心原理是利用/fileupload接口存在的未授权任意文件上传漏洞，结合Content-Disposition字段中的目录遍历序列（如../../../../repository/deployment/server/webapps），将恶意的JSP Webshell上传至Web根目录下的特定位置，从而实现远程代码执行。从代码片段看，它依赖requests库处理HTTP交互，rich库美化终端输出。该POC提供了完整的命令行界面，支持指定目标URL，利用过程高度自动化。经评估，该代码逻辑与公开的漏洞原理完全吻合，能够直接导致目标服务器被完全控制。利用步骤如下：1. 环境准备，安装Python 3及requests和rich库；2. 使用git克隆仓库并安装依赖；3. 执行main.py并使用-u参数指定目标WSO2服务器地址；4. 工具将自动尝试通过fileupload接口上传JSP后门并验证执行。该工具封装了路径穿越负载，极大降低了利用门槛。投毒风险分析：经过对提取的代码结构和README文档进行安全审计，该POC项目的投毒风险极低（约5%）。首先，代码逻辑清晰透明，使用了标准的Python库（requests, argparse），没有发现任何经过混淆的Base64编码字符、恶意编译的二进制文件或隐藏的外部脚本下载行为。其次，项目的开源属性和README中详尽的安装指导符合安全研究工具的特征。虽然README中提到了credits指向hakivvi（原始Webshell作者），但这属于正常的安全社区引用。在main.py中，代码仅执行了UI展示和逻辑启动函数，没有发现后门注入、敏感信息窃取（如环境变量上传、SSH密钥读取）或持久化维持等恶意行为。唯一潜在的风险点在于其依赖项requirements.txt，但在给出的版本（rich==12.4.1, requests==2.27.1）中均为官方主流版本，不存在已知的供应链投毒迹象。该工具是一个纯粹的渗透测试辅助脚本，而非针对安全从业者的钓鱼程序。

**项目地址:** [https://github.com/oppsec/WSOB](https://github.com/oppsec/WSOB)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)
