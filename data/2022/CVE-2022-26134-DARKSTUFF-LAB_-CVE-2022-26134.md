## CVE-2022-26134 - Atlassian Confluence Server 和 Data Center 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** All < 7.4.17 versions before 7.18.1

**利用条件:** 无需身份验证，网络可访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，属于 OGNL 注入导致的远程代码执行漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标系统上执行任意代码。根据 Atlassian 官方的安全公告，所有小于 7.4.17 以及 7.18.1 之前的版本均受此漏洞影响。

POC 有效性分析：提供的 POC 代码（exploit.py）是一个完整的漏洞利用程序，它利用了 OGNL 注入漏洞。POC 包含必要参数，例如目标 URL (-u)，文件包含 (-f)，线程数 (-t)，超时时间 (-m)，输出文件 (-o)，以及要执行的命令 (-c)。通过执行 'python3 exploit.py -u <target_url> -c id' 这样的命令，可以验证目标系统是否存在漏洞。POC 能够成功执行命令并返回结果，证明其有效性。提供的 README 文件详细描述了漏洞原理和利用方法，并提供了示例请求和利用步骤，表明 POC 具有较高的质量和可用性。

利用步骤：
1. 准备：安装 Python 3 和必要的 requests 库。
2. 执行：运行 exploit.py 脚本，指定目标 Confluence 实例的 URL 和要执行的命令。
3. 验证：检查命令执行的结果，确认代码已成功执行。

例如：
`python3 exploit.py -u http://xxxxx.com -c id`

上述命令将在目标系统上执行 'id' 命令，并将结果返回。

投毒风险分析：
该 POC 的投毒风险较低。主要基于以下几个方面：
1. 代码清晰：Python 代码结构清晰，逻辑简单，易于阅读和理解。
2. 标准库：POC 主要使用标准库 (optparse, multiprocessing) 和 requests 库，没有使用高风险的函数或模块。
3. 无可疑行为：代码没有包含任何恶意行为，例如下载和执行外部脚本、修改系统配置等。
4. 命令执行可控：用户需要显式指定要执行的命令，POC 本身不会主动执行恶意命令。
虽然该 POC 本身没有明显的投毒行为，但使用者仍需要注意，在未授权的情况下利用该漏洞进行攻击是违法的。此外，如果攻击者修改了 POC 代码，加入了恶意功能，则可能会导致投毒风险升高。例如，攻击者可能会在 POC 中加入恶意代码，用于植入后门、窃取敏感数据等。因此，在使用任何公开的 POC 代码时，都需要进行仔细的审查和验证。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
