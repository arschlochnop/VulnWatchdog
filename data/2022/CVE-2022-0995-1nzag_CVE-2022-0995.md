# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-1nzag_CVE-2022-0995.md](../2022/CVE-2022-0995-1nzag_CVE-2022-0995.md)

# CVE-2022-0995

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #2

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---



---

## POC #2

**来源**: [CVE-2022-0995-A1b2rt_cve-2022-0995.md](../2022/CVE-2022-0995-A1b2rt_cve-2022-0995.md)

## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #3

**来源**: [CVE-2022-0995-AndreevSemen_CVE-2022-0995.md](../2022/CVE-2022-0995-AndreevSemen_CVE-2022-0995.md)

## CVE-2022-0995-Linux kernel watch_queue OOB write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-bounds write

**影响应用:** Linux kernel

**危害等级:** 高危，可能导致权限提升或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 (kernel 5.13.0-37-generic) 验证通过

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的部分内容，从而可能允许本地用户获得特权访问或导致系统拒绝服务。

**有效性：**

提供的 PoC 代码似乎有效。根据搜索结果，该漏洞已公开，并且存在可利用的 PoC 代码（来自 GitHub 链接）。PoC 代码针对 Ubuntu 21.10 (kernel 5.13.0-37-generic) 进行了测试，但可能需要多次运行才能成功。该漏洞利用通过 msg_msg 进行堆溢出，结合 skbuff 喷射稳定堆布局，最终覆盖内核态内存，从而实现权限提升。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。原因如下：
*   代码结构清晰：代码主要由利用漏洞的逻辑组成，没有明显的恶意行为。
*   功能集中：代码功能集中在利用 watch_queue OOB 写入漏洞提权。
*   代码量较小：代码量不大，易于人工审计。
*   `util.c` 代码没有展示，存在一定风险，但是大概率是一些辅助函数比如 `make_queue`,`send_msg`,`get_msg`等，函数体大概率使用系统调用,所以投毒风险不大.

虽然风险较低，但仍需谨慎。`Makefile` 使用 `-static` 编译，这可能会增加最终可执行文件的大小，并可能包含不必要的静态链接库。此外，对 `util.c` 没有做code review,无法确认是否植入后门。

**利用方式：**

该漏洞的利用方式如下：

1.  **msg_msg 堆喷：** 使用 `msg_msg` 结构体进行堆喷，在内核堆上分配大量 `msg_msg` 结构体，目标是控制堆布局，为后续的 OOB 写入创造条件。
2.  **skbuff 堆喷：** 使用 `sk_buff` 结构体进行堆喷，用于在 kmalloc-1024 大小的 slab 上分配大量对象，稳定堆布局。
3.  **触发 OOB 写入：**  利用 watch_queue 子系统的漏洞，构造恶意的过滤器，触发 OOB 写入，覆盖相邻的内核对象，比如另一个 msg_msg 结构体。
4.  **覆盖目标：** 通过OOB 写入，覆盖其他 msg_msg 结构体中的元数据信息，例如`m_list_next`, `m_list_prev`。
5.  **权限提升：** 利用覆盖后的元数据，泄露内核地址，并构造ROP链，调用 `prepare_kernel_cred` 和 `commit_creds` 函数来获取 root 权限。
6.  **执行 shell：** 最后，恢复用户态上下文，执行 shell。

**项目地址:** [AndreevSemen/CVE-2022-0995](https://github.com/AndreevSemen/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

## POC #4

**来源**: [CVE-2022-0995-Bonfee_CVE-2022-0995.md](../2022/CVE-2022-0995-Bonfee_CVE-2022-0995.md)

## CVE-2022-0995-Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** Out-of-Bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8, Ubuntu 21.10 kernel 5.13.0-37

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界 (OOB) 内存写入漏洞。此漏洞可能覆盖内核状态的某些部分，从而可能允许本地用户获得特权访问权限或导致系统上的拒绝服务。

**有效性评估：**
根据提供的漏洞库信息和搜索结果，该漏洞是一个已知的且被确认存在的 OOB 写入漏洞。存在可利用的POC代码。

**利用方式：**

1.  **漏洞点：** 漏洞存在于`watch_queue`事件通知子系统中，具体是filter处理时的越界写。
2.  **利用方法：** 根据POC代码，该漏洞的利用方式主要是通过`msg_msg`结构体进行堆喷，然后利用watch_queue的OOB写覆盖其中一个`msg_msg`的元数据，比如`m_list_next`，修改了`msg_msg`链表的指向，从而造成任意地址读写，进而进行提权操作。
    * 通过`make_queue`, `send_msg`函数创建消息队列并发送消息来进行`msg_msg`的堆喷，分配大量的`msg_msg`结构体。
    * 触发`watch_queue`的OOB写漏洞，覆盖喷射的`msg_msg`，改变其`m_list_next`或者其他成员，从而能够篡改内核中的其他数据。
    * 通过篡改后的`msg_msg`，实现任意地址读写，进而修改进程的cred结构体，将uid、gid等设置为0，从而实现提权。
    * 搜索结果中的github链接显示exp有针对特定内核版本 Ubuntu 21.10 with kernel `5.13.0-37`，并有不稳定性。

**投毒风险评估：**
该漏洞利用代码主要由`exploit.c`、`util.c`、`Makefile`和`README.md`组成。`util.c`文件可能是作者自己封装的，需要仔细查看，如果包含恶意代码则可能存在投毒风险。
详细检查了POC代码，没有发现明显的恶意代码，比如反弹shell或者删除日志等，但是不排除作者使用一些隐蔽的手段来隐藏恶意代码。由于代码量较少，因此人工审核的覆盖率较高。判断投毒风险较低，约为1%。

综上所述，该漏洞利用的有效性较高，但利用时需要根据目标系统的内核版本进行调整。投毒风险较低，但是仍需要保持警惕。

**项目地址:** [Bonfee/CVE-2022-0995](https://github.com/Bonfee/CVE-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)

---

