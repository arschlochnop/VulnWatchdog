## CVE-2022-26134 - Atlassian Confluence Server和Data Center 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Server和Data Center

**危害等级:** 严重

**CVSS评分:** 10

**影响版本:** 受影响的版本范围未知，但需根据版本信息排查

**利用条件:** 未经身份验证即可利用，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server和Data Center中。该漏洞允许未经身份验证的远程攻击者通过注入OGNL表达式来执行任意代码。根据搜索结果，该漏洞的CVSS评分为10分，表明其具有极高的危害性。漏洞细节和PoC代码已被公开披露，并且检测到存在在野利用，这使得该漏洞的威胁级别进一步提高。

POC代码分析：
提供的Python脚本"confusploit.py"是一个完整的漏洞利用程序，利用了Confluence服务器中的OGNL表达式注入漏洞。脚本首先检查目标Confluence服务器的版本，然后构造包含恶意OGNL表达式的payload，该payload用于执行任意命令。该脚本通过发送一个GET请求，其中包含经过URL编码的OGNL表达式，该表达式利用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`类来执行命令并将结果写入响应头。如果服务器存在漏洞，它将执行命令并将输出包含在响应的“X-Cmd-Response”头中。脚本使用`requests`库发送HTTP请求，并使用`BeautifulSoup`库（尽管在本例中未使用）来解析HTML响应。脚本还使用`colorama`库来为输出着色，使其更易于阅读。脚本接受两个命令行参数：目标Confluence服务器的URL和要执行的命令。如果未提供任何参数，脚本将显示用法说明。总体而言，该脚本编写良好，易于使用，并且可以有效地利用CVE-2022-26134漏洞。

利用步骤：
1. 运行confusploit.py脚本，提供Confluence服务器的URL和要执行的命令，例如：`python3 confusploit.py https://example.com id`。
2. 脚本将发送包含恶意OGNL表达式的HTTP GET请求到Confluence服务器。
3. 如果服务器存在漏洞，它将执行命令并将输出包含在响应的“X-Cmd-Response”头中。
4. 脚本将从响应头中提取命令输出并将其显示在终端上。

投毒风险分析：
该PoC代码的投毒风险较低。该脚本主要使用标准Python库，如`requests`、`urllib3`、`re`和`colorama`，这些库通常被认为是安全的。该脚本没有包含任何混淆代码或可疑的外部脚本。该脚本执行的唯一网络请求是向目标Confluence服务器发送HTTP GET请求，该请求包含经过URL编码的OGNL表达式。虽然OGNL表达式本身可能包含恶意代码，但这被认为是漏洞利用的一部分，而不是投毒。脚本中没有发现任何明显的后门代码或恶意行为。但是，用户应始终谨慎使用来自不受信任来源的PoC代码，并确保在使用前对其进行彻底审查。考虑到脚本的功能和使用的库，投毒风险估计为15%。

**项目地址:** https://github.com/0x14dli/cve2022-26134exp

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
