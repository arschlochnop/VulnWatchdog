## CVE-2022-26134 - Atlassian Confluence 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 所有受影响版本未知，请参考Atlassian官方公告。

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134是Atlassian Confluence Server和Data Center中的一个OGNL注入漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞存在于Webwork OGNL表达式处理中。由于Confluence对用户提供的输入验证不足，攻击者可以通过构造恶意的OGNL表达式，将其注入到Confluence服务器的上下文中，从而执行任意命令。攻击者可以通过发送特制的HTTP请求来触发此漏洞，无需任何身份验证。成功利用此漏洞可使攻击者完全控制受影响的Confluence服务器，从而导致数据泄露、服务中断或进一步的恶意活动。

POC有效性分析：
提供的POC代码是一个名为ConfluentPwn的Python脚本，用于扫描Confluence服务器是否存在CVE-2022-26134漏洞并执行命令。该脚本通过发送特制的HTTP请求来利用漏洞，其中包括一个恶意的OGNL表达式。该POC的质量较高，因为它提供了完整的利用链，包括漏洞检测和命令执行。README文件提供了详细的用法说明和示例，以及如何指定目标、并发、超时和用户代理等参数。此外，该POC还提供了输出功能，可以将扫描结果写入CSV文件。

利用步骤：
1. 下载ConfluentPwn脚本。
2. 使用-file参数指定包含目标URL列表的文件，或者直接在命令行中指定目标URL。
3. 使用-cmd参数指定要在易受攻击的服务器上执行的命令，默认命令为"id"。
4. 使用-threads参数控制并发线程数，默认值为20。
5. 使用-timeout参数设置HTTP超时时间，默认值为5秒。
6. 使用-user-agent参数指定自定义User-Agent。
7. 运行脚本，并将输出写入CSV文件。

投毒风险分析：
ConfluentPwn脚本的投毒风险较低，约为15%。该脚本主要使用Python标准库，没有发现任何可疑的外部依赖项或代码混淆。该脚本的功能明确，旨在检测和利用CVE-2022-26134漏洞，没有发现任何恶意行为。然而，该脚本可以执行任意命令，因此存在一定的风险，攻击者可能会修改脚本以执行恶意操作，例如安装后门或窃取敏感数据。建议用户在使用该脚本时仔细审查代码，并从可信来源下载。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
