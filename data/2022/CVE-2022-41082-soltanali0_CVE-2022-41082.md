# CVE-2022-41082

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md](../2022/CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，攻击者可以利用此漏洞在受影响的Exchange服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 和 23, Exchange Server 2019 Cumulative Update 11 和 12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问受影响的Exchange服务器，通常通过ProxyNotShell漏洞链利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。 从搜索结果和漏洞库信息来看，该漏洞与 CVE-2022-41040 (ProxyNotShell) 经常一起被提及，表明它们可能构成一个攻击链。 从漏洞利用代码来看，攻击者发送包含特定格式的URL请求，该URL包含PowerShell相关的关键字，尝试在服务器端执行PowerShell命令， 漏洞利用代码的Request URL示例：`/autodiscover/autodiscover.json?@evil.com/owa/&Email=autodiscover/autodiscover.json%3f@evil.com&Protocol=XYZ&FooProtocol=Powershell` 。

**有效性分析：** 根据搜索结果，该漏洞已经被公开利用。 提供的POC代码展示了利用该漏洞的请求URL示例，表明该POC代码是有效的。

**投毒风险分析：** 提供的漏洞利用代码只是一个 README.md 文件，其中包含攻击事件的报告。 该文件仅描述了攻击尝试，并没有包含任何可执行的代码，因此不存在投毒风险。

**利用方式：**  利用方式通常是与ProxyNotShell漏洞（CVE-2022-41040）结合，先通过ProxyNotShell获得访问权限，然后利用CVE-2022-41082在Exchange服务器上执行任意代码。攻击者通过构造恶意的URL请求，利用Exchange服务器的 autodiscover 功能，并注入 PowerShell 代码，最终实现远程代码执行。


**项目地址:** [CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt](https://github.com/CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #2

**来源**: [CVE-2022-41082-Diverto_nse-exchange.md](../2022/CVE-2022-41082-Diverto_nse-exchange.md)

## CVE-2022-41082-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22和23，以及Exchange Server 2019 Cumulative Update 11和12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要目标Exchange服务器开放相关端口，攻击者需要一定的权限，需要Exchange PowerShell可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。根据搜索引擎结果和漏洞库信息，该漏洞与 CVE-2022-41040 (SSRF) 配合使用，被称为 ProxyNotShell。利用方式通常是首先通过 CVE-2022-41040 漏洞进行服务器端请求伪造，然后利用 CVE-2022-41082 执行任意代码。该漏洞的利用需要一定的权限，并且需要 Exchange PowerShell 可访问。

提供的漏洞利用代码是一个 Nmap NSE 脚本，用于检测目标 Exchange 服务器是否存在此漏洞的缓解措施(虚拟补丁)。它本身并不能直接执行代码，而是用于验证服务器是否容易受到攻击，根据返回结果判断是否受到虚拟补丁保护。

**有效性：**
提供的 Nmap 脚本主要用于检测虚拟补丁是否有效，并非直接的漏洞利用代码，但可以辅助判断目标是否受到漏洞影响。所以判定PoC有效。

**投毒风险：**
分析提供的代码仓库，其中包含一个 MIT 许可证、一个 README 文件和一个 Nmap NSE 脚本文件。该脚本的功能是检测目标 Exchange 服务器是否存在 CVE-2022-41082 漏洞的缓解措施。

代码本身看起来比较简单，主要使用 Nmap 的 http 库发送 HTTP 请求，并根据响应判断是否存在漏洞。没有发现明显的恶意代码或后门。但是，任何网络脚本都存在一定的风险，例如：

1.  **依赖项风险：** 脚本依赖于 Nmap 及其相关库。如果 Nmap 本身存在漏洞或被篡改，可能会影响脚本的安全性。
2.  **远程代码执行风险：** 即使脚本本身不包含恶意代码，如果它与目标系统交互的方式不安全，仍然可能导致远程代码执行。例如，如果脚本接受用户提供的 URL 作为输入，并且没有进行充分的验证，攻击者可能会利用这一点执行任意代码。
3.  **信息泄露风险：** 脚本可能会收集目标系统的敏感信息，例如 Exchange 服务器的版本号、配置信息等。如果这些信息被泄露，可能会被攻击者利用。

综合考虑以上因素，我将投毒风险评估为 10%。

**利用方式：**
1.  首先，攻击者利用 CVE-2022-41040 漏洞进行服务器端请求伪造，通过构造恶意的请求，绕过身份验证。
2.  然后，攻击者利用 CVE-2022-41082 漏洞，结合 Exchange PowerShell，执行任意代码，从而控制服务器。
3.  提供的 Nmap 脚本可以用来检测服务器是否已经应用了缓解措施，从而判断是否可以进行漏洞利用。

**项目地址:** [Diverto/nse-exchange](https://github.com/Diverto/nse-exchange)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #3

**来源**: [CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md](../2022/CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许远程代码执行，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013 Cumulative Update 23、2016 Cumulative Update 22 and 23, 以及 2019 Cumulative Update 11 and 12，具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问 Exchange PowerShell 或者利用 SSRF 漏洞 (CVE-2022-41040) 配合利用。根据搜索结果，通常需要身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，该漏洞通常与 CVE-2022-41040 (ProxyNotShell) 结合使用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，攻击者利用它来触发 CVE-2022-41082。利用方式通常涉及构造特定的 HTTP 请求发送到 Exchange 服务器，从而执行任意代码。提供的 YAML 格式的 PoC 代码主要用于检测漏洞是否存在。它尝试访问 `/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/` 路径，并检查服务器的响应状态码是否为 401 (未经授权)以及响应头中是否包含 `x-owa-version`。如果同时满足这两个条件，则可能存在此漏洞。关于投毒风险，PoC 本身主要目的是验证漏洞是否存在，但仍然存在一定的风险，例如，如果利用代码被修改为在服务器上执行恶意操作，或者被用来扫描大量目标服务器，可能会对网络造成一定的影响。PoC 验证阶段，不应该被认为是投毒行为。基于提供的 PoC 代码，其中使用了随机字符串 `{{randstr}}`，表明其主要目的是探测漏洞是否存在，而不是执行具体的恶意操作。因此，可以评估投毒风险较低，但是考虑到任何代码都可能被滥用或修改，仍然存在潜在风险。搜索结果也表明该漏洞被积极利用，需要及时修补。尽管 YAML 文件本身没有看到直接执行恶意操作的代码，但不能完全排除编写者或使用者后续添加恶意代码的可能性。所以评估投毒风险为 10%。

**项目地址:** [SUPRAAA-1337/CVE-2022-41082](https://github.com/SUPRAAA-1337/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #4

**来源**: [CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md](../2022/CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md)

## CVE-2022-41082 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange 2013, 2016, 2019 在2022年11月8日补丁之前的版本，具体版本参见CVE信息

**利用条件:** 需要有效的Exchange用户凭据以及OWA(Outlook Web Access)访问权限，通常与CVE-2022-41040 (SSRF) 配合使用, 搜索引擎结果显示需要Exchange PowerShell是可访问的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，也称为 ProxyNotShell。它与 CVE-2022-41040 (SSRF) 漏洞结合使用，形成一个攻击链。攻击者首先利用 CVE-2022-41040 的 SSRF 漏洞，然后利用 CVE-2022-41082 执行任意代码。

**利用方式：**

1.  **身份验证：** 攻击者需要一个有效的 Exchange 用户凭据。这可能是通过泄露、暴力破解或其他方式获得的。
2.  **SSRF (CVE-2022-41040)：** 攻击者利用 CVE-2022-41040 的 SSRF 漏洞，向 Exchange 服务器发送精心构造的请求。 
3.  **OWASSRF + RCE (CVE-2022-41082)：**  攻击者通过构造特定的请求，利用 Outlook Web Access (OWA) 绕过 URL 重写缓解措施，从而触发远程代码执行。
4.  **代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获得服务器的完全控制权。
5.  **TabShell (CVE-2022-41076):** PoC 中包含 TabShell.ps1，这是一种权限提升漏洞，用于突破受限的 PowerShell 沙箱，进一步提升攻击者的权限。

**关于投毒风险分析：**

查看提供的代码，`poc.py` 脚本主要功能是利用`requests`库，通过发送精心构造的HTTP请求到Exchange服务器上的OWA接口实现漏洞利用。`TabShell.ps1` 则是一个 PowerShell 脚本，用于在利用漏洞获得一定权限后，尝试提权并执行命令。

风险点可能在于`cmd_file`文件的内容。如果该文件由攻击者控制，则可以包含恶意命令。此外，`TabShell.ps1` 脚本中存在执行任意 PowerShell 命令的能力，存在潜在的恶意利用风险。

由于脚本主要依赖于合法的 Exchange 功能和协议，因此直接的“投毒”可能性较低，更多的是通过命令执行来植入后门或进行其他恶意活动。风险主要来自 `cmd_file` 的内容以及 `TabShell.ps1` 中可执行任意命令的功能. `poc.py`中的 HTTP Proxy设置可能被用于流量劫持，但属于利用方使用的手段，这里不判定为投毒。

因此，评估投毒风险为 10%。 风险主要存在于利用该 PoC 进行攻击的人员。如果利用此PoC进行未授权渗透，存在后门植入等恶意行为。作者本身的投毒风险较低。

**项目地址:** [balki97/OWASSRF-CVE-2022-41082-POC](https://github.com/balki97/OWASSRF-CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #5

**来源**: [CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md](../2022/CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22 和 23，Exchange Server 2019 Cumulative Update 11 和 12（具体版本范围见漏洞库信息）

**利用条件:** 需要身份验证，但可通过 SSRF 漏洞 (CVE-2022-41040) 结合利用绕过部分身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。攻击者可以通过利用此漏洞在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞与 CVE-2022-41040（SSRF 漏洞）组合成 ProxyNotShell 攻击链，允许经过身份验证的（或借助 SSRF 绕过部分身份验证的）攻击者远程执行代码。提供的 POC 代码显示了利用该漏洞的基本流程。POC包含一个Python脚本，用于发送特制的SOAP请求到Exchange服务器的PowerShell端点，从而触发RCE。此外，POC还包含TabShell.ps1脚本，利用特权提升，绕过受限的PowerShell沙箱环境，执行任意PowerShell命令，并执行操作系统命令，例如启动计算器（calc.exe）或获取IP配置信息。cmd文件指定了要执行的命令。POC的README文件提供了使用说明。投毒风险分析：虽然POC代码本身是为了演示漏洞利用，但由于其涉及到执行任意命令，存在一定的风险。`cmd` 文件中指定了 `C:\calc.exe` 作为示例，但攻击者可以替换为任何恶意程序。`TabShell.ps1`也具有潜在的风险，尝试绕过 PowerShell 的安全限制，如果成功，可能允许攻击者在更广泛的范围内执行恶意操作。代码中未发现明显的恶意投毒代码，但是建议审查脚本执行的操作，以确保其安全性和完整性。因此，推断投毒风险为10%。利用方式：

1.  **身份验证/SSRF 绕过：** 首先需要获取 Exchange 服务器的身份验证凭据，或者利用 CVE-2022-41040 (SSRF) 等漏洞绕过身份验证。
2.  **发送恶意 SOAP 请求：** 使用 POC 提供的 Python 脚本 `poc.py`，构造包含恶意 PowerShell 命令的 SOAP 请求，并将其发送到 Exchange 服务器的 PowerShell 端点。
3.  **命令执行：** Exchange 服务器解析并执行 SOAP 请求中的 PowerShell 命令，从而在服务器上执行任意代码。
4.  **特权提升（可选）：**  使用 `TabShell.ps1` 脚本突破 PowerShell 沙箱，提升权限并执行更广泛的恶意操作。
5.  **持久化/横向移动：**  攻击者可以利用 RCE 漏洞在 Exchange 服务器上安装后门、窃取敏感信息，或者横向移动到网络中的其他系统。

**项目地址:** [bigherocenter/CVE-2022-41082-POC](https://github.com/bigherocenter/CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #6

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (versionStartIncluding: 15.00.0, versionEndExcluding: 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (versionStartIncluding: 15.0.0, versionEndExcluding: 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (versionStartIncluding: 15.01.0, versionEndExcluding: 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问, 并且需要已经过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞，与 CVE-2022-41040 (ProxyNotShell) 组合利用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，允许经过身份验证的攻击者触发 CVE-2022-41082。CVE-2022-41082 允许远程代码执行，攻击者可以通过构造特定的请求，在 Exchange 服务器上执行任意代码。 

**漏洞利用方式:**

1.  攻击者首先利用 CVE-2022-41040 (SSRF) 漏洞获取对 Exchange 服务器的访问权限。
2.  然后，攻击者使用获得的权限构造恶意请求，触发 CVE-2022-41082，从而在服务器上执行任意代码。

提供的 Nmap 脚本 (`exchange-vuln-check.nse` 和 `vuln-CVE-2022-41082.nse`) 旨在检测目标 Exchange 服务器是否存在此漏洞。它们通过发送特制的 HTTP 请求到 `/autodiscover/autodiscover.json` 端点，并检查服务器的响应来判断漏洞是否存在。如果服务器返回 `401` 状态码并包含 `X-OWA-Version` 头部，则表示服务器可能存在漏洞。

**投毒风险分析:**

代码中 `rand.random_alpha(10)` 用于生成随机字符串，以避免缓存。这个操作本身没有问题。但是，由于代码主要用于漏洞检测，如果作者在其他地方加入恶意代码，比如在发送请求时附加恶意载荷，或者在报告结果时篡改信息，就可能构成投毒。
代码中的 `description` 字段包含西班牙语，初步判断作者存在翻译痕迹，可能使用了翻译工具，虽然不会直接导致投毒，但也增加了代码审查的难度, 通过审计代码，没有发现明显的恶意行为，但是存在一定的风险，因此认定投毒风险为10%。

**项目地址:** [notareaperbutDR34P3r/http-vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/http-vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #7

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (版本 < 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (版本 < 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (版本 < 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (版本 < 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (版本 < 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问，可能需要身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索引擎结果，该漏洞通常与 CVE-2022-41040 (SSRF) 结合利用，形成 ProxyNotShell 攻击链或 OWASSRF。攻击者首先利用 CVE-2022-41040 获得对 Exchange 服务器的访问权限，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码中的 `exchange-vuln-check.nse` 脚本旨在检测目标 Exchange 服务器是否存在此漏洞，它通过发送特制的 HTTP 请求到 `autodiscover/autodiscover.json` 路径进行检测。如果服务器返回特定的 HTTP 状态码和头部信息，则表明可能存在漏洞。此代码本身主要是检测，而非直接利用 RCE。因此，投毒风险较低，主要体现在 nmap 脚本的可靠性和可能存在的误报上。但如果此脚本被用于自动化扫描，并根据扫描结果进行进一步的攻击尝试，则可能被滥用。综上，判断该仓库存在 10% 的投毒风险，主要在于误报的可能性和脚本滥用的潜在风险。

**项目地址:** [notareaperbutDR34P3r/vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #8

**来源**: [CVE-2022-41082-sikkertech_CVE-2022-41082.md](../2022/CVE-2022-41082-sikkertech_CVE-2022-41082.md)

## CVE-2022-41082 - Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本：Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 & 23, Exchange Server 2019 Cumulative Update 11 & 12。 详见漏洞库信息。

**利用条件:** 需要经过身份验证（但结合CVE-2022-41040可以绕过身份验证）。 需要能够访问Exchange PowerShell。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索结果和漏洞库信息，该漏洞与 CVE-2022-41040（服务器端请求伪造，SSRF）一起被利用，被称为 'ProxyNotShell'。攻击者首先利用 CVE-2022-41040 绕过身份验证，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码通过构造特定的 URL，如 `autodiscover/autodiscover.json@Powershell.<random>.com/owa/`，来触发漏洞。该代码尝试访问该路径，并根据服务器的响应（例如，401 Unauthorized 并且包含 X-OWA-Version 头部）来判断目标是否易受攻击。由于代码中并没有发现恶意操作，例如执行恶意命令或上传后门，因此投毒风险较低，评估为0%。

**利用方式：**
1.  **SSRF (CVE-2022-41040)：** 攻击者利用SSRF漏洞绕过身份验证，向Exchange服务器发送伪造的请求。
2.  **RCE (CVE-2022-41082)：** 在绕过身份验证后，攻击者构造特定的请求，触发Exchange PowerShell，从而执行任意代码。这通常涉及在请求中包含恶意的PowerShell命令。

**POC代码有效性评估：**
POC代码尝试通过访问特定URL并检查响应头来确定是否存在漏洞。如果服务器返回401 Unauthorized 并且包含 `X-OWA-Version` 头部，则认为目标易受攻击。这个POC代码的逻辑是合理的，可以作为漏洞检测的一种方法。但是，实际的RCE利用需要更复杂的步骤，例如上传和执行webshell。该POC仅用于检测，不包含完整的RCE利用。

**项目地址:** [sikkertech/CVE-2022-41082](https://github.com/sikkertech/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #9

**来源**: [CVE-2022-41082-soltanali0_CVE-2022-41082.md](../2022/CVE-2022-41082-soltanali0_CVE-2022-41082.md)

# CVE-2022-41082

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md](../2022/CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，攻击者可以利用此漏洞在受影响的Exchange服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 和 23, Exchange Server 2019 Cumulative Update 11 和 12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问受影响的Exchange服务器，通常通过ProxyNotShell漏洞链利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。 从搜索结果和漏洞库信息来看，该漏洞与 CVE-2022-41040 (ProxyNotShell) 经常一起被提及，表明它们可能构成一个攻击链。 从漏洞利用代码来看，攻击者发送包含特定格式的URL请求，该URL包含PowerShell相关的关键字，尝试在服务器端执行PowerShell命令， 漏洞利用代码的Request URL示例：`/autodiscover/autodiscover.json?@evil.com/owa/&Email=autodiscover/autodiscover.json%3f@evil.com&Protocol=XYZ&FooProtocol=Powershell` 。

**有效性分析：** 根据搜索结果，该漏洞已经被公开利用。 提供的POC代码展示了利用该漏洞的请求URL示例，表明该POC代码是有效的。

**投毒风险分析：** 提供的漏洞利用代码只是一个 README.md 文件，其中包含攻击事件的报告。 该文件仅描述了攻击尝试，并没有包含任何可执行的代码，因此不存在投毒风险。

**利用方式：**  利用方式通常是与ProxyNotShell漏洞（CVE-2022-41040）结合，先通过ProxyNotShell获得访问权限，然后利用CVE-2022-41082在Exchange服务器上执行任意代码。攻击者通过构造恶意的URL请求，利用Exchange服务器的 autodiscover 功能，并注入 PowerShell 代码，最终实现远程代码执行。


**项目地址:** [CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt](https://github.com/CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #2

**来源**: [CVE-2022-41082-Diverto_nse-exchange.md](../2022/CVE-2022-41082-Diverto_nse-exchange.md)

## CVE-2022-41082-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22和23，以及Exchange Server 2019 Cumulative Update 11和12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要目标Exchange服务器开放相关端口，攻击者需要一定的权限，需要Exchange PowerShell可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。根据搜索引擎结果和漏洞库信息，该漏洞与 CVE-2022-41040 (SSRF) 配合使用，被称为 ProxyNotShell。利用方式通常是首先通过 CVE-2022-41040 漏洞进行服务器端请求伪造，然后利用 CVE-2022-41082 执行任意代码。该漏洞的利用需要一定的权限，并且需要 Exchange PowerShell 可访问。

提供的漏洞利用代码是一个 Nmap NSE 脚本，用于检测目标 Exchange 服务器是否存在此漏洞的缓解措施(虚拟补丁)。它本身并不能直接执行代码，而是用于验证服务器是否容易受到攻击，根据返回结果判断是否受到虚拟补丁保护。

**有效性：**
提供的 Nmap 脚本主要用于检测虚拟补丁是否有效，并非直接的漏洞利用代码，但可以辅助判断目标是否受到漏洞影响。所以判定PoC有效。

**投毒风险：**
分析提供的代码仓库，其中包含一个 MIT 许可证、一个 README 文件和一个 Nmap NSE 脚本文件。该脚本的功能是检测目标 Exchange 服务器是否存在 CVE-2022-41082 漏洞的缓解措施。

代码本身看起来比较简单，主要使用 Nmap 的 http 库发送 HTTP 请求，并根据响应判断是否存在漏洞。没有发现明显的恶意代码或后门。但是，任何网络脚本都存在一定的风险，例如：

1.  **依赖项风险：** 脚本依赖于 Nmap 及其相关库。如果 Nmap 本身存在漏洞或被篡改，可能会影响脚本的安全性。
2.  **远程代码执行风险：** 即使脚本本身不包含恶意代码，如果它与目标系统交互的方式不安全，仍然可能导致远程代码执行。例如，如果脚本接受用户提供的 URL 作为输入，并且没有进行充分的验证，攻击者可能会利用这一点执行任意代码。
3.  **信息泄露风险：** 脚本可能会收集目标系统的敏感信息，例如 Exchange 服务器的版本号、配置信息等。如果这些信息被泄露，可能会被攻击者利用。

综合考虑以上因素，我将投毒风险评估为 10%。

**利用方式：**
1.  首先，攻击者利用 CVE-2022-41040 漏洞进行服务器端请求伪造，通过构造恶意的请求，绕过身份验证。
2.  然后，攻击者利用 CVE-2022-41082 漏洞，结合 Exchange PowerShell，执行任意代码，从而控制服务器。
3.  提供的 Nmap 脚本可以用来检测服务器是否已经应用了缓解措施，从而判断是否可以进行漏洞利用。

**项目地址:** [Diverto/nse-exchange](https://github.com/Diverto/nse-exchange)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #3

**来源**: [CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md](../2022/CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许远程代码执行，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013 Cumulative Update 23、2016 Cumulative Update 22 and 23, 以及 2019 Cumulative Update 11 and 12，具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问 Exchange PowerShell 或者利用 SSRF 漏洞 (CVE-2022-41040) 配合利用。根据搜索结果，通常需要身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，该漏洞通常与 CVE-2022-41040 (ProxyNotShell) 结合使用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，攻击者利用它来触发 CVE-2022-41082。利用方式通常涉及构造特定的 HTTP 请求发送到 Exchange 服务器，从而执行任意代码。提供的 YAML 格式的 PoC 代码主要用于检测漏洞是否存在。它尝试访问 `/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/` 路径，并检查服务器的响应状态码是否为 401 (未经授权)以及响应头中是否包含 `x-owa-version`。如果同时满足这两个条件，则可能存在此漏洞。关于投毒风险，PoC 本身主要目的是验证漏洞是否存在，但仍然存在一定的风险，例如，如果利用代码被修改为在服务器上执行恶意操作，或者被用来扫描大量目标服务器，可能会对网络造成一定的影响。PoC 验证阶段，不应该被认为是投毒行为。基于提供的 PoC 代码，其中使用了随机字符串 `{{randstr}}`，表明其主要目的是探测漏洞是否存在，而不是执行具体的恶意操作。因此，可以评估投毒风险较低，但是考虑到任何代码都可能被滥用或修改，仍然存在潜在风险。搜索结果也表明该漏洞被积极利用，需要及时修补。尽管 YAML 文件本身没有看到直接执行恶意操作的代码，但不能完全排除编写者或使用者后续添加恶意代码的可能性。所以评估投毒风险为 10%。

**项目地址:** [SUPRAAA-1337/CVE-2022-41082](https://github.com/SUPRAAA-1337/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #4

**来源**: [CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md](../2022/CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md)

## CVE-2022-41082 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange 2013, 2016, 2019 在2022年11月8日补丁之前的版本，具体版本参见CVE信息

**利用条件:** 需要有效的Exchange用户凭据以及OWA(Outlook Web Access)访问权限，通常与CVE-2022-41040 (SSRF) 配合使用, 搜索引擎结果显示需要Exchange PowerShell是可访问的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，也称为 ProxyNotShell。它与 CVE-2022-41040 (SSRF) 漏洞结合使用，形成一个攻击链。攻击者首先利用 CVE-2022-41040 的 SSRF 漏洞，然后利用 CVE-2022-41082 执行任意代码。

**利用方式：**

1.  **身份验证：** 攻击者需要一个有效的 Exchange 用户凭据。这可能是通过泄露、暴力破解或其他方式获得的。
2.  **SSRF (CVE-2022-41040)：** 攻击者利用 CVE-2022-41040 的 SSRF 漏洞，向 Exchange 服务器发送精心构造的请求。 
3.  **OWASSRF + RCE (CVE-2022-41082)：**  攻击者通过构造特定的请求，利用 Outlook Web Access (OWA) 绕过 URL 重写缓解措施，从而触发远程代码执行。
4.  **代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获得服务器的完全控制权。
5.  **TabShell (CVE-2022-41076):** PoC 中包含 TabShell.ps1，这是一种权限提升漏洞，用于突破受限的 PowerShell 沙箱，进一步提升攻击者的权限。

**关于投毒风险分析：**

查看提供的代码，`poc.py` 脚本主要功能是利用`requests`库，通过发送精心构造的HTTP请求到Exchange服务器上的OWA接口实现漏洞利用。`TabShell.ps1` 则是一个 PowerShell 脚本，用于在利用漏洞获得一定权限后，尝试提权并执行命令。

风险点可能在于`cmd_file`文件的内容。如果该文件由攻击者控制，则可以包含恶意命令。此外，`TabShell.ps1` 脚本中存在执行任意 PowerShell 命令的能力，存在潜在的恶意利用风险。

由于脚本主要依赖于合法的 Exchange 功能和协议，因此直接的“投毒”可能性较低，更多的是通过命令执行来植入后门或进行其他恶意活动。风险主要来自 `cmd_file` 的内容以及 `TabShell.ps1` 中可执行任意命令的功能. `poc.py`中的 HTTP Proxy设置可能被用于流量劫持，但属于利用方使用的手段，这里不判定为投毒。

因此，评估投毒风险为 10%。 风险主要存在于利用该 PoC 进行攻击的人员。如果利用此PoC进行未授权渗透，存在后门植入等恶意行为。作者本身的投毒风险较低。

**项目地址:** [balki97/OWASSRF-CVE-2022-41082-POC](https://github.com/balki97/OWASSRF-CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #5

**来源**: [CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md](../2022/CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22 和 23，Exchange Server 2019 Cumulative Update 11 和 12（具体版本范围见漏洞库信息）

**利用条件:** 需要身份验证，但可通过 SSRF 漏洞 (CVE-2022-41040) 结合利用绕过部分身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。攻击者可以通过利用此漏洞在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞与 CVE-2022-41040（SSRF 漏洞）组合成 ProxyNotShell 攻击链，允许经过身份验证的（或借助 SSRF 绕过部分身份验证的）攻击者远程执行代码。提供的 POC 代码显示了利用该漏洞的基本流程。POC包含一个Python脚本，用于发送特制的SOAP请求到Exchange服务器的PowerShell端点，从而触发RCE。此外，POC还包含TabShell.ps1脚本，利用特权提升，绕过受限的PowerShell沙箱环境，执行任意PowerShell命令，并执行操作系统命令，例如启动计算器（calc.exe）或获取IP配置信息。cmd文件指定了要执行的命令。POC的README文件提供了使用说明。投毒风险分析：虽然POC代码本身是为了演示漏洞利用，但由于其涉及到执行任意命令，存在一定的风险。`cmd` 文件中指定了 `C:\calc.exe` 作为示例，但攻击者可以替换为任何恶意程序。`TabShell.ps1`也具有潜在的风险，尝试绕过 PowerShell 的安全限制，如果成功，可能允许攻击者在更广泛的范围内执行恶意操作。代码中未发现明显的恶意投毒代码，但是建议审查脚本执行的操作，以确保其安全性和完整性。因此，推断投毒风险为10%。利用方式：

1.  **身份验证/SSRF 绕过：** 首先需要获取 Exchange 服务器的身份验证凭据，或者利用 CVE-2022-41040 (SSRF) 等漏洞绕过身份验证。
2.  **发送恶意 SOAP 请求：** 使用 POC 提供的 Python 脚本 `poc.py`，构造包含恶意 PowerShell 命令的 SOAP 请求，并将其发送到 Exchange 服务器的 PowerShell 端点。
3.  **命令执行：** Exchange 服务器解析并执行 SOAP 请求中的 PowerShell 命令，从而在服务器上执行任意代码。
4.  **特权提升（可选）：**  使用 `TabShell.ps1` 脚本突破 PowerShell 沙箱，提升权限并执行更广泛的恶意操作。
5.  **持久化/横向移动：**  攻击者可以利用 RCE 漏洞在 Exchange 服务器上安装后门、窃取敏感信息，或者横向移动到网络中的其他系统。

**项目地址:** [bigherocenter/CVE-2022-41082-POC](https://github.com/bigherocenter/CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #6

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (versionStartIncluding: 15.00.0, versionEndExcluding: 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (versionStartIncluding: 15.0.0, versionEndExcluding: 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (versionStartIncluding: 15.01.0, versionEndExcluding: 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问, 并且需要已经过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞，与 CVE-2022-41040 (ProxyNotShell) 组合利用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，允许经过身份验证的攻击者触发 CVE-2022-41082。CVE-2022-41082 允许远程代码执行，攻击者可以通过构造特定的请求，在 Exchange 服务器上执行任意代码。 

**漏洞利用方式:**

1.  攻击者首先利用 CVE-2022-41040 (SSRF) 漏洞获取对 Exchange 服务器的访问权限。
2.  然后，攻击者使用获得的权限构造恶意请求，触发 CVE-2022-41082，从而在服务器上执行任意代码。

提供的 Nmap 脚本 (`exchange-vuln-check.nse` 和 `vuln-CVE-2022-41082.nse`) 旨在检测目标 Exchange 服务器是否存在此漏洞。它们通过发送特制的 HTTP 请求到 `/autodiscover/autodiscover.json` 端点，并检查服务器的响应来判断漏洞是否存在。如果服务器返回 `401` 状态码并包含 `X-OWA-Version` 头部，则表示服务器可能存在漏洞。

**投毒风险分析:**

代码中 `rand.random_alpha(10)` 用于生成随机字符串，以避免缓存。这个操作本身没有问题。但是，由于代码主要用于漏洞检测，如果作者在其他地方加入恶意代码，比如在发送请求时附加恶意载荷，或者在报告结果时篡改信息，就可能构成投毒。
代码中的 `description` 字段包含西班牙语，初步判断作者存在翻译痕迹，可能使用了翻译工具，虽然不会直接导致投毒，但也增加了代码审查的难度, 通过审计代码，没有发现明显的恶意行为，但是存在一定的风险，因此认定投毒风险为10%。

**项目地址:** [notareaperbutDR34P3r/http-vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/http-vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #7

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (版本 < 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (版本 < 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (版本 < 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (版本 < 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (版本 < 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问，可能需要身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索引擎结果，该漏洞通常与 CVE-2022-41040 (SSRF) 结合利用，形成 ProxyNotShell 攻击链或 OWASSRF。攻击者首先利用 CVE-2022-41040 获得对 Exchange 服务器的访问权限，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码中的 `exchange-vuln-check.nse` 脚本旨在检测目标 Exchange 服务器是否存在此漏洞，它通过发送特制的 HTTP 请求到 `autodiscover/autodiscover.json` 路径进行检测。如果服务器返回特定的 HTTP 状态码和头部信息，则表明可能存在漏洞。此代码本身主要是检测，而非直接利用 RCE。因此，投毒风险较低，主要体现在 nmap 脚本的可靠性和可能存在的误报上。但如果此脚本被用于自动化扫描，并根据扫描结果进行进一步的攻击尝试，则可能被滥用。综上，判断该仓库存在 10% 的投毒风险，主要在于误报的可能性和脚本滥用的潜在风险。

**项目地址:** [notareaperbutDR34P3r/vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #8

**来源**: [CVE-2022-41082-sikkertech_CVE-2022-41082.md](../2022/CVE-2022-41082-sikkertech_CVE-2022-41082.md)

## CVE-2022-41082 - Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本：Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 & 23, Exchange Server 2019 Cumulative Update 11 & 12。 详见漏洞库信息。

**利用条件:** 需要经过身份验证（但结合CVE-2022-41040可以绕过身份验证）。 需要能够访问Exchange PowerShell。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索结果和漏洞库信息，该漏洞与 CVE-2022-41040（服务器端请求伪造，SSRF）一起被利用，被称为 'ProxyNotShell'。攻击者首先利用 CVE-2022-41040 绕过身份验证，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码通过构造特定的 URL，如 `autodiscover/autodiscover.json@Powershell.<random>.com/owa/`，来触发漏洞。该代码尝试访问该路径，并根据服务器的响应（例如，401 Unauthorized 并且包含 X-OWA-Version 头部）来判断目标是否易受攻击。由于代码中并没有发现恶意操作，例如执行恶意命令或上传后门，因此投毒风险较低，评估为0%。

**利用方式：**
1.  **SSRF (CVE-2022-41040)：** 攻击者利用SSRF漏洞绕过身份验证，向Exchange服务器发送伪造的请求。
2.  **RCE (CVE-2022-41082)：** 在绕过身份验证后，攻击者构造特定的请求，触发Exchange PowerShell，从而执行任意代码。这通常涉及在请求中包含恶意的PowerShell命令。

**POC代码有效性评估：**
POC代码尝试通过访问特定URL并检查响应头来确定是否存在漏洞。如果服务器返回401 Unauthorized 并且包含 `X-OWA-Version` 头部，则认为目标易受攻击。这个POC代码的逻辑是合理的，可以作为漏洞检测的一种方法。但是，实际的RCE利用需要更复杂的步骤，例如上传和执行webshell。该POC仅用于检测，不包含完整的RCE利用。

**项目地址:** [sikkertech/CVE-2022-41082](https://github.com/sikkertech/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #9

**来源**: [CVE-2022-41082-soltanali0_CVE-2022-41082.md](../2022/CVE-2022-41082-soltanali0_CVE-2022-41082.md)

# CVE-2022-41082

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md](../2022/CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，攻击者可以利用此漏洞在受影响的Exchange服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 和 23, Exchange Server 2019 Cumulative Update 11 和 12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问受影响的Exchange服务器，通常通过ProxyNotShell漏洞链利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。 从搜索结果和漏洞库信息来看，该漏洞与 CVE-2022-41040 (ProxyNotShell) 经常一起被提及，表明它们可能构成一个攻击链。 从漏洞利用代码来看，攻击者发送包含特定格式的URL请求，该URL包含PowerShell相关的关键字，尝试在服务器端执行PowerShell命令， 漏洞利用代码的Request URL示例：`/autodiscover/autodiscover.json?@evil.com/owa/&Email=autodiscover/autodiscover.json%3f@evil.com&Protocol=XYZ&FooProtocol=Powershell` 。

**有效性分析：** 根据搜索结果，该漏洞已经被公开利用。 提供的POC代码展示了利用该漏洞的请求URL示例，表明该POC代码是有效的。

**投毒风险分析：** 提供的漏洞利用代码只是一个 README.md 文件，其中包含攻击事件的报告。 该文件仅描述了攻击尝试，并没有包含任何可执行的代码，因此不存在投毒风险。

**利用方式：**  利用方式通常是与ProxyNotShell漏洞（CVE-2022-41040）结合，先通过ProxyNotShell获得访问权限，然后利用CVE-2022-41082在Exchange服务器上执行任意代码。攻击者通过构造恶意的URL请求，利用Exchange服务器的 autodiscover 功能，并注入 PowerShell 代码，最终实现远程代码执行。


**项目地址:** [CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt](https://github.com/CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #2

**来源**: [CVE-2022-41082-Diverto_nse-exchange.md](../2022/CVE-2022-41082-Diverto_nse-exchange.md)

## CVE-2022-41082-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22和23，以及Exchange Server 2019 Cumulative Update 11和12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要目标Exchange服务器开放相关端口，攻击者需要一定的权限，需要Exchange PowerShell可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。根据搜索引擎结果和漏洞库信息，该漏洞与 CVE-2022-41040 (SSRF) 配合使用，被称为 ProxyNotShell。利用方式通常是首先通过 CVE-2022-41040 漏洞进行服务器端请求伪造，然后利用 CVE-2022-41082 执行任意代码。该漏洞的利用需要一定的权限，并且需要 Exchange PowerShell 可访问。

提供的漏洞利用代码是一个 Nmap NSE 脚本，用于检测目标 Exchange 服务器是否存在此漏洞的缓解措施(虚拟补丁)。它本身并不能直接执行代码，而是用于验证服务器是否容易受到攻击，根据返回结果判断是否受到虚拟补丁保护。

**有效性：**
提供的 Nmap 脚本主要用于检测虚拟补丁是否有效，并非直接的漏洞利用代码，但可以辅助判断目标是否受到漏洞影响。所以判定PoC有效。

**投毒风险：**
分析提供的代码仓库，其中包含一个 MIT 许可证、一个 README 文件和一个 Nmap NSE 脚本文件。该脚本的功能是检测目标 Exchange 服务器是否存在 CVE-2022-41082 漏洞的缓解措施。

代码本身看起来比较简单，主要使用 Nmap 的 http 库发送 HTTP 请求，并根据响应判断是否存在漏洞。没有发现明显的恶意代码或后门。但是，任何网络脚本都存在一定的风险，例如：

1.  **依赖项风险：** 脚本依赖于 Nmap 及其相关库。如果 Nmap 本身存在漏洞或被篡改，可能会影响脚本的安全性。
2.  **远程代码执行风险：** 即使脚本本身不包含恶意代码，如果它与目标系统交互的方式不安全，仍然可能导致远程代码执行。例如，如果脚本接受用户提供的 URL 作为输入，并且没有进行充分的验证，攻击者可能会利用这一点执行任意代码。
3.  **信息泄露风险：** 脚本可能会收集目标系统的敏感信息，例如 Exchange 服务器的版本号、配置信息等。如果这些信息被泄露，可能会被攻击者利用。

综合考虑以上因素，我将投毒风险评估为 10%。

**利用方式：**
1.  首先，攻击者利用 CVE-2022-41040 漏洞进行服务器端请求伪造，通过构造恶意的请求，绕过身份验证。
2.  然后，攻击者利用 CVE-2022-41082 漏洞，结合 Exchange PowerShell，执行任意代码，从而控制服务器。
3.  提供的 Nmap 脚本可以用来检测服务器是否已经应用了缓解措施，从而判断是否可以进行漏洞利用。

**项目地址:** [Diverto/nse-exchange](https://github.com/Diverto/nse-exchange)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #3

**来源**: [CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md](../2022/CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许远程代码执行，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013 Cumulative Update 23、2016 Cumulative Update 22 and 23, 以及 2019 Cumulative Update 11 and 12，具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问 Exchange PowerShell 或者利用 SSRF 漏洞 (CVE-2022-41040) 配合利用。根据搜索结果，通常需要身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，该漏洞通常与 CVE-2022-41040 (ProxyNotShell) 结合使用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，攻击者利用它来触发 CVE-2022-41082。利用方式通常涉及构造特定的 HTTP 请求发送到 Exchange 服务器，从而执行任意代码。提供的 YAML 格式的 PoC 代码主要用于检测漏洞是否存在。它尝试访问 `/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/` 路径，并检查服务器的响应状态码是否为 401 (未经授权)以及响应头中是否包含 `x-owa-version`。如果同时满足这两个条件，则可能存在此漏洞。关于投毒风险，PoC 本身主要目的是验证漏洞是否存在，但仍然存在一定的风险，例如，如果利用代码被修改为在服务器上执行恶意操作，或者被用来扫描大量目标服务器，可能会对网络造成一定的影响。PoC 验证阶段，不应该被认为是投毒行为。基于提供的 PoC 代码，其中使用了随机字符串 `{{randstr}}`，表明其主要目的是探测漏洞是否存在，而不是执行具体的恶意操作。因此，可以评估投毒风险较低，但是考虑到任何代码都可能被滥用或修改，仍然存在潜在风险。搜索结果也表明该漏洞被积极利用，需要及时修补。尽管 YAML 文件本身没有看到直接执行恶意操作的代码，但不能完全排除编写者或使用者后续添加恶意代码的可能性。所以评估投毒风险为 10%。

**项目地址:** [SUPRAAA-1337/CVE-2022-41082](https://github.com/SUPRAAA-1337/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #4

**来源**: [CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md](../2022/CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md)

## CVE-2022-41082 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange 2013, 2016, 2019 在2022年11月8日补丁之前的版本，具体版本参见CVE信息

**利用条件:** 需要有效的Exchange用户凭据以及OWA(Outlook Web Access)访问权限，通常与CVE-2022-41040 (SSRF) 配合使用, 搜索引擎结果显示需要Exchange PowerShell是可访问的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，也称为 ProxyNotShell。它与 CVE-2022-41040 (SSRF) 漏洞结合使用，形成一个攻击链。攻击者首先利用 CVE-2022-41040 的 SSRF 漏洞，然后利用 CVE-2022-41082 执行任意代码。

**利用方式：**

1.  **身份验证：** 攻击者需要一个有效的 Exchange 用户凭据。这可能是通过泄露、暴力破解或其他方式获得的。
2.  **SSRF (CVE-2022-41040)：** 攻击者利用 CVE-2022-41040 的 SSRF 漏洞，向 Exchange 服务器发送精心构造的请求。 
3.  **OWASSRF + RCE (CVE-2022-41082)：**  攻击者通过构造特定的请求，利用 Outlook Web Access (OWA) 绕过 URL 重写缓解措施，从而触发远程代码执行。
4.  **代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获得服务器的完全控制权。
5.  **TabShell (CVE-2022-41076):** PoC 中包含 TabShell.ps1，这是一种权限提升漏洞，用于突破受限的 PowerShell 沙箱，进一步提升攻击者的权限。

**关于投毒风险分析：**

查看提供的代码，`poc.py` 脚本主要功能是利用`requests`库，通过发送精心构造的HTTP请求到Exchange服务器上的OWA接口实现漏洞利用。`TabShell.ps1` 则是一个 PowerShell 脚本，用于在利用漏洞获得一定权限后，尝试提权并执行命令。

风险点可能在于`cmd_file`文件的内容。如果该文件由攻击者控制，则可以包含恶意命令。此外，`TabShell.ps1` 脚本中存在执行任意 PowerShell 命令的能力，存在潜在的恶意利用风险。

由于脚本主要依赖于合法的 Exchange 功能和协议，因此直接的“投毒”可能性较低，更多的是通过命令执行来植入后门或进行其他恶意活动。风险主要来自 `cmd_file` 的内容以及 `TabShell.ps1` 中可执行任意命令的功能. `poc.py`中的 HTTP Proxy设置可能被用于流量劫持，但属于利用方使用的手段，这里不判定为投毒。

因此，评估投毒风险为 10%。 风险主要存在于利用该 PoC 进行攻击的人员。如果利用此PoC进行未授权渗透，存在后门植入等恶意行为。作者本身的投毒风险较低。

**项目地址:** [balki97/OWASSRF-CVE-2022-41082-POC](https://github.com/balki97/OWASSRF-CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #5

**来源**: [CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md](../2022/CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22 和 23，Exchange Server 2019 Cumulative Update 11 和 12（具体版本范围见漏洞库信息）

**利用条件:** 需要身份验证，但可通过 SSRF 漏洞 (CVE-2022-41040) 结合利用绕过部分身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。攻击者可以通过利用此漏洞在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞与 CVE-2022-41040（SSRF 漏洞）组合成 ProxyNotShell 攻击链，允许经过身份验证的（或借助 SSRF 绕过部分身份验证的）攻击者远程执行代码。提供的 POC 代码显示了利用该漏洞的基本流程。POC包含一个Python脚本，用于发送特制的SOAP请求到Exchange服务器的PowerShell端点，从而触发RCE。此外，POC还包含TabShell.ps1脚本，利用特权提升，绕过受限的PowerShell沙箱环境，执行任意PowerShell命令，并执行操作系统命令，例如启动计算器（calc.exe）或获取IP配置信息。cmd文件指定了要执行的命令。POC的README文件提供了使用说明。投毒风险分析：虽然POC代码本身是为了演示漏洞利用，但由于其涉及到执行任意命令，存在一定的风险。`cmd` 文件中指定了 `C:\calc.exe` 作为示例，但攻击者可以替换为任何恶意程序。`TabShell.ps1`也具有潜在的风险，尝试绕过 PowerShell 的安全限制，如果成功，可能允许攻击者在更广泛的范围内执行恶意操作。代码中未发现明显的恶意投毒代码，但是建议审查脚本执行的操作，以确保其安全性和完整性。因此，推断投毒风险为10%。利用方式：

1.  **身份验证/SSRF 绕过：** 首先需要获取 Exchange 服务器的身份验证凭据，或者利用 CVE-2022-41040 (SSRF) 等漏洞绕过身份验证。
2.  **发送恶意 SOAP 请求：** 使用 POC 提供的 Python 脚本 `poc.py`，构造包含恶意 PowerShell 命令的 SOAP 请求，并将其发送到 Exchange 服务器的 PowerShell 端点。
3.  **命令执行：** Exchange 服务器解析并执行 SOAP 请求中的 PowerShell 命令，从而在服务器上执行任意代码。
4.  **特权提升（可选）：**  使用 `TabShell.ps1` 脚本突破 PowerShell 沙箱，提升权限并执行更广泛的恶意操作。
5.  **持久化/横向移动：**  攻击者可以利用 RCE 漏洞在 Exchange 服务器上安装后门、窃取敏感信息，或者横向移动到网络中的其他系统。

**项目地址:** [bigherocenter/CVE-2022-41082-POC](https://github.com/bigherocenter/CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #6

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (versionStartIncluding: 15.00.0, versionEndExcluding: 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (versionStartIncluding: 15.0.0, versionEndExcluding: 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (versionStartIncluding: 15.01.0, versionEndExcluding: 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问, 并且需要已经过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞，与 CVE-2022-41040 (ProxyNotShell) 组合利用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，允许经过身份验证的攻击者触发 CVE-2022-41082。CVE-2022-41082 允许远程代码执行，攻击者可以通过构造特定的请求，在 Exchange 服务器上执行任意代码。 

**漏洞利用方式:**

1.  攻击者首先利用 CVE-2022-41040 (SSRF) 漏洞获取对 Exchange 服务器的访问权限。
2.  然后，攻击者使用获得的权限构造恶意请求，触发 CVE-2022-41082，从而在服务器上执行任意代码。

提供的 Nmap 脚本 (`exchange-vuln-check.nse` 和 `vuln-CVE-2022-41082.nse`) 旨在检测目标 Exchange 服务器是否存在此漏洞。它们通过发送特制的 HTTP 请求到 `/autodiscover/autodiscover.json` 端点，并检查服务器的响应来判断漏洞是否存在。如果服务器返回 `401` 状态码并包含 `X-OWA-Version` 头部，则表示服务器可能存在漏洞。

**投毒风险分析:**

代码中 `rand.random_alpha(10)` 用于生成随机字符串，以避免缓存。这个操作本身没有问题。但是，由于代码主要用于漏洞检测，如果作者在其他地方加入恶意代码，比如在发送请求时附加恶意载荷，或者在报告结果时篡改信息，就可能构成投毒。
代码中的 `description` 字段包含西班牙语，初步判断作者存在翻译痕迹，可能使用了翻译工具，虽然不会直接导致投毒，但也增加了代码审查的难度, 通过审计代码，没有发现明显的恶意行为，但是存在一定的风险，因此认定投毒风险为10%。

**项目地址:** [notareaperbutDR34P3r/http-vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/http-vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #7

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (版本 < 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (版本 < 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (版本 < 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (版本 < 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (版本 < 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问，可能需要身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索引擎结果，该漏洞通常与 CVE-2022-41040 (SSRF) 结合利用，形成 ProxyNotShell 攻击链或 OWASSRF。攻击者首先利用 CVE-2022-41040 获得对 Exchange 服务器的访问权限，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码中的 `exchange-vuln-check.nse` 脚本旨在检测目标 Exchange 服务器是否存在此漏洞，它通过发送特制的 HTTP 请求到 `autodiscover/autodiscover.json` 路径进行检测。如果服务器返回特定的 HTTP 状态码和头部信息，则表明可能存在漏洞。此代码本身主要是检测，而非直接利用 RCE。因此，投毒风险较低，主要体现在 nmap 脚本的可靠性和可能存在的误报上。但如果此脚本被用于自动化扫描，并根据扫描结果进行进一步的攻击尝试，则可能被滥用。综上，判断该仓库存在 10% 的投毒风险，主要在于误报的可能性和脚本滥用的潜在风险。

**项目地址:** [notareaperbutDR34P3r/vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #8

**来源**: [CVE-2022-41082-sikkertech_CVE-2022-41082.md](../2022/CVE-2022-41082-sikkertech_CVE-2022-41082.md)

## CVE-2022-41082 - Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本：Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 & 23, Exchange Server 2019 Cumulative Update 11 & 12。 详见漏洞库信息。

**利用条件:** 需要经过身份验证（但结合CVE-2022-41040可以绕过身份验证）。 需要能够访问Exchange PowerShell。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索结果和漏洞库信息，该漏洞与 CVE-2022-41040（服务器端请求伪造，SSRF）一起被利用，被称为 'ProxyNotShell'。攻击者首先利用 CVE-2022-41040 绕过身份验证，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码通过构造特定的 URL，如 `autodiscover/autodiscover.json@Powershell.<random>.com/owa/`，来触发漏洞。该代码尝试访问该路径，并根据服务器的响应（例如，401 Unauthorized 并且包含 X-OWA-Version 头部）来判断目标是否易受攻击。由于代码中并没有发现恶意操作，例如执行恶意命令或上传后门，因此投毒风险较低，评估为0%。

**利用方式：**
1.  **SSRF (CVE-2022-41040)：** 攻击者利用SSRF漏洞绕过身份验证，向Exchange服务器发送伪造的请求。
2.  **RCE (CVE-2022-41082)：** 在绕过身份验证后，攻击者构造特定的请求，触发Exchange PowerShell，从而执行任意代码。这通常涉及在请求中包含恶意的PowerShell命令。

**POC代码有效性评估：**
POC代码尝试通过访问特定URL并检查响应头来确定是否存在漏洞。如果服务器返回401 Unauthorized 并且包含 `X-OWA-Version` 头部，则认为目标易受攻击。这个POC代码的逻辑是合理的，可以作为漏洞检测的一种方法。但是，实际的RCE利用需要更复杂的步骤，例如上传和执行webshell。该POC仅用于检测，不包含完整的RCE利用。

**项目地址:** [sikkertech/CVE-2022-41082](https://github.com/sikkertech/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #9

**来源**: [CVE-2022-41082-soltanali0_CVE-2022-41082.md](../2022/CVE-2022-41082-soltanali0_CVE-2022-41082.md)

# CVE-2022-41082

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md](../2022/CVE-2022-41082-CyprianAtsyor_LetsDefend-CVE-2022-41082-Exploitation-Attempt.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，攻击者可以利用此漏洞在受影响的Exchange服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 和 23, Exchange Server 2019 Cumulative Update 11 和 12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问受影响的Exchange服务器，通常通过ProxyNotShell漏洞链利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。 从搜索结果和漏洞库信息来看，该漏洞与 CVE-2022-41040 (ProxyNotShell) 经常一起被提及，表明它们可能构成一个攻击链。 从漏洞利用代码来看，攻击者发送包含特定格式的URL请求，该URL包含PowerShell相关的关键字，尝试在服务器端执行PowerShell命令， 漏洞利用代码的Request URL示例：`/autodiscover/autodiscover.json?@evil.com/owa/&Email=autodiscover/autodiscover.json%3f@evil.com&Protocol=XYZ&FooProtocol=Powershell` 。

**有效性分析：** 根据搜索结果，该漏洞已经被公开利用。 提供的POC代码展示了利用该漏洞的请求URL示例，表明该POC代码是有效的。

**投毒风险分析：** 提供的漏洞利用代码只是一个 README.md 文件，其中包含攻击事件的报告。 该文件仅描述了攻击尝试，并没有包含任何可执行的代码，因此不存在投毒风险。

**利用方式：**  利用方式通常是与ProxyNotShell漏洞（CVE-2022-41040）结合，先通过ProxyNotShell获得访问权限，然后利用CVE-2022-41082在Exchange服务器上执行任意代码。攻击者通过构造恶意的URL请求，利用Exchange服务器的 autodiscover 功能，并注入 PowerShell 代码，最终实现远程代码执行。


**项目地址:** [CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt](https://github.com/CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #2

**来源**: [CVE-2022-41082-Diverto_nse-exchange.md](../2022/CVE-2022-41082-Diverto_nse-exchange.md)

## CVE-2022-41082-Microsoft Exchange Server-RCE

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22和23，以及Exchange Server 2019 Cumulative Update 11和12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要目标Exchange服务器开放相关端口，攻击者需要一定的权限，需要Exchange PowerShell可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。根据搜索引擎结果和漏洞库信息，该漏洞与 CVE-2022-41040 (SSRF) 配合使用，被称为 ProxyNotShell。利用方式通常是首先通过 CVE-2022-41040 漏洞进行服务器端请求伪造，然后利用 CVE-2022-41082 执行任意代码。该漏洞的利用需要一定的权限，并且需要 Exchange PowerShell 可访问。

提供的漏洞利用代码是一个 Nmap NSE 脚本，用于检测目标 Exchange 服务器是否存在此漏洞的缓解措施(虚拟补丁)。它本身并不能直接执行代码，而是用于验证服务器是否容易受到攻击，根据返回结果判断是否受到虚拟补丁保护。

**有效性：**
提供的 Nmap 脚本主要用于检测虚拟补丁是否有效，并非直接的漏洞利用代码，但可以辅助判断目标是否受到漏洞影响。所以判定PoC有效。

**投毒风险：**
分析提供的代码仓库，其中包含一个 MIT 许可证、一个 README 文件和一个 Nmap NSE 脚本文件。该脚本的功能是检测目标 Exchange 服务器是否存在 CVE-2022-41082 漏洞的缓解措施。

代码本身看起来比较简单，主要使用 Nmap 的 http 库发送 HTTP 请求，并根据响应判断是否存在漏洞。没有发现明显的恶意代码或后门。但是，任何网络脚本都存在一定的风险，例如：

1.  **依赖项风险：** 脚本依赖于 Nmap 及其相关库。如果 Nmap 本身存在漏洞或被篡改，可能会影响脚本的安全性。
2.  **远程代码执行风险：** 即使脚本本身不包含恶意代码，如果它与目标系统交互的方式不安全，仍然可能导致远程代码执行。例如，如果脚本接受用户提供的 URL 作为输入，并且没有进行充分的验证，攻击者可能会利用这一点执行任意代码。
3.  **信息泄露风险：** 脚本可能会收集目标系统的敏感信息，例如 Exchange 服务器的版本号、配置信息等。如果这些信息被泄露，可能会被攻击者利用。

综合考虑以上因素，我将投毒风险评估为 10%。

**利用方式：**
1.  首先，攻击者利用 CVE-2022-41040 漏洞进行服务器端请求伪造，通过构造恶意的请求，绕过身份验证。
2.  然后，攻击者利用 CVE-2022-41082 漏洞，结合 Exchange PowerShell，执行任意代码，从而控制服务器。
3.  提供的 Nmap 脚本可以用来检测服务器是否已经应用了缓解措施，从而判断是否可以进行漏洞利用。

**项目地址:** [Diverto/nse-exchange](https://github.com/Diverto/nse-exchange)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #3

**来源**: [CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md](../2022/CVE-2022-41082-SUPRAAA-1337_CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许远程代码执行，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013 Cumulative Update 23、2016 Cumulative Update 22 and 23, 以及 2019 Cumulative Update 11 and 12，具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问 Exchange PowerShell 或者利用 SSRF 漏洞 (CVE-2022-41040) 配合利用。根据搜索结果，通常需要身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，该漏洞通常与 CVE-2022-41040 (ProxyNotShell) 结合使用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，攻击者利用它来触发 CVE-2022-41082。利用方式通常涉及构造特定的 HTTP 请求发送到 Exchange 服务器，从而执行任意代码。提供的 YAML 格式的 PoC 代码主要用于检测漏洞是否存在。它尝试访问 `/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/` 路径，并检查服务器的响应状态码是否为 401 (未经授权)以及响应头中是否包含 `x-owa-version`。如果同时满足这两个条件，则可能存在此漏洞。关于投毒风险，PoC 本身主要目的是验证漏洞是否存在，但仍然存在一定的风险，例如，如果利用代码被修改为在服务器上执行恶意操作，或者被用来扫描大量目标服务器，可能会对网络造成一定的影响。PoC 验证阶段，不应该被认为是投毒行为。基于提供的 PoC 代码，其中使用了随机字符串 `{{randstr}}`，表明其主要目的是探测漏洞是否存在，而不是执行具体的恶意操作。因此，可以评估投毒风险较低，但是考虑到任何代码都可能被滥用或修改，仍然存在潜在风险。搜索结果也表明该漏洞被积极利用，需要及时修补。尽管 YAML 文件本身没有看到直接执行恶意操作的代码，但不能完全排除编写者或使用者后续添加恶意代码的可能性。所以评估投毒风险为 10%。

**项目地址:** [SUPRAAA-1337/CVE-2022-41082](https://github.com/SUPRAAA-1337/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #4

**来源**: [CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md](../2022/CVE-2022-41082-balki97_OWASSRF-CVE-2022-41082-POC.md)

## CVE-2022-41082 - Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange 2013, 2016, 2019 在2022年11月8日补丁之前的版本，具体版本参见CVE信息

**利用条件:** 需要有效的Exchange用户凭据以及OWA(Outlook Web Access)访问权限，通常与CVE-2022-41040 (SSRF) 配合使用, 搜索引擎结果显示需要Exchange PowerShell是可访问的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，也称为 ProxyNotShell。它与 CVE-2022-41040 (SSRF) 漏洞结合使用，形成一个攻击链。攻击者首先利用 CVE-2022-41040 的 SSRF 漏洞，然后利用 CVE-2022-41082 执行任意代码。

**利用方式：**

1.  **身份验证：** 攻击者需要一个有效的 Exchange 用户凭据。这可能是通过泄露、暴力破解或其他方式获得的。
2.  **SSRF (CVE-2022-41040)：** 攻击者利用 CVE-2022-41040 的 SSRF 漏洞，向 Exchange 服务器发送精心构造的请求。 
3.  **OWASSRF + RCE (CVE-2022-41082)：**  攻击者通过构造特定的请求，利用 Outlook Web Access (OWA) 绕过 URL 重写缓解措施，从而触发远程代码执行。
4.  **代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，获得服务器的完全控制权。
5.  **TabShell (CVE-2022-41076):** PoC 中包含 TabShell.ps1，这是一种权限提升漏洞，用于突破受限的 PowerShell 沙箱，进一步提升攻击者的权限。

**关于投毒风险分析：**

查看提供的代码，`poc.py` 脚本主要功能是利用`requests`库，通过发送精心构造的HTTP请求到Exchange服务器上的OWA接口实现漏洞利用。`TabShell.ps1` 则是一个 PowerShell 脚本，用于在利用漏洞获得一定权限后，尝试提权并执行命令。

风险点可能在于`cmd_file`文件的内容。如果该文件由攻击者控制，则可以包含恶意命令。此外，`TabShell.ps1` 脚本中存在执行任意 PowerShell 命令的能力，存在潜在的恶意利用风险。

由于脚本主要依赖于合法的 Exchange 功能和协议，因此直接的“投毒”可能性较低，更多的是通过命令执行来植入后门或进行其他恶意活动。风险主要来自 `cmd_file` 的内容以及 `TabShell.ps1` 中可执行任意命令的功能. `poc.py`中的 HTTP Proxy设置可能被用于流量劫持，但属于利用方使用的手段，这里不判定为投毒。

因此，评估投毒风险为 10%。 风险主要存在于利用该 PoC 进行攻击的人员。如果利用此PoC进行未授权渗透，存在后门植入等恶意行为。作者本身的投毒风险较低。

**项目地址:** [balki97/OWASSRF-CVE-2022-41082-POC](https://github.com/balki97/OWASSRF-CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #5

**来源**: [CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md](../2022/CVE-2022-41082-bigherocenter_CVE-2022-41082-POC.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Exchange Server 2013 Cumulative Update 23，Exchange Server 2016 Cumulative Update 22 和 23，Exchange Server 2019 Cumulative Update 11 和 12（具体版本范围见漏洞库信息）

**利用条件:** 需要身份验证，但可通过 SSRF 漏洞 (CVE-2022-41040) 结合利用绕过部分身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。攻击者可以通过利用此漏洞在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞与 CVE-2022-41040（SSRF 漏洞）组合成 ProxyNotShell 攻击链，允许经过身份验证的（或借助 SSRF 绕过部分身份验证的）攻击者远程执行代码。提供的 POC 代码显示了利用该漏洞的基本流程。POC包含一个Python脚本，用于发送特制的SOAP请求到Exchange服务器的PowerShell端点，从而触发RCE。此外，POC还包含TabShell.ps1脚本，利用特权提升，绕过受限的PowerShell沙箱环境，执行任意PowerShell命令，并执行操作系统命令，例如启动计算器（calc.exe）或获取IP配置信息。cmd文件指定了要执行的命令。POC的README文件提供了使用说明。投毒风险分析：虽然POC代码本身是为了演示漏洞利用，但由于其涉及到执行任意命令，存在一定的风险。`cmd` 文件中指定了 `C:\calc.exe` 作为示例，但攻击者可以替换为任何恶意程序。`TabShell.ps1`也具有潜在的风险，尝试绕过 PowerShell 的安全限制，如果成功，可能允许攻击者在更广泛的范围内执行恶意操作。代码中未发现明显的恶意投毒代码，但是建议审查脚本执行的操作，以确保其安全性和完整性。因此，推断投毒风险为10%。利用方式：

1.  **身份验证/SSRF 绕过：** 首先需要获取 Exchange 服务器的身份验证凭据，或者利用 CVE-2022-41040 (SSRF) 等漏洞绕过身份验证。
2.  **发送恶意 SOAP 请求：** 使用 POC 提供的 Python 脚本 `poc.py`，构造包含恶意 PowerShell 命令的 SOAP 请求，并将其发送到 Exchange 服务器的 PowerShell 端点。
3.  **命令执行：** Exchange 服务器解析并执行 SOAP 请求中的 PowerShell 命令，从而在服务器上执行任意代码。
4.  **特权提升（可选）：**  使用 `TabShell.ps1` 脚本突破 PowerShell 沙箱，提升权限并执行更广泛的恶意操作。
5.  **持久化/横向移动：**  攻击者可以利用 RCE 漏洞在 Exchange 服务器上安装后门、窃取敏感信息，或者横向移动到网络中的其他系统。

**项目地址:** [bigherocenter/CVE-2022-41082-POC](https://github.com/bigherocenter/CVE-2022-41082-POC)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #6

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_http-vuln-CVE-2022-41082.md)

## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (versionStartIncluding: 15.00.0, versionEndExcluding: 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (versionStartIncluding: 15.0.0, versionEndExcluding: 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (versionStartIncluding: 15.02.0, versionEndExcluding: 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (versionStartIncluding: 15.01.0, versionEndExcluding: 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问, 并且需要已经过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞，与 CVE-2022-41040 (ProxyNotShell) 组合利用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，允许经过身份验证的攻击者触发 CVE-2022-41082。CVE-2022-41082 允许远程代码执行，攻击者可以通过构造特定的请求，在 Exchange 服务器上执行任意代码。 

**漏洞利用方式:**

1.  攻击者首先利用 CVE-2022-41040 (SSRF) 漏洞获取对 Exchange 服务器的访问权限。
2.  然后，攻击者使用获得的权限构造恶意请求，触发 CVE-2022-41082，从而在服务器上执行任意代码。

提供的 Nmap 脚本 (`exchange-vuln-check.nse` 和 `vuln-CVE-2022-41082.nse`) 旨在检测目标 Exchange 服务器是否存在此漏洞。它们通过发送特制的 HTTP 请求到 `/autodiscover/autodiscover.json` 端点，并检查服务器的响应来判断漏洞是否存在。如果服务器返回 `401` 状态码并包含 `X-OWA-Version` 头部，则表示服务器可能存在漏洞。

**投毒风险分析:**

代码中 `rand.random_alpha(10)` 用于生成随机字符串，以避免缓存。这个操作本身没有问题。但是，由于代码主要用于漏洞检测，如果作者在其他地方加入恶意代码，比如在发送请求时附加恶意载荷，或者在报告结果时篡改信息，就可能构成投毒。
代码中的 `description` 字段包含西班牙语，初步判断作者存在翻译痕迹，可能使用了翻译工具，虽然不会直接导致投毒，但也增加了代码审查的难度, 通过审计代码，没有发现明显的恶意行为，但是存在一定的风险，因此认定投毒风险为10%。

**项目地址:** [notareaperbutDR34P3r/http-vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/http-vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #7

**来源**: [CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md](../2022/CVE-2022-41082-notareaperbutDR34P3r_vuln-CVE-2022-41082.md)

## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (版本 < 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (版本 < 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (版本 < 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (版本 < 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (版本 < 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问，可能需要身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索引擎结果，该漏洞通常与 CVE-2022-41040 (SSRF) 结合利用，形成 ProxyNotShell 攻击链或 OWASSRF。攻击者首先利用 CVE-2022-41040 获得对 Exchange 服务器的访问权限，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码中的 `exchange-vuln-check.nse` 脚本旨在检测目标 Exchange 服务器是否存在此漏洞，它通过发送特制的 HTTP 请求到 `autodiscover/autodiscover.json` 路径进行检测。如果服务器返回特定的 HTTP 状态码和头部信息，则表明可能存在漏洞。此代码本身主要是检测，而非直接利用 RCE。因此，投毒风险较低，主要体现在 nmap 脚本的可靠性和可能存在的误报上。但如果此脚本被用于自动化扫描，并根据扫描结果进行进一步的攻击尝试，则可能被滥用。综上，判断该仓库存在 10% 的投毒风险，主要在于误报的可能性和脚本滥用的潜在风险。

**项目地址:** [notareaperbutDR34P3r/vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---

## POC #8

**来源**: [CVE-2022-41082-sikkertech_CVE-2022-41082.md](../2022/CVE-2022-41082-sikkertech_CVE-2022-41082.md)

## CVE-2022-41082 - Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本：Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 & 23, Exchange Server 2019 Cumulative Update 11 & 12。 详见漏洞库信息。

**利用条件:** 需要经过身份验证（但结合CVE-2022-41040可以绕过身份验证）。 需要能够访问Exchange PowerShell。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索结果和漏洞库信息，该漏洞与 CVE-2022-41040（服务器端请求伪造，SSRF）一起被利用，被称为 'ProxyNotShell'。攻击者首先利用 CVE-2022-41040 绕过身份验证，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码通过构造特定的 URL，如 `autodiscover/autodiscover.json@Powershell.<random>.com/owa/`，来触发漏洞。该代码尝试访问该路径，并根据服务器的响应（例如，401 Unauthorized 并且包含 X-OWA-Version 头部）来判断目标是否易受攻击。由于代码中并没有发现恶意操作，例如执行恶意命令或上传后门，因此投毒风险较低，评估为0%。

**利用方式：**
1.  **SSRF (CVE-2022-41040)：** 攻击者利用SSRF漏洞绕过身份验证，向Exchange服务器发送伪造的请求。
2.  **RCE (CVE-2022-41082)：** 在绕过身份验证后，攻击者构造特定的请求，触发Exchange PowerShell，从而执行任意代码。这通常涉及在请求中包含恶意的PowerShell命令。

**POC代码有效性评估：**
POC代码尝试通过访问特定URL并检查响应头来确定是否存在漏洞。如果服务器返回401 Unauthorized 并且包含 `X-OWA-Version` 头部，则认为目标易受攻击。这个POC代码的逻辑是合理的，可以作为漏洞检测的一种方法。但是，实际的RCE利用需要更复杂的步骤，例如上传和执行webshell。该POC仅用于检测，不包含完整的RCE利用。

**项目地址:** [sikkertech/CVE-2022-41082](https://github.com/sikkertech/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)

---



---



---



---

