# CVE-2022-46604

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604 - Responsive FileManager RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç™»å½•æƒé™ï¼Œä¸”æ–‡ä»¶ç®¡ç†å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Tecrail Responsive FileManager v9.9.5 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„ PHP æ–‡ä»¶ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ 'copy_cut' å’Œ 'paste_clipboard' ä¸¤ä¸ªåŠŸèƒ½å®ç°çš„ã€‚é¦–å…ˆï¼Œåˆ©ç”¨ 'copy_cut' åŠŸèƒ½å°†åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç„¶ååˆ©ç”¨ 'paste_clipboard' åŠŸèƒ½å°†å‰ªè´´æ¿çš„å†…å®¹ç²˜è´´åˆ°æœåŠ¡å™¨ä¸Šã€‚ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ å¹¶æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢ç»“æœä¸­æ˜ç¡®æŒ‡å‡ºå­˜åœ¨é’ˆå¯¹æ­¤æ¼æ´çš„åˆ©ç”¨ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒGitHub é“¾æ¥ï¼‰ï¼Œå¹¶ä¸”æ¼æ´åˆ©ç”¨ä»£ç ä¹Ÿå®ç°äº†æ–‡ä»¶ä¸Šä¼ å’Œè¿œç¨‹ä»£ç æ‰§è¡Œçš„é€»è¾‘ã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
1.  è‡ªåŠ¨è·å–PHPSESSID cookieï¼Œè‹¥å¤±è´¥åˆ™å…è®¸æ‰‹åŠ¨è¾“å…¥ã€‚
2.  ä½¿ç”¨`copy_cut`å‡½æ•°ï¼Œå°è¯•å°†ç›®æ ‡æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç›®æ ‡æ–‡ä»¶é€šè¿‡ç›®å½•ç©¿è¶Š`../../../../../../..` æ„é€ ã€‚
3.  ä½¿ç”¨`paste_clipboard`å‡½æ•°ï¼Œå°†æ–‡ä»¶ä»å‰ªè´´æ¿ç²˜è´´åˆ°ç›®æ ‡è·¯å¾„ã€‚
4.  ä½¿ç”¨`read_file`å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºã€‚

æŠ•æ¯’é£é™©åˆ†æï¼š
*   ä»£ç é€»è¾‘è¾ƒä¸ºæ¸…æ™°ï¼Œä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨ç›®å½•ç©¿è¶Šæ¼æ´è¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä»ä»£ç æœ¬èº«æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹ shell æˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰æ“ä½œã€‚
*   ä¸»è¦çš„é£é™©åœ¨äºç›®å½•ç©¿è¶Šçš„æ·±åº¦æ˜¯å¦è¶³å¤Ÿï¼Œå¦‚æœç›®å½•ç»“æ„å¤æ‚ï¼Œå¯èƒ½æ— æ³•æˆåŠŸè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­éšè—äº†å…¶ä»–çš„æ¼æ´åˆ©ç”¨æ–¹å¼æˆ–è€…åé—¨ï¼Œä¾‹å¦‚é€šè¿‡ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹æ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä½†è¿™éœ€è¦è¿›ä¸€æ­¥çš„åˆ†ææ‰èƒ½ç¡®å®šã€‚

ç»¼åˆæ¥çœ‹ï¼Œä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥æºäºå¯¹æ¼æ´åˆ©ç”¨çš„æ·±å…¥ç ”ç©¶å’Œæ½œåœ¨çš„åé—¨ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦é¦–å…ˆå…·æœ‰ç™»å½• Responsive FileManager çš„æƒé™ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ PHP æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…ä½¿ç”¨æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œé¦–å…ˆé€šè¿‡ copy_cut å‡½æ•°ï¼Œåˆ©ç”¨ç›®å½•ç©¿è¶Šå°†æ¶æ„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚
4.  æ”»å‡»è€…éšåä½¿ç”¨ paste_clipboard å‡½æ•°å°†æ–‡ä»¶ç²˜è´´åˆ°æœåŠ¡å™¨çš„æŸä¸ªç›®å½•ã€‚
5.  ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ ã€‚
6.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„æ¶æ„ PHP æ–‡ä»¶ï¼Œæ‰§è¡Œå…¶ä¸­çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager](https://github.com/CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #2

**æ¥æº**: [CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604-Responsive FileManager-RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ(RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èº«ä»½éªŒè¯ï¼ˆä½æƒé™ç”¨æˆ·å³å¯ï¼‰ä»¥åŠä¸Šä¼ æ–‡ä»¶çš„æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-46604æ˜¯Tecrail Responsive FileManager 9.9.5åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ–‡ä»¶æ‰©å±•åç»•è¿‡æ¼æ´ï¼Œå…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„æ”»å‡»è€…ä¸Šä¼ æ¶æ„PHPæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯exploit-db.comï¼‰ä»¥åŠGitHubä¸Šçš„POCä»“åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„POCä»£ç `/tmp/5cdc81c8c181540e8e03c8f4d97ce816/README.md`æœ¬èº«å¹¶æ²¡æœ‰åŒ…å«åˆ©ç”¨ä»£ç ï¼Œåªæ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŒ‡ç¤ºæ¼æ´çš„åˆ©ç”¨å·²ç»å­˜åœ¨å…¬å¼€çš„PoCã€‚å› æ­¤ï¼Œéœ€è¦æŸ¥æ‰¾å…¶ä»–çš„PoCä»£ç ï¼Œä¾‹å¦‚githubä¸Š **galoget/ResponsiveFileManager-CVE-2022-46604** æä¾›çš„Python3 è„šæœ¬ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„é£é™©åœ¨äºæ¼æ´æœ¬èº«çš„åˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ç›®å‰æä¾›çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŠ•æ¯’é£é™©å¾ˆä½ï¼Œçº¦10%ã€‚ä½†éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

*   å¦‚æœä¸‹è½½å’Œä½¿ç”¨äº†å…¶ä»–æ¥æºçš„POCä»£ç ï¼ˆä¾‹å¦‚GitHubä¸Šçš„è„šæœ¬ï¼‰ï¼Œéœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œé˜²æ­¢å…¶ä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellã€æ·»åŠ åé—¨ç­‰ã€‚
*   æ”»å‡»è€…å¯èƒ½ä¼šä¼ªé€ POCï¼Œè¯±éª—ç”¨æˆ·ä¸‹è½½åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **èº«ä»½éªŒè¯ï¼š** æ”»å‡»è€…éœ€è¦å…ˆé€šè¿‡èº«ä»½éªŒè¯ï¼Œè·å¾—ä¸Šä¼ æ–‡ä»¶çš„æƒé™ï¼Œè¯¥æƒé™è¦æ±‚ä¸é«˜ï¼Œä½æƒé™ç”¨æˆ·å³å¯åˆ©ç”¨ã€‚
2.  **æ–‡ä»¶æ‰©å±•åç»•è¿‡ï¼š** æ”»å‡»è€…åˆ©ç”¨æ–‡ä»¶æ‰©å±•åç»•è¿‡æœºåˆ¶ï¼Œä¸Šä¼ ä¸€ä¸ªåŒ…å«æ¶æ„PHPä»£ç çš„æ–‡ä»¶ã€‚å¸¸è§çš„ç»•è¿‡æ–¹æ³•åŒ…æ‹¬ï¼š
    *   ä½¿ç”¨åŒæ‰©å±•åï¼ˆä¾‹å¦‚ï¼š`evil.php.jpg`ï¼‰ã€‚
    *   ä¿®æ”¹Content-Typeå¤´ã€‚
    *   åˆ©ç”¨æ–‡ä»¶åä¸­çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ã€‚
3.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** ä¸Šä¼ çš„PHPæ–‡ä»¶è¢«æœåŠ¡å™¨è§£ææ‰§è¡Œï¼Œæ”»å‡»è€…ä»è€Œå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager](https://github.com/SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #3

**æ¥æº**: [CVE-2022-46604-galoget_ResponsiveFileManager-CVE-2022-46604.md](../2022/CVE-2022-46604-galoget_ResponsiveFileManager-CVE-2022-46604.md)

# CVE-2022-46604

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604 - Responsive FileManager RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç™»å½•æƒé™ï¼Œä¸”æ–‡ä»¶ç®¡ç†å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Tecrail Responsive FileManager v9.9.5 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„ PHP æ–‡ä»¶ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ 'copy_cut' å’Œ 'paste_clipboard' ä¸¤ä¸ªåŠŸèƒ½å®ç°çš„ã€‚é¦–å…ˆï¼Œåˆ©ç”¨ 'copy_cut' åŠŸèƒ½å°†åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç„¶ååˆ©ç”¨ 'paste_clipboard' åŠŸèƒ½å°†å‰ªè´´æ¿çš„å†…å®¹ç²˜è´´åˆ°æœåŠ¡å™¨ä¸Šã€‚ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ å¹¶æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢ç»“æœä¸­æ˜ç¡®æŒ‡å‡ºå­˜åœ¨é’ˆå¯¹æ­¤æ¼æ´çš„åˆ©ç”¨ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒGitHub é“¾æ¥ï¼‰ï¼Œå¹¶ä¸”æ¼æ´åˆ©ç”¨ä»£ç ä¹Ÿå®ç°äº†æ–‡ä»¶ä¸Šä¼ å’Œè¿œç¨‹ä»£ç æ‰§è¡Œçš„é€»è¾‘ã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
1.  è‡ªåŠ¨è·å–PHPSESSID cookieï¼Œè‹¥å¤±è´¥åˆ™å…è®¸æ‰‹åŠ¨è¾“å…¥ã€‚
2.  ä½¿ç”¨`copy_cut`å‡½æ•°ï¼Œå°è¯•å°†ç›®æ ‡æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç›®æ ‡æ–‡ä»¶é€šè¿‡ç›®å½•ç©¿è¶Š`../../../../../../..` æ„é€ ã€‚
3.  ä½¿ç”¨`paste_clipboard`å‡½æ•°ï¼Œå°†æ–‡ä»¶ä»å‰ªè´´æ¿ç²˜è´´åˆ°ç›®æ ‡è·¯å¾„ã€‚
4.  ä½¿ç”¨`read_file`å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºã€‚

æŠ•æ¯’é£é™©åˆ†æï¼š
*   ä»£ç é€»è¾‘è¾ƒä¸ºæ¸…æ™°ï¼Œä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨ç›®å½•ç©¿è¶Šæ¼æ´è¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä»ä»£ç æœ¬èº«æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹ shell æˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰æ“ä½œã€‚
*   ä¸»è¦çš„é£é™©åœ¨äºç›®å½•ç©¿è¶Šçš„æ·±åº¦æ˜¯å¦è¶³å¤Ÿï¼Œå¦‚æœç›®å½•ç»“æ„å¤æ‚ï¼Œå¯èƒ½æ— æ³•æˆåŠŸè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­éšè—äº†å…¶ä»–çš„æ¼æ´åˆ©ç”¨æ–¹å¼æˆ–è€…åé—¨ï¼Œä¾‹å¦‚é€šè¿‡ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹æ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä½†è¿™éœ€è¦è¿›ä¸€æ­¥çš„åˆ†ææ‰èƒ½ç¡®å®šã€‚

ç»¼åˆæ¥çœ‹ï¼Œä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥æºäºå¯¹æ¼æ´åˆ©ç”¨çš„æ·±å…¥ç ”ç©¶å’Œæ½œåœ¨çš„åé—¨ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦é¦–å…ˆå…·æœ‰ç™»å½• Responsive FileManager çš„æƒé™ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ PHP æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…ä½¿ç”¨æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œé¦–å…ˆé€šè¿‡ copy_cut å‡½æ•°ï¼Œåˆ©ç”¨ç›®å½•ç©¿è¶Šå°†æ¶æ„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚
4.  æ”»å‡»è€…éšåä½¿ç”¨ paste_clipboard å‡½æ•°å°†æ–‡ä»¶ç²˜è´´åˆ°æœåŠ¡å™¨çš„æŸä¸ªç›®å½•ã€‚
5.  ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ ã€‚
6.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„æ¶æ„ PHP æ–‡ä»¶ï¼Œæ‰§è¡Œå…¶ä¸­çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager](https://github.com/CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #2

**æ¥æº**: [CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604-Responsive FileManager-RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ(RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èº«ä»½éªŒè¯ï¼ˆä½æƒé™ç”¨æˆ·å³å¯ï¼‰ä»¥åŠä¸Šä¼ æ–‡ä»¶çš„æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-46604æ˜¯Tecrail Responsive FileManager 9.9.5åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ–‡ä»¶æ‰©å±•åç»•è¿‡æ¼æ´ï¼Œå…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„æ”»å‡»è€…ä¸Šä¼ æ¶æ„PHPæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯exploit-db.comï¼‰ä»¥åŠGitHubä¸Šçš„POCä»“åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„POCä»£ç `/tmp/5cdc81c8c181540e8e03c8f4d97ce816/README.md`æœ¬èº«å¹¶æ²¡æœ‰åŒ…å«åˆ©ç”¨ä»£ç ï¼Œåªæ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŒ‡ç¤ºæ¼æ´çš„åˆ©ç”¨å·²ç»å­˜åœ¨å…¬å¼€çš„PoCã€‚å› æ­¤ï¼Œéœ€è¦æŸ¥æ‰¾å…¶ä»–çš„PoCä»£ç ï¼Œä¾‹å¦‚githubä¸Š **galoget/ResponsiveFileManager-CVE-2022-46604** æä¾›çš„Python3 è„šæœ¬ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„é£é™©åœ¨äºæ¼æ´æœ¬èº«çš„åˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ç›®å‰æä¾›çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŠ•æ¯’é£é™©å¾ˆä½ï¼Œçº¦10%ã€‚ä½†éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

*   å¦‚æœä¸‹è½½å’Œä½¿ç”¨äº†å…¶ä»–æ¥æºçš„POCä»£ç ï¼ˆä¾‹å¦‚GitHubä¸Šçš„è„šæœ¬ï¼‰ï¼Œéœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œé˜²æ­¢å…¶ä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellã€æ·»åŠ åé—¨ç­‰ã€‚
*   æ”»å‡»è€…å¯èƒ½ä¼šä¼ªé€ POCï¼Œè¯±éª—ç”¨æˆ·ä¸‹è½½åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **èº«ä»½éªŒè¯ï¼š** æ”»å‡»è€…éœ€è¦å…ˆé€šè¿‡èº«ä»½éªŒè¯ï¼Œè·å¾—ä¸Šä¼ æ–‡ä»¶çš„æƒé™ï¼Œè¯¥æƒé™è¦æ±‚ä¸é«˜ï¼Œä½æƒé™ç”¨æˆ·å³å¯åˆ©ç”¨ã€‚
2.  **æ–‡ä»¶æ‰©å±•åç»•è¿‡ï¼š** æ”»å‡»è€…åˆ©ç”¨æ–‡ä»¶æ‰©å±•åç»•è¿‡æœºåˆ¶ï¼Œä¸Šä¼ ä¸€ä¸ªåŒ…å«æ¶æ„PHPä»£ç çš„æ–‡ä»¶ã€‚å¸¸è§çš„ç»•è¿‡æ–¹æ³•åŒ…æ‹¬ï¼š
    *   ä½¿ç”¨åŒæ‰©å±•åï¼ˆä¾‹å¦‚ï¼š`evil.php.jpg`ï¼‰ã€‚
    *   ä¿®æ”¹Content-Typeå¤´ã€‚
    *   åˆ©ç”¨æ–‡ä»¶åä¸­çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ã€‚
3.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** ä¸Šä¼ çš„PHPæ–‡ä»¶è¢«æœåŠ¡å™¨è§£ææ‰§è¡Œï¼Œæ”»å‡»è€…ä»è€Œå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager](https://github.com/SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #3

**æ¥æº**: [CVE-2022-46604-galoget_ResponsiveFileManager-CVE-2022-46604.md](../2022/CVE-2022-46604-galoget_ResponsiveFileManager-CVE-2022-46604.md)

# CVE-2022-46604

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604 - Responsive FileManager RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç™»å½•æƒé™ï¼Œä¸”æ–‡ä»¶ç®¡ç†å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Tecrail Responsive FileManager v9.9.5 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„ PHP æ–‡ä»¶ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ 'copy_cut' å’Œ 'paste_clipboard' ä¸¤ä¸ªåŠŸèƒ½å®ç°çš„ã€‚é¦–å…ˆï¼Œåˆ©ç”¨ 'copy_cut' åŠŸèƒ½å°†åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç„¶ååˆ©ç”¨ 'paste_clipboard' åŠŸèƒ½å°†å‰ªè´´æ¿çš„å†…å®¹ç²˜è´´åˆ°æœåŠ¡å™¨ä¸Šã€‚ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ å¹¶æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢ç»“æœä¸­æ˜ç¡®æŒ‡å‡ºå­˜åœ¨é’ˆå¯¹æ­¤æ¼æ´çš„åˆ©ç”¨ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒGitHub é“¾æ¥ï¼‰ï¼Œå¹¶ä¸”æ¼æ´åˆ©ç”¨ä»£ç ä¹Ÿå®ç°äº†æ–‡ä»¶ä¸Šä¼ å’Œè¿œç¨‹ä»£ç æ‰§è¡Œçš„é€»è¾‘ã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
1.  è‡ªåŠ¨è·å–PHPSESSID cookieï¼Œè‹¥å¤±è´¥åˆ™å…è®¸æ‰‹åŠ¨è¾“å…¥ã€‚
2.  ä½¿ç”¨`copy_cut`å‡½æ•°ï¼Œå°è¯•å°†ç›®æ ‡æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç›®æ ‡æ–‡ä»¶é€šè¿‡ç›®å½•ç©¿è¶Š`../../../../../../..` æ„é€ ã€‚
3.  ä½¿ç”¨`paste_clipboard`å‡½æ•°ï¼Œå°†æ–‡ä»¶ä»å‰ªè´´æ¿ç²˜è´´åˆ°ç›®æ ‡è·¯å¾„ã€‚
4.  ä½¿ç”¨`read_file`å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºã€‚

æŠ•æ¯’é£é™©åˆ†æï¼š
*   ä»£ç é€»è¾‘è¾ƒä¸ºæ¸…æ™°ï¼Œä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨ç›®å½•ç©¿è¶Šæ¼æ´è¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä»ä»£ç æœ¬èº«æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹ shell æˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰æ“ä½œã€‚
*   ä¸»è¦çš„é£é™©åœ¨äºç›®å½•ç©¿è¶Šçš„æ·±åº¦æ˜¯å¦è¶³å¤Ÿï¼Œå¦‚æœç›®å½•ç»“æ„å¤æ‚ï¼Œå¯èƒ½æ— æ³•æˆåŠŸè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­éšè—äº†å…¶ä»–çš„æ¼æ´åˆ©ç”¨æ–¹å¼æˆ–è€…åé—¨ï¼Œä¾‹å¦‚é€šè¿‡ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹æ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä½†è¿™éœ€è¦è¿›ä¸€æ­¥çš„åˆ†ææ‰èƒ½ç¡®å®šã€‚

ç»¼åˆæ¥çœ‹ï¼Œä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥æºäºå¯¹æ¼æ´åˆ©ç”¨çš„æ·±å…¥ç ”ç©¶å’Œæ½œåœ¨çš„åé—¨ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦é¦–å…ˆå…·æœ‰ç™»å½• Responsive FileManager çš„æƒé™ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ PHP æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…ä½¿ç”¨æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œé¦–å…ˆé€šè¿‡ copy_cut å‡½æ•°ï¼Œåˆ©ç”¨ç›®å½•ç©¿è¶Šå°†æ¶æ„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚
4.  æ”»å‡»è€…éšåä½¿ç”¨ paste_clipboard å‡½æ•°å°†æ–‡ä»¶ç²˜è´´åˆ°æœåŠ¡å™¨çš„æŸä¸ªç›®å½•ã€‚
5.  ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ ã€‚
6.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„æ¶æ„ PHP æ–‡ä»¶ï¼Œæ‰§è¡Œå…¶ä¸­çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager](https://github.com/CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #2

**æ¥æº**: [CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604-Responsive FileManager-RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ(RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èº«ä»½éªŒè¯ï¼ˆä½æƒé™ç”¨æˆ·å³å¯ï¼‰ä»¥åŠä¸Šä¼ æ–‡ä»¶çš„æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-46604æ˜¯Tecrail Responsive FileManager 9.9.5åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ–‡ä»¶æ‰©å±•åç»•è¿‡æ¼æ´ï¼Œå…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„æ”»å‡»è€…ä¸Šä¼ æ¶æ„PHPæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯exploit-db.comï¼‰ä»¥åŠGitHubä¸Šçš„POCä»“åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„POCä»£ç `/tmp/5cdc81c8c181540e8e03c8f4d97ce816/README.md`æœ¬èº«å¹¶æ²¡æœ‰åŒ…å«åˆ©ç”¨ä»£ç ï¼Œåªæ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŒ‡ç¤ºæ¼æ´çš„åˆ©ç”¨å·²ç»å­˜åœ¨å…¬å¼€çš„PoCã€‚å› æ­¤ï¼Œéœ€è¦æŸ¥æ‰¾å…¶ä»–çš„PoCä»£ç ï¼Œä¾‹å¦‚githubä¸Š **galoget/ResponsiveFileManager-CVE-2022-46604** æä¾›çš„Python3 è„šæœ¬ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„é£é™©åœ¨äºæ¼æ´æœ¬èº«çš„åˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ç›®å‰æä¾›çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŠ•æ¯’é£é™©å¾ˆä½ï¼Œçº¦10%ã€‚ä½†éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

*   å¦‚æœä¸‹è½½å’Œä½¿ç”¨äº†å…¶ä»–æ¥æºçš„POCä»£ç ï¼ˆä¾‹å¦‚GitHubä¸Šçš„è„šæœ¬ï¼‰ï¼Œéœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œé˜²æ­¢å…¶ä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellã€æ·»åŠ åé—¨ç­‰ã€‚
*   æ”»å‡»è€…å¯èƒ½ä¼šä¼ªé€ POCï¼Œè¯±éª—ç”¨æˆ·ä¸‹è½½åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **èº«ä»½éªŒè¯ï¼š** æ”»å‡»è€…éœ€è¦å…ˆé€šè¿‡èº«ä»½éªŒè¯ï¼Œè·å¾—ä¸Šä¼ æ–‡ä»¶çš„æƒé™ï¼Œè¯¥æƒé™è¦æ±‚ä¸é«˜ï¼Œä½æƒé™ç”¨æˆ·å³å¯åˆ©ç”¨ã€‚
2.  **æ–‡ä»¶æ‰©å±•åç»•è¿‡ï¼š** æ”»å‡»è€…åˆ©ç”¨æ–‡ä»¶æ‰©å±•åç»•è¿‡æœºåˆ¶ï¼Œä¸Šä¼ ä¸€ä¸ªåŒ…å«æ¶æ„PHPä»£ç çš„æ–‡ä»¶ã€‚å¸¸è§çš„ç»•è¿‡æ–¹æ³•åŒ…æ‹¬ï¼š
    *   ä½¿ç”¨åŒæ‰©å±•åï¼ˆä¾‹å¦‚ï¼š`evil.php.jpg`ï¼‰ã€‚
    *   ä¿®æ”¹Content-Typeå¤´ã€‚
    *   åˆ©ç”¨æ–‡ä»¶åä¸­çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ã€‚
3.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** ä¸Šä¼ çš„PHPæ–‡ä»¶è¢«æœåŠ¡å™¨è§£ææ‰§è¡Œï¼Œæ”»å‡»è€…ä»è€Œå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager](https://github.com/SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #3

**æ¥æº**: [CVE-2022-46604-galoget_ResponsiveFileManager-CVE-2022-46604.md](../2022/CVE-2022-46604-galoget_ResponsiveFileManager-CVE-2022-46604.md)

# CVE-2022-46604

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-CyberQuestor-infosec_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604 - Responsive FileManager RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç™»å½•æƒé™ï¼Œä¸”æ–‡ä»¶ç®¡ç†å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Tecrail Responsive FileManager v9.9.5 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„ PHP æ–‡ä»¶ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ 'copy_cut' å’Œ 'paste_clipboard' ä¸¤ä¸ªåŠŸèƒ½å®ç°çš„ã€‚é¦–å…ˆï¼Œåˆ©ç”¨ 'copy_cut' åŠŸèƒ½å°†åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç„¶ååˆ©ç”¨ 'paste_clipboard' åŠŸèƒ½å°†å‰ªè´´æ¿çš„å†…å®¹ç²˜è´´åˆ°æœåŠ¡å™¨ä¸Šã€‚ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ å¹¶æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢ç»“æœä¸­æ˜ç¡®æŒ‡å‡ºå­˜åœ¨é’ˆå¯¹æ­¤æ¼æ´çš„åˆ©ç”¨ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒGitHub é“¾æ¥ï¼‰ï¼Œå¹¶ä¸”æ¼æ´åˆ©ç”¨ä»£ç ä¹Ÿå®ç°äº†æ–‡ä»¶ä¸Šä¼ å’Œè¿œç¨‹ä»£ç æ‰§è¡Œçš„é€»è¾‘ã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
1.  è‡ªåŠ¨è·å–PHPSESSID cookieï¼Œè‹¥å¤±è´¥åˆ™å…è®¸æ‰‹åŠ¨è¾“å…¥ã€‚
2.  ä½¿ç”¨`copy_cut`å‡½æ•°ï¼Œå°è¯•å°†ç›®æ ‡æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç›®æ ‡æ–‡ä»¶é€šè¿‡ç›®å½•ç©¿è¶Š`../../../../../../..` æ„é€ ã€‚
3.  ä½¿ç”¨`paste_clipboard`å‡½æ•°ï¼Œå°†æ–‡ä»¶ä»å‰ªè´´æ¿ç²˜è´´åˆ°ç›®æ ‡è·¯å¾„ã€‚
4.  ä½¿ç”¨`read_file`å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºã€‚

æŠ•æ¯’é£é™©åˆ†æï¼š
*   ä»£ç é€»è¾‘è¾ƒä¸ºæ¸…æ™°ï¼Œä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨ç›®å½•ç©¿è¶Šæ¼æ´è¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä»ä»£ç æœ¬èº«æ¥çœ‹ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹ shell æˆ–ä¸‹è½½æ‰§è¡Œæ¶æ„ç¨‹åºç­‰æ“ä½œã€‚
*   ä¸»è¦çš„é£é™©åœ¨äºç›®å½•ç©¿è¶Šçš„æ·±åº¦æ˜¯å¦è¶³å¤Ÿï¼Œå¦‚æœç›®å½•ç»“æ„å¤æ‚ï¼Œå¯èƒ½æ— æ³•æˆåŠŸè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚
*   ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­éšè—äº†å…¶ä»–çš„æ¼æ´åˆ©ç”¨æ–¹å¼æˆ–è€…åé—¨ï¼Œä¾‹å¦‚é€šè¿‡ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹æ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä½†è¿™éœ€è¦è¿›ä¸€æ­¥çš„åˆ†ææ‰èƒ½ç¡®å®šã€‚

ç»¼åˆæ¥çœ‹ï¼Œä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥æºäºå¯¹æ¼æ´åˆ©ç”¨çš„æ·±å…¥ç ”ç©¶å’Œæ½œåœ¨çš„åé—¨ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦é¦–å…ˆå…·æœ‰ç™»å½• Responsive FileManager çš„æƒé™ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ PHP æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…ä½¿ç”¨æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œé¦–å…ˆé€šè¿‡ copy_cut å‡½æ•°ï¼Œåˆ©ç”¨ç›®å½•ç©¿è¶Šå°†æ¶æ„æ–‡ä»¶å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚
4.  æ”»å‡»è€…éšåä½¿ç”¨ paste_clipboard å‡½æ•°å°†æ–‡ä»¶ç²˜è´´åˆ°æœåŠ¡å™¨çš„æŸä¸ªç›®å½•ã€‚
5.  ç”±äºæ–‡ä»¶æ‰©å±•åæ£€æŸ¥æœºåˆ¶å­˜åœ¨ç¼ºé™·ï¼Œæ¶æ„ PHP æ–‡ä»¶å¯ä»¥æˆåŠŸä¸Šä¼ ã€‚
6.  æ”»å‡»è€…é€šè¿‡è®¿é—®ä¸Šä¼ çš„æ¶æ„ PHP æ–‡ä»¶ï¼Œæ‰§è¡Œå…¶ä¸­çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager](https://github.com/CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---

## POC #2

**æ¥æº**: [CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md](../2022/CVE-2022-46604-SakshiVelampudi_CVE-2022-46604-Responsive-File-Manager.md)

## CVE-2022-46604-Responsive FileManager-RCE

**æ¼æ´ç¼–å·:** CVE-2022-46604

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ(RCE)

**å½±å“åº”ç”¨:** Responsive FileManager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 9.9.5

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èº«ä»½éªŒè¯ï¼ˆä½æƒé™ç”¨æˆ·å³å¯ï¼‰ä»¥åŠä¸Šä¼ æ–‡ä»¶çš„æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-46604æ˜¯Tecrail Responsive FileManager 9.9.5åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ–‡ä»¶æ‰©å±•åç»•è¿‡æ¼æ´ï¼Œå…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„æ”»å‡»è€…ä¸Šä¼ æ¶æ„PHPæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯exploit-db.comï¼‰ä»¥åŠGitHubä¸Šçš„POCä»“åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

æä¾›çš„POCä»£ç `/tmp/5cdc81c8c181540e8e03c8f4d97ce816/README.md`æœ¬èº«å¹¶æ²¡æœ‰åŒ…å«åˆ©ç”¨ä»£ç ï¼Œåªæ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŒ‡ç¤ºæ¼æ´çš„åˆ©ç”¨å·²ç»å­˜åœ¨å…¬å¼€çš„PoCã€‚å› æ­¤ï¼Œéœ€è¦æŸ¥æ‰¾å…¶ä»–çš„PoCä»£ç ï¼Œä¾‹å¦‚githubä¸Š **galoget/ResponsiveFileManager-CVE-2022-46604** æä¾›çš„Python3 è„šæœ¬ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„é£é™©åœ¨äºæ¼æ´æœ¬èº«çš„åˆ©ç”¨ï¼Œä½†ä»ç„¶å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ç›®å‰æä¾›çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªREADMEæ–‡ä»¶ï¼ŒæŠ•æ¯’é£é™©å¾ˆä½ï¼Œçº¦10%ã€‚ä½†éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

*   å¦‚æœä¸‹è½½å’Œä½¿ç”¨äº†å…¶ä»–æ¥æºçš„POCä»£ç ï¼ˆä¾‹å¦‚GitHubä¸Šçš„è„šæœ¬ï¼‰ï¼Œéœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œé˜²æ­¢å…¶ä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellã€æ·»åŠ åé—¨ç­‰ã€‚
*   æ”»å‡»è€…å¯èƒ½ä¼šä¼ªé€ POCï¼Œè¯±éª—ç”¨æˆ·ä¸‹è½½åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **èº«ä»½éªŒè¯ï¼š** æ”»å‡»è€…éœ€è¦å…ˆé€šè¿‡èº«ä»½éªŒè¯ï¼Œè·å¾—ä¸Šä¼ æ–‡ä»¶çš„æƒé™ï¼Œè¯¥æƒé™è¦æ±‚ä¸é«˜ï¼Œä½æƒé™ç”¨æˆ·å³å¯åˆ©ç”¨ã€‚
2.  **æ–‡ä»¶æ‰©å±•åç»•è¿‡ï¼š** æ”»å‡»è€…åˆ©ç”¨æ–‡ä»¶æ‰©å±•åç»•è¿‡æœºåˆ¶ï¼Œä¸Šä¼ ä¸€ä¸ªåŒ…å«æ¶æ„PHPä»£ç çš„æ–‡ä»¶ã€‚å¸¸è§çš„ç»•è¿‡æ–¹æ³•åŒ…æ‹¬ï¼š
    *   ä½¿ç”¨åŒæ‰©å±•åï¼ˆä¾‹å¦‚ï¼š`evil.php.jpg`ï¼‰ã€‚
    *   ä¿®æ”¹Content-Typeå¤´ã€‚
    *   åˆ©ç”¨æ–‡ä»¶åä¸­çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ã€‚
3.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** ä¸Šä¼ çš„PHPæ–‡ä»¶è¢«æœåŠ¡å™¨è§£ææ‰§è¡Œï¼Œæ”»å‡»è€…ä»è€Œå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager](https://github.com/SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)

---



---



---



---

