# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md](../2022/CVE-2022-0492-Trinadh465_device_renesas_kernel_AOSP10_r33_CVE-2022-0492.md)

# CVE-2022-0492

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md](../2022/CVE-2022-0492-PaloAltoNetworks_can-ctr-escape-cve-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (可能影响其他版本)

**利用条件:** 需要cgroups v1, 容器环境，CAP_SYS_ADMIN能力或用户命名空间支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 存在于 Linux 内核的 `cgroup_release_agent_write` 函数中。攻击者可以利用 cgroups v1 的 release_agent 特性来提升权限并绕过命名空间隔离，从而实现容器逃逸。根据漏洞库信息和搜索结果，这是一个高危漏洞。提供的POC代码（`can-ctr-escape-cve-2022-0492.sh`）是一个检测脚本，用于判断容器环境是否容易受到此漏洞的影响，而非直接的攻击代码。它首先创建测试目录，然后尝试挂载 cgroup 并检查 `release_agent` 文件是否可写。如果容器具有 `CAP_SYS_ADMIN` 且没有 AppArmor 或 SELinux 的保护，则认为该容器容易受到攻击，但这不一定需要CVE-2022-0492来利用，而可以通过其他方式利用CAP_SYS_ADMIN实现逃逸。或者，如果容器可以利用用户命名空间进行逃逸，也会标记为易受攻击。脚本最后删除测试目录。因此，POC代码的目的是检测漏洞的存在，而不是利用它进行攻击，所以不存在直接的投毒风险。漏洞利用方式是：1. 创建一个 cgroup; 2. 设置 `release_agent` 为攻击者可控的脚本路径; 3. 触发 cgroup 的 release 操作，导致内核执行攻击者设置的脚本，从而提升权限或者逃逸容器。由于POC仅为检查脚本，故投毒风险为0%。

**项目地址:** [PaloAltoNetworks/can-ctr-escape-cve-2022-0492](https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #2

**来源**: [CVE-2022-0492-Perimora_cve_2022_0492.md](../2022/CVE-2022-0492-Perimora_cve_2022_0492.md)

## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #3

**来源**: [CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md](../2022/CVE-2022-0492-SofianeHamlaoui_CVE-2022-0492-Checker.md)

## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #4

**来源**: [CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md](../2022/CVE-2022-0492-T1erno_CVE-2022-0492-Docker-Breakout-Checker-and-PoC.md)

## CVE-2022-0492-Linux Kernel cgroup_release_agent 特权提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸，控制宿主机

**影响版本:** kernel 5.17 rc3 (受影响范围可能更广，需要检查)

**利用条件:** 容器需要CAP_SYS_ADMIN capabilities 或者存在可利用的user namespaces配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492 漏洞存在于 Linux kernel 的 `cgroup_release_agent_write` 函数中。攻击者可以利用此漏洞，通过操纵 cgroups v1 的 `release_agent` 特性，实现权限提升和绕过命名空间隔离，最终实现容器逃逸，控制宿主机。

**漏洞利用有效性:**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可供利用。从提供的PoC脚本 `CVE-2022-0492.sh` 来看，脚本首先检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以利用 user namespaces。如果满足其中一个条件，则脚本会尝试利用该漏洞。脚本通过挂载 cgroup 文件系统，设置 `release_agent` 路径指向一个恶意脚本，并在 cgroup 被释放时执行该脚本，从而在宿主机上执行任意命令。

**投毒风险分析:**

分析提供的PoC代码，存在一定投毒风险，占比约为10%。风险主要集中在以下几点：

*   **`payload` 变量的灵活性:**  脚本允许用户通过 `-c` 或 `--command` 参数自定义 `payload`，这使得攻击者可以方便地执行任意命令。虽然这本身是漏洞利用的一部分，但也可能被滥用，例如植入恶意后门、挖矿程序等。
*   **`exploit` 函数中的命令执行:** 脚本会生成 `/tmp/exploit.sh` 文件并执行，这个过程中，脚本会对宿主机的文件系统进行修改，存在潜在的风险。虽然脚本的目的是为了利用漏洞，但也可能被修改为执行恶意操作。
*   **检查方式的绕过:** PoC脚本只检查了 CAP_SYS_ADMIN 和 User Namespace，实际利用过程中可能存在其他方式可以触发漏洞，导致PoC成功执行，但宿主机实际上并没有受到保护。容易给使用者带来不安全感。

**利用方式:**

1.  **环境准备:** 首先，需要在存在漏洞的 Linux kernel 的容器环境中运行 PoC 脚本。
2.  **权限检查:** 脚本会检查容器是否具有 `CAP_SYS_ADMIN` 权限，或者是否可以创建和挂载 user namespaces。
3.  **漏洞利用:** 如果满足条件，脚本会创建 cgroup，设置 `release_agent` 指向一个可执行文件（`cmd`）。该可执行文件包含攻击者希望在宿主机上执行的命令（通过 `-c` 或 `--command` 指定）。
4.  **触发漏洞:** 通过向 cgroup 中写入进程 ID，然后释放 cgroup，可以触发 `release_agent` 的执行，从而在宿主机上执行任意命令，实现容器逃逸。
5.  **命令执行:** 成功利用漏洞后，攻击者可以在宿主机上执行任意命令，例如获取 root 权限，读取敏感信息，或进行其他恶意操作。

**项目地址:** [T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC](https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #5

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #6

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---



---

## POC #6

**来源**: [CVE-2022-0492-bb33bb_CVE-2022-0492.md](../2022/CVE-2022-0492-bb33bb_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel cgroup release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和容器逃逸

**影响版本:** <= kernel 5.17 rc3

**利用条件:** 需要存在cgroups v1且release_agent可写

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中(kernel/cgroup/cgroup-v1.c)。此漏洞允许在特定情况下使用 cgroups v1 的 release_agent 功能提升权限并绕过命名空间隔离。

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的漏洞利用代码。搜索结果表明，该漏洞可用于容器逃逸和权限提升。

**投毒风险：**
提供的漏洞利用代码片段是 GNU 通用公共许可证的文本，不是漏洞利用代码本身。仅为许可协议。 因此，无法直接分析其是否存在投毒代码，可以判断投毒风险为0%。

**利用方式：**
漏洞利用的核心在于利用 cgroups v1 的 `release_agent` 功能。
1.  **cgroups v1:**  该漏洞依赖于cgroups v1版本，较新的系统中可能默认使用cgroups v2，因此需要确认环境是否支持cgroups v1.
2.  **release_agent:**  `release_agent` 是一个可以配置的路径，当 cgroup 中的进程退出时，内核会执行该路径指向的程序。通常情况下，这个路径指向一个受限的辅助程序。
3.  **权限提升：**  攻击者可以通过以下步骤利用此漏洞：
    *   创建一个新的 cgroup。
    *   将 `release_agent` 设置为一个攻击者可控的脚本或程序。由于在存在漏洞的情况下，即使非特权用户也可以写入`release_agent`，因此这是一个关键步骤。
    *   触发 cgroup 的进程退出事件。这可以通过杀死 cgroup 中的进程来实现。
    *   当 cgroup 中的进程退出时，内核会以 root 权限执行攻击者设置的 `release_agent`，从而实现权限提升。
    *   攻击者可以通过这个root权限执行任意命令，例如容器逃逸。

**总结：**
CVE-2022-0492 是一个高危的 Linux 内核漏洞，攻击者利用此漏洞可以实现权限提升和容器逃逸。需要及时更新内核或采取缓解措施。

**项目地址:** [bb33bb/CVE-2022-0492](https://github.com/bb33bb/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #7

**来源**: [CVE-2022-0492-chenaotian_CVE-2022-0492.md](../2022/CVE-2022-0492-chenaotian_CVE-2022-0492.md)

## CVE-2022-0492-Linux Kernel-cgroup release_agent 权限提升/容器逃逸

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** <= 5.17-rc3

**利用条件:** 容器需要以root权限运行，并且没有开启严格的安全措施（seccomp禁用unshare，apparmor开启cgroup只读，selinux开启）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Linux内核的cgroup子系统的`cgroup_release_agent_write`函数中。由于访问控制缺失，攻击者可以修改cgroup的release_agent，导致在cgroup中最后一个进程退出时，执行攻击者指定的文件，从而实现权限提升或容器逃逸。

**利用方式：**

1.  **环境准备：** 准备一个存在漏洞的Linux内核版本的环境，例如使用Docker容器。
2.  **获取Root权限：** 确保在容器内拥有root权限。
3.  **检查安全措施：** 确认容器没有开启严格的安全措施，例如seccomp、apparmor和selinux。如果seccomp禁用了`unshare`，或者apparmor开启了cgroup只读，则需要绕过这些限制。
4.  **挂载cgroup文件系统：** 将cgroup文件系统挂载到一个目录，例如`/tmp/testcgroup`。
5.  **创建cgroup子节点：** 在挂载的cgroup目录下创建一个子目录，例如`/tmp/testcgroup/x`。
6.  **修改release_agent：** 修改`release_agent`文件，将其设置为一个攻击者可控的脚本路径，例如`/cmd`。该脚本将在容器逃逸时被执行。
7.  **设置notify_on_release：** 将`notify_on_release`设置为1，表示当cgroup中最后一个进程退出时，执行`release_agent`指定的脚本。
8.  **创建恶意脚本：** 创建一个恶意脚本，例如`/cmd`，该脚本将在宿主机上执行恶意操作，例如反弹shell或执行其他命令。
9.  **触发漏洞：** 退出cgroup中的所有进程，触发`release_agent`执行，从而实现容器逃逸。

**投毒风险分析：**

该POC代码主要包含环境搭建和漏洞利用的步骤，本身没有明显的投毒代码。

1.  README.md文件仅包含漏洞原理、利用条件和利用方式的描述。
2.  用于漏洞利用的脚本`/cmd`由用户手动创建，攻击者可以完全控制其内容。
3.  代码中没有发现任何隐藏的后门或恶意代码。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险较低，但是用户仍然应该仔细审查和理解代码，避免执行未知的操作。 总体投毒风险估计为1%。

**项目地址:** [chenaotian/CVE-2022-0492](https://github.com/chenaotian/CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

## POC #8

**来源**: [CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md](../2022/CVE-2022-0492-yoeelingBin_CVE-2022-0492-Container-Escape.md)

## CVE-2022-0492-Linux内核cgroups v1 release_agent权限提升漏洞

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和主机权限提升

**影响版本:** kernel 5.17 rc3 (受影响版本可能更广泛，需具体环境测试)

**利用条件:** 需要开启cgroups v1功能，且容器内需要一定的权限，例如CAP_SYS_ADMIN或通过unshare命令获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0492漏洞存在于Linux内核的cgroup v1实现中，具体位于`kernel/cgroup/cgroup-v1.c`文件的`cgroup_release_agent_write`函数。该漏洞允许攻击者利用`release_agent`特性来提升权限和绕过命名空间隔离。PoC代码通过以下步骤利用该漏洞：

1.  **创建cgroup目录:** 在`/tmp/cgrp`目录下创建一个新的cgroup目录。
2.  **启用release_agent:** 设置`notify_on_release`为1，启用`release_agent`功能。
3.  **查找容器在宿主机上的文件系统路径:** 通过读取`/etc/mtab`文件，找到容器的文件系统在宿主机上的路径。
4.  **写入release_agent:** 将一个指向宿主机文件系统上的脚本的路径写入`release_agent`文件中。这个脚本将在cgroup被释放时执行。
5.  **写入恶意脚本:** 将包含恶意命令的脚本写入到宿主机的文件系统上。
6.  **触发release_agent:** 将当前进程的PID写入`cgroup.procs`文件，然后触发cgroup释放，从而执行`release_agent`指向的脚本。
7. **权限检查与获取:** 如果当前进程没有`CAP_SYS_ADMIN`权限，PoC会尝试使用`unshare`命令创建一个新的用户、挂载和Cgroup命名空间，以获得必要的权限。

**有效性：** 根据漏洞描述和PoC代码分析，该漏洞利用方式是有效的，可以实现容器逃逸和权限提升。漏洞库信息、搜索引擎结果均指向该漏洞可被利用进行权限提升。

**投毒风险：** 评估为10%。该PoC代码的风险在于执行任意命令，本身不包含明显的恶意Payload，但用户可以自定义`cmd`参数，执行任意命令，存在一定的风险。例如，攻击者可能在传入的`cmd`参数中添加反弹shell、下载恶意文件等操作。代码虽然引用了外部链接，但是主要为参考链接，本身未发现混淆和隐藏的后门代码。

**利用方式总结：** 攻击者利用cgroup v1的`release_agent`特性，通过修改`release_agent`文件指向一个位于宿主机上的恶意脚本，当cgroup被释放时，该脚本将以root权限执行，从而实现容器逃逸和权限提升。该漏洞利用依赖于cgroup v1的启用和一定的容器权限。

**项目地址:** [yoeelingBin/CVE-2022-0492-Container-Escape](https://github.com/yoeelingBin/CVE-2022-0492-Container-Escape)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)

---

