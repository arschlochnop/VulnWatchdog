# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

# CVE-2022-40684

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-40684-Anthony1500_CVE-2022-40684.md](../2022/CVE-2022-40684-Anthony1500_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标Fortinet设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**漏洞利用有效性：**
根据提供的漏洞库信息，该漏洞的CVSS评分为9.8（严重），并且存在功能齐全的漏洞利用代码（Exploit Code Maturity: FUNCTIONAL）。CISA也将其添加到已知被利用的漏洞目录中，表明该漏洞在实际环境中被积极利用。提供的Python脚本似乎利用了`X-Forwarded-For`和`X-Forwarded-Vdom`头来绕过身份验证，并检索敏感信息，如管理员用户名、访问级别、序列号、版本以及LDAP配置。

**投毒风险分析：**

*   **README.md:**  `README.md` 文件仅包含简单的漏洞描述和使用说明，没有发现可疑代码。
*   **exploit.py:**  `exploit.py` 脚本本身旨在利用漏洞读取敏感信息，例如管理员用户名、密码配置文件和LDAP配置。脚本会将这些信息以JSON格式保存到文件中。虽然脚本的功能是信息泄露，但它本身并没有执行任何恶意代码或植入后门的功能。`validate_ip` 函数虽然名字叫做验证IP，但实际上的作用是验证 URL, 这点也需要注意。

虽然脚本本身没有明显的投毒代码，但是任何未经授权的漏洞利用都存在风险。利用此类漏洞获取的敏感信息可能被用于进一步的攻击，例如凭据盗用或横向移动。因此，在使用任何漏洞利用代码时，务必谨慎，并在受控环境中进行测试。

综合来看，该仓库存在投毒代码的可能性较低，但仍然建议人工审查漏洞利用代码，确保代码的安全性，避免在无意中执行恶意代码。并且该脚本存在错误验证函数, 可能导致被利用。

**漏洞利用方式：**

1.  攻击者构造包含特定的`X-Forwarded-For`、`X-Forwarded-Vdom`和`Host`头的HTTP/HTTPS请求。
2.  这些头信息被用于绕过身份验证检查。
3.  攻击者通过绕过身份验证后，可以访问`/api/v2/cmdb/system/admin/{username}`和`/api/v2/cmdb/user/ldap`等API端点。
4.  攻击者可以获取管理员用户名、访问级别、序列号、版本以及LDAP配置等敏感信息。
5.  获取的信息可被用于进一步攻击，例如尝试使用泄露的凭据登录或利用LDAP配置中的漏洞。

**项目地址:** [Anthony1500/CVE-2022-40684](https://github.com/Anthony1500/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #2

**来源**: [CVE-2022-40684-Bendalledj_CVE-2022-40684.md](../2022/CVE-2022-40684-Bendalledj_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #3

**来源**: [CVE-2022-40684-Chocapikk_CVE-2022-40684.md](../2022/CVE-2022-40684-Chocapikk_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问受影响的设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。

**漏洞利用方式：**

该漏洞的利用方式是发送特制的HTTP或HTTPS请求绕过身份验证。提供的POC代码使用Python编写，可以利用此漏洞为指定用户设置SSH密钥，从而允许攻击者使用该密钥登录系统。

1.  **分析POC代码：**
    *   POC代码包含一个Python脚本 (exploit.py) 和一个Nmap脚本 (cve-2022-40684.nse)。
    *   `exploit.py` 脚本接受目标URL、用户名和SSH公钥作为参数，并发送特制的HTTP请求来设置SSH密钥。
    *   `cve-2022-40684.nse` 是一个Nmap脚本，用于检测目标是否存在此漏洞。

2.  **有效性：**
    *   漏洞库信息中CVSS评分为9.8，漏洞利用成熟度为“功能齐全 (FUNCTIONAL)”，CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞被广泛利用，POC代码的有效性较高。

3.  **投毒风险：**
    *   检查了提供的POC代码，未发现明显的恶意代码。该脚本的主要功能是利用漏洞在目标系统上设置SSH公钥。虽然使用此脚本可以进行未授权访问，但脚本本身不包含任何隐藏的恶意行为（例如，删除文件、安装后门等）。因此，投毒风险较低，估计为0%。这个百分比基于对提供代码的静态分析，没有发现任何试图在目标机器上建立持久性后门、提取额外信息或横向移动的迹象。所有操作都集中在利用身份验证绕过来设置SSH密钥。

**总结：**

此漏洞影响多个Fortinet产品，允许未经身份验证的远程攻击者完全控制受影响的系统。由于存在可用的POC代码，并且该漏洞已被积极利用，因此组织应尽快应用补丁。

**项目地址:** [Chocapikk/CVE-2022-40684](https://github.com/Chocapikk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #4

**来源**: [CVE-2022-40684-ClickCyber_cve-2022-40684.md](../2022/CVE-2022-40684-ClickCyber_cve-2022-40684.md)

## CVE-2022-40684 Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的 Fortinet 产品版本，且暴露管理界面于网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求，在管理界面上执行操作。

**漏洞利用有效性分析：**
提供的 POC 代码 (Go 语言) 通过向目标设备的 `api/v2/cmdb/system/admin/{username}` 端点发送 PUT 请求，尝试为指定用户添加 SSH 公钥。POC 代码会读取指定的 SSH 公钥文件，并将其作为 `ssh-public-key1` 字段的值包含在 JSON 数据中。 通过设置 `Forwarded` 请求头来绕过身份验证检查。如果成功，攻击者可以使用新添加的 SSH 密钥登录到设备。

根据漏洞描述和 POC 代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在利用代码成熟度为 FUNCTIONAL (E:F)。

**投毒风险分析：**
查看提供的 POC 代码，未发现明显的恶意代码或后门。该代码的主要功能是读取 SSH 公钥并发送到目标设备，逻辑相对简单直接。所有的操作都在代码中明确可见。因此，投毒风险较低，可能性为 0%。

**利用方式总结：**
1.  攻击者准备一个 SSH 公钥文件。
2.  攻击者运行 POC 代码，指定目标 Fortinet 设备的 URL、要添加 SSH 公钥的用户名，以及 SSH 公钥文件的路径。
3.  POC 代码构造包含 SSH 公钥的 PUT 请求，并设置 `Forwarded` 请求头，绕过身份验证。
4.  如果请求成功，攻击者可以使用新添加的 SSH 公钥通过 SSH 登录到 Fortinet 设备。

总而言之，此漏洞危害严重，并且存在可用的功能性POC代码，应尽快修复。

**项目地址:** [ClickCyber/cve-2022-40684](https://github.com/ClickCyber/cve-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #5

**来源**: [CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md](../2022/CVE-2022-40684-Filiplain_Fortinet-PoC-Auth-Bypass.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能允许未授权访问管理界面，执行任意操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面，端口通常为HTTPS（443）或自定义端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中，是一个认证绕过漏洞。未认证的攻击者可以通过构造特殊的 HTTP 或 HTTPS 请求，绕过身份验证，在管理界面执行操作。

**漏洞利用分析：**

提供的 PoC 代码 (`poc.sh`) 尝试利用该漏洞。

1.  **请求构造：** PoC 脚本使用 `curl` 命令发送带有特定 header 的 HTTP GET 请求到目标设备。
2.  **关键 Header：** 关键的 HTTP header 包括 `Host`、`User-Agent`、`Accept-Encoding`、`Forwarded` 和 `X-Forwarded-Vdom`。
    *   `Forwarded` header 用于伪造客户端 IP 地址。
    *   `X-Forwarded-Vdom: root` 用于指定 VDOM (Virtual Domain)。设置为 `root` 可能会绕过某些身份验证检查。
3.  **目标 URL：** 请求的目标 URL 为 `/api/v2/cmdb/system/admin`，用于获取系统管理员信息。
4.  **验证：** 脚本检查返回的数据中是否包含 `results` 字符串，以判断目标是否受到漏洞影响。

**有效性评估：**

根据漏洞信息和 PoC 代码，此 PoC 具有一定的有效性。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已被广泛利用。

**投毒风险分析：**

查看 `poc.sh` 脚本：

*   脚本逻辑相对简单，主要就是发送一个带有特定 header 的 GET 请求，并检查返回结果。
*   脚本会将结果保存到 `$target.out` 文件中，方便分析。
*   没有发现任何执行恶意操作的代码，例如反弹 shell，下载恶意文件等。

查看 `README.md` 文件：

*   提供了脚本的使用方法。
*   链接到了 Exploit-db 上的相关利用。

综合来看，没有发现明显的投毒代码。脚本的功能与其描述相符，主要是用于检测漏洞的存在。
因此，投毒风险评估为 0%。

**利用方式总结：**

1.  攻击者发送特制的 HTTP/HTTPS 请求到目标 Fortinet 设备。
2.  请求中包含精心构造的 `Forwarded` 和 `X-Forwarded-Vdom` 等 header，以绕过身份验证。
3.  攻击者利用绕过的身份验证访问管理 API，执行未授权操作，例如获取系统信息，添加/删除用户，修改配置等。

**项目地址:** [Filiplain/Fortinet-PoC-Auth-Bypass](https://github.com/Filiplain/Fortinet-PoC-Auth-Bypass)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #6

**来源**: [CVE-2022-40684-HAWA771_CVE-2022-40684.md](../2022/CVE-2022-40684-HAWA771_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication-Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS: 7.0.0-7.0.6, 7.2.0-7.2.1; FortiProxy: 7.0.0-7.0.6, 7.2.0; FortiSwitchManager: 7.0.0, 7.2.0

**利用条件:** 需要能够通过HTTP或HTTPS访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**

根据漏洞库信息和提供的POC代码，该漏洞已被公开披露，且存在可用的POC利用代码，并被CISA列入已知被利用漏洞目录(KEV)。POC代码通过发送特制的HTTP PUT请求到目标设备的`/api/v2/cmdb/system/admin/{username}`接口，修改指定用户的SSH公钥来实现身份验证绕过。如果`SSH key is good`出现在响应文本中，则表示公钥已成功设置，之后即可使用对应的私钥通过SSH登录。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意代码或后门。代码主要功能是利用漏洞设置SSH密钥。虽然代码包含网络请求和SSH连接，但这些都是漏洞利用的必要步骤，没有发现其他可疑行为。但是，在使用任何第三方提供的漏洞利用代码时，都应谨慎审查，以确保其安全性。投毒的可能性极低，故设置为1%。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager的设备。
2.  **准备SSH密钥：** 生成一对SSH公钥和私钥。POC代码需要公钥的内容。
3.  **运行POC代码：** 使用提供的`exploit.py`脚本，指定目标URL、用户名和SSH公钥文件。例如：`python exploit.py -u <target_url> -U <username> -k <path_to_public_key>`。
4.  **SSH登录：** 如果利用成功，可以使用相应的私钥通过SSH登录到目标设备：`ssh <username>@<target_ip>`。

**项目地址:** [HAWA771/CVE-2022-40684](https://github.com/HAWA771/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #7

**来源**: [CVE-2022-40684-NeriaBasha_CVE-2022-40684.md](../2022/CVE-2022-40684-NeriaBasha_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标设备必须存在漏洞且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy, FortiSwitchManager 中的一个身份验证绕过漏洞。根据漏洞库信息，未经身份验证的攻击者可以通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。CVSS 3.1 评分为 9.8 (Critical)，说明该漏洞非常严重。

POC代码（poc-cve-2022-40684.ps1）是一个PowerShell脚本，它通过发送包含特定 Header 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 路径来尝试绕过身份验证。关键的 Header 包括 'Host', 'forwarded' 和 'x-forwarded-vdom'，这些 Header 被用来欺骗目标设备，使其认为请求来自受信任的来源。

**有效性：**

POC代码的有效性较高。漏洞库信息中该漏洞的 `ExploitCodeMaturity` 为 `FUNCTIONAL`，表明已经存在可用的利用代码。CISA 已将其添加到已知被利用的漏洞目录中，进一步表明该漏洞已被积极利用。

POC 代码通过构造特殊的HTTP头部来绕过身份验证，并尝试访问 `/api/v2/cmdb/system/admin` 获取管理员信息。如果返回状态码不是 401 (未经授权) 或 null (无法连接)，则表示目标可能存在漏洞，并解析返回的 JSON 数据以提取管理员用户名、权限信息、序列号、版本和构建信息。如果返回的是管理员信息，则证明漏洞利用成功。

**投毒风险：**

查看提供的 PowerShell 脚本 `poc-cve-2022-40684.ps1` 和 `README.md`，没有发现明显的恶意代码或投毒行为。脚本的功能明确，主要用于发送特制的 HTTP 请求来测试目标设备是否存在 CVE-2022-40684 漏洞。它只是简单地读取管理员信息，没有执行任何可能危害系统的操作。因此，判断投毒风险为 0%。

**利用方式：**

1.  攻击者构造包含特制的 HTTP Header（'Host', 'forwarded', 'x-forwarded-vdom'）的请求。
2.  将请求发送到目标 Fortinet 设备的 `/api/v2/cmdb/system/admin` 路径。
3.  如果设备存在漏洞，则身份验证将被绕过，攻击者可以访问管理员信息（用户名、权限等）和系统信息（序列号、版本、构建）。
4.  攻击者可以进一步利用获取的信息，例如，使用已知的管理员用户名和默认密码（如果存在）登录设备，或者利用获取的系统信息查找其他漏洞。

**项目地址:** [NeriaBasha/CVE-2022-40684](https://github.com/NeriaBasha/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #8

**来源**: [CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md](../2022/CVE-2022-40684-Rofell0s_Fortigate-Leak-CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #9

**来源**: [CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md](../2022/CVE-2022-40684-TaroballzChen_CVE-2022-40684-metasploit-scanner.md)

## CVE-2022-40684-Fortinet产品认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权访问管理界面并执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本且开放HTTP/HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684是一个Fortinet产品中的认证绕过漏洞，攻击者可以通过构造特殊的HTTP/HTTPS请求绕过身份验证，从而在管理界面执行未授权的操作。根据提供的漏洞利用代码，攻击者可以利用Metasploit框架，通过发送带有特定header的请求到目标系统的`/api/v2/cmdb/system/admin/{username}`或`/api/v2/cmdb/system/admin`路径，绕过身份验证。漏洞利用代码尝试获取LDAP配置信息，可能泄露敏感信息。漏洞利用的有效性取决于目标系统是否部署了受影响的Fortinet产品版本。投毒风险较低，主要集中在Metasploit模块的安装路径和对依赖库的潜在篡改。代码中`Host`头被设置为`127.0.0.1:9980`，`Forwarded`头包含内部IP地址，这可能被恶意修改，用于内部网络渗透或欺骗，因此存在一定风险。

**项目地址:** [TaroballzChen/CVE-2022-40684-metasploit-scanner](https://github.com/TaroballzChen/CVE-2022-40684-metasploit-scanner)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #10

**来源**: [CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md](../2022/CVE-2022-40684-XalfiE_Fortigate-Belsen-Leak-Dump-CVE-2022-40684-.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #11

**来源**: [CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md](../2022/CVE-2022-40684-Yami0x777_Belsen_Group-et-exploitation-de-la-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #12

**来源**: [CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md](../2022/CVE-2022-40684-arsolutioner_fortigate-belsen-leak.md)

## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #13

**来源**: [CVE-2022-40684-carlosevieira_CVE-2022-40684.md](../2022/CVE-2022-40684-carlosevieira_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet 产品中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 或 HTTPS 请求到管理界面来绕过身份验证。漏洞存在于FortiOS 7.2.0到7.2.1和7.0.0到7.0.6，FortiProxy 7.2.0和7.0.0到7.0.6，FortiSwitchManager 7.2.0和7.0.0。根据漏洞描述，攻击者可以通过构造包含`forwarded`和`x-forwarded-vdom`头的HTTP请求，利用备用路径或通道绕过身份验证检查。

**有效性：**
提供的PoC代码（`exploit.py`和`CVE-2022-40684.yaml`）是有效的。`exploit.py` 脚本使用 `requests` 库发送带有特定 headers 的 HTTP GET 请求到目标设备的 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 接口，从而绕过身份验证并获取敏感信息，例如管理员用户名、访问级别、序列号、版本信息以及 LDAP 配置。`CVE-2022-40684.yaml` 是一个 Nuclei 模板，用于自动化漏洞检测过程，本质上执行相同的 HTTP 请求。

**投毒风险：**
检查了提供的 PoC 代码，虽然该脚本的目的是为了演示漏洞利用，并且确实可以提取敏感信息，但是发现了如下潜在投毒风险点：

1.  `Host` header 被硬编码为 `127.0.0.1:9980`，这可能会导致一些网络配置不当的设备将请求发送到错误的目标。
2.  `forwarded` header 模拟从 `127.0.0.1` 发出的请求，这在某些复杂的网络环境中可能会导致意想不到的副作用。
3.  脚本缺少错误处理，例如，如果目标设备不存在或无法访问，脚本可能会崩溃，而不是优雅地退出。
4. 脚本泄露LDAP配置信息，可能导致连接到恶意LDAP服务器。

这些风险点并非明显的后门，但可能导致某些情况下利用失败或产生其他问题。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者使用PoC脚本或Nuclei模板，向目标Fortinet设备的管理界面发送特制的HTTP GET请求。
2.  请求包含精心构造的`forwarded`和`x-forwarded-vdom` headers，绕过身份验证检查。
3.  服务器错误地处理这些headers，允许未经验证的请求访问受保护的API接口。
4.  攻击者从而获取管理员用户名、访问级别、设备序列号、版本信息和LDAP配置等敏感信息。

**项目地址:** [carlosevieira/CVE-2022-40684](https://github.com/carlosevieira/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #14

**来源**: [CVE-2022-40684-ccordeiro_CVE-2022-40684.md](../2022/CVE-2022-40684-ccordeiro_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 目标系统存在漏洞版本，攻击者能够发起HTTP/HTTPS请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 是一个 Fortinet 产品中的身份验证绕过漏洞，通过构造特殊的 HTTP 或 HTTPS 请求，未经验证的攻击者可以在管理界面上执行操作。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞的 POC 代码是有效的。CVE 数据表明该漏洞的 `exploitCodeMaturity` 为 `FUNCTIONAL`，并且已经被 CISA 加入到已知被利用的漏洞目录中，表明该漏洞已在野外被积极利用。

**投毒风险：**
对提供的 Python 脚本 `exploit.py` 进行分析，它主要实现了以下功能：
1.  向目标发送带有特定 Header 的 HTTP GET 请求，绕过身份验证。
2.  如果状态码为 200，则解析返回的 JSON 数据，提取管理员用户名和访问级别。
3.  提取设备序列号和版本信息
4.  尝试读取 LDAP 配置信息，提取 LDAP 服务器地址、绑定 DN、用户名等敏感信息。

未发现明显的恶意代码或后门。脚本的目的是利用漏洞读取敏感信息。其它文件都是一些说明文档和更新日志。
因此，投毒风险较低，约为 5%。主要风险在于使用者在使用未经充分审计的代码时，可能引入安全风险。

**利用方式：**
该漏洞的利用方式主要通过发送特制的 HTTP 请求头来绕过身份验证。攻击者通过设置 `forwarded` 和 `x-forwarded-vdom` 请求头，欺骗 Fortinet 设备，从而可以访问 `/api/v2/cmdb/system/admin` 和 `/api/v2/cmdb/user/ldap` 等管理接口，读取管理员信息和 LDAP 配置。具体步骤如下：

1.  构造包含以下 header 的 HTTP GET 请求：
    *   `User-Agent: Node.js`
    *   `accept-encoding: gzip, deflate`
    *   `Host: <目标IP地址或域名>`
    *   `forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=`
    *   `x-forwarded-vdom: root`
2.  发送请求到 `/api/v2/cmdb/system/admin` 接口，获取管理员信息。
3.  发送请求到 `/api/v2/cmdb/user/ldap` 接口，获取 LDAP 配置信息。

**项目地址:** [ccordeiro/CVE-2022-40684](https://github.com/ccordeiro/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #15

**来源**: [CVE-2022-40684-dkstar11q_CVE-2022-40684.md](../2022/CVE-2022-40684-dkstar11q_CVE-2022-40684.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy/FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 存在于 FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求绕过身份验证，从而在管理界面上执行操作。

**有效性：**
提供的 Python 脚本 `CVE-2022-40684.py` 实现了对该漏洞的利用。脚本通过设置 `Forwarded` 头部来绕过身份验证，然后可以执行诸如添加 SSH 密钥以控制设备等操作。漏洞库信息中 `metrics`部分CVSS评分表明该漏洞是高危且具有可利用性。CISA将其列入已知被利用漏洞目录，更证明了该漏洞的有效性。

**投毒风险：**
对提供的代码进行分析，该脚本的主要功能是利用 CVE-2022-40684 漏洞，没有发现任何明显的恶意代码或后门。代码的功能是检查目标是否容易受到攻击，以及通过在目标设备上添加SSH公钥来利用该漏洞。LICENSE文件是MIT许可，较为通用，未发现异常。

**利用方式：**
1.  **检查漏洞：** 使用 `-c` 或 `--check` 参数来检查目标设备是否存在漏洞。该脚本会发送一个特制的 GET 请求到 `/api/v2/cmdb/system/admin` 端点，如果状态码为 200，则表明存在漏洞。还会尝试获取 LDAP 配置信息，以便进行进一步的攻击。
2.  **添加 SSH 密钥：** 使用 `-a` 或 `--attack` 参数以及 `-k` 或 `--key-file` 参数，指定 SSH 公钥文件路径，将指定的 SSH 公钥添加到目标设备的 `admin` 用户的 authorized_keys 文件中。利用该方式，攻击者可以通过 SSH 密钥登录到目标设备，从而完全控制该设备。

总而言之，该漏洞利用代码有效，且未发现明显的投毒风险，风险系数评估为 0%。利用方式主要是通过构造特殊的HTTP头部进行身份验证绕过，然后进行敏感信息的读取或进一步的利用。

**项目地址:** [dkstar11q/CVE-2022-40684](https://github.com/dkstar11q/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #16

**来源**: [CVE-2022-40684-gustavorobertux_gotigate.md](../2022/CVE-2022-40684-gustavorobertux_gotigate.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响的设备

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备必须运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**漏洞利用方式：**

POC 代码 `gotigate` 是一个 Go 程序，用于利用 CVE-2022-40684 漏洞。它通过发送带有特定 HTTP 头部（例如 `Host`, `forwarded`, `x-forwarded-vdom`）的 GET 请求到 `/api/v2/cmdb/system/admin` 端点来绕过身份验证。这些头部欺骗服务器，使其认为请求来自受信任的来源。

具体来说，该代码设置了以下头部：
*   `Host`: 设置为 `127.0.0.1:9980`，可能旨在绕过某些主机名验证。
*   `forwarded`: 模拟请求经过代理，指示原始请求来自本地地址，协议为 HTTP。
*   `x-forwarded-vdom`: 设置为 `root`，指示请求针对根虚拟域。

通过组合这些头部，攻击者可以绕过身份验证并访问管理界面，从而可能执行任意操作。

**有效性：**

根据漏洞库信息和提供的 POC 代码，该漏洞利用是有效的。漏洞库中的 CVSS 评分表明这是一个严重漏洞，利用代码成熟度为“功能性”，意味着存在可用的、有效的利用代码。CISA 将其添加到已知被利用的漏洞目录中也证实了这一点。

**投毒风险：**

查看`main.go`文件,代码比较简单, 主要就是发送了一个GET请求,没有发现恶意的行为。`README.md`只是说明了该工具的使用方法。综上，该存储库中存在作者隐藏的投毒代码可能性较低，因此判定投毒风险极低，大概为1%。

**项目地址:** [gustavorobertux/gotigate](https://github.com/gustavorobertux/gotigate)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #17

**来源**: [CVE-2022-40684-horizon3ai_CVE-2022-40684.md](../2022/CVE-2022-40684-horizon3ai_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTPS端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面上执行操作。

**有效性：**

提供的POC代码通过添加SSH密钥到目标设备的管理员账户，验证了漏洞的有效性。POC代码使用`requests`库发送带有特定header（`Forwarded`）的PUT请求到`/api/v2/cmdb/system/admin/{username}` URL，绕过身份验证，将指定的SSH公钥添加到指定用户，从而允许攻击者使用私钥登录设备。

**投毒风险：**

虽然POC代码本身是为了验证漏洞，理论上可以作为漏洞利用的起点，但仔细检查了提供的Python脚本和README文件，没有发现明显的投毒代码。代码功能相对简单，主要是发送HTTP请求。但是，任何下载和使用的第三方脚本都有潜在风险，始终建议在隔离环境中进行测试和代码审查。
投毒风险评估：较低，约为10%。主要考虑点是，用户是否信任代码作者，以及代码托管平台是否被攻陷。

**利用方式：**

1.  攻击者利用身份验证绕过漏洞，构造特殊的HTTP或HTTPS请求。
2.  POC代码中通过设置`Forwarded`头来绕过身份验证。
3.  攻击者发送PUT请求到`/api/v2/cmdb/system/admin/{username}` API端点，更新指定用户的SSH公钥。
4.  如果目标设备存在漏洞，攻击者就可以通过新添加的SSH密钥登录设备，从而控制系统。
5. 该漏洞通过允许未经身份验证的攻击者执行管理操作来实现利用。

**项目地址:** [horizon3ai/CVE-2022-40684](https://github.com/horizon3ai/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #18

**来源**: [CVE-2022-40684-hughink_CVE-2022-40684.md](../2022/CVE-2022-40684-hughink_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未授权的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启Web管理界面且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684 漏洞存在于 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 的Web管理界面。攻击者可以通过发送特制的HTTP或HTTPS请求，利用备用路径绕过身份验证，从而执行未经授权的管理操作。

**有效性：** 提供的POC代码有效。第一个GET请求用于获取管理员信息，验证漏洞是否存在。第二个PUT请求展示了如何通过构造包含ssh公钥的payload修改管理员信息，从而实现远程访问。

**投毒风险：** 仓库中存在投毒代码的可能性较低，约为5%。分析理由如下：
  * Readme文件主要包含漏洞描述、影响版本、资产确定方法、PoC和利用方法。
  * 提供的PoC利用的是已知漏洞，利用的payload也是常规的添加SSH公钥的方式，暂未发现后门代码，但仍需人工审计代码。

**利用方式：**
1.  **确定目标资产：** 通过title标签确定目标是否为受影响的 FortiProxy 或 FortiGate。
2.  **发送POC请求：**  使用GET请求 `/api/v2/cmdb/system/admin`，并设置`Host`, `Forwarded`, `X-Forwarded-Vdom`等header头，尝试绕过身份验证以获取管理员信息。
3.  **利用漏洞：**  如果POC成功，使用PUT请求`/api/v2/cmdb/system/admin/用户名`，并设置`Host`, `Forwarded`等header头。在请求体中，使用JSON格式设置`ssh-public-key1`字段为攻击者的公钥。这样，攻击者就可以通过SSH密钥登录到目标系统。

**总结：** 漏洞利用过程相对简单，但需要目标系统存在漏洞，且需要网络可达。成功利用漏洞后，攻击者可以获得目标系统的完全控制权。

**项目地址:** [hughink/CVE-2022-40684](https://github.com/hughink/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---



---

## POC #19

**来源**: [CVE-2022-40684-iveresk_CVE-2022-40684.md](../2022/CVE-2022-40684-iveresk_CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标设备运行受影响版本的FortiOS、FortiProxy或FortiSwitchManager，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过构造特制的HTTP或HTTPS请求，绕过身份验证并在受影响的 Fortinet 设备上执行管理操作。提供的 POC 代码通过向 `/api/v2/cmdb/system/admin/{username}` 发送 PUT 请求，并添加攻击者的 SSH 公钥到指定的管理员账户（默认为 admin）来利用此漏洞。 

**有效性：**

提供的 POC 代码看起来有效。它利用了身份验证绕过漏洞，通过构造包含 `Forwarded` 头的 HTTP 请求，将 SSH 公钥添加到指定用户，从而实现未经授权的访问。漏洞库信息中 CVSS 评分为 9.8（严重），且 exploitCodeMaturity 为 FUNCTIONAL，表明该漏洞的利用方式成熟且危害极大。

**投毒风险：**

分析提供的 POC 代码，没有发现明显的恶意代码或后门。该脚本的主要功能是利用漏洞添加 SSH 密钥。 `cve-2022-40684.py`脚本读取指定的公钥文件并将其添加到目标系统的管理员账户。`ip-pack.sh` 只是一个用于批量利用的简单脚本。`README.md` 文件描述了漏洞和利用方法。

**利用方式：**

1.  攻击者使用 `cve-2022-40684.py` 脚本或 `ip-pack.sh` 脚本，指定目标设备的 IP 地址、用户名（默认为 admin）和 SSH 公钥文件。
2.  脚本构造包含 `Forwarded` 头的 HTTP PUT 请求，并将 SSH 公钥添加到目标设备的管理员账户。
3.  通过 SSH 使用添加的公钥登录目标设备，从而获得管理员权限。

总而言之，提供的代码是 CVE-2022-40684 漏洞的有效 POC，允许攻击者通过身份验证绕过漏洞添加 SSH 密钥并获得未经授权的访问。没有检测到明显的投毒代码。

**项目地址:** [iveresk/CVE-2022-40684](https://github.com/iveresk/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #20

**来源**: [CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md](../2022/CVE-2022-40684-jsongmax_Fortinet-CVE-2022-40684.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy version 7.2.0 and version 7.0.0 through 7.0.6 and FortiSwitchManager version 7.2.0 and 7.0.0

**利用条件:** 需要网络访问Fortinet设备的管理界面（HTTP或HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 漏洞允许未经身份验证的攻击者通过构造特殊的HTTP或HTTPS请求绕过身份验证，从而在 FortiOS、FortiProxy 和 FortiSwitchManager 的管理界面上执行操作。

**有效性评估：**
根据漏洞库信息，该漏洞已被CISA添加到已知被利用的漏洞目录(KEV)，且存在功能性(Functional)的exp，表明该漏洞利用的有效性很高。提供的Go语言POC代码尝试通过上传SSH公钥到目标系统来获得未授权访问。

**投毒风险评估：**
该Go语言POC代码本身用于利用CVE-2022-40684漏洞，目的在于上传SSH密钥以获得访问权限。代码中使用的依赖项看起来都是常见的Go库，如req (HTTP客户端)，banner，color等。没有明显的恶意代码的迹象，但仍需要仔细审查代码逻辑以排除任何隐藏的后门。

投毒风险评估为10%。原因如下：
*   POC代码相对简单，功能明确，主要是进行HTTP请求和文件操作。
*   代码使用了流行的Go库，这些库被广泛使用，被投毒的可能性较低。
*   作者声明了免责声明，表明其目的是进行合法的安全测试。

即便如此，用户在使用前应仔细审查代码，确保没有隐藏的恶意行为。 建议编译前检查代码，确保上传的公钥为自己所拥有，以防被他人利用。

**利用方式分析：**
利用方式如下：
1.  攻击者构造恶意的HTTP/HTTPS请求，利用身份验证绕过漏洞。
2.  POC代码使用`req`库发送精心设计的HTTP请求到目标Fortinet设备的管理界面。
3.  攻击者可以使用该漏洞在目标系统上添加新的管理用户或上传SSH密钥。
4.  利用上传的SSH公钥，攻击者可以使用私钥通过SSH登录到设备。
5.  成功登录后，攻击者可以执行任意管理操作，包括配置更改、固件升级、数据窃取等。

**项目地址:** [jsongmax/Fortinet-CVE-2022-40684](https://github.com/jsongmax/Fortinet-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #21

**来源**: [CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md](../2022/CVE-2022-40684-kljunowsky_CVE-2022-40684-POC.md)

## CVE-2022-40684-FortiOS/FortiProxy/FortiSwitchManager身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以对管理界面执行操作，可能导致完全控制系统

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的FortiOS, FortiProxy 或 FortiSwitchManager版本，并且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的HTTP或HTTPS请求，在管理界面上执行操作。提供的PoC代码通过PUT请求向`/api/v2/cmdb/system/admin/<username>`端点发送包含SSH公钥的JSON数据，试图将攻击者的SSH公钥添加到指定用户名对应的管理员账户中，从而实现SSH密钥认证登录。

**有效性评估：**
PoC代码看起来有效，因为它利用了漏洞描述中提到的特定API端点和请求方法，并且数据结构符合要求。如果目标系统存在漏洞，并且用户提供的用户名存在，则攻击者可以成功将SSH公钥添加到目标系统，从而获得未经授权的访问权限。从CVE信息来看，该漏洞的`ExploitCodeMaturity`是`FUNCTIONAL`，说明存在可用的漏洞利用代码，进一步佐证了PoC的有效性。

**投毒风险评估：**
分析PoC代码后，未发现明显的投毒代码。该脚本的主要功能是读取目标、用户名和SSH公钥文件，然后向目标系统发送PUT请求。脚本本身没有尝试执行任何恶意操作，例如下载或执行其他代码。但是，需要注意以下几点：
1.  **依赖性：** 该脚本依赖于`requests`库，如果安装的`requests`库被替换为恶意版本，则可能存在风险。
2.  **用户输入：** 该脚本接受用户提供的目标、用户名和SSH公钥文件作为输入。如果用户提供的文件包含恶意内容（例如，SSH公钥文件实际上包含后门），则可能导致远程代码执行。
3.  **目标系统安全性：** 即使该脚本本身没有投毒代码，成功利用该漏洞后，攻击者仍然可以对目标系统执行恶意操作。

综合考虑，此仓库中直接包含恶意投毒代码的风险较低，估计为0%。但是，仍然需要注意依赖性和用户输入的安全。

**利用方式：**
1.  **目标确定：** 确定运行受影响的FortiOS、FortiProxy或FortiSwitchManager版本的目标系统。
2.  **用户名收集：** 收集目标系统上可能存在的用户名。常见用户名包括`admin`、`administrator`等。
3.  **SSH密钥生成：** 生成SSH密钥对。将公钥保存在文件中，供PoC脚本使用。
4.  **PoC执行：** 运行PoC脚本，指定目标、用户名和SSH公钥文件。如果成功，则攻击者的SSH公钥将被添加到目标系统的管理员账户中。
5.  **SSH登录：** 使用私钥通过SSH登录目标系统。

**项目地址:** [kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #22

**来源**: [CVE-2022-40684-mhd108_CVE-2022-40684.md](../2022/CVE-2022-40684-mhd108_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，可能导致完全控制受影响系统

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是Fortinet FortiOS、FortiProxy和FortiSwitchManager中的一个身份验证绕过漏洞。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，并在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在可用的功能性漏洞利用代码(exploitCodeMaturity为FUNCTIONAL)。CISA已知被利用漏洞目录中也包含该漏洞。提供的漏洞利用代码片段`/tmp/2f6a79f153d24e98a3585c85dba2106b/CVE-2022-40684` 指向了一个名为 `CVE-2022-40684` 的可执行文件，这意味着它很可能是已经编译好的漏洞利用程序，可以直接运行利用。 由于代码片段很短且只显示路径，因此无法分析是否存在投毒风险。假设该文件是已知漏洞的利用程序，那么投毒的风险较低(0%)，因为它的目的是利用已知漏洞而不是植入新的恶意代码。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在未经授权的情况下访问和操作受影响的Fortinet产品的管理界面。考虑到存在公开可用的漏洞利用代码和高危的漏洞评分，该漏洞的利用有效性非常高。

**项目地址:** [mhd108/CVE-2022-40684](https://github.com/mhd108/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #23

**来源**: [CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md](../2022/CVE-2022-40684-niklasmato_fortileak-01-2025-Be.md)

## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical, allows unauthenticated attacker to perform operations on the administrative interface.

**影响版本:** FortiOS 7.2.1, 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiProxy 7.2.0, 7.0.6, 7.0.5, 7.0.4, 7.0.3, 7.0.2, 7.0.1, 7.0.0; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Requires network access to the administrative interface (HTTP or HTTPS).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS, FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。攻击者可以通过构造特制的 HTTP 或 HTTPS 请求绕过身份验证，在管理界面上执行操作。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别，且已经被CISA添加到已知被利用漏洞目录中，存在实际被利用案例。提供的“漏洞利用代码”只是指向一个Github仓库的链接，提示用户检查更新后的仓库。该仓库中可能包含漏洞利用脚本，但是目前并没有具体的脚本内容。由于仅仅是一个链接，无法直接判断仓库内容的可靠性，所以投毒风险大约为10%， 主要源于不确定的第三方代码的潜在风险。

**利用方式：**

1.  攻击者构造恶意的HTTP或HTTPS请求，利用Alternate Path or Channel bypass漏洞进行身份验证绕过。
2.  成功绕过身份验证后，攻击者可以访问并操作管理界面。
3.  攻击者可能利用管理权限执行未授权的操作，例如更改配置、执行命令或访问敏感数据。

因为搜索引擎没有返回有效信息，漏洞库信息和给定的POC代码（仓库链接）有限，故评估基于这两者。


**项目地址:** [niklasmato/fortileak-01-2025-Be](https://github.com/niklasmato/fortileak-01-2025-Be)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #24

**来源**: [CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md](../2022/CVE-2022-40684-notareaperbutDR34P3r_CVE-2022-40684-Rust.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 through 7.2.1, 7.0.0 through 7.0.6; FortiProxy 7.2.0, 7.0.0 through 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在于受影响的版本范围内，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8（严重），漏洞利用代码成熟度为“功能性”，已被CISA添加到已知被利用的漏洞目录中。

漏洞利用代码 (CVE-2022-40684.rs) 使用 Rust 编写，功能是向目标 Fortinet 设备的特定 API 端点 ( `/api/v2/cmdb/system/admin/{username}` ) 发送 PUT 请求，以添加用户的 SSH 公钥。它通过以下步骤利用该漏洞：

1.  **获取参数：** 使用 `structopt` crate 解析命令行参数，包括目标 IP 地址、用户名和 SSH 密钥文件。
2.  **读取 SSH 密钥：** 从指定的文件中读取 SSH 公钥。
3.  **构造 HTTP 请求：** 创建一个 `reqwest` HTTP 客户端，并构建一个 PUT 请求，该请求包含一个 JSON payload，其中包含要添加的 SSH 公钥。
4.  **设置请求头：** 设置 `User-Agent` 和 `Forwarded` 请求头。`Forwarded` 头是漏洞利用的关键，攻击者利用该头绕过身份验证。
5.  **发送请求：** 将请求发送到目标设备的 API 端点。
6.  **检查响应：** 检查响应内容是否包含字符串 “SSH key is good”，以确定是否成功添加了 SSH 密钥。

**有效性评估：**

该漏洞利用代码通过构造包含特定 `Forwarded` 头的HTTP请求来绕过身份验证，利用了备用路径或通道中的身份验证缺陷。根据漏洞信息和漏洞利用代码，该利用方式是有效的，未经授权的攻击者可以通过该方法控制受影响的Fortinet设备。

**投毒风险评估：**

提供的 Rust 代码段没有明显的投毒风险。它执行的操作是明确的，即读取 SSH 密钥文件并将其添加到指定用户的帐户中。代码没有尝试执行任何其他恶意操作，例如下载或执行任意代码，或者修改系统文件。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

该漏洞利用方式基于向目标 Fortinet 设备的管理 API 发送带有特定 `Forwarded` 标头的特制 HTTP/HTTPS 请求。此标头允许攻击者绕过身份验证并执行管理操作，例如添加 SSH 密钥，从而获得对设备的未授权访问。攻击者需要知道目标设备的 IP 地址以及要添加 SSH 密钥的用户名。


**项目地址:** [notareaperbutDR34P3r/CVE-2022-40684-Rust](https://github.com/notareaperbutDR34P3r/CVE-2022-40684-Rust)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #25

**来源**: [CVE-2022-40684-puckiestyle_CVE-2022-40684.md](../2022/CVE-2022-40684-puckiestyle_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权访问管理界面，可能导致完全系统控制

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统存在漏洞版本，且攻击者可以发起 HTTP/HTTPS 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个严重的身份验证绕过漏洞，影响Fortinet的FortiOS, FortiProxy, 和 FortiSwitchManager。未经验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在管理界面执行操作。

**有效性：** 提供的POC代码通过发送特定的请求来添加SSH公钥，从而允许未经授权的访问，证明了漏洞的有效性。

**投毒风险：** 查看提供的Python脚本，主要功能是利用漏洞添加SSH密钥，代码逻辑清晰，主要利用requests库发送HTTP请求。脚本没有发现任何明显的后门或恶意代码，例如下载并执行恶意二进制文件，或者未经授权的数据泄露。README中也描述了漏洞的利用方式和缓解措施，提高了透明度。因此，投毒风险评估为0%。

**利用方式：** 该漏洞允许攻击者绕过身份验证，然后使用该权限执行操作。提供的POC代码演示了如何利用此漏洞来添加SSH公钥到目标系统上的指定用户。攻击者通过构造包含`Forwarded`头的HTTP(S)请求绕过身份验证，然后调用API来更新用户的SSH密钥。成功添加SSH密钥后，攻击者就可以使用私钥通过SSH登录系统。

**项目地址:** [puckiestyle/CVE-2022-40684](https://github.com/puckiestyle/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #26

**来源**: [CVE-2022-40684-qingsiweisan_CVE-2022-40684.md](../2022/CVE-2022-40684-qingsiweisan_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #27

**来源**: [CVE-2022-40684-secunnix_CVE-2022-40684.md](../2022/CVE-2022-40684-secunnix_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #28

**来源**: [CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md](../2022/CVE-2022-40684-und3sc0n0c1d0_CVE-2022-40684.md)

## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #29

**来源**: [CVE-2022-40684-xtwip_fortipwn.md](../2022/CVE-2022-40684-xtwip_fortipwn.md)

## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

## POC #30

**来源**: [CVE-2022-40684-z-bool_CVE-2022-40684.md](../2022/CVE-2022-40684-z-bool_CVE-2022-40684.md)

## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，允许未经身份验证的攻击者执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标存在漏洞版本，且可以通过HTTP/HTTPS访问管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。

**有效性：**
提供的POC代码有效。它首先尝试通过`/api/v2/cmdb/system/admin` API接口获取用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置。如果成功，则表明目标存在漏洞。然后，它允许用户输入用户名和SSH公钥路径，并将公钥写入目标系统，实现SSH免密登录，从而获得控制权。

**投毒风险：**
POC代码本身的主要功能是利用身份验证绕过漏洞，枚举用户名和写入SSH公钥以获得系统访问权限。直接利用此代码进行攻击会在目标系统上留下明显的痕迹，因此进行隐蔽的投毒操作不太可能。但是仍然存在着很小的概率。例如，攻击者可能会修改 `get_shell` 函数，在写入 SSH 公钥的同时，也在后台执行其他恶意代码，比如下载并执行恶意脚本等。考虑到该代码主要通过网络请求交互，潜在的风险可能来自于伪造服务器响应、篡改 API 返回数据，从而在受害者不知情的情况下植入后门。所以综合评估投毒风险在10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过身份验证。
2.  **信息泄露：**  利用绕过的身份验证，通过API接口 `/api/v2/cmdb/system/admin` 枚举用户名、访问级别、序列号和版本信息，并尝试获取LDAP配置等敏感信息。
3.  **SSH密钥注入：** 攻击者提供SSH公钥，POC利用PUT请求将公钥添加到指定用户的authorized_keys中。
4.  **远程控制：**  攻击者使用SSH密钥登录到目标系统，实现远程控制。

**项目地址:** [z-bool/CVE-2022-40684](https://github.com/z-bool/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)

---

