# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

# CVE-2022-26134

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-26134-404fu_CVE-2022-26134-POC.md](../2022/CVE-2022-26134-404fu_CVE-2022-26134-POC.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #2

**来源**: [CVE-2022-26134-Agentgilspy_CVE-2022-26134.md](../2022/CVE-2022-26134-Agentgilspy_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开启并且存在于网络中，攻击者能够访问8090端口（默认）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的系统上执行任意代码。根据漏洞库信息，该漏洞影响多个 Confluence 版本。搜索引擎结果表明该漏洞已被积极利用，存在实际的威胁。提供的漏洞利用代码（main.py）通过构造包含 OGNL 表达式的 URL，利用漏洞在目标服务器上执行命令。该脚本首先尝试获取 Confluence 的版本信息，然后允许用户交互式地执行命令，或者建立反向 shell。代码中未发现明显的恶意投毒行为，其行为与漏洞利用的目标一致。因此，可以判定投毒风险较低。利用方式是：攻击者发送特制的HTTP请求，Confluence 服务器解析 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [Agentgilspy/CVE-2022-26134](https://github.com/Agentgilspy/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #3

**来源**: [CVE-2022-26134-CJ-0107_cve-2022-26134.md](../2022/CVE-2022-26134-CJ-0107_cve-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #4

**来源**: [CVE-2022-26134-Chocapikk_CVE-2022-26134.md](../2022/CVE-2022-26134-Chocapikk_CVE-2022-26134.md)

## CVE-2022-26134 - Confluence OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例存在于受影响的版本范围内，且攻击者可以访问Confluence服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog）和提供的漏洞利用代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险:**
提供的 Python 漏洞利用代码 `exploit.py` 总体来说没有明显的投毒代码。它通过构造包含恶意 OGNL 表达式的 URL 发送 HTTP 请求，并在响应头中接收命令执行结果。但是，有几个潜在的风险点：

1.  **依赖风险:** 代码依赖于 `requests`, `rich` 等第三方库，如果这些库被篡改，可能引入恶意代码。
2.  **反向 shell 代码:**  `-l` 和 `-p` 参数会植入反向shell，如被恶意利用可以控制目标服务器。本次分析**不视为投毒**。
3.  **结果判断:**  脚本通过检查 HTTP 状态码和 `X-Cmd-Response` 头的长度来判断漏洞是否成功利用。如果 Confluence 服务器的行为略有不同，攻击者可能会错误地认为目标易受攻击，并执行恶意操作。

综合判断，投毒风险为 10%，主要是由于可能存在的依赖风险。

**利用方式:**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  攻击者将构造的 URL 发送到目标 Confluence 服务器。
3.  Confluence 服务器解析该 URL，执行 OGNL 表达式。
4.  如果 OGNL 表达式成功执行，攻击者可以在 Confluence 服务器上执行任意代码。
5.  漏洞利用代码 `exploit.py` 通过命令行参数指定目标 URL 和要执行的命令，构造包含恶意 OGNL 表达式的 HTTP GET 请求，服务器执行命令后，将结果放在HTTP Header的X-Cmd-Response字段中返回。或者通过指定lhost和lport, 执行反向shell, 从而获取目标服务器控制权。

**项目地址:** [Chocapikk/CVE-2022-26134](https://github.com/Chocapikk/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #5

**来源**: [CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md](../2022/CVE-2022-26134-DARKSTUFF-LAB_-CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码。

**影响版本:** 1.3.0 到 7.4.17, 7.13.0 到 7.13.7, 7.14.0 到 7.14.3, 7.15.0 到 7.15.2, 7.16.0 到 7.16.4, 7.17.0 到 7.17.4, 以及 7.18.0 到 7.18.1 之前的版本

**利用条件:** 目标 Confluence 实例需要存在于可访问的网络中，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的利用代码。

**投毒风险：**

检查提供的 `exploit.py` 代码，发现以下可疑点：
1. 代码使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 (`urllib3.disable_warnings()` 和 `verify=False`)。 这可能导致中间人攻击的风险，攻击者可以拦截和修改请求，从而执行恶意代码。
2. 代码从目标服务器的响应头 `X-Cmd-Response` 中获取命令执行结果。虽然这本身不是投毒，但依赖响应头可能存在被篡改的风险，也为投毒提供了可乘之机，例如恶意服务器伪造响应头。
3. 代码使用了 `multiprocessing` 库，可能存在进程间通信的问题，增加了复杂性，也可能为恶意代码提供隐藏点。
4. 代码中包含从 URL 中获取参数后未经过严格校验就执行，存在一定的安全风险，允许用户自定义请求头，增加了一些安全隐患。

总体而言，代码本身没有明显的恶意行为，但是代码质量不高，存在一定的安全隐患，有被利用进行投毒的潜在风险，因此判断为存在10% 的投毒风险。

**利用方式：**

1.  **漏洞原理：**  该漏洞源于 Confluence 中 OGNL 表达式处理不当，允许攻击者在请求中注入恶意 OGNL 代码。
2.  **攻击步骤：**
    *   攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。此表达式可以执行任意命令。
    *   受影响的 Confluence 实例解析并执行 OGNL 表达式。
    *   服务器执行攻击者指定的命令，并将结果通过 `X-Cmd-Response` 响应头返回。
3.  **POC 利用：**  提供的 `exploit.py` 脚本通过构造包含 OGNL 表达式的 URL 来利用此漏洞。脚本将命令注入到 URL 中，发送请求，然后从响应头中提取命令执行的结果。

**项目地址:** [DARKSTUFF-LAB/-CVE-2022-26134](https://github.com/DARKSTUFF-LAB/-CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #6

**来源**: [CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md](../2022/CVE-2022-26134-Khalidhaimur_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #7

**来源**: [CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md](../2022/CVE-2022-26134-MaskCyberSecurityTeam_CVE-2022-26134_Behinder_MemShell.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。 

**有效性:** 根据漏洞库信息，搜索结果和漏洞利用代码，可以确定提供的POC代码有效。搜索引擎结果显示该漏洞已被积极利用。 

**投毒风险:**  提供的漏洞利用代码包含一个简单的Java模块配置文件、LICENSE文本和一个iml文件，主要功能是构建和加载恶意类。虽然看起来像是用于内存马，本身实现的功能为正常漏洞利用范畴，但存在轻微投毒风险，如编译后植入恶意代码、依赖污染等，判定投毒风险为10%。

**利用方式:** 攻击者通过发送特制的HTTP请求，在请求中包含恶意的OGNL表达式，Confluence服务器在处理请求时未正确过滤或转义该表达式，导致OGNL表达式被执行，从而实现远程代码执行。攻击者可以在服务器上执行任意命令，安装恶意软件，窃取敏感数据或控制整个系统。 内存马可以直接在内存中运行，不会在磁盘上留下痕迹，能够绕过常规的文件扫描和检测机制，实现持久化的控制。

**项目地址:** [MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell](https://github.com/MaskCyberSecurityTeam/CVE-2022-26134_Behinder_MemShell)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #8

**来源**: [CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md](../2022/CVE-2022-26134-Muhammad-Ali007_Atlassian_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 < Version < 7.13.7, 7.14.0 < Version < 7.14.3, 7.15.0 < Version < 7.15.2, 7.16.0 < Version < 7.16.4, 7.17.0 < Version < 7.17.4, 7.18.0 < Version < 7.18.1

**利用条件:** 目标Confluence服务可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入引起的。漏洞利用方式是通过构造恶意的 HTTP GET 请求，将包含 OGNL 表达式的 payload 注入到 URI 中，利用 Java 运行时的 `getRuntime().exec()` 方法执行任意系统命令。根据提供的漏洞利用代码，可以通过 curl 命令或 Python 脚本进行利用。风险在于，尽管提供的PoC主要用于验证和演示，但攻击者可能会修改利用代码以执行恶意操作，例如安装后门、窃取敏感数据或进行加密货币挖矿。仓库中可能存在投毒代码的风险较低，但无法完全排除，因为攻击者可能在 PoC 代码中插入恶意代码。在实际使用 PoC 前，务必进行代码审查。

**项目地址:** [Muhammad-Ali007/Atlassian_CVE-2022-26134](https://github.com/Muhammad-Ali007/Atlassian_CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #9

**来源**: [CVE-2022-26134-W01fh4cker_Serein.md](../2022/CVE-2022-26134-W01fh4cker_Serein.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在Confluence服务器上执行任意代码，完全控制服务器。

**漏洞利用方式:**

1.  攻击者发送特制的HTTP请求到Confluence服务器。
2.  请求中包含恶意的OGNL表达式。
3.  Confluence服务器解析OGNL表达式，导致任意代码执行。

**有效性评估:**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用。

**投毒风险分析:**

提供的代码库`Serein`是一个集成了多个漏洞利用的工具，其主要功能是批量利用各种漏洞。虽然集成了很多EXP，但是结合代码来看，作者添加恶意代码的可能性较低。但是依然存在一定的投毒风险，特别是考虑到代码库的复杂性以及集成了大量第三方漏洞利用代码，因此存在一定潜在风险。风险占比10%。

该`Serein`工具的使用者应保持警惕，仔细审查任何外部提供的漏洞利用代码，并在非生产环境中进行测试，以降低风险。

**项目地址:** [W01fh4cker/Serein](https://github.com/W01fh4cker/Serein)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #10

**来源**: [CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md](../2022/CVE-2022-26134-XiaomingX_cve-2022-26134-poc.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 需要目标Confluence实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是Atlassian Confluence Server和Data Center中的一个OGNL注入漏洞。攻击者可以通过发送特制的HTTP请求利用此漏洞，无需身份验证即可在Confluence服务器上执行任意代码。漏洞利用代码（POC）通常包含构造好的OGNL表达式，该表达式能够执行系统命令或加载恶意类。根据搜索结果，该漏洞在野外被积极利用，包括用于加密货币挖矿。提供的代码片段是Apache 2.0 许可证，不包含任何可执行的利用代码，因此不存在投毒风险。利用方式：攻击者发送包含恶意 OGNL 表达式的 HTTP 请求，Confluence 服务器解析该表达式并在服务器上执行，导致远程代码执行。

**项目地址:** [XiaomingX/cve-2022-26134-poc](https://github.com/XiaomingX/cve-2022-26134-poc)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---



---

## POC #11

**来源**: [CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md](../2022/CVE-2022-26134-Yuri08loveElaina_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #12

**来源**: [CVE-2022-26134-acfirthh_CVE-2022-26134.md](../2022/CVE-2022-26134-acfirthh_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #13

**来源**: [CVE-2022-26134-b4dboy17_CVE-2022-26134.md](../2022/CVE-2022-26134-b4dboy17_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以通过发送特制的请求到目标服务器，利用该漏洞执行任意代码。漏洞的根本原因是Confluence在处理用户输入时，未对OGNL表达式进行充分的验证和过滤，导致攻击者可以注入恶意的OGNL表达式，从而执行任意代码。从漏洞库信息来看，该漏洞影响多个版本的Confluence Server和Data Center。搜索引擎结果显示，该漏洞已被广泛利用，并被用于恶意挖矿等活动。漏洞利用代码（POC）提供了一个Python脚本，该脚本通过构造包含恶意OGNL表达式的HTTP请求，来利用该漏洞。该脚本首先尝试获取目标Confluence实例的版本信息，然后构造并发送包含恶意OGNL表达式的HTTP请求。如果目标服务器存在漏洞，该请求将导致目标服务器执行任意代码，并将结果返回给攻击者。脚本使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应。POC代码本身相对简单，但由于OGNL表达式的强大功能，攻击者可以利用它执行各种恶意操作，包括读取敏感文件、执行系统命令和安装恶意软件。投毒风险分析：POC代码主体功能明确，主要功能是发送包含OGNL表达式的请求，没有发现明显的后门代码。但是，存在轻微的投毒风险：攻击者可以修改`command`变量，注入恶意的系统命令，从而将恶意软件安装到目标服务器上。例如，攻击者可以将`command`变量设置为下载和执行恶意脚本的命令。由于POC本身具备远程代码执行能力，添加恶意命令会进一步扩大攻击范围。因此，评判投毒风险为10%。利用方式总结：

1.  **确定目标：** 攻击者首先需要确定目标Confluence实例，并确认其版本是否在受影响的范围内。
2.  **构造Payload：** 攻击者需要构造包含恶意OGNL表达式的Payload。Payload的具体内容取决于攻击者的目的，例如，读取`/etc/passwd`文件或执行系统命令。
3.  **发送请求：** 攻击者需要将构造好的Payload嵌入到HTTP请求中，并发送到目标Confluence实例。根据POC代码，Payload可以作为URL的一部分发送。
4.  **执行代码：** 如果目标服务器存在漏洞，且Payload构造正确，目标服务器将执行Payload中包含的恶意代码。
5.  **获取结果：** 攻击者可以通过查看HTTP响应头或服务器日志来获取执行结果。

**项目地址:** [b4dboy17/CVE-2022-26134](https://github.com/b4dboy17/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #14

**来源**: [CVE-2022-26134-cbk914_CVE-2022-26134_check.md](../2022/CVE-2022-26134-cbk914_CVE-2022-26134_check.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #15

**来源**: [CVE-2022-26134-cc3305_CVE-2022-26134.md](../2022/CVE-2022-26134-cc3305_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特殊的请求，利用该漏洞在 Confluence Server 或 Data Center 实例上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，并且存在公开的PoC代码。提供的PoC代码看起来有效，它构造了一个包含 OGNL 表达式的 URL，该表达式可以执行命令并将输出放在响应头中。

**投毒风险：**

提供的PoC代码没有明显的投毒代码。该代码的功能是利用 OGNL 注入漏洞执行指定的命令，没有发现任何其他恶意行为。投毒风险评估为 0%。

**利用方式：**

1.  攻击者构造一个包含恶意 OGNL 表达式的 URL。
2.  该 URL 被发送到目标 Confluence Server 或 Data Center 实例。
3.  Confluence 服务器解析该 OGNL 表达式，导致执行攻击者指定的任意代码。
4.  命令执行的结果通过 HTTP 响应头返回。

**项目地址:** [cc3305/CVE-2022-26134](https://github.com/cc3305/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #16

**来源**: [CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md](../2022/CVE-2022-26134-f4yd4-s3c_cve-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #17

**来源**: [CVE-2022-26134-kelemaoya_CVE-2022-26134.md](../2022/CVE-2022-26134-kelemaoya_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence实例在受影响版本范围内，且攻击者能够通过网络访问Confluence服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadoghq 等安全厂商均有报告）以及提供的 PoC 代码，该漏洞的有效性极高，且在野利用情况广泛。

**投毒风险：**
PoC代码主要功能是验证漏洞是否存在，即通过 OGNL 注入执行 `id` 命令，并将结果通过 HTTP 响应头返回。虽然 PoC 执行了系统命令，但这属于漏洞验证的正常行为，PoC 主要作用是漏洞验证和利用，本身不算是恶意投毒代码。但是`README.md`中提到的安装方式`pip3 install -r requirements.txt`,可能存在投毒的风险,通过分析给出的代码,投毒的概率大约是10%,代码本身没有发现明显的恶意行为。

**利用方式：**
利用方式是通过构造包含恶意 OGNL 表达式的 URL，发送到存在漏洞的 Confluence Server 或 Data Center 实例。PoC 代码中的 URL 构造方式为：`self.url.strip() + "/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"`。该 URL 包含一个 OGNL 表达式，该表达式执行 `id` 命令，并将输出写入 HTTP 响应头 `X-Cmd-Response`。攻击者可以将 `id` 命令替换为其他命令，从而在目标系统上执行任意代码。由于漏洞未经身份验证，攻击者无需任何凭据即可利用此漏洞。

**项目地址:** [kelemaoya/CVE-2022-26134](https://github.com/kelemaoya/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #18

**来源**: [CVE-2022-26134-latings_CVE-2022-26134.md](../2022/CVE-2022-26134-latings_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要目标Confluence服务器开放网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息，未经身份验证的攻击者可以利用此漏洞在 Confluence 服务器或数据中心实例上执行任意代码。受影响的版本包括从 1.3.0 到 7.4.17，以及 7.13.0 到 7.18.1 之间的一些版本。

**有效性分析：**
根据搜索引擎结果，该漏洞存在活跃利用，且有多个安全厂商发布了关于此漏洞的分析和检测方法。提供的POC代码 `CVE-2022-26134.py` 通过构造包含恶意 OGNL 表达式的 URL，尝试在目标服务器上执行 `id` 命令，并通过 `X-Cmd-Response` header 返回执行结果。如果返回结果包含 `uid=`，则判断漏洞存在。这个POC代码可以有效验证漏洞的存在。

**投毒风险分析：**
检查提供的 POC 代码后，发现代码主要功能是发送包含 OGNL 表达式的 HTTP 请求来验证漏洞。`requests.get` 函数用于发送请求，并且设置了用户代理，header信息。虽然POC中发送的OGNL表达式可以执行任意命令，但是当前提供的代码是为了验证漏洞而执行`id`命令，其本身不具备长期驻留或者维持权限的能力。同时，该POC并没有发现明显的文件写入、修改等恶意操作，初步判断不存在直接的恶意投毒行为。但由于OGNL注入本身可以执行任意代码，如果被滥用，可能导致服务器被植入恶意软件。因此，认为存在较低的投毒风险，可能性为10%。

**利用方式：**
该漏洞的利用方式是通过构造恶意的HTTP请求，该请求包含OGNL表达式，目标Confluence服务器在处理请求时，由于未对OGNL表达式进行充分的过滤，导致OGNL表达式被执行，从而实现远程代码执行。具体来说，POC中使用了如下的payload:

```
/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
```
这个payload通过OGNL表达式执行`id`命令，并将结果写入HTTP Response Header中。攻击者可以修改`exec()`中的命令，执行任意代码。

**结论：**
该漏洞是一个严重的安全问题，允许未经身份验证的远程代码执行。提供的POC代码可以有效验证漏洞的存在，但潜在的投毒风险较低，主要风险在于攻击者可能利用该漏洞植入恶意软件。建议尽快升级Confluence版本到安全版本。

**项目地址:** [latings/CVE-2022-26134](https://github.com/latings/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #19

**来源**: [CVE-2022-26134-mr-won_cve-2022-26134.md](../2022/CVE-2022-26134-mr-won_cve-2022-26134.md)

## CVE-2022-26134 Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence 服务可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 漏洞是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞，允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响多个 Confluence 版本。漏洞利用代码（POC）仓库中的 `README.md` 文件表明存在利用此漏洞的尝试。 

**有效性：**根据Rapid7、Qualys、Unit 42 和 NVD 的报告，此漏洞已被积极利用，表明该漏洞的 POC 代码可能有效。Packet Storm Security也发布了多个相关的POC。

**投毒风险：** 提供的漏洞利用代码信息非常有限，只有一个`README.md`文件，无法确认是否存在投毒代码。由于仅包含README文件，假设仓库作者有动机进行投毒，但缺乏实际代码无法确认，因此推测投毒风险较低，约为10%。

**利用方式：** 该漏洞的利用方式是通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 实例中，从而实现远程代码执行。从搜索结果来看，攻击者可能利用此漏洞进行加密货币挖矿或其他恶意活动。

**项目地址:** [mr-won/cve-2022-26134](https://github.com/mr-won/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #20

**来源**: [CVE-2022-26134-nxtexploit_CVE-2022-26134.md](../2022/CVE-2022-26134-nxtexploit_CVE-2022-26134.md)

## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例对外开放，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**

提供的POC代码有效。搜索引擎结果表明该漏洞在野外被积极利用(webpage 0, 5, 6)。该POC代码可以检测目标Confluence的版本，并发送包含OGNL表达式的payload，从而在目标服务器上执行命令。它通过设置HTTP Header `X-Cmd-Response`来获取命令执行的结果。

**投毒风险：**

该仓库的投毒风险较低。代码较为简洁，主要功能是利用OGNL注入执行命令。虽然存在引入恶意依赖的可能性，但`requirements.txt`中只包含`bs4`, `requests`, `urllib3`这三个常用的库，被投毒的可能性不大。代码逻辑主要是构造Payload，执行命令，没有发现明显的后门代码。但仍存在一定风险，例如作者可能在之后版本引入恶意代码，或者利用依赖关系进行投毒。因此，投毒风险估计为10%。

**利用方式：**

1.  **版本检测：** POC 首先尝试从 `/login.action` 页面提取 Confluence 的版本信息，用于确定目标是否在受影响的范围内。
2.  **Payload 构造：**  POC 通过 URL 编码构造包含 OGNL 表达式的 Payload。该 Payload 利用 `org.apache.commons.io.IOUtils` 读取 Runtime 执行命令后的输入流，然后将结果设置到 HTTP 响应头的 `X-Cmd-Response` 字段中。
3.  **漏洞触发：**  POC 通过向目标 Confluence 实例发送包含 Payload 的 GET 请求来触发漏洞。
4.  **结果获取：**  POC 检查 HTTP 响应状态码是否为 302，如果是，则从响应头 `X-Cmd-Response` 中获取命令执行的结果。

**项目地址:** [nxtexploit/CVE-2022-26134](https://github.com/nxtexploit/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #21

**来源**: [CVE-2022-26134-p4b3l1t0_confusploit.md](../2022/CVE-2022-26134-p4b3l1t0_confusploit.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过此漏洞在受影响的 Confluence 实例上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被广泛利用，且POC代码已经公开，证明其有效性。多个安全厂商（如Rapid7, Qualys, Palo Alto Networks, Darktrace, Trend Micro, Akamai, Splunk, Sysdig, Datadog）的分析和博客文章都证实了该漏洞的活跃利用。

**投毒风险：**
分析提供的POC代码，发现`confusploit.py`脚本主要功能是发送包含 OGNL 表达式的 HTTP 请求，并从响应头中提取命令执行结果。 该脚本结构清晰，没有明显的恶意代码或后门。风险主要在于使用者执行此脚本针对未授权的目标进行渗透测试，从而造成的法律风险，而非代码本身的投毒。 `requirements.txt` 文件中包含的库都是常见的安全测试工具包，没有发现可疑的第三方库。`readme.md`中提示仅用于合法的用途。

`check_vesion` 函数检查 Confluence 的版本，`send_payload` 函数通过构造 OGNL 表达式将命令注入到 URL 中，从而执行任意命令。因此脚本的主要作用是辅助漏洞利用，风险较低。

评估仓库投毒的可能性为10%，因为任何下载和使用第三方工具都存在一定的风险，虽然代码本身看似无害，但作者可能在未来版本中引入恶意代码，或者存在其他的安全风险。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被 Confluence 服务器解析并执行，导致任意代码执行。
3.  攻击者可以在 Confluence 服务器上执行任意命令，例如安装恶意软件、窃取数据或控制服务器。

攻击者通过发送特制的HTTP GET请求，并在URL中包含恶意的OGNL表达式来实现远程代码执行。此表达式允许攻击者执行任意系统命令，并将结果通过HTTP响应头返回。


**项目地址:** [p4b3l1t0/confusploit](https://github.com/p4b3l1t0/confusploit)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #22

**来源**: [CVE-2022-26134-redhuntlabs_ConfluentPwn.md](../2022/CVE-2022-26134-redhuntlabs_ConfluentPwn.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #23

**来源**: [CVE-2022-26134-thetowsif_CVE-2022-26134.md](../2022/CVE-2022-26134-thetowsif_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #24

**来源**: [CVE-2022-26134-wjlin0_CVE-2022-26134.md](../2022/CVE-2022-26134-wjlin0_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #25

**来源**: [CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md](../2022/CVE-2022-26134-xanszZZ_ATLASSIAN-Confluence_rce.md)

## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #26

**来源**: [CVE-2022-26134-xsxtw_CVE-2022-26134.md](../2022/CVE-2022-26134-xsxtw_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #27

**来源**: [CVE-2022-26134-yTxZx_CVE-2022-26134.md](../2022/CVE-2022-26134-yTxZx_CVE-2022-26134.md)

## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例需要存在于受影响的版本范围内，且攻击者能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造特定的 HTTP 请求，向存在漏洞的 Confluence 实例注入恶意的 OGNL 表达式，从而执行任意代码。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞已被广泛确认，并且存在公开的PoC利用代码。搜索结果显示存在活跃的漏洞利用案例，表明该漏洞的有效性很高。

**投毒风险分析：**
提供的PoC代码 (CVE-2022-26134.py) 主要功能是发送包含恶意 OGNL 表达式的 HTTP 请求，并根据返回头中的特定字段（X-Qualys-Response）判断漏洞是否成功利用。代码本身包含以下功能：

*   **漏洞利用：**  通过构造包含 OGNL 表达式的 URL，向目标 Confluence 服务器发送请求。
*   **结果判断：**  检查响应头中是否存在 `X-Qualys-Response` 字段，以确定命令是否执行成功。
*   **批量处理：**  支持从文件中读取多个目标 URL 进行批量漏洞扫描。
*   **结果输出：**  将成功利用漏洞的 URL 输出到 Excel 文件中。

对PoC代码进行了仔细分析，未发现明显的恶意代码，例如反向shell，downloader等。PoC主要用于验证漏洞是否存在和执行用户指定的命令。但是，任何允许远程代码执行的漏洞都存在被滥用的风险。攻击者可以修改该PoC以植入恶意软件或执行其他恶意行为。

**投毒风险：** 低，代码主要功能是验证漏洞，虽然存在被修改后进行恶意利用的可能性，但是代码本身不包含恶意功能。评估投毒风险为 5%。

**利用方式：**

1.  **构造恶意请求：**  攻击者需要构造包含 OGNL 表达式的 HTTP 请求。该表达式会被 Confluence 服务器解析并执行。
2.  **发送请求：**  将构造好的请求发送到目标 Confluence 服务器的特定 URL。
3.  **执行任意代码：**  如果目标服务器存在漏洞，且 OGNL 表达式构造正确，服务器会执行攻击者指定的代码。
4.  **获取结果：**  攻击者可以通过多种方式获取代码执行的结果，例如通过 DNS 查询、写入文件或通过 HTTP 响应头。

**POC利用分析：**
此POC通过在URL中插入特殊构造的OGNL表达式，利用Confluence服务器的漏洞执行命令。它通过修改HTTP响应头 `X-Qualys-Response` 来回显命令执行的结果，从而验证漏洞的存在。该脚本还支持批量扫描和将结果输出到Excel文件，这对于大规模漏洞评估和渗透测试非常有用。

**项目地址:** [yTxZx/CVE-2022-26134](https://github.com/yTxZx/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

## POC #28

**来源**: [CVE-2022-26134-yyqxi_CVE-2022-26134.md](../2022/CVE-2022-26134-yyqxi_CVE-2022-26134.md)

## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** 目标Confluence实例可访问且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。根据漏洞库信息和搜索结果，这是一个已被广泛利用的漏洞，多个安全公司都发布了关于此漏洞的报告。提供的 POC 代码利用 OGNL 注入，通过构造特定的 URL，执行 `id` 命令，并将结果设置在响应头 `X-Cmd-Response` 中。通过检查响应头，可以验证漏洞是否存在。代码中未发现任何隐藏的投毒代码。漏洞利用有效性高，影响严重，应尽快修复。

**项目地址:** [yyqxi/CVE-2022-26134](https://github.com/yyqxi/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)

---

