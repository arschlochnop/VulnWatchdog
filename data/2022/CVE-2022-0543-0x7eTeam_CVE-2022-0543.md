# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

# CVE-2022-0543

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0543-0x7eTeam_CVE-2022-0543.md](../2022/CVE-2022-0543-0x7eTeam_CVE-2022-0543.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian specific packaging issue, version N/A

**利用条件:** 需要Redis服务器运行在存在此漏洞的Debian系统上，并且允许用户执行Lua脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543 是一个 Debian 版本的 Redis 中的 Lua 沙箱逃逸漏洞，允许攻击者执行任意命令。

**有效性:**
提供的 POC 代码 `CVE-2022-0543.py` 看上去是有效的。它利用了 Redis 的 `eval` 命令执行 Lua 脚本，绕过沙箱执行系统命令。代码首先加载 `/usr/lib/x86_64-linux-gnu/liblua5.1.so.0` 这个动态库，然后使用 `io.popen` 执行 shell 命令，并将结果返回。

**投毒风险:**
代码中没有明显的投毒行为。它直接利用了已知的 Lua 沙箱逃逸技术，利用 `package.loadlib` 和 `io.popen` 函数执行系统命令。代码相对简单，主要功能是执行用户输入的命令。README.md文件只是简单的使用说明，也没有投毒代码。因此，投毒风险为0%。

**利用方式:**
1.  攻击者首先需要连接到存在漏洞的 Redis 服务器，并且Redis服务器运行在debian系统上。
2.  攻击者执行 `CVE-2022-0543.py` 脚本，指定 Redis 服务器的 IP 地址、端口以及密码(如果需要身份验证)。
3.  脚本会提示攻击者输入要执行的命令。
4.  脚本使用 `redis.eval` 命令执行构造的 Lua 脚本。
5.  Lua 脚本利用 `package.loadlib` 加载 `liblua5.1.so.0`，然后使用 `io.popen` 执行指定的系统命令。
6.  命令执行的结果会被返回给攻击者。

此漏洞利用依赖于 Debian 系统特定的 Redis 打包问题，因此只影响运行在 Debian 系统上的 Redis 服务器。

**项目地址:** [0x7eTeam/CVE-2022-0543](https://github.com/0x7eTeam/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---



---

## POC #2

**来源**: [CVE-2022-0543-JacobEbben_CVE-2022-0543.md](../2022/CVE-2022-0543-JacobEbben_CVE-2022-0543.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #3

**来源**: [CVE-2022-0543-SiennaSkies_redisHack.md](../2022/CVE-2022-0543-SiennaSkies_redisHack.md)

## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #4

**来源**: [CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md](../2022/CVE-2022-0543-netw0rk7_CVE-2022-0543-Home-Lab.md)

## CVE-2022-0543 - Redis Lua Sandbox Escape

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua Sandbox Escape

**影响应用:** Redis (Debian Package)

**危害等级:** 高危，远程代码执行

**影响版本:** Debian/Ubuntu packages before DSA-5081-1

**利用条件:** Redis must be installed via Debian/Ubuntu package, Lua modules must be loaded dynamically, and Redis must be accessible without authentication (or attacker has credentials).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis 远程代码执行漏洞，由不正确的 Lua 沙盒导致。Debian 包动态加载 Lua 模块，暴露了 `package.loadlib()`，允许完全逃逸沙箱并执行主机操作系统命令。 

**有效性:**
提供的 Dockerfile 通过指定 snapshot.debian.org 的历史版本，安装了受影响的 Redis 版本 (5:5.0.14-1+deb10u1)。它还安装了 `lua-cjson` 和 `lua-bitop`，这使得漏洞更容易被利用。提供的 `docker-compose.yml` 和 `entrypoint.sh` 脚本用于启动 Redis 实例，而 `redis.conf` 配置文件打开了 Redis 的网络端口，且未设置密码，使得未经身份验证的攻击成为可能。PoC 地址 `https://github.com/0x7eTeam/CVE-2022-0543` 包含利用此漏洞的代码，表明该漏洞是可以利用的。

**投毒风险:**
虽然提供的 Dockerfile 和脚本是为了复现漏洞，但仍然存在轻微的投毒风险。`entrypoint.sh` 脚本包含一个生成 flag 的函数，但这个函数本身并没有恶意。风险在于脚本中使用的命令，例如 `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 8`  和  `tr -dc 'A-Za-z0-9' </dev/urandom | head -c 32`，虽然看起来无害，但如果恶意修改成可以下载并执行额外脚本，或者写入特定文件来修改系统行为，理论上存在投毒的可能。 此外，Dockerfile 通过 `apt-get install` 安装了 `vim` 和 `nano`，攻击者可能将预先配置的恶意配置文件嵌入到 docker 镜像中,虽然这种攻击的可能性较低，但是无法排除,因此给出 5% 的投毒风险。

**利用方式:**
利用方式如下：
1.  攻击者连接到未授权的 Redis 实例。
2.  攻击者使用 Lua 脚本执行 `package.loadlib()`。
3.  利用 `package.loadlib()` 加载系统库，逃逸 Lua 沙箱。
4.  执行任意系统命令，例如读取 flag 文件或其他敏感信息。
5. 攻击者也可以通过修改redis配置文件、上传恶意模块等方式实现持久化攻击。

**项目地址:** [netw0rk7/CVE-2022-0543-Home-Lab](https://github.com/netw0rk7/CVE-2022-0543-Home-Lab)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

## POC #5

**来源**: [CVE-2022-0543-z92g_CVE-2022-0543.md](../2022/CVE-2022-0543-z92g_CVE-2022-0543.md)

## CVE-2022-0543 Redis Lua 沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua 沙箱逃逸

**影响应用:** Redis (Debian specific)

**危害等级:** 高危，远程代码执行

**影响版本:** n/a (Debian packaging issue)

**利用条件:** 目标 Redis 服务器运行在 Debian 环境，存在 Debian 特定的 Lua 库路径问题

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0543 是一个 Debian 特定的 Redis Lua 沙箱逃逸漏洞。由于 Debian 的 Redis 打包方式问题，Lua 运行库的路径与 Redis 期望的路径不一致，导致可以通过 Lua 脚本逃逸沙箱，执行任意系统命令。

**有效性：**

提供的 Go 语言 POC 代码看起来有效。它连接到 Redis 服务器，然后利用 Lua 脚本中的 `package.loadlib` 和 `io.popen` 函数来执行系统命令。代码通过命令行参数指定目标 Redis 服务器的地址、用户名、密码和数据库，并提供了一个交互式控制台来执行命令。

**投毒风险：**

代码本身直接利用漏洞，风险较低。 主要风险点在于代码在每次循环中都重新创建一个新的Redis客户端连接, 如果在高并发下可能导致资源耗尽。以及代码中使用的liblua路径`/usr/lib/x86_64-linux-gnu/liblua5.1.so.0`写死了, 可能在其他debian环境上不适用,导致利用失败。README.md文件风险可忽略。

因此，我评估该漏洞利用代码的投毒风险为 5%。

**利用方式：**

1.  **连接 Redis 服务器：** 使用提供的 POC 代码，指定目标 Redis 服务器的 IP 地址、端口、用户名、密码和数据库。代码会尝试连接到 Redis 服务器。
2.  **利用 Lua 脚本执行命令：** 连接成功后，POC 代码会使用 `EVAL` 命令执行 Lua 脚本。该 Lua 脚本使用 `package.loadlib` 加载 Lua 的 I/O 库，然后使用 `io.popen` 执行系统命令。执行的结果会被读取并返回。
3.  **交互式执行命令：** POC 代码提供了一个交互式控制台，允许攻击者输入任意系统命令，这些命令将在目标服务器上执行。输入 "q" 退出程序。
4.  **免责声明：** README.md 中声明此工具仅用于学习、研究和自查，不应用于非法目的。

**项目地址:** [z92g/CVE-2022-0543](https://github.com/z92g/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

---

