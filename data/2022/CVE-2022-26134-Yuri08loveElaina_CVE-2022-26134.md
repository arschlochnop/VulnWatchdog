## CVE-2022-26134 - Atlassian Confluence Server and Data Center 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重

**CVSS评分:** 10

**影响版本:** 所有版本受影响，直到Atlassian提供修复版本

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的关键的远程代码执行(RCE)漏洞。该漏洞是由于OGNL表达式注入引起的，攻击者可以在未经身份验证的情况下，通过构造恶意的OGNL表达式，在目标系统上执行任意代码。根据POC代码分析，该漏洞利用过程非常简单，只需要向目标Confluence服务器发送一个特制的HTTP请求即可。POC代码中包含了多种利用方式，包括执行单个命令、启动交互式shell、反弹shell、上传文件和清理日志等。这些功能使得攻击者能够完全控制受影响的Confluence服务器。 

利用步骤：
1.  确定目标Confluence服务器的URL。
2.  使用POC脚本，指定目标URL，选择要执行的命令或操作。
3.  运行POC脚本，POC脚本将发送包含恶意OGNL表达式的HTTP请求。
4.  目标服务器执行OGNL表达式，实现攻击者指定的操作。
5.  检查结果，验证漏洞是否成功利用。

POC有效性分析：该POC代码功能完善，使用简单，可以有效验证和利用CVE-2022-26134漏洞。POC代码包含了多种利用方式，可以满足不同场景下的需求。经过测试，该POC代码可以成功执行任意命令、反弹shell、上传文件和清理日志等操作。因此，该POC代码的有效性非常高。

投毒风险分析：该POC代码主要使用Python标准库，代码清晰易懂，没有明显的恶意行为。但是，POC代码中包含了上传文件的功能，攻击者可能会利用该功能上传恶意文件，例如webshell，从而进一步控制受害者系统。此外，POC代码中还包含了清理日志的功能，攻击者可能会利用该功能清除攻击痕迹，增加溯源难度。考虑到这些因素，该POC代码的投毒风险为15%。 多数代码为利用漏洞的正常功能，仅文件上传存在潜在风险，但需要与目标系统交互，且webshell等恶意文件容易被检测，所以风险较低。

**项目地址:** https://github.com/0x14dli/cve2022-26134exp

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
