# CVE-2022-24834

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-24834-DukeSec97_CVE-2022-24834-.md](../2022/CVE-2022-24834-DukeSec97_CVE-2022-24834-.md)

## CVE-2022-24834-Redis-Lua cjson heap overflow

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** 6.0.0 < version < 6.0.20, 6.2.0 < version < 6.2.13, 7.0.0 < version < 7.0.12

**利用条件:** 需要Redis实例开启Lua脚本支持，且攻击者需要通过身份验证和授权访问Redis

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24834 漏洞是 Redis 中 Lua cjson 库的一个堆溢出漏洞。当 Redis 执行特别构造的 Lua 脚本时，可能触发 cjson 库中的堆溢出，导致堆破坏，甚至远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用是有效的。搜索结果中多个链接指向漏洞详情和利用分析，表明该漏洞已被广泛研究和利用。提供的 exploit.py 脚本，明确使用了 pwn 库与 Redis 实例进行交互，并执行包含反弹 shell 命令的 Lua 脚本，具备利用该漏洞进行远程代码执行的能力。

**投毒风险：**
提供的 exploit.py 脚本主要功能是利用 Redis 实例执行恶意 Lua 脚本，脚本从文件读取 Lua 代码，并将 bash 反弹 shell 命令嵌入其中。该脚本本身功能较为直接，没有发现任何隐藏的、与漏洞利用无关的代码或逻辑。此外，README.md 文件的内容也很简单，没有可疑之处。因此，此仓库中存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **准备环境：**搭建存在漏洞版本的Redis实例。
2.  **编写Lua脚本：**编写包含漏洞触发代码和恶意负载的Lua脚本,恶意负载是反弹shell。
3.  **执行利用代码：**运行提供的 `exploit.py` 脚本，指定目标 Redis 主机、端口，监听主机、端口和包含恶意 Lua 脚本的文件路径。
4.  **反弹Shell：**脚本会连接 Redis 实例，执行 Lua 脚本，Lua 脚本中的恶意代码会在 Redis 服务器上执行反弹 shell 命令。
5.  **控制服务器：**攻击者通过监听端口，获得 Redis 服务器的 shell，从而控制服务器。

**项目地址:** [DukeSec97/CVE-2022-24834-](https://github.com/DukeSec97/CVE-2022-24834-)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---

## POC #2

**来源**: [CVE-2022-24834-convisolabs_CVE-2022-24834.md](../2022/CVE-2022-24834-convisolabs_CVE-2022-24834.md)

# CVE-2022-24834

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-24834-DukeSec97_CVE-2022-24834-.md](../2022/CVE-2022-24834-DukeSec97_CVE-2022-24834-.md)

## CVE-2022-24834-Redis-Lua cjson heap overflow

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** 6.0.0 < version < 6.0.20, 6.2.0 < version < 6.2.13, 7.0.0 < version < 7.0.12

**利用条件:** 需要Redis实例开启Lua脚本支持，且攻击者需要通过身份验证和授权访问Redis

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24834 漏洞是 Redis 中 Lua cjson 库的一个堆溢出漏洞。当 Redis 执行特别构造的 Lua 脚本时，可能触发 cjson 库中的堆溢出，导致堆破坏，甚至远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用是有效的。搜索结果中多个链接指向漏洞详情和利用分析，表明该漏洞已被广泛研究和利用。提供的 exploit.py 脚本，明确使用了 pwn 库与 Redis 实例进行交互，并执行包含反弹 shell 命令的 Lua 脚本，具备利用该漏洞进行远程代码执行的能力。

**投毒风险：**
提供的 exploit.py 脚本主要功能是利用 Redis 实例执行恶意 Lua 脚本，脚本从文件读取 Lua 代码，并将 bash 反弹 shell 命令嵌入其中。该脚本本身功能较为直接，没有发现任何隐藏的、与漏洞利用无关的代码或逻辑。此外，README.md 文件的内容也很简单，没有可疑之处。因此，此仓库中存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **准备环境：**搭建存在漏洞版本的Redis实例。
2.  **编写Lua脚本：**编写包含漏洞触发代码和恶意负载的Lua脚本,恶意负载是反弹shell。
3.  **执行利用代码：**运行提供的 `exploit.py` 脚本，指定目标 Redis 主机、端口，监听主机、端口和包含恶意 Lua 脚本的文件路径。
4.  **反弹Shell：**脚本会连接 Redis 实例，执行 Lua 脚本，Lua 脚本中的恶意代码会在 Redis 服务器上执行反弹 shell 命令。
5.  **控制服务器：**攻击者通过监听端口，获得 Redis 服务器的 shell，从而控制服务器。

**项目地址:** [DukeSec97/CVE-2022-24834-](https://github.com/DukeSec97/CVE-2022-24834-)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---

## POC #2

**来源**: [CVE-2022-24834-convisolabs_CVE-2022-24834.md](../2022/CVE-2022-24834-convisolabs_CVE-2022-24834.md)

# CVE-2022-24834

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-24834-DukeSec97_CVE-2022-24834-.md](../2022/CVE-2022-24834-DukeSec97_CVE-2022-24834-.md)

## CVE-2022-24834-Redis-Lua cjson heap overflow

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** 6.0.0 < version < 6.0.20, 6.2.0 < version < 6.2.13, 7.0.0 < version < 7.0.12

**利用条件:** 需要Redis实例开启Lua脚本支持，且攻击者需要通过身份验证和授权访问Redis

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24834 漏洞是 Redis 中 Lua cjson 库的一个堆溢出漏洞。当 Redis 执行特别构造的 Lua 脚本时，可能触发 cjson 库中的堆溢出，导致堆破坏，甚至远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用是有效的。搜索结果中多个链接指向漏洞详情和利用分析，表明该漏洞已被广泛研究和利用。提供的 exploit.py 脚本，明确使用了 pwn 库与 Redis 实例进行交互，并执行包含反弹 shell 命令的 Lua 脚本，具备利用该漏洞进行远程代码执行的能力。

**投毒风险：**
提供的 exploit.py 脚本主要功能是利用 Redis 实例执行恶意 Lua 脚本，脚本从文件读取 Lua 代码，并将 bash 反弹 shell 命令嵌入其中。该脚本本身功能较为直接，没有发现任何隐藏的、与漏洞利用无关的代码或逻辑。此外，README.md 文件的内容也很简单，没有可疑之处。因此，此仓库中存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **准备环境：**搭建存在漏洞版本的Redis实例。
2.  **编写Lua脚本：**编写包含漏洞触发代码和恶意负载的Lua脚本,恶意负载是反弹shell。
3.  **执行利用代码：**运行提供的 `exploit.py` 脚本，指定目标 Redis 主机、端口，监听主机、端口和包含恶意 Lua 脚本的文件路径。
4.  **反弹Shell：**脚本会连接 Redis 实例，执行 Lua 脚本，Lua 脚本中的恶意代码会在 Redis 服务器上执行反弹 shell 命令。
5.  **控制服务器：**攻击者通过监听端口，获得 Redis 服务器的 shell，从而控制服务器。

**项目地址:** [DukeSec97/CVE-2022-24834-](https://github.com/DukeSec97/CVE-2022-24834-)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---

## POC #2

**来源**: [CVE-2022-24834-convisolabs_CVE-2022-24834.md](../2022/CVE-2022-24834-convisolabs_CVE-2022-24834.md)

# CVE-2022-24834

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-24834-DukeSec97_CVE-2022-24834-.md](../2022/CVE-2022-24834-DukeSec97_CVE-2022-24834-.md)

## CVE-2022-24834-Redis-Lua cjson heap overflow

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** 6.0.0 < version < 6.0.20, 6.2.0 < version < 6.2.13, 7.0.0 < version < 7.0.12

**利用条件:** 需要Redis实例开启Lua脚本支持，且攻击者需要通过身份验证和授权访问Redis

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24834 漏洞是 Redis 中 Lua cjson 库的一个堆溢出漏洞。当 Redis 执行特别构造的 Lua 脚本时，可能触发 cjson 库中的堆溢出，导致堆破坏，甚至远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用是有效的。搜索结果中多个链接指向漏洞详情和利用分析，表明该漏洞已被广泛研究和利用。提供的 exploit.py 脚本，明确使用了 pwn 库与 Redis 实例进行交互，并执行包含反弹 shell 命令的 Lua 脚本，具备利用该漏洞进行远程代码执行的能力。

**投毒风险：**
提供的 exploit.py 脚本主要功能是利用 Redis 实例执行恶意 Lua 脚本，脚本从文件读取 Lua 代码，并将 bash 反弹 shell 命令嵌入其中。该脚本本身功能较为直接，没有发现任何隐藏的、与漏洞利用无关的代码或逻辑。此外，README.md 文件的内容也很简单，没有可疑之处。因此，此仓库中存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **准备环境：**搭建存在漏洞版本的Redis实例。
2.  **编写Lua脚本：**编写包含漏洞触发代码和恶意负载的Lua脚本,恶意负载是反弹shell。
3.  **执行利用代码：**运行提供的 `exploit.py` 脚本，指定目标 Redis 主机、端口，监听主机、端口和包含恶意 Lua 脚本的文件路径。
4.  **反弹Shell：**脚本会连接 Redis 实例，执行 Lua 脚本，Lua 脚本中的恶意代码会在 Redis 服务器上执行反弹 shell 命令。
5.  **控制服务器：**攻击者通过监听端口，获得 Redis 服务器的 shell，从而控制服务器。

**项目地址:** [DukeSec97/CVE-2022-24834-](https://github.com/DukeSec97/CVE-2022-24834-)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---

## POC #2

**来源**: [CVE-2022-24834-convisolabs_CVE-2022-24834.md](../2022/CVE-2022-24834-convisolabs_CVE-2022-24834.md)

# CVE-2022-24834

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-24834-DukeSec97_CVE-2022-24834-.md](../2022/CVE-2022-24834-DukeSec97_CVE-2022-24834-.md)

## CVE-2022-24834-Redis-Lua cjson heap overflow

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** 6.0.0 < version < 6.0.20, 6.2.0 < version < 6.2.13, 7.0.0 < version < 7.0.12

**利用条件:** 需要Redis实例开启Lua脚本支持，且攻击者需要通过身份验证和授权访问Redis

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24834 漏洞是 Redis 中 Lua cjson 库的一个堆溢出漏洞。当 Redis 执行特别构造的 Lua 脚本时，可能触发 cjson 库中的堆溢出，导致堆破坏，甚至远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用是有效的。搜索结果中多个链接指向漏洞详情和利用分析，表明该漏洞已被广泛研究和利用。提供的 exploit.py 脚本，明确使用了 pwn 库与 Redis 实例进行交互，并执行包含反弹 shell 命令的 Lua 脚本，具备利用该漏洞进行远程代码执行的能力。

**投毒风险：**
提供的 exploit.py 脚本主要功能是利用 Redis 实例执行恶意 Lua 脚本，脚本从文件读取 Lua 代码，并将 bash 反弹 shell 命令嵌入其中。该脚本本身功能较为直接，没有发现任何隐藏的、与漏洞利用无关的代码或逻辑。此外，README.md 文件的内容也很简单，没有可疑之处。因此，此仓库中存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **准备环境：**搭建存在漏洞版本的Redis实例。
2.  **编写Lua脚本：**编写包含漏洞触发代码和恶意负载的Lua脚本,恶意负载是反弹shell。
3.  **执行利用代码：**运行提供的 `exploit.py` 脚本，指定目标 Redis 主机、端口，监听主机、端口和包含恶意 Lua 脚本的文件路径。
4.  **反弹Shell：**脚本会连接 Redis 实例，执行 Lua 脚本，Lua 脚本中的恶意代码会在 Redis 服务器上执行反弹 shell 命令。
5.  **控制服务器：**攻击者通过监听端口，获得 Redis 服务器的 shell，从而控制服务器。

**项目地址:** [DukeSec97/CVE-2022-24834-](https://github.com/DukeSec97/CVE-2022-24834-)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---

## POC #2

**来源**: [CVE-2022-24834-convisolabs_CVE-2022-24834.md](../2022/CVE-2022-24834-convisolabs_CVE-2022-24834.md)

# CVE-2022-24834

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-24834-DukeSec97_CVE-2022-24834-.md](../2022/CVE-2022-24834-DukeSec97_CVE-2022-24834-.md)

## CVE-2022-24834-Redis-Lua cjson heap overflow

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** 6.0.0 < version < 6.0.20, 6.2.0 < version < 6.2.13, 7.0.0 < version < 7.0.12

**利用条件:** 需要Redis实例开启Lua脚本支持，且攻击者需要通过身份验证和授权访问Redis

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24834 漏洞是 Redis 中 Lua cjson 库的一个堆溢出漏洞。当 Redis 执行特别构造的 Lua 脚本时，可能触发 cjson 库中的堆溢出，导致堆破坏，甚至远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的利用是有效的。搜索结果中多个链接指向漏洞详情和利用分析，表明该漏洞已被广泛研究和利用。提供的 exploit.py 脚本，明确使用了 pwn 库与 Redis 实例进行交互，并执行包含反弹 shell 命令的 Lua 脚本，具备利用该漏洞进行远程代码执行的能力。

**投毒风险：**
提供的 exploit.py 脚本主要功能是利用 Redis 实例执行恶意 Lua 脚本，脚本从文件读取 Lua 代码，并将 bash 反弹 shell 命令嵌入其中。该脚本本身功能较为直接，没有发现任何隐藏的、与漏洞利用无关的代码或逻辑。此外，README.md 文件的内容也很简单，没有可疑之处。因此，此仓库中存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **准备环境：**搭建存在漏洞版本的Redis实例。
2.  **编写Lua脚本：**编写包含漏洞触发代码和恶意负载的Lua脚本,恶意负载是反弹shell。
3.  **执行利用代码：**运行提供的 `exploit.py` 脚本，指定目标 Redis 主机、端口，监听主机、端口和包含恶意 Lua 脚本的文件路径。
4.  **反弹Shell：**脚本会连接 Redis 实例，执行 Lua 脚本，Lua 脚本中的恶意代码会在 Redis 服务器上执行反弹 shell 命令。
5.  **控制服务器：**攻击者通过监听端口，获得 Redis 服务器的 shell，从而控制服务器。

**项目地址:** [DukeSec97/CVE-2022-24834-](https://github.com/DukeSec97/CVE-2022-24834-)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---

## POC #2

**来源**: [CVE-2022-24834-convisolabs_CVE-2022-24834.md](../2022/CVE-2022-24834-convisolabs_CVE-2022-24834.md)

## CVE-2022-24834 - Redis Lua cjson 库堆溢出

**漏洞编号:** CVE-2022-24834

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致堆破坏和远程代码执行

**影响版本:** Redis 6.0.0 ~ 6.0.19, 6.2.0 ~ 6.2.12, 7.0.0 ~ 7.0.11

**利用条件:** 需要 Redis 实例开启 Lua 脚本支持，且攻击者需要通过认证和授权才能执行 Lua 脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-24834 是 Redis 中 Lua cjson 库的一个堆溢出漏洞。攻击者可以利用该漏洞执行任意代码。

**漏洞利用方式：**

1.  **漏洞成因：** 通过精心构造的 Lua 脚本，在调用 cjson 库处理 JSON 数据时，触发整数溢出，导致堆缓冲区溢出。
2.  **利用步骤：**
    *   攻击者需要连接到 Redis 实例，并通过认证。
    *   攻击者需要发送恶意的 Lua 脚本到 Redis 服务器执行。
    *   Lua 脚本利用 cjson 库的漏洞，实现堆溢出，覆盖内存。
    *   通过内存覆盖，攻击者可以修改程序执行流程，或者执行任意代码。
3.  **POC 分析：**
    *   提供的 POC 代码旨在绕过硬编码的偏移量，使其更通用。
    *   使用超大字符串以便于读取任意内存地址。
    *   使用 Lua 协程泄漏栈和 libc 地址。
    *   包含符号解析函数和自动 gadget 查找器。
    *   修改了原始 exploit.py 以使用 pwntools 并添加了反向 shell 处理程序。
    *   其中包含内存地址泄露，堆喷射等常见漏洞利用技巧。

**有效性：**

提供的 POC 代码已经过验证，可在多个 Redis 版本和环境中成功利用（Redis 7.0.11 和 6.2.12 在 Ubuntu 20.04 上通过 docker image 测试成功）。

**投毒风险：**

该漏洞利用代码具备一定的投毒风险。虽然 POC 的主要目的是利用漏洞，但仍然存在以下可能性：

*   **后门植入：** 攻击者可能修改 POC 代码，在成功利用漏洞后，在目标系统上植入后门，以便长期控制系统。
*   **拒绝服务：** 攻击者可能故意编写不稳定的 POC 代码，导致 Redis 服务器崩溃或拒绝服务。
*   **数据篡改：** 攻击者可能修改 POC 代码，在利用漏洞的过程中，篡改 Redis 数据库中的数据。

考虑到该 POC 代码包含从内存中dump信息的代码，并且修改了原始的利用代码，添加了一些额外的功能，因此，存在潜在的投毒风险的可能性。为了降低风险，使用前务必进行详细的安全审计。

**项目地址:** [convisolabs/CVE-2022-24834](https://github.com/convisolabs/CVE-2022-24834)

**漏洞详情:** [CVE-2022-24834](https://nvd.nist.gov/vuln/detail/CVE-2022-24834)

---



---



---



---



---



---

