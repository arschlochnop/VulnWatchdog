## CVE-2022-26134 - Atlassian Confluence Server and Data Center 远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 受影响版本范围未知，参考搜索结果和POC均为受影响版本

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个Atlassian Confluence Server和Data Center中的OGNL表达式注入远程代码执行漏洞。攻击者可以通过构造恶意的OGNL表达式，利用该漏洞在Confluence服务器上执行任意代码，从而完全控制服务器。根据搜索结果和POC代码，该漏洞的利用非常简单，无需认证，只需要发送一个包含恶意OGNL表达式的HTTP请求即可。

POC有效性分析：
根据多个搜索结果，已经有大量的公开POC可用于验证该漏洞。这些POC通常包含一个精心构造的HTTP请求，该请求将恶意OGNL表达式注入到Confluence服务器中。当服务器处理该请求时，OGNL表达式将被执行，从而允许攻击者执行任意命令。POC代码通常会执行一些简单的命令，如`whoami`或`id`，以验证漏洞是否成功利用。

利用步骤：
1.  确定目标Confluence服务器是否存在CVE-2022-26134漏洞。
2.  使用公开的POC代码或工具，构造一个包含恶意OGNL表达式的HTTP请求。
3.  将该请求发送到目标Confluence服务器。
4.  如果漏洞成功利用，服务器将执行恶意OGNL表达式并返回结果。
5.  攻击者可以使用该漏洞执行任意命令，例如安装后门程序或窃取敏感数据。


投毒风险分析：
由于该漏洞的利用非常简单，且有大量的公开POC可用，因此存在一定的投毒风险。攻击者可能会修改公开的POC代码，使其包含恶意代码，例如下载并执行恶意脚本。这些恶意脚本可能会在受害者系统上安装后门程序，或者窃取用户的敏感信息。由于漏洞本身是通过OGNL表达式注入实现的，攻击者可以在OGNL表达式中嵌入恶意代码，使得受害者难以察觉。此外，攻击者还可能利用该漏洞传播勒索软件或其他恶意软件。
在分析给出的POC代码时，发现代码主体较为简单，主要功能是漏洞验证，未发现明显的恶意行为，依赖的也是标准库。但是，由于其可以执行任意命令，因此，被修改后存在一定的投毒风险。假设攻击者修改了POC代码，在执行命令后，额外执行了下载恶意脚本并执行的命令，那么就实现了投毒攻击。考虑到漏洞利用的便捷性和潜在的危害，将投毒风险评估为10%。

**项目地址:** https://github.com/vulhub/vulhub/blob/master/confluence/CVE-2022-26134/README.zh-cn.md

**漏洞详情:** https://nvd.nist.gov/vuln/detail/cve-2022-26134
