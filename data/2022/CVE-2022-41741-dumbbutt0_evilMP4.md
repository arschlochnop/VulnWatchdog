# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

# CVE-2022-41741

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41741-dumbbutt0_evilMP4.md](../2022/CVE-2022-41741-dumbbutt0_evilMP4.md)

## CVE-2022-41741-NGINX-内存损坏

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** NGINX

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** NGINX Open Source < 1.23.2, NGINX Open Source < 1.22.1, NGINX Plus < R27 P1, NGINX Plus < R26 P1, NGINX Open Source Subscription < R2 P1, NGINX Open Source Subscription < R1 P1

**利用条件:** 需要目标系统启用了ngx_http_mp4_module模块，并且攻击者能够触发nginx处理特制的mp4文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41741是NGINX ngx_http_mp4_module模块中的一个漏洞，该漏洞允许本地攻击者破坏NGINX工作进程的内存，导致进程终止或产生其他潜在影响。该漏洞影响构建了ngx_http_mp4_module模块的NGINX产品，并且配置文件中使用了mp4指令。此外，只有当攻击者能够触发模块ngx_http_mp4_module处理特制的音频或视频文件时，攻击才有可能发生。

**有效性：**
提供的POC代码尝试通过修改MP4文件头部的atom size字段来实现越界读取。该方法符合漏洞描述，理论上是有效的。PoC代码的思路是通过构造畸形的MP4文件，使得nginx在解析MP4文件时，由于size字段不正确，导致越界读取，从而造成内存损坏。用户可自定义循环次数来调整size大小，达到更佳的攻击效果。

**投毒风险：**
代码主要功能是修改MP4文件，没有发现明显的恶意代码或后门，例如反弹shell、文件上传等。但是，仍然存在一定的投毒风险，虽然可能性较低，但无法完全排除：
1.  **细微的逻辑错误：** 细微的编码错误可能会导致非预期的行为，例如程序崩溃或资源耗尽。 虽然这不是直接的恶意行为，但可能会影响使用者的系统稳定性。
2.  **依赖项风险：** 代码依赖construct库。如果construct库本身存在漏洞，则可能通过该PoC传播。
3.  **误用风险：**  使用者可能会误用该PoC，例如在生产环境中进行测试，导致服务中断。虽然这不是作者的恶意行为，但仍然需要考虑。

因此，投毒风险评估为5%。

**利用方式：**
1.  **配置确认：** 确认目标NGINX服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
2.  **构造恶意MP4文件：** 使用提供的`evilmp4.py`脚本，指定循环次数,创建一个畸形的MP4文件。该脚本修改MP4文件头部的atom size字段，使其大于实际数据大小。
3.  **触发漏洞：** 将恶意的MP4文件放置在NGINX服务器可以访问的位置，并尝试通过HTTP请求访问该文件。如果NGINX服务器在处理该文件时出现崩溃或其他异常，则说明漏洞利用成功。
4.  **验证效果：** 观察NGINX工作进程的状态，确认是否由于内存损坏而崩溃。也可以尝试利用该漏洞读取敏感信息（如果攻击成功，且可以控制读取地址）。

**项目地址:** [dumbbutt0/evilMP4](https://github.com/dumbbutt0/evilMP4)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---



---

## POC #2

**来源**: [CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md](../2022/CVE-2022-41741-moften_CVE-2022-41741-742-Nginx-Vulnerability-Scanner.md)

## CVE-2022-41741 - Nginx ngx_http_mp4_module 内存损坏漏洞

**漏洞编号:** CVE-2022-41741

**漏洞类型:** 内存损坏

**影响应用:** Nginx

**危害等级:** 高危，可能导致Nginx工作进程崩溃或潜在的其他影响

**影响版本:** Mainline < 1.23.2, Stable < 1.22.1, Nginx Plus R27 < R27-p1, R1 < R26-p1, Nginx Open Source Subscription R2 < R2 P1, R1 < R1 P1

**利用条件:** 需要开启ngx_http_mp4_module模块，且攻击者能触发处理恶意构造的音视频文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41741是Nginx ngx_http_mp4_module模块中的一个内存损坏漏洞。本地攻击者可以通过构造恶意音视频文件，如果nginx配置中使用了mp4指令，并且攻击者可以触发Nginx处理该恶意文件，则可能导致Nginx工作进程的内存损坏，从而导致进程终止或其他潜在影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中`dumbbutt0/evilMP4`仓库提供工具和文档来演示漏洞。提供的Python脚本用于检测目标是否存在该漏洞，虽然它不是直接利用漏洞的exp，但可以验证漏洞是否存在，确定是否满足利用条件。

**投毒风险分析：**
提供的Python脚本主要是用于检测目标Nginx服务器是否存在CVE-2022-41741漏洞以及是否存在HTTP/2 Rapid Reset漏洞，并且README.md文件也只是对脚本的介绍。脚本本身没有发现明显的恶意代码或后门。但考虑到任何代码都存在潜在的风险，例如依赖库可能被篡改，或者未来作者可能会添加恶意代码，所以存在很小的投毒风险。风险评估：10%。

**利用方式分析：**
1.  **前提条件：**
    *   目标Nginx服务器启用了`ngx_http_mp4_module`模块，并在配置文件中使用了`mp4`指令。
    *   攻击者能够将恶意构造的音视频文件放置在Nginx服务器可以访问的位置，或者诱使用户上传恶意文件。
2.  **攻击步骤：**
    *   攻击者构造一个特制的MP4文件，该文件能够触发`ngx_http_mp4_module`模块中的内存损坏漏洞。
    *   攻击者通过HTTP请求访问该MP4文件，触发Nginx处理该文件。
    *   `ngx_http_mp4_module`模块在处理恶意MP4文件时，由于漏洞导致内存写入越界，可能导致Nginx工作进程崩溃或被恶意代码覆盖。
3.  **结果：**
    *   Nginx工作进程崩溃，导致服务中断。
    *   攻击者可能利用内存损坏漏洞执行任意代码，完全控制服务器。

**项目地址:** [moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner](https://github.com/moften/CVE-2022-41741-742-Nginx-Vulnerability-Scanner)

**漏洞详情:** [CVE-2022-41741](https://nvd.nist.gov/vuln/detail/CVE-2022-41741)

---

