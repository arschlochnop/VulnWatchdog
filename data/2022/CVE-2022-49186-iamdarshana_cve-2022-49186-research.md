## CVE-2022-49186 - Linux Kernel Privilege Escalation

**漏洞编号:** CVE-2022-49186

**漏洞类型:** Privilege Escalation

**影响应用:** Linux Kernel

**危害等级:** High

**CVSS评分:** 7.8

**影响版本:** 5.17.0 - 5.17.1

**利用条件:** Local access required

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

CVE-2022-49186 is a privilege escalation vulnerability present in the Visconti clock driver of the Linux kernel. The vulnerability stems from an array overflow due to a signed-to-unsigned conversion. Specifically, the `rs_id` field within the `visconti_clk_gate` struct, which is a signed 8-bit integer, is cast to an unsigned 8-bit integer when used as an index to access the `reset_controls` array. This can lead to out-of-bounds memory access. The provided proof-of-concept (POC) code includes a complete exploit, a vulnerable kernel module (`visconti_clk.c`), and a Makefile for building the module. The exploit code demonstrates how to trigger the array overflow and overwrite adjacent memory, specifically the `exploit_control` struct, to achieve privilege escalation to root. The steps to reproduce the exploit involve building the vulnerable kernel module, loading it into the kernel, and then executing the provided exploit. The `Makefile` simplifies the module build process, and the exploit itself is statically compiled using `gcc`. The provided README file includes build instructions. Successful exploitation allows an unprivileged user to gain root privileges on the system. The root cause is an integer overflow when accessing the `reset_controls` array, leading to arbitrary code execution after memory corruption. The poc code provided is effective, well structured and contains all the necessary components (vulnerable module and exploit code).

The provided POC code has a relatively low poisoning risk. The code is clear and well-commented, making it easy to understand its functionality. It primarily uses standard C libraries and Linux kernel APIs. While the exploit modifies kernel memory, this is an inherent part of the exploit's functionality and doesn't necessarily indicate malicious intent beyond the scope of the vulnerability. The Makefile contains standard commands and no suspicious activity. However, the risk isn't zero. An attacker could potentially modify the exploit code to perform other malicious actions after gaining root privileges. Also, the module loading process gives an attacker an oppurtunity to inject rootkit functions while the vulnerable module is being loaded. Therefore the poisoning risk is estimated to be around 15%. It's advisable to review and understand the code before execution, as with any exploit code.

**项目地址:** https://github.com/null/CVE-2022-49186

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-49186
