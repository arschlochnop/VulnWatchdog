## CVE-2022-26134 - Atlassian Confluence Server and Data Center 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (9.8)

**影响版本:** Confluence Server and Data Center versions before 7.4.17, from 7.13.0 before 7.13.7, from 7.14.0 before 7.14.3, from 7.15.0 before 7.15.2, from 8.0.0 before 8.0.3, from 8.1.0 before 8.1.3, and from 8.2.0 before 8.2.1

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个严重的 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造的请求，在受影响的服务器上执行任意代码，从而完全控制系统。该漏洞存在于 Confluence 的某些版本中，利用了 OGNL 表达式语言的处理不当。攻击者通过发送包含恶意 OGNL 表达式的 HTTP 请求，可以触发远程代码执行。此漏洞影响广泛，由于 Confluence 在企业环境中的普遍使用，使得其成为一个高价值的目标。

POC有效性分析：提供的Python POC代码 `CVE-2022-26134.py` 实现了对该漏洞的完整利用。代码首先定义了漏洞检测的功能，通过发送包含恶意 OGNL 表达式的特殊构造的HTTP请求到目标Confluence服务器，然后检查服务器的响应。如果服务器返回特定的状态码 (302) 且响应头中包含命令执行的回显，则表明漏洞存在且利用成功。该POC允许用户指定目标URL和要执行的命令，从而验证漏洞的存在并执行任意命令。POC利用了 `requests` 库发送HTTP请求，并使用 `colorama` 库进行彩色输出，方便用户识别。

利用步骤：
1.  安装Python环境和必要的库 (requests, colorama)。
2.  下载或复制提供的Python POC代码 `CVE-2022-26134.py`。
3.  修改POC代码，设置目标Confluence服务器的URL和要执行的命令。
4.  运行POC代码，观察输出结果。
5.  如果服务器存在漏洞，POC将显示命令执行的回显。

投毒风险分析：该POC的投毒风险较低，约为10%。代码主要使用了标准的Python库如 `requests`, `colorama` 和 `concurrent.futures`，没有发现明显的恶意行为或外部脚本调用。唯一的潜在风险在于，攻击者可能会修改POC代码，使其在执行命令后，进一步上传恶意文件或执行其他恶意操作。但是，原始POC代码本身并不包含这些功能。代码中禁用SSL验证 `requests.packages.urllib3.disable_warnings()` 可能会被滥用以绕过安全检查，但这不是直接的投毒行为。总体而言，该POC代码的结构清晰，功能明确，风险较低。其主要用途是验证漏洞的存在和执行命令，而不是进行大规模的恶意攻击。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
