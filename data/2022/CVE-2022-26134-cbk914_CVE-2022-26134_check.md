## CVE-2022-26134 - Atlassian Confluence Server and Data Center OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 受影响版本未知，参考Atlassian安全公告

**利用条件:** 未授权访问，需要网络访问

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-26134是Atlassian Confluence Server和Data Center中的一个OGNL注入漏洞。未经身份验证的攻击者可以通过构造恶意的请求，利用OGNL表达式注入，实现在服务器上执行任意代码。漏洞的根本原因在于Confluence对用户输入数据过滤不严，导致攻击者可以将恶意代码注入到OGNL表达式中，从而控制服务器。该漏洞在野外被广泛利用，导致大量Confluence服务器被入侵，攻击者通常利用该漏洞部署挖矿程序或进行其他恶意活动。

POC代码分析：提供的POC代码是一个Python脚本，用于检测Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过向目标URL发送一个特定的HTTP GET请求，检测服务器的响应。如果服务器返回的状态码为200，并且响应内容中包含"Confluence"和"com.atlassian.confluence.extra.jira"字符串，则认为服务器存在漏洞。该POC的有效性在于它模拟了攻击者利用漏洞的初步步骤，即发送包含恶意OGNL表达式的HTTP请求。但是，该POC仅用于检测漏洞是否存在，并不能实现完整的远程代码执行。脚本通过requests库发送HTTP请求，并使用字符串匹配来判断目标是否存在漏洞，没有执行真正的代码执行，相对比较安全。

利用步骤：
1. 确定目标Confluence服务器的URL。
2. 运行POC脚本，检测目标服务器是否存在漏洞。
3. 如果目标服务器存在漏洞，攻击者可以构造包含恶意OGNL表达式的HTTP请求，发送到目标服务器。
4. 目标服务器解析HTTP请求中的OGNL表达式，执行攻击者注入的恶意代码。
5. 攻击者可以利用执行的恶意代码，获取服务器的控制权，执行任意操作。

投毒风险分析：该POC的投毒风险较低。首先，POC代码本身相对简单，只包含发送HTTP请求和字符串匹配等基本操作，没有包含任何恶意代码或后门程序。其次，POC代码使用标准的Python库，例如requests，这些库都是经过广泛测试和验证的，不存在已知的安全漏洞。第三，POC代码的执行过程相对独立，不会对目标服务器的文件系统或系统配置进行修改，也不会与其他系统进行交互。但是，攻击者可能会修改POC代码，添加恶意代码或后门程序，从而利用该POC进行恶意活动。例如，攻击者可以在POC代码中添加代码，用于下载和执行恶意文件，或者将服务器的敏感信息发送到远程服务器。因此，在使用POC代码时，需要仔细审查代码，确保代码的安全性，并采取必要的安全措施，例如使用防火墙和入侵检测系统，以防止潜在的攻击。

综上所述，CVE-2022-26134是一个严重的远程代码执行漏洞，攻击者可以利用该漏洞获取Confluence服务器的控制权。提供的POC代码可以用于检测Confluence服务器是否存在该漏洞，但使用时需要注意潜在的投毒风险，确保代码的安全性。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
