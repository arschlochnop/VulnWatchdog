# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

# CVE-2022-46463

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46463-404tk_CVE-2022-46463.md](../2022/CVE-2022-46463-404tk_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可公开访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46463是Harbor的一个未授权访问漏洞，允许攻击者在未经身份验证的情况下访问公共和私有镜像仓库。根据漏洞库信息和搜索结果，该漏洞影响Harbor v1.X.X到v2.5.3版本。

**有效性：**
提供的POC代码 (`harbor.py`) 旨在利用此漏洞，通过列举public镜像并支持dump操作（类似`docker pull`），从而方便从公开暴露的镜像中查找敏感信息。该代码通过发送未授权的HTTP请求来获取镜像信息，证明了漏洞的有效性。

**投毒风险：**
阅读提供的`harbor.py`代码，主要功能是镜像仓库的枚举与下载，代码功能较为简单，主要是利用未授权访问漏洞。存在少量风险是，如果Harbor实例被攻陷，攻击者可能会篡改镜像内容进行供应链投毒。综合考虑，此仓库本身投毒风险较低。

**利用方式：**
1.  攻击者使用POC代码指定Harbor实例的URL。
2.  POC代码发送HTTP请求到 `/api/search` 或 `/api/v2.0/search` API端点，以列出所有公共镜像。
3.  攻击者可以选择dump特定的镜像或者所有镜像。
4.  POC代码下载镜像的layer。
5.  攻击者可以在下载的镜像中查找敏感信息，如密钥、密码等。
6.  通过 `--tags` 参数可以列出镜像的所有tag，通过 `--history` 从构建历史中获取敏感信息，无需下载镜像。


**项目地址:** [404tk/CVE-2022-46463](https://github.com/404tk/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---



---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---



---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---



---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---



---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---



---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---



---

## POC #2

**来源**: [CVE-2022-46463-CodeSecurityTeam_harbor.md](../2022/CVE-2022-46463-CodeSecurityTeam_harbor.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露，供应链投毒

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor服务对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46463 漏洞允许未经身份验证的攻击者访问 Harbor 的公共和私有镜像仓库。根据漏洞描述和搜索引擎结果，该漏洞的利用方式主要是通过未授权的 HTTP 请求来访问 Harbor API，从而获取镜像信息甚至下载镜像。

**有效性评估：**
提供的Python脚本通过 Harbor API 搜索镜像，并直接下载镜像文件，验证了未授权访问漏洞的存在。

**投毒风险分析：**
虽然该脚本的主要目的是扫描和下载镜像，但存在一定的投毒风险，主要体现在以下几个方面：
*   **依赖风险：**脚本依赖于 `requests` 和 `urllib3` 等第三方库，如果这些库本身存在安全漏洞，则可能导致代码执行。
*   **配置错误风险：**脚本允许用户指定代理，如果代理配置不当，可能导致敏感信息泄露。
*   **恶意代码风险：**尽管脚本本身没有明显的恶意代码，但攻击者可能修改脚本，例如植入后门或者修改下载的镜像文件，从而实现供应链投毒。
*   **文件操作风险** 脚本会生成和读取文件,存在一定的文件读取风险.

综合来看，投毒风险主要来自于对脚本的修改和不当配置，脚本本身下载后篡改上传投毒的可能性较低，脚本本身的功能主要是镜像的扫描和下载，并非上传，所以脚本本身投毒的可能性占比5%。

**利用方式：**
1.  **搜索镜像：** 通过脚本扫描Harbor实例，遍历公开和私有仓库中的镜像列表，获取项目ID和仓库名称等信息。
2.  **下载镜像：** 根据获取的镜像信息，直接通过 Harbor API 下载镜像文件，绕过身份验证。
3.  **解压镜像：** 脚本可以自动解压下载的镜像文件，方便攻击者进一步分析和利用。
4.  **信息泄露：** 攻击者可以利用此漏洞获取 Harbor 中存储的敏感信息，例如访问密钥、配置文件等。
5.  **供应链攻击：** 攻击者可以下载私有镜像，分析其中的安全漏洞，甚至可以修改镜像并重新上传，实施供应链投毒。

**项目地址:** [CodeSecurityTeam/harbor](https://github.com/CodeSecurityTeam/harbor)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

## POC #3

**来源**: [CVE-2022-46463-nu0l_CVE-2022-46463.md](../2022/CVE-2022-46463-nu0l_CVE-2022-46463.md)

## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)

---

