## CVE-2022-26134 - Atlassian Confluence Server and Data Center 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** > 7.18.1

**利用条件:** 无需认证，可通过网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的远程代码执行漏洞。该漏洞是由于OGNL注入造成的，攻击者可以通过构造恶意的OGNL表达式，在目标系统上执行任意代码。该漏洞影响的版本大于7.18.1。通过分析提供的POC代码，可以看出这是一个完整的利用程序。该POC首先检查目标Confluence服务器的版本，然后构造包含恶意命令的OGNL表达式，并将其作为HTTP GET请求的一部分发送到目标服务器。如果目标服务器存在漏洞，它将执行OGNL表达式中的命令，并将结果返回给攻击者。POC代码使用`requests`库发送HTTP请求，使用`BeautifulSoup`库解析HTML响应，使用`re`模块提取版本信息。该POC的有效性很高，因为它利用了Confluence服务器中存在的真实漏洞，并且可以成功地在目标系统上执行任意代码。利用步骤如下：
1. 运行POC脚本：`python CVE-2022-26134.py http://<target_url>:8090 <command>`
2. 脚本首先会尝试获取Confluence的版本信息，如果获取成功，则会显示版本号。
3. 脚本会构造包含命令的payload，通过GET请求发送到目标服务器。
4. 目标服务器执行命令后，会将结果放在HTTP响应头X-Cmd-Response中返回。
5. 脚本会提取X-Cmd-Response中的内容并输出。

投毒风险分析：该POC代码的投毒风险较低。因为它主要使用了Python的标准库，例如`requests`和`BeautifulSoup`。虽然使用了`os.system`函数来执行命令，但这部分代码是可控的，因为它只执行用户指定的命令。此外，该POC代码没有包含任何混淆或加密，易于阅读和理解。总体而言，该POC代码的风险较低，但用户仍然需要谨慎使用，避免在生产环境中执行未知的命令。该POC仅使用标准库发送HTTP请求，没有发现恶意行为，没有发现外部脚本调用，代码可读性高，因此判断投毒风险较低。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
