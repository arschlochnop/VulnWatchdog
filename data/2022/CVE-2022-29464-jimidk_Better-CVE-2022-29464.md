# CVE-2022-29464

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-29464-000pp_WSOB.md](../2022/CVE-2022-29464-000pp_WSOB.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器开放fileupload端点，且攻击者可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞存在于多个WSO2产品中，允许未经授权的文件上传，最终导致远程代码执行。

**漏洞利用方式：**

攻击者通过 `/fileupload` 端点，利用 `Content-Disposition` 头部的目录穿越（Path Traversal）序列，将恶意文件上传到Web根目录下的可执行目录，例如 `../../../../repository/deployment/server/webapps`。上传的文件会被服务器解析执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Trend Micro等安全厂商的分析）和提供的POC代码（WSOB工具），该漏洞利用的有效性很高。网上有大量的关于此漏洞的分析文章和漏洞利用案例。

**投毒风险：**

提供的POC代码是一个相对简单的Python脚本，主要功能是利用该漏洞进行文件上传。主要包含以下几个文件:
* `main.py`: 主程序入口，解析参数并启动漏洞利用。
* `src/interface/ui.py`: 定义了用户界面相关的函数，如显示banner。
* `src/wsob/main.py`: 漏洞利用的核心代码。
* `requirements.txt`: 依赖的Python库。

通过分析POC代码，**未发现明显的恶意代码或后门**。代码逻辑相对清晰，主要是发送HTTP请求，构造恶意的文件上传请求，进行目录穿越，实现任意文件上传。

但依旧存在潜在的投毒风险：

1.  **依赖风险：** `requirements.txt` 中列出的依赖库可能存在安全漏洞，攻击者可以通过供应链攻击，篡改这些依赖库，从而植入恶意代码。但是概率较低。
2. **漏洞利用代码本身的缺陷:**  漏洞利用代码中可能包含未知的缺陷或者错误，导致利用失败，或者引发其他安全问题。但是根据目前搜索结果该POC相对比较成熟。

**综合评估，该POC代码存在轻微的投毒风险，大约为5%。**

**项目地址:** [000pp/WSOB](https://github.com/000pp/WSOB)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #2

**来源**: [CVE-2022-29464-Chocapikk_CVE-2022-29464.md](../2022/CVE-2022-29464-Chocapikk_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** Unrestricted File Upload/Remote Code Execution

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的文件上传导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM/KM 1.4.0 to 2.0.0

**利用条件:** 目标服务器存在fileupload endpoint，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 允许未经授权的文件上传，导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 目录遍历序列，将恶意JSP文件上传至Web根目录下的 `repository/deployment/server/webapps` 目录，从而实现RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞是有效的。搜索结果中多个来源确认了该漏洞的存在和利用，并给出了相应的修复建议。漏洞利用代码通过上传JSP webshell来实现远程代码执行。

**投毒风险：**

POC代码中存在一定的投毒风险的可能性，可能性估计为10%。

*   **反弹shell配置：** `reverse_jsp` 中包含硬编码的反弹shell服务器 `8.tcp.ngrok.io:12508`。虽然这可能是为了方便测试，但也可能被用于跟踪或控制利用者的行为。此IP和端口并不一定是恶意的，但是需要使用者额外注意。
*   **公钥上传：**代码中存在上传公钥的部分，用途不明，存在潜在风险。
*   **代码审查：** 漏洞利用代码本身的行为是上传JSP文件，并在目标系统上执行命令。审查发现此代码中无明显恶意逻辑，但是使用者需要进行仔细的代码审查,确认符合预期行为。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本 WSO2 产品的服务器。
2.  **上传恶意文件：** 利用 `/fileupload` 端点，通过构造包含目录遍历的 `Content-Disposition` 请求，上传包含恶意代码的 JSP 文件到服务器的 `/repository/deployment/server/webapps` 目录，例如上传到 `authenticationendpoint` 目录下。
3.  **触发恶意代码：** 访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。POC代码中上传了webshell `balgo.jsp` 和反弹shell `balgorev.jsp`。
4.  **反弹shell接收:** 如果成功利用了反弹shell,需要在相应ip和端口监听,接收反弹shell连接

**项目地址:** [Chocapikk/CVE-2022-29464](https://github.com/Chocapikk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #3

**来源**: [CVE-2022-29464-LinJacck_CVE-2022-29464.md](../2022/CVE-2022-29464-LinJacck_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。

**漏洞分析：**

该漏洞的根本原因是 WSO2 产品中的 `/fileupload` 接口没有对上传的文件进行充分的验证。攻击者可以利用目录遍历漏洞，通过在 `Content-Disposition` 头中构造恶意路径，将恶意文件上传到 Web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。

**利用方式：**

1.  攻击者首先需要确定目标系统存在漏洞，即存在 `/fileupload` 接口且允许上传文件。
2.  攻击者构造一个包含恶意代码的 JSP 文件（或其他服务器支持的脚本文件）。
3.  攻击者构造一个包含目录遍历序列的 HTTP POST 请求，将恶意 JSP 文件上传到目标服务器的 Web 根目录下的 `repository/deployment/server/webapps/authenticationendpoint/` 目录中。文件名可以自定义，但通常以 `.jsp` 结尾，如 ShellDef变量所示。
4.  攻击者通过访问上传的 JSP 文件，即可执行其中的恶意代码，从而获得对服务器的控制权。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用 CVE-2022-29464 漏洞。

*   它首先定义了一个 `exploit` 函数，该函数负责构造包含恶意 JSP 代码的 HTTP POST 请求，并将该请求发送到目标服务器的 `/fileupload` 接口。
*   JSP 代码创建一个简单的 Web shell，允许攻击者通过 Web 界面执行任意系统命令。
*  脚本尝试上传一个名为`404.jsp`的文件用以验证漏洞.如果上传成功,则上传webshell到`/authenticationendpoint`目录下。
*  脚本还允许从外部文件读取webshell的内容并上传,增强了灵活性

**投毒风险评估：**

该 POC 代码本身**没有明显的投毒行为**。代码只是尝试上传 webshell，以便进行远程代码执行。恶意行为完全取决于攻击者上传的 JSP 文件中的内容。因此，该代码的投毒风险较低,可以认为是0。

**有效性：**

根据漏洞描述和 POC 代码的实现，以及搜索引擎返回的结果，该 POC 代码能够有效地利用 CVE-2022-29464 漏洞，实现任意文件上传和远程代码执行。


**项目地址:** [LinJacck/CVE-2022-29464](https://github.com/LinJacck/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #4

**来源**: [CVE-2022-29464-Pasch0_WSO2RCE.md](../2022/CVE-2022-29464-Pasch0_WSO2RCE.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问，目标存在/fileupload接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重的任意文件上传漏洞，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头部的请求，上传恶意文件到 web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。上传的文件可以被当作 JSP 或其他可执行文件解析，从而导致远程代码执行。根据搜索结果，该漏洞已经被广泛利用，并被用于安装 Cobalt Strike beacons 和其他恶意软件。提供的代码片段是 GNU GPL 协议，与漏洞利用本身无关，因此不存在投毒风险。利用方式主要为：

1.  利用 `/fileupload` 接口上传文件。
2.  在 `Content-Disposition` 头中构造目录遍历路径，将文件上传到 webapps 目录下。
3.  上传恶意 JSP 或其他可执行文件。
4.  通过访问上传的文件执行任意代码。

由于该漏洞已经被 CISA 加入已知被利用漏洞目录，建议尽快修复。

**项目地址:** [Pasch0/WSO2RCE](https://github.com/Pasch0/WSO2RCE)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #5

**来源**: [CVE-2022-29464-Pushkarup_CVE-2022-29464.md](../2022/CVE-2022-29464-Pushkarup_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的关键漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  攻击者通过`/fileupload`端点上传恶意文件，通常是包含恶意代码的JSP webshell。
2.  攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）绕过文件上传限制，将webshell上传到Web根目录下的可执行目录，例如`repository/deployment/server/webapps`。
3.  一旦webshell上传成功，攻击者可以通过访问该webshell的URL来执行任意代码。

**有效性评估：**

*   根据漏洞信息、搜索引擎结果和提供的POC代码，此漏洞的利用是有效的。 搜索引擎结果显示，该漏洞已被积极利用（例如TrendMicro报告）。 提供的POC代码（`wso.py` 脚本）旨在自动化利用过程，包括上传webshell并执行命令。

**投毒风险评估：**

该漏洞利用代码主要包含以下几个文件:

*   `LICENSE`：MIT许可证声明，表明代码是开源的，并允许修改和分发。
*   `README.md`：包含漏洞描述、免责声明、利用说明、webshell功能介绍、安装步骤、使用方法、贡献方式、许可协议和联系方式等信息。免责声明明确表示该POC仅用于教育目的，禁止用于非法活动。
*   `wso.py`：此Python脚本包含漏洞利用的核心代码，用于扫描目标站点是否存在漏洞、上传webshell、执行命令等操作。
*   `requirements.txt`：列出了脚本运行所需的Python依赖包，包括requests、colorama和urllib3。

考虑到代码的结构和功能，投毒的潜在风险较低，但仍然存在以下可能性：

1.  **Webshell后门植入**: `wso.py`脚本可能包含额外的后门或恶意代码，虽然webshell本身就是后门，但可能隐藏更深层的控制机制。
2.  **依赖包投毒**: 虽然 `requirements.txt` 文件中的依赖包看起来是标准的，但攻击者可能会使用拼写相似的恶意包来替换它们（例如，将`requests`替换为`requ3sts`）。
3.  **信息收集**: 脚本可能会暗中收集目标系统的信息，并将这些信息发送给攻击者。
4.  **资源消耗**: 脚本可能设计为消耗目标系统的资源，例如CPU或内存，从而导致拒绝服务。

鉴于以上分析，我估计该POC代码存在10%的投毒风险。 这个比例基于以下因素：

*   该POC的主要功能是利用已知的漏洞，目的是方便用户进行测试和验证。
*   POC的作者声明仅用于教育目的。
*   代码开源，方便其他人审查。
*   潜在的风险因素（如webshell后门、依赖包投毒、信息收集和资源消耗）依然存在，需要保持警惕。

**安全建议：**

*   在运行此POC之前，务必在一个隔离的环境中进行。
*   仔细审查代码，特别注意webshell和依赖包。
*   使用网络监控工具来检测任何异常的网络活动。


**项目地址:** [Pushkarup/CVE-2022-29464](https://github.com/Pushkarup/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #6

**来源**: [CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md](../2022/CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码。

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口，且未对上传的文件类型和路径进行严格限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于多个 WSO2 产品中，是一个严重的安全漏洞。攻击者可以利用`/fileupload`接口，通过目录遍历的方式将恶意 JSP 文件上传到 Web 应用的根目录下，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`。上传的 JSP 文件随后可以被 Web 服务器执行，从而导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用方式是有效的，并且已经被广泛利用。
提供的 PoC 代码尝试上传一个名为 `shell.jsp` 的 JSP 文件，该文件包含可以执行系统命令的恶意代码。如果上传成功，攻击者可以通过访问 `http(s)://目标地址/authenticationendpoint/shell.jsp` 来执行任意代码。

**投毒风险：**

PoC 代码中，`/tmp/e2105c9753cc00a9633b2cfd9b6fe351/cve.py` 主要功能是发送恶意请求，上传木马文件，整体代码没有明显的投毒行为。但是，以下几点需要注意：
*   `Files/shell.jsp`: 这是一个后门文件，如果未经审查直接使用，可能会引入未知风险。建议在使用前，仔细检查 `shell.jsp` 的内容，确保其只包含必要的功能，并且没有恶意代码。
*   对 `requirements.txt` 中引入的第三方库也需要进行审核，确保没有引入恶意的依赖。
*   README.md 感谢列表,作者SynixCyberCrimeMY & ?/h4zzzzzz.scc 未知。

因此，投毒风险较低，预估在10%左右。

**利用方式：**

1.  攻击者构造包含目录遍历的恶意请求，利用`/fileupload`接口上传恶意的 JSP 文件 (shell.jsp)。
2.  恶意 JSP 文件被上传到 Web 应用的根目录下。
3.  攻击者通过 Web 浏览器访问上传的 JSP 文件，执行其中的恶意代码。
4.  恶意代码在服务器上执行，允许攻击者执行任意系统命令，从而完全控制受影响的系统。

**防范措施：**

*   升级到 WSO2 官方修复后的版本。
*   实施文件上传白名单策略，仅允许上传必要的文件类型。
*   对上传的文件进行严格的路径验证，防止目录遍历攻击。
*   部署 Web 应用防火墙 (WAF)，检测和阻止恶意的文件上传请求。

**项目地址:** [SynixCyberCrimeMy/CVE-2022-29464](https://github.com/SynixCyberCrimeMy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #7

**来源**: [CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md](../2022/CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标存在/fileupload端点且未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，攻击者可以通过利用/fileupload端点上传任意文件，结合目录遍历将恶意JSP文件写入到webapps目录下，从而实现远程代码执行。该POC脚本首先生成一个随机文件名的JSP webshell，然后通过POST请求将该webshell上传到目标服务器的/fileupload/toolsAny端点。请求头中包含目录遍历(../)序列，用于将文件写入到服务器的webapps目录。上传后，脚本会休眠15秒，然后尝试通过GET请求访问上传的webshell，并执行指定的命令。如果返回状态码为200，则表示webshell执行成功。该POC的利用方式是典型的任意文件上传结合目录遍历实现RCE的漏洞利用方式。

**有效性:**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的，可以利用该漏洞在目标服务器上执行任意代码。

**投毒风险:**
代码没有发现明显的恶意行为或隐藏的后门。所有操作都与漏洞利用相关，例如上传 webshell 和执行命令。该代码的主要目的是为了验证漏洞的存在并进行简单的命令执行，没有检测到任何试图损害用户系统或窃取信息的行为。

**利用方式:**
1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的服务器。
2.  **上传 Webshell：** 使用包含目录遍历的 Content-Disposition 头的 POST 请求，将恶意 JSP 文件上传到`/fileupload/toolsAny`端点。
3.  **远程代码执行：** 通过访问上传的 JSP 文件，传递需要执行的命令作为参数，实现远程代码执行。例如：`{host}/authenticationendpoint/{filename}?cmd={command}`


**项目地址:** [SystemVll/CVE-2022-29464-loader](https://github.com/SystemVll/CVE-2022-29464-loader)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #8

**来源**: [CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md](../2022/CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传漏洞

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 - 4.0.0, WSO2 Identity Server 5.2.0 - 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 - 5.11.0, WSO2 Enterprise Integrator 6.2.0 - 6.6.0, WSO2 Open Banking AM 1.4.0 - 2.0.0, WSO2 Open Banking KM 1.4.0 - 2.0.0

**利用条件:** 需要网络访问，目标存在 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。漏洞的根源在于 /fileupload 接口缺乏适当的文件类型验证，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头，将恶意文件上传到 Web 根目录下的可执行位置，例如 repository/deployment/server/webapps 目录。上传的文件可以是 JSP 文件或其他服务器支持的脚本类型。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 WSO2 产品的服务器。
2.  **构造恶意请求：**  构造一个包含恶意文件的 HTTP POST 请求，该请求发送到 /fileupload 接口。Content-Disposition 头必须包含目录遍历序列，以将文件上传到 Web 根目录下的指定位置。
3.  **上传文件：**  将构造的请求发送到目标服务器。
4.  **执行代码：**  通过访问上传的文件来触发恶意代码的执行。例如，如果上传的是 JSP 文件，则可以通过 Web 浏览器访问该文件来执行其中的代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源都证实了该漏洞的存在和利用方式，并且提供了可用的 POC 代码。

**投毒风险：**

提供的 POC 代码（wso.py）主要功能是利用漏洞进行文件上传和远程代码执行。代码包含以下部分：

*   **请求库 (requests)：**  用于发送 HTTP 请求。
*   **目录创建 (os.mkdir)：**  用于创建结果目录。
*   **命令行清除 (os.system)：**  用于清除屏幕。
*   **Banner 打印：** 用于打印作者信息及免责声明

虽然没有明显的恶意代码，但仍存在一些潜在的风险：

*   **依赖项风险：** requirements.txt 文件中列出的依赖项（requests, urllib3, colorama）本身可能存在漏洞。如果这些依赖项被篡改或包含恶意代码，则可能导致安全问题。
*   **编码风险：** 代码没有对用户输入进行严格的验证，可能存在潜在的代码注入风险。例如，如果目标 URL 可控，攻击者可能会注入恶意代码。
*   **免责声明：** 作者的免责声明也暗示了使用该工具可能存在的风险，虽然正常的漏洞利用工具都有免责声明，但是也暗示此工具有一定的风险。

综上所述，该仓库存在较低的投毒风险，约为 10%。主要风险来自于依赖项和编码风险，需要仔细审查代码和依赖项，确保安全性。


**项目地址:** [ThatNotEasy/CVE-2022-29464](https://github.com/ThatNotEasy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #9

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #10

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 到 4.0.0, WSO2 Identity Server 5.2.0 到 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 和 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 到 5.11.0, WSO2 Enterprise Integrator 6.2.0 到 6.6.0, WSO2 Open Banking AM 1.4.0 到 2.0.0 和 WSO2 Open Banking KM 1.4.0, 到 2.0.0

**利用条件:** 需要网络访问目标 WSO2 实例，利用 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而实现远程代码执行。该漏洞的核心在于 `/fileupload` 端点未进行严格的身份验证和文件类型限制。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：**  WSO2 产品中的 `/fileupload` 端点允许未经身份验证的文件上传。`FileUploadServlet` 处理该请求，并根据 `carbon.xml` 配置文件加载的文件上传执行器处理上传的文件。由于未进行充分的验证，攻击者可以上传恶意文件。
2.  **利用步骤：**
    *   攻击者发送包含恶意 JSP 代码的 HTTP POST 请求到 `/fileupload` 端点。
    *   请求的 `Content-Disposition` 头包含目录遍历序列 (例如 `../../../../repository/deployment/server/webapps`)，用于将文件上传到 Web 根目录下的可执行目录。
    *   上传的 JSP 文件会被 WSO2 服务器执行，从而允许攻击者执行任意代码。
3.  **有效性评估：** 漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是可利用的，并且已经有公开的 PoC 代码存在。
4.  **投毒风险评估：**  漏洞利用代码的仓库中可能存在投毒的风险。虽然主要的利用方式是利用已知的漏洞，但仓库中可能会包含一些隐藏的、不明显的功能或代码，这些代码可能用于收集信息、植入后门或执行其他恶意活动。因此，对代码的审计是必要的，且投毒风险存在，约为 10%。风险主要来自于：
    *   **非必要的辅助脚本：** 仓库中可能包含一些非漏洞利用必需的脚本，例如用于扫描或配置的脚本，这些脚本可能包含恶意代码。
    *   **混淆的代码：**  某些代码可能经过混淆，使得难以分析其真实行为。
    *   **供应链攻击：**  仓库可能依赖于外部的库或组件，这些库或组件可能被恶意篡改。
    *   **社会工程：**  攻击者可能通过提交看似无害的 Pull Request 来引入恶意代码。
5.  **缓解措施：**
    *   升级到已修复漏洞的 WSO2 产品版本。
    *   实施严格的文件上传验证机制，包括身份验证、文件类型检查和大小限制。
    *   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
    *   定期进行安全审计和漏洞扫描。

**项目地址:** [amit-pathak009/CVE-2022-29464](https://github.com/amit-pathak009/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #11

**来源**: [CVE-2022-29464-axin2019_CVE-2022-29464.md](../2022/CVE-2022-29464-axin2019_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要目标服务器开放web端口且服务未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是WSO2产品中的一个严重漏洞，允许未经授权的文件上传，从而导致远程代码执行。攻击者通过向 `/fileupload` 端点发送包含目录遍历序列 `../../../../repository/deployment/server/webapps` 的 `Content-Disposition` 头部的恶意请求，绕过文件上传限制，将恶意JSP文件上传到web根目录下。  

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造一个`multipart/form-data`类型的POST请求，其中包含恶意JSP代码。请求的`Content-Disposition`头部使用目录遍历，将文件上传到目标web应用的`/repository/deployment/server/webapps`目录下的一个可访问的路径，如`authenticationendpoint`。
2.  **绕过上传限制：** 由于漏洞存在于文件上传的路径验证环节，攻击者可以利用目录遍历绕过服务器的文件类型和大小限制。
3.  **远程代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件，执行任意系统命令。
4.  **POC代码分析：**  提供的Python POC脚本模拟了上述攻击流程。脚本首先尝试访问目标URL，然后发送包含JSP后门的`multipart/form-data`请求到`/fileupload/toolsAny`，通过目录遍历将JSP文件上传到`authenticationendpoint`目录下。最后，脚本通过访问上传的JSP文件，执行`whoami`命令来验证漏洞是否存在。脚本中使用了两个不同的请求头`headers1`和`headers2`，针对目标进行尝试，提高了漏洞利用成功率。

**有效性评估：**

根据漏洞描述和POC代码，此漏洞利用方法有效，因为成功上传JSP文件即可执行任意命令。

**投毒风险评估：**

POC代码本身包含了一个用于远程代码执行的JSP后门，但这不是作者植入的恶意代码，而是漏洞利用的必要组成部分。代码中存在轻微的投毒风险（约10%），因为用户在复制和粘贴POC代码时，可能会无意中引入其他潜在的恶意代码或依赖项，但主要的风险在于漏洞本身，而不是POC代码的作者植入恶意代码。

**项目地址:** [axin2019/CVE-2022-29464](https://github.com/axin2019/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #12

**来源**: [CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md](../2022/CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM 等

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在漏洞并且可以通过网络访问 /fileupload 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 接口上传任意文件，通过目录穿越将文件写入到webapps目录下，从而导致远程代码执行。

**有效性分析：**

提供的POC代码利用了该漏洞。代码通过构造一个包含恶意JSP代码的文件，并使用目录穿越的方式将其上传到目标服务器的 `repository/deployment/server/webapps/authenticationendpoint/` 目录下。上传成功后，攻击者可以通过访问上传的JSP文件来执行任意命令。
根据搜索结果显示，该漏洞已经被广泛利用，证明POC的有效性。

**投毒风险分析：**

代码本身的功能是实现漏洞利用，上传并执行JSP后门。其中恶意行为是利用漏洞本身，而非代码作者额外添加的恶意功能。代码的危害在于利用漏洞，代码本身较为直白。
尽管如此，仍然存在微小的投毒风险，例如作者可能在代码中加入隐蔽的回连等恶意功能，但可能性较低，评估为5%。

**利用方式：**

1.  **确定目标：** 确定存在CVE-2022-29464漏洞的WSO2产品实例。
2.  **构造恶意JSP文件：** POC代码中已经包含了一个简单的JSP Shell，可以执行命令。攻击者可以根据需要修改JSP代码，实现更复杂的功能。
3.  **利用POC上传文件：** 使用POC代码，指定目标服务器地址和JSP文件名，将恶意JSP文件上传到目标服务器。
    *   `-f`：指定包含目标列表的文件。每一行包含一个目标地址，格式为 `HOST:PORT` 或 `IP:PORT`。
    *   `-t`：指定单个目标地址，格式同上。
    *   `-j`：指定要上传的JSP文件名。
4.  **执行命令：** 访问上传的JSP文件，通过URL参数传递要执行的命令。

例如，如果JSP文件名为 `shell.jsp`，则可以通过访问 `https://target/authenticationendpoint/shell.jsp?cmd=whoami` 来执行 `whoami` 命令。


**项目地址:** [c1ph3rbyt3/CVE-2022-29464](https://github.com/c1ph3rbyt3/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #13

**来源**: [CVE-2022-29464-cc3305_CVE-2022-29464.md](../2022/CVE-2022-29464-cc3305_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。搜索引擎结果表明该漏洞已被积极利用，存在公开可用的PoC，并且厂商建议用户立即更新或采取临时缓解措施。

**投毒风险：**

该PoC代码主要通过文件上传功能将恶意的JSP文件上传到目标服务器的webapps目录下。直接观察代码，存在投毒的可能性较低，例如作者可能嵌入反向shell或其他恶意功能，但并未发现明显的恶意行为。但仍需要对该脚本依赖的库，以及脚本的作者进行信誉评估。同时代码使用`force`参数绕过版本检测，如果目标事实上不存在漏洞，可能会因为尝试上传恶意文件导致服务不稳定。综合评估，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者使用 `/fileupload` 端点，通过 `Content-Disposition` 中的目录遍历序列（例如 `../../../../`）将文件上传到 Web 根目录下的目录，如 `repository/deployment/server/webapps`。
2.  **文件上传：** 攻击者上传包含恶意代码的 JSP 文件（或其他 Web Shell），例如本例中，poc脚本构造一个jsp_shell，命令执行的命令通过参数传入，更加灵活。
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件触发恶意代码的执行，从而在服务器上执行任意命令。

总而言之，该漏洞利用方式是通过精心构造的HTTP请求，利用WSO2文件上传接口的目录遍历漏洞，上传恶意JSP文件，最终导致远程代码执行。

**项目地址:** [cc3305/CVE-2022-29464](https://github.com/cc3305/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #14

**来源**: [CVE-2022-29464-devengpk_CVE-2022-29464.md](../2022/CVE-2022-29464-devengpk_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，允许未经身份验证的攻击者上传恶意文件并在服务器上执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要目标WSO2服务器实例可以通过网络访问，并且存在/fileupload端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于 WSO2 产品中，允许未经授权的文件上传，最终导致远程代码执行。攻击者可以利用 `/fileupload` 端点，通过 `Content-Disposition` 头部进行目录遍历，将恶意 JSP 文件上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录等位置。由于 `/fileupload` 路由未受到身份验证的保护，攻击者无需登录即可利用此漏洞。

**利用方式：**
1.  攻击者构造包含恶意 JSP 代码的文件。
2.  攻击者向 `/fileupload` 端点发送包含 `Content-Disposition` 头部，进行目录遍历的 HTTP 请求，将恶意 JSP 文件上传到服务器的 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。
3.  服务器处理上传请求，并将恶意 JSP 文件写入目标目录。
4.  攻击者通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码执行，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞利用代码有效。

**投毒风险：**
虽然提供的代码主要描述了漏洞原理，但代码中仍存在小概率潜在的投毒风险。作者可能会在利用代码中添加一些难以察觉的恶意代码，例如反弹 shell 或植入后门等。因此，在使用此类代码时，需要谨慎审查，确保其安全性。初步估计投毒风险为10%。

**项目地址:** [devengpk/CVE-2022-29464](https://github.com/devengpk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #15

**来源**: [CVE-2022-29464-g0dxing_CVE-2022-29464.md](../2022/CVE-2022-29464-g0dxing_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 `/fileupload` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 端点上传任意文件，通过目录穿越将恶意JSP文件上传到webapps目录下，从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。多个来源都确认了该漏洞的存在和可利用性，并且存在公开的PoC。

**投毒风险：**
PoC 代码本身主要功能是上传 webshell，但是`reverse_jsp`使用了硬编码的`8.tcp.ngrok.io:12508`，存在潜在的风险，如果攻击者修改了这个reverse shell 的地址，有可能反弹shell到攻击者的机器上。虽然`public_key`变量存在，但是代码没有使用，所以可以排除钓鱼风险，综上判断，存在5%的投毒风险。

**利用方式：**
1.  攻击者使用带有目录穿越的 `Content-Disposition` 头构造恶意的POST请求到 `/fileupload` 端点。
2.  请求中包含要上传的恶意JSP文件，目标路径指向Web根目录下的一个可执行JSP的目录，例如 `repository/deployment/server/webapps`。
3.  服务器接收到请求后，由于未对上传的文件类型和目标路径进行充分验证，会将恶意JSP文件写入到指定目录。
4.  攻击者可以通过访问上传的JSP文件，执行其中的恶意代码，实现远程代码执行。

**项目地址:** [g0dxing/CVE-2022-29464](https://github.com/g0dxing/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #16

**来源**: [CVE-2022-29464-gbrsh_CVE-2022-29464.md](../2022/CVE-2022-29464-gbrsh_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传 / 远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权的攻击者上传恶意文件并执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标WSO2服务器存在/fileupload endpoint且未进行适当的路径限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的高危漏洞，允许未经身份验证的攻击者通过`/fileupload`端点上传任意文件，从而导致远程代码执行。攻击者利用路径遍历漏洞将恶意JSP文件上传到webapps目录下，例如`../../../../repository/deployment/server/webapps/authenticationendpoint/evil.jsp`。上传成功后，攻击者可以通过访问该JSP文件来执行任意系统命令。提供的POC代码通过构造包含恶意JSP代码的文件上传请求，利用该漏洞。代码首先上传一个包含命令执行功能的JSP文件，然后通过发送带有`cmd`参数的GET请求来执行系统命令。代码中未发现任何隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低。

**漏洞利用方式：**

1.  **文件上传：** 攻击者向目标WSO2服务器的`/fileupload`端点发送POST请求，上传包含恶意JSP代码的文件。Content-Disposition头包含路径遍历序列，将文件上传到webapps目录下。
2.  **代码执行：** 攻击者通过访问上传的JSP文件（例如`/authenticationendpoint/evil.jsp?cmd=whoami`）来执行任意系统命令。服务器执行JSP代码，并将命令执行结果返回给攻击者。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。利用成功与否取决于目标系统是否存在漏洞，是否打补丁，以及是否配置正确。

**搜索引擎结果：**

搜索结果表明，CVE-2022-29464是一个已被广泛利用的漏洞，多个安全厂商发布了关于该漏洞的分析报告和修复建议。有报告指出，该漏洞已被用于安装Cobalt Strike beacons和其他恶意软件。


**项目地址:** [gbrsh/CVE-2022-29464](https://github.com/gbrsh/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #17

**来源**: [CVE-2022-29464-hakivvi_CVE-2022-29464.md](../2022/CVE-2022-29464-hakivvi_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问到WSO2服务器的/fileupload端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞是一个存在于多个WSO2产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要是漏洞原理的分析和描述，并未发现直接的恶意代码。然而，任何公开的漏洞利用代码都存在被修改并植入恶意代码的风险。例如，攻击者可能修改POC，在成功上传JSP后，执行额外的恶意操作，例如下载并执行其他恶意程序。POC中直接包含恶意JSP的可能性较低，但后续利用上传的JSP进行投毒的可能性较高。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞位置：** 受影响的WSO2产品存在`/fileupload`端点，该端点允许未授权的文件上传。
2.  **路径穿越：** 攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）将上传的文件写入到Web根目录下的特定位置，如`repository/deployment/server/webapps`。
3.  **上传恶意文件：** 攻击者上传包含恶意代码的JSP文件。
4.  **远程代码执行：**  一旦恶意JSP文件被上传到Web根目录，攻击者可以通过访问该JSP文件来执行服务器上的任意代码。

**项目地址:** [hakivvi/CVE-2022-29464](https://github.com/hakivvi/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #18

**来源**: [CVE-2022-29464-hev0x_CVE-2022-29464.md](../2022/CVE-2022-29464-hev0x_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问，目标存在/fileupload端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的任意文件上传漏洞，允许未经授权的攻击者上传恶意文件并执行远程代码。根据漏洞信息和搜索结果，此漏洞利用涉及利用 `/fileupload` 端点，并使用 `Content-Disposition` 头部中的目录遍历序列将文件上传到 Web 根目录下的可访问位置，例如 `../../../../repository/deployment/server/webapps` 目录。POC 代码的工作原理如下：

1.  **定位目标：** 脚本接收包含目标 URL 的文件作为输入。
2.  **构造恶意请求：** 脚本构造一个 POST 请求，使用 `/fileupload/toolsAny` 端点，并在 `files` 参数中包含一个指向恶意 JSP 文件的映射。JSP 文件的内容是一个简单的 WebShell，允许执行任意命令。
3.  **目录遍历：** 脚本使用目录遍历序列 (例如 `../../../../`) 将 JSP 文件上传到 `repository/deployment/server/webapps/authenticationendpoint/megas.jsp` 路径下。 `authenticationendpoint` 是一个常见的 Web 应用目录，`megas.jsp` 是上传的 webshell 文件名。
4.  **执行代码：** 脚本通过访问上传的 JSP WebShell (例如 `/authenticationendpoint/megas.jsp?cmd=id`) 来执行命令。脚本首先尝试执行 `id` 命令以验证漏洞是否成功利用。
5.  **验证与输出：** 如果 `id` 命令执行成功并且返回了 `uid` 信息，脚本会认为目标存在漏洞，并将结果输出到屏幕和文件中。

**投毒风险分析：**

我分析了提供的 POC 代码。该代码的主要功能是利用目录遍历和文件上传漏洞在目标系统上部署一个 webshell，然后通过 webshell 执行系统命令。代码没有发现任何隐藏的、与漏洞利用无关的功能，例如收集用户信息、传播恶意软件或篡改系统配置等。因此，该 POC 代码的投毒风险评估为 0%。

**总结：**

该漏洞利用代码有效，因为它能够利用文件上传漏洞在目标系统上部署和执行恶意代码，从而实现远程代码执行。利用方式清晰，无需身份验证。由于代码只包含漏洞利用逻辑，因此不存在投毒风险。

**项目地址:** [hev0x/CVE-2022-29464](https://github.com/hev0x/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #19

**来源**: [CVE-2022-29464-hupe1980_CVE-2022-29464.md](../2022/CVE-2022-29464-hupe1980_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的高危漏洞，它允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，最终导致远程代码执行。该漏洞的利用方式是通过构造包含目录穿越序列的 `Content-Disposition` 头，将恶意 JSP 文件上传到 Web 根目录下的可访问位置，如 `repository/deployment/server/webapps` 目录。上传的 JSP 文件包含执行任意命令的代码。根据提供的漏洞利用代码 `exploit.py`，该脚本通过 POST 请求向目标服务器的 `/fileupload/toolsAny` 端点上传一个包含恶意代码的 JSP 文件。攻击者可以通过访问上传的 JSP 文件来执行任意命令。例如，脚本会将包含一个表单的 JSP shell 上传到 `/authenticationendpoint` 应用目录下。 该代码看起来是直接利用漏洞，没有发现隐藏的恶意代码或者后门，所以投毒风险评估为0%。 搜索引擎结果也表明该漏洞已被广泛利用，并建议用户尽快更新或采取缓解措施。

**项目地址:** [hupe1980/CVE-2022-29464](https://github.com/hupe1980/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #20

**来源**: [CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md](../2022/CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行，系统完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经授权的文件上传，并最终导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 头部中的目录遍历序列（如 `../../../../`）将恶意文件上传到 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。上传的文件可以是 JSP、WAR 或其他可执行格式，从而允许攻击者在服务器上执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的目标服务器。
2.  **构造恶意请求：** 构造一个包含恶意文件的 POST 请求，该文件将被上传到 `/fileupload` 端点。请求的 `Content-Disposition` 头部必须包含目录遍历序列，以便将文件放置在 Web 根目录下的可执行目录中。
3.  **上传恶意文件：** 发送构造的请求到目标服务器。服务器会处理请求并将恶意文件上传到指定目录。
4.  **触发代码执行：** 通过访问上传的恶意文件（例如，通过 Web 浏览器），触发服务器执行其中的代码。

**投毒风险分析：**

提供的漏洞利用代码段（`LICENSE`文件）是 GNU GPL 许可证的文本，不包含任何恶意代码或投毒行为。因此，此代码段本身不存在投毒风险。 但是，如果提供的仓库中包含其他payload.jsp或者war,那么会存在投毒风险.根据现有信息，投毒风险为0%。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2022-29464 漏洞利用的有效性很高，该漏洞被广泛利用，并且已经有公开的PoC利用代码。

**项目地址:** [hxlxmj/Mass-exploit-CVE-2022-29464](https://github.com/hxlxmj/Mass-exploit-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #21

**来源**: [CVE-2022-29464-jimidk_Better-CVE-2022-29464.md](../2022/CVE-2022-29464-jimidk_Better-CVE-2022-29464.md)

# CVE-2022-29464

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-29464-000pp_WSOB.md](../2022/CVE-2022-29464-000pp_WSOB.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器开放fileupload端点，且攻击者可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞存在于多个WSO2产品中，允许未经授权的文件上传，最终导致远程代码执行。

**漏洞利用方式：**

攻击者通过 `/fileupload` 端点，利用 `Content-Disposition` 头部的目录穿越（Path Traversal）序列，将恶意文件上传到Web根目录下的可执行目录，例如 `../../../../repository/deployment/server/webapps`。上传的文件会被服务器解析执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Trend Micro等安全厂商的分析）和提供的POC代码（WSOB工具），该漏洞利用的有效性很高。网上有大量的关于此漏洞的分析文章和漏洞利用案例。

**投毒风险：**

提供的POC代码是一个相对简单的Python脚本，主要功能是利用该漏洞进行文件上传。主要包含以下几个文件:
* `main.py`: 主程序入口，解析参数并启动漏洞利用。
* `src/interface/ui.py`: 定义了用户界面相关的函数，如显示banner。
* `src/wsob/main.py`: 漏洞利用的核心代码。
* `requirements.txt`: 依赖的Python库。

通过分析POC代码，**未发现明显的恶意代码或后门**。代码逻辑相对清晰，主要是发送HTTP请求，构造恶意的文件上传请求，进行目录穿越，实现任意文件上传。

但依旧存在潜在的投毒风险：

1.  **依赖风险：** `requirements.txt` 中列出的依赖库可能存在安全漏洞，攻击者可以通过供应链攻击，篡改这些依赖库，从而植入恶意代码。但是概率较低。
2. **漏洞利用代码本身的缺陷:**  漏洞利用代码中可能包含未知的缺陷或者错误，导致利用失败，或者引发其他安全问题。但是根据目前搜索结果该POC相对比较成熟。

**综合评估，该POC代码存在轻微的投毒风险，大约为5%。**

**项目地址:** [000pp/WSOB](https://github.com/000pp/WSOB)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #2

**来源**: [CVE-2022-29464-Chocapikk_CVE-2022-29464.md](../2022/CVE-2022-29464-Chocapikk_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** Unrestricted File Upload/Remote Code Execution

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的文件上传导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM/KM 1.4.0 to 2.0.0

**利用条件:** 目标服务器存在fileupload endpoint，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 允许未经授权的文件上传，导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 目录遍历序列，将恶意JSP文件上传至Web根目录下的 `repository/deployment/server/webapps` 目录，从而实现RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞是有效的。搜索结果中多个来源确认了该漏洞的存在和利用，并给出了相应的修复建议。漏洞利用代码通过上传JSP webshell来实现远程代码执行。

**投毒风险：**

POC代码中存在一定的投毒风险的可能性，可能性估计为10%。

*   **反弹shell配置：** `reverse_jsp` 中包含硬编码的反弹shell服务器 `8.tcp.ngrok.io:12508`。虽然这可能是为了方便测试，但也可能被用于跟踪或控制利用者的行为。此IP和端口并不一定是恶意的，但是需要使用者额外注意。
*   **公钥上传：**代码中存在上传公钥的部分，用途不明，存在潜在风险。
*   **代码审查：** 漏洞利用代码本身的行为是上传JSP文件，并在目标系统上执行命令。审查发现此代码中无明显恶意逻辑，但是使用者需要进行仔细的代码审查,确认符合预期行为。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本 WSO2 产品的服务器。
2.  **上传恶意文件：** 利用 `/fileupload` 端点，通过构造包含目录遍历的 `Content-Disposition` 请求，上传包含恶意代码的 JSP 文件到服务器的 `/repository/deployment/server/webapps` 目录，例如上传到 `authenticationendpoint` 目录下。
3.  **触发恶意代码：** 访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。POC代码中上传了webshell `balgo.jsp` 和反弹shell `balgorev.jsp`。
4.  **反弹shell接收:** 如果成功利用了反弹shell,需要在相应ip和端口监听,接收反弹shell连接

**项目地址:** [Chocapikk/CVE-2022-29464](https://github.com/Chocapikk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #3

**来源**: [CVE-2022-29464-LinJacck_CVE-2022-29464.md](../2022/CVE-2022-29464-LinJacck_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。

**漏洞分析：**

该漏洞的根本原因是 WSO2 产品中的 `/fileupload` 接口没有对上传的文件进行充分的验证。攻击者可以利用目录遍历漏洞，通过在 `Content-Disposition` 头中构造恶意路径，将恶意文件上传到 Web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。

**利用方式：**

1.  攻击者首先需要确定目标系统存在漏洞，即存在 `/fileupload` 接口且允许上传文件。
2.  攻击者构造一个包含恶意代码的 JSP 文件（或其他服务器支持的脚本文件）。
3.  攻击者构造一个包含目录遍历序列的 HTTP POST 请求，将恶意 JSP 文件上传到目标服务器的 Web 根目录下的 `repository/deployment/server/webapps/authenticationendpoint/` 目录中。文件名可以自定义，但通常以 `.jsp` 结尾，如 ShellDef变量所示。
4.  攻击者通过访问上传的 JSP 文件，即可执行其中的恶意代码，从而获得对服务器的控制权。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用 CVE-2022-29464 漏洞。

*   它首先定义了一个 `exploit` 函数，该函数负责构造包含恶意 JSP 代码的 HTTP POST 请求，并将该请求发送到目标服务器的 `/fileupload` 接口。
*   JSP 代码创建一个简单的 Web shell，允许攻击者通过 Web 界面执行任意系统命令。
*  脚本尝试上传一个名为`404.jsp`的文件用以验证漏洞.如果上传成功,则上传webshell到`/authenticationendpoint`目录下。
*  脚本还允许从外部文件读取webshell的内容并上传,增强了灵活性

**投毒风险评估：**

该 POC 代码本身**没有明显的投毒行为**。代码只是尝试上传 webshell，以便进行远程代码执行。恶意行为完全取决于攻击者上传的 JSP 文件中的内容。因此，该代码的投毒风险较低,可以认为是0。

**有效性：**

根据漏洞描述和 POC 代码的实现，以及搜索引擎返回的结果，该 POC 代码能够有效地利用 CVE-2022-29464 漏洞，实现任意文件上传和远程代码执行。


**项目地址:** [LinJacck/CVE-2022-29464](https://github.com/LinJacck/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #4

**来源**: [CVE-2022-29464-Pasch0_WSO2RCE.md](../2022/CVE-2022-29464-Pasch0_WSO2RCE.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问，目标存在/fileupload接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重的任意文件上传漏洞，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头部的请求，上传恶意文件到 web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。上传的文件可以被当作 JSP 或其他可执行文件解析，从而导致远程代码执行。根据搜索结果，该漏洞已经被广泛利用，并被用于安装 Cobalt Strike beacons 和其他恶意软件。提供的代码片段是 GNU GPL 协议，与漏洞利用本身无关，因此不存在投毒风险。利用方式主要为：

1.  利用 `/fileupload` 接口上传文件。
2.  在 `Content-Disposition` 头中构造目录遍历路径，将文件上传到 webapps 目录下。
3.  上传恶意 JSP 或其他可执行文件。
4.  通过访问上传的文件执行任意代码。

由于该漏洞已经被 CISA 加入已知被利用漏洞目录，建议尽快修复。

**项目地址:** [Pasch0/WSO2RCE](https://github.com/Pasch0/WSO2RCE)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #5

**来源**: [CVE-2022-29464-Pushkarup_CVE-2022-29464.md](../2022/CVE-2022-29464-Pushkarup_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的关键漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  攻击者通过`/fileupload`端点上传恶意文件，通常是包含恶意代码的JSP webshell。
2.  攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）绕过文件上传限制，将webshell上传到Web根目录下的可执行目录，例如`repository/deployment/server/webapps`。
3.  一旦webshell上传成功，攻击者可以通过访问该webshell的URL来执行任意代码。

**有效性评估：**

*   根据漏洞信息、搜索引擎结果和提供的POC代码，此漏洞的利用是有效的。 搜索引擎结果显示，该漏洞已被积极利用（例如TrendMicro报告）。 提供的POC代码（`wso.py` 脚本）旨在自动化利用过程，包括上传webshell并执行命令。

**投毒风险评估：**

该漏洞利用代码主要包含以下几个文件:

*   `LICENSE`：MIT许可证声明，表明代码是开源的，并允许修改和分发。
*   `README.md`：包含漏洞描述、免责声明、利用说明、webshell功能介绍、安装步骤、使用方法、贡献方式、许可协议和联系方式等信息。免责声明明确表示该POC仅用于教育目的，禁止用于非法活动。
*   `wso.py`：此Python脚本包含漏洞利用的核心代码，用于扫描目标站点是否存在漏洞、上传webshell、执行命令等操作。
*   `requirements.txt`：列出了脚本运行所需的Python依赖包，包括requests、colorama和urllib3。

考虑到代码的结构和功能，投毒的潜在风险较低，但仍然存在以下可能性：

1.  **Webshell后门植入**: `wso.py`脚本可能包含额外的后门或恶意代码，虽然webshell本身就是后门，但可能隐藏更深层的控制机制。
2.  **依赖包投毒**: 虽然 `requirements.txt` 文件中的依赖包看起来是标准的，但攻击者可能会使用拼写相似的恶意包来替换它们（例如，将`requests`替换为`requ3sts`）。
3.  **信息收集**: 脚本可能会暗中收集目标系统的信息，并将这些信息发送给攻击者。
4.  **资源消耗**: 脚本可能设计为消耗目标系统的资源，例如CPU或内存，从而导致拒绝服务。

鉴于以上分析，我估计该POC代码存在10%的投毒风险。 这个比例基于以下因素：

*   该POC的主要功能是利用已知的漏洞，目的是方便用户进行测试和验证。
*   POC的作者声明仅用于教育目的。
*   代码开源，方便其他人审查。
*   潜在的风险因素（如webshell后门、依赖包投毒、信息收集和资源消耗）依然存在，需要保持警惕。

**安全建议：**

*   在运行此POC之前，务必在一个隔离的环境中进行。
*   仔细审查代码，特别注意webshell和依赖包。
*   使用网络监控工具来检测任何异常的网络活动。


**项目地址:** [Pushkarup/CVE-2022-29464](https://github.com/Pushkarup/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #6

**来源**: [CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md](../2022/CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码。

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口，且未对上传的文件类型和路径进行严格限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于多个 WSO2 产品中，是一个严重的安全漏洞。攻击者可以利用`/fileupload`接口，通过目录遍历的方式将恶意 JSP 文件上传到 Web 应用的根目录下，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`。上传的 JSP 文件随后可以被 Web 服务器执行，从而导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用方式是有效的，并且已经被广泛利用。
提供的 PoC 代码尝试上传一个名为 `shell.jsp` 的 JSP 文件，该文件包含可以执行系统命令的恶意代码。如果上传成功，攻击者可以通过访问 `http(s)://目标地址/authenticationendpoint/shell.jsp` 来执行任意代码。

**投毒风险：**

PoC 代码中，`/tmp/e2105c9753cc00a9633b2cfd9b6fe351/cve.py` 主要功能是发送恶意请求，上传木马文件，整体代码没有明显的投毒行为。但是，以下几点需要注意：
*   `Files/shell.jsp`: 这是一个后门文件，如果未经审查直接使用，可能会引入未知风险。建议在使用前，仔细检查 `shell.jsp` 的内容，确保其只包含必要的功能，并且没有恶意代码。
*   对 `requirements.txt` 中引入的第三方库也需要进行审核，确保没有引入恶意的依赖。
*   README.md 感谢列表,作者SynixCyberCrimeMY & ?/h4zzzzzz.scc 未知。

因此，投毒风险较低，预估在10%左右。

**利用方式：**

1.  攻击者构造包含目录遍历的恶意请求，利用`/fileupload`接口上传恶意的 JSP 文件 (shell.jsp)。
2.  恶意 JSP 文件被上传到 Web 应用的根目录下。
3.  攻击者通过 Web 浏览器访问上传的 JSP 文件，执行其中的恶意代码。
4.  恶意代码在服务器上执行，允许攻击者执行任意系统命令，从而完全控制受影响的系统。

**防范措施：**

*   升级到 WSO2 官方修复后的版本。
*   实施文件上传白名单策略，仅允许上传必要的文件类型。
*   对上传的文件进行严格的路径验证，防止目录遍历攻击。
*   部署 Web 应用防火墙 (WAF)，检测和阻止恶意的文件上传请求。

**项目地址:** [SynixCyberCrimeMy/CVE-2022-29464](https://github.com/SynixCyberCrimeMy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #7

**来源**: [CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md](../2022/CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标存在/fileupload端点且未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，攻击者可以通过利用/fileupload端点上传任意文件，结合目录遍历将恶意JSP文件写入到webapps目录下，从而实现远程代码执行。该POC脚本首先生成一个随机文件名的JSP webshell，然后通过POST请求将该webshell上传到目标服务器的/fileupload/toolsAny端点。请求头中包含目录遍历(../)序列，用于将文件写入到服务器的webapps目录。上传后，脚本会休眠15秒，然后尝试通过GET请求访问上传的webshell，并执行指定的命令。如果返回状态码为200，则表示webshell执行成功。该POC的利用方式是典型的任意文件上传结合目录遍历实现RCE的漏洞利用方式。

**有效性:**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的，可以利用该漏洞在目标服务器上执行任意代码。

**投毒风险:**
代码没有发现明显的恶意行为或隐藏的后门。所有操作都与漏洞利用相关，例如上传 webshell 和执行命令。该代码的主要目的是为了验证漏洞的存在并进行简单的命令执行，没有检测到任何试图损害用户系统或窃取信息的行为。

**利用方式:**
1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的服务器。
2.  **上传 Webshell：** 使用包含目录遍历的 Content-Disposition 头的 POST 请求，将恶意 JSP 文件上传到`/fileupload/toolsAny`端点。
3.  **远程代码执行：** 通过访问上传的 JSP 文件，传递需要执行的命令作为参数，实现远程代码执行。例如：`{host}/authenticationendpoint/{filename}?cmd={command}`


**项目地址:** [SystemVll/CVE-2022-29464-loader](https://github.com/SystemVll/CVE-2022-29464-loader)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #8

**来源**: [CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md](../2022/CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传漏洞

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 - 4.0.0, WSO2 Identity Server 5.2.0 - 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 - 5.11.0, WSO2 Enterprise Integrator 6.2.0 - 6.6.0, WSO2 Open Banking AM 1.4.0 - 2.0.0, WSO2 Open Banking KM 1.4.0 - 2.0.0

**利用条件:** 需要网络访问，目标存在 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。漏洞的根源在于 /fileupload 接口缺乏适当的文件类型验证，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头，将恶意文件上传到 Web 根目录下的可执行位置，例如 repository/deployment/server/webapps 目录。上传的文件可以是 JSP 文件或其他服务器支持的脚本类型。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 WSO2 产品的服务器。
2.  **构造恶意请求：**  构造一个包含恶意文件的 HTTP POST 请求，该请求发送到 /fileupload 接口。Content-Disposition 头必须包含目录遍历序列，以将文件上传到 Web 根目录下的指定位置。
3.  **上传文件：**  将构造的请求发送到目标服务器。
4.  **执行代码：**  通过访问上传的文件来触发恶意代码的执行。例如，如果上传的是 JSP 文件，则可以通过 Web 浏览器访问该文件来执行其中的代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源都证实了该漏洞的存在和利用方式，并且提供了可用的 POC 代码。

**投毒风险：**

提供的 POC 代码（wso.py）主要功能是利用漏洞进行文件上传和远程代码执行。代码包含以下部分：

*   **请求库 (requests)：**  用于发送 HTTP 请求。
*   **目录创建 (os.mkdir)：**  用于创建结果目录。
*   **命令行清除 (os.system)：**  用于清除屏幕。
*   **Banner 打印：** 用于打印作者信息及免责声明

虽然没有明显的恶意代码，但仍存在一些潜在的风险：

*   **依赖项风险：** requirements.txt 文件中列出的依赖项（requests, urllib3, colorama）本身可能存在漏洞。如果这些依赖项被篡改或包含恶意代码，则可能导致安全问题。
*   **编码风险：** 代码没有对用户输入进行严格的验证，可能存在潜在的代码注入风险。例如，如果目标 URL 可控，攻击者可能会注入恶意代码。
*   **免责声明：** 作者的免责声明也暗示了使用该工具可能存在的风险，虽然正常的漏洞利用工具都有免责声明，但是也暗示此工具有一定的风险。

综上所述，该仓库存在较低的投毒风险，约为 10%。主要风险来自于依赖项和编码风险，需要仔细审查代码和依赖项，确保安全性。


**项目地址:** [ThatNotEasy/CVE-2022-29464](https://github.com/ThatNotEasy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #9

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #10

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 到 4.0.0, WSO2 Identity Server 5.2.0 到 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 和 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 到 5.11.0, WSO2 Enterprise Integrator 6.2.0 到 6.6.0, WSO2 Open Banking AM 1.4.0 到 2.0.0 和 WSO2 Open Banking KM 1.4.0, 到 2.0.0

**利用条件:** 需要网络访问目标 WSO2 实例，利用 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而实现远程代码执行。该漏洞的核心在于 `/fileupload` 端点未进行严格的身份验证和文件类型限制。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：**  WSO2 产品中的 `/fileupload` 端点允许未经身份验证的文件上传。`FileUploadServlet` 处理该请求，并根据 `carbon.xml` 配置文件加载的文件上传执行器处理上传的文件。由于未进行充分的验证，攻击者可以上传恶意文件。
2.  **利用步骤：**
    *   攻击者发送包含恶意 JSP 代码的 HTTP POST 请求到 `/fileupload` 端点。
    *   请求的 `Content-Disposition` 头包含目录遍历序列 (例如 `../../../../repository/deployment/server/webapps`)，用于将文件上传到 Web 根目录下的可执行目录。
    *   上传的 JSP 文件会被 WSO2 服务器执行，从而允许攻击者执行任意代码。
3.  **有效性评估：** 漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是可利用的，并且已经有公开的 PoC 代码存在。
4.  **投毒风险评估：**  漏洞利用代码的仓库中可能存在投毒的风险。虽然主要的利用方式是利用已知的漏洞，但仓库中可能会包含一些隐藏的、不明显的功能或代码，这些代码可能用于收集信息、植入后门或执行其他恶意活动。因此，对代码的审计是必要的，且投毒风险存在，约为 10%。风险主要来自于：
    *   **非必要的辅助脚本：** 仓库中可能包含一些非漏洞利用必需的脚本，例如用于扫描或配置的脚本，这些脚本可能包含恶意代码。
    *   **混淆的代码：**  某些代码可能经过混淆，使得难以分析其真实行为。
    *   **供应链攻击：**  仓库可能依赖于外部的库或组件，这些库或组件可能被恶意篡改。
    *   **社会工程：**  攻击者可能通过提交看似无害的 Pull Request 来引入恶意代码。
5.  **缓解措施：**
    *   升级到已修复漏洞的 WSO2 产品版本。
    *   实施严格的文件上传验证机制，包括身份验证、文件类型检查和大小限制。
    *   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
    *   定期进行安全审计和漏洞扫描。

**项目地址:** [amit-pathak009/CVE-2022-29464](https://github.com/amit-pathak009/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #11

**来源**: [CVE-2022-29464-axin2019_CVE-2022-29464.md](../2022/CVE-2022-29464-axin2019_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要目标服务器开放web端口且服务未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是WSO2产品中的一个严重漏洞，允许未经授权的文件上传，从而导致远程代码执行。攻击者通过向 `/fileupload` 端点发送包含目录遍历序列 `../../../../repository/deployment/server/webapps` 的 `Content-Disposition` 头部的恶意请求，绕过文件上传限制，将恶意JSP文件上传到web根目录下。  

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造一个`multipart/form-data`类型的POST请求，其中包含恶意JSP代码。请求的`Content-Disposition`头部使用目录遍历，将文件上传到目标web应用的`/repository/deployment/server/webapps`目录下的一个可访问的路径，如`authenticationendpoint`。
2.  **绕过上传限制：** 由于漏洞存在于文件上传的路径验证环节，攻击者可以利用目录遍历绕过服务器的文件类型和大小限制。
3.  **远程代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件，执行任意系统命令。
4.  **POC代码分析：**  提供的Python POC脚本模拟了上述攻击流程。脚本首先尝试访问目标URL，然后发送包含JSP后门的`multipart/form-data`请求到`/fileupload/toolsAny`，通过目录遍历将JSP文件上传到`authenticationendpoint`目录下。最后，脚本通过访问上传的JSP文件，执行`whoami`命令来验证漏洞是否存在。脚本中使用了两个不同的请求头`headers1`和`headers2`，针对目标进行尝试，提高了漏洞利用成功率。

**有效性评估：**

根据漏洞描述和POC代码，此漏洞利用方法有效，因为成功上传JSP文件即可执行任意命令。

**投毒风险评估：**

POC代码本身包含了一个用于远程代码执行的JSP后门，但这不是作者植入的恶意代码，而是漏洞利用的必要组成部分。代码中存在轻微的投毒风险（约10%），因为用户在复制和粘贴POC代码时，可能会无意中引入其他潜在的恶意代码或依赖项，但主要的风险在于漏洞本身，而不是POC代码的作者植入恶意代码。

**项目地址:** [axin2019/CVE-2022-29464](https://github.com/axin2019/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #12

**来源**: [CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md](../2022/CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM 等

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在漏洞并且可以通过网络访问 /fileupload 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 接口上传任意文件，通过目录穿越将文件写入到webapps目录下，从而导致远程代码执行。

**有效性分析：**

提供的POC代码利用了该漏洞。代码通过构造一个包含恶意JSP代码的文件，并使用目录穿越的方式将其上传到目标服务器的 `repository/deployment/server/webapps/authenticationendpoint/` 目录下。上传成功后，攻击者可以通过访问上传的JSP文件来执行任意命令。
根据搜索结果显示，该漏洞已经被广泛利用，证明POC的有效性。

**投毒风险分析：**

代码本身的功能是实现漏洞利用，上传并执行JSP后门。其中恶意行为是利用漏洞本身，而非代码作者额外添加的恶意功能。代码的危害在于利用漏洞，代码本身较为直白。
尽管如此，仍然存在微小的投毒风险，例如作者可能在代码中加入隐蔽的回连等恶意功能，但可能性较低，评估为5%。

**利用方式：**

1.  **确定目标：** 确定存在CVE-2022-29464漏洞的WSO2产品实例。
2.  **构造恶意JSP文件：** POC代码中已经包含了一个简单的JSP Shell，可以执行命令。攻击者可以根据需要修改JSP代码，实现更复杂的功能。
3.  **利用POC上传文件：** 使用POC代码，指定目标服务器地址和JSP文件名，将恶意JSP文件上传到目标服务器。
    *   `-f`：指定包含目标列表的文件。每一行包含一个目标地址，格式为 `HOST:PORT` 或 `IP:PORT`。
    *   `-t`：指定单个目标地址，格式同上。
    *   `-j`：指定要上传的JSP文件名。
4.  **执行命令：** 访问上传的JSP文件，通过URL参数传递要执行的命令。

例如，如果JSP文件名为 `shell.jsp`，则可以通过访问 `https://target/authenticationendpoint/shell.jsp?cmd=whoami` 来执行 `whoami` 命令。


**项目地址:** [c1ph3rbyt3/CVE-2022-29464](https://github.com/c1ph3rbyt3/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #13

**来源**: [CVE-2022-29464-cc3305_CVE-2022-29464.md](../2022/CVE-2022-29464-cc3305_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。搜索引擎结果表明该漏洞已被积极利用，存在公开可用的PoC，并且厂商建议用户立即更新或采取临时缓解措施。

**投毒风险：**

该PoC代码主要通过文件上传功能将恶意的JSP文件上传到目标服务器的webapps目录下。直接观察代码，存在投毒的可能性较低，例如作者可能嵌入反向shell或其他恶意功能，但并未发现明显的恶意行为。但仍需要对该脚本依赖的库，以及脚本的作者进行信誉评估。同时代码使用`force`参数绕过版本检测，如果目标事实上不存在漏洞，可能会因为尝试上传恶意文件导致服务不稳定。综合评估，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者使用 `/fileupload` 端点，通过 `Content-Disposition` 中的目录遍历序列（例如 `../../../../`）将文件上传到 Web 根目录下的目录，如 `repository/deployment/server/webapps`。
2.  **文件上传：** 攻击者上传包含恶意代码的 JSP 文件（或其他 Web Shell），例如本例中，poc脚本构造一个jsp_shell，命令执行的命令通过参数传入，更加灵活。
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件触发恶意代码的执行，从而在服务器上执行任意命令。

总而言之，该漏洞利用方式是通过精心构造的HTTP请求，利用WSO2文件上传接口的目录遍历漏洞，上传恶意JSP文件，最终导致远程代码执行。

**项目地址:** [cc3305/CVE-2022-29464](https://github.com/cc3305/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #14

**来源**: [CVE-2022-29464-devengpk_CVE-2022-29464.md](../2022/CVE-2022-29464-devengpk_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，允许未经身份验证的攻击者上传恶意文件并在服务器上执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要目标WSO2服务器实例可以通过网络访问，并且存在/fileupload端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于 WSO2 产品中，允许未经授权的文件上传，最终导致远程代码执行。攻击者可以利用 `/fileupload` 端点，通过 `Content-Disposition` 头部进行目录遍历，将恶意 JSP 文件上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录等位置。由于 `/fileupload` 路由未受到身份验证的保护，攻击者无需登录即可利用此漏洞。

**利用方式：**
1.  攻击者构造包含恶意 JSP 代码的文件。
2.  攻击者向 `/fileupload` 端点发送包含 `Content-Disposition` 头部，进行目录遍历的 HTTP 请求，将恶意 JSP 文件上传到服务器的 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。
3.  服务器处理上传请求，并将恶意 JSP 文件写入目标目录。
4.  攻击者通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码执行，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞利用代码有效。

**投毒风险：**
虽然提供的代码主要描述了漏洞原理，但代码中仍存在小概率潜在的投毒风险。作者可能会在利用代码中添加一些难以察觉的恶意代码，例如反弹 shell 或植入后门等。因此，在使用此类代码时，需要谨慎审查，确保其安全性。初步估计投毒风险为10%。

**项目地址:** [devengpk/CVE-2022-29464](https://github.com/devengpk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #15

**来源**: [CVE-2022-29464-g0dxing_CVE-2022-29464.md](../2022/CVE-2022-29464-g0dxing_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 `/fileupload` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 端点上传任意文件，通过目录穿越将恶意JSP文件上传到webapps目录下，从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。多个来源都确认了该漏洞的存在和可利用性，并且存在公开的PoC。

**投毒风险：**
PoC 代码本身主要功能是上传 webshell，但是`reverse_jsp`使用了硬编码的`8.tcp.ngrok.io:12508`，存在潜在的风险，如果攻击者修改了这个reverse shell 的地址，有可能反弹shell到攻击者的机器上。虽然`public_key`变量存在，但是代码没有使用，所以可以排除钓鱼风险，综上判断，存在5%的投毒风险。

**利用方式：**
1.  攻击者使用带有目录穿越的 `Content-Disposition` 头构造恶意的POST请求到 `/fileupload` 端点。
2.  请求中包含要上传的恶意JSP文件，目标路径指向Web根目录下的一个可执行JSP的目录，例如 `repository/deployment/server/webapps`。
3.  服务器接收到请求后，由于未对上传的文件类型和目标路径进行充分验证，会将恶意JSP文件写入到指定目录。
4.  攻击者可以通过访问上传的JSP文件，执行其中的恶意代码，实现远程代码执行。

**项目地址:** [g0dxing/CVE-2022-29464](https://github.com/g0dxing/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #16

**来源**: [CVE-2022-29464-gbrsh_CVE-2022-29464.md](../2022/CVE-2022-29464-gbrsh_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传 / 远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权的攻击者上传恶意文件并执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标WSO2服务器存在/fileupload endpoint且未进行适当的路径限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的高危漏洞，允许未经身份验证的攻击者通过`/fileupload`端点上传任意文件，从而导致远程代码执行。攻击者利用路径遍历漏洞将恶意JSP文件上传到webapps目录下，例如`../../../../repository/deployment/server/webapps/authenticationendpoint/evil.jsp`。上传成功后，攻击者可以通过访问该JSP文件来执行任意系统命令。提供的POC代码通过构造包含恶意JSP代码的文件上传请求，利用该漏洞。代码首先上传一个包含命令执行功能的JSP文件，然后通过发送带有`cmd`参数的GET请求来执行系统命令。代码中未发现任何隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低。

**漏洞利用方式：**

1.  **文件上传：** 攻击者向目标WSO2服务器的`/fileupload`端点发送POST请求，上传包含恶意JSP代码的文件。Content-Disposition头包含路径遍历序列，将文件上传到webapps目录下。
2.  **代码执行：** 攻击者通过访问上传的JSP文件（例如`/authenticationendpoint/evil.jsp?cmd=whoami`）来执行任意系统命令。服务器执行JSP代码，并将命令执行结果返回给攻击者。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。利用成功与否取决于目标系统是否存在漏洞，是否打补丁，以及是否配置正确。

**搜索引擎结果：**

搜索结果表明，CVE-2022-29464是一个已被广泛利用的漏洞，多个安全厂商发布了关于该漏洞的分析报告和修复建议。有报告指出，该漏洞已被用于安装Cobalt Strike beacons和其他恶意软件。


**项目地址:** [gbrsh/CVE-2022-29464](https://github.com/gbrsh/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #17

**来源**: [CVE-2022-29464-hakivvi_CVE-2022-29464.md](../2022/CVE-2022-29464-hakivvi_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问到WSO2服务器的/fileupload端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞是一个存在于多个WSO2产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要是漏洞原理的分析和描述，并未发现直接的恶意代码。然而，任何公开的漏洞利用代码都存在被修改并植入恶意代码的风险。例如，攻击者可能修改POC，在成功上传JSP后，执行额外的恶意操作，例如下载并执行其他恶意程序。POC中直接包含恶意JSP的可能性较低，但后续利用上传的JSP进行投毒的可能性较高。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞位置：** 受影响的WSO2产品存在`/fileupload`端点，该端点允许未授权的文件上传。
2.  **路径穿越：** 攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）将上传的文件写入到Web根目录下的特定位置，如`repository/deployment/server/webapps`。
3.  **上传恶意文件：** 攻击者上传包含恶意代码的JSP文件。
4.  **远程代码执行：**  一旦恶意JSP文件被上传到Web根目录，攻击者可以通过访问该JSP文件来执行服务器上的任意代码。

**项目地址:** [hakivvi/CVE-2022-29464](https://github.com/hakivvi/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #18

**来源**: [CVE-2022-29464-hev0x_CVE-2022-29464.md](../2022/CVE-2022-29464-hev0x_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问，目标存在/fileupload端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的任意文件上传漏洞，允许未经授权的攻击者上传恶意文件并执行远程代码。根据漏洞信息和搜索结果，此漏洞利用涉及利用 `/fileupload` 端点，并使用 `Content-Disposition` 头部中的目录遍历序列将文件上传到 Web 根目录下的可访问位置，例如 `../../../../repository/deployment/server/webapps` 目录。POC 代码的工作原理如下：

1.  **定位目标：** 脚本接收包含目标 URL 的文件作为输入。
2.  **构造恶意请求：** 脚本构造一个 POST 请求，使用 `/fileupload/toolsAny` 端点，并在 `files` 参数中包含一个指向恶意 JSP 文件的映射。JSP 文件的内容是一个简单的 WebShell，允许执行任意命令。
3.  **目录遍历：** 脚本使用目录遍历序列 (例如 `../../../../`) 将 JSP 文件上传到 `repository/deployment/server/webapps/authenticationendpoint/megas.jsp` 路径下。 `authenticationendpoint` 是一个常见的 Web 应用目录，`megas.jsp` 是上传的 webshell 文件名。
4.  **执行代码：** 脚本通过访问上传的 JSP WebShell (例如 `/authenticationendpoint/megas.jsp?cmd=id`) 来执行命令。脚本首先尝试执行 `id` 命令以验证漏洞是否成功利用。
5.  **验证与输出：** 如果 `id` 命令执行成功并且返回了 `uid` 信息，脚本会认为目标存在漏洞，并将结果输出到屏幕和文件中。

**投毒风险分析：**

我分析了提供的 POC 代码。该代码的主要功能是利用目录遍历和文件上传漏洞在目标系统上部署一个 webshell，然后通过 webshell 执行系统命令。代码没有发现任何隐藏的、与漏洞利用无关的功能，例如收集用户信息、传播恶意软件或篡改系统配置等。因此，该 POC 代码的投毒风险评估为 0%。

**总结：**

该漏洞利用代码有效，因为它能够利用文件上传漏洞在目标系统上部署和执行恶意代码，从而实现远程代码执行。利用方式清晰，无需身份验证。由于代码只包含漏洞利用逻辑，因此不存在投毒风险。

**项目地址:** [hev0x/CVE-2022-29464](https://github.com/hev0x/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #19

**来源**: [CVE-2022-29464-hupe1980_CVE-2022-29464.md](../2022/CVE-2022-29464-hupe1980_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的高危漏洞，它允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，最终导致远程代码执行。该漏洞的利用方式是通过构造包含目录穿越序列的 `Content-Disposition` 头，将恶意 JSP 文件上传到 Web 根目录下的可访问位置，如 `repository/deployment/server/webapps` 目录。上传的 JSP 文件包含执行任意命令的代码。根据提供的漏洞利用代码 `exploit.py`，该脚本通过 POST 请求向目标服务器的 `/fileupload/toolsAny` 端点上传一个包含恶意代码的 JSP 文件。攻击者可以通过访问上传的 JSP 文件来执行任意命令。例如，脚本会将包含一个表单的 JSP shell 上传到 `/authenticationendpoint` 应用目录下。 该代码看起来是直接利用漏洞，没有发现隐藏的恶意代码或者后门，所以投毒风险评估为0%。 搜索引擎结果也表明该漏洞已被广泛利用，并建议用户尽快更新或采取缓解措施。

**项目地址:** [hupe1980/CVE-2022-29464](https://github.com/hupe1980/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #20

**来源**: [CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md](../2022/CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行，系统完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经授权的文件上传，并最终导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 头部中的目录遍历序列（如 `../../../../`）将恶意文件上传到 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。上传的文件可以是 JSP、WAR 或其他可执行格式，从而允许攻击者在服务器上执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的目标服务器。
2.  **构造恶意请求：** 构造一个包含恶意文件的 POST 请求，该文件将被上传到 `/fileupload` 端点。请求的 `Content-Disposition` 头部必须包含目录遍历序列，以便将文件放置在 Web 根目录下的可执行目录中。
3.  **上传恶意文件：** 发送构造的请求到目标服务器。服务器会处理请求并将恶意文件上传到指定目录。
4.  **触发代码执行：** 通过访问上传的恶意文件（例如，通过 Web 浏览器），触发服务器执行其中的代码。

**投毒风险分析：**

提供的漏洞利用代码段（`LICENSE`文件）是 GNU GPL 许可证的文本，不包含任何恶意代码或投毒行为。因此，此代码段本身不存在投毒风险。 但是，如果提供的仓库中包含其他payload.jsp或者war,那么会存在投毒风险.根据现有信息，投毒风险为0%。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2022-29464 漏洞利用的有效性很高，该漏洞被广泛利用，并且已经有公开的PoC利用代码。

**项目地址:** [hxlxmj/Mass-exploit-CVE-2022-29464](https://github.com/hxlxmj/Mass-exploit-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #21

**来源**: [CVE-2022-29464-jimidk_Better-CVE-2022-29464.md](../2022/CVE-2022-29464-jimidk_Better-CVE-2022-29464.md)

# CVE-2022-29464

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-29464-000pp_WSOB.md](../2022/CVE-2022-29464-000pp_WSOB.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器开放fileupload端点，且攻击者可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞存在于多个WSO2产品中，允许未经授权的文件上传，最终导致远程代码执行。

**漏洞利用方式：**

攻击者通过 `/fileupload` 端点，利用 `Content-Disposition` 头部的目录穿越（Path Traversal）序列，将恶意文件上传到Web根目录下的可执行目录，例如 `../../../../repository/deployment/server/webapps`。上传的文件会被服务器解析执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Trend Micro等安全厂商的分析）和提供的POC代码（WSOB工具），该漏洞利用的有效性很高。网上有大量的关于此漏洞的分析文章和漏洞利用案例。

**投毒风险：**

提供的POC代码是一个相对简单的Python脚本，主要功能是利用该漏洞进行文件上传。主要包含以下几个文件:
* `main.py`: 主程序入口，解析参数并启动漏洞利用。
* `src/interface/ui.py`: 定义了用户界面相关的函数，如显示banner。
* `src/wsob/main.py`: 漏洞利用的核心代码。
* `requirements.txt`: 依赖的Python库。

通过分析POC代码，**未发现明显的恶意代码或后门**。代码逻辑相对清晰，主要是发送HTTP请求，构造恶意的文件上传请求，进行目录穿越，实现任意文件上传。

但依旧存在潜在的投毒风险：

1.  **依赖风险：** `requirements.txt` 中列出的依赖库可能存在安全漏洞，攻击者可以通过供应链攻击，篡改这些依赖库，从而植入恶意代码。但是概率较低。
2. **漏洞利用代码本身的缺陷:**  漏洞利用代码中可能包含未知的缺陷或者错误，导致利用失败，或者引发其他安全问题。但是根据目前搜索结果该POC相对比较成熟。

**综合评估，该POC代码存在轻微的投毒风险，大约为5%。**

**项目地址:** [000pp/WSOB](https://github.com/000pp/WSOB)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #2

**来源**: [CVE-2022-29464-Chocapikk_CVE-2022-29464.md](../2022/CVE-2022-29464-Chocapikk_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** Unrestricted File Upload/Remote Code Execution

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的文件上传导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM/KM 1.4.0 to 2.0.0

**利用条件:** 目标服务器存在fileupload endpoint，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 允许未经授权的文件上传，导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 目录遍历序列，将恶意JSP文件上传至Web根目录下的 `repository/deployment/server/webapps` 目录，从而实现RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞是有效的。搜索结果中多个来源确认了该漏洞的存在和利用，并给出了相应的修复建议。漏洞利用代码通过上传JSP webshell来实现远程代码执行。

**投毒风险：**

POC代码中存在一定的投毒风险的可能性，可能性估计为10%。

*   **反弹shell配置：** `reverse_jsp` 中包含硬编码的反弹shell服务器 `8.tcp.ngrok.io:12508`。虽然这可能是为了方便测试，但也可能被用于跟踪或控制利用者的行为。此IP和端口并不一定是恶意的，但是需要使用者额外注意。
*   **公钥上传：**代码中存在上传公钥的部分，用途不明，存在潜在风险。
*   **代码审查：** 漏洞利用代码本身的行为是上传JSP文件，并在目标系统上执行命令。审查发现此代码中无明显恶意逻辑，但是使用者需要进行仔细的代码审查,确认符合预期行为。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本 WSO2 产品的服务器。
2.  **上传恶意文件：** 利用 `/fileupload` 端点，通过构造包含目录遍历的 `Content-Disposition` 请求，上传包含恶意代码的 JSP 文件到服务器的 `/repository/deployment/server/webapps` 目录，例如上传到 `authenticationendpoint` 目录下。
3.  **触发恶意代码：** 访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。POC代码中上传了webshell `balgo.jsp` 和反弹shell `balgorev.jsp`。
4.  **反弹shell接收:** 如果成功利用了反弹shell,需要在相应ip和端口监听,接收反弹shell连接

**项目地址:** [Chocapikk/CVE-2022-29464](https://github.com/Chocapikk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #3

**来源**: [CVE-2022-29464-LinJacck_CVE-2022-29464.md](../2022/CVE-2022-29464-LinJacck_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。

**漏洞分析：**

该漏洞的根本原因是 WSO2 产品中的 `/fileupload` 接口没有对上传的文件进行充分的验证。攻击者可以利用目录遍历漏洞，通过在 `Content-Disposition` 头中构造恶意路径，将恶意文件上传到 Web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。

**利用方式：**

1.  攻击者首先需要确定目标系统存在漏洞，即存在 `/fileupload` 接口且允许上传文件。
2.  攻击者构造一个包含恶意代码的 JSP 文件（或其他服务器支持的脚本文件）。
3.  攻击者构造一个包含目录遍历序列的 HTTP POST 请求，将恶意 JSP 文件上传到目标服务器的 Web 根目录下的 `repository/deployment/server/webapps/authenticationendpoint/` 目录中。文件名可以自定义，但通常以 `.jsp` 结尾，如 ShellDef变量所示。
4.  攻击者通过访问上传的 JSP 文件，即可执行其中的恶意代码，从而获得对服务器的控制权。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用 CVE-2022-29464 漏洞。

*   它首先定义了一个 `exploit` 函数，该函数负责构造包含恶意 JSP 代码的 HTTP POST 请求，并将该请求发送到目标服务器的 `/fileupload` 接口。
*   JSP 代码创建一个简单的 Web shell，允许攻击者通过 Web 界面执行任意系统命令。
*  脚本尝试上传一个名为`404.jsp`的文件用以验证漏洞.如果上传成功,则上传webshell到`/authenticationendpoint`目录下。
*  脚本还允许从外部文件读取webshell的内容并上传,增强了灵活性

**投毒风险评估：**

该 POC 代码本身**没有明显的投毒行为**。代码只是尝试上传 webshell，以便进行远程代码执行。恶意行为完全取决于攻击者上传的 JSP 文件中的内容。因此，该代码的投毒风险较低,可以认为是0。

**有效性：**

根据漏洞描述和 POC 代码的实现，以及搜索引擎返回的结果，该 POC 代码能够有效地利用 CVE-2022-29464 漏洞，实现任意文件上传和远程代码执行。


**项目地址:** [LinJacck/CVE-2022-29464](https://github.com/LinJacck/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #4

**来源**: [CVE-2022-29464-Pasch0_WSO2RCE.md](../2022/CVE-2022-29464-Pasch0_WSO2RCE.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问，目标存在/fileupload接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重的任意文件上传漏洞，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头部的请求，上传恶意文件到 web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。上传的文件可以被当作 JSP 或其他可执行文件解析，从而导致远程代码执行。根据搜索结果，该漏洞已经被广泛利用，并被用于安装 Cobalt Strike beacons 和其他恶意软件。提供的代码片段是 GNU GPL 协议，与漏洞利用本身无关，因此不存在投毒风险。利用方式主要为：

1.  利用 `/fileupload` 接口上传文件。
2.  在 `Content-Disposition` 头中构造目录遍历路径，将文件上传到 webapps 目录下。
3.  上传恶意 JSP 或其他可执行文件。
4.  通过访问上传的文件执行任意代码。

由于该漏洞已经被 CISA 加入已知被利用漏洞目录，建议尽快修复。

**项目地址:** [Pasch0/WSO2RCE](https://github.com/Pasch0/WSO2RCE)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #5

**来源**: [CVE-2022-29464-Pushkarup_CVE-2022-29464.md](../2022/CVE-2022-29464-Pushkarup_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的关键漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  攻击者通过`/fileupload`端点上传恶意文件，通常是包含恶意代码的JSP webshell。
2.  攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）绕过文件上传限制，将webshell上传到Web根目录下的可执行目录，例如`repository/deployment/server/webapps`。
3.  一旦webshell上传成功，攻击者可以通过访问该webshell的URL来执行任意代码。

**有效性评估：**

*   根据漏洞信息、搜索引擎结果和提供的POC代码，此漏洞的利用是有效的。 搜索引擎结果显示，该漏洞已被积极利用（例如TrendMicro报告）。 提供的POC代码（`wso.py` 脚本）旨在自动化利用过程，包括上传webshell并执行命令。

**投毒风险评估：**

该漏洞利用代码主要包含以下几个文件:

*   `LICENSE`：MIT许可证声明，表明代码是开源的，并允许修改和分发。
*   `README.md`：包含漏洞描述、免责声明、利用说明、webshell功能介绍、安装步骤、使用方法、贡献方式、许可协议和联系方式等信息。免责声明明确表示该POC仅用于教育目的，禁止用于非法活动。
*   `wso.py`：此Python脚本包含漏洞利用的核心代码，用于扫描目标站点是否存在漏洞、上传webshell、执行命令等操作。
*   `requirements.txt`：列出了脚本运行所需的Python依赖包，包括requests、colorama和urllib3。

考虑到代码的结构和功能，投毒的潜在风险较低，但仍然存在以下可能性：

1.  **Webshell后门植入**: `wso.py`脚本可能包含额外的后门或恶意代码，虽然webshell本身就是后门，但可能隐藏更深层的控制机制。
2.  **依赖包投毒**: 虽然 `requirements.txt` 文件中的依赖包看起来是标准的，但攻击者可能会使用拼写相似的恶意包来替换它们（例如，将`requests`替换为`requ3sts`）。
3.  **信息收集**: 脚本可能会暗中收集目标系统的信息，并将这些信息发送给攻击者。
4.  **资源消耗**: 脚本可能设计为消耗目标系统的资源，例如CPU或内存，从而导致拒绝服务。

鉴于以上分析，我估计该POC代码存在10%的投毒风险。 这个比例基于以下因素：

*   该POC的主要功能是利用已知的漏洞，目的是方便用户进行测试和验证。
*   POC的作者声明仅用于教育目的。
*   代码开源，方便其他人审查。
*   潜在的风险因素（如webshell后门、依赖包投毒、信息收集和资源消耗）依然存在，需要保持警惕。

**安全建议：**

*   在运行此POC之前，务必在一个隔离的环境中进行。
*   仔细审查代码，特别注意webshell和依赖包。
*   使用网络监控工具来检测任何异常的网络活动。


**项目地址:** [Pushkarup/CVE-2022-29464](https://github.com/Pushkarup/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #6

**来源**: [CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md](../2022/CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码。

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口，且未对上传的文件类型和路径进行严格限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于多个 WSO2 产品中，是一个严重的安全漏洞。攻击者可以利用`/fileupload`接口，通过目录遍历的方式将恶意 JSP 文件上传到 Web 应用的根目录下，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`。上传的 JSP 文件随后可以被 Web 服务器执行，从而导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用方式是有效的，并且已经被广泛利用。
提供的 PoC 代码尝试上传一个名为 `shell.jsp` 的 JSP 文件，该文件包含可以执行系统命令的恶意代码。如果上传成功，攻击者可以通过访问 `http(s)://目标地址/authenticationendpoint/shell.jsp` 来执行任意代码。

**投毒风险：**

PoC 代码中，`/tmp/e2105c9753cc00a9633b2cfd9b6fe351/cve.py` 主要功能是发送恶意请求，上传木马文件，整体代码没有明显的投毒行为。但是，以下几点需要注意：
*   `Files/shell.jsp`: 这是一个后门文件，如果未经审查直接使用，可能会引入未知风险。建议在使用前，仔细检查 `shell.jsp` 的内容，确保其只包含必要的功能，并且没有恶意代码。
*   对 `requirements.txt` 中引入的第三方库也需要进行审核，确保没有引入恶意的依赖。
*   README.md 感谢列表,作者SynixCyberCrimeMY & ?/h4zzzzzz.scc 未知。

因此，投毒风险较低，预估在10%左右。

**利用方式：**

1.  攻击者构造包含目录遍历的恶意请求，利用`/fileupload`接口上传恶意的 JSP 文件 (shell.jsp)。
2.  恶意 JSP 文件被上传到 Web 应用的根目录下。
3.  攻击者通过 Web 浏览器访问上传的 JSP 文件，执行其中的恶意代码。
4.  恶意代码在服务器上执行，允许攻击者执行任意系统命令，从而完全控制受影响的系统。

**防范措施：**

*   升级到 WSO2 官方修复后的版本。
*   实施文件上传白名单策略，仅允许上传必要的文件类型。
*   对上传的文件进行严格的路径验证，防止目录遍历攻击。
*   部署 Web 应用防火墙 (WAF)，检测和阻止恶意的文件上传请求。

**项目地址:** [SynixCyberCrimeMy/CVE-2022-29464](https://github.com/SynixCyberCrimeMy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #7

**来源**: [CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md](../2022/CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标存在/fileupload端点且未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，攻击者可以通过利用/fileupload端点上传任意文件，结合目录遍历将恶意JSP文件写入到webapps目录下，从而实现远程代码执行。该POC脚本首先生成一个随机文件名的JSP webshell，然后通过POST请求将该webshell上传到目标服务器的/fileupload/toolsAny端点。请求头中包含目录遍历(../)序列，用于将文件写入到服务器的webapps目录。上传后，脚本会休眠15秒，然后尝试通过GET请求访问上传的webshell，并执行指定的命令。如果返回状态码为200，则表示webshell执行成功。该POC的利用方式是典型的任意文件上传结合目录遍历实现RCE的漏洞利用方式。

**有效性:**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的，可以利用该漏洞在目标服务器上执行任意代码。

**投毒风险:**
代码没有发现明显的恶意行为或隐藏的后门。所有操作都与漏洞利用相关，例如上传 webshell 和执行命令。该代码的主要目的是为了验证漏洞的存在并进行简单的命令执行，没有检测到任何试图损害用户系统或窃取信息的行为。

**利用方式:**
1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的服务器。
2.  **上传 Webshell：** 使用包含目录遍历的 Content-Disposition 头的 POST 请求，将恶意 JSP 文件上传到`/fileupload/toolsAny`端点。
3.  **远程代码执行：** 通过访问上传的 JSP 文件，传递需要执行的命令作为参数，实现远程代码执行。例如：`{host}/authenticationendpoint/{filename}?cmd={command}`


**项目地址:** [SystemVll/CVE-2022-29464-loader](https://github.com/SystemVll/CVE-2022-29464-loader)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #8

**来源**: [CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md](../2022/CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传漏洞

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 - 4.0.0, WSO2 Identity Server 5.2.0 - 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 - 5.11.0, WSO2 Enterprise Integrator 6.2.0 - 6.6.0, WSO2 Open Banking AM 1.4.0 - 2.0.0, WSO2 Open Banking KM 1.4.0 - 2.0.0

**利用条件:** 需要网络访问，目标存在 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。漏洞的根源在于 /fileupload 接口缺乏适当的文件类型验证，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头，将恶意文件上传到 Web 根目录下的可执行位置，例如 repository/deployment/server/webapps 目录。上传的文件可以是 JSP 文件或其他服务器支持的脚本类型。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 WSO2 产品的服务器。
2.  **构造恶意请求：**  构造一个包含恶意文件的 HTTP POST 请求，该请求发送到 /fileupload 接口。Content-Disposition 头必须包含目录遍历序列，以将文件上传到 Web 根目录下的指定位置。
3.  **上传文件：**  将构造的请求发送到目标服务器。
4.  **执行代码：**  通过访问上传的文件来触发恶意代码的执行。例如，如果上传的是 JSP 文件，则可以通过 Web 浏览器访问该文件来执行其中的代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源都证实了该漏洞的存在和利用方式，并且提供了可用的 POC 代码。

**投毒风险：**

提供的 POC 代码（wso.py）主要功能是利用漏洞进行文件上传和远程代码执行。代码包含以下部分：

*   **请求库 (requests)：**  用于发送 HTTP 请求。
*   **目录创建 (os.mkdir)：**  用于创建结果目录。
*   **命令行清除 (os.system)：**  用于清除屏幕。
*   **Banner 打印：** 用于打印作者信息及免责声明

虽然没有明显的恶意代码，但仍存在一些潜在的风险：

*   **依赖项风险：** requirements.txt 文件中列出的依赖项（requests, urllib3, colorama）本身可能存在漏洞。如果这些依赖项被篡改或包含恶意代码，则可能导致安全问题。
*   **编码风险：** 代码没有对用户输入进行严格的验证，可能存在潜在的代码注入风险。例如，如果目标 URL 可控，攻击者可能会注入恶意代码。
*   **免责声明：** 作者的免责声明也暗示了使用该工具可能存在的风险，虽然正常的漏洞利用工具都有免责声明，但是也暗示此工具有一定的风险。

综上所述，该仓库存在较低的投毒风险，约为 10%。主要风险来自于依赖项和编码风险，需要仔细审查代码和依赖项，确保安全性。


**项目地址:** [ThatNotEasy/CVE-2022-29464](https://github.com/ThatNotEasy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #9

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #10

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 到 4.0.0, WSO2 Identity Server 5.2.0 到 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 和 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 到 5.11.0, WSO2 Enterprise Integrator 6.2.0 到 6.6.0, WSO2 Open Banking AM 1.4.0 到 2.0.0 和 WSO2 Open Banking KM 1.4.0, 到 2.0.0

**利用条件:** 需要网络访问目标 WSO2 实例，利用 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而实现远程代码执行。该漏洞的核心在于 `/fileupload` 端点未进行严格的身份验证和文件类型限制。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：**  WSO2 产品中的 `/fileupload` 端点允许未经身份验证的文件上传。`FileUploadServlet` 处理该请求，并根据 `carbon.xml` 配置文件加载的文件上传执行器处理上传的文件。由于未进行充分的验证，攻击者可以上传恶意文件。
2.  **利用步骤：**
    *   攻击者发送包含恶意 JSP 代码的 HTTP POST 请求到 `/fileupload` 端点。
    *   请求的 `Content-Disposition` 头包含目录遍历序列 (例如 `../../../../repository/deployment/server/webapps`)，用于将文件上传到 Web 根目录下的可执行目录。
    *   上传的 JSP 文件会被 WSO2 服务器执行，从而允许攻击者执行任意代码。
3.  **有效性评估：** 漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是可利用的，并且已经有公开的 PoC 代码存在。
4.  **投毒风险评估：**  漏洞利用代码的仓库中可能存在投毒的风险。虽然主要的利用方式是利用已知的漏洞，但仓库中可能会包含一些隐藏的、不明显的功能或代码，这些代码可能用于收集信息、植入后门或执行其他恶意活动。因此，对代码的审计是必要的，且投毒风险存在，约为 10%。风险主要来自于：
    *   **非必要的辅助脚本：** 仓库中可能包含一些非漏洞利用必需的脚本，例如用于扫描或配置的脚本，这些脚本可能包含恶意代码。
    *   **混淆的代码：**  某些代码可能经过混淆，使得难以分析其真实行为。
    *   **供应链攻击：**  仓库可能依赖于外部的库或组件，这些库或组件可能被恶意篡改。
    *   **社会工程：**  攻击者可能通过提交看似无害的 Pull Request 来引入恶意代码。
5.  **缓解措施：**
    *   升级到已修复漏洞的 WSO2 产品版本。
    *   实施严格的文件上传验证机制，包括身份验证、文件类型检查和大小限制。
    *   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
    *   定期进行安全审计和漏洞扫描。

**项目地址:** [amit-pathak009/CVE-2022-29464](https://github.com/amit-pathak009/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #11

**来源**: [CVE-2022-29464-axin2019_CVE-2022-29464.md](../2022/CVE-2022-29464-axin2019_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要目标服务器开放web端口且服务未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是WSO2产品中的一个严重漏洞，允许未经授权的文件上传，从而导致远程代码执行。攻击者通过向 `/fileupload` 端点发送包含目录遍历序列 `../../../../repository/deployment/server/webapps` 的 `Content-Disposition` 头部的恶意请求，绕过文件上传限制，将恶意JSP文件上传到web根目录下。  

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造一个`multipart/form-data`类型的POST请求，其中包含恶意JSP代码。请求的`Content-Disposition`头部使用目录遍历，将文件上传到目标web应用的`/repository/deployment/server/webapps`目录下的一个可访问的路径，如`authenticationendpoint`。
2.  **绕过上传限制：** 由于漏洞存在于文件上传的路径验证环节，攻击者可以利用目录遍历绕过服务器的文件类型和大小限制。
3.  **远程代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件，执行任意系统命令。
4.  **POC代码分析：**  提供的Python POC脚本模拟了上述攻击流程。脚本首先尝试访问目标URL，然后发送包含JSP后门的`multipart/form-data`请求到`/fileupload/toolsAny`，通过目录遍历将JSP文件上传到`authenticationendpoint`目录下。最后，脚本通过访问上传的JSP文件，执行`whoami`命令来验证漏洞是否存在。脚本中使用了两个不同的请求头`headers1`和`headers2`，针对目标进行尝试，提高了漏洞利用成功率。

**有效性评估：**

根据漏洞描述和POC代码，此漏洞利用方法有效，因为成功上传JSP文件即可执行任意命令。

**投毒风险评估：**

POC代码本身包含了一个用于远程代码执行的JSP后门，但这不是作者植入的恶意代码，而是漏洞利用的必要组成部分。代码中存在轻微的投毒风险（约10%），因为用户在复制和粘贴POC代码时，可能会无意中引入其他潜在的恶意代码或依赖项，但主要的风险在于漏洞本身，而不是POC代码的作者植入恶意代码。

**项目地址:** [axin2019/CVE-2022-29464](https://github.com/axin2019/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #12

**来源**: [CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md](../2022/CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM 等

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在漏洞并且可以通过网络访问 /fileupload 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 接口上传任意文件，通过目录穿越将文件写入到webapps目录下，从而导致远程代码执行。

**有效性分析：**

提供的POC代码利用了该漏洞。代码通过构造一个包含恶意JSP代码的文件，并使用目录穿越的方式将其上传到目标服务器的 `repository/deployment/server/webapps/authenticationendpoint/` 目录下。上传成功后，攻击者可以通过访问上传的JSP文件来执行任意命令。
根据搜索结果显示，该漏洞已经被广泛利用，证明POC的有效性。

**投毒风险分析：**

代码本身的功能是实现漏洞利用，上传并执行JSP后门。其中恶意行为是利用漏洞本身，而非代码作者额外添加的恶意功能。代码的危害在于利用漏洞，代码本身较为直白。
尽管如此，仍然存在微小的投毒风险，例如作者可能在代码中加入隐蔽的回连等恶意功能，但可能性较低，评估为5%。

**利用方式：**

1.  **确定目标：** 确定存在CVE-2022-29464漏洞的WSO2产品实例。
2.  **构造恶意JSP文件：** POC代码中已经包含了一个简单的JSP Shell，可以执行命令。攻击者可以根据需要修改JSP代码，实现更复杂的功能。
3.  **利用POC上传文件：** 使用POC代码，指定目标服务器地址和JSP文件名，将恶意JSP文件上传到目标服务器。
    *   `-f`：指定包含目标列表的文件。每一行包含一个目标地址，格式为 `HOST:PORT` 或 `IP:PORT`。
    *   `-t`：指定单个目标地址，格式同上。
    *   `-j`：指定要上传的JSP文件名。
4.  **执行命令：** 访问上传的JSP文件，通过URL参数传递要执行的命令。

例如，如果JSP文件名为 `shell.jsp`，则可以通过访问 `https://target/authenticationendpoint/shell.jsp?cmd=whoami` 来执行 `whoami` 命令。


**项目地址:** [c1ph3rbyt3/CVE-2022-29464](https://github.com/c1ph3rbyt3/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #13

**来源**: [CVE-2022-29464-cc3305_CVE-2022-29464.md](../2022/CVE-2022-29464-cc3305_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。搜索引擎结果表明该漏洞已被积极利用，存在公开可用的PoC，并且厂商建议用户立即更新或采取临时缓解措施。

**投毒风险：**

该PoC代码主要通过文件上传功能将恶意的JSP文件上传到目标服务器的webapps目录下。直接观察代码，存在投毒的可能性较低，例如作者可能嵌入反向shell或其他恶意功能，但并未发现明显的恶意行为。但仍需要对该脚本依赖的库，以及脚本的作者进行信誉评估。同时代码使用`force`参数绕过版本检测，如果目标事实上不存在漏洞，可能会因为尝试上传恶意文件导致服务不稳定。综合评估，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者使用 `/fileupload` 端点，通过 `Content-Disposition` 中的目录遍历序列（例如 `../../../../`）将文件上传到 Web 根目录下的目录，如 `repository/deployment/server/webapps`。
2.  **文件上传：** 攻击者上传包含恶意代码的 JSP 文件（或其他 Web Shell），例如本例中，poc脚本构造一个jsp_shell，命令执行的命令通过参数传入，更加灵活。
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件触发恶意代码的执行，从而在服务器上执行任意命令。

总而言之，该漏洞利用方式是通过精心构造的HTTP请求，利用WSO2文件上传接口的目录遍历漏洞，上传恶意JSP文件，最终导致远程代码执行。

**项目地址:** [cc3305/CVE-2022-29464](https://github.com/cc3305/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #14

**来源**: [CVE-2022-29464-devengpk_CVE-2022-29464.md](../2022/CVE-2022-29464-devengpk_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，允许未经身份验证的攻击者上传恶意文件并在服务器上执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要目标WSO2服务器实例可以通过网络访问，并且存在/fileupload端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于 WSO2 产品中，允许未经授权的文件上传，最终导致远程代码执行。攻击者可以利用 `/fileupload` 端点，通过 `Content-Disposition` 头部进行目录遍历，将恶意 JSP 文件上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录等位置。由于 `/fileupload` 路由未受到身份验证的保护，攻击者无需登录即可利用此漏洞。

**利用方式：**
1.  攻击者构造包含恶意 JSP 代码的文件。
2.  攻击者向 `/fileupload` 端点发送包含 `Content-Disposition` 头部，进行目录遍历的 HTTP 请求，将恶意 JSP 文件上传到服务器的 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。
3.  服务器处理上传请求，并将恶意 JSP 文件写入目标目录。
4.  攻击者通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码执行，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞利用代码有效。

**投毒风险：**
虽然提供的代码主要描述了漏洞原理，但代码中仍存在小概率潜在的投毒风险。作者可能会在利用代码中添加一些难以察觉的恶意代码，例如反弹 shell 或植入后门等。因此，在使用此类代码时，需要谨慎审查，确保其安全性。初步估计投毒风险为10%。

**项目地址:** [devengpk/CVE-2022-29464](https://github.com/devengpk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #15

**来源**: [CVE-2022-29464-g0dxing_CVE-2022-29464.md](../2022/CVE-2022-29464-g0dxing_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 `/fileupload` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 端点上传任意文件，通过目录穿越将恶意JSP文件上传到webapps目录下，从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。多个来源都确认了该漏洞的存在和可利用性，并且存在公开的PoC。

**投毒风险：**
PoC 代码本身主要功能是上传 webshell，但是`reverse_jsp`使用了硬编码的`8.tcp.ngrok.io:12508`，存在潜在的风险，如果攻击者修改了这个reverse shell 的地址，有可能反弹shell到攻击者的机器上。虽然`public_key`变量存在，但是代码没有使用，所以可以排除钓鱼风险，综上判断，存在5%的投毒风险。

**利用方式：**
1.  攻击者使用带有目录穿越的 `Content-Disposition` 头构造恶意的POST请求到 `/fileupload` 端点。
2.  请求中包含要上传的恶意JSP文件，目标路径指向Web根目录下的一个可执行JSP的目录，例如 `repository/deployment/server/webapps`。
3.  服务器接收到请求后，由于未对上传的文件类型和目标路径进行充分验证，会将恶意JSP文件写入到指定目录。
4.  攻击者可以通过访问上传的JSP文件，执行其中的恶意代码，实现远程代码执行。

**项目地址:** [g0dxing/CVE-2022-29464](https://github.com/g0dxing/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #16

**来源**: [CVE-2022-29464-gbrsh_CVE-2022-29464.md](../2022/CVE-2022-29464-gbrsh_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传 / 远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权的攻击者上传恶意文件并执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标WSO2服务器存在/fileupload endpoint且未进行适当的路径限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的高危漏洞，允许未经身份验证的攻击者通过`/fileupload`端点上传任意文件，从而导致远程代码执行。攻击者利用路径遍历漏洞将恶意JSP文件上传到webapps目录下，例如`../../../../repository/deployment/server/webapps/authenticationendpoint/evil.jsp`。上传成功后，攻击者可以通过访问该JSP文件来执行任意系统命令。提供的POC代码通过构造包含恶意JSP代码的文件上传请求，利用该漏洞。代码首先上传一个包含命令执行功能的JSP文件，然后通过发送带有`cmd`参数的GET请求来执行系统命令。代码中未发现任何隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低。

**漏洞利用方式：**

1.  **文件上传：** 攻击者向目标WSO2服务器的`/fileupload`端点发送POST请求，上传包含恶意JSP代码的文件。Content-Disposition头包含路径遍历序列，将文件上传到webapps目录下。
2.  **代码执行：** 攻击者通过访问上传的JSP文件（例如`/authenticationendpoint/evil.jsp?cmd=whoami`）来执行任意系统命令。服务器执行JSP代码，并将命令执行结果返回给攻击者。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。利用成功与否取决于目标系统是否存在漏洞，是否打补丁，以及是否配置正确。

**搜索引擎结果：**

搜索结果表明，CVE-2022-29464是一个已被广泛利用的漏洞，多个安全厂商发布了关于该漏洞的分析报告和修复建议。有报告指出，该漏洞已被用于安装Cobalt Strike beacons和其他恶意软件。


**项目地址:** [gbrsh/CVE-2022-29464](https://github.com/gbrsh/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #17

**来源**: [CVE-2022-29464-hakivvi_CVE-2022-29464.md](../2022/CVE-2022-29464-hakivvi_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问到WSO2服务器的/fileupload端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞是一个存在于多个WSO2产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要是漏洞原理的分析和描述，并未发现直接的恶意代码。然而，任何公开的漏洞利用代码都存在被修改并植入恶意代码的风险。例如，攻击者可能修改POC，在成功上传JSP后，执行额外的恶意操作，例如下载并执行其他恶意程序。POC中直接包含恶意JSP的可能性较低，但后续利用上传的JSP进行投毒的可能性较高。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞位置：** 受影响的WSO2产品存在`/fileupload`端点，该端点允许未授权的文件上传。
2.  **路径穿越：** 攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）将上传的文件写入到Web根目录下的特定位置，如`repository/deployment/server/webapps`。
3.  **上传恶意文件：** 攻击者上传包含恶意代码的JSP文件。
4.  **远程代码执行：**  一旦恶意JSP文件被上传到Web根目录，攻击者可以通过访问该JSP文件来执行服务器上的任意代码。

**项目地址:** [hakivvi/CVE-2022-29464](https://github.com/hakivvi/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #18

**来源**: [CVE-2022-29464-hev0x_CVE-2022-29464.md](../2022/CVE-2022-29464-hev0x_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问，目标存在/fileupload端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的任意文件上传漏洞，允许未经授权的攻击者上传恶意文件并执行远程代码。根据漏洞信息和搜索结果，此漏洞利用涉及利用 `/fileupload` 端点，并使用 `Content-Disposition` 头部中的目录遍历序列将文件上传到 Web 根目录下的可访问位置，例如 `../../../../repository/deployment/server/webapps` 目录。POC 代码的工作原理如下：

1.  **定位目标：** 脚本接收包含目标 URL 的文件作为输入。
2.  **构造恶意请求：** 脚本构造一个 POST 请求，使用 `/fileupload/toolsAny` 端点，并在 `files` 参数中包含一个指向恶意 JSP 文件的映射。JSP 文件的内容是一个简单的 WebShell，允许执行任意命令。
3.  **目录遍历：** 脚本使用目录遍历序列 (例如 `../../../../`) 将 JSP 文件上传到 `repository/deployment/server/webapps/authenticationendpoint/megas.jsp` 路径下。 `authenticationendpoint` 是一个常见的 Web 应用目录，`megas.jsp` 是上传的 webshell 文件名。
4.  **执行代码：** 脚本通过访问上传的 JSP WebShell (例如 `/authenticationendpoint/megas.jsp?cmd=id`) 来执行命令。脚本首先尝试执行 `id` 命令以验证漏洞是否成功利用。
5.  **验证与输出：** 如果 `id` 命令执行成功并且返回了 `uid` 信息，脚本会认为目标存在漏洞，并将结果输出到屏幕和文件中。

**投毒风险分析：**

我分析了提供的 POC 代码。该代码的主要功能是利用目录遍历和文件上传漏洞在目标系统上部署一个 webshell，然后通过 webshell 执行系统命令。代码没有发现任何隐藏的、与漏洞利用无关的功能，例如收集用户信息、传播恶意软件或篡改系统配置等。因此，该 POC 代码的投毒风险评估为 0%。

**总结：**

该漏洞利用代码有效，因为它能够利用文件上传漏洞在目标系统上部署和执行恶意代码，从而实现远程代码执行。利用方式清晰，无需身份验证。由于代码只包含漏洞利用逻辑，因此不存在投毒风险。

**项目地址:** [hev0x/CVE-2022-29464](https://github.com/hev0x/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #19

**来源**: [CVE-2022-29464-hupe1980_CVE-2022-29464.md](../2022/CVE-2022-29464-hupe1980_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的高危漏洞，它允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，最终导致远程代码执行。该漏洞的利用方式是通过构造包含目录穿越序列的 `Content-Disposition` 头，将恶意 JSP 文件上传到 Web 根目录下的可访问位置，如 `repository/deployment/server/webapps` 目录。上传的 JSP 文件包含执行任意命令的代码。根据提供的漏洞利用代码 `exploit.py`，该脚本通过 POST 请求向目标服务器的 `/fileupload/toolsAny` 端点上传一个包含恶意代码的 JSP 文件。攻击者可以通过访问上传的 JSP 文件来执行任意命令。例如，脚本会将包含一个表单的 JSP shell 上传到 `/authenticationendpoint` 应用目录下。 该代码看起来是直接利用漏洞，没有发现隐藏的恶意代码或者后门，所以投毒风险评估为0%。 搜索引擎结果也表明该漏洞已被广泛利用，并建议用户尽快更新或采取缓解措施。

**项目地址:** [hupe1980/CVE-2022-29464](https://github.com/hupe1980/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #20

**来源**: [CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md](../2022/CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行，系统完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经授权的文件上传，并最终导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 头部中的目录遍历序列（如 `../../../../`）将恶意文件上传到 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。上传的文件可以是 JSP、WAR 或其他可执行格式，从而允许攻击者在服务器上执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的目标服务器。
2.  **构造恶意请求：** 构造一个包含恶意文件的 POST 请求，该文件将被上传到 `/fileupload` 端点。请求的 `Content-Disposition` 头部必须包含目录遍历序列，以便将文件放置在 Web 根目录下的可执行目录中。
3.  **上传恶意文件：** 发送构造的请求到目标服务器。服务器会处理请求并将恶意文件上传到指定目录。
4.  **触发代码执行：** 通过访问上传的恶意文件（例如，通过 Web 浏览器），触发服务器执行其中的代码。

**投毒风险分析：**

提供的漏洞利用代码段（`LICENSE`文件）是 GNU GPL 许可证的文本，不包含任何恶意代码或投毒行为。因此，此代码段本身不存在投毒风险。 但是，如果提供的仓库中包含其他payload.jsp或者war,那么会存在投毒风险.根据现有信息，投毒风险为0%。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2022-29464 漏洞利用的有效性很高，该漏洞被广泛利用，并且已经有公开的PoC利用代码。

**项目地址:** [hxlxmj/Mass-exploit-CVE-2022-29464](https://github.com/hxlxmj/Mass-exploit-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #21

**来源**: [CVE-2022-29464-jimidk_Better-CVE-2022-29464.md](../2022/CVE-2022-29464-jimidk_Better-CVE-2022-29464.md)

# CVE-2022-29464

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-29464-000pp_WSOB.md](../2022/CVE-2022-29464-000pp_WSOB.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器开放fileupload端点，且攻击者可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞存在于多个WSO2产品中，允许未经授权的文件上传，最终导致远程代码执行。

**漏洞利用方式：**

攻击者通过 `/fileupload` 端点，利用 `Content-Disposition` 头部的目录穿越（Path Traversal）序列，将恶意文件上传到Web根目录下的可执行目录，例如 `../../../../repository/deployment/server/webapps`。上传的文件会被服务器解析执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Trend Micro等安全厂商的分析）和提供的POC代码（WSOB工具），该漏洞利用的有效性很高。网上有大量的关于此漏洞的分析文章和漏洞利用案例。

**投毒风险：**

提供的POC代码是一个相对简单的Python脚本，主要功能是利用该漏洞进行文件上传。主要包含以下几个文件:
* `main.py`: 主程序入口，解析参数并启动漏洞利用。
* `src/interface/ui.py`: 定义了用户界面相关的函数，如显示banner。
* `src/wsob/main.py`: 漏洞利用的核心代码。
* `requirements.txt`: 依赖的Python库。

通过分析POC代码，**未发现明显的恶意代码或后门**。代码逻辑相对清晰，主要是发送HTTP请求，构造恶意的文件上传请求，进行目录穿越，实现任意文件上传。

但依旧存在潜在的投毒风险：

1.  **依赖风险：** `requirements.txt` 中列出的依赖库可能存在安全漏洞，攻击者可以通过供应链攻击，篡改这些依赖库，从而植入恶意代码。但是概率较低。
2. **漏洞利用代码本身的缺陷:**  漏洞利用代码中可能包含未知的缺陷或者错误，导致利用失败，或者引发其他安全问题。但是根据目前搜索结果该POC相对比较成熟。

**综合评估，该POC代码存在轻微的投毒风险，大约为5%。**

**项目地址:** [000pp/WSOB](https://github.com/000pp/WSOB)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #2

**来源**: [CVE-2022-29464-Chocapikk_CVE-2022-29464.md](../2022/CVE-2022-29464-Chocapikk_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** Unrestricted File Upload/Remote Code Execution

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的文件上传导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM/KM 1.4.0 to 2.0.0

**利用条件:** 目标服务器存在fileupload endpoint，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 允许未经授权的文件上传，导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 目录遍历序列，将恶意JSP文件上传至Web根目录下的 `repository/deployment/server/webapps` 目录，从而实现RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞是有效的。搜索结果中多个来源确认了该漏洞的存在和利用，并给出了相应的修复建议。漏洞利用代码通过上传JSP webshell来实现远程代码执行。

**投毒风险：**

POC代码中存在一定的投毒风险的可能性，可能性估计为10%。

*   **反弹shell配置：** `reverse_jsp` 中包含硬编码的反弹shell服务器 `8.tcp.ngrok.io:12508`。虽然这可能是为了方便测试，但也可能被用于跟踪或控制利用者的行为。此IP和端口并不一定是恶意的，但是需要使用者额外注意。
*   **公钥上传：**代码中存在上传公钥的部分，用途不明，存在潜在风险。
*   **代码审查：** 漏洞利用代码本身的行为是上传JSP文件，并在目标系统上执行命令。审查发现此代码中无明显恶意逻辑，但是使用者需要进行仔细的代码审查,确认符合预期行为。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本 WSO2 产品的服务器。
2.  **上传恶意文件：** 利用 `/fileupload` 端点，通过构造包含目录遍历的 `Content-Disposition` 请求，上传包含恶意代码的 JSP 文件到服务器的 `/repository/deployment/server/webapps` 目录，例如上传到 `authenticationendpoint` 目录下。
3.  **触发恶意代码：** 访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。POC代码中上传了webshell `balgo.jsp` 和反弹shell `balgorev.jsp`。
4.  **反弹shell接收:** 如果成功利用了反弹shell,需要在相应ip和端口监听,接收反弹shell连接

**项目地址:** [Chocapikk/CVE-2022-29464](https://github.com/Chocapikk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #3

**来源**: [CVE-2022-29464-LinJacck_CVE-2022-29464.md](../2022/CVE-2022-29464-LinJacck_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。

**漏洞分析：**

该漏洞的根本原因是 WSO2 产品中的 `/fileupload` 接口没有对上传的文件进行充分的验证。攻击者可以利用目录遍历漏洞，通过在 `Content-Disposition` 头中构造恶意路径，将恶意文件上传到 Web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。

**利用方式：**

1.  攻击者首先需要确定目标系统存在漏洞，即存在 `/fileupload` 接口且允许上传文件。
2.  攻击者构造一个包含恶意代码的 JSP 文件（或其他服务器支持的脚本文件）。
3.  攻击者构造一个包含目录遍历序列的 HTTP POST 请求，将恶意 JSP 文件上传到目标服务器的 Web 根目录下的 `repository/deployment/server/webapps/authenticationendpoint/` 目录中。文件名可以自定义，但通常以 `.jsp` 结尾，如 ShellDef变量所示。
4.  攻击者通过访问上传的 JSP 文件，即可执行其中的恶意代码，从而获得对服务器的控制权。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用 CVE-2022-29464 漏洞。

*   它首先定义了一个 `exploit` 函数，该函数负责构造包含恶意 JSP 代码的 HTTP POST 请求，并将该请求发送到目标服务器的 `/fileupload` 接口。
*   JSP 代码创建一个简单的 Web shell，允许攻击者通过 Web 界面执行任意系统命令。
*  脚本尝试上传一个名为`404.jsp`的文件用以验证漏洞.如果上传成功,则上传webshell到`/authenticationendpoint`目录下。
*  脚本还允许从外部文件读取webshell的内容并上传,增强了灵活性

**投毒风险评估：**

该 POC 代码本身**没有明显的投毒行为**。代码只是尝试上传 webshell，以便进行远程代码执行。恶意行为完全取决于攻击者上传的 JSP 文件中的内容。因此，该代码的投毒风险较低,可以认为是0。

**有效性：**

根据漏洞描述和 POC 代码的实现，以及搜索引擎返回的结果，该 POC 代码能够有效地利用 CVE-2022-29464 漏洞，实现任意文件上传和远程代码执行。


**项目地址:** [LinJacck/CVE-2022-29464](https://github.com/LinJacck/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #4

**来源**: [CVE-2022-29464-Pasch0_WSO2RCE.md](../2022/CVE-2022-29464-Pasch0_WSO2RCE.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问，目标存在/fileupload接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重的任意文件上传漏洞，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头部的请求，上传恶意文件到 web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。上传的文件可以被当作 JSP 或其他可执行文件解析，从而导致远程代码执行。根据搜索结果，该漏洞已经被广泛利用，并被用于安装 Cobalt Strike beacons 和其他恶意软件。提供的代码片段是 GNU GPL 协议，与漏洞利用本身无关，因此不存在投毒风险。利用方式主要为：

1.  利用 `/fileupload` 接口上传文件。
2.  在 `Content-Disposition` 头中构造目录遍历路径，将文件上传到 webapps 目录下。
3.  上传恶意 JSP 或其他可执行文件。
4.  通过访问上传的文件执行任意代码。

由于该漏洞已经被 CISA 加入已知被利用漏洞目录，建议尽快修复。

**项目地址:** [Pasch0/WSO2RCE](https://github.com/Pasch0/WSO2RCE)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #5

**来源**: [CVE-2022-29464-Pushkarup_CVE-2022-29464.md](../2022/CVE-2022-29464-Pushkarup_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的关键漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  攻击者通过`/fileupload`端点上传恶意文件，通常是包含恶意代码的JSP webshell。
2.  攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）绕过文件上传限制，将webshell上传到Web根目录下的可执行目录，例如`repository/deployment/server/webapps`。
3.  一旦webshell上传成功，攻击者可以通过访问该webshell的URL来执行任意代码。

**有效性评估：**

*   根据漏洞信息、搜索引擎结果和提供的POC代码，此漏洞的利用是有效的。 搜索引擎结果显示，该漏洞已被积极利用（例如TrendMicro报告）。 提供的POC代码（`wso.py` 脚本）旨在自动化利用过程，包括上传webshell并执行命令。

**投毒风险评估：**

该漏洞利用代码主要包含以下几个文件:

*   `LICENSE`：MIT许可证声明，表明代码是开源的，并允许修改和分发。
*   `README.md`：包含漏洞描述、免责声明、利用说明、webshell功能介绍、安装步骤、使用方法、贡献方式、许可协议和联系方式等信息。免责声明明确表示该POC仅用于教育目的，禁止用于非法活动。
*   `wso.py`：此Python脚本包含漏洞利用的核心代码，用于扫描目标站点是否存在漏洞、上传webshell、执行命令等操作。
*   `requirements.txt`：列出了脚本运行所需的Python依赖包，包括requests、colorama和urllib3。

考虑到代码的结构和功能，投毒的潜在风险较低，但仍然存在以下可能性：

1.  **Webshell后门植入**: `wso.py`脚本可能包含额外的后门或恶意代码，虽然webshell本身就是后门，但可能隐藏更深层的控制机制。
2.  **依赖包投毒**: 虽然 `requirements.txt` 文件中的依赖包看起来是标准的，但攻击者可能会使用拼写相似的恶意包来替换它们（例如，将`requests`替换为`requ3sts`）。
3.  **信息收集**: 脚本可能会暗中收集目标系统的信息，并将这些信息发送给攻击者。
4.  **资源消耗**: 脚本可能设计为消耗目标系统的资源，例如CPU或内存，从而导致拒绝服务。

鉴于以上分析，我估计该POC代码存在10%的投毒风险。 这个比例基于以下因素：

*   该POC的主要功能是利用已知的漏洞，目的是方便用户进行测试和验证。
*   POC的作者声明仅用于教育目的。
*   代码开源，方便其他人审查。
*   潜在的风险因素（如webshell后门、依赖包投毒、信息收集和资源消耗）依然存在，需要保持警惕。

**安全建议：**

*   在运行此POC之前，务必在一个隔离的环境中进行。
*   仔细审查代码，特别注意webshell和依赖包。
*   使用网络监控工具来检测任何异常的网络活动。


**项目地址:** [Pushkarup/CVE-2022-29464](https://github.com/Pushkarup/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #6

**来源**: [CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md](../2022/CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码。

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口，且未对上传的文件类型和路径进行严格限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于多个 WSO2 产品中，是一个严重的安全漏洞。攻击者可以利用`/fileupload`接口，通过目录遍历的方式将恶意 JSP 文件上传到 Web 应用的根目录下，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`。上传的 JSP 文件随后可以被 Web 服务器执行，从而导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用方式是有效的，并且已经被广泛利用。
提供的 PoC 代码尝试上传一个名为 `shell.jsp` 的 JSP 文件，该文件包含可以执行系统命令的恶意代码。如果上传成功，攻击者可以通过访问 `http(s)://目标地址/authenticationendpoint/shell.jsp` 来执行任意代码。

**投毒风险：**

PoC 代码中，`/tmp/e2105c9753cc00a9633b2cfd9b6fe351/cve.py` 主要功能是发送恶意请求，上传木马文件，整体代码没有明显的投毒行为。但是，以下几点需要注意：
*   `Files/shell.jsp`: 这是一个后门文件，如果未经审查直接使用，可能会引入未知风险。建议在使用前，仔细检查 `shell.jsp` 的内容，确保其只包含必要的功能，并且没有恶意代码。
*   对 `requirements.txt` 中引入的第三方库也需要进行审核，确保没有引入恶意的依赖。
*   README.md 感谢列表,作者SynixCyberCrimeMY & ?/h4zzzzzz.scc 未知。

因此，投毒风险较低，预估在10%左右。

**利用方式：**

1.  攻击者构造包含目录遍历的恶意请求，利用`/fileupload`接口上传恶意的 JSP 文件 (shell.jsp)。
2.  恶意 JSP 文件被上传到 Web 应用的根目录下。
3.  攻击者通过 Web 浏览器访问上传的 JSP 文件，执行其中的恶意代码。
4.  恶意代码在服务器上执行，允许攻击者执行任意系统命令，从而完全控制受影响的系统。

**防范措施：**

*   升级到 WSO2 官方修复后的版本。
*   实施文件上传白名单策略，仅允许上传必要的文件类型。
*   对上传的文件进行严格的路径验证，防止目录遍历攻击。
*   部署 Web 应用防火墙 (WAF)，检测和阻止恶意的文件上传请求。

**项目地址:** [SynixCyberCrimeMy/CVE-2022-29464](https://github.com/SynixCyberCrimeMy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #7

**来源**: [CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md](../2022/CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标存在/fileupload端点且未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，攻击者可以通过利用/fileupload端点上传任意文件，结合目录遍历将恶意JSP文件写入到webapps目录下，从而实现远程代码执行。该POC脚本首先生成一个随机文件名的JSP webshell，然后通过POST请求将该webshell上传到目标服务器的/fileupload/toolsAny端点。请求头中包含目录遍历(../)序列，用于将文件写入到服务器的webapps目录。上传后，脚本会休眠15秒，然后尝试通过GET请求访问上传的webshell，并执行指定的命令。如果返回状态码为200，则表示webshell执行成功。该POC的利用方式是典型的任意文件上传结合目录遍历实现RCE的漏洞利用方式。

**有效性:**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的，可以利用该漏洞在目标服务器上执行任意代码。

**投毒风险:**
代码没有发现明显的恶意行为或隐藏的后门。所有操作都与漏洞利用相关，例如上传 webshell 和执行命令。该代码的主要目的是为了验证漏洞的存在并进行简单的命令执行，没有检测到任何试图损害用户系统或窃取信息的行为。

**利用方式:**
1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的服务器。
2.  **上传 Webshell：** 使用包含目录遍历的 Content-Disposition 头的 POST 请求，将恶意 JSP 文件上传到`/fileupload/toolsAny`端点。
3.  **远程代码执行：** 通过访问上传的 JSP 文件，传递需要执行的命令作为参数，实现远程代码执行。例如：`{host}/authenticationendpoint/{filename}?cmd={command}`


**项目地址:** [SystemVll/CVE-2022-29464-loader](https://github.com/SystemVll/CVE-2022-29464-loader)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #8

**来源**: [CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md](../2022/CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传漏洞

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 - 4.0.0, WSO2 Identity Server 5.2.0 - 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 - 5.11.0, WSO2 Enterprise Integrator 6.2.0 - 6.6.0, WSO2 Open Banking AM 1.4.0 - 2.0.0, WSO2 Open Banking KM 1.4.0 - 2.0.0

**利用条件:** 需要网络访问，目标存在 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。漏洞的根源在于 /fileupload 接口缺乏适当的文件类型验证，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头，将恶意文件上传到 Web 根目录下的可执行位置，例如 repository/deployment/server/webapps 目录。上传的文件可以是 JSP 文件或其他服务器支持的脚本类型。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 WSO2 产品的服务器。
2.  **构造恶意请求：**  构造一个包含恶意文件的 HTTP POST 请求，该请求发送到 /fileupload 接口。Content-Disposition 头必须包含目录遍历序列，以将文件上传到 Web 根目录下的指定位置。
3.  **上传文件：**  将构造的请求发送到目标服务器。
4.  **执行代码：**  通过访问上传的文件来触发恶意代码的执行。例如，如果上传的是 JSP 文件，则可以通过 Web 浏览器访问该文件来执行其中的代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源都证实了该漏洞的存在和利用方式，并且提供了可用的 POC 代码。

**投毒风险：**

提供的 POC 代码（wso.py）主要功能是利用漏洞进行文件上传和远程代码执行。代码包含以下部分：

*   **请求库 (requests)：**  用于发送 HTTP 请求。
*   **目录创建 (os.mkdir)：**  用于创建结果目录。
*   **命令行清除 (os.system)：**  用于清除屏幕。
*   **Banner 打印：** 用于打印作者信息及免责声明

虽然没有明显的恶意代码，但仍存在一些潜在的风险：

*   **依赖项风险：** requirements.txt 文件中列出的依赖项（requests, urllib3, colorama）本身可能存在漏洞。如果这些依赖项被篡改或包含恶意代码，则可能导致安全问题。
*   **编码风险：** 代码没有对用户输入进行严格的验证，可能存在潜在的代码注入风险。例如，如果目标 URL 可控，攻击者可能会注入恶意代码。
*   **免责声明：** 作者的免责声明也暗示了使用该工具可能存在的风险，虽然正常的漏洞利用工具都有免责声明，但是也暗示此工具有一定的风险。

综上所述，该仓库存在较低的投毒风险，约为 10%。主要风险来自于依赖项和编码风险，需要仔细审查代码和依赖项，确保安全性。


**项目地址:** [ThatNotEasy/CVE-2022-29464](https://github.com/ThatNotEasy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #9

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #10

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 到 4.0.0, WSO2 Identity Server 5.2.0 到 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 和 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 到 5.11.0, WSO2 Enterprise Integrator 6.2.0 到 6.6.0, WSO2 Open Banking AM 1.4.0 到 2.0.0 和 WSO2 Open Banking KM 1.4.0, 到 2.0.0

**利用条件:** 需要网络访问目标 WSO2 实例，利用 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而实现远程代码执行。该漏洞的核心在于 `/fileupload` 端点未进行严格的身份验证和文件类型限制。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：**  WSO2 产品中的 `/fileupload` 端点允许未经身份验证的文件上传。`FileUploadServlet` 处理该请求，并根据 `carbon.xml` 配置文件加载的文件上传执行器处理上传的文件。由于未进行充分的验证，攻击者可以上传恶意文件。
2.  **利用步骤：**
    *   攻击者发送包含恶意 JSP 代码的 HTTP POST 请求到 `/fileupload` 端点。
    *   请求的 `Content-Disposition` 头包含目录遍历序列 (例如 `../../../../repository/deployment/server/webapps`)，用于将文件上传到 Web 根目录下的可执行目录。
    *   上传的 JSP 文件会被 WSO2 服务器执行，从而允许攻击者执行任意代码。
3.  **有效性评估：** 漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是可利用的，并且已经有公开的 PoC 代码存在。
4.  **投毒风险评估：**  漏洞利用代码的仓库中可能存在投毒的风险。虽然主要的利用方式是利用已知的漏洞，但仓库中可能会包含一些隐藏的、不明显的功能或代码，这些代码可能用于收集信息、植入后门或执行其他恶意活动。因此，对代码的审计是必要的，且投毒风险存在，约为 10%。风险主要来自于：
    *   **非必要的辅助脚本：** 仓库中可能包含一些非漏洞利用必需的脚本，例如用于扫描或配置的脚本，这些脚本可能包含恶意代码。
    *   **混淆的代码：**  某些代码可能经过混淆，使得难以分析其真实行为。
    *   **供应链攻击：**  仓库可能依赖于外部的库或组件，这些库或组件可能被恶意篡改。
    *   **社会工程：**  攻击者可能通过提交看似无害的 Pull Request 来引入恶意代码。
5.  **缓解措施：**
    *   升级到已修复漏洞的 WSO2 产品版本。
    *   实施严格的文件上传验证机制，包括身份验证、文件类型检查和大小限制。
    *   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
    *   定期进行安全审计和漏洞扫描。

**项目地址:** [amit-pathak009/CVE-2022-29464](https://github.com/amit-pathak009/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #11

**来源**: [CVE-2022-29464-axin2019_CVE-2022-29464.md](../2022/CVE-2022-29464-axin2019_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要目标服务器开放web端口且服务未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是WSO2产品中的一个严重漏洞，允许未经授权的文件上传，从而导致远程代码执行。攻击者通过向 `/fileupload` 端点发送包含目录遍历序列 `../../../../repository/deployment/server/webapps` 的 `Content-Disposition` 头部的恶意请求，绕过文件上传限制，将恶意JSP文件上传到web根目录下。  

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造一个`multipart/form-data`类型的POST请求，其中包含恶意JSP代码。请求的`Content-Disposition`头部使用目录遍历，将文件上传到目标web应用的`/repository/deployment/server/webapps`目录下的一个可访问的路径，如`authenticationendpoint`。
2.  **绕过上传限制：** 由于漏洞存在于文件上传的路径验证环节，攻击者可以利用目录遍历绕过服务器的文件类型和大小限制。
3.  **远程代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件，执行任意系统命令。
4.  **POC代码分析：**  提供的Python POC脚本模拟了上述攻击流程。脚本首先尝试访问目标URL，然后发送包含JSP后门的`multipart/form-data`请求到`/fileupload/toolsAny`，通过目录遍历将JSP文件上传到`authenticationendpoint`目录下。最后，脚本通过访问上传的JSP文件，执行`whoami`命令来验证漏洞是否存在。脚本中使用了两个不同的请求头`headers1`和`headers2`，针对目标进行尝试，提高了漏洞利用成功率。

**有效性评估：**

根据漏洞描述和POC代码，此漏洞利用方法有效，因为成功上传JSP文件即可执行任意命令。

**投毒风险评估：**

POC代码本身包含了一个用于远程代码执行的JSP后门，但这不是作者植入的恶意代码，而是漏洞利用的必要组成部分。代码中存在轻微的投毒风险（约10%），因为用户在复制和粘贴POC代码时，可能会无意中引入其他潜在的恶意代码或依赖项，但主要的风险在于漏洞本身，而不是POC代码的作者植入恶意代码。

**项目地址:** [axin2019/CVE-2022-29464](https://github.com/axin2019/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #12

**来源**: [CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md](../2022/CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM 等

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在漏洞并且可以通过网络访问 /fileupload 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 接口上传任意文件，通过目录穿越将文件写入到webapps目录下，从而导致远程代码执行。

**有效性分析：**

提供的POC代码利用了该漏洞。代码通过构造一个包含恶意JSP代码的文件，并使用目录穿越的方式将其上传到目标服务器的 `repository/deployment/server/webapps/authenticationendpoint/` 目录下。上传成功后，攻击者可以通过访问上传的JSP文件来执行任意命令。
根据搜索结果显示，该漏洞已经被广泛利用，证明POC的有效性。

**投毒风险分析：**

代码本身的功能是实现漏洞利用，上传并执行JSP后门。其中恶意行为是利用漏洞本身，而非代码作者额外添加的恶意功能。代码的危害在于利用漏洞，代码本身较为直白。
尽管如此，仍然存在微小的投毒风险，例如作者可能在代码中加入隐蔽的回连等恶意功能，但可能性较低，评估为5%。

**利用方式：**

1.  **确定目标：** 确定存在CVE-2022-29464漏洞的WSO2产品实例。
2.  **构造恶意JSP文件：** POC代码中已经包含了一个简单的JSP Shell，可以执行命令。攻击者可以根据需要修改JSP代码，实现更复杂的功能。
3.  **利用POC上传文件：** 使用POC代码，指定目标服务器地址和JSP文件名，将恶意JSP文件上传到目标服务器。
    *   `-f`：指定包含目标列表的文件。每一行包含一个目标地址，格式为 `HOST:PORT` 或 `IP:PORT`。
    *   `-t`：指定单个目标地址，格式同上。
    *   `-j`：指定要上传的JSP文件名。
4.  **执行命令：** 访问上传的JSP文件，通过URL参数传递要执行的命令。

例如，如果JSP文件名为 `shell.jsp`，则可以通过访问 `https://target/authenticationendpoint/shell.jsp?cmd=whoami` 来执行 `whoami` 命令。


**项目地址:** [c1ph3rbyt3/CVE-2022-29464](https://github.com/c1ph3rbyt3/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #13

**来源**: [CVE-2022-29464-cc3305_CVE-2022-29464.md](../2022/CVE-2022-29464-cc3305_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。搜索引擎结果表明该漏洞已被积极利用，存在公开可用的PoC，并且厂商建议用户立即更新或采取临时缓解措施。

**投毒风险：**

该PoC代码主要通过文件上传功能将恶意的JSP文件上传到目标服务器的webapps目录下。直接观察代码，存在投毒的可能性较低，例如作者可能嵌入反向shell或其他恶意功能，但并未发现明显的恶意行为。但仍需要对该脚本依赖的库，以及脚本的作者进行信誉评估。同时代码使用`force`参数绕过版本检测，如果目标事实上不存在漏洞，可能会因为尝试上传恶意文件导致服务不稳定。综合评估，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者使用 `/fileupload` 端点，通过 `Content-Disposition` 中的目录遍历序列（例如 `../../../../`）将文件上传到 Web 根目录下的目录，如 `repository/deployment/server/webapps`。
2.  **文件上传：** 攻击者上传包含恶意代码的 JSP 文件（或其他 Web Shell），例如本例中，poc脚本构造一个jsp_shell，命令执行的命令通过参数传入，更加灵活。
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件触发恶意代码的执行，从而在服务器上执行任意命令。

总而言之，该漏洞利用方式是通过精心构造的HTTP请求，利用WSO2文件上传接口的目录遍历漏洞，上传恶意JSP文件，最终导致远程代码执行。

**项目地址:** [cc3305/CVE-2022-29464](https://github.com/cc3305/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #14

**来源**: [CVE-2022-29464-devengpk_CVE-2022-29464.md](../2022/CVE-2022-29464-devengpk_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，允许未经身份验证的攻击者上传恶意文件并在服务器上执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要目标WSO2服务器实例可以通过网络访问，并且存在/fileupload端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于 WSO2 产品中，允许未经授权的文件上传，最终导致远程代码执行。攻击者可以利用 `/fileupload` 端点，通过 `Content-Disposition` 头部进行目录遍历，将恶意 JSP 文件上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录等位置。由于 `/fileupload` 路由未受到身份验证的保护，攻击者无需登录即可利用此漏洞。

**利用方式：**
1.  攻击者构造包含恶意 JSP 代码的文件。
2.  攻击者向 `/fileupload` 端点发送包含 `Content-Disposition` 头部，进行目录遍历的 HTTP 请求，将恶意 JSP 文件上传到服务器的 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。
3.  服务器处理上传请求，并将恶意 JSP 文件写入目标目录。
4.  攻击者通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码执行，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞利用代码有效。

**投毒风险：**
虽然提供的代码主要描述了漏洞原理，但代码中仍存在小概率潜在的投毒风险。作者可能会在利用代码中添加一些难以察觉的恶意代码，例如反弹 shell 或植入后门等。因此，在使用此类代码时，需要谨慎审查，确保其安全性。初步估计投毒风险为10%。

**项目地址:** [devengpk/CVE-2022-29464](https://github.com/devengpk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #15

**来源**: [CVE-2022-29464-g0dxing_CVE-2022-29464.md](../2022/CVE-2022-29464-g0dxing_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 `/fileupload` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 端点上传任意文件，通过目录穿越将恶意JSP文件上传到webapps目录下，从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。多个来源都确认了该漏洞的存在和可利用性，并且存在公开的PoC。

**投毒风险：**
PoC 代码本身主要功能是上传 webshell，但是`reverse_jsp`使用了硬编码的`8.tcp.ngrok.io:12508`，存在潜在的风险，如果攻击者修改了这个reverse shell 的地址，有可能反弹shell到攻击者的机器上。虽然`public_key`变量存在，但是代码没有使用，所以可以排除钓鱼风险，综上判断，存在5%的投毒风险。

**利用方式：**
1.  攻击者使用带有目录穿越的 `Content-Disposition` 头构造恶意的POST请求到 `/fileupload` 端点。
2.  请求中包含要上传的恶意JSP文件，目标路径指向Web根目录下的一个可执行JSP的目录，例如 `repository/deployment/server/webapps`。
3.  服务器接收到请求后，由于未对上传的文件类型和目标路径进行充分验证，会将恶意JSP文件写入到指定目录。
4.  攻击者可以通过访问上传的JSP文件，执行其中的恶意代码，实现远程代码执行。

**项目地址:** [g0dxing/CVE-2022-29464](https://github.com/g0dxing/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #16

**来源**: [CVE-2022-29464-gbrsh_CVE-2022-29464.md](../2022/CVE-2022-29464-gbrsh_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传 / 远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权的攻击者上传恶意文件并执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标WSO2服务器存在/fileupload endpoint且未进行适当的路径限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的高危漏洞，允许未经身份验证的攻击者通过`/fileupload`端点上传任意文件，从而导致远程代码执行。攻击者利用路径遍历漏洞将恶意JSP文件上传到webapps目录下，例如`../../../../repository/deployment/server/webapps/authenticationendpoint/evil.jsp`。上传成功后，攻击者可以通过访问该JSP文件来执行任意系统命令。提供的POC代码通过构造包含恶意JSP代码的文件上传请求，利用该漏洞。代码首先上传一个包含命令执行功能的JSP文件，然后通过发送带有`cmd`参数的GET请求来执行系统命令。代码中未发现任何隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低。

**漏洞利用方式：**

1.  **文件上传：** 攻击者向目标WSO2服务器的`/fileupload`端点发送POST请求，上传包含恶意JSP代码的文件。Content-Disposition头包含路径遍历序列，将文件上传到webapps目录下。
2.  **代码执行：** 攻击者通过访问上传的JSP文件（例如`/authenticationendpoint/evil.jsp?cmd=whoami`）来执行任意系统命令。服务器执行JSP代码，并将命令执行结果返回给攻击者。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。利用成功与否取决于目标系统是否存在漏洞，是否打补丁，以及是否配置正确。

**搜索引擎结果：**

搜索结果表明，CVE-2022-29464是一个已被广泛利用的漏洞，多个安全厂商发布了关于该漏洞的分析报告和修复建议。有报告指出，该漏洞已被用于安装Cobalt Strike beacons和其他恶意软件。


**项目地址:** [gbrsh/CVE-2022-29464](https://github.com/gbrsh/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #17

**来源**: [CVE-2022-29464-hakivvi_CVE-2022-29464.md](../2022/CVE-2022-29464-hakivvi_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问到WSO2服务器的/fileupload端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞是一个存在于多个WSO2产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要是漏洞原理的分析和描述，并未发现直接的恶意代码。然而，任何公开的漏洞利用代码都存在被修改并植入恶意代码的风险。例如，攻击者可能修改POC，在成功上传JSP后，执行额外的恶意操作，例如下载并执行其他恶意程序。POC中直接包含恶意JSP的可能性较低，但后续利用上传的JSP进行投毒的可能性较高。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞位置：** 受影响的WSO2产品存在`/fileupload`端点，该端点允许未授权的文件上传。
2.  **路径穿越：** 攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）将上传的文件写入到Web根目录下的特定位置，如`repository/deployment/server/webapps`。
3.  **上传恶意文件：** 攻击者上传包含恶意代码的JSP文件。
4.  **远程代码执行：**  一旦恶意JSP文件被上传到Web根目录，攻击者可以通过访问该JSP文件来执行服务器上的任意代码。

**项目地址:** [hakivvi/CVE-2022-29464](https://github.com/hakivvi/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #18

**来源**: [CVE-2022-29464-hev0x_CVE-2022-29464.md](../2022/CVE-2022-29464-hev0x_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问，目标存在/fileupload端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的任意文件上传漏洞，允许未经授权的攻击者上传恶意文件并执行远程代码。根据漏洞信息和搜索结果，此漏洞利用涉及利用 `/fileupload` 端点，并使用 `Content-Disposition` 头部中的目录遍历序列将文件上传到 Web 根目录下的可访问位置，例如 `../../../../repository/deployment/server/webapps` 目录。POC 代码的工作原理如下：

1.  **定位目标：** 脚本接收包含目标 URL 的文件作为输入。
2.  **构造恶意请求：** 脚本构造一个 POST 请求，使用 `/fileupload/toolsAny` 端点，并在 `files` 参数中包含一个指向恶意 JSP 文件的映射。JSP 文件的内容是一个简单的 WebShell，允许执行任意命令。
3.  **目录遍历：** 脚本使用目录遍历序列 (例如 `../../../../`) 将 JSP 文件上传到 `repository/deployment/server/webapps/authenticationendpoint/megas.jsp` 路径下。 `authenticationendpoint` 是一个常见的 Web 应用目录，`megas.jsp` 是上传的 webshell 文件名。
4.  **执行代码：** 脚本通过访问上传的 JSP WebShell (例如 `/authenticationendpoint/megas.jsp?cmd=id`) 来执行命令。脚本首先尝试执行 `id` 命令以验证漏洞是否成功利用。
5.  **验证与输出：** 如果 `id` 命令执行成功并且返回了 `uid` 信息，脚本会认为目标存在漏洞，并将结果输出到屏幕和文件中。

**投毒风险分析：**

我分析了提供的 POC 代码。该代码的主要功能是利用目录遍历和文件上传漏洞在目标系统上部署一个 webshell，然后通过 webshell 执行系统命令。代码没有发现任何隐藏的、与漏洞利用无关的功能，例如收集用户信息、传播恶意软件或篡改系统配置等。因此，该 POC 代码的投毒风险评估为 0%。

**总结：**

该漏洞利用代码有效，因为它能够利用文件上传漏洞在目标系统上部署和执行恶意代码，从而实现远程代码执行。利用方式清晰，无需身份验证。由于代码只包含漏洞利用逻辑，因此不存在投毒风险。

**项目地址:** [hev0x/CVE-2022-29464](https://github.com/hev0x/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #19

**来源**: [CVE-2022-29464-hupe1980_CVE-2022-29464.md](../2022/CVE-2022-29464-hupe1980_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的高危漏洞，它允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，最终导致远程代码执行。该漏洞的利用方式是通过构造包含目录穿越序列的 `Content-Disposition` 头，将恶意 JSP 文件上传到 Web 根目录下的可访问位置，如 `repository/deployment/server/webapps` 目录。上传的 JSP 文件包含执行任意命令的代码。根据提供的漏洞利用代码 `exploit.py`，该脚本通过 POST 请求向目标服务器的 `/fileupload/toolsAny` 端点上传一个包含恶意代码的 JSP 文件。攻击者可以通过访问上传的 JSP 文件来执行任意命令。例如，脚本会将包含一个表单的 JSP shell 上传到 `/authenticationendpoint` 应用目录下。 该代码看起来是直接利用漏洞，没有发现隐藏的恶意代码或者后门，所以投毒风险评估为0%。 搜索引擎结果也表明该漏洞已被广泛利用，并建议用户尽快更新或采取缓解措施。

**项目地址:** [hupe1980/CVE-2022-29464](https://github.com/hupe1980/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #20

**来源**: [CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md](../2022/CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行，系统完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经授权的文件上传，并最终导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 头部中的目录遍历序列（如 `../../../../`）将恶意文件上传到 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。上传的文件可以是 JSP、WAR 或其他可执行格式，从而允许攻击者在服务器上执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的目标服务器。
2.  **构造恶意请求：** 构造一个包含恶意文件的 POST 请求，该文件将被上传到 `/fileupload` 端点。请求的 `Content-Disposition` 头部必须包含目录遍历序列，以便将文件放置在 Web 根目录下的可执行目录中。
3.  **上传恶意文件：** 发送构造的请求到目标服务器。服务器会处理请求并将恶意文件上传到指定目录。
4.  **触发代码执行：** 通过访问上传的恶意文件（例如，通过 Web 浏览器），触发服务器执行其中的代码。

**投毒风险分析：**

提供的漏洞利用代码段（`LICENSE`文件）是 GNU GPL 许可证的文本，不包含任何恶意代码或投毒行为。因此，此代码段本身不存在投毒风险。 但是，如果提供的仓库中包含其他payload.jsp或者war,那么会存在投毒风险.根据现有信息，投毒风险为0%。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2022-29464 漏洞利用的有效性很高，该漏洞被广泛利用，并且已经有公开的PoC利用代码。

**项目地址:** [hxlxmj/Mass-exploit-CVE-2022-29464](https://github.com/hxlxmj/Mass-exploit-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #21

**来源**: [CVE-2022-29464-jimidk_Better-CVE-2022-29464.md](../2022/CVE-2022-29464-jimidk_Better-CVE-2022-29464.md)

# CVE-2022-29464

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-29464-000pp_WSOB.md](../2022/CVE-2022-29464-000pp_WSOB.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器开放fileupload端点，且攻击者可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞存在于多个WSO2产品中，允许未经授权的文件上传，最终导致远程代码执行。

**漏洞利用方式：**

攻击者通过 `/fileupload` 端点，利用 `Content-Disposition` 头部的目录穿越（Path Traversal）序列，将恶意文件上传到Web根目录下的可执行目录，例如 `../../../../repository/deployment/server/webapps`。上传的文件会被服务器解析执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Trend Micro等安全厂商的分析）和提供的POC代码（WSOB工具），该漏洞利用的有效性很高。网上有大量的关于此漏洞的分析文章和漏洞利用案例。

**投毒风险：**

提供的POC代码是一个相对简单的Python脚本，主要功能是利用该漏洞进行文件上传。主要包含以下几个文件:
* `main.py`: 主程序入口，解析参数并启动漏洞利用。
* `src/interface/ui.py`: 定义了用户界面相关的函数，如显示banner。
* `src/wsob/main.py`: 漏洞利用的核心代码。
* `requirements.txt`: 依赖的Python库。

通过分析POC代码，**未发现明显的恶意代码或后门**。代码逻辑相对清晰，主要是发送HTTP请求，构造恶意的文件上传请求，进行目录穿越，实现任意文件上传。

但依旧存在潜在的投毒风险：

1.  **依赖风险：** `requirements.txt` 中列出的依赖库可能存在安全漏洞，攻击者可以通过供应链攻击，篡改这些依赖库，从而植入恶意代码。但是概率较低。
2. **漏洞利用代码本身的缺陷:**  漏洞利用代码中可能包含未知的缺陷或者错误，导致利用失败，或者引发其他安全问题。但是根据目前搜索结果该POC相对比较成熟。

**综合评估，该POC代码存在轻微的投毒风险，大约为5%。**

**项目地址:** [000pp/WSOB](https://github.com/000pp/WSOB)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #2

**来源**: [CVE-2022-29464-Chocapikk_CVE-2022-29464.md](../2022/CVE-2022-29464-Chocapikk_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** Unrestricted File Upload/Remote Code Execution

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的文件上传导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM/KM 1.4.0 to 2.0.0

**利用条件:** 目标服务器存在fileupload endpoint，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 允许未经授权的文件上传，导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 目录遍历序列，将恶意JSP文件上传至Web根目录下的 `repository/deployment/server/webapps` 目录，从而实现RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞是有效的。搜索结果中多个来源确认了该漏洞的存在和利用，并给出了相应的修复建议。漏洞利用代码通过上传JSP webshell来实现远程代码执行。

**投毒风险：**

POC代码中存在一定的投毒风险的可能性，可能性估计为10%。

*   **反弹shell配置：** `reverse_jsp` 中包含硬编码的反弹shell服务器 `8.tcp.ngrok.io:12508`。虽然这可能是为了方便测试，但也可能被用于跟踪或控制利用者的行为。此IP和端口并不一定是恶意的，但是需要使用者额外注意。
*   **公钥上传：**代码中存在上传公钥的部分，用途不明，存在潜在风险。
*   **代码审查：** 漏洞利用代码本身的行为是上传JSP文件，并在目标系统上执行命令。审查发现此代码中无明显恶意逻辑，但是使用者需要进行仔细的代码审查,确认符合预期行为。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本 WSO2 产品的服务器。
2.  **上传恶意文件：** 利用 `/fileupload` 端点，通过构造包含目录遍历的 `Content-Disposition` 请求，上传包含恶意代码的 JSP 文件到服务器的 `/repository/deployment/server/webapps` 目录，例如上传到 `authenticationendpoint` 目录下。
3.  **触发恶意代码：** 访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。POC代码中上传了webshell `balgo.jsp` 和反弹shell `balgorev.jsp`。
4.  **反弹shell接收:** 如果成功利用了反弹shell,需要在相应ip和端口监听,接收反弹shell连接

**项目地址:** [Chocapikk/CVE-2022-29464](https://github.com/Chocapikk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #3

**来源**: [CVE-2022-29464-LinJacck_CVE-2022-29464.md](../2022/CVE-2022-29464-LinJacck_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。

**漏洞分析：**

该漏洞的根本原因是 WSO2 产品中的 `/fileupload` 接口没有对上传的文件进行充分的验证。攻击者可以利用目录遍历漏洞，通过在 `Content-Disposition` 头中构造恶意路径，将恶意文件上传到 Web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。

**利用方式：**

1.  攻击者首先需要确定目标系统存在漏洞，即存在 `/fileupload` 接口且允许上传文件。
2.  攻击者构造一个包含恶意代码的 JSP 文件（或其他服务器支持的脚本文件）。
3.  攻击者构造一个包含目录遍历序列的 HTTP POST 请求，将恶意 JSP 文件上传到目标服务器的 Web 根目录下的 `repository/deployment/server/webapps/authenticationendpoint/` 目录中。文件名可以自定义，但通常以 `.jsp` 结尾，如 ShellDef变量所示。
4.  攻击者通过访问上传的 JSP 文件，即可执行其中的恶意代码，从而获得对服务器的控制权。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用 CVE-2022-29464 漏洞。

*   它首先定义了一个 `exploit` 函数，该函数负责构造包含恶意 JSP 代码的 HTTP POST 请求，并将该请求发送到目标服务器的 `/fileupload` 接口。
*   JSP 代码创建一个简单的 Web shell，允许攻击者通过 Web 界面执行任意系统命令。
*  脚本尝试上传一个名为`404.jsp`的文件用以验证漏洞.如果上传成功,则上传webshell到`/authenticationendpoint`目录下。
*  脚本还允许从外部文件读取webshell的内容并上传,增强了灵活性

**投毒风险评估：**

该 POC 代码本身**没有明显的投毒行为**。代码只是尝试上传 webshell，以便进行远程代码执行。恶意行为完全取决于攻击者上传的 JSP 文件中的内容。因此，该代码的投毒风险较低,可以认为是0。

**有效性：**

根据漏洞描述和 POC 代码的实现，以及搜索引擎返回的结果，该 POC 代码能够有效地利用 CVE-2022-29464 漏洞，实现任意文件上传和远程代码执行。


**项目地址:** [LinJacck/CVE-2022-29464](https://github.com/LinJacck/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #4

**来源**: [CVE-2022-29464-Pasch0_WSO2RCE.md](../2022/CVE-2022-29464-Pasch0_WSO2RCE.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问，目标存在/fileupload接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重的任意文件上传漏洞，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头部的请求，上传恶意文件到 web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。上传的文件可以被当作 JSP 或其他可执行文件解析，从而导致远程代码执行。根据搜索结果，该漏洞已经被广泛利用，并被用于安装 Cobalt Strike beacons 和其他恶意软件。提供的代码片段是 GNU GPL 协议，与漏洞利用本身无关，因此不存在投毒风险。利用方式主要为：

1.  利用 `/fileupload` 接口上传文件。
2.  在 `Content-Disposition` 头中构造目录遍历路径，将文件上传到 webapps 目录下。
3.  上传恶意 JSP 或其他可执行文件。
4.  通过访问上传的文件执行任意代码。

由于该漏洞已经被 CISA 加入已知被利用漏洞目录，建议尽快修复。

**项目地址:** [Pasch0/WSO2RCE](https://github.com/Pasch0/WSO2RCE)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #5

**来源**: [CVE-2022-29464-Pushkarup_CVE-2022-29464.md](../2022/CVE-2022-29464-Pushkarup_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的关键漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  攻击者通过`/fileupload`端点上传恶意文件，通常是包含恶意代码的JSP webshell。
2.  攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）绕过文件上传限制，将webshell上传到Web根目录下的可执行目录，例如`repository/deployment/server/webapps`。
3.  一旦webshell上传成功，攻击者可以通过访问该webshell的URL来执行任意代码。

**有效性评估：**

*   根据漏洞信息、搜索引擎结果和提供的POC代码，此漏洞的利用是有效的。 搜索引擎结果显示，该漏洞已被积极利用（例如TrendMicro报告）。 提供的POC代码（`wso.py` 脚本）旨在自动化利用过程，包括上传webshell并执行命令。

**投毒风险评估：**

该漏洞利用代码主要包含以下几个文件:

*   `LICENSE`：MIT许可证声明，表明代码是开源的，并允许修改和分发。
*   `README.md`：包含漏洞描述、免责声明、利用说明、webshell功能介绍、安装步骤、使用方法、贡献方式、许可协议和联系方式等信息。免责声明明确表示该POC仅用于教育目的，禁止用于非法活动。
*   `wso.py`：此Python脚本包含漏洞利用的核心代码，用于扫描目标站点是否存在漏洞、上传webshell、执行命令等操作。
*   `requirements.txt`：列出了脚本运行所需的Python依赖包，包括requests、colorama和urllib3。

考虑到代码的结构和功能，投毒的潜在风险较低，但仍然存在以下可能性：

1.  **Webshell后门植入**: `wso.py`脚本可能包含额外的后门或恶意代码，虽然webshell本身就是后门，但可能隐藏更深层的控制机制。
2.  **依赖包投毒**: 虽然 `requirements.txt` 文件中的依赖包看起来是标准的，但攻击者可能会使用拼写相似的恶意包来替换它们（例如，将`requests`替换为`requ3sts`）。
3.  **信息收集**: 脚本可能会暗中收集目标系统的信息，并将这些信息发送给攻击者。
4.  **资源消耗**: 脚本可能设计为消耗目标系统的资源，例如CPU或内存，从而导致拒绝服务。

鉴于以上分析，我估计该POC代码存在10%的投毒风险。 这个比例基于以下因素：

*   该POC的主要功能是利用已知的漏洞，目的是方便用户进行测试和验证。
*   POC的作者声明仅用于教育目的。
*   代码开源，方便其他人审查。
*   潜在的风险因素（如webshell后门、依赖包投毒、信息收集和资源消耗）依然存在，需要保持警惕。

**安全建议：**

*   在运行此POC之前，务必在一个隔离的环境中进行。
*   仔细审查代码，特别注意webshell和依赖包。
*   使用网络监控工具来检测任何异常的网络活动。


**项目地址:** [Pushkarup/CVE-2022-29464](https://github.com/Pushkarup/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #6

**来源**: [CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md](../2022/CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码。

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口，且未对上传的文件类型和路径进行严格限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于多个 WSO2 产品中，是一个严重的安全漏洞。攻击者可以利用`/fileupload`接口，通过目录遍历的方式将恶意 JSP 文件上传到 Web 应用的根目录下，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`。上传的 JSP 文件随后可以被 Web 服务器执行，从而导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用方式是有效的，并且已经被广泛利用。
提供的 PoC 代码尝试上传一个名为 `shell.jsp` 的 JSP 文件，该文件包含可以执行系统命令的恶意代码。如果上传成功，攻击者可以通过访问 `http(s)://目标地址/authenticationendpoint/shell.jsp` 来执行任意代码。

**投毒风险：**

PoC 代码中，`/tmp/e2105c9753cc00a9633b2cfd9b6fe351/cve.py` 主要功能是发送恶意请求，上传木马文件，整体代码没有明显的投毒行为。但是，以下几点需要注意：
*   `Files/shell.jsp`: 这是一个后门文件，如果未经审查直接使用，可能会引入未知风险。建议在使用前，仔细检查 `shell.jsp` 的内容，确保其只包含必要的功能，并且没有恶意代码。
*   对 `requirements.txt` 中引入的第三方库也需要进行审核，确保没有引入恶意的依赖。
*   README.md 感谢列表,作者SynixCyberCrimeMY & ?/h4zzzzzz.scc 未知。

因此，投毒风险较低，预估在10%左右。

**利用方式：**

1.  攻击者构造包含目录遍历的恶意请求，利用`/fileupload`接口上传恶意的 JSP 文件 (shell.jsp)。
2.  恶意 JSP 文件被上传到 Web 应用的根目录下。
3.  攻击者通过 Web 浏览器访问上传的 JSP 文件，执行其中的恶意代码。
4.  恶意代码在服务器上执行，允许攻击者执行任意系统命令，从而完全控制受影响的系统。

**防范措施：**

*   升级到 WSO2 官方修复后的版本。
*   实施文件上传白名单策略，仅允许上传必要的文件类型。
*   对上传的文件进行严格的路径验证，防止目录遍历攻击。
*   部署 Web 应用防火墙 (WAF)，检测和阻止恶意的文件上传请求。

**项目地址:** [SynixCyberCrimeMy/CVE-2022-29464](https://github.com/SynixCyberCrimeMy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #7

**来源**: [CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md](../2022/CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标存在/fileupload端点且未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，攻击者可以通过利用/fileupload端点上传任意文件，结合目录遍历将恶意JSP文件写入到webapps目录下，从而实现远程代码执行。该POC脚本首先生成一个随机文件名的JSP webshell，然后通过POST请求将该webshell上传到目标服务器的/fileupload/toolsAny端点。请求头中包含目录遍历(../)序列，用于将文件写入到服务器的webapps目录。上传后，脚本会休眠15秒，然后尝试通过GET请求访问上传的webshell，并执行指定的命令。如果返回状态码为200，则表示webshell执行成功。该POC的利用方式是典型的任意文件上传结合目录遍历实现RCE的漏洞利用方式。

**有效性:**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的，可以利用该漏洞在目标服务器上执行任意代码。

**投毒风险:**
代码没有发现明显的恶意行为或隐藏的后门。所有操作都与漏洞利用相关，例如上传 webshell 和执行命令。该代码的主要目的是为了验证漏洞的存在并进行简单的命令执行，没有检测到任何试图损害用户系统或窃取信息的行为。

**利用方式:**
1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的服务器。
2.  **上传 Webshell：** 使用包含目录遍历的 Content-Disposition 头的 POST 请求，将恶意 JSP 文件上传到`/fileupload/toolsAny`端点。
3.  **远程代码执行：** 通过访问上传的 JSP 文件，传递需要执行的命令作为参数，实现远程代码执行。例如：`{host}/authenticationendpoint/{filename}?cmd={command}`


**项目地址:** [SystemVll/CVE-2022-29464-loader](https://github.com/SystemVll/CVE-2022-29464-loader)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #8

**来源**: [CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md](../2022/CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传漏洞

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 - 4.0.0, WSO2 Identity Server 5.2.0 - 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 - 5.11.0, WSO2 Enterprise Integrator 6.2.0 - 6.6.0, WSO2 Open Banking AM 1.4.0 - 2.0.0, WSO2 Open Banking KM 1.4.0 - 2.0.0

**利用条件:** 需要网络访问，目标存在 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。漏洞的根源在于 /fileupload 接口缺乏适当的文件类型验证，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头，将恶意文件上传到 Web 根目录下的可执行位置，例如 repository/deployment/server/webapps 目录。上传的文件可以是 JSP 文件或其他服务器支持的脚本类型。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 WSO2 产品的服务器。
2.  **构造恶意请求：**  构造一个包含恶意文件的 HTTP POST 请求，该请求发送到 /fileupload 接口。Content-Disposition 头必须包含目录遍历序列，以将文件上传到 Web 根目录下的指定位置。
3.  **上传文件：**  将构造的请求发送到目标服务器。
4.  **执行代码：**  通过访问上传的文件来触发恶意代码的执行。例如，如果上传的是 JSP 文件，则可以通过 Web 浏览器访问该文件来执行其中的代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源都证实了该漏洞的存在和利用方式，并且提供了可用的 POC 代码。

**投毒风险：**

提供的 POC 代码（wso.py）主要功能是利用漏洞进行文件上传和远程代码执行。代码包含以下部分：

*   **请求库 (requests)：**  用于发送 HTTP 请求。
*   **目录创建 (os.mkdir)：**  用于创建结果目录。
*   **命令行清除 (os.system)：**  用于清除屏幕。
*   **Banner 打印：** 用于打印作者信息及免责声明

虽然没有明显的恶意代码，但仍存在一些潜在的风险：

*   **依赖项风险：** requirements.txt 文件中列出的依赖项（requests, urllib3, colorama）本身可能存在漏洞。如果这些依赖项被篡改或包含恶意代码，则可能导致安全问题。
*   **编码风险：** 代码没有对用户输入进行严格的验证，可能存在潜在的代码注入风险。例如，如果目标 URL 可控，攻击者可能会注入恶意代码。
*   **免责声明：** 作者的免责声明也暗示了使用该工具可能存在的风险，虽然正常的漏洞利用工具都有免责声明，但是也暗示此工具有一定的风险。

综上所述，该仓库存在较低的投毒风险，约为 10%。主要风险来自于依赖项和编码风险，需要仔细审查代码和依赖项，确保安全性。


**项目地址:** [ThatNotEasy/CVE-2022-29464](https://github.com/ThatNotEasy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #9

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #10

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 到 4.0.0, WSO2 Identity Server 5.2.0 到 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 和 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 到 5.11.0, WSO2 Enterprise Integrator 6.2.0 到 6.6.0, WSO2 Open Banking AM 1.4.0 到 2.0.0 和 WSO2 Open Banking KM 1.4.0, 到 2.0.0

**利用条件:** 需要网络访问目标 WSO2 实例，利用 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而实现远程代码执行。该漏洞的核心在于 `/fileupload` 端点未进行严格的身份验证和文件类型限制。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：**  WSO2 产品中的 `/fileupload` 端点允许未经身份验证的文件上传。`FileUploadServlet` 处理该请求，并根据 `carbon.xml` 配置文件加载的文件上传执行器处理上传的文件。由于未进行充分的验证，攻击者可以上传恶意文件。
2.  **利用步骤：**
    *   攻击者发送包含恶意 JSP 代码的 HTTP POST 请求到 `/fileupload` 端点。
    *   请求的 `Content-Disposition` 头包含目录遍历序列 (例如 `../../../../repository/deployment/server/webapps`)，用于将文件上传到 Web 根目录下的可执行目录。
    *   上传的 JSP 文件会被 WSO2 服务器执行，从而允许攻击者执行任意代码。
3.  **有效性评估：** 漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是可利用的，并且已经有公开的 PoC 代码存在。
4.  **投毒风险评估：**  漏洞利用代码的仓库中可能存在投毒的风险。虽然主要的利用方式是利用已知的漏洞，但仓库中可能会包含一些隐藏的、不明显的功能或代码，这些代码可能用于收集信息、植入后门或执行其他恶意活动。因此，对代码的审计是必要的，且投毒风险存在，约为 10%。风险主要来自于：
    *   **非必要的辅助脚本：** 仓库中可能包含一些非漏洞利用必需的脚本，例如用于扫描或配置的脚本，这些脚本可能包含恶意代码。
    *   **混淆的代码：**  某些代码可能经过混淆，使得难以分析其真实行为。
    *   **供应链攻击：**  仓库可能依赖于外部的库或组件，这些库或组件可能被恶意篡改。
    *   **社会工程：**  攻击者可能通过提交看似无害的 Pull Request 来引入恶意代码。
5.  **缓解措施：**
    *   升级到已修复漏洞的 WSO2 产品版本。
    *   实施严格的文件上传验证机制，包括身份验证、文件类型检查和大小限制。
    *   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
    *   定期进行安全审计和漏洞扫描。

**项目地址:** [amit-pathak009/CVE-2022-29464](https://github.com/amit-pathak009/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #11

**来源**: [CVE-2022-29464-axin2019_CVE-2022-29464.md](../2022/CVE-2022-29464-axin2019_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要目标服务器开放web端口且服务未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是WSO2产品中的一个严重漏洞，允许未经授权的文件上传，从而导致远程代码执行。攻击者通过向 `/fileupload` 端点发送包含目录遍历序列 `../../../../repository/deployment/server/webapps` 的 `Content-Disposition` 头部的恶意请求，绕过文件上传限制，将恶意JSP文件上传到web根目录下。  

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造一个`multipart/form-data`类型的POST请求，其中包含恶意JSP代码。请求的`Content-Disposition`头部使用目录遍历，将文件上传到目标web应用的`/repository/deployment/server/webapps`目录下的一个可访问的路径，如`authenticationendpoint`。
2.  **绕过上传限制：** 由于漏洞存在于文件上传的路径验证环节，攻击者可以利用目录遍历绕过服务器的文件类型和大小限制。
3.  **远程代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件，执行任意系统命令。
4.  **POC代码分析：**  提供的Python POC脚本模拟了上述攻击流程。脚本首先尝试访问目标URL，然后发送包含JSP后门的`multipart/form-data`请求到`/fileupload/toolsAny`，通过目录遍历将JSP文件上传到`authenticationendpoint`目录下。最后，脚本通过访问上传的JSP文件，执行`whoami`命令来验证漏洞是否存在。脚本中使用了两个不同的请求头`headers1`和`headers2`，针对目标进行尝试，提高了漏洞利用成功率。

**有效性评估：**

根据漏洞描述和POC代码，此漏洞利用方法有效，因为成功上传JSP文件即可执行任意命令。

**投毒风险评估：**

POC代码本身包含了一个用于远程代码执行的JSP后门，但这不是作者植入的恶意代码，而是漏洞利用的必要组成部分。代码中存在轻微的投毒风险（约10%），因为用户在复制和粘贴POC代码时，可能会无意中引入其他潜在的恶意代码或依赖项，但主要的风险在于漏洞本身，而不是POC代码的作者植入恶意代码。

**项目地址:** [axin2019/CVE-2022-29464](https://github.com/axin2019/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #12

**来源**: [CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md](../2022/CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM 等

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在漏洞并且可以通过网络访问 /fileupload 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 接口上传任意文件，通过目录穿越将文件写入到webapps目录下，从而导致远程代码执行。

**有效性分析：**

提供的POC代码利用了该漏洞。代码通过构造一个包含恶意JSP代码的文件，并使用目录穿越的方式将其上传到目标服务器的 `repository/deployment/server/webapps/authenticationendpoint/` 目录下。上传成功后，攻击者可以通过访问上传的JSP文件来执行任意命令。
根据搜索结果显示，该漏洞已经被广泛利用，证明POC的有效性。

**投毒风险分析：**

代码本身的功能是实现漏洞利用，上传并执行JSP后门。其中恶意行为是利用漏洞本身，而非代码作者额外添加的恶意功能。代码的危害在于利用漏洞，代码本身较为直白。
尽管如此，仍然存在微小的投毒风险，例如作者可能在代码中加入隐蔽的回连等恶意功能，但可能性较低，评估为5%。

**利用方式：**

1.  **确定目标：** 确定存在CVE-2022-29464漏洞的WSO2产品实例。
2.  **构造恶意JSP文件：** POC代码中已经包含了一个简单的JSP Shell，可以执行命令。攻击者可以根据需要修改JSP代码，实现更复杂的功能。
3.  **利用POC上传文件：** 使用POC代码，指定目标服务器地址和JSP文件名，将恶意JSP文件上传到目标服务器。
    *   `-f`：指定包含目标列表的文件。每一行包含一个目标地址，格式为 `HOST:PORT` 或 `IP:PORT`。
    *   `-t`：指定单个目标地址，格式同上。
    *   `-j`：指定要上传的JSP文件名。
4.  **执行命令：** 访问上传的JSP文件，通过URL参数传递要执行的命令。

例如，如果JSP文件名为 `shell.jsp`，则可以通过访问 `https://target/authenticationendpoint/shell.jsp?cmd=whoami` 来执行 `whoami` 命令。


**项目地址:** [c1ph3rbyt3/CVE-2022-29464](https://github.com/c1ph3rbyt3/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #13

**来源**: [CVE-2022-29464-cc3305_CVE-2022-29464.md](../2022/CVE-2022-29464-cc3305_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。搜索引擎结果表明该漏洞已被积极利用，存在公开可用的PoC，并且厂商建议用户立即更新或采取临时缓解措施。

**投毒风险：**

该PoC代码主要通过文件上传功能将恶意的JSP文件上传到目标服务器的webapps目录下。直接观察代码，存在投毒的可能性较低，例如作者可能嵌入反向shell或其他恶意功能，但并未发现明显的恶意行为。但仍需要对该脚本依赖的库，以及脚本的作者进行信誉评估。同时代码使用`force`参数绕过版本检测，如果目标事实上不存在漏洞，可能会因为尝试上传恶意文件导致服务不稳定。综合评估，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者使用 `/fileupload` 端点，通过 `Content-Disposition` 中的目录遍历序列（例如 `../../../../`）将文件上传到 Web 根目录下的目录，如 `repository/deployment/server/webapps`。
2.  **文件上传：** 攻击者上传包含恶意代码的 JSP 文件（或其他 Web Shell），例如本例中，poc脚本构造一个jsp_shell，命令执行的命令通过参数传入，更加灵活。
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件触发恶意代码的执行，从而在服务器上执行任意命令。

总而言之，该漏洞利用方式是通过精心构造的HTTP请求，利用WSO2文件上传接口的目录遍历漏洞，上传恶意JSP文件，最终导致远程代码执行。

**项目地址:** [cc3305/CVE-2022-29464](https://github.com/cc3305/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #14

**来源**: [CVE-2022-29464-devengpk_CVE-2022-29464.md](../2022/CVE-2022-29464-devengpk_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，允许未经身份验证的攻击者上传恶意文件并在服务器上执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要目标WSO2服务器实例可以通过网络访问，并且存在/fileupload端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于 WSO2 产品中，允许未经授权的文件上传，最终导致远程代码执行。攻击者可以利用 `/fileupload` 端点，通过 `Content-Disposition` 头部进行目录遍历，将恶意 JSP 文件上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录等位置。由于 `/fileupload` 路由未受到身份验证的保护，攻击者无需登录即可利用此漏洞。

**利用方式：**
1.  攻击者构造包含恶意 JSP 代码的文件。
2.  攻击者向 `/fileupload` 端点发送包含 `Content-Disposition` 头部，进行目录遍历的 HTTP 请求，将恶意 JSP 文件上传到服务器的 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。
3.  服务器处理上传请求，并将恶意 JSP 文件写入目标目录。
4.  攻击者通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码执行，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞利用代码有效。

**投毒风险：**
虽然提供的代码主要描述了漏洞原理，但代码中仍存在小概率潜在的投毒风险。作者可能会在利用代码中添加一些难以察觉的恶意代码，例如反弹 shell 或植入后门等。因此，在使用此类代码时，需要谨慎审查，确保其安全性。初步估计投毒风险为10%。

**项目地址:** [devengpk/CVE-2022-29464](https://github.com/devengpk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #15

**来源**: [CVE-2022-29464-g0dxing_CVE-2022-29464.md](../2022/CVE-2022-29464-g0dxing_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 `/fileupload` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 端点上传任意文件，通过目录穿越将恶意JSP文件上传到webapps目录下，从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。多个来源都确认了该漏洞的存在和可利用性，并且存在公开的PoC。

**投毒风险：**
PoC 代码本身主要功能是上传 webshell，但是`reverse_jsp`使用了硬编码的`8.tcp.ngrok.io:12508`，存在潜在的风险，如果攻击者修改了这个reverse shell 的地址，有可能反弹shell到攻击者的机器上。虽然`public_key`变量存在，但是代码没有使用，所以可以排除钓鱼风险，综上判断，存在5%的投毒风险。

**利用方式：**
1.  攻击者使用带有目录穿越的 `Content-Disposition` 头构造恶意的POST请求到 `/fileupload` 端点。
2.  请求中包含要上传的恶意JSP文件，目标路径指向Web根目录下的一个可执行JSP的目录，例如 `repository/deployment/server/webapps`。
3.  服务器接收到请求后，由于未对上传的文件类型和目标路径进行充分验证，会将恶意JSP文件写入到指定目录。
4.  攻击者可以通过访问上传的JSP文件，执行其中的恶意代码，实现远程代码执行。

**项目地址:** [g0dxing/CVE-2022-29464](https://github.com/g0dxing/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #16

**来源**: [CVE-2022-29464-gbrsh_CVE-2022-29464.md](../2022/CVE-2022-29464-gbrsh_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传 / 远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权的攻击者上传恶意文件并执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标WSO2服务器存在/fileupload endpoint且未进行适当的路径限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的高危漏洞，允许未经身份验证的攻击者通过`/fileupload`端点上传任意文件，从而导致远程代码执行。攻击者利用路径遍历漏洞将恶意JSP文件上传到webapps目录下，例如`../../../../repository/deployment/server/webapps/authenticationendpoint/evil.jsp`。上传成功后，攻击者可以通过访问该JSP文件来执行任意系统命令。提供的POC代码通过构造包含恶意JSP代码的文件上传请求，利用该漏洞。代码首先上传一个包含命令执行功能的JSP文件，然后通过发送带有`cmd`参数的GET请求来执行系统命令。代码中未发现任何隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低。

**漏洞利用方式：**

1.  **文件上传：** 攻击者向目标WSO2服务器的`/fileupload`端点发送POST请求，上传包含恶意JSP代码的文件。Content-Disposition头包含路径遍历序列，将文件上传到webapps目录下。
2.  **代码执行：** 攻击者通过访问上传的JSP文件（例如`/authenticationendpoint/evil.jsp?cmd=whoami`）来执行任意系统命令。服务器执行JSP代码，并将命令执行结果返回给攻击者。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。利用成功与否取决于目标系统是否存在漏洞，是否打补丁，以及是否配置正确。

**搜索引擎结果：**

搜索结果表明，CVE-2022-29464是一个已被广泛利用的漏洞，多个安全厂商发布了关于该漏洞的分析报告和修复建议。有报告指出，该漏洞已被用于安装Cobalt Strike beacons和其他恶意软件。


**项目地址:** [gbrsh/CVE-2022-29464](https://github.com/gbrsh/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #17

**来源**: [CVE-2022-29464-hakivvi_CVE-2022-29464.md](../2022/CVE-2022-29464-hakivvi_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问到WSO2服务器的/fileupload端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞是一个存在于多个WSO2产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要是漏洞原理的分析和描述，并未发现直接的恶意代码。然而，任何公开的漏洞利用代码都存在被修改并植入恶意代码的风险。例如，攻击者可能修改POC，在成功上传JSP后，执行额外的恶意操作，例如下载并执行其他恶意程序。POC中直接包含恶意JSP的可能性较低，但后续利用上传的JSP进行投毒的可能性较高。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞位置：** 受影响的WSO2产品存在`/fileupload`端点，该端点允许未授权的文件上传。
2.  **路径穿越：** 攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）将上传的文件写入到Web根目录下的特定位置，如`repository/deployment/server/webapps`。
3.  **上传恶意文件：** 攻击者上传包含恶意代码的JSP文件。
4.  **远程代码执行：**  一旦恶意JSP文件被上传到Web根目录，攻击者可以通过访问该JSP文件来执行服务器上的任意代码。

**项目地址:** [hakivvi/CVE-2022-29464](https://github.com/hakivvi/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #18

**来源**: [CVE-2022-29464-hev0x_CVE-2022-29464.md](../2022/CVE-2022-29464-hev0x_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问，目标存在/fileupload端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的任意文件上传漏洞，允许未经授权的攻击者上传恶意文件并执行远程代码。根据漏洞信息和搜索结果，此漏洞利用涉及利用 `/fileupload` 端点，并使用 `Content-Disposition` 头部中的目录遍历序列将文件上传到 Web 根目录下的可访问位置，例如 `../../../../repository/deployment/server/webapps` 目录。POC 代码的工作原理如下：

1.  **定位目标：** 脚本接收包含目标 URL 的文件作为输入。
2.  **构造恶意请求：** 脚本构造一个 POST 请求，使用 `/fileupload/toolsAny` 端点，并在 `files` 参数中包含一个指向恶意 JSP 文件的映射。JSP 文件的内容是一个简单的 WebShell，允许执行任意命令。
3.  **目录遍历：** 脚本使用目录遍历序列 (例如 `../../../../`) 将 JSP 文件上传到 `repository/deployment/server/webapps/authenticationendpoint/megas.jsp` 路径下。 `authenticationendpoint` 是一个常见的 Web 应用目录，`megas.jsp` 是上传的 webshell 文件名。
4.  **执行代码：** 脚本通过访问上传的 JSP WebShell (例如 `/authenticationendpoint/megas.jsp?cmd=id`) 来执行命令。脚本首先尝试执行 `id` 命令以验证漏洞是否成功利用。
5.  **验证与输出：** 如果 `id` 命令执行成功并且返回了 `uid` 信息，脚本会认为目标存在漏洞，并将结果输出到屏幕和文件中。

**投毒风险分析：**

我分析了提供的 POC 代码。该代码的主要功能是利用目录遍历和文件上传漏洞在目标系统上部署一个 webshell，然后通过 webshell 执行系统命令。代码没有发现任何隐藏的、与漏洞利用无关的功能，例如收集用户信息、传播恶意软件或篡改系统配置等。因此，该 POC 代码的投毒风险评估为 0%。

**总结：**

该漏洞利用代码有效，因为它能够利用文件上传漏洞在目标系统上部署和执行恶意代码，从而实现远程代码执行。利用方式清晰，无需身份验证。由于代码只包含漏洞利用逻辑，因此不存在投毒风险。

**项目地址:** [hev0x/CVE-2022-29464](https://github.com/hev0x/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #19

**来源**: [CVE-2022-29464-hupe1980_CVE-2022-29464.md](../2022/CVE-2022-29464-hupe1980_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的高危漏洞，它允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，最终导致远程代码执行。该漏洞的利用方式是通过构造包含目录穿越序列的 `Content-Disposition` 头，将恶意 JSP 文件上传到 Web 根目录下的可访问位置，如 `repository/deployment/server/webapps` 目录。上传的 JSP 文件包含执行任意命令的代码。根据提供的漏洞利用代码 `exploit.py`，该脚本通过 POST 请求向目标服务器的 `/fileupload/toolsAny` 端点上传一个包含恶意代码的 JSP 文件。攻击者可以通过访问上传的 JSP 文件来执行任意命令。例如，脚本会将包含一个表单的 JSP shell 上传到 `/authenticationendpoint` 应用目录下。 该代码看起来是直接利用漏洞，没有发现隐藏的恶意代码或者后门，所以投毒风险评估为0%。 搜索引擎结果也表明该漏洞已被广泛利用，并建议用户尽快更新或采取缓解措施。

**项目地址:** [hupe1980/CVE-2022-29464](https://github.com/hupe1980/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #20

**来源**: [CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md](../2022/CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行，系统完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经授权的文件上传，并最终导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 头部中的目录遍历序列（如 `../../../../`）将恶意文件上传到 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。上传的文件可以是 JSP、WAR 或其他可执行格式，从而允许攻击者在服务器上执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的目标服务器。
2.  **构造恶意请求：** 构造一个包含恶意文件的 POST 请求，该文件将被上传到 `/fileupload` 端点。请求的 `Content-Disposition` 头部必须包含目录遍历序列，以便将文件放置在 Web 根目录下的可执行目录中。
3.  **上传恶意文件：** 发送构造的请求到目标服务器。服务器会处理请求并将恶意文件上传到指定目录。
4.  **触发代码执行：** 通过访问上传的恶意文件（例如，通过 Web 浏览器），触发服务器执行其中的代码。

**投毒风险分析：**

提供的漏洞利用代码段（`LICENSE`文件）是 GNU GPL 许可证的文本，不包含任何恶意代码或投毒行为。因此，此代码段本身不存在投毒风险。 但是，如果提供的仓库中包含其他payload.jsp或者war,那么会存在投毒风险.根据现有信息，投毒风险为0%。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2022-29464 漏洞利用的有效性很高，该漏洞被广泛利用，并且已经有公开的PoC利用代码。

**项目地址:** [hxlxmj/Mass-exploit-CVE-2022-29464](https://github.com/hxlxmj/Mass-exploit-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #21

**来源**: [CVE-2022-29464-jimidk_Better-CVE-2022-29464.md](../2022/CVE-2022-29464-jimidk_Better-CVE-2022-29464.md)

# CVE-2022-29464

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-29464-000pp_WSOB.md](../2022/CVE-2022-29464-000pp_WSOB.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器开放fileupload端点，且攻击者可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞存在于多个WSO2产品中，允许未经授权的文件上传，最终导致远程代码执行。

**漏洞利用方式：**

攻击者通过 `/fileupload` 端点，利用 `Content-Disposition` 头部的目录穿越（Path Traversal）序列，将恶意文件上传到Web根目录下的可执行目录，例如 `../../../../repository/deployment/server/webapps`。上传的文件会被服务器解析执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Trend Micro等安全厂商的分析）和提供的POC代码（WSOB工具），该漏洞利用的有效性很高。网上有大量的关于此漏洞的分析文章和漏洞利用案例。

**投毒风险：**

提供的POC代码是一个相对简单的Python脚本，主要功能是利用该漏洞进行文件上传。主要包含以下几个文件:
* `main.py`: 主程序入口，解析参数并启动漏洞利用。
* `src/interface/ui.py`: 定义了用户界面相关的函数，如显示banner。
* `src/wsob/main.py`: 漏洞利用的核心代码。
* `requirements.txt`: 依赖的Python库。

通过分析POC代码，**未发现明显的恶意代码或后门**。代码逻辑相对清晰，主要是发送HTTP请求，构造恶意的文件上传请求，进行目录穿越，实现任意文件上传。

但依旧存在潜在的投毒风险：

1.  **依赖风险：** `requirements.txt` 中列出的依赖库可能存在安全漏洞，攻击者可以通过供应链攻击，篡改这些依赖库，从而植入恶意代码。但是概率较低。
2. **漏洞利用代码本身的缺陷:**  漏洞利用代码中可能包含未知的缺陷或者错误，导致利用失败，或者引发其他安全问题。但是根据目前搜索结果该POC相对比较成熟。

**综合评估，该POC代码存在轻微的投毒风险，大约为5%。**

**项目地址:** [000pp/WSOB](https://github.com/000pp/WSOB)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #2

**来源**: [CVE-2022-29464-Chocapikk_CVE-2022-29464.md](../2022/CVE-2022-29464-Chocapikk_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** Unrestricted File Upload/Remote Code Execution

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的文件上传导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM/KM 1.4.0 to 2.0.0

**利用条件:** 目标服务器存在fileupload endpoint，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 允许未经授权的文件上传，导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 目录遍历序列，将恶意JSP文件上传至Web根目录下的 `repository/deployment/server/webapps` 目录，从而实现RCE。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞是有效的。搜索结果中多个来源确认了该漏洞的存在和利用，并给出了相应的修复建议。漏洞利用代码通过上传JSP webshell来实现远程代码执行。

**投毒风险：**

POC代码中存在一定的投毒风险的可能性，可能性估计为10%。

*   **反弹shell配置：** `reverse_jsp` 中包含硬编码的反弹shell服务器 `8.tcp.ngrok.io:12508`。虽然这可能是为了方便测试，但也可能被用于跟踪或控制利用者的行为。此IP和端口并不一定是恶意的，但是需要使用者额外注意。
*   **公钥上传：**代码中存在上传公钥的部分，用途不明，存在潜在风险。
*   **代码审查：** 漏洞利用代码本身的行为是上传JSP文件，并在目标系统上执行命令。审查发现此代码中无明显恶意逻辑，但是使用者需要进行仔细的代码审查,确认符合预期行为。

**利用方式：**

1.  **确定目标：** 找到运行受影响版本 WSO2 产品的服务器。
2.  **上传恶意文件：** 利用 `/fileupload` 端点，通过构造包含目录遍历的 `Content-Disposition` 请求，上传包含恶意代码的 JSP 文件到服务器的 `/repository/deployment/server/webapps` 目录，例如上传到 `authenticationendpoint` 目录下。
3.  **触发恶意代码：** 访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。POC代码中上传了webshell `balgo.jsp` 和反弹shell `balgorev.jsp`。
4.  **反弹shell接收:** 如果成功利用了反弹shell,需要在相应ip和端口监听,接收反弹shell连接

**项目地址:** [Chocapikk/CVE-2022-29464](https://github.com/Chocapikk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #3

**来源**: [CVE-2022-29464-LinJacck_CVE-2022-29464.md](../2022/CVE-2022-29464-LinJacck_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。

**漏洞分析：**

该漏洞的根本原因是 WSO2 产品中的 `/fileupload` 接口没有对上传的文件进行充分的验证。攻击者可以利用目录遍历漏洞，通过在 `Content-Disposition` 头中构造恶意路径，将恶意文件上传到 Web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。

**利用方式：**

1.  攻击者首先需要确定目标系统存在漏洞，即存在 `/fileupload` 接口且允许上传文件。
2.  攻击者构造一个包含恶意代码的 JSP 文件（或其他服务器支持的脚本文件）。
3.  攻击者构造一个包含目录遍历序列的 HTTP POST 请求，将恶意 JSP 文件上传到目标服务器的 Web 根目录下的 `repository/deployment/server/webapps/authenticationendpoint/` 目录中。文件名可以自定义，但通常以 `.jsp` 结尾，如 ShellDef变量所示。
4.  攻击者通过访问上传的 JSP 文件，即可执行其中的恶意代码，从而获得对服务器的控制权。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化利用 CVE-2022-29464 漏洞。

*   它首先定义了一个 `exploit` 函数，该函数负责构造包含恶意 JSP 代码的 HTTP POST 请求，并将该请求发送到目标服务器的 `/fileupload` 接口。
*   JSP 代码创建一个简单的 Web shell，允许攻击者通过 Web 界面执行任意系统命令。
*  脚本尝试上传一个名为`404.jsp`的文件用以验证漏洞.如果上传成功,则上传webshell到`/authenticationendpoint`目录下。
*  脚本还允许从外部文件读取webshell的内容并上传,增强了灵活性

**投毒风险评估：**

该 POC 代码本身**没有明显的投毒行为**。代码只是尝试上传 webshell，以便进行远程代码执行。恶意行为完全取决于攻击者上传的 JSP 文件中的内容。因此，该代码的投毒风险较低,可以认为是0。

**有效性：**

根据漏洞描述和 POC 代码的实现，以及搜索引擎返回的结果，该 POC 代码能够有效地利用 CVE-2022-29464 漏洞，实现任意文件上传和远程代码执行。


**项目地址:** [LinJacck/CVE-2022-29464](https://github.com/LinJacck/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #4

**来源**: [CVE-2022-29464-Pasch0_WSO2RCE.md](../2022/CVE-2022-29464-Pasch0_WSO2RCE.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问，目标存在/fileupload接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重的任意文件上传漏洞，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头部的请求，上传恶意文件到 web 根目录下的可执行位置，例如 `../../../../repository/deployment/server/webapps`。上传的文件可以被当作 JSP 或其他可执行文件解析，从而导致远程代码执行。根据搜索结果，该漏洞已经被广泛利用，并被用于安装 Cobalt Strike beacons 和其他恶意软件。提供的代码片段是 GNU GPL 协议，与漏洞利用本身无关，因此不存在投毒风险。利用方式主要为：

1.  利用 `/fileupload` 接口上传文件。
2.  在 `Content-Disposition` 头中构造目录遍历路径，将文件上传到 webapps 目录下。
3.  上传恶意 JSP 或其他可执行文件。
4.  通过访问上传的文件执行任意代码。

由于该漏洞已经被 CISA 加入已知被利用漏洞目录，建议尽快修复。

**项目地址:** [Pasch0/WSO2RCE](https://github.com/Pasch0/WSO2RCE)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #5

**来源**: [CVE-2022-29464-Pushkarup_CVE-2022-29464.md](../2022/CVE-2022-29464-Pushkarup_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口且未进行严格的文件类型和路径校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的关键漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**漏洞利用方式：**

1.  攻击者通过`/fileupload`端点上传恶意文件，通常是包含恶意代码的JSP webshell。
2.  攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）绕过文件上传限制，将webshell上传到Web根目录下的可执行目录，例如`repository/deployment/server/webapps`。
3.  一旦webshell上传成功，攻击者可以通过访问该webshell的URL来执行任意代码。

**有效性评估：**

*   根据漏洞信息、搜索引擎结果和提供的POC代码，此漏洞的利用是有效的。 搜索引擎结果显示，该漏洞已被积极利用（例如TrendMicro报告）。 提供的POC代码（`wso.py` 脚本）旨在自动化利用过程，包括上传webshell并执行命令。

**投毒风险评估：**

该漏洞利用代码主要包含以下几个文件:

*   `LICENSE`：MIT许可证声明，表明代码是开源的，并允许修改和分发。
*   `README.md`：包含漏洞描述、免责声明、利用说明、webshell功能介绍、安装步骤、使用方法、贡献方式、许可协议和联系方式等信息。免责声明明确表示该POC仅用于教育目的，禁止用于非法活动。
*   `wso.py`：此Python脚本包含漏洞利用的核心代码，用于扫描目标站点是否存在漏洞、上传webshell、执行命令等操作。
*   `requirements.txt`：列出了脚本运行所需的Python依赖包，包括requests、colorama和urllib3。

考虑到代码的结构和功能，投毒的潜在风险较低，但仍然存在以下可能性：

1.  **Webshell后门植入**: `wso.py`脚本可能包含额外的后门或恶意代码，虽然webshell本身就是后门，但可能隐藏更深层的控制机制。
2.  **依赖包投毒**: 虽然 `requirements.txt` 文件中的依赖包看起来是标准的，但攻击者可能会使用拼写相似的恶意包来替换它们（例如，将`requests`替换为`requ3sts`）。
3.  **信息收集**: 脚本可能会暗中收集目标系统的信息，并将这些信息发送给攻击者。
4.  **资源消耗**: 脚本可能设计为消耗目标系统的资源，例如CPU或内存，从而导致拒绝服务。

鉴于以上分析，我估计该POC代码存在10%的投毒风险。 这个比例基于以下因素：

*   该POC的主要功能是利用已知的漏洞，目的是方便用户进行测试和验证。
*   POC的作者声明仅用于教育目的。
*   代码开源，方便其他人审查。
*   潜在的风险因素（如webshell后门、依赖包投毒、信息收集和资源消耗）依然存在，需要保持警惕。

**安全建议：**

*   在运行此POC之前，务必在一个隔离的环境中进行。
*   仔细审查代码，特别注意webshell和依赖包。
*   使用网络监控工具来检测任何异常的网络活动。


**项目地址:** [Pushkarup/CVE-2022-29464](https://github.com/Pushkarup/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #6

**来源**: [CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md](../2022/CVE-2022-29464-SynixCyberCrimeMy_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码。

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标系统存在/fileupload接口，且未对上传的文件类型和路径进行严格限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于多个 WSO2 产品中，是一个严重的安全漏洞。攻击者可以利用`/fileupload`接口，通过目录遍历的方式将恶意 JSP 文件上传到 Web 应用的根目录下，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`。上传的 JSP 文件随后可以被 Web 服务器执行，从而导致远程代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用方式是有效的，并且已经被广泛利用。
提供的 PoC 代码尝试上传一个名为 `shell.jsp` 的 JSP 文件，该文件包含可以执行系统命令的恶意代码。如果上传成功，攻击者可以通过访问 `http(s)://目标地址/authenticationendpoint/shell.jsp` 来执行任意代码。

**投毒风险：**

PoC 代码中，`/tmp/e2105c9753cc00a9633b2cfd9b6fe351/cve.py` 主要功能是发送恶意请求，上传木马文件，整体代码没有明显的投毒行为。但是，以下几点需要注意：
*   `Files/shell.jsp`: 这是一个后门文件，如果未经审查直接使用，可能会引入未知风险。建议在使用前，仔细检查 `shell.jsp` 的内容，确保其只包含必要的功能，并且没有恶意代码。
*   对 `requirements.txt` 中引入的第三方库也需要进行审核，确保没有引入恶意的依赖。
*   README.md 感谢列表,作者SynixCyberCrimeMY & ?/h4zzzzzz.scc 未知。

因此，投毒风险较低，预估在10%左右。

**利用方式：**

1.  攻击者构造包含目录遍历的恶意请求，利用`/fileupload`接口上传恶意的 JSP 文件 (shell.jsp)。
2.  恶意 JSP 文件被上传到 Web 应用的根目录下。
3.  攻击者通过 Web 浏览器访问上传的 JSP 文件，执行其中的恶意代码。
4.  恶意代码在服务器上执行，允许攻击者执行任意系统命令，从而完全控制受影响的系统。

**防范措施：**

*   升级到 WSO2 官方修复后的版本。
*   实施文件上传白名单策略，仅允许上传必要的文件类型。
*   对上传的文件进行严格的路径验证，防止目录遍历攻击。
*   部署 Web 应用防火墙 (WAF)，检测和阻止恶意的文件上传请求。

**项目地址:** [SynixCyberCrimeMy/CVE-2022-29464](https://github.com/SynixCyberCrimeMy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #7

**来源**: [CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md](../2022/CVE-2022-29464-SystemVll_CVE-2022-29464-loader.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标存在/fileupload端点且未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，攻击者可以通过利用/fileupload端点上传任意文件，结合目录遍历将恶意JSP文件写入到webapps目录下，从而实现远程代码执行。该POC脚本首先生成一个随机文件名的JSP webshell，然后通过POST请求将该webshell上传到目标服务器的/fileupload/toolsAny端点。请求头中包含目录遍历(../)序列，用于将文件写入到服务器的webapps目录。上传后，脚本会休眠15秒，然后尝试通过GET请求访问上传的webshell，并执行指定的命令。如果返回状态码为200，则表示webshell执行成功。该POC的利用方式是典型的任意文件上传结合目录遍历实现RCE的漏洞利用方式。

**有效性:**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的，可以利用该漏洞在目标服务器上执行任意代码。

**投毒风险:**
代码没有发现明显的恶意行为或隐藏的后门。所有操作都与漏洞利用相关，例如上传 webshell 和执行命令。该代码的主要目的是为了验证漏洞的存在并进行简单的命令执行，没有检测到任何试图损害用户系统或窃取信息的行为。

**利用方式:**
1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的服务器。
2.  **上传 Webshell：** 使用包含目录遍历的 Content-Disposition 头的 POST 请求，将恶意 JSP 文件上传到`/fileupload/toolsAny`端点。
3.  **远程代码执行：** 通过访问上传的 JSP 文件，传递需要执行的命令作为参数，实现远程代码执行。例如：`{host}/authenticationendpoint/{filename}?cmd={command}`


**项目地址:** [SystemVll/CVE-2022-29464-loader](https://github.com/SystemVll/CVE-2022-29464-loader)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #8

**来源**: [CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md](../2022/CVE-2022-29464-ThatNotEasy_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传漏洞

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 - 4.0.0, WSO2 Identity Server 5.2.0 - 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 - 5.11.0, WSO2 Enterprise Integrator 6.2.0 - 6.6.0, WSO2 Open Banking AM 1.4.0 - 2.0.0, WSO2 Open Banking KM 1.4.0 - 2.0.0

**利用条件:** 需要网络访问，目标存在 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。漏洞的根源在于 /fileupload 接口缺乏适当的文件类型验证，攻击者可以通过构造包含目录遍历序列的 Content-Disposition 头，将恶意文件上传到 Web 根目录下的可执行位置，例如 repository/deployment/server/webapps 目录。上传的文件可以是 JSP 文件或其他服务器支持的脚本类型。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 WSO2 产品的服务器。
2.  **构造恶意请求：**  构造一个包含恶意文件的 HTTP POST 请求，该请求发送到 /fileupload 接口。Content-Disposition 头必须包含目录遍历序列，以将文件上传到 Web 根目录下的指定位置。
3.  **上传文件：**  将构造的请求发送到目标服务器。
4.  **执行代码：**  通过访问上传的文件来触发恶意代码的执行。例如，如果上传的是 JSP 文件，则可以通过 Web 浏览器访问该文件来执行其中的代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源都证实了该漏洞的存在和利用方式，并且提供了可用的 POC 代码。

**投毒风险：**

提供的 POC 代码（wso.py）主要功能是利用漏洞进行文件上传和远程代码执行。代码包含以下部分：

*   **请求库 (requests)：**  用于发送 HTTP 请求。
*   **目录创建 (os.mkdir)：**  用于创建结果目录。
*   **命令行清除 (os.system)：**  用于清除屏幕。
*   **Banner 打印：** 用于打印作者信息及免责声明

虽然没有明显的恶意代码，但仍存在一些潜在的风险：

*   **依赖项风险：** requirements.txt 文件中列出的依赖项（requests, urllib3, colorama）本身可能存在漏洞。如果这些依赖项被篡改或包含恶意代码，则可能导致安全问题。
*   **编码风险：** 代码没有对用户输入进行严格的验证，可能存在潜在的代码注入风险。例如，如果目标 URL 可控，攻击者可能会注入恶意代码。
*   **免责声明：** 作者的免责声明也暗示了使用该工具可能存在的风险，虽然正常的漏洞利用工具都有免责声明，但是也暗示此工具有一定的风险。

综上所述，该仓库存在较低的投毒风险，约为 10%。主要风险来自于依赖项和编码风险，需要仔细审查代码和依赖项，确保安全性。


**项目地址:** [ThatNotEasy/CVE-2022-29464](https://github.com/ThatNotEasy/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #9

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464-mass.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #10

**来源**: [CVE-2022-29464-amit-pathak009_CVE-2022-29464.md](../2022/CVE-2022-29464-amit-pathak009_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 到 4.0.0, WSO2 Identity Server 5.2.0 到 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 和 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 到 5.11.0, WSO2 Enterprise Integrator 6.2.0 到 6.6.0, WSO2 Open Banking AM 1.4.0 到 2.0.0 和 WSO2 Open Banking KM 1.4.0, 到 2.0.0

**利用条件:** 需要网络访问目标 WSO2 实例，利用 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而实现远程代码执行。该漏洞的核心在于 `/fileupload` 端点未进行严格的身份验证和文件类型限制。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：**  WSO2 产品中的 `/fileupload` 端点允许未经身份验证的文件上传。`FileUploadServlet` 处理该请求，并根据 `carbon.xml` 配置文件加载的文件上传执行器处理上传的文件。由于未进行充分的验证，攻击者可以上传恶意文件。
2.  **利用步骤：**
    *   攻击者发送包含恶意 JSP 代码的 HTTP POST 请求到 `/fileupload` 端点。
    *   请求的 `Content-Disposition` 头包含目录遍历序列 (例如 `../../../../repository/deployment/server/webapps`)，用于将文件上传到 Web 根目录下的可执行目录。
    *   上传的 JSP 文件会被 WSO2 服务器执行，从而允许攻击者执行任意代码。
3.  **有效性评估：** 漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞是可利用的，并且已经有公开的 PoC 代码存在。
4.  **投毒风险评估：**  漏洞利用代码的仓库中可能存在投毒的风险。虽然主要的利用方式是利用已知的漏洞，但仓库中可能会包含一些隐藏的、不明显的功能或代码，这些代码可能用于收集信息、植入后门或执行其他恶意活动。因此，对代码的审计是必要的，且投毒风险存在，约为 10%。风险主要来自于：
    *   **非必要的辅助脚本：** 仓库中可能包含一些非漏洞利用必需的脚本，例如用于扫描或配置的脚本，这些脚本可能包含恶意代码。
    *   **混淆的代码：**  某些代码可能经过混淆，使得难以分析其真实行为。
    *   **供应链攻击：**  仓库可能依赖于外部的库或组件，这些库或组件可能被恶意篡改。
    *   **社会工程：**  攻击者可能通过提交看似无害的 Pull Request 来引入恶意代码。
5.  **缓解措施：**
    *   升级到已修复漏洞的 WSO2 产品版本。
    *   实施严格的文件上传验证机制，包括身份验证、文件类型检查和大小限制。
    *   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
    *   定期进行安全审计和漏洞扫描。

**项目地址:** [amit-pathak009/CVE-2022-29464](https://github.com/amit-pathak009/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #11

**来源**: [CVE-2022-29464-axin2019_CVE-2022-29464.md](../2022/CVE-2022-29464-axin2019_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要目标服务器开放web端口且服务未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464是WSO2产品中的一个严重漏洞，允许未经授权的文件上传，从而导致远程代码执行。攻击者通过向 `/fileupload` 端点发送包含目录遍历序列 `../../../../repository/deployment/server/webapps` 的 `Content-Disposition` 头部的恶意请求，绕过文件上传限制，将恶意JSP文件上传到web根目录下。  

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造一个`multipart/form-data`类型的POST请求，其中包含恶意JSP代码。请求的`Content-Disposition`头部使用目录遍历，将文件上传到目标web应用的`/repository/deployment/server/webapps`目录下的一个可访问的路径，如`authenticationendpoint`。
2.  **绕过上传限制：** 由于漏洞存在于文件上传的路径验证环节，攻击者可以利用目录遍历绕过服务器的文件类型和大小限制。
3.  **远程代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件，执行任意系统命令。
4.  **POC代码分析：**  提供的Python POC脚本模拟了上述攻击流程。脚本首先尝试访问目标URL，然后发送包含JSP后门的`multipart/form-data`请求到`/fileupload/toolsAny`，通过目录遍历将JSP文件上传到`authenticationendpoint`目录下。最后，脚本通过访问上传的JSP文件，执行`whoami`命令来验证漏洞是否存在。脚本中使用了两个不同的请求头`headers1`和`headers2`，针对目标进行尝试，提高了漏洞利用成功率。

**有效性评估：**

根据漏洞描述和POC代码，此漏洞利用方法有效，因为成功上传JSP文件即可执行任意命令。

**投毒风险评估：**

POC代码本身包含了一个用于远程代码执行的JSP后门，但这不是作者植入的恶意代码，而是漏洞利用的必要组成部分。代码中存在轻微的投毒风险（约10%），因为用户在复制和粘贴POC代码时，可能会无意中引入其他潜在的恶意代码或依赖项，但主要的风险在于漏洞本身，而不是POC代码的作者植入恶意代码。

**项目地址:** [axin2019/CVE-2022-29464](https://github.com/axin2019/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #12

**来源**: [CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md](../2022/CVE-2022-29464-c1ph3rbyt3_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM 等

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在漏洞并且可以通过网络访问 /fileupload 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 接口上传任意文件，通过目录穿越将文件写入到webapps目录下，从而导致远程代码执行。

**有效性分析：**

提供的POC代码利用了该漏洞。代码通过构造一个包含恶意JSP代码的文件，并使用目录穿越的方式将其上传到目标服务器的 `repository/deployment/server/webapps/authenticationendpoint/` 目录下。上传成功后，攻击者可以通过访问上传的JSP文件来执行任意命令。
根据搜索结果显示，该漏洞已经被广泛利用，证明POC的有效性。

**投毒风险分析：**

代码本身的功能是实现漏洞利用，上传并执行JSP后门。其中恶意行为是利用漏洞本身，而非代码作者额外添加的恶意功能。代码的危害在于利用漏洞，代码本身较为直白。
尽管如此，仍然存在微小的投毒风险，例如作者可能在代码中加入隐蔽的回连等恶意功能，但可能性较低，评估为5%。

**利用方式：**

1.  **确定目标：** 确定存在CVE-2022-29464漏洞的WSO2产品实例。
2.  **构造恶意JSP文件：** POC代码中已经包含了一个简单的JSP Shell，可以执行命令。攻击者可以根据需要修改JSP代码，实现更复杂的功能。
3.  **利用POC上传文件：** 使用POC代码，指定目标服务器地址和JSP文件名，将恶意JSP文件上传到目标服务器。
    *   `-f`：指定包含目标列表的文件。每一行包含一个目标地址，格式为 `HOST:PORT` 或 `IP:PORT`。
    *   `-t`：指定单个目标地址，格式同上。
    *   `-j`：指定要上传的JSP文件名。
4.  **执行命令：** 访问上传的JSP文件，通过URL参数传递要执行的命令。

例如，如果JSP文件名为 `shell.jsp`，则可以通过访问 `https://target/authenticationendpoint/shell.jsp?cmd=whoami` 来执行 `whoami` 命令。


**项目地址:** [c1ph3rbyt3/CVE-2022-29464](https://github.com/c1ph3rbyt3/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #13

**来源**: [CVE-2022-29464-cc3305_CVE-2022-29464.md](../2022/CVE-2022-29464-cc3305_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行（RCE）。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。搜索引擎结果表明该漏洞已被积极利用，存在公开可用的PoC，并且厂商建议用户立即更新或采取临时缓解措施。

**投毒风险：**

该PoC代码主要通过文件上传功能将恶意的JSP文件上传到目标服务器的webapps目录下。直接观察代码，存在投毒的可能性较低，例如作者可能嵌入反向shell或其他恶意功能，但并未发现明显的恶意行为。但仍需要对该脚本依赖的库，以及脚本的作者进行信誉评估。同时代码使用`force`参数绕过版本检测，如果目标事实上不存在漏洞，可能会因为尝试上传恶意文件导致服务不稳定。综合评估，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者使用 `/fileupload` 端点，通过 `Content-Disposition` 中的目录遍历序列（例如 `../../../../`）将文件上传到 Web 根目录下的目录，如 `repository/deployment/server/webapps`。
2.  **文件上传：** 攻击者上传包含恶意代码的 JSP 文件（或其他 Web Shell），例如本例中，poc脚本构造一个jsp_shell，命令执行的命令通过参数传入，更加灵活。
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件触发恶意代码的执行，从而在服务器上执行任意命令。

总而言之，该漏洞利用方式是通过精心构造的HTTP请求，利用WSO2文件上传接口的目录遍历漏洞，上传恶意JSP文件，最终导致远程代码执行。

**项目地址:** [cc3305/CVE-2022-29464](https://github.com/cc3305/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #14

**来源**: [CVE-2022-29464-devengpk_CVE-2022-29464.md](../2022/CVE-2022-29464-devengpk_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 严重，允许未经身份验证的攻击者上传恶意文件并在服务器上执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要目标WSO2服务器实例可以通过网络访问，并且存在/fileupload端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞存在于 WSO2 产品中，允许未经授权的文件上传，最终导致远程代码执行。攻击者可以利用 `/fileupload` 端点，通过 `Content-Disposition` 头部进行目录遍历，将恶意 JSP 文件上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录等位置。由于 `/fileupload` 路由未受到身份验证的保护，攻击者无需登录即可利用此漏洞。

**利用方式：**
1.  攻击者构造包含恶意 JSP 代码的文件。
2.  攻击者向 `/fileupload` 端点发送包含 `Content-Disposition` 头部，进行目录遍历的 HTTP 请求，将恶意 JSP 文件上传到服务器的 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。
3.  服务器处理上传请求，并将恶意 JSP 文件写入目标目录。
4.  攻击者通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码执行，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞利用代码有效。

**投毒风险：**
虽然提供的代码主要描述了漏洞原理，但代码中仍存在小概率潜在的投毒风险。作者可能会在利用代码中添加一些难以察觉的恶意代码，例如反弹 shell 或植入后门等。因此，在使用此类代码时，需要谨慎审查，确保其安全性。初步估计投毒风险为10%。

**项目地址:** [devengpk/CVE-2022-29464](https://github.com/devengpk/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #15

**来源**: [CVE-2022-29464-g0dxing_CVE-2022-29464.md](../2022/CVE-2022-29464-g0dxing_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 `/fileupload` 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 `/fileupload` 端点上传任意文件，通过目录穿越将恶意JSP文件上传到webapps目录下，从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。多个来源都确认了该漏洞的存在和可利用性，并且存在公开的PoC。

**投毒风险：**
PoC 代码本身主要功能是上传 webshell，但是`reverse_jsp`使用了硬编码的`8.tcp.ngrok.io:12508`，存在潜在的风险，如果攻击者修改了这个reverse shell 的地址，有可能反弹shell到攻击者的机器上。虽然`public_key`变量存在，但是代码没有使用，所以可以排除钓鱼风险，综上判断，存在5%的投毒风险。

**利用方式：**
1.  攻击者使用带有目录穿越的 `Content-Disposition` 头构造恶意的POST请求到 `/fileupload` 端点。
2.  请求中包含要上传的恶意JSP文件，目标路径指向Web根目录下的一个可执行JSP的目录，例如 `repository/deployment/server/webapps`。
3.  服务器接收到请求后，由于未对上传的文件类型和目标路径进行充分验证，会将恶意JSP文件写入到指定目录。
4.  攻击者可以通过访问上传的JSP文件，执行其中的恶意代码，实现远程代码执行。

**项目地址:** [g0dxing/CVE-2022-29464](https://github.com/g0dxing/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #16

**来源**: [CVE-2022-29464-gbrsh_CVE-2022-29464.md](../2022/CVE-2022-29464-gbrsh_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传 / 远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，允许未授权的攻击者上传恶意文件并执行任意代码

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标WSO2服务器存在/fileupload endpoint且未进行适当的路径限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的高危漏洞，允许未经身份验证的攻击者通过`/fileupload`端点上传任意文件，从而导致远程代码执行。攻击者利用路径遍历漏洞将恶意JSP文件上传到webapps目录下，例如`../../../../repository/deployment/server/webapps/authenticationendpoint/evil.jsp`。上传成功后，攻击者可以通过访问该JSP文件来执行任意系统命令。提供的POC代码通过构造包含恶意JSP代码的文件上传请求，利用该漏洞。代码首先上传一个包含命令执行功能的JSP文件，然后通过发送带有`cmd`参数的GET请求来执行系统命令。代码中未发现任何隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低。

**漏洞利用方式：**

1.  **文件上传：** 攻击者向目标WSO2服务器的`/fileupload`端点发送POST请求，上传包含恶意JSP代码的文件。Content-Disposition头包含路径遍历序列，将文件上传到webapps目录下。
2.  **代码执行：** 攻击者通过访问上传的JSP文件（例如`/authenticationendpoint/evil.jsp?cmd=whoami`）来执行任意系统命令。服务器执行JSP代码，并将命令执行结果返回给攻击者。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。利用成功与否取决于目标系统是否存在漏洞，是否打补丁，以及是否配置正确。

**搜索引擎结果：**

搜索结果表明，CVE-2022-29464是一个已被广泛利用的漏洞，多个安全厂商发布了关于该漏洞的分析报告和修复建议。有报告指出，该漏洞已被用于安装Cobalt Strike beacons和其他恶意软件。


**项目地址:** [gbrsh/CVE-2022-29464](https://github.com/gbrsh/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #17

**来源**: [CVE-2022-29464-hakivvi_CVE-2022-29464.md](../2022/CVE-2022-29464-hakivvi_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问到WSO2服务器的/fileupload端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 漏洞是一个存在于多个WSO2产品中的严重漏洞，允许未经身份验证的攻击者上传任意文件，进而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。搜索引擎结果中多个链接表明该漏洞已被积极利用，且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要是漏洞原理的分析和描述，并未发现直接的恶意代码。然而，任何公开的漏洞利用代码都存在被修改并植入恶意代码的风险。例如，攻击者可能修改POC，在成功上传JSP后，执行额外的恶意操作，例如下载并执行其他恶意程序。POC中直接包含恶意JSP的可能性较低，但后续利用上传的JSP进行投毒的可能性较高。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞位置：** 受影响的WSO2产品存在`/fileupload`端点，该端点允许未授权的文件上传。
2.  **路径穿越：** 攻击者利用`Content-Disposition`头中的目录遍历序列（例如`../../../../`）将上传的文件写入到Web根目录下的特定位置，如`repository/deployment/server/webapps`。
3.  **上传恶意文件：** 攻击者上传包含恶意代码的JSP文件。
4.  **远程代码执行：**  一旦恶意JSP文件被上传到Web根目录，攻击者可以通过访问该JSP文件来执行服务器上的任意代码。

**项目地址:** [hakivvi/CVE-2022-29464](https://github.com/hakivvi/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #18

**来源**: [CVE-2022-29464-hev0x_CVE-2022-29464.md](../2022/CVE-2022-29464-hev0x_CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致RCE

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要网络访问，目标存在/fileupload端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的任意文件上传漏洞，允许未经授权的攻击者上传恶意文件并执行远程代码。根据漏洞信息和搜索结果，此漏洞利用涉及利用 `/fileupload` 端点，并使用 `Content-Disposition` 头部中的目录遍历序列将文件上传到 Web 根目录下的可访问位置，例如 `../../../../repository/deployment/server/webapps` 目录。POC 代码的工作原理如下：

1.  **定位目标：** 脚本接收包含目标 URL 的文件作为输入。
2.  **构造恶意请求：** 脚本构造一个 POST 请求，使用 `/fileupload/toolsAny` 端点，并在 `files` 参数中包含一个指向恶意 JSP 文件的映射。JSP 文件的内容是一个简单的 WebShell，允许执行任意命令。
3.  **目录遍历：** 脚本使用目录遍历序列 (例如 `../../../../`) 将 JSP 文件上传到 `repository/deployment/server/webapps/authenticationendpoint/megas.jsp` 路径下。 `authenticationendpoint` 是一个常见的 Web 应用目录，`megas.jsp` 是上传的 webshell 文件名。
4.  **执行代码：** 脚本通过访问上传的 JSP WebShell (例如 `/authenticationendpoint/megas.jsp?cmd=id`) 来执行命令。脚本首先尝试执行 `id` 命令以验证漏洞是否成功利用。
5.  **验证与输出：** 如果 `id` 命令执行成功并且返回了 `uid` 信息，脚本会认为目标存在漏洞，并将结果输出到屏幕和文件中。

**投毒风险分析：**

我分析了提供的 POC 代码。该代码的主要功能是利用目录遍历和文件上传漏洞在目标系统上部署一个 webshell，然后通过 webshell 执行系统命令。代码没有发现任何隐藏的、与漏洞利用无关的功能，例如收集用户信息、传播恶意软件或篡改系统配置等。因此，该 POC 代码的投毒风险评估为 0%。

**总结：**

该漏洞利用代码有效，因为它能够利用文件上传漏洞在目标系统上部署和执行恶意代码，从而实现远程代码执行。利用方式清晰，无需身份验证。由于代码只包含漏洞利用逻辑，因此不存在投毒风险。

**项目地址:** [hev0x/CVE-2022-29464](https://github.com/hev0x/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #19

**来源**: [CVE-2022-29464-hupe1980_CVE-2022-29464.md](../2022/CVE-2022-29464-hupe1980_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 产品

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的高危漏洞，它允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，最终导致远程代码执行。该漏洞的利用方式是通过构造包含目录穿越序列的 `Content-Disposition` 头，将恶意 JSP 文件上传到 Web 根目录下的可访问位置，如 `repository/deployment/server/webapps` 目录。上传的 JSP 文件包含执行任意命令的代码。根据提供的漏洞利用代码 `exploit.py`，该脚本通过 POST 请求向目标服务器的 `/fileupload/toolsAny` 端点上传一个包含恶意代码的 JSP 文件。攻击者可以通过访问上传的 JSP 文件来执行任意命令。例如，脚本会将包含一个表单的 JSP shell 上传到 `/authenticationendpoint` 应用目录下。 该代码看起来是直接利用漏洞，没有发现隐藏的恶意代码或者后门，所以投毒风险评估为0%。 搜索引擎结果也表明该漏洞已被广泛利用，并建议用户尽快更新或采取缓解措施。

**项目地址:** [hupe1980/CVE-2022-29464](https://github.com/hupe1980/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #20

**来源**: [CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md](../2022/CVE-2022-29464-hxlxmj_Mass-exploit-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行，系统完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问 /fileupload 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，允许未经授权的文件上传，并最终导致远程代码执行。攻击者利用 `/fileupload` 端点，通过 `Content-Disposition` 头部中的目录遍历序列（如 `../../../../`）将恶意文件上传到 Web 根目录下的可执行目录，例如 `repository/deployment/server/webapps`。上传的文件可以是 JSP、WAR 或其他可执行格式，从而允许攻击者在服务器上执行任意代码。

**漏洞利用方式：**

1.  **确定目标：** 确定运行存在漏洞的 WSO2 产品的目标服务器。
2.  **构造恶意请求：** 构造一个包含恶意文件的 POST 请求，该文件将被上传到 `/fileupload` 端点。请求的 `Content-Disposition` 头部必须包含目录遍历序列，以便将文件放置在 Web 根目录下的可执行目录中。
3.  **上传恶意文件：** 发送构造的请求到目标服务器。服务器会处理请求并将恶意文件上传到指定目录。
4.  **触发代码执行：** 通过访问上传的恶意文件（例如，通过 Web 浏览器），触发服务器执行其中的代码。

**投毒风险分析：**

提供的漏洞利用代码段（`LICENSE`文件）是 GNU GPL 许可证的文本，不包含任何恶意代码或投毒行为。因此，此代码段本身不存在投毒风险。 但是，如果提供的仓库中包含其他payload.jsp或者war,那么会存在投毒风险.根据现有信息，投毒风险为0%。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2022-29464 漏洞利用的有效性很高，该漏洞被广泛利用，并且已经有公开的PoC利用代码。

**项目地址:** [hxlxmj/Mass-exploit-CVE-2022-29464](https://github.com/hxlxmj/Mass-exploit-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #21

**来源**: [CVE-2022-29464-lowkey0808_cve-2022-29464.md](../2022/CVE-2022-29464-lowkey0808_cve-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload endpoint且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 /fileupload 接口上传任意文件，最终导致远程代码执行。攻击者利用 Content-Disposition 头中的目录遍历序列将恶意文件（如 JSP shell）上传到 Web 根目录下的可执行位置，例如 ../../../../repository/deployment/server/webapps 目录。  

**POC分析:**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  **构建Payload:**  脚本允许上传用户自定义的webshell，默认情况下，如果用户没有提供webshell文件,它将上传一个内置的简单的JSP webshell，该webshell接受`cmd`参数并在服务器上执行系统命令。代码中变量`xloq`定义了内置的shell内容。
2.  **发送恶意请求:** 脚本使用`requests`库向目标URL的`/fileupload/toolsAny` endpoint发送POST请求，其中包含精心构造的`files`参数，利用目录遍历将webshell上传到`/repository/deployment/server/webapps/authenticationendpoint/`目录下，文件名为`shell.jsp`或者用户指定的文件名。
3.  **利用上传的webshell:** 如果上传成功，默认的webshell将通过构造URL（如`/authenticationendpoint/shell.jsp?cmd=whoami`）来执行命令，并打印命令执行结果。用户自定义上传的webshell将会直接返回webshell的URL地址,方便使用.

**有效性:**

根据漏洞库信息、搜索结果和提供的POC代码，可以判断该POC代码是有效的。 多个搜索结果表明该漏洞已被积极利用。

**投毒风险:**

仔细审查了POC代码，该代码主要功能是利用漏洞上传webshell并执行命令。没有发现作者隐藏的恶意代码或者后门。因此，认为投毒风险为0%。

**利用方式:**

1.  确定目标WSO2产品存在CVE-2022-29464漏洞。
2.  使用POC脚本，指定目标URL。
3.  POC脚本利用`/fileupload/toolsAny`接口，通过构造包含目录遍历的`Content-Disposition`头部的POST请求，将webshell上传到服务器的`/repository/deployment/server/webapps/authenticationendpoint/`目录下。
4.  通过访问上传的webshell（例如 `/authenticationendpoint/shell.jsp?cmd=command`）执行任意命令。

**项目地址:** [lowkey0808/cve-2022-29464](https://github.com/lowkey0808/cve-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #22

**来源**: [CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md](../2022/CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传

**影响应用:** WSO2 API Manager, WSO2 Identity Server, WSO2 Enterprise Integrator, WSO2 Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个未限制文件上传漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。攻击者利用 `/fileupload` 接口，通过构造包含目录遍历序列 `../../../../` 的 `Content-Disposition` 头，将恶意文件（如 JSP webshell）上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录。成功上传后，攻击者可以通过访问该恶意文件来执行任意代码。根据提供的POC代码，`exploit.py` 脚本首先创建一个包含恶意代码的 `cmd.jsp` 文件，然后使用 `requests` 库向目标 WSO2 服务器的 `/fileupload/toolsAny` 接口发送 POST 请求，上传该文件。如果上传成功，则会在目标服务器的 `user-portal` 目录下创建一个可执行命令的webshell `cmd.jsp`，攻击者可以通过访问 `user-portal/cmd.jsp?cmd=<command>` 来执行任意命令。根据搜索引擎结果，此漏洞已被积极利用，建议尽快修复。POC代码中未发现明显的投毒迹象，其功能明确为上传webshell并执行命令。因此，投毒风险为 0%。

**项目地址:** [mr-r3bot/WSO2-CVE-2022-29464](https://github.com/mr-r3bot/WSO2-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #23

**来源**: [CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md](../2022/CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器的/fileupload endpoint，目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，从而导致远程代码执行。漏洞利用的关键在于使用 `Content-Disposition` 头中的目录遍历序列，将恶意文件上传到 Web 根目录下的可执行路径，例如 `../../../../repository/deployment/server/webapps`。 

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（如 JSP webshell）的文件。
2.  攻击者利用 `/fileupload` 端点上传该恶意文件，并在 `Content-Disposition` 头中包含目录遍历序列，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`，其中 `shell.jsp` 为攻击者上传的恶意文件。
3.  服务器将文件上传到指定路径。
4.  攻击者通过访问上传的文件（例如 `https://host/authenticationendpoint/shell.jsp`）来执行恶意代码。

**POC 代码分析：**

提供的 Python 脚本 `exploit.py` 实现了上述利用过程。

*   脚本接受 WSO2 服务器地址和 webshell 文件名作为参数。
*   脚本构造一个包含 JSP webshell 内容的字典 `files`。  JSP webshell允许通过GET请求的`cmd`参数执行任意命令. 这是一个功能后门，而非投毒代码.
*   脚本使用 `requests.post` 函数向 `/fileupload/toolsAny` 端点发送 POST 请求，上传 webshell 文件，并通过目录遍历将其放置到 `authenticationendpoint` 目录下。
*   脚本输出 webshell 的访问 URL。

**有效性评估：**

根据漏洞描述和 POC 代码，此漏洞利用方法是有效的。多个来源证实了此漏洞的存在和可利用性（如 Trend Micro, Rapid7, Arctic Wolf 等）。

**投毒风险评估：**

代码本身主要是一个漏洞利用工具，用于上传和执行 webshell。**投毒风险较低，约为 10%**。尽管如此，仍需要注意以下潜在风险：

*   **代码托管平台的安全性：**如果该代码是从非官方、信誉差的平台下载，可能存在被篡改的风险。
*   **依赖项风险：**该脚本依赖于 `requests` 和 `urllib3` 库。如果这些库本身存在安全漏洞或被恶意篡改，可能会引入安全风险。
*   **作者意图：**虽然代码的主要功能是漏洞利用，但作者可能在代码中隐藏其他恶意功能，例如收集目标系统信息或安装后门。虽然当前代码未发现明显投毒行为, 但不能完全排除.

**结论：**

此漏洞的利用方法是有效的，可以导致远程代码执行。在使用此 POC 代码时，应注意潜在的投毒风险，并从可信来源获取代码。

**项目地址:** [n3rdh4x0r/CVE-2022-29464](https://github.com/n3rdh4x0r/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #24

**来源**: [CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md](../2022/CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器存在/fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的严重漏洞，允许未经授权的攻击者上传任意文件，并最终导致远程代码执行。根据漏洞描述和搜索结果，攻击者可以通过`/fileupload`端点，利用`Content-Disposition`头中的目录遍历序列，将恶意文件上传到Web根目录下的可执行位置，例如`../../../../repository/deployment/server/webapps`目录。  

提供的POC代码包含两个python脚本：`deface.py` 和 `shell.py`。 `shell.py`会上传一个包含命令执行功能的jsp文件，`deface.py`上传任意文件。  

**有效性：**  根据漏洞描述和POC代码，该漏洞的利用方式是有效的。POC代码通过构造包含目录遍历的请求，将恶意JSP文件上传到服务器的webapps目录下，从而实现远程代码执行。脚本使用了requests库发送POST请求，并禁用SSL验证，绕过证书校验。

**投毒风险：** 提供的代码较为简洁，主要功能是利用漏洞上传恶意文件。 虽然存在使用`requests.post(f'{host}/fileupload/toolsAny', files=files, verify=False)`语句, 禁用SSL证书验证，但这是为了POC的通用性，方便在各种环境下测试，不一定是投毒行为。由于没有发现明显的恶意代码或后门，因此投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者利用`fileupload`端点。
2.  在POST请求的`Content-Disposition`头中构造目录遍历序列（例如`../../../../`）。
3.  将恶意JSP文件（或其他服务器支持的脚本文件）上传到`repository/deployment/server/webapps`目录或其他Web根目录下的可执行位置。
4.  通过Web浏览器访问上传的JSP文件，执行任意命令。

**项目地址:** [r4x0r1337/-CVE-2022-29464](https://github.com/r4x0r1337/-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #25

**来源**: [CVE-2022-29464-superzerosec_CVE-2022-29464.md](../2022/CVE-2022-29464-superzerosec_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload端点，且未进行适当的文件上传限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。该漏洞的核心在于 `/fileupload` 端点缺乏适当的验证机制，攻击者可以通过构造包含目录遍历序列（如 `../../../../`）的 `Content-Disposition` 头来将恶意文件上传到 Web 根目录下的任意位置，例如 `repository/deployment/server/webapps` 目录。 

**利用方式：**

1.  **发送恶意文件上传请求：** 攻击者构造一个包含恶意 JSP webshell 的 HTTP POST 请求，该请求的目标是 `/fileupload` 端点。在请求头中，`Content-Disposition` 字段被设置为包含目录遍历序列，以便将文件上传到 `repository/deployment/server/webapps/authenticationendpoint` 目录下。
2.  **绕过文件类型限制（如果存在）：** 某些 WSO2 产品可能存在文件类型验证，但通常可以通过修改文件名或 Content-Type 头来绕过这些限制。
3.  **访问上传的 Webshell：** 成功上传 Webshell 后，攻击者可以通过 Web 浏览器访问该 Webshell，从而在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码是有效的。代码首先定义了一个 JSP webshell，然后构造一个 HTTP POST 请求，利用目录遍历漏洞将该 webshell 上传到目标服务器的 `authenticationendpoint` 目录下。最后，攻击者可以通过访问上传的 webshell 来执行命令。

**投毒风险评估：**

经过分析，提供的 POC 代码本身**没有明显的投毒代码**。webshell 的内容是直接嵌入在脚本中的，功能是执行用户通过 HTTP 请求传递的命令。风险评估为0%。


**项目地址:** [superzerosec/CVE-2022-29464](https://github.com/superzerosec/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---



---

## POC #22

**来源**: [CVE-2022-29464-lowkey0808_cve-2022-29464.md](../2022/CVE-2022-29464-lowkey0808_cve-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload endpoint且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 /fileupload 接口上传任意文件，最终导致远程代码执行。攻击者利用 Content-Disposition 头中的目录遍历序列将恶意文件（如 JSP shell）上传到 Web 根目录下的可执行位置，例如 ../../../../repository/deployment/server/webapps 目录。  

**POC分析:**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  **构建Payload:**  脚本允许上传用户自定义的webshell，默认情况下，如果用户没有提供webshell文件,它将上传一个内置的简单的JSP webshell，该webshell接受`cmd`参数并在服务器上执行系统命令。代码中变量`xloq`定义了内置的shell内容。
2.  **发送恶意请求:** 脚本使用`requests`库向目标URL的`/fileupload/toolsAny` endpoint发送POST请求，其中包含精心构造的`files`参数，利用目录遍历将webshell上传到`/repository/deployment/server/webapps/authenticationendpoint/`目录下，文件名为`shell.jsp`或者用户指定的文件名。
3.  **利用上传的webshell:** 如果上传成功，默认的webshell将通过构造URL（如`/authenticationendpoint/shell.jsp?cmd=whoami`）来执行命令，并打印命令执行结果。用户自定义上传的webshell将会直接返回webshell的URL地址,方便使用.

**有效性:**

根据漏洞库信息、搜索结果和提供的POC代码，可以判断该POC代码是有效的。 多个搜索结果表明该漏洞已被积极利用。

**投毒风险:**

仔细审查了POC代码，该代码主要功能是利用漏洞上传webshell并执行命令。没有发现作者隐藏的恶意代码或者后门。因此，认为投毒风险为0%。

**利用方式:**

1.  确定目标WSO2产品存在CVE-2022-29464漏洞。
2.  使用POC脚本，指定目标URL。
3.  POC脚本利用`/fileupload/toolsAny`接口，通过构造包含目录遍历的`Content-Disposition`头部的POST请求，将webshell上传到服务器的`/repository/deployment/server/webapps/authenticationendpoint/`目录下。
4.  通过访问上传的webshell（例如 `/authenticationendpoint/shell.jsp?cmd=command`）执行任意命令。

**项目地址:** [lowkey0808/cve-2022-29464](https://github.com/lowkey0808/cve-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #23

**来源**: [CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md](../2022/CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传

**影响应用:** WSO2 API Manager, WSO2 Identity Server, WSO2 Enterprise Integrator, WSO2 Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个未限制文件上传漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。攻击者利用 `/fileupload` 接口，通过构造包含目录遍历序列 `../../../../` 的 `Content-Disposition` 头，将恶意文件（如 JSP webshell）上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录。成功上传后，攻击者可以通过访问该恶意文件来执行任意代码。根据提供的POC代码，`exploit.py` 脚本首先创建一个包含恶意代码的 `cmd.jsp` 文件，然后使用 `requests` 库向目标 WSO2 服务器的 `/fileupload/toolsAny` 接口发送 POST 请求，上传该文件。如果上传成功，则会在目标服务器的 `user-portal` 目录下创建一个可执行命令的webshell `cmd.jsp`，攻击者可以通过访问 `user-portal/cmd.jsp?cmd=<command>` 来执行任意命令。根据搜索引擎结果，此漏洞已被积极利用，建议尽快修复。POC代码中未发现明显的投毒迹象，其功能明确为上传webshell并执行命令。因此，投毒风险为 0%。

**项目地址:** [mr-r3bot/WSO2-CVE-2022-29464](https://github.com/mr-r3bot/WSO2-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #24

**来源**: [CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md](../2022/CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器的/fileupload endpoint，目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，从而导致远程代码执行。漏洞利用的关键在于使用 `Content-Disposition` 头中的目录遍历序列，将恶意文件上传到 Web 根目录下的可执行路径，例如 `../../../../repository/deployment/server/webapps`。 

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（如 JSP webshell）的文件。
2.  攻击者利用 `/fileupload` 端点上传该恶意文件，并在 `Content-Disposition` 头中包含目录遍历序列，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`，其中 `shell.jsp` 为攻击者上传的恶意文件。
3.  服务器将文件上传到指定路径。
4.  攻击者通过访问上传的文件（例如 `https://host/authenticationendpoint/shell.jsp`）来执行恶意代码。

**POC 代码分析：**

提供的 Python 脚本 `exploit.py` 实现了上述利用过程。

*   脚本接受 WSO2 服务器地址和 webshell 文件名作为参数。
*   脚本构造一个包含 JSP webshell 内容的字典 `files`。  JSP webshell允许通过GET请求的`cmd`参数执行任意命令. 这是一个功能后门，而非投毒代码.
*   脚本使用 `requests.post` 函数向 `/fileupload/toolsAny` 端点发送 POST 请求，上传 webshell 文件，并通过目录遍历将其放置到 `authenticationendpoint` 目录下。
*   脚本输出 webshell 的访问 URL。

**有效性评估：**

根据漏洞描述和 POC 代码，此漏洞利用方法是有效的。多个来源证实了此漏洞的存在和可利用性（如 Trend Micro, Rapid7, Arctic Wolf 等）。

**投毒风险评估：**

代码本身主要是一个漏洞利用工具，用于上传和执行 webshell。**投毒风险较低，约为 10%**。尽管如此，仍需要注意以下潜在风险：

*   **代码托管平台的安全性：**如果该代码是从非官方、信誉差的平台下载，可能存在被篡改的风险。
*   **依赖项风险：**该脚本依赖于 `requests` 和 `urllib3` 库。如果这些库本身存在安全漏洞或被恶意篡改，可能会引入安全风险。
*   **作者意图：**虽然代码的主要功能是漏洞利用，但作者可能在代码中隐藏其他恶意功能，例如收集目标系统信息或安装后门。虽然当前代码未发现明显投毒行为, 但不能完全排除.

**结论：**

此漏洞的利用方法是有效的，可以导致远程代码执行。在使用此 POC 代码时，应注意潜在的投毒风险，并从可信来源获取代码。

**项目地址:** [n3rdh4x0r/CVE-2022-29464](https://github.com/n3rdh4x0r/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #25

**来源**: [CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md](../2022/CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器存在/fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的严重漏洞，允许未经授权的攻击者上传任意文件，并最终导致远程代码执行。根据漏洞描述和搜索结果，攻击者可以通过`/fileupload`端点，利用`Content-Disposition`头中的目录遍历序列，将恶意文件上传到Web根目录下的可执行位置，例如`../../../../repository/deployment/server/webapps`目录。  

提供的POC代码包含两个python脚本：`deface.py` 和 `shell.py`。 `shell.py`会上传一个包含命令执行功能的jsp文件，`deface.py`上传任意文件。  

**有效性：**  根据漏洞描述和POC代码，该漏洞的利用方式是有效的。POC代码通过构造包含目录遍历的请求，将恶意JSP文件上传到服务器的webapps目录下，从而实现远程代码执行。脚本使用了requests库发送POST请求，并禁用SSL验证，绕过证书校验。

**投毒风险：** 提供的代码较为简洁，主要功能是利用漏洞上传恶意文件。 虽然存在使用`requests.post(f'{host}/fileupload/toolsAny', files=files, verify=False)`语句, 禁用SSL证书验证，但这是为了POC的通用性，方便在各种环境下测试，不一定是投毒行为。由于没有发现明显的恶意代码或后门，因此投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者利用`fileupload`端点。
2.  在POST请求的`Content-Disposition`头中构造目录遍历序列（例如`../../../../`）。
3.  将恶意JSP文件（或其他服务器支持的脚本文件）上传到`repository/deployment/server/webapps`目录或其他Web根目录下的可执行位置。
4.  通过Web浏览器访问上传的JSP文件，执行任意命令。

**项目地址:** [r4x0r1337/-CVE-2022-29464](https://github.com/r4x0r1337/-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #26

**来源**: [CVE-2022-29464-superzerosec_CVE-2022-29464.md](../2022/CVE-2022-29464-superzerosec_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload端点，且未进行适当的文件上传限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。该漏洞的核心在于 `/fileupload` 端点缺乏适当的验证机制，攻击者可以通过构造包含目录遍历序列（如 `../../../../`）的 `Content-Disposition` 头来将恶意文件上传到 Web 根目录下的任意位置，例如 `repository/deployment/server/webapps` 目录。 

**利用方式：**

1.  **发送恶意文件上传请求：** 攻击者构造一个包含恶意 JSP webshell 的 HTTP POST 请求，该请求的目标是 `/fileupload` 端点。在请求头中，`Content-Disposition` 字段被设置为包含目录遍历序列，以便将文件上传到 `repository/deployment/server/webapps/authenticationendpoint` 目录下。
2.  **绕过文件类型限制（如果存在）：** 某些 WSO2 产品可能存在文件类型验证，但通常可以通过修改文件名或 Content-Type 头来绕过这些限制。
3.  **访问上传的 Webshell：** 成功上传 Webshell 后，攻击者可以通过 Web 浏览器访问该 Webshell，从而在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码是有效的。代码首先定义了一个 JSP webshell，然后构造一个 HTTP POST 请求，利用目录遍历漏洞将该 webshell 上传到目标服务器的 `authenticationendpoint` 目录下。最后，攻击者可以通过访问上传的 webshell 来执行命令。

**投毒风险评估：**

经过分析，提供的 POC 代码本身**没有明显的投毒代码**。webshell 的内容是直接嵌入在脚本中的，功能是执行用户通过 HTTP 请求传递的命令。风险评估为0%。


**项目地址:** [superzerosec/CVE-2022-29464](https://github.com/superzerosec/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---



---

## POC #22

**来源**: [CVE-2022-29464-lowkey0808_cve-2022-29464.md](../2022/CVE-2022-29464-lowkey0808_cve-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload endpoint且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 /fileupload 接口上传任意文件，最终导致远程代码执行。攻击者利用 Content-Disposition 头中的目录遍历序列将恶意文件（如 JSP shell）上传到 Web 根目录下的可执行位置，例如 ../../../../repository/deployment/server/webapps 目录。  

**POC分析:**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  **构建Payload:**  脚本允许上传用户自定义的webshell，默认情况下，如果用户没有提供webshell文件,它将上传一个内置的简单的JSP webshell，该webshell接受`cmd`参数并在服务器上执行系统命令。代码中变量`xloq`定义了内置的shell内容。
2.  **发送恶意请求:** 脚本使用`requests`库向目标URL的`/fileupload/toolsAny` endpoint发送POST请求，其中包含精心构造的`files`参数，利用目录遍历将webshell上传到`/repository/deployment/server/webapps/authenticationendpoint/`目录下，文件名为`shell.jsp`或者用户指定的文件名。
3.  **利用上传的webshell:** 如果上传成功，默认的webshell将通过构造URL（如`/authenticationendpoint/shell.jsp?cmd=whoami`）来执行命令，并打印命令执行结果。用户自定义上传的webshell将会直接返回webshell的URL地址,方便使用.

**有效性:**

根据漏洞库信息、搜索结果和提供的POC代码，可以判断该POC代码是有效的。 多个搜索结果表明该漏洞已被积极利用。

**投毒风险:**

仔细审查了POC代码，该代码主要功能是利用漏洞上传webshell并执行命令。没有发现作者隐藏的恶意代码或者后门。因此，认为投毒风险为0%。

**利用方式:**

1.  确定目标WSO2产品存在CVE-2022-29464漏洞。
2.  使用POC脚本，指定目标URL。
3.  POC脚本利用`/fileupload/toolsAny`接口，通过构造包含目录遍历的`Content-Disposition`头部的POST请求，将webshell上传到服务器的`/repository/deployment/server/webapps/authenticationendpoint/`目录下。
4.  通过访问上传的webshell（例如 `/authenticationendpoint/shell.jsp?cmd=command`）执行任意命令。

**项目地址:** [lowkey0808/cve-2022-29464](https://github.com/lowkey0808/cve-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #23

**来源**: [CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md](../2022/CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传

**影响应用:** WSO2 API Manager, WSO2 Identity Server, WSO2 Enterprise Integrator, WSO2 Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个未限制文件上传漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。攻击者利用 `/fileupload` 接口，通过构造包含目录遍历序列 `../../../../` 的 `Content-Disposition` 头，将恶意文件（如 JSP webshell）上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录。成功上传后，攻击者可以通过访问该恶意文件来执行任意代码。根据提供的POC代码，`exploit.py` 脚本首先创建一个包含恶意代码的 `cmd.jsp` 文件，然后使用 `requests` 库向目标 WSO2 服务器的 `/fileupload/toolsAny` 接口发送 POST 请求，上传该文件。如果上传成功，则会在目标服务器的 `user-portal` 目录下创建一个可执行命令的webshell `cmd.jsp`，攻击者可以通过访问 `user-portal/cmd.jsp?cmd=<command>` 来执行任意命令。根据搜索引擎结果，此漏洞已被积极利用，建议尽快修复。POC代码中未发现明显的投毒迹象，其功能明确为上传webshell并执行命令。因此，投毒风险为 0%。

**项目地址:** [mr-r3bot/WSO2-CVE-2022-29464](https://github.com/mr-r3bot/WSO2-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #24

**来源**: [CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md](../2022/CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器的/fileupload endpoint，目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，从而导致远程代码执行。漏洞利用的关键在于使用 `Content-Disposition` 头中的目录遍历序列，将恶意文件上传到 Web 根目录下的可执行路径，例如 `../../../../repository/deployment/server/webapps`。 

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（如 JSP webshell）的文件。
2.  攻击者利用 `/fileupload` 端点上传该恶意文件，并在 `Content-Disposition` 头中包含目录遍历序列，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`，其中 `shell.jsp` 为攻击者上传的恶意文件。
3.  服务器将文件上传到指定路径。
4.  攻击者通过访问上传的文件（例如 `https://host/authenticationendpoint/shell.jsp`）来执行恶意代码。

**POC 代码分析：**

提供的 Python 脚本 `exploit.py` 实现了上述利用过程。

*   脚本接受 WSO2 服务器地址和 webshell 文件名作为参数。
*   脚本构造一个包含 JSP webshell 内容的字典 `files`。  JSP webshell允许通过GET请求的`cmd`参数执行任意命令. 这是一个功能后门，而非投毒代码.
*   脚本使用 `requests.post` 函数向 `/fileupload/toolsAny` 端点发送 POST 请求，上传 webshell 文件，并通过目录遍历将其放置到 `authenticationendpoint` 目录下。
*   脚本输出 webshell 的访问 URL。

**有效性评估：**

根据漏洞描述和 POC 代码，此漏洞利用方法是有效的。多个来源证实了此漏洞的存在和可利用性（如 Trend Micro, Rapid7, Arctic Wolf 等）。

**投毒风险评估：**

代码本身主要是一个漏洞利用工具，用于上传和执行 webshell。**投毒风险较低，约为 10%**。尽管如此，仍需要注意以下潜在风险：

*   **代码托管平台的安全性：**如果该代码是从非官方、信誉差的平台下载，可能存在被篡改的风险。
*   **依赖项风险：**该脚本依赖于 `requests` 和 `urllib3` 库。如果这些库本身存在安全漏洞或被恶意篡改，可能会引入安全风险。
*   **作者意图：**虽然代码的主要功能是漏洞利用，但作者可能在代码中隐藏其他恶意功能，例如收集目标系统信息或安装后门。虽然当前代码未发现明显投毒行为, 但不能完全排除.

**结论：**

此漏洞的利用方法是有效的，可以导致远程代码执行。在使用此 POC 代码时，应注意潜在的投毒风险，并从可信来源获取代码。

**项目地址:** [n3rdh4x0r/CVE-2022-29464](https://github.com/n3rdh4x0r/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #25

**来源**: [CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md](../2022/CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器存在/fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的严重漏洞，允许未经授权的攻击者上传任意文件，并最终导致远程代码执行。根据漏洞描述和搜索结果，攻击者可以通过`/fileupload`端点，利用`Content-Disposition`头中的目录遍历序列，将恶意文件上传到Web根目录下的可执行位置，例如`../../../../repository/deployment/server/webapps`目录。  

提供的POC代码包含两个python脚本：`deface.py` 和 `shell.py`。 `shell.py`会上传一个包含命令执行功能的jsp文件，`deface.py`上传任意文件。  

**有效性：**  根据漏洞描述和POC代码，该漏洞的利用方式是有效的。POC代码通过构造包含目录遍历的请求，将恶意JSP文件上传到服务器的webapps目录下，从而实现远程代码执行。脚本使用了requests库发送POST请求，并禁用SSL验证，绕过证书校验。

**投毒风险：** 提供的代码较为简洁，主要功能是利用漏洞上传恶意文件。 虽然存在使用`requests.post(f'{host}/fileupload/toolsAny', files=files, verify=False)`语句, 禁用SSL证书验证，但这是为了POC的通用性，方便在各种环境下测试，不一定是投毒行为。由于没有发现明显的恶意代码或后门，因此投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者利用`fileupload`端点。
2.  在POST请求的`Content-Disposition`头中构造目录遍历序列（例如`../../../../`）。
3.  将恶意JSP文件（或其他服务器支持的脚本文件）上传到`repository/deployment/server/webapps`目录或其他Web根目录下的可执行位置。
4.  通过Web浏览器访问上传的JSP文件，执行任意命令。

**项目地址:** [r4x0r1337/-CVE-2022-29464](https://github.com/r4x0r1337/-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #26

**来源**: [CVE-2022-29464-superzerosec_CVE-2022-29464.md](../2022/CVE-2022-29464-superzerosec_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload端点，且未进行适当的文件上传限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。该漏洞的核心在于 `/fileupload` 端点缺乏适当的验证机制，攻击者可以通过构造包含目录遍历序列（如 `../../../../`）的 `Content-Disposition` 头来将恶意文件上传到 Web 根目录下的任意位置，例如 `repository/deployment/server/webapps` 目录。 

**利用方式：**

1.  **发送恶意文件上传请求：** 攻击者构造一个包含恶意 JSP webshell 的 HTTP POST 请求，该请求的目标是 `/fileupload` 端点。在请求头中，`Content-Disposition` 字段被设置为包含目录遍历序列，以便将文件上传到 `repository/deployment/server/webapps/authenticationendpoint` 目录下。
2.  **绕过文件类型限制（如果存在）：** 某些 WSO2 产品可能存在文件类型验证，但通常可以通过修改文件名或 Content-Type 头来绕过这些限制。
3.  **访问上传的 Webshell：** 成功上传 Webshell 后，攻击者可以通过 Web 浏览器访问该 Webshell，从而在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码是有效的。代码首先定义了一个 JSP webshell，然后构造一个 HTTP POST 请求，利用目录遍历漏洞将该 webshell 上传到目标服务器的 `authenticationendpoint` 目录下。最后，攻击者可以通过访问上传的 webshell 来执行命令。

**投毒风险评估：**

经过分析，提供的 POC 代码本身**没有明显的投毒代码**。webshell 的内容是直接嵌入在脚本中的，功能是执行用户通过 HTTP 请求传递的命令。风险评估为0%。


**项目地址:** [superzerosec/CVE-2022-29464](https://github.com/superzerosec/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---



---

## POC #22

**来源**: [CVE-2022-29464-lowkey0808_cve-2022-29464.md](../2022/CVE-2022-29464-lowkey0808_cve-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload endpoint且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 /fileupload 接口上传任意文件，最终导致远程代码执行。攻击者利用 Content-Disposition 头中的目录遍历序列将恶意文件（如 JSP shell）上传到 Web 根目录下的可执行位置，例如 ../../../../repository/deployment/server/webapps 目录。  

**POC分析:**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  **构建Payload:**  脚本允许上传用户自定义的webshell，默认情况下，如果用户没有提供webshell文件,它将上传一个内置的简单的JSP webshell，该webshell接受`cmd`参数并在服务器上执行系统命令。代码中变量`xloq`定义了内置的shell内容。
2.  **发送恶意请求:** 脚本使用`requests`库向目标URL的`/fileupload/toolsAny` endpoint发送POST请求，其中包含精心构造的`files`参数，利用目录遍历将webshell上传到`/repository/deployment/server/webapps/authenticationendpoint/`目录下，文件名为`shell.jsp`或者用户指定的文件名。
3.  **利用上传的webshell:** 如果上传成功，默认的webshell将通过构造URL（如`/authenticationendpoint/shell.jsp?cmd=whoami`）来执行命令，并打印命令执行结果。用户自定义上传的webshell将会直接返回webshell的URL地址,方便使用.

**有效性:**

根据漏洞库信息、搜索结果和提供的POC代码，可以判断该POC代码是有效的。 多个搜索结果表明该漏洞已被积极利用。

**投毒风险:**

仔细审查了POC代码，该代码主要功能是利用漏洞上传webshell并执行命令。没有发现作者隐藏的恶意代码或者后门。因此，认为投毒风险为0%。

**利用方式:**

1.  确定目标WSO2产品存在CVE-2022-29464漏洞。
2.  使用POC脚本，指定目标URL。
3.  POC脚本利用`/fileupload/toolsAny`接口，通过构造包含目录遍历的`Content-Disposition`头部的POST请求，将webshell上传到服务器的`/repository/deployment/server/webapps/authenticationendpoint/`目录下。
4.  通过访问上传的webshell（例如 `/authenticationendpoint/shell.jsp?cmd=command`）执行任意命令。

**项目地址:** [lowkey0808/cve-2022-29464](https://github.com/lowkey0808/cve-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #23

**来源**: [CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md](../2022/CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传

**影响应用:** WSO2 API Manager, WSO2 Identity Server, WSO2 Enterprise Integrator, WSO2 Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个未限制文件上传漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。攻击者利用 `/fileupload` 接口，通过构造包含目录遍历序列 `../../../../` 的 `Content-Disposition` 头，将恶意文件（如 JSP webshell）上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录。成功上传后，攻击者可以通过访问该恶意文件来执行任意代码。根据提供的POC代码，`exploit.py` 脚本首先创建一个包含恶意代码的 `cmd.jsp` 文件，然后使用 `requests` 库向目标 WSO2 服务器的 `/fileupload/toolsAny` 接口发送 POST 请求，上传该文件。如果上传成功，则会在目标服务器的 `user-portal` 目录下创建一个可执行命令的webshell `cmd.jsp`，攻击者可以通过访问 `user-portal/cmd.jsp?cmd=<command>` 来执行任意命令。根据搜索引擎结果，此漏洞已被积极利用，建议尽快修复。POC代码中未发现明显的投毒迹象，其功能明确为上传webshell并执行命令。因此，投毒风险为 0%。

**项目地址:** [mr-r3bot/WSO2-CVE-2022-29464](https://github.com/mr-r3bot/WSO2-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #24

**来源**: [CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md](../2022/CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器的/fileupload endpoint，目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，从而导致远程代码执行。漏洞利用的关键在于使用 `Content-Disposition` 头中的目录遍历序列，将恶意文件上传到 Web 根目录下的可执行路径，例如 `../../../../repository/deployment/server/webapps`。 

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（如 JSP webshell）的文件。
2.  攻击者利用 `/fileupload` 端点上传该恶意文件，并在 `Content-Disposition` 头中包含目录遍历序列，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`，其中 `shell.jsp` 为攻击者上传的恶意文件。
3.  服务器将文件上传到指定路径。
4.  攻击者通过访问上传的文件（例如 `https://host/authenticationendpoint/shell.jsp`）来执行恶意代码。

**POC 代码分析：**

提供的 Python 脚本 `exploit.py` 实现了上述利用过程。

*   脚本接受 WSO2 服务器地址和 webshell 文件名作为参数。
*   脚本构造一个包含 JSP webshell 内容的字典 `files`。  JSP webshell允许通过GET请求的`cmd`参数执行任意命令. 这是一个功能后门，而非投毒代码.
*   脚本使用 `requests.post` 函数向 `/fileupload/toolsAny` 端点发送 POST 请求，上传 webshell 文件，并通过目录遍历将其放置到 `authenticationendpoint` 目录下。
*   脚本输出 webshell 的访问 URL。

**有效性评估：**

根据漏洞描述和 POC 代码，此漏洞利用方法是有效的。多个来源证实了此漏洞的存在和可利用性（如 Trend Micro, Rapid7, Arctic Wolf 等）。

**投毒风险评估：**

代码本身主要是一个漏洞利用工具，用于上传和执行 webshell。**投毒风险较低，约为 10%**。尽管如此，仍需要注意以下潜在风险：

*   **代码托管平台的安全性：**如果该代码是从非官方、信誉差的平台下载，可能存在被篡改的风险。
*   **依赖项风险：**该脚本依赖于 `requests` 和 `urllib3` 库。如果这些库本身存在安全漏洞或被恶意篡改，可能会引入安全风险。
*   **作者意图：**虽然代码的主要功能是漏洞利用，但作者可能在代码中隐藏其他恶意功能，例如收集目标系统信息或安装后门。虽然当前代码未发现明显投毒行为, 但不能完全排除.

**结论：**

此漏洞的利用方法是有效的，可以导致远程代码执行。在使用此 POC 代码时，应注意潜在的投毒风险，并从可信来源获取代码。

**项目地址:** [n3rdh4x0r/CVE-2022-29464](https://github.com/n3rdh4x0r/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #25

**来源**: [CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md](../2022/CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器存在/fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的严重漏洞，允许未经授权的攻击者上传任意文件，并最终导致远程代码执行。根据漏洞描述和搜索结果，攻击者可以通过`/fileupload`端点，利用`Content-Disposition`头中的目录遍历序列，将恶意文件上传到Web根目录下的可执行位置，例如`../../../../repository/deployment/server/webapps`目录。  

提供的POC代码包含两个python脚本：`deface.py` 和 `shell.py`。 `shell.py`会上传一个包含命令执行功能的jsp文件，`deface.py`上传任意文件。  

**有效性：**  根据漏洞描述和POC代码，该漏洞的利用方式是有效的。POC代码通过构造包含目录遍历的请求，将恶意JSP文件上传到服务器的webapps目录下，从而实现远程代码执行。脚本使用了requests库发送POST请求，并禁用SSL验证，绕过证书校验。

**投毒风险：** 提供的代码较为简洁，主要功能是利用漏洞上传恶意文件。 虽然存在使用`requests.post(f'{host}/fileupload/toolsAny', files=files, verify=False)`语句, 禁用SSL证书验证，但这是为了POC的通用性，方便在各种环境下测试，不一定是投毒行为。由于没有发现明显的恶意代码或后门，因此投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者利用`fileupload`端点。
2.  在POST请求的`Content-Disposition`头中构造目录遍历序列（例如`../../../../`）。
3.  将恶意JSP文件（或其他服务器支持的脚本文件）上传到`repository/deployment/server/webapps`目录或其他Web根目录下的可执行位置。
4.  通过Web浏览器访问上传的JSP文件，执行任意命令。

**项目地址:** [r4x0r1337/-CVE-2022-29464](https://github.com/r4x0r1337/-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #26

**来源**: [CVE-2022-29464-superzerosec_CVE-2022-29464.md](../2022/CVE-2022-29464-superzerosec_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload端点，且未进行适当的文件上传限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。该漏洞的核心在于 `/fileupload` 端点缺乏适当的验证机制，攻击者可以通过构造包含目录遍历序列（如 `../../../../`）的 `Content-Disposition` 头来将恶意文件上传到 Web 根目录下的任意位置，例如 `repository/deployment/server/webapps` 目录。 

**利用方式：**

1.  **发送恶意文件上传请求：** 攻击者构造一个包含恶意 JSP webshell 的 HTTP POST 请求，该请求的目标是 `/fileupload` 端点。在请求头中，`Content-Disposition` 字段被设置为包含目录遍历序列，以便将文件上传到 `repository/deployment/server/webapps/authenticationendpoint` 目录下。
2.  **绕过文件类型限制（如果存在）：** 某些 WSO2 产品可能存在文件类型验证，但通常可以通过修改文件名或 Content-Type 头来绕过这些限制。
3.  **访问上传的 Webshell：** 成功上传 Webshell 后，攻击者可以通过 Web 浏览器访问该 Webshell，从而在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码是有效的。代码首先定义了一个 JSP webshell，然后构造一个 HTTP POST 请求，利用目录遍历漏洞将该 webshell 上传到目标服务器的 `authenticationendpoint` 目录下。最后，攻击者可以通过访问上传的 webshell 来执行命令。

**投毒风险评估：**

经过分析，提供的 POC 代码本身**没有明显的投毒代码**。webshell 的内容是直接嵌入在脚本中的，功能是执行用户通过 HTTP 请求传递的命令。风险评估为0%。


**项目地址:** [superzerosec/CVE-2022-29464](https://github.com/superzerosec/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---



---

## POC #22

**来源**: [CVE-2022-29464-lowkey0808_cve-2022-29464.md](../2022/CVE-2022-29464-lowkey0808_cve-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload endpoint且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 /fileupload 接口上传任意文件，最终导致远程代码执行。攻击者利用 Content-Disposition 头中的目录遍历序列将恶意文件（如 JSP shell）上传到 Web 根目录下的可执行位置，例如 ../../../../repository/deployment/server/webapps 目录。  

**POC分析:**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  **构建Payload:**  脚本允许上传用户自定义的webshell，默认情况下，如果用户没有提供webshell文件,它将上传一个内置的简单的JSP webshell，该webshell接受`cmd`参数并在服务器上执行系统命令。代码中变量`xloq`定义了内置的shell内容。
2.  **发送恶意请求:** 脚本使用`requests`库向目标URL的`/fileupload/toolsAny` endpoint发送POST请求，其中包含精心构造的`files`参数，利用目录遍历将webshell上传到`/repository/deployment/server/webapps/authenticationendpoint/`目录下，文件名为`shell.jsp`或者用户指定的文件名。
3.  **利用上传的webshell:** 如果上传成功，默认的webshell将通过构造URL（如`/authenticationendpoint/shell.jsp?cmd=whoami`）来执行命令，并打印命令执行结果。用户自定义上传的webshell将会直接返回webshell的URL地址,方便使用.

**有效性:**

根据漏洞库信息、搜索结果和提供的POC代码，可以判断该POC代码是有效的。 多个搜索结果表明该漏洞已被积极利用。

**投毒风险:**

仔细审查了POC代码，该代码主要功能是利用漏洞上传webshell并执行命令。没有发现作者隐藏的恶意代码或者后门。因此，认为投毒风险为0%。

**利用方式:**

1.  确定目标WSO2产品存在CVE-2022-29464漏洞。
2.  使用POC脚本，指定目标URL。
3.  POC脚本利用`/fileupload/toolsAny`接口，通过构造包含目录遍历的`Content-Disposition`头部的POST请求，将webshell上传到服务器的`/repository/deployment/server/webapps/authenticationendpoint/`目录下。
4.  通过访问上传的webshell（例如 `/authenticationendpoint/shell.jsp?cmd=command`）执行任意命令。

**项目地址:** [lowkey0808/cve-2022-29464](https://github.com/lowkey0808/cve-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #23

**来源**: [CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md](../2022/CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传

**影响应用:** WSO2 API Manager, WSO2 Identity Server, WSO2 Enterprise Integrator, WSO2 Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个未限制文件上传漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。攻击者利用 `/fileupload` 接口，通过构造包含目录遍历序列 `../../../../` 的 `Content-Disposition` 头，将恶意文件（如 JSP webshell）上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录。成功上传后，攻击者可以通过访问该恶意文件来执行任意代码。根据提供的POC代码，`exploit.py` 脚本首先创建一个包含恶意代码的 `cmd.jsp` 文件，然后使用 `requests` 库向目标 WSO2 服务器的 `/fileupload/toolsAny` 接口发送 POST 请求，上传该文件。如果上传成功，则会在目标服务器的 `user-portal` 目录下创建一个可执行命令的webshell `cmd.jsp`，攻击者可以通过访问 `user-portal/cmd.jsp?cmd=<command>` 来执行任意命令。根据搜索引擎结果，此漏洞已被积极利用，建议尽快修复。POC代码中未发现明显的投毒迹象，其功能明确为上传webshell并执行命令。因此，投毒风险为 0%。

**项目地址:** [mr-r3bot/WSO2-CVE-2022-29464](https://github.com/mr-r3bot/WSO2-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #24

**来源**: [CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md](../2022/CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器的/fileupload endpoint，目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，从而导致远程代码执行。漏洞利用的关键在于使用 `Content-Disposition` 头中的目录遍历序列，将恶意文件上传到 Web 根目录下的可执行路径，例如 `../../../../repository/deployment/server/webapps`。 

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（如 JSP webshell）的文件。
2.  攻击者利用 `/fileupload` 端点上传该恶意文件，并在 `Content-Disposition` 头中包含目录遍历序列，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`，其中 `shell.jsp` 为攻击者上传的恶意文件。
3.  服务器将文件上传到指定路径。
4.  攻击者通过访问上传的文件（例如 `https://host/authenticationendpoint/shell.jsp`）来执行恶意代码。

**POC 代码分析：**

提供的 Python 脚本 `exploit.py` 实现了上述利用过程。

*   脚本接受 WSO2 服务器地址和 webshell 文件名作为参数。
*   脚本构造一个包含 JSP webshell 内容的字典 `files`。  JSP webshell允许通过GET请求的`cmd`参数执行任意命令. 这是一个功能后门，而非投毒代码.
*   脚本使用 `requests.post` 函数向 `/fileupload/toolsAny` 端点发送 POST 请求，上传 webshell 文件，并通过目录遍历将其放置到 `authenticationendpoint` 目录下。
*   脚本输出 webshell 的访问 URL。

**有效性评估：**

根据漏洞描述和 POC 代码，此漏洞利用方法是有效的。多个来源证实了此漏洞的存在和可利用性（如 Trend Micro, Rapid7, Arctic Wolf 等）。

**投毒风险评估：**

代码本身主要是一个漏洞利用工具，用于上传和执行 webshell。**投毒风险较低，约为 10%**。尽管如此，仍需要注意以下潜在风险：

*   **代码托管平台的安全性：**如果该代码是从非官方、信誉差的平台下载，可能存在被篡改的风险。
*   **依赖项风险：**该脚本依赖于 `requests` 和 `urllib3` 库。如果这些库本身存在安全漏洞或被恶意篡改，可能会引入安全风险。
*   **作者意图：**虽然代码的主要功能是漏洞利用，但作者可能在代码中隐藏其他恶意功能，例如收集目标系统信息或安装后门。虽然当前代码未发现明显投毒行为, 但不能完全排除.

**结论：**

此漏洞的利用方法是有效的，可以导致远程代码执行。在使用此 POC 代码时，应注意潜在的投毒风险，并从可信来源获取代码。

**项目地址:** [n3rdh4x0r/CVE-2022-29464](https://github.com/n3rdh4x0r/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #25

**来源**: [CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md](../2022/CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器存在/fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的严重漏洞，允许未经授权的攻击者上传任意文件，并最终导致远程代码执行。根据漏洞描述和搜索结果，攻击者可以通过`/fileupload`端点，利用`Content-Disposition`头中的目录遍历序列，将恶意文件上传到Web根目录下的可执行位置，例如`../../../../repository/deployment/server/webapps`目录。  

提供的POC代码包含两个python脚本：`deface.py` 和 `shell.py`。 `shell.py`会上传一个包含命令执行功能的jsp文件，`deface.py`上传任意文件。  

**有效性：**  根据漏洞描述和POC代码，该漏洞的利用方式是有效的。POC代码通过构造包含目录遍历的请求，将恶意JSP文件上传到服务器的webapps目录下，从而实现远程代码执行。脚本使用了requests库发送POST请求，并禁用SSL验证，绕过证书校验。

**投毒风险：** 提供的代码较为简洁，主要功能是利用漏洞上传恶意文件。 虽然存在使用`requests.post(f'{host}/fileupload/toolsAny', files=files, verify=False)`语句, 禁用SSL证书验证，但这是为了POC的通用性，方便在各种环境下测试，不一定是投毒行为。由于没有发现明显的恶意代码或后门，因此投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者利用`fileupload`端点。
2.  在POST请求的`Content-Disposition`头中构造目录遍历序列（例如`../../../../`）。
3.  将恶意JSP文件（或其他服务器支持的脚本文件）上传到`repository/deployment/server/webapps`目录或其他Web根目录下的可执行位置。
4.  通过Web浏览器访问上传的JSP文件，执行任意命令。

**项目地址:** [r4x0r1337/-CVE-2022-29464](https://github.com/r4x0r1337/-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #26

**来源**: [CVE-2022-29464-superzerosec_CVE-2022-29464.md](../2022/CVE-2022-29464-superzerosec_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload端点，且未进行适当的文件上传限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。该漏洞的核心在于 `/fileupload` 端点缺乏适当的验证机制，攻击者可以通过构造包含目录遍历序列（如 `../../../../`）的 `Content-Disposition` 头来将恶意文件上传到 Web 根目录下的任意位置，例如 `repository/deployment/server/webapps` 目录。 

**利用方式：**

1.  **发送恶意文件上传请求：** 攻击者构造一个包含恶意 JSP webshell 的 HTTP POST 请求，该请求的目标是 `/fileupload` 端点。在请求头中，`Content-Disposition` 字段被设置为包含目录遍历序列，以便将文件上传到 `repository/deployment/server/webapps/authenticationendpoint` 目录下。
2.  **绕过文件类型限制（如果存在）：** 某些 WSO2 产品可能存在文件类型验证，但通常可以通过修改文件名或 Content-Type 头来绕过这些限制。
3.  **访问上传的 Webshell：** 成功上传 Webshell 后，攻击者可以通过 Web 浏览器访问该 Webshell，从而在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码是有效的。代码首先定义了一个 JSP webshell，然后构造一个 HTTP POST 请求，利用目录遍历漏洞将该 webshell 上传到目标服务器的 `authenticationendpoint` 目录下。最后，攻击者可以通过访问上传的 webshell 来执行命令。

**投毒风险评估：**

经过分析，提供的 POC 代码本身**没有明显的投毒代码**。webshell 的内容是直接嵌入在脚本中的，功能是执行用户通过 HTTP 请求传递的命令。风险评估为0%。


**项目地址:** [superzerosec/CVE-2022-29464](https://github.com/superzerosec/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---



---

## POC #22

**来源**: [CVE-2022-29464-lowkey0808_cve-2022-29464.md](../2022/CVE-2022-29464-lowkey0808_cve-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 目标系统存在/fileupload endpoint且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 漏洞允许攻击者通过 /fileupload 接口上传任意文件，最终导致远程代码执行。攻击者利用 Content-Disposition 头中的目录遍历序列将恶意文件（如 JSP shell）上传到 Web 根目录下的可执行位置，例如 ../../../../repository/deployment/server/webapps 目录。  

**POC分析:**

提供的POC代码是一个Python脚本，它执行以下操作：

1.  **构建Payload:**  脚本允许上传用户自定义的webshell，默认情况下，如果用户没有提供webshell文件,它将上传一个内置的简单的JSP webshell，该webshell接受`cmd`参数并在服务器上执行系统命令。代码中变量`xloq`定义了内置的shell内容。
2.  **发送恶意请求:** 脚本使用`requests`库向目标URL的`/fileupload/toolsAny` endpoint发送POST请求，其中包含精心构造的`files`参数，利用目录遍历将webshell上传到`/repository/deployment/server/webapps/authenticationendpoint/`目录下，文件名为`shell.jsp`或者用户指定的文件名。
3.  **利用上传的webshell:** 如果上传成功，默认的webshell将通过构造URL（如`/authenticationendpoint/shell.jsp?cmd=whoami`）来执行命令，并打印命令执行结果。用户自定义上传的webshell将会直接返回webshell的URL地址,方便使用.

**有效性:**

根据漏洞库信息、搜索结果和提供的POC代码，可以判断该POC代码是有效的。 多个搜索结果表明该漏洞已被积极利用。

**投毒风险:**

仔细审查了POC代码，该代码主要功能是利用漏洞上传webshell并执行命令。没有发现作者隐藏的恶意代码或者后门。因此，认为投毒风险为0%。

**利用方式:**

1.  确定目标WSO2产品存在CVE-2022-29464漏洞。
2.  使用POC脚本，指定目标URL。
3.  POC脚本利用`/fileupload/toolsAny`接口，通过构造包含目录遍历的`Content-Disposition`头部的POST请求，将webshell上传到服务器的`/repository/deployment/server/webapps/authenticationendpoint/`目录下。
4.  通过访问上传的webshell（例如 `/authenticationendpoint/shell.jsp?cmd=command`）执行任意命令。

**项目地址:** [lowkey0808/cve-2022-29464](https://github.com/lowkey0808/cve-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #23

**来源**: [CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md](../2022/CVE-2022-29464-mr-r3bot_WSO2-CVE-2022-29464.md)

## CVE-2022-29464-WSO2-Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 未限制文件上传

**影响应用:** WSO2 API Manager, WSO2 Identity Server, WSO2 Enterprise Integrator, WSO2 Open Banking AM/KM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0

**利用条件:** 需要能够访问 /fileupload 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个未限制文件上传漏洞，允许未经身份验证的攻击者上传任意文件，从而导致远程代码执行。攻击者利用 `/fileupload` 接口，通过构造包含目录遍历序列 `../../../../` 的 `Content-Disposition` 头，将恶意文件（如 JSP webshell）上传到 Web 根目录下的 `repository/deployment/server/webapps` 目录。成功上传后，攻击者可以通过访问该恶意文件来执行任意代码。根据提供的POC代码，`exploit.py` 脚本首先创建一个包含恶意代码的 `cmd.jsp` 文件，然后使用 `requests` 库向目标 WSO2 服务器的 `/fileupload/toolsAny` 接口发送 POST 请求，上传该文件。如果上传成功，则会在目标服务器的 `user-portal` 目录下创建一个可执行命令的webshell `cmd.jsp`，攻击者可以通过访问 `user-portal/cmd.jsp?cmd=<command>` 来执行任意命令。根据搜索引擎结果，此漏洞已被积极利用，建议尽快修复。POC代码中未发现明显的投毒迹象，其功能明确为上传webshell并执行命令。因此，投毒风险为 0%。

**项目地址:** [mr-r3bot/WSO2-CVE-2022-29464](https://github.com/mr-r3bot/WSO2-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #24

**来源**: [CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md](../2022/CVE-2022-29464-n3rdh4x0r_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 需要网络访问目标WSO2服务器的/fileupload endpoint，目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经授权的攻击者通过 `/fileupload` 端点上传任意文件，从而导致远程代码执行。漏洞利用的关键在于使用 `Content-Disposition` 头中的目录遍历序列，将恶意文件上传到 Web 根目录下的可执行路径，例如 `../../../../repository/deployment/server/webapps`。 

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（如 JSP webshell）的文件。
2.  攻击者利用 `/fileupload` 端点上传该恶意文件，并在 `Content-Disposition` 头中包含目录遍历序列，例如 `../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp`，其中 `shell.jsp` 为攻击者上传的恶意文件。
3.  服务器将文件上传到指定路径。
4.  攻击者通过访问上传的文件（例如 `https://host/authenticationendpoint/shell.jsp`）来执行恶意代码。

**POC 代码分析：**

提供的 Python 脚本 `exploit.py` 实现了上述利用过程。

*   脚本接受 WSO2 服务器地址和 webshell 文件名作为参数。
*   脚本构造一个包含 JSP webshell 内容的字典 `files`。  JSP webshell允许通过GET请求的`cmd`参数执行任意命令. 这是一个功能后门，而非投毒代码.
*   脚本使用 `requests.post` 函数向 `/fileupload/toolsAny` 端点发送 POST 请求，上传 webshell 文件，并通过目录遍历将其放置到 `authenticationendpoint` 目录下。
*   脚本输出 webshell 的访问 URL。

**有效性评估：**

根据漏洞描述和 POC 代码，此漏洞利用方法是有效的。多个来源证实了此漏洞的存在和可利用性（如 Trend Micro, Rapid7, Arctic Wolf 等）。

**投毒风险评估：**

代码本身主要是一个漏洞利用工具，用于上传和执行 webshell。**投毒风险较低，约为 10%**。尽管如此，仍需要注意以下潜在风险：

*   **代码托管平台的安全性：**如果该代码是从非官方、信誉差的平台下载，可能存在被篡改的风险。
*   **依赖项风险：**该脚本依赖于 `requests` 和 `urllib3` 库。如果这些库本身存在安全漏洞或被恶意篡改，可能会引入安全风险。
*   **作者意图：**虽然代码的主要功能是漏洞利用，但作者可能在代码中隐藏其他恶意功能，例如收集目标系统信息或安装后门。虽然当前代码未发现明显投毒行为, 但不能完全排除.

**结论：**

此漏洞的利用方法是有效的，可以导致远程代码执行。在使用此 POC 代码时，应注意潜在的投毒风险，并从可信来源获取代码。

**项目地址:** [n3rdh4x0r/CVE-2022-29464](https://github.com/n3rdh4x0r/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #25

**来源**: [CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md](../2022/CVE-2022-29464-r4x0r1337_-CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** WSO2 API Manager 2.2.0 to 4.0.0, WSO2 Identity Server 5.2.0 to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 to 5.11.0, WSO2 Enterprise Integrator 6.2.0 to 6.6.0, WSO2 Open Banking AM 1.4.0 to 2.0.0 and WSO2 Open Banking KM 1.4.0 to 2.0.0

**利用条件:** 需要目标服务器存在/fileupload端点且未进行严格的文件类型和路径校验

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-29464是一个存在于多个WSO2产品中的严重漏洞，允许未经授权的攻击者上传任意文件，并最终导致远程代码执行。根据漏洞描述和搜索结果，攻击者可以通过`/fileupload`端点，利用`Content-Disposition`头中的目录遍历序列，将恶意文件上传到Web根目录下的可执行位置，例如`../../../../repository/deployment/server/webapps`目录。  

提供的POC代码包含两个python脚本：`deface.py` 和 `shell.py`。 `shell.py`会上传一个包含命令执行功能的jsp文件，`deface.py`上传任意文件。  

**有效性：**  根据漏洞描述和POC代码，该漏洞的利用方式是有效的。POC代码通过构造包含目录遍历的请求，将恶意JSP文件上传到服务器的webapps目录下，从而实现远程代码执行。脚本使用了requests库发送POST请求，并禁用SSL验证，绕过证书校验。

**投毒风险：** 提供的代码较为简洁，主要功能是利用漏洞上传恶意文件。 虽然存在使用`requests.post(f'{host}/fileupload/toolsAny', files=files, verify=False)`语句, 禁用SSL证书验证，但这是为了POC的通用性，方便在各种环境下测试，不一定是投毒行为。由于没有发现明显的恶意代码或后门，因此投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者利用`fileupload`端点。
2.  在POST请求的`Content-Disposition`头中构造目录遍历序列（例如`../../../../`）。
3.  将恶意JSP文件（或其他服务器支持的脚本文件）上传到`repository/deployment/server/webapps`目录或其他Web根目录下的可执行位置。
4.  通过Web浏览器访问上传的JSP文件，执行任意命令。

**项目地址:** [r4x0r1337/-CVE-2022-29464](https://github.com/r4x0r1337/-CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

## POC #26

**来源**: [CVE-2022-29464-superzerosec_CVE-2022-29464.md](../2022/CVE-2022-29464-superzerosec_CVE-2022-29464.md)

## CVE-2022-29464 - WSO2 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload端点，且未进行适当的文件上传限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是一个存在于多个 WSO2 产品中的严重漏洞，它允许未经授权的攻击者上传任意文件，从而导致远程代码执行。该漏洞的核心在于 `/fileupload` 端点缺乏适当的验证机制，攻击者可以通过构造包含目录遍历序列（如 `../../../../`）的 `Content-Disposition` 头来将恶意文件上传到 Web 根目录下的任意位置，例如 `repository/deployment/server/webapps` 目录。 

**利用方式：**

1.  **发送恶意文件上传请求：** 攻击者构造一个包含恶意 JSP webshell 的 HTTP POST 请求，该请求的目标是 `/fileupload` 端点。在请求头中，`Content-Disposition` 字段被设置为包含目录遍历序列，以便将文件上传到 `repository/deployment/server/webapps/authenticationendpoint` 目录下。
2.  **绕过文件类型限制（如果存在）：** 某些 WSO2 产品可能存在文件类型验证，但通常可以通过修改文件名或 Content-Type 头来绕过这些限制。
3.  **访问上传的 Webshell：** 成功上传 Webshell 后，攻击者可以通过 Web 浏览器访问该 Webshell，从而在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码是有效的。代码首先定义了一个 JSP webshell，然后构造一个 HTTP POST 请求，利用目录遍历漏洞将该 webshell 上传到目标服务器的 `authenticationendpoint` 目录下。最后，攻击者可以通过访问上传的 webshell 来执行命令。

**投毒风险评估：**

经过分析，提供的 POC 代码本身**没有明显的投毒代码**。webshell 的内容是直接嵌入在脚本中的，功能是执行用户通过 HTTP 请求传递的命令。风险评估为0%。


**项目地址:** [superzerosec/CVE-2022-29464](https://github.com/superzerosec/CVE-2022-29464)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)

---

