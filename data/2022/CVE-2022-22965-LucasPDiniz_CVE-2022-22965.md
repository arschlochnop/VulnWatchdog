# CVE-2022-22965

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22965-0xrobiul_CVE-2022-22965.md](../2022/CVE-2022-22965-0xrobiul_CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat WAR deployment, Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和漏洞利用代码，评估如下：

**有效性：**
CVE-2022-22965 (Spring4Shell) 是一个远程代码执行漏洞，影响运行在 JDK 9+ 上的 Spring MVC 或 Spring WebFlux 应用，并且这些应用需要部署为 Tomcat WAR 包。搜索引擎结果表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含 GNU GPL 协议，不包含任何与漏洞利用相关的代码。无法通过此代码分析是否存在投毒风险。由于提供的代码并非实际的POC代码，因此投毒风险评估为0%。实际环境中利用代码可能存在投毒，但需进一步分析具体POC代码才能判断。

**利用方式：**
漏洞利用方式主要涉及利用数据绑定机制，通过构造恶意的 HTTP 请求，修改 Tomcat 的日志配置，将日志输出到 Web 目录，然后写入恶意 JSP 代码，最终实现远程代码执行。攻击者通过精心构造的请求参数，利用 Spring 框架的数据绑定功能，修改 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 和其他相关属性来实现 RCE。一些利用方式还涉及 Spring Expression Language (SpEL) 注入。

**排序优先级理由：**
*   **搜索引擎结果：** 优先级最高，因为它们提供了关于该漏洞的实际利用情况和影响的最新信息，包括已被积极利用的证据。
*   **漏洞利用代码：** 优先级第二，因为真实的POC代码能提供最直接的漏洞利用方式验证，但本次提供的不是有效POC代码，无法有效分析漏洞。
*   **漏洞库信息：** 优先级最低，因为它们通常只提供漏洞的概要描述，而不提供实际的利用细节。


**项目地址:** [0xrobiul/CVE-2022-22965](https://github.com/0xrobiul/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #2

**来源**: [CVE-2022-22965-Aur3ns_Block-Spring4Shell.md](../2022/CVE-2022-22965-Aur3ns_Block-Spring4Shell.md)

## CVE-2022-22965 Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework 5.3.X (prior to 5.3.18+), 5.2.x (prior to 5.2.20+) 和所有旧版本

**利用条件:** JDK 9+, Tomcat WAR部署，Spring MVC或Spring WebFlux应用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring框架中的远程代码执行漏洞。攻击者可以通过操纵类加载器等属性来执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个真实存在且已被积极利用的漏洞。提供的POC代码是一个防火墙服务器，旨在检测和阻止针对此漏洞的攻击，而不是利用漏洞。因此，POC代码本身的有效性在于其防御能力，而非攻击能力。

**投毒风险评估：**

分析提供的 frs.py 脚本，这个脚本模拟了一个简单的防火墙，用来检测特定的payload和header。虽然代码本身实现了防御 Spring4Shell 攻击的功能，但潜在的风险点在于：
*   **绕过规则：** 精明的攻击者可以研究这些规则，设计绕过这些规则的payload。如果规则过于简单，很容易被绕过。
*   **性能问题：** 复杂的规则可能会影响服务器性能，特别是在高流量情况下。
*   **误报风险：** 过于宽泛的规则可能会导致误报，阻止合法的请求。

检查代码，未发现明显的恶意代码，该项目更像是提供防御措施而非主动攻击，但作者可能在其他地方添加恶意程序，建议谨慎。
因此，投毒风险较低，估计为5%。主要的风险在于规则的有效性和完整性，而不是直接包含恶意代码。

**利用方式分析：**

1.  **目标：** 攻击运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序，并且部署在Tomcat中作为WAR包。
2.  **机制：** 利用Spring的数据绑定功能，通过恶意构造的请求参数，修改`class.module.classLoader.resources.context.parent.pipeline.first`等属性，从而控制Tomcat的日志配置和Web shell路径。
3.  **步骤：**
    *   发送包含恶意参数的HTTP请求，例如修改Tomcat访问日志的目录为Web目录。
    *   然后，通过修改日志文件的后缀，使其成为可执行的JSP文件。
    *   最后，写入恶意代码到这个JSP文件，实现远程代码执行。

**总结：**

CVE-2022-22965是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。该漏洞利用的有效性取决于目标应用程序的配置和补丁状态。该项目提供的代码旨在防御这种攻击，但需要注意规则的有效性和潜在的绕过风险。

**项目地址:** [Aur3ns/Block-Spring4Shell](https://github.com/Aur3ns/Block-Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #3

**来源**: [CVE-2022-22965-BKLockly_CVE-2022-22965.md](../2022/CVE-2022-22965-BKLockly_CVE-2022-22965.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，运行在 Tomcat 作为 WAR 部署的 Spring MVC 或 Spring WebFlux 应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞允许攻击者通过数据绑定，在满足特定条件下（JDK 9+，Tomcat WAR部署），利用恶意请求执行任意代码。

**漏洞利用方式：**

1.  **目标确认：** 确认目标应用程序使用受影响的Spring Framework版本，并且满足漏洞利用的条件（JDK版本、部署方式）。
2.  **参数操纵：**  通过构造恶意的HTTP请求，操纵`class.module.classLoader.resources.context.parent.pipeline.first.pattern`等参数，修改Tomcat的日志配置，写入恶意Web Shell。
3.  **代码执行：** 访问恶意Web Shell，执行任意命令。

**POC有效性分析：**

提供的POC代码是一个Go程序，它包含了漏洞检测(POC)和利用(Exploit)功能。通过命令行参数，可以指定目标URL、要执行的命令、反弹shell的地址和端口等。从代码结构上看，POC程序会首先检测目标是否存在漏洞，如果存在则尝试进行利用，根据参数决定是否反弹shell。

**投毒风险分析：**

代码本身包含网络请求和命令执行功能，具有一定的风险。以下是一些潜在的投毒风险点：

*   **硬编码的恶意命令：** 虽然POC提供了`-c`参数指定命令，但作者可能在代码中隐藏了特定的恶意命令，在特定条件下执行。
*   **反弹shell的隐蔽后门：**  反弹shell功能本身就具有一定的风险，如果作者在反弹shell的代码中加入额外的逻辑，例如收集目标信息并回传，就构成了一个隐蔽的后门。
*   **依赖包风险：** 虽然`go.mod`和`go.sum`文件看起来正常，但仍然存在依赖包被篡改的风险，从而引入恶意代码。

基于以上分析，认为该POC代码存在**10%**的投毒风险。需要仔细审查代码，特别是网络请求、命令执行和反弹shell相关的部分，确保没有隐藏的恶意逻辑。同时也需要注意依赖包的安全性。

**其他说明:** 该POC代码的README描述了单个IP扫描和批量扫描的使用方法和效果。同时，提到第一次执行exp可能报错，但其实已经上传成功，需要等待一会。这表明该POC有一定的局限性，可能存在利用成功率不高的问题。

**项目地址:** [BKLockly/CVE-2022-22965](https://github.com/BKLockly/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #4

**来源**: [CVE-2022-22965-DDuarte_springshell-rce-poc.md](../2022/CVE-2022-22965-DDuarte_springshell-rce-poc.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat with WAR deployment, vulnerable Spring version, no blocklist on WebDataBinder/InitBinder, parameter bind with POJOs directly, writeable file system

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个Spring Framework中的远程代码执行漏洞。漏洞利用源于在JDK 9+环境中，当应用程序部署为WAR包在Tomcat上运行时，攻击者可以通过操纵类加载器来修改Tomcat的访问日志配置，进而写入恶意的JSP webshell，最终实现远程代码执行。提供的POC代码通过发送包含恶意参数的POST请求到易受攻击的应用程序的index端点。这些参数用于修改Tomcat的日志记录管道，特别是配置一个logger，将JSP代码写入到webapps/ROOT目录下的一个文件中（tomcatwar.jsp）。然后，POC尝试访问这个JSP文件，如果成功访问并返回500错误，则表示webshell已成功部署，可以通过传递cmd参数执行任意命令。Dockerfile构建了一个易受攻击的Spring应用，并将其部署到Tomcat服务器上，为漏洞利用提供环境。

**有效性：**根据漏洞描述和提供的POC代码，该POC在满足特定条件下（如JDK版本、Tomcat部署方式、Spring版本等）应该是有效的。

**投毒风险：** 评估投毒风险为10%。
*   Dockerfile中的构建过程相对透明，主要依赖于官方Maven和Tomcat镜像。虽存在供应链投毒风险，但概率较低。
*   pom.xml文件指定了依赖项，存在引入恶意依赖的风险，但当前依赖项均为常见的Spring组件，直接投毒的可能性较低。
*   poc.py脚本主要用于漏洞利用，虽然本身是攻击代码，但与投毒无关。
*   总体而言，仓库的投毒风险较低，主要集中在供应链攻击层面，例如Maven中央仓库的依赖包被篡改。但考虑到公开的漏洞利用仓库通常会接受安全社区的审查，恶意投毒的概率相对较低。

**利用方式：**
1.  **发送恶意请求：** 攻击者发送一个包含特殊构造的参数的HTTP请求到Spring MVC或Spring WebFlux应用程序。
2.  **修改Tomcat日志配置：** 这些参数用于修改Tomcat服务器的访问日志配置。
3.  **写入Webshell：** 通过修改日志配置，将一个恶意的JSP webshell写入到Tomcat的webapps目录。
4.  **远程代码执行：** 攻击者通过访问写入的JSP webshell，传递命令参数，实现在服务器上执行任意代码。

**项目地址:** [DDuarte/springshell-rce-poc](https://github.com/DDuarte/springshell-rce-poc)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #5

**来源**: [CVE-2022-22965-ESSAFAR_Firewall-Rules.md](../2022/CVE-2022-22965-ESSAFAR_Firewall-Rules.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，运行在Tomcat上，部署为WAR包，Spring MVC或Spring WebFlux应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework中的远程代码执行漏洞。攻击者可以利用数据绑定机制，通过构造恶意的请求，修改Tomcat的日志配置，例如修改日志文件的存放路径和文件后缀名为jsp，然后向日志文件写入webshell，从而获得服务器的控制权。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此漏洞是有效的。漏洞库信息中提到该漏洞可能导致RCE，并被CISA收录到已知被利用的漏洞目录中。搜索引擎结果中也提及了该漏洞的利用和分析，并且存在公开的POC。
提供的漏洞利用代码是一个用于检测和阻止针对此漏洞的防火墙服务器脚本。它通过检测请求路径和HTTP头中包含的特定模式来识别可能的攻击请求。因此，代码本身并不是POC，而是防御工具，但是侧面验证了漏洞的存在和利用方式。

**投毒风险：**
提供的python脚本是一个简单的HTTP服务器，其主要功能是根据请求的路径和头部信息来判断是否拦截该请求。如果请求的路径包含`/tomcatwar.jsp`，或者HTTP头部包含特定的字符串（如`suffix=%>//`， `c1=Runtime`，`c2=<%`等），则该请求会被拦截。该脚本的目的是模拟一个防火墙，用于防御针对CVE-2022-22965的攻击，**并未发现任何投毒代码，因此投毒风险为0%**。

**利用方式：**
1.  **目标环境：** 目标应用程序必须满足以下条件：
    *   使用Spring MVC或Spring WebFlux框架。
    *   运行在JDK 9及以上版本。
    *   部署在Tomcat服务器上，并且是WAR包部署。
2.  **攻击方法：** 攻击者通过发送精心构造的HTTP请求，利用Spring的数据绑定功能，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern`的值为包含webshell的恶意代码,并且修改`class.module.classLoader.resources.context.parent.pipeline.first.suffix`的值为`.jsp`,以及`class.module.classLoader.resources.context.parent.pipeline.first.directory`设置为`webapps/[应用名]`，从而将webshell写入到可执行的JSP文件中。
3.  **RCE实现：** 写入webshell后，攻击者可以通过访问该JSP文件来执行任意代码，从而控制服务器。

**项目地址:** [ESSAFAR/Firewall-Rules](https://github.com/ESSAFAR/Firewall-Rules)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #6

**来源**: [CVE-2022-22965-LucasPDiniz_CVE-2022-22965.md](../2022/CVE-2022-22965-LucasPDiniz_CVE-2022-22965.md)

# CVE-2022-22965

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22965-0xrobiul_CVE-2022-22965.md](../2022/CVE-2022-22965-0xrobiul_CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat WAR deployment, Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和漏洞利用代码，评估如下：

**有效性：**
CVE-2022-22965 (Spring4Shell) 是一个远程代码执行漏洞，影响运行在 JDK 9+ 上的 Spring MVC 或 Spring WebFlux 应用，并且这些应用需要部署为 Tomcat WAR 包。搜索引擎结果表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含 GNU GPL 协议，不包含任何与漏洞利用相关的代码。无法通过此代码分析是否存在投毒风险。由于提供的代码并非实际的POC代码，因此投毒风险评估为0%。实际环境中利用代码可能存在投毒，但需进一步分析具体POC代码才能判断。

**利用方式：**
漏洞利用方式主要涉及利用数据绑定机制，通过构造恶意的 HTTP 请求，修改 Tomcat 的日志配置，将日志输出到 Web 目录，然后写入恶意 JSP 代码，最终实现远程代码执行。攻击者通过精心构造的请求参数，利用 Spring 框架的数据绑定功能，修改 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 和其他相关属性来实现 RCE。一些利用方式还涉及 Spring Expression Language (SpEL) 注入。

**排序优先级理由：**
*   **搜索引擎结果：** 优先级最高，因为它们提供了关于该漏洞的实际利用情况和影响的最新信息，包括已被积极利用的证据。
*   **漏洞利用代码：** 优先级第二，因为真实的POC代码能提供最直接的漏洞利用方式验证，但本次提供的不是有效POC代码，无法有效分析漏洞。
*   **漏洞库信息：** 优先级最低，因为它们通常只提供漏洞的概要描述，而不提供实际的利用细节。


**项目地址:** [0xrobiul/CVE-2022-22965](https://github.com/0xrobiul/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #2

**来源**: [CVE-2022-22965-Aur3ns_Block-Spring4Shell.md](../2022/CVE-2022-22965-Aur3ns_Block-Spring4Shell.md)

## CVE-2022-22965 Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework 5.3.X (prior to 5.3.18+), 5.2.x (prior to 5.2.20+) 和所有旧版本

**利用条件:** JDK 9+, Tomcat WAR部署，Spring MVC或Spring WebFlux应用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring框架中的远程代码执行漏洞。攻击者可以通过操纵类加载器等属性来执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个真实存在且已被积极利用的漏洞。提供的POC代码是一个防火墙服务器，旨在检测和阻止针对此漏洞的攻击，而不是利用漏洞。因此，POC代码本身的有效性在于其防御能力，而非攻击能力。

**投毒风险评估：**

分析提供的 frs.py 脚本，这个脚本模拟了一个简单的防火墙，用来检测特定的payload和header。虽然代码本身实现了防御 Spring4Shell 攻击的功能，但潜在的风险点在于：
*   **绕过规则：** 精明的攻击者可以研究这些规则，设计绕过这些规则的payload。如果规则过于简单，很容易被绕过。
*   **性能问题：** 复杂的规则可能会影响服务器性能，特别是在高流量情况下。
*   **误报风险：** 过于宽泛的规则可能会导致误报，阻止合法的请求。

检查代码，未发现明显的恶意代码，该项目更像是提供防御措施而非主动攻击，但作者可能在其他地方添加恶意程序，建议谨慎。
因此，投毒风险较低，估计为5%。主要的风险在于规则的有效性和完整性，而不是直接包含恶意代码。

**利用方式分析：**

1.  **目标：** 攻击运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序，并且部署在Tomcat中作为WAR包。
2.  **机制：** 利用Spring的数据绑定功能，通过恶意构造的请求参数，修改`class.module.classLoader.resources.context.parent.pipeline.first`等属性，从而控制Tomcat的日志配置和Web shell路径。
3.  **步骤：**
    *   发送包含恶意参数的HTTP请求，例如修改Tomcat访问日志的目录为Web目录。
    *   然后，通过修改日志文件的后缀，使其成为可执行的JSP文件。
    *   最后，写入恶意代码到这个JSP文件，实现远程代码执行。

**总结：**

CVE-2022-22965是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。该漏洞利用的有效性取决于目标应用程序的配置和补丁状态。该项目提供的代码旨在防御这种攻击，但需要注意规则的有效性和潜在的绕过风险。

**项目地址:** [Aur3ns/Block-Spring4Shell](https://github.com/Aur3ns/Block-Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #3

**来源**: [CVE-2022-22965-BKLockly_CVE-2022-22965.md](../2022/CVE-2022-22965-BKLockly_CVE-2022-22965.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，运行在 Tomcat 作为 WAR 部署的 Spring MVC 或 Spring WebFlux 应用程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞允许攻击者通过数据绑定，在满足特定条件下（JDK 9+，Tomcat WAR部署），利用恶意请求执行任意代码。

**漏洞利用方式：**

1.  **目标确认：** 确认目标应用程序使用受影响的Spring Framework版本，并且满足漏洞利用的条件（JDK版本、部署方式）。
2.  **参数操纵：**  通过构造恶意的HTTP请求，操纵`class.module.classLoader.resources.context.parent.pipeline.first.pattern`等参数，修改Tomcat的日志配置，写入恶意Web Shell。
3.  **代码执行：** 访问恶意Web Shell，执行任意命令。

**POC有效性分析：**

提供的POC代码是一个Go程序，它包含了漏洞检测(POC)和利用(Exploit)功能。通过命令行参数，可以指定目标URL、要执行的命令、反弹shell的地址和端口等。从代码结构上看，POC程序会首先检测目标是否存在漏洞，如果存在则尝试进行利用，根据参数决定是否反弹shell。

**投毒风险分析：**

代码本身包含网络请求和命令执行功能，具有一定的风险。以下是一些潜在的投毒风险点：

*   **硬编码的恶意命令：** 虽然POC提供了`-c`参数指定命令，但作者可能在代码中隐藏了特定的恶意命令，在特定条件下执行。
*   **反弹shell的隐蔽后门：**  反弹shell功能本身就具有一定的风险，如果作者在反弹shell的代码中加入额外的逻辑，例如收集目标信息并回传，就构成了一个隐蔽的后门。
*   **依赖包风险：** 虽然`go.mod`和`go.sum`文件看起来正常，但仍然存在依赖包被篡改的风险，从而引入恶意代码。

基于以上分析，认为该POC代码存在**10%**的投毒风险。需要仔细审查代码，特别是网络请求、命令执行和反弹shell相关的部分，确保没有隐藏的恶意逻辑。同时也需要注意依赖包的安全性。

**其他说明:** 该POC代码的README描述了单个IP扫描和批量扫描的使用方法和效果。同时，提到第一次执行exp可能报错，但其实已经上传成功，需要等待一会。这表明该POC有一定的局限性，可能存在利用成功率不高的问题。

**项目地址:** [BKLockly/CVE-2022-22965](https://github.com/BKLockly/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #4

**来源**: [CVE-2022-22965-DDuarte_springshell-rce-poc.md](../2022/CVE-2022-22965-DDuarte_springshell-rce-poc.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat with WAR deployment, vulnerable Spring version, no blocklist on WebDataBinder/InitBinder, parameter bind with POJOs directly, writeable file system

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个Spring Framework中的远程代码执行漏洞。漏洞利用源于在JDK 9+环境中，当应用程序部署为WAR包在Tomcat上运行时，攻击者可以通过操纵类加载器来修改Tomcat的访问日志配置，进而写入恶意的JSP webshell，最终实现远程代码执行。提供的POC代码通过发送包含恶意参数的POST请求到易受攻击的应用程序的index端点。这些参数用于修改Tomcat的日志记录管道，特别是配置一个logger，将JSP代码写入到webapps/ROOT目录下的一个文件中（tomcatwar.jsp）。然后，POC尝试访问这个JSP文件，如果成功访问并返回500错误，则表示webshell已成功部署，可以通过传递cmd参数执行任意命令。Dockerfile构建了一个易受攻击的Spring应用，并将其部署到Tomcat服务器上，为漏洞利用提供环境。

**有效性：**根据漏洞描述和提供的POC代码，该POC在满足特定条件下（如JDK版本、Tomcat部署方式、Spring版本等）应该是有效的。

**投毒风险：** 评估投毒风险为10%。
*   Dockerfile中的构建过程相对透明，主要依赖于官方Maven和Tomcat镜像。虽存在供应链投毒风险，但概率较低。
*   pom.xml文件指定了依赖项，存在引入恶意依赖的风险，但当前依赖项均为常见的Spring组件，直接投毒的可能性较低。
*   poc.py脚本主要用于漏洞利用，虽然本身是攻击代码，但与投毒无关。
*   总体而言，仓库的投毒风险较低，主要集中在供应链攻击层面，例如Maven中央仓库的依赖包被篡改。但考虑到公开的漏洞利用仓库通常会接受安全社区的审查，恶意投毒的概率相对较低。

**利用方式：**
1.  **发送恶意请求：** 攻击者发送一个包含特殊构造的参数的HTTP请求到Spring MVC或Spring WebFlux应用程序。
2.  **修改Tomcat日志配置：** 这些参数用于修改Tomcat服务器的访问日志配置。
3.  **写入Webshell：** 通过修改日志配置，将一个恶意的JSP webshell写入到Tomcat的webapps目录。
4.  **远程代码执行：** 攻击者通过访问写入的JSP webshell，传递命令参数，实现在服务器上执行任意代码。

**项目地址:** [DDuarte/springshell-rce-poc](https://github.com/DDuarte/springshell-rce-poc)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #5

**来源**: [CVE-2022-22965-ESSAFAR_Firewall-Rules.md](../2022/CVE-2022-22965-ESSAFAR_Firewall-Rules.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，运行在Tomcat上，部署为WAR包，Spring MVC或Spring WebFlux应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework中的远程代码执行漏洞。攻击者可以利用数据绑定机制，通过构造恶意的请求，修改Tomcat的日志配置，例如修改日志文件的存放路径和文件后缀名为jsp，然后向日志文件写入webshell，从而获得服务器的控制权。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此漏洞是有效的。漏洞库信息中提到该漏洞可能导致RCE，并被CISA收录到已知被利用的漏洞目录中。搜索引擎结果中也提及了该漏洞的利用和分析，并且存在公开的POC。
提供的漏洞利用代码是一个用于检测和阻止针对此漏洞的防火墙服务器脚本。它通过检测请求路径和HTTP头中包含的特定模式来识别可能的攻击请求。因此，代码本身并不是POC，而是防御工具，但是侧面验证了漏洞的存在和利用方式。

**投毒风险：**
提供的python脚本是一个简单的HTTP服务器，其主要功能是根据请求的路径和头部信息来判断是否拦截该请求。如果请求的路径包含`/tomcatwar.jsp`，或者HTTP头部包含特定的字符串（如`suffix=%>//`， `c1=Runtime`，`c2=<%`等），则该请求会被拦截。该脚本的目的是模拟一个防火墙，用于防御针对CVE-2022-22965的攻击，**并未发现任何投毒代码，因此投毒风险为0%**。

**利用方式：**
1.  **目标环境：** 目标应用程序必须满足以下条件：
    *   使用Spring MVC或Spring WebFlux框架。
    *   运行在JDK 9及以上版本。
    *   部署在Tomcat服务器上，并且是WAR包部署。
2.  **攻击方法：** 攻击者通过发送精心构造的HTTP请求，利用Spring的数据绑定功能，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern`的值为包含webshell的恶意代码,并且修改`class.module.classLoader.resources.context.parent.pipeline.first.suffix`的值为`.jsp`,以及`class.module.classLoader.resources.context.parent.pipeline.first.directory`设置为`webapps/[应用名]`，从而将webshell写入到可执行的JSP文件中。
3.  **RCE实现：** 写入webshell后，攻击者可以通过访问该JSP文件来执行任意代码，从而控制服务器。

**项目地址:** [ESSAFAR/Firewall-Rules](https://github.com/ESSAFAR/Firewall-Rules)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #6

**来源**: [CVE-2022-22965-Nosie12_fire-wall-server.md](../2022/CVE-2022-22965-Nosie12_fire-wall-server.md)

## CVE-2022-22965 Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个高危的远程代码执行漏洞，影响运行在 JDK 9+ 上的 Spring MVC 或 Spring WebFlux 应用，并且需要部署在 Tomcat 中，以 WAR 包的形式部署。漏洞利用方式是通过数据绑定，允许攻击者传入恶意构造的请求参数，修改 Tomcat 的 AccessLogValve 组件，从而写入 webshell 或执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用确实存在并且被广泛讨论和利用。提供的Python代码实际上是一个防火墙脚本，用于检测和阻止利用 Spring4Shell 漏洞的恶意请求，而不是漏洞利用代码本身。它通过检测请求路径和请求体中是否存在已知的恶意模式来工作。因此，提供的 Python 代码并不能直接验证漏洞的有效性，但是可以作为防御措施。

**投毒风险：**
对提供的 Python 代码 `firewall_server.py` 进行了分析，该脚本的功能是检测和阻止包含特定恶意模式的HTTP请求。脚本中定义了 `BLOCKED_PATTERNS` 列表，其中包含了诸如 `/tomcatwar.jsp`，`class.module.classLoader.resources.context.parent.pipeline` 和一些编码后的字符串等模式。脚本会检查传入的请求路径和请求体，如果发现任何匹配的模式，它将返回一个 `403 Forbidden` 响应。因此，从代码的功能和内容来看，该脚本本身不包含任何投毒代码。可以认为投毒风险为 0%。

**利用方式：**
根据漏洞信息，Spring4Shell 的利用方式如下：
1.  攻击者发送一个包含恶意构造的请求，该请求的目标是 Spring MVC 或 Spring WebFlux 应用。
2.  恶意请求中的参数会利用 Spring 的数据绑定机制，尝试修改 Tomcat 的 AccessLogValve 组件的属性。
3.  通过修改 AccessLogValve 的属性，攻击者可以控制日志文件的位置和格式，从而写入任意代码（例如，一个 webshell）。
4.  一旦 webshell 被写入，攻击者就可以通过它来执行任意命令，从而控制服务器。

**项目地址:** [Nosie12/fire-wall-server](https://github.com/Nosie12/fire-wall-server)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #7

**来源**: [CVE-2022-22965-ZapcoMan_spring4shell-vulnerable-application.md](../2022/CVE-2022-22965-ZapcoMan_spring4shell-vulnerable-application.md)

## CVE-2022-22965-Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 使用Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，评估如下：

**有效性：**
该漏洞利用代码提供了一个可 docker 化的应用程序，容易受到 Spring4Shell 漏洞 (CVE-2022-22965) 的攻击。Dockerfile 使用了特定版本的 Tomcat 镜像 (lunasec/tomcat-9.0.59-jdk11)，该版本在漏洞修复之前。pom.xml 文件配置了 Spring Boot 版本 2.6.3，该版本可能受漏洞影响（具体取决于 Spring Framework 的版本）。构建过程包括使用 Maven 打包应用程序为 WAR 文件，并将其部署到 Tomcat 的 webapps 目录。描述文件也描述这是一个POC。

**投毒风险：**
该 POC 仓库的主要目的是演示 CVE-2022-22965 漏洞。然而，始终存在代码中包含恶意或后门代码的风险，即使作者的意图是良性的。代码中检测到投毒代码的风险较低。风险估计为 10%，原因如下：

*   Dockerfile：它下载了一个指定的tomcat版本，如果该docker存在后门，则存在风险
*   `README.md` 推荐了LunaSec的分支，可以推断是官方的。

**利用方式：**
该漏洞允许未经身份验证的远程代码执行。利用方式涉及操纵类加载器和 servlet 上下文以写入恶意 JSP 文件到 Tomcat 的 webapp 目录中，然后攻击者可以通过发送特定构造的 HTTP 请求来触发该 JSP 文件。

总体而言，该 POC 代码似乎有效，但使用和部署 POC 需要谨慎，尤其是在生产环境中。始终建议在安全隔离的环境中进行测试，并仔细审查代码是否存在潜在的恶意代码。

**项目地址:** [ZapcoMan/spring4shell-vulnerable-application](https://github.com/ZapcoMan/spring4shell-vulnerable-application)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #8

**来源**: [CVE-2022-22965-bL34cHig0_Telstra-Cybersecurity-Virtual-Experience-.md](../2022/CVE-2022-22965-bL34cHig0_Telstra-Cybersecurity-Virtual-Experience-.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat (WAR deployment), 存在RequestMapping和POJO参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965，又名 Spring4Shell，是一个Spring Framework的远程代码执行漏洞。根据漏洞库信息，运行在JDK 9+的Spring MVC或Spring WebFlux应用可能受到影响。该漏洞利用需要应用部署为Tomcat WAR包。如果部署为Spring Boot可执行jar，则不受影响。漏洞利用方式是利用数据绑定，将恶意属性写入到`class.module.classLoader.resources.context.parent.pipeline.first.pattern`等属性中，最终写入恶意webshell。

**有效性评估：**
根据搜索结果，该漏洞已被积极利用。

**利用方式：**
攻击者通过发送包含恶意参数的HTTP请求，利用Spring的数据绑定功能修改Tomcat的日志配置，写入webshell。webshell的路径和文件名可以通过请求参数指定。攻击者可以通过webshell执行任意代码。

**投毒风险分析：**
提供的代码是一个防火墙脚本，旨在阻止利用CVE-2022-22965的恶意请求。它通过检查请求路径和HTTP头来识别恶意流量，并返回403 Forbidden错误。此代码本身**不包含任何恶意功能或后门**，因此，投毒风险评估为0%。它主要通过正则表达式来匹配恶意请求，如请求路径包含`/tomcatwar.jsp`或者HTTP头部包含`suffix=%>//`等特征。这个脚本的目的是防御Spring4Shell攻击，而不是利用它。

**项目地址:** [bL34cHig0/Telstra-Cybersecurity-Virtual-Experience-](https://github.com/bL34cHig0/Telstra-Cybersecurity-Virtual-Experience-)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #9

**来源**: [CVE-2022-22965-brunoh6_web-threat-mitigation.md](../2022/CVE-2022-22965-brunoh6_web-threat-mitigation.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 并且应用使用了Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个存在于Spring Framework中的远程代码执行漏洞。攻击者可以通过精心构造的请求，利用数据绑定机制，修改 Tomcat 的 AccessLogValve 组件的属性，从而写入恶意 WebShell 到服务器，最终实现 RCE。

**漏洞利用有效性:**
根据漏洞库信息和搜索结果，该漏洞在特定环境下（JDK 9+, Tomcat WAR部署）可以被成功利用。提供的POC代码（`web-threat-mitigation`仓库）也证实了这一点，该仓库提供了一个使用Metasploit进行漏洞利用的示例，展示了在有WAF和无WAF的情况下，利用的成功与失败。因此，可以判断POC代码是有效的。

**投毒风险:**
分析提供的代码仓库，主要是演示如何检测和缓解web应用程序威胁，通过 OWASP ZAP, Burp Suite, 和 ModSecurity WAF。它还包括了CVE-2022-22965 (Spring4Shell)的漏洞利用。代码仓库中没有明显的恶意代码或者后门, 但是考虑到任何人都可以修改和传播这些代码，以及实际环境中可能存在的复杂性，仍然不能完全排除投毒的可能。 风险估计为5%。

**利用方式:**
1.  **确定目标环境:**  检查目标应用程序是否满足漏洞利用的先决条件 (Spring MVC/WebFlux, JDK 9+, Tomcat WAR部署)。
2.  **发送恶意请求:**  构造包含恶意参数的HTTP请求，利用Spring的数据绑定机制，修改Tomcat的`AccessLogValve`组件属性。
3.  **写入WebShell:** 通过修改`directory`、`prefix`、`suffix`和`pattern`属性，将WebShell写入到服务器上的可访问目录。
4.  **执行命令:**  通过访问写入的WebShell，执行任意命令，实现远程代码执行。

**防御建议:**
*   升级Spring Framework到不受影响的版本 (5.3.18+, 5.2.20+)。
*   使用WAF (如ModSecurity) 并配置OWASP CRS来检测和阻止恶意请求。
*   限制数据绑定的使用，避免将用户输入直接绑定到敏感对象属性。

**项目地址:** [brunoh6/web-threat-mitigation](https://github.com/brunoh6/web-threat-mitigation)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #10

**来源**: [CVE-2022-22965-c33dd_CVE-2022-22965.md](../2022/CVE-2022-22965-c33dd_CVE-2022-22965.md)

## CVE-2022-22965 - Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965 (Spring4Shell) 是一种远程代码执行漏洞，存在于 Spring Framework 中。根据漏洞库信息和搜索结果，攻击者可以通过数据绑定利用此漏洞，向某些参数传递特制的恶意请求，从而获得对服务器的控制权。

**利用方式：**

1.  **目标：** 目标应用程序需要运行在 JDK 9 或更高版本上，并且部署为 Tomcat WAR 包。使用 Spring MVC 或 Spring WebFlux 框架。
2.  **漏洞触发：** 漏洞利用涉及操纵类加载器绕过安全机制。通过修改 Tomcat 的 AccessLogValve 组件，可以写入恶意 Web shell。
3.  **具体步骤：** 攻击者发送包含恶意参数的 HTTP 请求。这些参数被 Spring 的数据绑定机制处理，导致 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 属性被修改，从而写入 Web shell 到服务器的可访问位置。
4.  **代码分析：** 提供的POC代码是一个C程序，该程序尝试通过HTTP请求与目标服务器通信，并检查响应状态码以确定漏洞是否存在。关键部分在于构造特定的HTTP头，例如`suffix`和`c1`，以利用数据绑定漏洞。代码中没有发现明显的投毒代码。

**有效性：**

提供的C代码片段看起来像是漏洞利用的前期检查工具，用于验证目标是否存在漏洞。它通过发送包含特定header的HTTP请求并检查响应来尝试利用该漏洞。如果服务器返回 2XX 状态码，则认为漏洞存在。

**投毒风险：**

仔细审查提供的C代码后，没有发现任何可疑的、恶意的或隐藏的后门代码。代码的功能主要是发送HTTP请求，读取响应，并根据响应码判断漏洞是否存在。 因此，评估的投毒风险为 0%。

**项目地址:** [c33dd/CVE-2022-22965](https://github.com/c33dd/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #11

**来源**: [CVE-2022-22965-cxzero_CVE-2022-22965-spring4shell.md](../2022/CVE-2022-22965-cxzero_CVE-2022-22965-spring4shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat as WAR deployment, Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring框架中的远程代码执行漏洞。该漏洞的利用方式是，攻击者通过精心构造的请求，利用Spring的数据绑定功能，修改Tomcat服务器的日志配置，写入恶意JSP文件到服务器的webapps目录下，从而实现远程代码执行。

**有效性评估：**

从提供的漏洞库信息、搜索引擎结果以及漏洞利用代码来看，此漏洞利用的有效性较高。漏洞库信息明确指出存在RCE的可能，并提及了利用条件。搜索引擎结果中包含大量关于该漏洞的分析和利用文章，表明该漏洞已被广泛研究和利用。提供的POC代码实现了利用该漏洞上传webshell的功能，通过修改classloader等属性，将恶意代码写入到目标服务器。执行状态判断表明，POC 至少能够完成webshell的上传过程。

**投毒风险分析：**

仔细分析提供的 exploit1.py 和 exploit2.py 脚本，以及 README.md 文件，主要风险点在于：

*   **硬编码密码：** exploit1.py 中存在默认密码 `thm`，如果攻击者没有修改密码就直接使用，存在被其他恶意用户利用的风险。虽然这不算是代码层面的投毒，但属于配置不当可能导致的风险。
*   **文件名和目录：** 默认的文件名 `tomcatwar.jsp` 和目录 `ROOT` 可能会被监控系统检测到，但这更多是方便利用，而非隐藏的恶意行为。
*   **依赖项风险：** README.md 中提到了 Maven 编译和 Tomcat 依赖，如果使用的 Maven 仓库或 Tomcat 镜像被恶意篡改，可能会引入恶意代码。这属于供应链风险，而非代码本身投毒。
*    **代理服务器风险**: 在 exploit1.py 脚本中，支持通过代理服务器进行连接，虽然是方便进行HTTP消息拦截，但也存在代理服务器收集请求中的敏感信息。这不属于是POC投毒范畴，是属于使用者信息安全范畴。
*   **免责声明和学习目的：** README.md 中声明 PoC 仅用于学习目的，但无法保证使用者不会将其用于非法用途。

综合来看，代码本身没有明显的投毒行为，但存在一些配置风险和依赖项风险，可能被恶意利用。因此，投毒风险评估为 **10%**。这个百分比主要考虑使用者在使用默认配置可能带来的风险以及引入恶意依赖的潜在可能。

**漏洞利用方式：**

1.  **目标环境：** 目标应用运行在 JDK 9+，并且部署在 Tomcat 中，以 WAR 包形式部署。应用使用了 Spring MVC 或 Spring WebFlux 框架。
2.  **构造恶意请求：** 攻击者构造包含恶意参数的 HTTP POST 请求，利用 Spring 的数据绑定功能，修改 Tomcat 的 `AccessLogValve` 组件的属性。
3.  **修改日志配置：** 攻击者通过修改 `pattern` 属性，将恶意 JSP 代码写入到日志文件中。`directory`、`prefix`、`suffix` 和 `fileDateFormat` 属性用于控制日志文件的路径和名称，确保 JSP 代码能够写入到 webapps 目录下，并以 JSP 文件的形式存在。
4.  **上传 Webshell：**  成功修改日志配置后，Tomcat 会将恶意 JSP 代码写入到指定的 webapps 目录下，形成一个 Webshell。
5.  **远程代码执行：**  攻击者通过访问 Webshell 的 URL，执行任意代码，从而控制目标服务器。

**项目地址:** [cxzero/CVE-2022-22965-spring4shell](https://github.com/cxzero/CVE-2022-22965-spring4shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #12

**来源**: [CVE-2022-22965-dbgee_Spring4Shell.md](../2022/CVE-2022-22965-dbgee_Spring4Shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，也被称为 Spring4Shell，是一个 Spring Framework 中的远程代码执行漏洞。该漏洞利用了数据绑定功能，允许攻击者通过构造恶意请求来修改 Tomcat 的访问日志配置，进而写入恶意 Web shell，最终实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，并且存在公开的利用代码。漏洞的有效性取决于目标应用程序是否满足漏洞利用的先决条件：运行在 JDK 9+，部署为 WAR 包在 Tomcat 上，并使用 Spring MVC 或 Spring WebFlux。

**投毒风险：**
提供的代码片段 `/tmp/654a99bf9ba51c6c41107b986ba46894/mvnw` 看起来是 Maven Wrapper 脚本。这个脚本的主要目的是为了在没有安装 Maven 的环境下也能构建 Maven 项目，它本身不包含直接的漏洞利用代码。投毒的风险在于：

*   **依赖项投毒：** 攻击者可能修改 Maven 项目的 `pom.xml` 文件，添加恶意的依赖项。当 Maven Wrapper 构建项目时，会下载并执行这些恶意依赖项中的代码，从而实现投毒。虽然代码片段本身没有恶意，但 Maven 构建过程的性质决定了存在这种风险。
*   **配置投毒：** 攻击者可能篡改 Maven 的配置文件，修改构建过程，插入恶意代码。

考虑到 Maven Wrapper 的功能以及潜在的构建过程篡改，投毒风险评估为10%。

**利用方式：**
根据漏洞信息，利用方式主要包括以下步骤：

1.  **确定目标：** 找到满足漏洞利用条件的 Spring 应用。
2.  **构造恶意请求：** 构造包含恶意参数的 HTTP 请求，这些参数会修改 Tomcat 的访问日志配置。
3.  **写入 Web Shell：** 通过修改访问日志配置，将恶意代码（例如，一个简单的 Web shell）写入到 Tomcat 的 webapps 目录下。
4.  **执行命令：** 通过访问写入的 Web shell，执行任意命令。

总而言之，这是一个高危漏洞，如果目标应用程序满足利用条件，攻击者可以很容易地利用该漏洞执行任意命令。

**项目地址:** [dbgee/Spring4Shell](https://github.com/dbgee/Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #13

**来源**: [CVE-2022-22965-gokul-ramesh_Spring4Shell-PoC-exploit.md](../2022/CVE-2022-22965-gokul-ramesh_Spring4Shell-PoC-exploit.md)

## CVE-2022-22965 Spring4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19 and older versions

**利用条件:** 需要运行在JDK 9+，并且部署为WAR包在Tomcat上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework的远程代码执行漏洞。攻击者可以通过精心构造的请求，利用数据绑定功能操纵ClassLoader，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。漏洞已被公开利用，并有可用的POC。

**投毒风险：**
查看提供的exploit.py代码，代码结构非常简单，主要是一个命令行参数解析器，但run和check函数均未实现，是未完成的POC。直接分析没有发现明显的投毒行为，但是由于代码不完整，未来存在被修改并添加恶意代码的可能性。考虑到仓库本身是PoC性质，以及代码的未完成状态，投毒风险评估为10%。该仓库还引用了其他仓库，需要注意。

**利用方式：**
1.  **目标环境：** 应用程序必须运行在JDK 9+上，并且部署为传统的WAR包在Tomcat服务器中。
2.  **漏洞原理：** 该漏洞源于Spring Framework的数据绑定功能。当使用`RequestMapping`注解和POJO参数时，攻击者可以通过修改`class.module.classLoader`等属性，进而控制Tomcat的日志目录，写入webshell或其他恶意代码。
3.  **攻击步骤（基于已知利用方式）：**
    *   发送包含恶意参数的HTTP请求，例如，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern`属性，将Tomcat的access log配置为webshell。
    *   访问webshell，执行任意代码。

**项目地址:** [gokul-ramesh/Spring4Shell-PoC-exploit](https://github.com/gokul-ramesh/Spring4Shell-PoC-exploit)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #14

**来源**: [CVE-2022-22965-guigui237_Expoitation-de-la-vuln-rabilit-CVE-2022-22965.md](../2022/CVE-2022-22965-guigui237_Expoitation-de-la-vuln-rabilit-CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat作为WAR部署，使用Spring MVC或Spring WebFlux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个在 Spring Framework 中发现的远程代码执行漏洞。攻击者可以通过数据绑定，操纵某些属性来执行任意代码。根据漏洞库信息和搜索结果，漏洞利用的有效性较高，特别是针对使用JDK 9+并以WAR包形式部署在Tomcat上的Spring应用。

**利用方式：**

1.  **利用条件:**  需要满足以下条件：
    *   运行在 JDK 9 或更高版本。
    *   Spring MVC 或 Spring WebFlux 应用。
    *   部署为 Tomcat WAR 包。
    *   使用受影响的 Spring Framework 版本 (5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+)。
2.  **漏洞原理:** 通过操纵 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 属性，修改Tomcat的日志配置，写入webshell到可访问的目录。
3.  **利用步骤:**
    *   发送恶意构造的HTTP请求，包含精心设计的参数，以修改Tomcat的日志设置，将日志输出到Web可访问的目录。
    *   日志内容包含恶意代码，例如JSP webshell。
    *   通过访问webshell的URL，执行任意命令。

提供的漏洞利用代码 (`spring4shell.py`) 旨在自动化上述过程。

**投毒风险分析：**

提供的Python脚本`spring4shell.py`主要功能是利用CVE-2022-22965漏洞，通过修改Tomcat日志配置写入webshell，从而实现远程代码执行。虽然该脚本本身是为了攻击利用而编写的，但仍然存在潜在的投毒风险，尤其是在使用者直接下载并使用未经仔细审查的代码时。

具体分析如下：

*   **风险点1：**  脚本中可能会包含恶意代码，例如植入后门、收集敏感信息并外传等。虽然目前的代码片段看起来相对直接，主要关注漏洞利用，但攻击者可以很容易地添加额外的恶意功能。
*   **风险点2：**  该脚本依赖于第三方库 (`requests`, `bs4`)，这些库本身可能存在安全漏洞，或者被攻击者替换为恶意版本。虽然`pip3 install bs4` 和 `pip3 install requests`  是安装常用库，但如果源被劫持，可能会安装恶意版本。
*   **风险点3：**  脚本中的默认参数，例如webshell的文件名、密码、上传目录等，可能被攻击者利用。如果攻击者能够预测或控制这些参数，就可以更容易地进行后续攻击。

由于存在以上潜在风险，在使用任何公开的漏洞利用代码之前，都必须进行彻底的安全审查，确保代码的安全性和可靠性。此外，建议修改默认参数，增加攻击难度。

**投毒风险评估：**
考虑到代码功能相对集中于漏洞利用，且作者也给出了GitHub地址，初步判断投毒的可能性较低，但不能完全排除。综合评估，投毒风险为10%。这个概率考虑到作者可能隐藏恶意代码，或者将来代码仓库被入侵后植入恶意代码的情况。

**项目地址:** [guigui237/Expoitation-de-la-vuln-rabilit-CVE-2022-22965](https://github.com/guigui237/Expoitation-de-la-vuln-rabilit-CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #15

**来源**: [CVE-2022-22965-jakabakos_CVE-2022-22965-Spring4Shell.md](../2022/CVE-2022-22965-jakabakos_CVE-2022-22965-Spring4Shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions on JDK 9+ with Tomcat as WAR deployment.

**利用条件:** 需要目标应用使用存在漏洞的Spring Framework版本，运行在JDK 9+，部署为WAR包到Tomcat服务器，并且使用了受影响的Spring MVC或Spring WebFlux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个Spring Framework中的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过数据绑定利用某些特性来执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞影响运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序，并且这些应用程序必须以WAR包形式部署在Tomcat服务器上。如果应用部署为Spring Boot可执行jar，则不受影响。漏洞利用代码通过以下步骤实现RCE：

1.  **重置日志变量:** 通过修改`fileDateFormat`参数来初始化。
2.  **修改Tomcat日志配置:** 攻击者通过精心构造的请求，修改Tomcat的日志配置，将日志输出格式设置为包含可以执行命令的JSP代码。
3.  **写入 Webshell:**  通过header头传递包含Runtime的参数和命令执行的逻辑，通过修改过的日志配置写入webshell到服务器的webapps目录下。
4.  **命令执行:** 攻击者可以通过访问写入的webshell，传递`cmd`参数来执行任意命令。
5.  **清理日志变量:** 清理之前修改的日志变量，防止恶意写入。

**有效性:** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该POC代码是有效的，利用了不安全的配置修改来写入 Webshell.

**投毒风险评估:** 此仓库的投毒风险较低，约10%。Dockerfile中使用lunasec/tomcat-9.0.59-jdk11作为基础镜像，这本身具备一定的安全性，maven构建流程相对标准，没有发现明显的恶意代码注入行为，最主要的风险点在于`vulnerable-app`目录下的源代码，如果该目录下的源代码包含恶意代码，则可能存在投毒风险。

**利用方式总结:** 该漏洞的利用方式是先修改Tomcat的日志配置，将日志输出重定向到Web目录，并设置日志内容为可执行的JSP代码。然后，发送包含恶意代码的请求，使Tomcat将JSP代码写入日志文件，从而在Web目录中创建一个webshell。攻击者可以通过访问webshell执行任意命令，实现远程代码执行。

**项目地址:** [jakabakos/CVE-2022-22965-Spring4Shell](https://github.com/jakabakos/CVE-2022-22965-Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #16

**来源**: [CVE-2022-22965-jashan-lefty_Spring4Shell.md](../2022/CVE-2022-22965-jashan-lefty_Spring4Shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat WAR deployment, Spring MVC or Spring WebFlux application

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个远程代码执行漏洞，存在于Spring Framework中。根据漏洞信息，该漏洞只在特定条件下可被利用，即：

*   运行在JDK 9+之上。
*   以WAR包形式部署在Tomcat上。
*   使用了Spring MVC或Spring WebFlux。

**POC有效性评估：**

提供的`test.py`脚本尝试利用此漏洞。它通过修改`class.module.classLoader.resources.context.parent.pipeline.first`属性来写入恶意JSP文件到Tomcat的webapps/ROOT目录下，从而实现RCE。脚本尝试设置`pattern`属性（用于定义JSP文件的内容，包含后门代码），`suffix`属性（设置为.jsp），`directory`属性（设置为webapps/ROOT），`prefix`属性（设置为tomcatwar），以及`fileDateFormat`属性。

根据搜索引擎结果，此漏洞在野外已被积极利用，并且存在公开的POC。`test.py`脚本中的payload结构与公开的Spring4Shell利用方式相符，所以该POC代码有效。

**投毒风险评估：**

该仓库包含三个文件：`README.md`，`fw_handler.py` 和 `test.py`。

*   `README.md` 描述了对漏洞的分析和防御措施，无投毒风险。
*   `fw_handler.py` 实现了简单的防火墙，用于阻止包含特定payload的请求，用于防御攻击，无投毒风险。
*   `test.py` 包含漏洞利用代码，旨在验证漏洞是否存在。它通过发送包含特定payload的POST请求，尝试在目标服务器上写入恶意的JSP文件。该文件的目的是创建一个后门，允许通过`pwd`和`cmd`参数执行任意命令。此部分**并非**投毒代码，而是漏洞验证和利用的一部分。

虽然整个仓库的主题是关于漏洞分析和防御，但 `test.py` 中的利用代码如果被恶意使用，可能会导致安全风险。但就仓库本身而言，作者直接植入恶意代码的可能性较低，`fw_handler.py`反而是防御手段, 漏洞利用代码本身是利用漏洞的手段，不应被视为投毒。投毒风险较低，估计为10%。这个10%主要考虑的是仓库的维护者可能被黑客入侵，然后植入恶意代码。

**利用方式总结：**

1.  攻击者发送特制的HTTP请求，其中包含用于修改`class.module.classLoader.resources.context.parent.pipeline.first`属性的payload。
2.  这些属性的修改允许攻击者在Tomcat的webapps/ROOT目录下写入任意JSP文件。
3.  写入的JSP文件包含恶意代码（例如一个Webshell）。
4.  攻击者可以通过访问该JSP文件来执行任意命令，从而控制服务器。

**项目地址:** [jashan-lefty/Spring4Shell](https://github.com/jashan-lefty/Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #17

**来源**: [CVE-2022-22965-likewhite_CVE-2022-22965.md](../2022/CVE-2022-22965-likewhite_CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat (WAR deployment), Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过构造恶意请求来执行任意代码。根据漏洞库信息，该漏洞存在于运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序中，并且需要以WAR包形式部署在Tomcat服务器上。如果应用部署为Spring Boot可执行jar包，则不易受此漏洞影响。搜索结果证实了该漏洞的存在，并指出该漏洞易于利用。提供的POC代码尝试利用数据绑定漏洞，通过修改 Tomcat 的 AccessLogValve 的属性来写入 webshell。该利用代码的有效性取决于目标系统是否满足漏洞利用的条件，包括 Spring 版本、JDK 版本、部署方式和 Tomcat 配置等。虽然`teamserver`和`readme.md`文件看起来不相关，但`CVE-2022-22965.py`文件本身并未发现明显的恶意代码。`teamserver`文件是Cobalt Strike的启动脚本，与漏洞利用无关。`readme.md`只是描述了漏洞和利用条件，并没有包含恶意代码。考虑到网络资源可能被篡改的风险，依然存在轻微的投毒可能（5%），但目前无法直接从代码中得出结论。

**利用方式：**

1.  **发送恶意请求：** 攻击者发送包含恶意参数的HTTP请求到目标Spring应用程序。
2.  **修改AccessLogValve：**  利用Spring的数据绑定功能，动态修改Tomcat的AccessLogValve组件的属性，例如`directory`，`prefix`，`suffix`和`pattern`。
3.  **写入Webshell：** 通过修改`pattern`属性，将一段包含恶意代码（例如，执行系统命令）的JSP代码写入到指定的目录和文件名的Webshell中。
4.  **执行Webshell：**  攻击者访问写入的Webshell，并传递命令参数，从而在服务器上执行任意代码。

**项目地址:** [likewhite/CVE-2022-22965](https://github.com/likewhite/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #18

**来源**: [CVE-2022-22965-osungjinwoo_CVE-2022-22965.md](../2022/CVE-2022-22965-osungjinwoo_CVE-2022-22965.md)

## CVE-2022-22965 - Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 和所有旧的和不支持的版本

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 Spring4Shell，允许未经身份验证的远程代码执行。利用方式是通过数据绑定，修改 Tomcat 的 AccessLogValve 组件属性，写入恶意 webshell 文件到 webapps 目录下。漏洞利用依赖于特定的环境配置，包括 JDK 9+，部署为 WAR 包的 Tomcat，以及使用了受影响版本的 Spring Framework。提供的 Python 和 Bash 脚本均旨在利用此漏洞。存在轻微投毒风险，主要体现在脚本可能包含下载其他恶意文件的代码或者修改服务器配置等，但主要功能是实现RCE，投毒风险较低。

**有效性分析:** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是真实存在的，并且有积极的利用案例。POC 代码尝试修改 Tomcat 的日志配置以写入 Webshell，这是一种已知的利用方式，因此提供的POC代码**有效**。

**投毒风险分析:** 查看提供的脚本`spring4shell.py`和`spring4shell.sh`，脚本主要功能是利用漏洞上传webshell，没有明显的恶意行为比如删除文件，反向连接恶意服务器等。`README.md`中引用了外部链接，存在一定的跳转风险，但代码本身主要是为了演示漏洞利用，故投毒风险较低，判断为10%。

**利用方式:**

1.  **漏洞原理：**  攻击者通过操纵 class.module.classLoader.resources.context.parent.pipeline.first 的属性，修改 Tomcat AccessLogValve 的配置，特别是 pattern 属性。
2.  **攻击过程：**
    *   构造包含恶意代码的请求，通过 Spring 的数据绑定功能，修改 Tomcat 的 AccessLogValve 组件的 pattern 属性，将恶意代码写入日志文件中。
    *   由于 Tomcat 的日志文件通常位于 webapps 目录下，因此恶意代码实际上被写入了一个 JSP 文件（webshell）。
    *   攻击者通过访问该 JSP 文件，执行任意命令。
3.  **POC代码分析:**
    *   `spring4shell.py` 脚本使用 `requests` 库发送 POST 请求，包含构造的恶意数据，目标 URL 是存在漏洞的 Spring 应用。
    *   `spring4shell.sh` 脚本同样发送构造的 HTTP 请求，修改 Tomcat 的 AccessLogValve 组件属性。
    *   两个脚本都设置了webshell密码，上传目录，webshell文件名，攻击成功后通过webshell url进行命令执行。
4.  **先决条件：**
    *   目标应用运行在 JDK 9+ 上。
    *   目标应用部署为 WAR 包到 Tomcat 上。
    *   目标应用使用了受影响版本的 Spring Framework。
    *   需要目标服务器能够访问

**项目地址:** [osungjinwoo/CVE-2022-22965](https://github.com/osungjinwoo/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #19

**来源**: [CVE-2022-22965-salo-404_firewall.md](../2022/CVE-2022-22965-salo-404_firewall.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 和所有旧的、不受支持的版本

**利用条件:** 需要运行在JDK 9+的Spring MVC或Spring WebFlux应用，并且部署在Tomcat上作为WAR包。另外，服务器需存在可写目录。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞利用了数据绑定功能，允许攻击者通过修改classLoader来写入恶意web shell,从而导致RCE。 

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实且可被利用的。提供的漏洞利用代码模拟了一个防火墙，用于防御Spring4Shell攻击，本身不包含攻击载荷，但是能够检测利用尝试，这间接证明了此漏洞的可利用性。

**投毒风险：**
提供的代码仓库主要包含一个模拟防火墙的Python脚本（firewall_server.py）。该脚本的目的是检测并阻止Spring4Shell漏洞的利用。审查该脚本后，发现它主要通过检查HTTP POST数据中的恶意键、header、有效载荷特征来工作。没有发现任何迹象表明作者试图在代码中隐藏任何恶意功能或后门。因此，投毒风险较低，约为10%。风险主要来自于对于拦截规则的绕过和未来潜在的恶意修改。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于Spring框架的数据绑定功能，它允许将HTTP请求参数自动绑定到Java对象的属性上。攻击者可以利用这一点，通过构造恶意的请求参数，修改`classLoader`等关键对象，从而实现远程代码执行。
2.  **利用条件：**
    *   运行在JDK 9+的Spring MVC或Spring WebFlux应用。
    *   部署在Tomcat上作为WAR包（Spring Boot可执行jar默认部署方式不受影响）。
    *   目标应用存在可写目录
3.  **攻击步骤：**
    *   攻击者发送包含恶意参数的HTTP POST请求到存在漏洞的端点。
    *   恶意参数会修改Tomcat的日志目录、URI编码等配置。
    *   攻击者上传包含恶意代码的JSP文件到修改后的日志目录，从而创建一个webshell。
    *   攻击者通过访问该webshell执行任意代码。

**项目地址:** [salo-404/firewall](https://github.com/salo-404/firewall)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #20

**来源**: [CVE-2022-22965-shoucheng3_spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE.md](../2022/CVE-2022-22965-shoucheng3_spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 和所有旧的以及不支持的版本

**利用条件:** JDK 9+，Tomcat 作为 WAR 部署，受影响的 Spring Framework 版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22965，又名Spring4Shell，是Spring Framework中的一个远程代码执行漏洞。它允许攻击者通过数据绑定在运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序上执行任意代码。特定的利用方式要求应用程序部署为Tomcat上的WAR包。漏洞利用方式：利用 Spring 框架的数据绑定功能，通过操纵类加载器和访问日志等属性，将恶意代码注入到服务器中，最终实现远程代码执行。提供的代码主要是贡献者行为准则和提交规范，不包含后门代码,存在轻微投毒的可能性，例如，篡改贡献指南以包含恶意链接，但直接 RCE 利用的可能性为低。

**项目地址:** [shoucheng3/spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE](https://github.com/shoucheng3/spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #21

**来源**: [CVE-2022-22965-sohamsharma966_Spring4Shell-CVE-2022-22965.md](../2022/CVE-2022-22965-sohamsharma966_Spring4Shell-CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 依赖 spring-webmvc 和/或 spring-webflux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个 Spring Framework 中的远程代码执行漏洞。利用方式如下：

1.  **漏洞原理：** 利用了 Spring Framework 在 JDK 9+ 版本中，使用数据绑定功能时，由于类加载器机制的改变，攻击者可以通过修改 `class.module.classLoader.resources.context.parent.pipeline.first` 的属性，来修改 Tomcat 的 access log valve 的配置，从而写入恶意 JSP 文件。

2.  **利用条件：**
    *   JDK 9+
    *   受影响的 Spring Framework 版本
    *   Tomcat 作为 WAR 部署
    *   依赖 spring-webmvc 和/或 spring-webflux

3.  **利用步骤：**
    *   攻击者发送包含恶意参数的 HTTP 请求到目标服务器。
    *   这些恶意参数修改 Tomcat 的 access log valve 配置，将 pattern 设置为包含恶意代码的 JSP。
    *   Tomcat 将恶意代码写入到 webapps/ROOT 目录下，形成一个 JSP shell 文件。
    *   攻击者通过访问 JSP shell 文件执行任意代码。

4.  **POC 代码分析：** 提供的 `exploit.py` 脚本实现了上述攻击流程。
    *   脚本构造了包含恶意参数的 POST 请求，这些参数用于修改 Tomcat 的 access log valve 配置。
    *   `headers` 字典定义了请求头，`data` 变量定义了 POST 请求的数据，包含了修改 access log valve 的 payload。
    *   脚本发送 POST 请求到目标 URL，然后尝试访问生成的 JSP shell 文件。
    *   如果 JSP shell 文件成功生成并可以访问，脚本会输出 shell 的 URL。

5.  **有效性：** 根据漏洞信息和搜索引擎结果，该POC代码是有效的，可以成功利用该漏洞在满足条件的服务器上执行任意代码。

6.  **投毒风险：** 该POC代码的功能是利用漏洞在目标服务器上部署一个 JSP shell， 允许远程执行命令。脚本本身并没有发现任何隐藏的、超出此范围的恶意行为，即没有发现任何投毒代码。因此，投毒风险评估为0%。该脚本的功能与漏洞利用本身相关，旨在验证和利用漏洞，而不是植入恶意后门。

简而言之，该漏洞利用方式是通过操纵Tomcat的日志配置来写入恶意JSP文件，从而实现远程代码执行。提供的POC代码能够有效地实现这一攻击，且没有明显的投毒迹象。

**项目地址:** [sohamsharma966/Spring4Shell-CVE-2022-22965](https://github.com/sohamsharma966/Spring4Shell-CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #22

**来源**: [CVE-2022-22965-sunnyvale-it_CVE-2022-22965-PoC.md](../2022/CVE-2022-22965-sunnyvale-it_CVE-2022-22965-PoC.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** Spring Framework 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 以及所有旧的、不受支持的版本，运行在JDK 9+且部署为WAR包到Tomcat服务器上

**利用条件:** 目标应用必须满足：使用Spring MVC或Spring WebFlux，运行在JDK 9+，部署为WAR包到Tomcat服务器上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework的远程代码执行漏洞，通过数据绑定利用。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者通过修改`class.module.classLoader.resources.context.parent.pipeline.first`相关的属性（如`directory`, `prefix`, `suffix`, `pattern`等），来控制Tomcat的日志记录行为，最终写入一个恶意JSP webshell。
2.  **利用步骤：**
    *   首先，利用POST请求重置`fileDateFormat`属性。
    *   然后，通过POST请求设置Tomcat日志配置，包括日志目录、文件名前缀、后缀和包含恶意代码的日志模式，这些参数被编码在URL中。
    *   发送一个GET请求，触发日志记录，并将恶意JSP webshell写入到目标服务器上。
    *   webshell地址为`http://目标/前缀.jsp?cmd=命令`。
3.  **有效性：** 提供的POC代码是有效的，根据README的说明，可以成功在满足漏洞条件的服务器上执行任意命令。
4.  **投毒风险：**  虽然主要代码是为了利用漏洞，但仍存在一定的投毒风险。例如，`exploit-core.py`脚本中，恶意代码的写入目标（JSP webshell）是硬编码的。攻击者可能通过修改这些参数，在服务器上植入更隐蔽或更具破坏性的后门。Dockerfile中的lunasec/tomcat-9.0.59-jdk11镜像来源未经验证，有可能包含恶意代码，但是此仓库的重点在于spring漏洞利用。假设Dockerfile中的基础镜像没有问题，投毒风险比例约为10%。
5.  **总结：** 此漏洞的利用需要精心构造的HTTP请求，利用Spring的数据绑定机制，动态地修改Tomcat服务器的日志配置，最终达到远程代码执行的目的。这个过程对目标服务器的环境有一定要求，需要特定的Spring版本、JDK版本和部署方式。POC代码的有效性已经确认，但使用时需要注意潜在的投毒风险。

**项目地址:** [sunnyvale-it/CVE-2022-22965-PoC](https://github.com/sunnyvale-it/CVE-2022-22965-PoC)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #23

**来源**: [CVE-2022-22965-viniciuspereiras_CVE-2022-22965-poc.md](../2022/CVE-2022-22965-viniciuspereiras_CVE-2022-22965-poc.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，Tomcat作为WAR部署

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22965（Spring4Shell）是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞利用了在JDK 9+环境下，Spring MVC或Spring WebFlux应用的数据绑定功能。攻击者通过构造恶意的请求，修改classloader中的属性，进而控制Tomcat的日志记录行为，最终写入webshell，实现远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被积极利用，并且存在公开可用的POC代码。提供的POC代码利用了修改 Tomcat access log pattern 的方式写入 webshell，从而实现远程代码执行。

**投毒风险：**

检查提供的POC代码后，虽然POC利用了常见的漏洞利用方法（写入Webshell），但代码中包含一个密码验证逻辑 `--password`。如果攻击者不提供正确的密码，webshell将无法执行命令，从而增加了防御的难度，存在一定概率为后门，但概率较低。虽然webshell的写入行为本身具有一定的风险，但整体代码较为直接，投毒可能性较低。风险预估为1%。

**利用方式：**

1.  攻击者发送精心构造的HTTP请求到目标Spring应用。
2.  请求中包含的参数利用Spring的数据绑定机制，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern` 属性，将恶意代码（例如，webshell）写入Tomcat的access log pattern。
3.  访问目标应用的相应URL，触发webshell执行。
4.  攻击者通过webshell执行任意命令，实现远程代码执行。

**项目地址:** [viniciuspereiras/CVE-2022-22965-poc](https://github.com/viniciuspereiras/CVE-2022-22965-poc)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #24

**来源**: [CVE-2022-22965-xsxtw_SpringFramework_CVE-2022-22965_RCE.md](../2022/CVE-2022-22965-xsxtw_SpringFramework_CVE-2022-22965_RCE.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat as WAR deployment, Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个Spring Framework的远程代码执行漏洞。攻击者可以通过操纵classloader来写入webshell或者执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用条件较为苛刻，需要JDK 9+，并且应用必须部署为WAR包在Tomcat上运行。如果应用以Spring Boot executable jar（默认方式）部署，则不易受到该漏洞影响。

**有效性分析：**
提供的POC代码是有效的。POC利用了Spring Data Binding的特性，通过修改class.module.classLoader.resources.context.parent.pipeline.first的值，修改了Tomcat的access log pattern，从而写入webshell。通过webshell的`Tomcat=S&cmd=`参数可以执行任意命令。

**投毒风险分析：**
提供的POC代码本身没有明显的投毒行为。它直接利用了漏洞来执行命令，没有进行任何尝试来修改或破坏目标系统上的其他文件或组件。代码目的明确，就是利用漏洞执行给定的命令，没有发现其他恶意意图的代码，因此投毒风险可以评估为0%。

**利用方式：**
利用方式主要是通过发送特制的HTTP POST请求，请求体中包含恶意的参数，这些参数用于修改Tomcat的access log pattern。具体步骤如下：

1.  发送包含恶意参数的POST请求，例如：
    ```
    class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22S%22.equals(request.getParameter(%22Tomcat%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%25%7Bsuffix%7Di&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix=Shell&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=
    ```
2.  上述请求会在`webapps/ROOT`目录下创建一个名为`Shell.jsp`的webshell。 webshell内容是读取`cmd`参数并执行。
3.  访问webshell，并通过`Tomcat=S&cmd=`参数执行任意命令，例如：
    ```
    http://target.com/Shell.jsp?Tomcat=S&cmd=whoami
    ```

攻击者可以利用这个webshell执行任意系统命令，从而控制服务器。

**项目地址:** [xsxtw/SpringFramework_CVE-2022-22965_RCE](https://github.com/xsxtw/SpringFramework_CVE-2022-22965_RCE)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #25

**来源**: [CVE-2022-22965-zangcc_CVE-2022-22965-rexbb.md](../2022/CVE-2022-22965-zangcc_CVE-2022-22965-rexbb.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions，JDK 9+，Tomcat 作为 WAR 部署

**利用条件:** Spring MVC 或 Spring WebFlux 应用程序，运行在 JDK 9+ 上，部署为 WAR 包在 Tomcat 上。需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名 Spring4Shell，是一个Spring框架中的远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过数据绑定利用不当的输入验证，在目标系统上执行任意代码。漏洞利用依赖于以下条件：

*   **受影响的Spring版本：** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions
*   **JDK 版本：** JDK 9 及以上
*   **部署方式：** 应用必须部署为 WAR 包在 Tomcat 上运行，而不是 Spring Boot 可执行 JAR。
*   **利用方式：**  攻击者通过构造恶意的HTTP请求，利用Spring的数据绑定功能修改`class.module.classLoader.resources.context.parent.pipeline.first`等属性，从而写入恶意JSP Webshell到Tomcat服务器，进而执行任意命令。

**漏洞利用代码分析：**

提供的漏洞利用代码是一个基于 JavaFx 开发的图形化工具 (Rexbb.jar)。它简化了漏洞利用过程，主要功能包括：

1.  **发送 Payload：**  自动构造和发送包含恶意参数的 HTTP 请求，利用 Spring 的数据绑定漏洞。
2.  **RCE 检测：**  在成功写入 Webshell 后，执行任意命令，并将结果回显。
3.  **命令执行：**  允许用户输入自定义命令，并在目标系统上执行。

该工具通过图形界面封装了漏洞利用的细节，降低了利用门槛。

**投毒风险分析：**

该POC工具本身存在一定的投毒风险。虽然主要功能是利用Spring4Shell漏洞，但作者可能在代码中加入恶意逻辑，例如：

*   **后门植入：**  在 Webshell 中添加额外的后门，方便攻击者长期控制目标系统。
*   **信息窃取：**  在命令执行过程中，收集敏感信息并发送到攻击者控制的服务器。
*   **恶意传播：**  利用漏洞感染其他系统。

由于无法直接审查 Rexbb.jar 的源代码，因此存在一定的信任风险。建议在使用此类工具时，保持警惕，在安全隔离的环境中进行测试，并进行代码审计，以确保工具的安全性。

**投毒可能性评估：**

虽然不能确定是否存在投毒代码，但根据代码的性质，作者具备植入恶意代码的可能性。相对来说，作者详细说明了POC使用方式以及原理，降低了投毒可能性。因此，评估投毒风险为10%。

**项目地址:** [zangcc/CVE-2022-22965-rexbb](https://github.com/zangcc/CVE-2022-22965-rexbb)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---



---

## POC #7

**来源**: [CVE-2022-22965-Nosie12_fire-wall-server.md](../2022/CVE-2022-22965-Nosie12_fire-wall-server.md)

## CVE-2022-22965 Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个高危的远程代码执行漏洞，影响运行在 JDK 9+ 上的 Spring MVC 或 Spring WebFlux 应用，并且需要部署在 Tomcat 中，以 WAR 包的形式部署。漏洞利用方式是通过数据绑定，允许攻击者传入恶意构造的请求参数，修改 Tomcat 的 AccessLogValve 组件，从而写入 webshell 或执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用确实存在并且被广泛讨论和利用。提供的Python代码实际上是一个防火墙脚本，用于检测和阻止利用 Spring4Shell 漏洞的恶意请求，而不是漏洞利用代码本身。它通过检测请求路径和请求体中是否存在已知的恶意模式来工作。因此，提供的 Python 代码并不能直接验证漏洞的有效性，但是可以作为防御措施。

**投毒风险：**
对提供的 Python 代码 `firewall_server.py` 进行了分析，该脚本的功能是检测和阻止包含特定恶意模式的HTTP请求。脚本中定义了 `BLOCKED_PATTERNS` 列表，其中包含了诸如 `/tomcatwar.jsp`，`class.module.classLoader.resources.context.parent.pipeline` 和一些编码后的字符串等模式。脚本会检查传入的请求路径和请求体，如果发现任何匹配的模式，它将返回一个 `403 Forbidden` 响应。因此，从代码的功能和内容来看，该脚本本身不包含任何投毒代码。可以认为投毒风险为 0%。

**利用方式：**
根据漏洞信息，Spring4Shell 的利用方式如下：
1.  攻击者发送一个包含恶意构造的请求，该请求的目标是 Spring MVC 或 Spring WebFlux 应用。
2.  恶意请求中的参数会利用 Spring 的数据绑定机制，尝试修改 Tomcat 的 AccessLogValve 组件的属性。
3.  通过修改 AccessLogValve 的属性，攻击者可以控制日志文件的位置和格式，从而写入任意代码（例如，一个 webshell）。
4.  一旦 webshell 被写入，攻击者就可以通过它来执行任意命令，从而控制服务器。

**项目地址:** [Nosie12/fire-wall-server](https://github.com/Nosie12/fire-wall-server)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #8

**来源**: [CVE-2022-22965-ZapcoMan_spring4shell-vulnerable-application.md](../2022/CVE-2022-22965-ZapcoMan_spring4shell-vulnerable-application.md)

## CVE-2022-22965-Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 使用Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，评估如下：

**有效性：**
该漏洞利用代码提供了一个可 docker 化的应用程序，容易受到 Spring4Shell 漏洞 (CVE-2022-22965) 的攻击。Dockerfile 使用了特定版本的 Tomcat 镜像 (lunasec/tomcat-9.0.59-jdk11)，该版本在漏洞修复之前。pom.xml 文件配置了 Spring Boot 版本 2.6.3，该版本可能受漏洞影响（具体取决于 Spring Framework 的版本）。构建过程包括使用 Maven 打包应用程序为 WAR 文件，并将其部署到 Tomcat 的 webapps 目录。描述文件也描述这是一个POC。

**投毒风险：**
该 POC 仓库的主要目的是演示 CVE-2022-22965 漏洞。然而，始终存在代码中包含恶意或后门代码的风险，即使作者的意图是良性的。代码中检测到投毒代码的风险较低。风险估计为 10%，原因如下：

*   Dockerfile：它下载了一个指定的tomcat版本，如果该docker存在后门，则存在风险
*   `README.md` 推荐了LunaSec的分支，可以推断是官方的。

**利用方式：**
该漏洞允许未经身份验证的远程代码执行。利用方式涉及操纵类加载器和 servlet 上下文以写入恶意 JSP 文件到 Tomcat 的 webapp 目录中，然后攻击者可以通过发送特定构造的 HTTP 请求来触发该 JSP 文件。

总体而言，该 POC 代码似乎有效，但使用和部署 POC 需要谨慎，尤其是在生产环境中。始终建议在安全隔离的环境中进行测试，并仔细审查代码是否存在潜在的恶意代码。

**项目地址:** [ZapcoMan/spring4shell-vulnerable-application](https://github.com/ZapcoMan/spring4shell-vulnerable-application)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #9

**来源**: [CVE-2022-22965-bL34cHig0_Telstra-Cybersecurity-Virtual-Experience-.md](../2022/CVE-2022-22965-bL34cHig0_Telstra-Cybersecurity-Virtual-Experience-.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat (WAR deployment), 存在RequestMapping和POJO参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965，又名 Spring4Shell，是一个Spring Framework的远程代码执行漏洞。根据漏洞库信息，运行在JDK 9+的Spring MVC或Spring WebFlux应用可能受到影响。该漏洞利用需要应用部署为Tomcat WAR包。如果部署为Spring Boot可执行jar，则不受影响。漏洞利用方式是利用数据绑定，将恶意属性写入到`class.module.classLoader.resources.context.parent.pipeline.first.pattern`等属性中，最终写入恶意webshell。

**有效性评估：**
根据搜索结果，该漏洞已被积极利用。

**利用方式：**
攻击者通过发送包含恶意参数的HTTP请求，利用Spring的数据绑定功能修改Tomcat的日志配置，写入webshell。webshell的路径和文件名可以通过请求参数指定。攻击者可以通过webshell执行任意代码。

**投毒风险分析：**
提供的代码是一个防火墙脚本，旨在阻止利用CVE-2022-22965的恶意请求。它通过检查请求路径和HTTP头来识别恶意流量，并返回403 Forbidden错误。此代码本身**不包含任何恶意功能或后门**，因此，投毒风险评估为0%。它主要通过正则表达式来匹配恶意请求，如请求路径包含`/tomcatwar.jsp`或者HTTP头部包含`suffix=%>//`等特征。这个脚本的目的是防御Spring4Shell攻击，而不是利用它。

**项目地址:** [bL34cHig0/Telstra-Cybersecurity-Virtual-Experience-](https://github.com/bL34cHig0/Telstra-Cybersecurity-Virtual-Experience-)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #10

**来源**: [CVE-2022-22965-brunoh6_web-threat-mitigation.md](../2022/CVE-2022-22965-brunoh6_web-threat-mitigation.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 并且应用使用了Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个存在于Spring Framework中的远程代码执行漏洞。攻击者可以通过精心构造的请求，利用数据绑定机制，修改 Tomcat 的 AccessLogValve 组件的属性，从而写入恶意 WebShell 到服务器，最终实现 RCE。

**漏洞利用有效性:**
根据漏洞库信息和搜索结果，该漏洞在特定环境下（JDK 9+, Tomcat WAR部署）可以被成功利用。提供的POC代码（`web-threat-mitigation`仓库）也证实了这一点，该仓库提供了一个使用Metasploit进行漏洞利用的示例，展示了在有WAF和无WAF的情况下，利用的成功与失败。因此，可以判断POC代码是有效的。

**投毒风险:**
分析提供的代码仓库，主要是演示如何检测和缓解web应用程序威胁，通过 OWASP ZAP, Burp Suite, 和 ModSecurity WAF。它还包括了CVE-2022-22965 (Spring4Shell)的漏洞利用。代码仓库中没有明显的恶意代码或者后门, 但是考虑到任何人都可以修改和传播这些代码，以及实际环境中可能存在的复杂性，仍然不能完全排除投毒的可能。 风险估计为5%。

**利用方式:**
1.  **确定目标环境:**  检查目标应用程序是否满足漏洞利用的先决条件 (Spring MVC/WebFlux, JDK 9+, Tomcat WAR部署)。
2.  **发送恶意请求:**  构造包含恶意参数的HTTP请求，利用Spring的数据绑定机制，修改Tomcat的`AccessLogValve`组件属性。
3.  **写入WebShell:** 通过修改`directory`、`prefix`、`suffix`和`pattern`属性，将WebShell写入到服务器上的可访问目录。
4.  **执行命令:**  通过访问写入的WebShell，执行任意命令，实现远程代码执行。

**防御建议:**
*   升级Spring Framework到不受影响的版本 (5.3.18+, 5.2.20+)。
*   使用WAF (如ModSecurity) 并配置OWASP CRS来检测和阻止恶意请求。
*   限制数据绑定的使用，避免将用户输入直接绑定到敏感对象属性。

**项目地址:** [brunoh6/web-threat-mitigation](https://github.com/brunoh6/web-threat-mitigation)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #11

**来源**: [CVE-2022-22965-c33dd_CVE-2022-22965.md](../2022/CVE-2022-22965-c33dd_CVE-2022-22965.md)

## CVE-2022-22965 - Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965 (Spring4Shell) 是一种远程代码执行漏洞，存在于 Spring Framework 中。根据漏洞库信息和搜索结果，攻击者可以通过数据绑定利用此漏洞，向某些参数传递特制的恶意请求，从而获得对服务器的控制权。

**利用方式：**

1.  **目标：** 目标应用程序需要运行在 JDK 9 或更高版本上，并且部署为 Tomcat WAR 包。使用 Spring MVC 或 Spring WebFlux 框架。
2.  **漏洞触发：** 漏洞利用涉及操纵类加载器绕过安全机制。通过修改 Tomcat 的 AccessLogValve 组件，可以写入恶意 Web shell。
3.  **具体步骤：** 攻击者发送包含恶意参数的 HTTP 请求。这些参数被 Spring 的数据绑定机制处理，导致 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 属性被修改，从而写入 Web shell 到服务器的可访问位置。
4.  **代码分析：** 提供的POC代码是一个C程序，该程序尝试通过HTTP请求与目标服务器通信，并检查响应状态码以确定漏洞是否存在。关键部分在于构造特定的HTTP头，例如`suffix`和`c1`，以利用数据绑定漏洞。代码中没有发现明显的投毒代码。

**有效性：**

提供的C代码片段看起来像是漏洞利用的前期检查工具，用于验证目标是否存在漏洞。它通过发送包含特定header的HTTP请求并检查响应来尝试利用该漏洞。如果服务器返回 2XX 状态码，则认为漏洞存在。

**投毒风险：**

仔细审查提供的C代码后，没有发现任何可疑的、恶意的或隐藏的后门代码。代码的功能主要是发送HTTP请求，读取响应，并根据响应码判断漏洞是否存在。 因此，评估的投毒风险为 0%。

**项目地址:** [c33dd/CVE-2022-22965](https://github.com/c33dd/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #12

**来源**: [CVE-2022-22965-cxzero_CVE-2022-22965-spring4shell.md](../2022/CVE-2022-22965-cxzero_CVE-2022-22965-spring4shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat as WAR deployment, Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring框架中的远程代码执行漏洞。该漏洞的利用方式是，攻击者通过精心构造的请求，利用Spring的数据绑定功能，修改Tomcat服务器的日志配置，写入恶意JSP文件到服务器的webapps目录下，从而实现远程代码执行。

**有效性评估：**

从提供的漏洞库信息、搜索引擎结果以及漏洞利用代码来看，此漏洞利用的有效性较高。漏洞库信息明确指出存在RCE的可能，并提及了利用条件。搜索引擎结果中包含大量关于该漏洞的分析和利用文章，表明该漏洞已被广泛研究和利用。提供的POC代码实现了利用该漏洞上传webshell的功能，通过修改classloader等属性，将恶意代码写入到目标服务器。执行状态判断表明，POC 至少能够完成webshell的上传过程。

**投毒风险分析：**

仔细分析提供的 exploit1.py 和 exploit2.py 脚本，以及 README.md 文件，主要风险点在于：

*   **硬编码密码：** exploit1.py 中存在默认密码 `thm`，如果攻击者没有修改密码就直接使用，存在被其他恶意用户利用的风险。虽然这不算是代码层面的投毒，但属于配置不当可能导致的风险。
*   **文件名和目录：** 默认的文件名 `tomcatwar.jsp` 和目录 `ROOT` 可能会被监控系统检测到，但这更多是方便利用，而非隐藏的恶意行为。
*   **依赖项风险：** README.md 中提到了 Maven 编译和 Tomcat 依赖，如果使用的 Maven 仓库或 Tomcat 镜像被恶意篡改，可能会引入恶意代码。这属于供应链风险，而非代码本身投毒。
*    **代理服务器风险**: 在 exploit1.py 脚本中，支持通过代理服务器进行连接，虽然是方便进行HTTP消息拦截，但也存在代理服务器收集请求中的敏感信息。这不属于是POC投毒范畴，是属于使用者信息安全范畴。
*   **免责声明和学习目的：** README.md 中声明 PoC 仅用于学习目的，但无法保证使用者不会将其用于非法用途。

综合来看，代码本身没有明显的投毒行为，但存在一些配置风险和依赖项风险，可能被恶意利用。因此，投毒风险评估为 **10%**。这个百分比主要考虑使用者在使用默认配置可能带来的风险以及引入恶意依赖的潜在可能。

**漏洞利用方式：**

1.  **目标环境：** 目标应用运行在 JDK 9+，并且部署在 Tomcat 中，以 WAR 包形式部署。应用使用了 Spring MVC 或 Spring WebFlux 框架。
2.  **构造恶意请求：** 攻击者构造包含恶意参数的 HTTP POST 请求，利用 Spring 的数据绑定功能，修改 Tomcat 的 `AccessLogValve` 组件的属性。
3.  **修改日志配置：** 攻击者通过修改 `pattern` 属性，将恶意 JSP 代码写入到日志文件中。`directory`、`prefix`、`suffix` 和 `fileDateFormat` 属性用于控制日志文件的路径和名称，确保 JSP 代码能够写入到 webapps 目录下，并以 JSP 文件的形式存在。
4.  **上传 Webshell：**  成功修改日志配置后，Tomcat 会将恶意 JSP 代码写入到指定的 webapps 目录下，形成一个 Webshell。
5.  **远程代码执行：**  攻击者通过访问 Webshell 的 URL，执行任意代码，从而控制目标服务器。

**项目地址:** [cxzero/CVE-2022-22965-spring4shell](https://github.com/cxzero/CVE-2022-22965-spring4shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #13

**来源**: [CVE-2022-22965-dbgee_Spring4Shell.md](../2022/CVE-2022-22965-dbgee_Spring4Shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，也被称为 Spring4Shell，是一个 Spring Framework 中的远程代码执行漏洞。该漏洞利用了数据绑定功能，允许攻击者通过构造恶意请求来修改 Tomcat 的访问日志配置，进而写入恶意 Web shell，最终实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，并且存在公开的利用代码。漏洞的有效性取决于目标应用程序是否满足漏洞利用的先决条件：运行在 JDK 9+，部署为 WAR 包在 Tomcat 上，并使用 Spring MVC 或 Spring WebFlux。

**投毒风险：**
提供的代码片段 `/tmp/654a99bf9ba51c6c41107b986ba46894/mvnw` 看起来是 Maven Wrapper 脚本。这个脚本的主要目的是为了在没有安装 Maven 的环境下也能构建 Maven 项目，它本身不包含直接的漏洞利用代码。投毒的风险在于：

*   **依赖项投毒：** 攻击者可能修改 Maven 项目的 `pom.xml` 文件，添加恶意的依赖项。当 Maven Wrapper 构建项目时，会下载并执行这些恶意依赖项中的代码，从而实现投毒。虽然代码片段本身没有恶意，但 Maven 构建过程的性质决定了存在这种风险。
*   **配置投毒：** 攻击者可能篡改 Maven 的配置文件，修改构建过程，插入恶意代码。

考虑到 Maven Wrapper 的功能以及潜在的构建过程篡改，投毒风险评估为10%。

**利用方式：**
根据漏洞信息，利用方式主要包括以下步骤：

1.  **确定目标：** 找到满足漏洞利用条件的 Spring 应用。
2.  **构造恶意请求：** 构造包含恶意参数的 HTTP 请求，这些参数会修改 Tomcat 的访问日志配置。
3.  **写入 Web Shell：** 通过修改访问日志配置，将恶意代码（例如，一个简单的 Web shell）写入到 Tomcat 的 webapps 目录下。
4.  **执行命令：** 通过访问写入的 Web shell，执行任意命令。

总而言之，这是一个高危漏洞，如果目标应用程序满足利用条件，攻击者可以很容易地利用该漏洞执行任意命令。

**项目地址:** [dbgee/Spring4Shell](https://github.com/dbgee/Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #14

**来源**: [CVE-2022-22965-gokul-ramesh_Spring4Shell-PoC-exploit.md](../2022/CVE-2022-22965-gokul-ramesh_Spring4Shell-PoC-exploit.md)

## CVE-2022-22965 Spring4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19 and older versions

**利用条件:** 需要运行在JDK 9+，并且部署为WAR包在Tomcat上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework的远程代码执行漏洞。攻击者可以通过精心构造的请求，利用数据绑定功能操纵ClassLoader，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。漏洞已被公开利用，并有可用的POC。

**投毒风险：**
查看提供的exploit.py代码，代码结构非常简单，主要是一个命令行参数解析器，但run和check函数均未实现，是未完成的POC。直接分析没有发现明显的投毒行为，但是由于代码不完整，未来存在被修改并添加恶意代码的可能性。考虑到仓库本身是PoC性质，以及代码的未完成状态，投毒风险评估为10%。该仓库还引用了其他仓库，需要注意。

**利用方式：**
1.  **目标环境：** 应用程序必须运行在JDK 9+上，并且部署为传统的WAR包在Tomcat服务器中。
2.  **漏洞原理：** 该漏洞源于Spring Framework的数据绑定功能。当使用`RequestMapping`注解和POJO参数时，攻击者可以通过修改`class.module.classLoader`等属性，进而控制Tomcat的日志目录，写入webshell或其他恶意代码。
3.  **攻击步骤（基于已知利用方式）：**
    *   发送包含恶意参数的HTTP请求，例如，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern`属性，将Tomcat的access log配置为webshell。
    *   访问webshell，执行任意代码。

**项目地址:** [gokul-ramesh/Spring4Shell-PoC-exploit](https://github.com/gokul-ramesh/Spring4Shell-PoC-exploit)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #15

**来源**: [CVE-2022-22965-guigui237_Expoitation-de-la-vuln-rabilit-CVE-2022-22965.md](../2022/CVE-2022-22965-guigui237_Expoitation-de-la-vuln-rabilit-CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat作为WAR部署，使用Spring MVC或Spring WebFlux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个在 Spring Framework 中发现的远程代码执行漏洞。攻击者可以通过数据绑定，操纵某些属性来执行任意代码。根据漏洞库信息和搜索结果，漏洞利用的有效性较高，特别是针对使用JDK 9+并以WAR包形式部署在Tomcat上的Spring应用。

**利用方式：**

1.  **利用条件:**  需要满足以下条件：
    *   运行在 JDK 9 或更高版本。
    *   Spring MVC 或 Spring WebFlux 应用。
    *   部署为 Tomcat WAR 包。
    *   使用受影响的 Spring Framework 版本 (5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+)。
2.  **漏洞原理:** 通过操纵 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 属性，修改Tomcat的日志配置，写入webshell到可访问的目录。
3.  **利用步骤:**
    *   发送恶意构造的HTTP请求，包含精心设计的参数，以修改Tomcat的日志设置，将日志输出到Web可访问的目录。
    *   日志内容包含恶意代码，例如JSP webshell。
    *   通过访问webshell的URL，执行任意命令。

提供的漏洞利用代码 (`spring4shell.py`) 旨在自动化上述过程。

**投毒风险分析：**

提供的Python脚本`spring4shell.py`主要功能是利用CVE-2022-22965漏洞，通过修改Tomcat日志配置写入webshell，从而实现远程代码执行。虽然该脚本本身是为了攻击利用而编写的，但仍然存在潜在的投毒风险，尤其是在使用者直接下载并使用未经仔细审查的代码时。

具体分析如下：

*   **风险点1：**  脚本中可能会包含恶意代码，例如植入后门、收集敏感信息并外传等。虽然目前的代码片段看起来相对直接，主要关注漏洞利用，但攻击者可以很容易地添加额外的恶意功能。
*   **风险点2：**  该脚本依赖于第三方库 (`requests`, `bs4`)，这些库本身可能存在安全漏洞，或者被攻击者替换为恶意版本。虽然`pip3 install bs4` 和 `pip3 install requests`  是安装常用库，但如果源被劫持，可能会安装恶意版本。
*   **风险点3：**  脚本中的默认参数，例如webshell的文件名、密码、上传目录等，可能被攻击者利用。如果攻击者能够预测或控制这些参数，就可以更容易地进行后续攻击。

由于存在以上潜在风险，在使用任何公开的漏洞利用代码之前，都必须进行彻底的安全审查，确保代码的安全性和可靠性。此外，建议修改默认参数，增加攻击难度。

**投毒风险评估：**
考虑到代码功能相对集中于漏洞利用，且作者也给出了GitHub地址，初步判断投毒的可能性较低，但不能完全排除。综合评估，投毒风险为10%。这个概率考虑到作者可能隐藏恶意代码，或者将来代码仓库被入侵后植入恶意代码的情况。

**项目地址:** [guigui237/Expoitation-de-la-vuln-rabilit-CVE-2022-22965](https://github.com/guigui237/Expoitation-de-la-vuln-rabilit-CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #16

**来源**: [CVE-2022-22965-jakabakos_CVE-2022-22965-Spring4Shell.md](../2022/CVE-2022-22965-jakabakos_CVE-2022-22965-Spring4Shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions on JDK 9+ with Tomcat as WAR deployment.

**利用条件:** 需要目标应用使用存在漏洞的Spring Framework版本，运行在JDK 9+，部署为WAR包到Tomcat服务器，并且使用了受影响的Spring MVC或Spring WebFlux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个Spring Framework中的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过数据绑定利用某些特性来执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞影响运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序，并且这些应用程序必须以WAR包形式部署在Tomcat服务器上。如果应用部署为Spring Boot可执行jar，则不受影响。漏洞利用代码通过以下步骤实现RCE：

1.  **重置日志变量:** 通过修改`fileDateFormat`参数来初始化。
2.  **修改Tomcat日志配置:** 攻击者通过精心构造的请求，修改Tomcat的日志配置，将日志输出格式设置为包含可以执行命令的JSP代码。
3.  **写入 Webshell:**  通过header头传递包含Runtime的参数和命令执行的逻辑，通过修改过的日志配置写入webshell到服务器的webapps目录下。
4.  **命令执行:** 攻击者可以通过访问写入的webshell，传递`cmd`参数来执行任意命令。
5.  **清理日志变量:** 清理之前修改的日志变量，防止恶意写入。

**有效性:** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该POC代码是有效的，利用了不安全的配置修改来写入 Webshell.

**投毒风险评估:** 此仓库的投毒风险较低，约10%。Dockerfile中使用lunasec/tomcat-9.0.59-jdk11作为基础镜像，这本身具备一定的安全性，maven构建流程相对标准，没有发现明显的恶意代码注入行为，最主要的风险点在于`vulnerable-app`目录下的源代码，如果该目录下的源代码包含恶意代码，则可能存在投毒风险。

**利用方式总结:** 该漏洞的利用方式是先修改Tomcat的日志配置，将日志输出重定向到Web目录，并设置日志内容为可执行的JSP代码。然后，发送包含恶意代码的请求，使Tomcat将JSP代码写入日志文件，从而在Web目录中创建一个webshell。攻击者可以通过访问webshell执行任意命令，实现远程代码执行。

**项目地址:** [jakabakos/CVE-2022-22965-Spring4Shell](https://github.com/jakabakos/CVE-2022-22965-Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #17

**来源**: [CVE-2022-22965-jashan-lefty_Spring4Shell.md](../2022/CVE-2022-22965-jashan-lefty_Spring4Shell.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat WAR deployment, Spring MVC or Spring WebFlux application

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个远程代码执行漏洞，存在于Spring Framework中。根据漏洞信息，该漏洞只在特定条件下可被利用，即：

*   运行在JDK 9+之上。
*   以WAR包形式部署在Tomcat上。
*   使用了Spring MVC或Spring WebFlux。

**POC有效性评估：**

提供的`test.py`脚本尝试利用此漏洞。它通过修改`class.module.classLoader.resources.context.parent.pipeline.first`属性来写入恶意JSP文件到Tomcat的webapps/ROOT目录下，从而实现RCE。脚本尝试设置`pattern`属性（用于定义JSP文件的内容，包含后门代码），`suffix`属性（设置为.jsp），`directory`属性（设置为webapps/ROOT），`prefix`属性（设置为tomcatwar），以及`fileDateFormat`属性。

根据搜索引擎结果，此漏洞在野外已被积极利用，并且存在公开的POC。`test.py`脚本中的payload结构与公开的Spring4Shell利用方式相符，所以该POC代码有效。

**投毒风险评估：**

该仓库包含三个文件：`README.md`，`fw_handler.py` 和 `test.py`。

*   `README.md` 描述了对漏洞的分析和防御措施，无投毒风险。
*   `fw_handler.py` 实现了简单的防火墙，用于阻止包含特定payload的请求，用于防御攻击，无投毒风险。
*   `test.py` 包含漏洞利用代码，旨在验证漏洞是否存在。它通过发送包含特定payload的POST请求，尝试在目标服务器上写入恶意的JSP文件。该文件的目的是创建一个后门，允许通过`pwd`和`cmd`参数执行任意命令。此部分**并非**投毒代码，而是漏洞验证和利用的一部分。

虽然整个仓库的主题是关于漏洞分析和防御，但 `test.py` 中的利用代码如果被恶意使用，可能会导致安全风险。但就仓库本身而言，作者直接植入恶意代码的可能性较低，`fw_handler.py`反而是防御手段, 漏洞利用代码本身是利用漏洞的手段，不应被视为投毒。投毒风险较低，估计为10%。这个10%主要考虑的是仓库的维护者可能被黑客入侵，然后植入恶意代码。

**利用方式总结：**

1.  攻击者发送特制的HTTP请求，其中包含用于修改`class.module.classLoader.resources.context.parent.pipeline.first`属性的payload。
2.  这些属性的修改允许攻击者在Tomcat的webapps/ROOT目录下写入任意JSP文件。
3.  写入的JSP文件包含恶意代码（例如一个Webshell）。
4.  攻击者可以通过访问该JSP文件来执行任意命令，从而控制服务器。

**项目地址:** [jashan-lefty/Spring4Shell](https://github.com/jashan-lefty/Spring4Shell)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #18

**来源**: [CVE-2022-22965-likewhite_CVE-2022-22965.md](../2022/CVE-2022-22965-likewhite_CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat (WAR deployment), Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过构造恶意请求来执行任意代码。根据漏洞库信息，该漏洞存在于运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序中，并且需要以WAR包形式部署在Tomcat服务器上。如果应用部署为Spring Boot可执行jar包，则不易受此漏洞影响。搜索结果证实了该漏洞的存在，并指出该漏洞易于利用。提供的POC代码尝试利用数据绑定漏洞，通过修改 Tomcat 的 AccessLogValve 的属性来写入 webshell。该利用代码的有效性取决于目标系统是否满足漏洞利用的条件，包括 Spring 版本、JDK 版本、部署方式和 Tomcat 配置等。虽然`teamserver`和`readme.md`文件看起来不相关，但`CVE-2022-22965.py`文件本身并未发现明显的恶意代码。`teamserver`文件是Cobalt Strike的启动脚本，与漏洞利用无关。`readme.md`只是描述了漏洞和利用条件，并没有包含恶意代码。考虑到网络资源可能被篡改的风险，依然存在轻微的投毒可能（5%），但目前无法直接从代码中得出结论。

**利用方式：**

1.  **发送恶意请求：** 攻击者发送包含恶意参数的HTTP请求到目标Spring应用程序。
2.  **修改AccessLogValve：**  利用Spring的数据绑定功能，动态修改Tomcat的AccessLogValve组件的属性，例如`directory`，`prefix`，`suffix`和`pattern`。
3.  **写入Webshell：** 通过修改`pattern`属性，将一段包含恶意代码（例如，执行系统命令）的JSP代码写入到指定的目录和文件名的Webshell中。
4.  **执行Webshell：**  攻击者访问写入的Webshell，并传递命令参数，从而在服务器上执行任意代码。

**项目地址:** [likewhite/CVE-2022-22965](https://github.com/likewhite/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #19

**来源**: [CVE-2022-22965-osungjinwoo_CVE-2022-22965.md](../2022/CVE-2022-22965-osungjinwoo_CVE-2022-22965.md)

## CVE-2022-22965 - Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 和所有旧的和不支持的版本

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署，Spring MVC 或 Spring WebFlux 应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 Spring4Shell，允许未经身份验证的远程代码执行。利用方式是通过数据绑定，修改 Tomcat 的 AccessLogValve 组件属性，写入恶意 webshell 文件到 webapps 目录下。漏洞利用依赖于特定的环境配置，包括 JDK 9+，部署为 WAR 包的 Tomcat，以及使用了受影响版本的 Spring Framework。提供的 Python 和 Bash 脚本均旨在利用此漏洞。存在轻微投毒风险，主要体现在脚本可能包含下载其他恶意文件的代码或者修改服务器配置等，但主要功能是实现RCE，投毒风险较低。

**有效性分析:** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是真实存在的，并且有积极的利用案例。POC 代码尝试修改 Tomcat 的日志配置以写入 Webshell，这是一种已知的利用方式，因此提供的POC代码**有效**。

**投毒风险分析:** 查看提供的脚本`spring4shell.py`和`spring4shell.sh`，脚本主要功能是利用漏洞上传webshell，没有明显的恶意行为比如删除文件，反向连接恶意服务器等。`README.md`中引用了外部链接，存在一定的跳转风险，但代码本身主要是为了演示漏洞利用，故投毒风险较低，判断为10%。

**利用方式:**

1.  **漏洞原理：**  攻击者通过操纵 class.module.classLoader.resources.context.parent.pipeline.first 的属性，修改 Tomcat AccessLogValve 的配置，特别是 pattern 属性。
2.  **攻击过程：**
    *   构造包含恶意代码的请求，通过 Spring 的数据绑定功能，修改 Tomcat 的 AccessLogValve 组件的 pattern 属性，将恶意代码写入日志文件中。
    *   由于 Tomcat 的日志文件通常位于 webapps 目录下，因此恶意代码实际上被写入了一个 JSP 文件（webshell）。
    *   攻击者通过访问该 JSP 文件，执行任意命令。
3.  **POC代码分析:**
    *   `spring4shell.py` 脚本使用 `requests` 库发送 POST 请求，包含构造的恶意数据，目标 URL 是存在漏洞的 Spring 应用。
    *   `spring4shell.sh` 脚本同样发送构造的 HTTP 请求，修改 Tomcat 的 AccessLogValve 组件属性。
    *   两个脚本都设置了webshell密码，上传目录，webshell文件名，攻击成功后通过webshell url进行命令执行。
4.  **先决条件：**
    *   目标应用运行在 JDK 9+ 上。
    *   目标应用部署为 WAR 包到 Tomcat 上。
    *   目标应用使用了受影响版本的 Spring Framework。
    *   需要目标服务器能够访问

**项目地址:** [osungjinwoo/CVE-2022-22965](https://github.com/osungjinwoo/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #20

**来源**: [CVE-2022-22965-salo-404_firewall.md](../2022/CVE-2022-22965-salo-404_firewall.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 和所有旧的、不受支持的版本

**利用条件:** 需要运行在JDK 9+的Spring MVC或Spring WebFlux应用，并且部署在Tomcat上作为WAR包。另外，服务器需存在可写目录。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞利用了数据绑定功能，允许攻击者通过修改classLoader来写入恶意web shell,从而导致RCE。 

**有效性：**
根据漏洞信息和搜索结果，此漏洞是真实且可被利用的。提供的漏洞利用代码模拟了一个防火墙，用于防御Spring4Shell攻击，本身不包含攻击载荷，但是能够检测利用尝试，这间接证明了此漏洞的可利用性。

**投毒风险：**
提供的代码仓库主要包含一个模拟防火墙的Python脚本（firewall_server.py）。该脚本的目的是检测并阻止Spring4Shell漏洞的利用。审查该脚本后，发现它主要通过检查HTTP POST数据中的恶意键、header、有效载荷特征来工作。没有发现任何迹象表明作者试图在代码中隐藏任何恶意功能或后门。因此，投毒风险较低，约为10%。风险主要来自于对于拦截规则的绕过和未来潜在的恶意修改。

**利用方式：**
1.  **漏洞原理：** 该漏洞源于Spring框架的数据绑定功能，它允许将HTTP请求参数自动绑定到Java对象的属性上。攻击者可以利用这一点，通过构造恶意的请求参数，修改`classLoader`等关键对象，从而实现远程代码执行。
2.  **利用条件：**
    *   运行在JDK 9+的Spring MVC或Spring WebFlux应用。
    *   部署在Tomcat上作为WAR包（Spring Boot可执行jar默认部署方式不受影响）。
    *   目标应用存在可写目录
3.  **攻击步骤：**
    *   攻击者发送包含恶意参数的HTTP POST请求到存在漏洞的端点。
    *   恶意参数会修改Tomcat的日志目录、URI编码等配置。
    *   攻击者上传包含恶意代码的JSP文件到修改后的日志目录，从而创建一个webshell。
    *   攻击者通过访问该webshell执行任意代码。

**项目地址:** [salo-404/firewall](https://github.com/salo-404/firewall)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #21

**来源**: [CVE-2022-22965-shoucheng3_spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE.md](../2022/CVE-2022-22965-shoucheng3_spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 和所有旧的以及不支持的版本

**利用条件:** JDK 9+，Tomcat 作为 WAR 部署，受影响的 Spring Framework 版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22965，又名Spring4Shell，是Spring Framework中的一个远程代码执行漏洞。它允许攻击者通过数据绑定在运行在JDK 9+上的Spring MVC或Spring WebFlux应用程序上执行任意代码。特定的利用方式要求应用程序部署为Tomcat上的WAR包。漏洞利用方式：利用 Spring 框架的数据绑定功能，通过操纵类加载器和访问日志等属性，将恶意代码注入到服务器中，最终实现远程代码执行。提供的代码主要是贡献者行为准则和提交规范，不包含后门代码,存在轻微投毒的可能性，例如，篡改贡献指南以包含恶意链接，但直接 RCE 利用的可能性为低。

**项目地址:** [shoucheng3/spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE](https://github.com/shoucheng3/spring-projects__spring-framework_CVE-2022-22965_5-2-19-RELEASE)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #22

**来源**: [CVE-2022-22965-sohamsharma966_Spring4Shell-CVE-2022-22965.md](../2022/CVE-2022-22965-sohamsharma966_Spring4Shell-CVE-2022-22965.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 依赖 spring-webmvc 和/或 spring-webflux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965 (Spring4Shell) 是一个 Spring Framework 中的远程代码执行漏洞。利用方式如下：

1.  **漏洞原理：** 利用了 Spring Framework 在 JDK 9+ 版本中，使用数据绑定功能时，由于类加载器机制的改变，攻击者可以通过修改 `class.module.classLoader.resources.context.parent.pipeline.first` 的属性，来修改 Tomcat 的 access log valve 的配置，从而写入恶意 JSP 文件。

2.  **利用条件：**
    *   JDK 9+
    *   受影响的 Spring Framework 版本
    *   Tomcat 作为 WAR 部署
    *   依赖 spring-webmvc 和/或 spring-webflux

3.  **利用步骤：**
    *   攻击者发送包含恶意参数的 HTTP 请求到目标服务器。
    *   这些恶意参数修改 Tomcat 的 access log valve 配置，将 pattern 设置为包含恶意代码的 JSP。
    *   Tomcat 将恶意代码写入到 webapps/ROOT 目录下，形成一个 JSP shell 文件。
    *   攻击者通过访问 JSP shell 文件执行任意代码。

4.  **POC 代码分析：** 提供的 `exploit.py` 脚本实现了上述攻击流程。
    *   脚本构造了包含恶意参数的 POST 请求，这些参数用于修改 Tomcat 的 access log valve 配置。
    *   `headers` 字典定义了请求头，`data` 变量定义了 POST 请求的数据，包含了修改 access log valve 的 payload。
    *   脚本发送 POST 请求到目标 URL，然后尝试访问生成的 JSP shell 文件。
    *   如果 JSP shell 文件成功生成并可以访问，脚本会输出 shell 的 URL。

5.  **有效性：** 根据漏洞信息和搜索引擎结果，该POC代码是有效的，可以成功利用该漏洞在满足条件的服务器上执行任意代码。

6.  **投毒风险：** 该POC代码的功能是利用漏洞在目标服务器上部署一个 JSP shell， 允许远程执行命令。脚本本身并没有发现任何隐藏的、超出此范围的恶意行为，即没有发现任何投毒代码。因此，投毒风险评估为0%。该脚本的功能与漏洞利用本身相关，旨在验证和利用漏洞，而不是植入恶意后门。

简而言之，该漏洞利用方式是通过操纵Tomcat的日志配置来写入恶意JSP文件，从而实现远程代码执行。提供的POC代码能够有效地实现这一攻击，且没有明显的投毒迹象。

**项目地址:** [sohamsharma966/Spring4Shell-CVE-2022-22965](https://github.com/sohamsharma966/Spring4Shell-CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #23

**来源**: [CVE-2022-22965-sunnyvale-it_CVE-2022-22965-PoC.md](../2022/CVE-2022-22965-sunnyvale-it_CVE-2022-22965-PoC.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** Spring Framework 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ 以及所有旧的、不受支持的版本，运行在JDK 9+且部署为WAR包到Tomcat服务器上

**利用条件:** 目标应用必须满足：使用Spring MVC或Spring WebFlux，运行在JDK 9+，部署为WAR包到Tomcat服务器上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework的远程代码执行漏洞，通过数据绑定利用。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者通过修改`class.module.classLoader.resources.context.parent.pipeline.first`相关的属性（如`directory`, `prefix`, `suffix`, `pattern`等），来控制Tomcat的日志记录行为，最终写入一个恶意JSP webshell。
2.  **利用步骤：**
    *   首先，利用POST请求重置`fileDateFormat`属性。
    *   然后，通过POST请求设置Tomcat日志配置，包括日志目录、文件名前缀、后缀和包含恶意代码的日志模式，这些参数被编码在URL中。
    *   发送一个GET请求，触发日志记录，并将恶意JSP webshell写入到目标服务器上。
    *   webshell地址为`http://目标/前缀.jsp?cmd=命令`。
3.  **有效性：** 提供的POC代码是有效的，根据README的说明，可以成功在满足漏洞条件的服务器上执行任意命令。
4.  **投毒风险：**  虽然主要代码是为了利用漏洞，但仍存在一定的投毒风险。例如，`exploit-core.py`脚本中，恶意代码的写入目标（JSP webshell）是硬编码的。攻击者可能通过修改这些参数，在服务器上植入更隐蔽或更具破坏性的后门。Dockerfile中的lunasec/tomcat-9.0.59-jdk11镜像来源未经验证，有可能包含恶意代码，但是此仓库的重点在于spring漏洞利用。假设Dockerfile中的基础镜像没有问题，投毒风险比例约为10%。
5.  **总结：** 此漏洞的利用需要精心构造的HTTP请求，利用Spring的数据绑定机制，动态地修改Tomcat服务器的日志配置，最终达到远程代码执行的目的。这个过程对目标服务器的环境有一定要求，需要特定的Spring版本、JDK版本和部署方式。POC代码的有效性已经确认，但使用时需要注意潜在的投毒风险。

**项目地址:** [sunnyvale-it/CVE-2022-22965-PoC](https://github.com/sunnyvale-it/CVE-2022-22965-PoC)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #24

**来源**: [CVE-2022-22965-viniciuspereiras_CVE-2022-22965-poc.md](../2022/CVE-2022-22965-viniciuspereiras_CVE-2022-22965-poc.md)

## CVE-2022-22965-Spring4Shell-RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+，Tomcat作为WAR部署

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22965（Spring4Shell）是一个存在于Spring Framework中的远程代码执行漏洞。该漏洞利用了在JDK 9+环境下，Spring MVC或Spring WebFlux应用的数据绑定功能。攻击者通过构造恶意的请求，修改classloader中的属性，进而控制Tomcat的日志记录行为，最终写入webshell，实现远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被积极利用，并且存在公开可用的POC代码。提供的POC代码利用了修改 Tomcat access log pattern 的方式写入 webshell，从而实现远程代码执行。

**投毒风险：**

检查提供的POC代码后，虽然POC利用了常见的漏洞利用方法（写入Webshell），但代码中包含一个密码验证逻辑 `--password`。如果攻击者不提供正确的密码，webshell将无法执行命令，从而增加了防御的难度，存在一定概率为后门，但概率较低。虽然webshell的写入行为本身具有一定的风险，但整体代码较为直接，投毒可能性较低。风险预估为1%。

**利用方式：**

1.  攻击者发送精心构造的HTTP请求到目标Spring应用。
2.  请求中包含的参数利用Spring的数据绑定机制，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern` 属性，将恶意代码（例如，webshell）写入Tomcat的access log pattern。
3.  访问目标应用的相应URL，触发webshell执行。
4.  攻击者通过webshell执行任意命令，实现远程代码执行。

**项目地址:** [viniciuspereiras/CVE-2022-22965-poc](https://github.com/viniciuspereiras/CVE-2022-22965-poc)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #25

**来源**: [CVE-2022-22965-xsxtw_SpringFramework_CVE-2022-22965_RCE.md](../2022/CVE-2022-22965-xsxtw_SpringFramework_CVE-2022-22965_RCE.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat as WAR deployment, Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965，又名Spring4Shell，是一个Spring Framework的远程代码执行漏洞。攻击者可以通过操纵classloader来写入webshell或者执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用条件较为苛刻，需要JDK 9+，并且应用必须部署为WAR包在Tomcat上运行。如果应用以Spring Boot executable jar（默认方式）部署，则不易受到该漏洞影响。

**有效性分析：**
提供的POC代码是有效的。POC利用了Spring Data Binding的特性，通过修改class.module.classLoader.resources.context.parent.pipeline.first的值，修改了Tomcat的access log pattern，从而写入webshell。通过webshell的`Tomcat=S&cmd=`参数可以执行任意命令。

**投毒风险分析：**
提供的POC代码本身没有明显的投毒行为。它直接利用了漏洞来执行命令，没有进行任何尝试来修改或破坏目标系统上的其他文件或组件。代码目的明确，就是利用漏洞执行给定的命令，没有发现其他恶意意图的代码，因此投毒风险可以评估为0%。

**利用方式：**
利用方式主要是通过发送特制的HTTP POST请求，请求体中包含恶意的参数，这些参数用于修改Tomcat的access log pattern。具体步骤如下：

1.  发送包含恶意参数的POST请求，例如：
    ```
    class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22S%22.equals(request.getParameter(%22Tomcat%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%25%7Bsuffix%7Di&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix=Shell&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=
    ```
2.  上述请求会在`webapps/ROOT`目录下创建一个名为`Shell.jsp`的webshell。 webshell内容是读取`cmd`参数并执行。
3.  访问webshell，并通过`Tomcat=S&cmd=`参数执行任意命令，例如：
    ```
    http://target.com/Shell.jsp?Tomcat=S&cmd=whoami
    ```

攻击者可以利用这个webshell执行任意系统命令，从而控制服务器。

**项目地址:** [xsxtw/SpringFramework_CVE-2022-22965_RCE](https://github.com/xsxtw/SpringFramework_CVE-2022-22965_RCE)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

## POC #26

**来源**: [CVE-2022-22965-zangcc_CVE-2022-22965-rexbb.md](../2022/CVE-2022-22965-zangcc_CVE-2022-22965-rexbb.md)

## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions，JDK 9+，Tomcat 作为 WAR 部署

**利用条件:** Spring MVC 或 Spring WebFlux 应用程序，运行在 JDK 9+ 上，部署为 WAR 包在 Tomcat 上。需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965，又名 Spring4Shell，是一个Spring框架中的远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过数据绑定利用不当的输入验证，在目标系统上执行任意代码。漏洞利用依赖于以下条件：

*   **受影响的Spring版本：** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions
*   **JDK 版本：** JDK 9 及以上
*   **部署方式：** 应用必须部署为 WAR 包在 Tomcat 上运行，而不是 Spring Boot 可执行 JAR。
*   **利用方式：**  攻击者通过构造恶意的HTTP请求，利用Spring的数据绑定功能修改`class.module.classLoader.resources.context.parent.pipeline.first`等属性，从而写入恶意JSP Webshell到Tomcat服务器，进而执行任意命令。

**漏洞利用代码分析：**

提供的漏洞利用代码是一个基于 JavaFx 开发的图形化工具 (Rexbb.jar)。它简化了漏洞利用过程，主要功能包括：

1.  **发送 Payload：**  自动构造和发送包含恶意参数的 HTTP 请求，利用 Spring 的数据绑定漏洞。
2.  **RCE 检测：**  在成功写入 Webshell 后，执行任意命令，并将结果回显。
3.  **命令执行：**  允许用户输入自定义命令，并在目标系统上执行。

该工具通过图形界面封装了漏洞利用的细节，降低了利用门槛。

**投毒风险分析：**

该POC工具本身存在一定的投毒风险。虽然主要功能是利用Spring4Shell漏洞，但作者可能在代码中加入恶意逻辑，例如：

*   **后门植入：**  在 Webshell 中添加额外的后门，方便攻击者长期控制目标系统。
*   **信息窃取：**  在命令执行过程中，收集敏感信息并发送到攻击者控制的服务器。
*   **恶意传播：**  利用漏洞感染其他系统。

由于无法直接审查 Rexbb.jar 的源代码，因此存在一定的信任风险。建议在使用此类工具时，保持警惕，在安全隔离的环境中进行测试，并进行代码审计，以确保工具的安全性。

**投毒可能性评估：**

虽然不能确定是否存在投毒代码，但根据代码的性质，作者具备植入恶意代码的可能性。相对来说，作者详细说明了POC使用方式以及原理，降低了投毒可能性。因此，评估投毒风险为10%。

**项目地址:** [zangcc/CVE-2022-22965-rexbb](https://github.com/zangcc/CVE-2022-22965-rexbb)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)

---

