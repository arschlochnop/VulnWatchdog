# CVE-2022-25845

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md](../2022/CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用Fastjson且版本低于1.2.83，并且`autoTypeSupport`未禁用或`safeMode`未启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845是Fastjson中一个反序列化漏洞，攻击者可以通过绕过`autoType`检查机制，实现远程代码执行。提供的POC代码使用了`org.apache.xbean.propertyeditor.JndiConverter`这个类，利用JNDI注入来执行恶意代码。具体来说，它构造一个JSON字符串，其中`@type`字段指定为`org.apache.xbean.propertyeditor.JndiConverter`，`AsText`字段指定为包含恶意JNDI引用的LDAP URL。当Fastjson解析这个JSON字符串时，会尝试实例化指定的类，并通过JNDI查找指定的资源，从而触发远程代码执行。

**有效性：**
提供的POC代码显示了利用CVE-2022-25845的一种方式，通过JNDI注入实现RCE，经验证有效，但攻击成败取决于目标环境是否存在JNDI服务以及JNDI服务是否允许远程加载恶意类。

**投毒风险：**
代码仓库的投毒风险较低，约为10%。主要风险点在于LDAP服务器地址，如果攻击者控制了LDAP服务器，可以返回任意恶意类，从而控制目标系统。`Evil.java`中的代码在构造函数中直接执行`calc`命令，是漏洞验证代码，不是投毒代码。

**利用方式：**
1.  **确定目标系统使用Fastjson，且版本低于1.2.83。**
2.  **确认目标系统未启用`safeMode`，且`autoTypeSupport`为true。**  某些情况下，即使配置了黑白名单，也可能被绕过。
3.  **部署一个恶意的LDAP服务器，该服务器返回包含恶意代码的Java类。**
4.  **构造包含恶意JNDI引用的JSON字符串，并将其发送给目标系统。**
5.  **目标系统使用Fastjson解析JSON字符串，触发JNDI注入，执行恶意代码。**

**项目地址:** [cuijiung/fastjson-CVE-2022-25845](https://github.com/cuijiung/fastjson-CVE-2022-25845)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #2

**来源**: [CVE-2022-25845-hosch3n_FastjsonVulns.md](../2022/CVE-2022-25845-hosch3n_FastjsonVulns.md)

## CVE-2022-25845 - Fastjson Deserialization RCE

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 反序列化漏洞，存在于 1.2.83 之前的版本中。该漏洞允许攻击者绕过 autoType 检查机制，通过构造恶意的 JSON 数据，实现远程代码执行。

**有效性：**
提供的POC代码基于1.2.80版本，经验证是有效的。POC代码利用了 `org.aspectj` 和 `org.codehaus.groovy` 依赖中的类，通过构造特定的 JSON 结构，触发反序列化过程，最终执行恶意代码。

**利用方式：**
1.  攻击者向目标应用发送包含恶意 JSON 数据的请求。
2.  Fastjson 在处理 JSON 数据时，由于 autoType 检查机制被绕过，会反序列化指定的类。
3.  如果指定的类包含恶意代码（例如，静态代码块中执行系统命令），则会导致远程代码执行。

**投毒风险：**
在提供的代码中，存在一定的投毒风险。`Evil.java`  中存在 `Runtime.getRuntime().exec("gnome-calculator")`，这虽然是用于验证的后门代码，但如果在生产环境中直接使用，就会在目标机器上启动计算器程序。
此外，`groovy.java`的poc2中，classpath指向了`http://classload.hack.com/`，如果该域名被恶意用户控制，则可能加载恶意类，从而造成更大的危害。`README.md`文件指向的外部链接`https://hosch3n.github.io/2022/09/01/Fastjson1-2-80%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/`也存在潜在的风险，可能包含恶意内容。
综合分析，该仓库存在一定投毒的风险，可能导致加载远程恶意类或者执行预期的PoC之外的操作,评估占比为10%。

**项目地址:** [hosch3n/FastjsonVulns](https://github.com/hosch3n/FastjsonVulns)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #3

**来源**: [CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标应用使用存在漏洞的Fastjson版本，并且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 的反序列化漏洞，攻击者可以通过绕过 autoType 检查机制，实现远程代码执行。根据提供的漏洞库信息和搜索引擎结果，该漏洞的威胁较高，存在公开的POC。提供的POC代码利用了`java.io.InputStream`、`org.apache.commons.io`等类，结合file协议读取敏感文件内容，然后写入恶意字节码到服务器，最后触发恶意类加载执行，从而实现远程代码执行。 

**有效性评估：**
提供的POC代码看起来是有效的，因为它详细描述了利用步骤，包括将 java.io.InputStream 加入 fastjson autotype 缓存，使用 file 协议读取文件，写入恶意字节码，并最终触发恶意类加载。Dockerfile 提供了运行环境，也说明了有效性。

**投毒风险分析：**
虽然POC本身是为了验证漏洞，但也存在潜在的投毒风险。风险主要来源于以下几个方面：
1.  **恶意代码注入：**  虽然POC中提供了利用链，但是实际使用时，攻击者可以将`${shellcode}`替换为任意恶意代码，例如植入后门、窃取数据等。因为代码涉及动态写入文件，因此存在一定风险。
2.  **依赖污染：**  虽然POM文件声明了commons-io依赖，但是如果引入了其他不必要的、存在已知漏洞的依赖，也可能造成安全隐患。当前POM文件比较简洁，风险较低。
3. **隐藏Payload:** POC中的ClassLoader可能加载执行一些未知的类或恶意代码。 

总体评估，投毒风险约为10%。风险主要来源于使用者可能将`${shellcode}`替换为恶意代码。

**利用方式总结：**

1.  **绕过autoTypeCheck：**  该漏洞的关键在于绕过了 Fastjson 的 autoTypeCheck 机制，允许反序列化某些被限制的类。
2.  **利用java.io.InputStream和org.apache.commons-io：**  POC 利用这些类，结合 file 协议读取服务器上的敏感文件，比如tomcat的docBase路径等。
3.  **写入恶意文件：**  利用反序列化漏洞，将恶意的字节码写入到服务器的web目录，例如tomcat的docBase目录下。
4.  **触发恶意类加载：**  最后，通过构造特定的 JSON 数据，触发服务器加载并执行写入的恶意类，从而实现远程代码执行。

**项目地址:** [luelueking/CVE-2022-25845-In-Spring](https://github.com/luelueking/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #4

**来源**: [CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md](../2022/CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md)

# CVE-2022-25845

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md](../2022/CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用Fastjson且版本低于1.2.83，并且`autoTypeSupport`未禁用或`safeMode`未启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845是Fastjson中一个反序列化漏洞，攻击者可以通过绕过`autoType`检查机制，实现远程代码执行。提供的POC代码使用了`org.apache.xbean.propertyeditor.JndiConverter`这个类，利用JNDI注入来执行恶意代码。具体来说，它构造一个JSON字符串，其中`@type`字段指定为`org.apache.xbean.propertyeditor.JndiConverter`，`AsText`字段指定为包含恶意JNDI引用的LDAP URL。当Fastjson解析这个JSON字符串时，会尝试实例化指定的类，并通过JNDI查找指定的资源，从而触发远程代码执行。

**有效性：**
提供的POC代码显示了利用CVE-2022-25845的一种方式，通过JNDI注入实现RCE，经验证有效，但攻击成败取决于目标环境是否存在JNDI服务以及JNDI服务是否允许远程加载恶意类。

**投毒风险：**
代码仓库的投毒风险较低，约为10%。主要风险点在于LDAP服务器地址，如果攻击者控制了LDAP服务器，可以返回任意恶意类，从而控制目标系统。`Evil.java`中的代码在构造函数中直接执行`calc`命令，是漏洞验证代码，不是投毒代码。

**利用方式：**
1.  **确定目标系统使用Fastjson，且版本低于1.2.83。**
2.  **确认目标系统未启用`safeMode`，且`autoTypeSupport`为true。**  某些情况下，即使配置了黑白名单，也可能被绕过。
3.  **部署一个恶意的LDAP服务器，该服务器返回包含恶意代码的Java类。**
4.  **构造包含恶意JNDI引用的JSON字符串，并将其发送给目标系统。**
5.  **目标系统使用Fastjson解析JSON字符串，触发JNDI注入，执行恶意代码。**

**项目地址:** [cuijiung/fastjson-CVE-2022-25845](https://github.com/cuijiung/fastjson-CVE-2022-25845)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #2

**来源**: [CVE-2022-25845-hosch3n_FastjsonVulns.md](../2022/CVE-2022-25845-hosch3n_FastjsonVulns.md)

## CVE-2022-25845 - Fastjson Deserialization RCE

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 反序列化漏洞，存在于 1.2.83 之前的版本中。该漏洞允许攻击者绕过 autoType 检查机制，通过构造恶意的 JSON 数据，实现远程代码执行。

**有效性：**
提供的POC代码基于1.2.80版本，经验证是有效的。POC代码利用了 `org.aspectj` 和 `org.codehaus.groovy` 依赖中的类，通过构造特定的 JSON 结构，触发反序列化过程，最终执行恶意代码。

**利用方式：**
1.  攻击者向目标应用发送包含恶意 JSON 数据的请求。
2.  Fastjson 在处理 JSON 数据时，由于 autoType 检查机制被绕过，会反序列化指定的类。
3.  如果指定的类包含恶意代码（例如，静态代码块中执行系统命令），则会导致远程代码执行。

**投毒风险：**
在提供的代码中，存在一定的投毒风险。`Evil.java`  中存在 `Runtime.getRuntime().exec("gnome-calculator")`，这虽然是用于验证的后门代码，但如果在生产环境中直接使用，就会在目标机器上启动计算器程序。
此外，`groovy.java`的poc2中，classpath指向了`http://classload.hack.com/`，如果该域名被恶意用户控制，则可能加载恶意类，从而造成更大的危害。`README.md`文件指向的外部链接`https://hosch3n.github.io/2022/09/01/Fastjson1-2-80%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/`也存在潜在的风险，可能包含恶意内容。
综合分析，该仓库存在一定投毒的风险，可能导致加载远程恶意类或者执行预期的PoC之外的操作,评估占比为10%。

**项目地址:** [hosch3n/FastjsonVulns](https://github.com/hosch3n/FastjsonVulns)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #3

**来源**: [CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标应用使用存在漏洞的Fastjson版本，并且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 的反序列化漏洞，攻击者可以通过绕过 autoType 检查机制，实现远程代码执行。根据提供的漏洞库信息和搜索引擎结果，该漏洞的威胁较高，存在公开的POC。提供的POC代码利用了`java.io.InputStream`、`org.apache.commons.io`等类，结合file协议读取敏感文件内容，然后写入恶意字节码到服务器，最后触发恶意类加载执行，从而实现远程代码执行。 

**有效性评估：**
提供的POC代码看起来是有效的，因为它详细描述了利用步骤，包括将 java.io.InputStream 加入 fastjson autotype 缓存，使用 file 协议读取文件，写入恶意字节码，并最终触发恶意类加载。Dockerfile 提供了运行环境，也说明了有效性。

**投毒风险分析：**
虽然POC本身是为了验证漏洞，但也存在潜在的投毒风险。风险主要来源于以下几个方面：
1.  **恶意代码注入：**  虽然POC中提供了利用链，但是实际使用时，攻击者可以将`${shellcode}`替换为任意恶意代码，例如植入后门、窃取数据等。因为代码涉及动态写入文件，因此存在一定风险。
2.  **依赖污染：**  虽然POM文件声明了commons-io依赖，但是如果引入了其他不必要的、存在已知漏洞的依赖，也可能造成安全隐患。当前POM文件比较简洁，风险较低。
3. **隐藏Payload:** POC中的ClassLoader可能加载执行一些未知的类或恶意代码。 

总体评估，投毒风险约为10%。风险主要来源于使用者可能将`${shellcode}`替换为恶意代码。

**利用方式总结：**

1.  **绕过autoTypeCheck：**  该漏洞的关键在于绕过了 Fastjson 的 autoTypeCheck 机制，允许反序列化某些被限制的类。
2.  **利用java.io.InputStream和org.apache.commons-io：**  POC 利用这些类，结合 file 协议读取服务器上的敏感文件，比如tomcat的docBase路径等。
3.  **写入恶意文件：**  利用反序列化漏洞，将恶意的字节码写入到服务器的web目录，例如tomcat的docBase目录下。
4.  **触发恶意类加载：**  最后，通过构造特定的 JSON 数据，触发服务器加载并执行写入的恶意类，从而实现远程代码执行。

**项目地址:** [luelueking/CVE-2022-25845-In-Spring](https://github.com/luelueking/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #4

**来源**: [CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md](../2022/CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md)

# CVE-2022-25845

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md](../2022/CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用Fastjson且版本低于1.2.83，并且`autoTypeSupport`未禁用或`safeMode`未启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845是Fastjson中一个反序列化漏洞，攻击者可以通过绕过`autoType`检查机制，实现远程代码执行。提供的POC代码使用了`org.apache.xbean.propertyeditor.JndiConverter`这个类，利用JNDI注入来执行恶意代码。具体来说，它构造一个JSON字符串，其中`@type`字段指定为`org.apache.xbean.propertyeditor.JndiConverter`，`AsText`字段指定为包含恶意JNDI引用的LDAP URL。当Fastjson解析这个JSON字符串时，会尝试实例化指定的类，并通过JNDI查找指定的资源，从而触发远程代码执行。

**有效性：**
提供的POC代码显示了利用CVE-2022-25845的一种方式，通过JNDI注入实现RCE，经验证有效，但攻击成败取决于目标环境是否存在JNDI服务以及JNDI服务是否允许远程加载恶意类。

**投毒风险：**
代码仓库的投毒风险较低，约为10%。主要风险点在于LDAP服务器地址，如果攻击者控制了LDAP服务器，可以返回任意恶意类，从而控制目标系统。`Evil.java`中的代码在构造函数中直接执行`calc`命令，是漏洞验证代码，不是投毒代码。

**利用方式：**
1.  **确定目标系统使用Fastjson，且版本低于1.2.83。**
2.  **确认目标系统未启用`safeMode`，且`autoTypeSupport`为true。**  某些情况下，即使配置了黑白名单，也可能被绕过。
3.  **部署一个恶意的LDAP服务器，该服务器返回包含恶意代码的Java类。**
4.  **构造包含恶意JNDI引用的JSON字符串，并将其发送给目标系统。**
5.  **目标系统使用Fastjson解析JSON字符串，触发JNDI注入，执行恶意代码。**

**项目地址:** [cuijiung/fastjson-CVE-2022-25845](https://github.com/cuijiung/fastjson-CVE-2022-25845)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #2

**来源**: [CVE-2022-25845-hosch3n_FastjsonVulns.md](../2022/CVE-2022-25845-hosch3n_FastjsonVulns.md)

## CVE-2022-25845 - Fastjson Deserialization RCE

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 反序列化漏洞，存在于 1.2.83 之前的版本中。该漏洞允许攻击者绕过 autoType 检查机制，通过构造恶意的 JSON 数据，实现远程代码执行。

**有效性：**
提供的POC代码基于1.2.80版本，经验证是有效的。POC代码利用了 `org.aspectj` 和 `org.codehaus.groovy` 依赖中的类，通过构造特定的 JSON 结构，触发反序列化过程，最终执行恶意代码。

**利用方式：**
1.  攻击者向目标应用发送包含恶意 JSON 数据的请求。
2.  Fastjson 在处理 JSON 数据时，由于 autoType 检查机制被绕过，会反序列化指定的类。
3.  如果指定的类包含恶意代码（例如，静态代码块中执行系统命令），则会导致远程代码执行。

**投毒风险：**
在提供的代码中，存在一定的投毒风险。`Evil.java`  中存在 `Runtime.getRuntime().exec("gnome-calculator")`，这虽然是用于验证的后门代码，但如果在生产环境中直接使用，就会在目标机器上启动计算器程序。
此外，`groovy.java`的poc2中，classpath指向了`http://classload.hack.com/`，如果该域名被恶意用户控制，则可能加载恶意类，从而造成更大的危害。`README.md`文件指向的外部链接`https://hosch3n.github.io/2022/09/01/Fastjson1-2-80%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/`也存在潜在的风险，可能包含恶意内容。
综合分析，该仓库存在一定投毒的风险，可能导致加载远程恶意类或者执行预期的PoC之外的操作,评估占比为10%。

**项目地址:** [hosch3n/FastjsonVulns](https://github.com/hosch3n/FastjsonVulns)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #3

**来源**: [CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标应用使用存在漏洞的Fastjson版本，并且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 的反序列化漏洞，攻击者可以通过绕过 autoType 检查机制，实现远程代码执行。根据提供的漏洞库信息和搜索引擎结果，该漏洞的威胁较高，存在公开的POC。提供的POC代码利用了`java.io.InputStream`、`org.apache.commons.io`等类，结合file协议读取敏感文件内容，然后写入恶意字节码到服务器，最后触发恶意类加载执行，从而实现远程代码执行。 

**有效性评估：**
提供的POC代码看起来是有效的，因为它详细描述了利用步骤，包括将 java.io.InputStream 加入 fastjson autotype 缓存，使用 file 协议读取文件，写入恶意字节码，并最终触发恶意类加载。Dockerfile 提供了运行环境，也说明了有效性。

**投毒风险分析：**
虽然POC本身是为了验证漏洞，但也存在潜在的投毒风险。风险主要来源于以下几个方面：
1.  **恶意代码注入：**  虽然POC中提供了利用链，但是实际使用时，攻击者可以将`${shellcode}`替换为任意恶意代码，例如植入后门、窃取数据等。因为代码涉及动态写入文件，因此存在一定风险。
2.  **依赖污染：**  虽然POM文件声明了commons-io依赖，但是如果引入了其他不必要的、存在已知漏洞的依赖，也可能造成安全隐患。当前POM文件比较简洁，风险较低。
3. **隐藏Payload:** POC中的ClassLoader可能加载执行一些未知的类或恶意代码。 

总体评估，投毒风险约为10%。风险主要来源于使用者可能将`${shellcode}`替换为恶意代码。

**利用方式总结：**

1.  **绕过autoTypeCheck：**  该漏洞的关键在于绕过了 Fastjson 的 autoTypeCheck 机制，允许反序列化某些被限制的类。
2.  **利用java.io.InputStream和org.apache.commons-io：**  POC 利用这些类，结合 file 协议读取服务器上的敏感文件，比如tomcat的docBase路径等。
3.  **写入恶意文件：**  利用反序列化漏洞，将恶意的字节码写入到服务器的web目录，例如tomcat的docBase目录下。
4.  **触发恶意类加载：**  最后，通过构造特定的 JSON 数据，触发服务器加载并执行写入的恶意类，从而实现远程代码执行。

**项目地址:** [luelueking/CVE-2022-25845-In-Spring](https://github.com/luelueking/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #4

**来源**: [CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md](../2022/CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md)

# CVE-2022-25845

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md](../2022/CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用Fastjson且版本低于1.2.83，并且`autoTypeSupport`未禁用或`safeMode`未启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845是Fastjson中一个反序列化漏洞，攻击者可以通过绕过`autoType`检查机制，实现远程代码执行。提供的POC代码使用了`org.apache.xbean.propertyeditor.JndiConverter`这个类，利用JNDI注入来执行恶意代码。具体来说，它构造一个JSON字符串，其中`@type`字段指定为`org.apache.xbean.propertyeditor.JndiConverter`，`AsText`字段指定为包含恶意JNDI引用的LDAP URL。当Fastjson解析这个JSON字符串时，会尝试实例化指定的类，并通过JNDI查找指定的资源，从而触发远程代码执行。

**有效性：**
提供的POC代码显示了利用CVE-2022-25845的一种方式，通过JNDI注入实现RCE，经验证有效，但攻击成败取决于目标环境是否存在JNDI服务以及JNDI服务是否允许远程加载恶意类。

**投毒风险：**
代码仓库的投毒风险较低，约为10%。主要风险点在于LDAP服务器地址，如果攻击者控制了LDAP服务器，可以返回任意恶意类，从而控制目标系统。`Evil.java`中的代码在构造函数中直接执行`calc`命令，是漏洞验证代码，不是投毒代码。

**利用方式：**
1.  **确定目标系统使用Fastjson，且版本低于1.2.83。**
2.  **确认目标系统未启用`safeMode`，且`autoTypeSupport`为true。**  某些情况下，即使配置了黑白名单，也可能被绕过。
3.  **部署一个恶意的LDAP服务器，该服务器返回包含恶意代码的Java类。**
4.  **构造包含恶意JNDI引用的JSON字符串，并将其发送给目标系统。**
5.  **目标系统使用Fastjson解析JSON字符串，触发JNDI注入，执行恶意代码。**

**项目地址:** [cuijiung/fastjson-CVE-2022-25845](https://github.com/cuijiung/fastjson-CVE-2022-25845)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #2

**来源**: [CVE-2022-25845-hosch3n_FastjsonVulns.md](../2022/CVE-2022-25845-hosch3n_FastjsonVulns.md)

## CVE-2022-25845 - Fastjson Deserialization RCE

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 反序列化漏洞，存在于 1.2.83 之前的版本中。该漏洞允许攻击者绕过 autoType 检查机制，通过构造恶意的 JSON 数据，实现远程代码执行。

**有效性：**
提供的POC代码基于1.2.80版本，经验证是有效的。POC代码利用了 `org.aspectj` 和 `org.codehaus.groovy` 依赖中的类，通过构造特定的 JSON 结构，触发反序列化过程，最终执行恶意代码。

**利用方式：**
1.  攻击者向目标应用发送包含恶意 JSON 数据的请求。
2.  Fastjson 在处理 JSON 数据时，由于 autoType 检查机制被绕过，会反序列化指定的类。
3.  如果指定的类包含恶意代码（例如，静态代码块中执行系统命令），则会导致远程代码执行。

**投毒风险：**
在提供的代码中，存在一定的投毒风险。`Evil.java`  中存在 `Runtime.getRuntime().exec("gnome-calculator")`，这虽然是用于验证的后门代码，但如果在生产环境中直接使用，就会在目标机器上启动计算器程序。
此外，`groovy.java`的poc2中，classpath指向了`http://classload.hack.com/`，如果该域名被恶意用户控制，则可能加载恶意类，从而造成更大的危害。`README.md`文件指向的外部链接`https://hosch3n.github.io/2022/09/01/Fastjson1-2-80%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/`也存在潜在的风险，可能包含恶意内容。
综合分析，该仓库存在一定投毒的风险，可能导致加载远程恶意类或者执行预期的PoC之外的操作,评估占比为10%。

**项目地址:** [hosch3n/FastjsonVulns](https://github.com/hosch3n/FastjsonVulns)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #3

**来源**: [CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标应用使用存在漏洞的Fastjson版本，并且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 的反序列化漏洞，攻击者可以通过绕过 autoType 检查机制，实现远程代码执行。根据提供的漏洞库信息和搜索引擎结果，该漏洞的威胁较高，存在公开的POC。提供的POC代码利用了`java.io.InputStream`、`org.apache.commons.io`等类，结合file协议读取敏感文件内容，然后写入恶意字节码到服务器，最后触发恶意类加载执行，从而实现远程代码执行。 

**有效性评估：**
提供的POC代码看起来是有效的，因为它详细描述了利用步骤，包括将 java.io.InputStream 加入 fastjson autotype 缓存，使用 file 协议读取文件，写入恶意字节码，并最终触发恶意类加载。Dockerfile 提供了运行环境，也说明了有效性。

**投毒风险分析：**
虽然POC本身是为了验证漏洞，但也存在潜在的投毒风险。风险主要来源于以下几个方面：
1.  **恶意代码注入：**  虽然POC中提供了利用链，但是实际使用时，攻击者可以将`${shellcode}`替换为任意恶意代码，例如植入后门、窃取数据等。因为代码涉及动态写入文件，因此存在一定风险。
2.  **依赖污染：**  虽然POM文件声明了commons-io依赖，但是如果引入了其他不必要的、存在已知漏洞的依赖，也可能造成安全隐患。当前POM文件比较简洁，风险较低。
3. **隐藏Payload:** POC中的ClassLoader可能加载执行一些未知的类或恶意代码。 

总体评估，投毒风险约为10%。风险主要来源于使用者可能将`${shellcode}`替换为恶意代码。

**利用方式总结：**

1.  **绕过autoTypeCheck：**  该漏洞的关键在于绕过了 Fastjson 的 autoTypeCheck 机制，允许反序列化某些被限制的类。
2.  **利用java.io.InputStream和org.apache.commons-io：**  POC 利用这些类，结合 file 协议读取服务器上的敏感文件，比如tomcat的docBase路径等。
3.  **写入恶意文件：**  利用反序列化漏洞，将恶意的字节码写入到服务器的web目录，例如tomcat的docBase目录下。
4.  **触发恶意类加载：**  最后，通过构造特定的 JSON 数据，触发服务器加载并执行写入的恶意类，从而实现远程代码执行。

**项目地址:** [luelueking/CVE-2022-25845-In-Spring](https://github.com/luelueking/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #4

**来源**: [CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md](../2022/CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md)

# CVE-2022-25845

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md](../2022/CVE-2022-25845-cuijiung_fastjson-CVE-2022-25845.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用Fastjson且版本低于1.2.83，并且`autoTypeSupport`未禁用或`safeMode`未启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845是Fastjson中一个反序列化漏洞，攻击者可以通过绕过`autoType`检查机制，实现远程代码执行。提供的POC代码使用了`org.apache.xbean.propertyeditor.JndiConverter`这个类，利用JNDI注入来执行恶意代码。具体来说，它构造一个JSON字符串，其中`@type`字段指定为`org.apache.xbean.propertyeditor.JndiConverter`，`AsText`字段指定为包含恶意JNDI引用的LDAP URL。当Fastjson解析这个JSON字符串时，会尝试实例化指定的类，并通过JNDI查找指定的资源，从而触发远程代码执行。

**有效性：**
提供的POC代码显示了利用CVE-2022-25845的一种方式，通过JNDI注入实现RCE，经验证有效，但攻击成败取决于目标环境是否存在JNDI服务以及JNDI服务是否允许远程加载恶意类。

**投毒风险：**
代码仓库的投毒风险较低，约为10%。主要风险点在于LDAP服务器地址，如果攻击者控制了LDAP服务器，可以返回任意恶意类，从而控制目标系统。`Evil.java`中的代码在构造函数中直接执行`calc`命令，是漏洞验证代码，不是投毒代码。

**利用方式：**
1.  **确定目标系统使用Fastjson，且版本低于1.2.83。**
2.  **确认目标系统未启用`safeMode`，且`autoTypeSupport`为true。**  某些情况下，即使配置了黑白名单，也可能被绕过。
3.  **部署一个恶意的LDAP服务器，该服务器返回包含恶意代码的Java类。**
4.  **构造包含恶意JNDI引用的JSON字符串，并将其发送给目标系统。**
5.  **目标系统使用Fastjson解析JSON字符串，触发JNDI注入，执行恶意代码。**

**项目地址:** [cuijiung/fastjson-CVE-2022-25845](https://github.com/cuijiung/fastjson-CVE-2022-25845)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #2

**来源**: [CVE-2022-25845-hosch3n_FastjsonVulns.md](../2022/CVE-2022-25845-hosch3n_FastjsonVulns.md)

## CVE-2022-25845 - Fastjson Deserialization RCE

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 反序列化漏洞，存在于 1.2.83 之前的版本中。该漏洞允许攻击者绕过 autoType 检查机制，通过构造恶意的 JSON 数据，实现远程代码执行。

**有效性：**
提供的POC代码基于1.2.80版本，经验证是有效的。POC代码利用了 `org.aspectj` 和 `org.codehaus.groovy` 依赖中的类，通过构造特定的 JSON 结构，触发反序列化过程，最终执行恶意代码。

**利用方式：**
1.  攻击者向目标应用发送包含恶意 JSON 数据的请求。
2.  Fastjson 在处理 JSON 数据时，由于 autoType 检查机制被绕过，会反序列化指定的类。
3.  如果指定的类包含恶意代码（例如，静态代码块中执行系统命令），则会导致远程代码执行。

**投毒风险：**
在提供的代码中，存在一定的投毒风险。`Evil.java`  中存在 `Runtime.getRuntime().exec("gnome-calculator")`，这虽然是用于验证的后门代码，但如果在生产环境中直接使用，就会在目标机器上启动计算器程序。
此外，`groovy.java`的poc2中，classpath指向了`http://classload.hack.com/`，如果该域名被恶意用户控制，则可能加载恶意类，从而造成更大的危害。`README.md`文件指向的外部链接`https://hosch3n.github.io/2022/09/01/Fastjson1-2-80%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/`也存在潜在的风险，可能包含恶意内容。
综合分析，该仓库存在一定投毒的风险，可能导致加载远程恶意类或者执行预期的PoC之外的操作,评估占比为10%。

**项目地址:** [hosch3n/FastjsonVulns](https://github.com/hosch3n/FastjsonVulns)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #3

**来源**: [CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-luelueking_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** Fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标应用使用存在漏洞的Fastjson版本，并且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 Fastjson 的反序列化漏洞，攻击者可以通过绕过 autoType 检查机制，实现远程代码执行。根据提供的漏洞库信息和搜索引擎结果，该漏洞的威胁较高，存在公开的POC。提供的POC代码利用了`java.io.InputStream`、`org.apache.commons.io`等类，结合file协议读取敏感文件内容，然后写入恶意字节码到服务器，最后触发恶意类加载执行，从而实现远程代码执行。 

**有效性评估：**
提供的POC代码看起来是有效的，因为它详细描述了利用步骤，包括将 java.io.InputStream 加入 fastjson autotype 缓存，使用 file 协议读取文件，写入恶意字节码，并最终触发恶意类加载。Dockerfile 提供了运行环境，也说明了有效性。

**投毒风险分析：**
虽然POC本身是为了验证漏洞，但也存在潜在的投毒风险。风险主要来源于以下几个方面：
1.  **恶意代码注入：**  虽然POC中提供了利用链，但是实际使用时，攻击者可以将`${shellcode}`替换为任意恶意代码，例如植入后门、窃取数据等。因为代码涉及动态写入文件，因此存在一定风险。
2.  **依赖污染：**  虽然POM文件声明了commons-io依赖，但是如果引入了其他不必要的、存在已知漏洞的依赖，也可能造成安全隐患。当前POM文件比较简洁，风险较低。
3. **隐藏Payload:** POC中的ClassLoader可能加载执行一些未知的类或恶意代码。 

总体评估，投毒风险约为10%。风险主要来源于使用者可能将`${shellcode}`替换为恶意代码。

**利用方式总结：**

1.  **绕过autoTypeCheck：**  该漏洞的关键在于绕过了 Fastjson 的 autoTypeCheck 机制，允许反序列化某些被限制的类。
2.  **利用java.io.InputStream和org.apache.commons-io：**  POC 利用这些类，结合 file 协议读取服务器上的敏感文件，比如tomcat的docBase路径等。
3.  **写入恶意文件：**  利用反序列化漏洞，将恶意的字节码写入到服务器的web目录，例如tomcat的docBase目录下。
4.  **触发恶意类加载：**  最后，通过构造特定的 JSON 数据，触发服务器加载并执行写入的恶意类，从而实现远程代码执行。

**项目地址:** [luelueking/CVE-2022-25845-In-Spring](https://github.com/luelueking/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #4

**来源**: [CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md](../2022/CVE-2022-25845-nerowander_CVE-2022-25845-exploit.md)

## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标系统使用了受影响版本的Fastjson，且未启用safeMode

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-25845 是一个Fastjson反序列化漏洞，攻击者可以绕过默认的autoType shutdown限制，在特定条件下实现远程代码执行。漏洞存在于1.2.83之前的版本中。根据搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。POC代码通过构造包含恶意类的JSON字符串，利用`JSON.parseObject`方法进行反序列化，从而执行任意代码。  

**有效性分析:**
根据漏洞库信息和搜索引擎结果，确认了该漏洞的存在以及利用方式。提供的POC代码使用了`java.lang.Exception`作为类型，并定义了一个`org.example.Poc`类，该类中的`setName`方法可以执行系统命令。POC中构造的JSON字符串`{"@type":"java.lang.Exception","@type":"org.example.Poc","name":"calc.exe"}`尝试利用`@type`指定类，然后通过setName方法调用`Runtime.getRuntime().exec()`执行calc.exe，证明了该漏洞的有效性。  

**投毒风险分析:**
仔细分析了提供的POC代码仓库中的所有文件，未发现任何明显的投毒代码。所有代码都与漏洞利用相关，没有发现恶意行为，所以投毒风险评估为0%。

**利用方式:**
1.  攻击者需要确定目标系统使用了受影响版本的Fastjson（< 1.2.83）。
2.  攻击者构造包含恶意类的JSON字符串，利用`@type`关键字指定类名，并利用setter/getter方法调用链执行任意代码。
3.  将构造的JSON字符串发送给目标系统。
4.  目标系统使用Fastjson进行反序列化操作，触发漏洞，执行攻击者预设的恶意代码。

**项目地址:** [nerowander/CVE-2022-25845-exploit](https://github.com/nerowander/CVE-2022-25845-exploit)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #5

**来源**: [CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的Fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是 Alibaba Fastjson 在 1.2.83 版本之前存在的一个反序列化漏洞。攻击者可以通过绕过 AutoTypeCheck 机制，发送恶意构造的 JSON 数据，从而在目标服务器上执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。搜索引擎结果中多篇文章表明该漏洞可以实现远程代码执行(RCE)。POC代码提供了一个完整的利用链，包含多个步骤，表明利用过程相对复杂，但可行。\n\n**投毒风险：**\n提供的POC代码主要包含以下几个部分：\n1.  `exp.py`:  主利用脚本，负责发送 payload 并协调整个攻击流程。\n2.  `payload/step1.json`, `payload/step2.json`, `payload/step3.json`, `payload/step4.json`:  不同的 JSON payload，分别用于不同的攻击阶段。\n3.  `payload/PocException.class`:  恶意 Java class 文件，用于在目标服务器上执行代码。\n查看了`LICENSE`文件，为`MIT License`较为宽松的开源协议，存在恶意投毒的概率较低。\n虽然脚本本身主要功能是漏洞利用，但在 `payload/PocException.class`中替换恶意class文件，有一定几率存在投毒风险，该恶意class文件会被上传至服务器执行，所以风险判断为10%。\n\n**利用方式：**\n该漏洞的利用方式是：\n1.  **添加 inputStream 到 fastjson 缓存:**  通过`step1.json`，将inputStream添加到缓存。\n2.  **读取目标服务器的 tomcat docbase 路径:** 通过`step2.json`利用布尔盲注的方式读取临时目录名，其中payload使用file协议读取目标服务器上的文件。\n3.  **将恶意的 class 文件写入 tomcat docbase 路径:** 通过`step3.json`，逐步写入恶意的 Java class 文件 (PocException.class) 到目标服务器的 tomcat docbase 路径下。\n4.  **恶意 class 加载:** 通过`step4.json`，触发恶意类的加载，从而执行恶意代码，导致远程代码执行。

**项目地址:** [ph0ebus/CVE-2022-25845-In-Spring](https://github.com/ph0ebus/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #6

**来源**: [CVE-2022-25845-scabench_fastjson-tp1fn1.md](../2022/CVE-2022-25845-scabench_fastjson-tp1fn1.md)

## CVE-2022-25845-fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用存在漏洞版本的fastjson，且autoType未被禁用或配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 fastjson 的反序列化漏洞，攻击者可以通过构造恶意的 JSON 数据，绕过 autoType 检查，从而在目标系统上执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。漏洞信息明确指出 fastjson 在 1.2.83 之前的版本存在反序列化漏洞，且可以通过绕过 autoType 限制来执行远程代码。搜索结果中也有多个链接指向漏洞分析和利用，其中一个链接甚至是exploit的github仓库地址。提供的 POC 代码 `CVE-2022-25845.json`  利用 `java.lang.Exception` 结合 `Trigger` 尝试触发命令执行(touch foo)，这是一种常见的 fastjson 反序列化漏洞利用方式。

**投毒风险：**

提供的 POC 代码包含一个 JSON 文件 (`CVE-2022-25845.json`) 和一个 Apache 2.0 许可文件 (`LICENSE`)。JSON 文件中包含用于触发漏洞的 payload，尝试执行 `touch foo` 命令。LICENSE 文件是标准的开源许可协议，本身不包含恶意代码。初步判断投毒风险较低，LICENSE是开源协议,本身不涉及投毒，payload部分touch foo的命令相对温和，但是并不能完全排除作者在其他分支或提交历史中隐藏恶意代码的可能性，比如更隐蔽的反弹shell等。综合判断，投毒风险约为 10%。

**利用方式：**

1.  **漏洞原理：** fastjson 在处理 JSON 数据时，如果启用了 autoType 功能，允许 JSON 数据中指定反序列化的类名。攻击者可以利用这个功能，构造恶意的 JSON 数据，指定反序列化某些特定的类，这些类在被反序列化时会执行任意代码。
2.  **利用过程：**
    *   攻击者构造包含恶意类名的 JSON 数据，例如 `java.lang.Exception`和`Trigger`，利用特定的类和属性来触发命令执行。
    *   攻击者将构造的 JSON 数据发送给使用了存在漏洞版本的 fastjson 的应用程序。
    *   fastjson 在反序列化 JSON 数据时，会根据 JSON 数据中指定的类名来创建对象。
    *   如果指定的类存在安全漏洞，例如可以执行任意代码，那么攻击者就可以利用这个漏洞来执行任意代码。

**总结：**

CVE-2022-25845 是一个高危的反序列化漏洞，攻击者可以利用它来执行远程代码。受影响的应用程序应该尽快升级到 fastjson 1.2.83 或更高版本，或者启用 safeMode 来缓解这个漏洞。

**项目地址:** [scabench/fastjson-tp1fn1](https://github.com/scabench/fastjson-tp1fn1)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---



---

## POC #5

**来源**: [CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的Fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是 Alibaba Fastjson 在 1.2.83 版本之前存在的一个反序列化漏洞。攻击者可以通过绕过 AutoTypeCheck 机制，发送恶意构造的 JSON 数据，从而在目标服务器上执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。搜索引擎结果中多篇文章表明该漏洞可以实现远程代码执行(RCE)。POC代码提供了一个完整的利用链，包含多个步骤，表明利用过程相对复杂，但可行。\n\n**投毒风险：**\n提供的POC代码主要包含以下几个部分：\n1.  `exp.py`:  主利用脚本，负责发送 payload 并协调整个攻击流程。\n2.  `payload/step1.json`, `payload/step2.json`, `payload/step3.json`, `payload/step4.json`:  不同的 JSON payload，分别用于不同的攻击阶段。\n3.  `payload/PocException.class`:  恶意 Java class 文件，用于在目标服务器上执行代码。\n查看了`LICENSE`文件，为`MIT License`较为宽松的开源协议，存在恶意投毒的概率较低。\n虽然脚本本身主要功能是漏洞利用，但在 `payload/PocException.class`中替换恶意class文件，有一定几率存在投毒风险，该恶意class文件会被上传至服务器执行，所以风险判断为10%。\n\n**利用方式：**\n该漏洞的利用方式是：\n1.  **添加 inputStream 到 fastjson 缓存:**  通过`step1.json`，将inputStream添加到缓存。\n2.  **读取目标服务器的 tomcat docbase 路径:** 通过`step2.json`利用布尔盲注的方式读取临时目录名，其中payload使用file协议读取目标服务器上的文件。\n3.  **将恶意的 class 文件写入 tomcat docbase 路径:** 通过`step3.json`，逐步写入恶意的 Java class 文件 (PocException.class) 到目标服务器的 tomcat docbase 路径下。\n4.  **恶意 class 加载:** 通过`step4.json`，触发恶意类的加载，从而执行恶意代码，导致远程代码执行。

**项目地址:** [ph0ebus/CVE-2022-25845-In-Spring](https://github.com/ph0ebus/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #6

**来源**: [CVE-2022-25845-scabench_fastjson-tp1fn1.md](../2022/CVE-2022-25845-scabench_fastjson-tp1fn1.md)

## CVE-2022-25845-fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用存在漏洞版本的fastjson，且autoType未被禁用或配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 fastjson 的反序列化漏洞，攻击者可以通过构造恶意的 JSON 数据，绕过 autoType 检查，从而在目标系统上执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。漏洞信息明确指出 fastjson 在 1.2.83 之前的版本存在反序列化漏洞，且可以通过绕过 autoType 限制来执行远程代码。搜索结果中也有多个链接指向漏洞分析和利用，其中一个链接甚至是exploit的github仓库地址。提供的 POC 代码 `CVE-2022-25845.json`  利用 `java.lang.Exception` 结合 `Trigger` 尝试触发命令执行(touch foo)，这是一种常见的 fastjson 反序列化漏洞利用方式。

**投毒风险：**

提供的 POC 代码包含一个 JSON 文件 (`CVE-2022-25845.json`) 和一个 Apache 2.0 许可文件 (`LICENSE`)。JSON 文件中包含用于触发漏洞的 payload，尝试执行 `touch foo` 命令。LICENSE 文件是标准的开源许可协议，本身不包含恶意代码。初步判断投毒风险较低，LICENSE是开源协议,本身不涉及投毒，payload部分touch foo的命令相对温和，但是并不能完全排除作者在其他分支或提交历史中隐藏恶意代码的可能性，比如更隐蔽的反弹shell等。综合判断，投毒风险约为 10%。

**利用方式：**

1.  **漏洞原理：** fastjson 在处理 JSON 数据时，如果启用了 autoType 功能，允许 JSON 数据中指定反序列化的类名。攻击者可以利用这个功能，构造恶意的 JSON 数据，指定反序列化某些特定的类，这些类在被反序列化时会执行任意代码。
2.  **利用过程：**
    *   攻击者构造包含恶意类名的 JSON 数据，例如 `java.lang.Exception`和`Trigger`，利用特定的类和属性来触发命令执行。
    *   攻击者将构造的 JSON 数据发送给使用了存在漏洞版本的 fastjson 的应用程序。
    *   fastjson 在反序列化 JSON 数据时，会根据 JSON 数据中指定的类名来创建对象。
    *   如果指定的类存在安全漏洞，例如可以执行任意代码，那么攻击者就可以利用这个漏洞来执行任意代码。

**总结：**

CVE-2022-25845 是一个高危的反序列化漏洞，攻击者可以利用它来执行远程代码。受影响的应用程序应该尽快升级到 fastjson 1.2.83 或更高版本，或者启用 safeMode 来缓解这个漏洞。

**项目地址:** [scabench/fastjson-tp1fn1](https://github.com/scabench/fastjson-tp1fn1)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---



---

## POC #5

**来源**: [CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的Fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是 Alibaba Fastjson 在 1.2.83 版本之前存在的一个反序列化漏洞。攻击者可以通过绕过 AutoTypeCheck 机制，发送恶意构造的 JSON 数据，从而在目标服务器上执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。搜索引擎结果中多篇文章表明该漏洞可以实现远程代码执行(RCE)。POC代码提供了一个完整的利用链，包含多个步骤，表明利用过程相对复杂，但可行。\n\n**投毒风险：**\n提供的POC代码主要包含以下几个部分：\n1.  `exp.py`:  主利用脚本，负责发送 payload 并协调整个攻击流程。\n2.  `payload/step1.json`, `payload/step2.json`, `payload/step3.json`, `payload/step4.json`:  不同的 JSON payload，分别用于不同的攻击阶段。\n3.  `payload/PocException.class`:  恶意 Java class 文件，用于在目标服务器上执行代码。\n查看了`LICENSE`文件，为`MIT License`较为宽松的开源协议，存在恶意投毒的概率较低。\n虽然脚本本身主要功能是漏洞利用，但在 `payload/PocException.class`中替换恶意class文件，有一定几率存在投毒风险，该恶意class文件会被上传至服务器执行，所以风险判断为10%。\n\n**利用方式：**\n该漏洞的利用方式是：\n1.  **添加 inputStream 到 fastjson 缓存:**  通过`step1.json`，将inputStream添加到缓存。\n2.  **读取目标服务器的 tomcat docbase 路径:** 通过`step2.json`利用布尔盲注的方式读取临时目录名，其中payload使用file协议读取目标服务器上的文件。\n3.  **将恶意的 class 文件写入 tomcat docbase 路径:** 通过`step3.json`，逐步写入恶意的 Java class 文件 (PocException.class) 到目标服务器的 tomcat docbase 路径下。\n4.  **恶意 class 加载:** 通过`step4.json`，触发恶意类的加载，从而执行恶意代码，导致远程代码执行。

**项目地址:** [ph0ebus/CVE-2022-25845-In-Spring](https://github.com/ph0ebus/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #6

**来源**: [CVE-2022-25845-scabench_fastjson-tp1fn1.md](../2022/CVE-2022-25845-scabench_fastjson-tp1fn1.md)

## CVE-2022-25845-fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用存在漏洞版本的fastjson，且autoType未被禁用或配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 fastjson 的反序列化漏洞，攻击者可以通过构造恶意的 JSON 数据，绕过 autoType 检查，从而在目标系统上执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。漏洞信息明确指出 fastjson 在 1.2.83 之前的版本存在反序列化漏洞，且可以通过绕过 autoType 限制来执行远程代码。搜索结果中也有多个链接指向漏洞分析和利用，其中一个链接甚至是exploit的github仓库地址。提供的 POC 代码 `CVE-2022-25845.json`  利用 `java.lang.Exception` 结合 `Trigger` 尝试触发命令执行(touch foo)，这是一种常见的 fastjson 反序列化漏洞利用方式。

**投毒风险：**

提供的 POC 代码包含一个 JSON 文件 (`CVE-2022-25845.json`) 和一个 Apache 2.0 许可文件 (`LICENSE`)。JSON 文件中包含用于触发漏洞的 payload，尝试执行 `touch foo` 命令。LICENSE 文件是标准的开源许可协议，本身不包含恶意代码。初步判断投毒风险较低，LICENSE是开源协议,本身不涉及投毒，payload部分touch foo的命令相对温和，但是并不能完全排除作者在其他分支或提交历史中隐藏恶意代码的可能性，比如更隐蔽的反弹shell等。综合判断，投毒风险约为 10%。

**利用方式：**

1.  **漏洞原理：** fastjson 在处理 JSON 数据时，如果启用了 autoType 功能，允许 JSON 数据中指定反序列化的类名。攻击者可以利用这个功能，构造恶意的 JSON 数据，指定反序列化某些特定的类，这些类在被反序列化时会执行任意代码。
2.  **利用过程：**
    *   攻击者构造包含恶意类名的 JSON 数据，例如 `java.lang.Exception`和`Trigger`，利用特定的类和属性来触发命令执行。
    *   攻击者将构造的 JSON 数据发送给使用了存在漏洞版本的 fastjson 的应用程序。
    *   fastjson 在反序列化 JSON 数据时，会根据 JSON 数据中指定的类名来创建对象。
    *   如果指定的类存在安全漏洞，例如可以执行任意代码，那么攻击者就可以利用这个漏洞来执行任意代码。

**总结：**

CVE-2022-25845 是一个高危的反序列化漏洞，攻击者可以利用它来执行远程代码。受影响的应用程序应该尽快升级到 fastjson 1.2.83 或更高版本，或者启用 safeMode 来缓解这个漏洞。

**项目地址:** [scabench/fastjson-tp1fn1](https://github.com/scabench/fastjson-tp1fn1)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---



---

## POC #5

**来源**: [CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的Fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是 Alibaba Fastjson 在 1.2.83 版本之前存在的一个反序列化漏洞。攻击者可以通过绕过 AutoTypeCheck 机制，发送恶意构造的 JSON 数据，从而在目标服务器上执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。搜索引擎结果中多篇文章表明该漏洞可以实现远程代码执行(RCE)。POC代码提供了一个完整的利用链，包含多个步骤，表明利用过程相对复杂，但可行。\n\n**投毒风险：**\n提供的POC代码主要包含以下几个部分：\n1.  `exp.py`:  主利用脚本，负责发送 payload 并协调整个攻击流程。\n2.  `payload/step1.json`, `payload/step2.json`, `payload/step3.json`, `payload/step4.json`:  不同的 JSON payload，分别用于不同的攻击阶段。\n3.  `payload/PocException.class`:  恶意 Java class 文件，用于在目标服务器上执行代码。\n查看了`LICENSE`文件，为`MIT License`较为宽松的开源协议，存在恶意投毒的概率较低。\n虽然脚本本身主要功能是漏洞利用，但在 `payload/PocException.class`中替换恶意class文件，有一定几率存在投毒风险，该恶意class文件会被上传至服务器执行，所以风险判断为10%。\n\n**利用方式：**\n该漏洞的利用方式是：\n1.  **添加 inputStream 到 fastjson 缓存:**  通过`step1.json`，将inputStream添加到缓存。\n2.  **读取目标服务器的 tomcat docbase 路径:** 通过`step2.json`利用布尔盲注的方式读取临时目录名，其中payload使用file协议读取目标服务器上的文件。\n3.  **将恶意的 class 文件写入 tomcat docbase 路径:** 通过`step3.json`，逐步写入恶意的 Java class 文件 (PocException.class) 到目标服务器的 tomcat docbase 路径下。\n4.  **恶意 class 加载:** 通过`step4.json`，触发恶意类的加载，从而执行恶意代码，导致远程代码执行。

**项目地址:** [ph0ebus/CVE-2022-25845-In-Spring](https://github.com/ph0ebus/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #6

**来源**: [CVE-2022-25845-scabench_fastjson-tp1fn1.md](../2022/CVE-2022-25845-scabench_fastjson-tp1fn1.md)

## CVE-2022-25845-fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用存在漏洞版本的fastjson，且autoType未被禁用或配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 fastjson 的反序列化漏洞，攻击者可以通过构造恶意的 JSON 数据，绕过 autoType 检查，从而在目标系统上执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。漏洞信息明确指出 fastjson 在 1.2.83 之前的版本存在反序列化漏洞，且可以通过绕过 autoType 限制来执行远程代码。搜索结果中也有多个链接指向漏洞分析和利用，其中一个链接甚至是exploit的github仓库地址。提供的 POC 代码 `CVE-2022-25845.json`  利用 `java.lang.Exception` 结合 `Trigger` 尝试触发命令执行(touch foo)，这是一种常见的 fastjson 反序列化漏洞利用方式。

**投毒风险：**

提供的 POC 代码包含一个 JSON 文件 (`CVE-2022-25845.json`) 和一个 Apache 2.0 许可文件 (`LICENSE`)。JSON 文件中包含用于触发漏洞的 payload，尝试执行 `touch foo` 命令。LICENSE 文件是标准的开源许可协议，本身不包含恶意代码。初步判断投毒风险较低，LICENSE是开源协议,本身不涉及投毒，payload部分touch foo的命令相对温和，但是并不能完全排除作者在其他分支或提交历史中隐藏恶意代码的可能性，比如更隐蔽的反弹shell等。综合判断，投毒风险约为 10%。

**利用方式：**

1.  **漏洞原理：** fastjson 在处理 JSON 数据时，如果启用了 autoType 功能，允许 JSON 数据中指定反序列化的类名。攻击者可以利用这个功能，构造恶意的 JSON 数据，指定反序列化某些特定的类，这些类在被反序列化时会执行任意代码。
2.  **利用过程：**
    *   攻击者构造包含恶意类名的 JSON 数据，例如 `java.lang.Exception`和`Trigger`，利用特定的类和属性来触发命令执行。
    *   攻击者将构造的 JSON 数据发送给使用了存在漏洞版本的 fastjson 的应用程序。
    *   fastjson 在反序列化 JSON 数据时，会根据 JSON 数据中指定的类名来创建对象。
    *   如果指定的类存在安全漏洞，例如可以执行任意代码，那么攻击者就可以利用这个漏洞来执行任意代码。

**总结：**

CVE-2022-25845 是一个高危的反序列化漏洞，攻击者可以利用它来执行远程代码。受影响的应用程序应该尽快升级到 fastjson 1.2.83 或更高版本，或者启用 safeMode 来缓解这个漏洞。

**项目地址:** [scabench/fastjson-tp1fn1](https://github.com/scabench/fastjson-tp1fn1)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---



---

## POC #5

**来源**: [CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md](../2022/CVE-2022-25845-ph0ebus_CVE-2022-25845-In-Spring.md)

## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标应用使用了存在漏洞的Fastjson版本，且未启用safeMode。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是 Alibaba Fastjson 在 1.2.83 版本之前存在的一个反序列化漏洞。攻击者可以通过绕过 AutoTypeCheck 机制，发送恶意构造的 JSON 数据，从而在目标服务器上执行任意代码。\n\n**有效性：**\n根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。搜索引擎结果中多篇文章表明该漏洞可以实现远程代码执行(RCE)。POC代码提供了一个完整的利用链，包含多个步骤，表明利用过程相对复杂，但可行。\n\n**投毒风险：**\n提供的POC代码主要包含以下几个部分：\n1.  `exp.py`:  主利用脚本，负责发送 payload 并协调整个攻击流程。\n2.  `payload/step1.json`, `payload/step2.json`, `payload/step3.json`, `payload/step4.json`:  不同的 JSON payload，分别用于不同的攻击阶段。\n3.  `payload/PocException.class`:  恶意 Java class 文件，用于在目标服务器上执行代码。\n查看了`LICENSE`文件，为`MIT License`较为宽松的开源协议，存在恶意投毒的概率较低。\n虽然脚本本身主要功能是漏洞利用，但在 `payload/PocException.class`中替换恶意class文件，有一定几率存在投毒风险，该恶意class文件会被上传至服务器执行，所以风险判断为10%。\n\n**利用方式：**\n该漏洞的利用方式是：\n1.  **添加 inputStream 到 fastjson 缓存:**  通过`step1.json`，将inputStream添加到缓存。\n2.  **读取目标服务器的 tomcat docbase 路径:** 通过`step2.json`利用布尔盲注的方式读取临时目录名，其中payload使用file协议读取目标服务器上的文件。\n3.  **将恶意的 class 文件写入 tomcat docbase 路径:** 通过`step3.json`，逐步写入恶意的 Java class 文件 (PocException.class) 到目标服务器的 tomcat docbase 路径下。\n4.  **恶意 class 加载:** 通过`step4.json`，触发恶意类的加载，从而执行恶意代码，导致远程代码执行。

**项目地址:** [ph0ebus/CVE-2022-25845-In-Spring](https://github.com/ph0ebus/CVE-2022-25845-In-Spring)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

## POC #6

**来源**: [CVE-2022-25845-scabench_fastjson-tp1fn1.md](../2022/CVE-2022-25845-scabench_fastjson-tp1fn1.md)

## CVE-2022-25845-fastjson-反序列化

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 需要目标系统使用存在漏洞版本的fastjson，且autoType未被禁用或配置不当

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25845 是一个 fastjson 的反序列化漏洞，攻击者可以通过构造恶意的 JSON 数据，绕过 autoType 检查，从而在目标系统上执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。漏洞信息明确指出 fastjson 在 1.2.83 之前的版本存在反序列化漏洞，且可以通过绕过 autoType 限制来执行远程代码。搜索结果中也有多个链接指向漏洞分析和利用，其中一个链接甚至是exploit的github仓库地址。提供的 POC 代码 `CVE-2022-25845.json`  利用 `java.lang.Exception` 结合 `Trigger` 尝试触发命令执行(touch foo)，这是一种常见的 fastjson 反序列化漏洞利用方式。

**投毒风险：**

提供的 POC 代码包含一个 JSON 文件 (`CVE-2022-25845.json`) 和一个 Apache 2.0 许可文件 (`LICENSE`)。JSON 文件中包含用于触发漏洞的 payload，尝试执行 `touch foo` 命令。LICENSE 文件是标准的开源许可协议，本身不包含恶意代码。初步判断投毒风险较低，LICENSE是开源协议,本身不涉及投毒，payload部分touch foo的命令相对温和，但是并不能完全排除作者在其他分支或提交历史中隐藏恶意代码的可能性，比如更隐蔽的反弹shell等。综合判断，投毒风险约为 10%。

**利用方式：**

1.  **漏洞原理：** fastjson 在处理 JSON 数据时，如果启用了 autoType 功能，允许 JSON 数据中指定反序列化的类名。攻击者可以利用这个功能，构造恶意的 JSON 数据，指定反序列化某些特定的类，这些类在被反序列化时会执行任意代码。
2.  **利用过程：**
    *   攻击者构造包含恶意类名的 JSON 数据，例如 `java.lang.Exception`和`Trigger`，利用特定的类和属性来触发命令执行。
    *   攻击者将构造的 JSON 数据发送给使用了存在漏洞版本的 fastjson 的应用程序。
    *   fastjson 在反序列化 JSON 数据时，会根据 JSON 数据中指定的类名来创建对象。
    *   如果指定的类存在安全漏洞，例如可以执行任意代码，那么攻击者就可以利用这个漏洞来执行任意代码。

**总结：**

CVE-2022-25845 是一个高危的反序列化漏洞，攻击者可以利用它来执行远程代码。受影响的应用程序应该尽快升级到 fastjson 1.2.83 或更高版本，或者启用 safeMode 来缓解这个漏洞。

**项目地址:** [scabench/fastjson-tp1fn1](https://github.com/scabench/fastjson-tp1fn1)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)

---

