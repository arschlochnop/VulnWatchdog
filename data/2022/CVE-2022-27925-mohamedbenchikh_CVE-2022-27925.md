# CVE-2022-27925

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-路径遍历/任意文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限（根据搜索结果1，6，8表明可以绕过认证，实现未经身份验证的RCE），目标系统存在漏洞，可以访问Zimbra服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Zimbra Collaboration Suite (ZCS) 的mboximport功能中。拥有管理员权限的认证用户（或未经认证的用户，如果存在其他漏洞如CVE-2022-37042）可以上传包含恶意路径的ZIP文件，导致目录遍历，最终写入任意文件。POC通过上传包含JSP Webshell的ZIP文件到服务器，然后通过访问该Webshell执行任意命令。根据Volexity的博客，存在身份验证绕过。

**有效性：** 提供的POC代码似乎有效，因为它利用了 zip 文件解压时的路径遍历漏洞来上传 webshell，并且代码中包含了验证 webshell 是否成功上传并执行命令的逻辑。

**投毒风险：** POC代码本身主要是利用漏洞，没有明显的恶意投毒代码。代码首先构造一个ZIP文件，包含一个JSP webshell，然后通过POST请求上传该ZIP文件。之后，尝试访问上传的webshell并执行命令。投毒风险较低，主要风险在于利用成功后，上传的webshell本身就是后门。代码中的随机webshell文件名和反向shell功能可以被用于恶意目的，但这些都属于漏洞利用的范畴，而非代码投毒。

**利用方式：**

1.  **认证/未认证（取决于是否存在身份认证绕过漏洞）：** 根据漏洞描述，最初需要管理员权限。但根据搜索引擎结果 (例如Volexity博客) ，存在可以绕过身份验证的利用方法，可直接实现未授权RCE。 
2.  **构造恶意ZIP文件：**  创建一个包含恶意JSP文件的ZIP文件。恶意JSP文件包含 webshell 代码，允许远程执行命令。文件名使用路径遍历payload，例如 `../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/shell.jsp`。
3.  **上传ZIP文件：**  使用mboximport功能上传构造的ZIP文件。POC代码中使用了两个不同的URL，都指向mboximport功能，以增加漏洞利用的成功率。
4.  **访问Webshell：**  上传成功后，通过构造的URL访问上传的JSP webshell，从而执行任意命令。
5.  **反向Shell：**  POC代码还包含创建反向shell的功能，允许攻击者获得对受感染服务器的shell访问权限。


**项目地址:** [Chocapikk/CVE-2022-27925-Revshell](https://github.com/Chocapikk/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #2

**来源**: [CVE-2022-27925-Inplex-sys_CVE-2022-27925.md](../2022/CVE-2022-27925-Inplex-sys_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件写入和远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925 漏洞存在于 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 的 mboximport 功能中。该功能允许经过身份验证并具有管理员权限的用户上传 ZIP 压缩包，并从中提取文件。由于未对压缩包中的文件名进行充分的路径验证，攻击者可以构造包含恶意路径的压缩包，从而将任意文件写入服务器的任意位置。根据搜索结果，该漏洞已被大规模利用，甚至存在绕过身份验证的利用方式（虽然漏洞描述本身需要管理员权限）。漏洞利用代码中仅包含Apache License 2.0许可协议，没有发现潜在的投毒代码。

**利用方式：**

1.  攻击者需要拥有 Zimbra ZCS 的管理员账户权限（原始漏洞描述）。但根据搜索结果，存在身份验证绕过方法，攻击者可能无需管理员权限即可利用。
2.  攻击者创建一个恶意的 ZIP 压缩包，该压缩包中的文件名包含路径遍历字符串 (例如 `../../../path/to/target/file`)。
3.  攻击者使用 mboximport 功能上传该 ZIP 压缩包。
4.  Zimbra ZCS 解压该压缩包，并将文件写入攻击者指定的任意位置。

通过写入恶意文件（例如 webshell）到 Web 服务器的可访问目录，攻击者可以实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-27925](https://github.com/Inplex-sys/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #3

**来源**: [CVE-2022-27925-Josexv1_CVE-2022-27925.md](../2022/CVE-2022-27925-Josexv1_CVE-2022-27925.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 任意文件上传导致目录遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Zimbra Collaboration Suite Network Edition 9.0.0 Patch 23 (及更早版本); Zimbra Collaboration Suite Network Edition 8.8.15 Patch 30 (及更早版本)

**利用条件:** 需要目标存在漏洞版本的Zimbra Collaboration Suite，且攻击者可以通过网络访问目标服务器的7071端口(默认管理员端口)。某些情况下需要绕过身份验证 (CVE-2022-37042)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中，该功能接收ZIP压缩包并从中提取文件。由于存在路径遍历漏洞，攻击者可以通过构造恶意的ZIP压缩包，将任意文件上传到服务器的任意目录。根据搜索引擎结果，早期需要管理员权限，但后续发现存在身份验证绕过漏洞（CVE-2022-37042），允许未经身份验证的攻击者利用该漏洞。提供的POC代码利用了这一漏洞，通过上传JSP webshell来实现远程代码执行。由于POC代码只包含漏洞利用逻辑，不包含任何与漏洞利用无关的恶意代码，因此投毒风险较低。该POC的有效性较高，但需要注意的是，如果目标服务器已经修复了漏洞，则利用会失败。利用方式是，首先判断目标是否为漏洞版本，然后构造包含恶意路径的ZIP文件，上传到服务器指定目录，然后访问上传的JSP webshell，执行任意命令。

POC代码分析：

*   代码通过 `-t` 参数指定目标URL，通过 `-l` 参数指定目标列表。
*   代码首先测试目标URL是否可访问。
*   然后，代码构造恶意的ZIP文件，该ZIP文件包含一个JSP webshell，并将其放置在目标服务器的 `mailboxd/webapps/zimbraAdmin/` 或者 `jetty_base/webapps/zimbraAdmin/` 目录下。
*   代码利用Zimbra的mboximport功能上传ZIP文件，触发路径遍历漏洞。
*   最后，代码尝试访问上传的JSP webshell，如果访问成功，则表示漏洞利用成功，并显示webshell的URL地址，以及执行 `uname -a` 命令的结果。

综上，该漏洞利用有效性较高，但取决于目标是否已修复。POC代码不包含明显投毒代码，因此投毒风险为0%。漏洞利用方式清晰，攻击者可以通过构造恶意的ZIP文件，上传webshell，实现远程代码执行。

**项目地址:** [Josexv1/CVE-2022-27925](https://github.com/Josexv1/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #4

**来源**: [CVE-2022-27925-akincibor_CVE-2022-27925.md](../2022/CVE-2022-27925-akincibor_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历/远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限或借助其他漏洞绕过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite（ZCS）中的目录遍历漏洞。攻击者通过利用mboximport功能，上传包含恶意构造的ZIP压缩包，ZIP压缩包中包含带有目录遍历的jsp文件，上传文件最终解压写入到服务器任意目录。漏洞需要管理员权限，但是存在认证绕过，所以可以未经授权直接访问。

**有效性：**

提供的POC代码是一个nuclei模板，通过发送精心构造的POST请求到`/service/extension/backup/mboximport`端点，上传包含恶意JSP文件的ZIP压缩包。ZIP包里的目录结构为`../../../../mailboxd/webapps/zimbraAdmin/cmd.jsp`，利用目录遍历将JSP文件写入到目标目录。该JSP文件`cmd.jsp`是一个简单的命令执行webshell，允许攻击者通过GET请求的`cmd`参数执行任意系统命令。搜索引擎结果表明该漏洞在野外已被积极利用，该POC利用方式是有效的。

**投毒风险：**

该POC代码本身就是一个漏洞利用程序，目的是在目标服务器上部署webshell。从代码本身来看，不存在额外的、作者隐藏的恶意代码或后门。ZIP压缩包中包含的是一个标准的命令执行JSP webshell，其行为是可预测和可理解的。可以判定此仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  攻击者首先需要访问Zimbra服务器的`/service/extension/backup/mboximport`端点。这个端点通常需要管理员权限，但是可能存在身份验证绕过漏洞（例如CVE-2022-37042），允许未经授权的访问。
2.  攻击者构造一个包含恶意JSP文件的ZIP压缩包，其中JSP文件的路径包含目录遍历序列（`../`），将文件写入到`/mailboxd/webapps/zimbraAdmin/`目录下，命名为`cmd.jsp`。
3.  攻击者将构造好的ZIP文件作为POST请求的内容上传到`/service/extension/backup/mboximport`端点。
4.  Zimbra服务器解压上传的ZIP文件，由于目录遍历漏洞，恶意JSP文件被写入到`/mailboxd/webapps/zimbraAdmin/cmd.jsp`。
5.  攻击者通过访问`/zimbraAdmin/cmd.jsp?cmd=<command>`来执行任意系统命令，从而控制服务器。


**项目地址:** [akincibor/CVE-2022-27925](https://github.com/akincibor/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #5

**来源**: [CVE-2022-27925-jam620_Zimbra.md](../2022/CVE-2022-27925-jam620_Zimbra.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 目录遍历和远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限（初始评估），但后续研究发现存在认证绕过，降低了利用门槛。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925 存在于 Zimbra Collaboration Suite (ZCS) 的 mboximport 功能中，允许经过身份验证的管理员用户通过上传包含恶意路径的 ZIP 归档文件，实现目录遍历，最终上传任意文件到系统。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果（特别是Volexity的博客），此漏洞已被大规模利用。提供的漏洞利用代码（来自 GitHub 仓库 Josexv1/CVE-2022-27925 和 vnhacker1337/CVE-2022-27925-PoC）提供了利用此漏洞的 POC，并且成功实现了远程代码执行。因此，可以判断此POC代码有效。

**投毒风险分析：**
代码仓库`vnhacker1337/CVE-2022-27925-PoC`提供的利用链比较完整，包含目标枚举，漏洞利用，后渗透利用。从给出的信息看，作者进行了后渗透利用，但这些操作不属于投毒行为。代码中直接包含恶意行为的部分可能性较低，所以投毒风险评估为10%。

**利用方式：**
1.  **认证绕过 (CVE-2022-37042):** 最初需要管理员权限，但后续研究揭示存在认证绕过漏洞（CVE-2022-37042），使得未认证的攻击者也能利用该漏洞，降低了利用门槛。
2.  **上传恶意 ZIP 文件：** 利用 mboximport 功能，上传包含恶意构造路径的 ZIP 归档文件。这些路径指向目标文件系统中的特定位置，以便写入或覆盖文件。
3.  **目录遍历：** ZIP 文件中的恶意路径使得解压过程突破目录限制，导致任意文件写入。
4.  **远程代码执行：** 通过写入 Webshell 或其他可执行文件，最终实现远程代码执行。
5.  **后渗透攻击：** 攻击者可以安装后门、窃取数据，甚至部署勒索软件。

**总结：** 该漏洞利用需要上传特定的ZIP文件，利用Zimbra自身的功能进行目录穿越，最终实现代码执行。从搜索结果来看，该漏洞已被广泛利用。

**项目地址:** [jam620/Zimbra](https://github.com/jam620/Zimbra)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #6

**来源**: [CVE-2022-27925-miko550_CVE-2022-27925.md](../2022/CVE-2022-27925-miko550_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限，但可能存在未授权访问利用链（CVE-2022-37042）。 需要能够上传 ZIP 压缩包到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中。一个具有管理员权限的认证用户可以通过上传恶意的ZIP压缩包，利用路径遍历漏洞将任意文件写入系统，最终可能导致远程代码执行。POC代码通过构造包含恶意路径的ZIP文件，并利用mboximport接口上传到服务器。搜索引擎结果显示，此漏洞被大规模利用，并且存在未经身份验证的利用方式（CVE-2022-37042）。

**漏洞利用方式：**

1.  攻击者需要访问Zimbra服务器的mboximport功能。
2.  攻击者构造一个包含恶意路径的ZIP压缩包。该ZIP包中的文件路径包含路径遍历字符（例如`../`），指向服务器文件系统中的目标位置。
3.  攻击者通过mboximport接口上传该ZIP压缩包。
4.  Zimbra服务器解压该ZIP压缩包，由于没有充分验证文件路径，导致恶意文件被写入到指定的位置。
5. 攻击者可以通过上传webshell等文件, 获取服务器的控制权限.

**投毒风险分析：**

虽然POC代码本身功能是实现漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **利用脚本的隐蔽修改：** 攻击者可能在原始利用脚本中添加额外的恶意代码，例如反向shell、数据收集等。用户下载并执行被篡改的脚本后，可能会受到进一步的攻击。
2.  **ZIP文件内容替换：** 攻击者可能会替换POC中使用的ZIP文件，使其包含更具破坏性的恶意代码或文件。
3.  **对cmd.jsp的修改:** 攻击者可能会修改`cmd.jsp`里的内容,植入恶意代码.

基于以上分析，我将投毒风险评定为10%。 虽然poc验证本身是按照漏洞描述进行的, 没有发现明确的后门, 但是用户在使用POC时，仍应保持警惕，验证代码的完整性和安全性。特别注意检查ZIP文件的内容以及利用脚本的来源。

**项目地址:** [miko550/CVE-2022-27925](https://github.com/miko550/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #7

**来源**: [CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md](../2022/CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md)

# CVE-2022-27925

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-路径遍历/任意文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限（根据搜索结果1，6，8表明可以绕过认证，实现未经身份验证的RCE），目标系统存在漏洞，可以访问Zimbra服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Zimbra Collaboration Suite (ZCS) 的mboximport功能中。拥有管理员权限的认证用户（或未经认证的用户，如果存在其他漏洞如CVE-2022-37042）可以上传包含恶意路径的ZIP文件，导致目录遍历，最终写入任意文件。POC通过上传包含JSP Webshell的ZIP文件到服务器，然后通过访问该Webshell执行任意命令。根据Volexity的博客，存在身份验证绕过。

**有效性：** 提供的POC代码似乎有效，因为它利用了 zip 文件解压时的路径遍历漏洞来上传 webshell，并且代码中包含了验证 webshell 是否成功上传并执行命令的逻辑。

**投毒风险：** POC代码本身主要是利用漏洞，没有明显的恶意投毒代码。代码首先构造一个ZIP文件，包含一个JSP webshell，然后通过POST请求上传该ZIP文件。之后，尝试访问上传的webshell并执行命令。投毒风险较低，主要风险在于利用成功后，上传的webshell本身就是后门。代码中的随机webshell文件名和反向shell功能可以被用于恶意目的，但这些都属于漏洞利用的范畴，而非代码投毒。

**利用方式：**

1.  **认证/未认证（取决于是否存在身份认证绕过漏洞）：** 根据漏洞描述，最初需要管理员权限。但根据搜索引擎结果 (例如Volexity博客) ，存在可以绕过身份验证的利用方法，可直接实现未授权RCE。 
2.  **构造恶意ZIP文件：**  创建一个包含恶意JSP文件的ZIP文件。恶意JSP文件包含 webshell 代码，允许远程执行命令。文件名使用路径遍历payload，例如 `../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/shell.jsp`。
3.  **上传ZIP文件：**  使用mboximport功能上传构造的ZIP文件。POC代码中使用了两个不同的URL，都指向mboximport功能，以增加漏洞利用的成功率。
4.  **访问Webshell：**  上传成功后，通过构造的URL访问上传的JSP webshell，从而执行任意命令。
5.  **反向Shell：**  POC代码还包含创建反向shell的功能，允许攻击者获得对受感染服务器的shell访问权限。


**项目地址:** [Chocapikk/CVE-2022-27925-Revshell](https://github.com/Chocapikk/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #2

**来源**: [CVE-2022-27925-Inplex-sys_CVE-2022-27925.md](../2022/CVE-2022-27925-Inplex-sys_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件写入和远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925 漏洞存在于 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 的 mboximport 功能中。该功能允许经过身份验证并具有管理员权限的用户上传 ZIP 压缩包，并从中提取文件。由于未对压缩包中的文件名进行充分的路径验证，攻击者可以构造包含恶意路径的压缩包，从而将任意文件写入服务器的任意位置。根据搜索结果，该漏洞已被大规模利用，甚至存在绕过身份验证的利用方式（虽然漏洞描述本身需要管理员权限）。漏洞利用代码中仅包含Apache License 2.0许可协议，没有发现潜在的投毒代码。

**利用方式：**

1.  攻击者需要拥有 Zimbra ZCS 的管理员账户权限（原始漏洞描述）。但根据搜索结果，存在身份验证绕过方法，攻击者可能无需管理员权限即可利用。
2.  攻击者创建一个恶意的 ZIP 压缩包，该压缩包中的文件名包含路径遍历字符串 (例如 `../../../path/to/target/file`)。
3.  攻击者使用 mboximport 功能上传该 ZIP 压缩包。
4.  Zimbra ZCS 解压该压缩包，并将文件写入攻击者指定的任意位置。

通过写入恶意文件（例如 webshell）到 Web 服务器的可访问目录，攻击者可以实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-27925](https://github.com/Inplex-sys/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #3

**来源**: [CVE-2022-27925-Josexv1_CVE-2022-27925.md](../2022/CVE-2022-27925-Josexv1_CVE-2022-27925.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 任意文件上传导致目录遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Zimbra Collaboration Suite Network Edition 9.0.0 Patch 23 (及更早版本); Zimbra Collaboration Suite Network Edition 8.8.15 Patch 30 (及更早版本)

**利用条件:** 需要目标存在漏洞版本的Zimbra Collaboration Suite，且攻击者可以通过网络访问目标服务器的7071端口(默认管理员端口)。某些情况下需要绕过身份验证 (CVE-2022-37042)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中，该功能接收ZIP压缩包并从中提取文件。由于存在路径遍历漏洞，攻击者可以通过构造恶意的ZIP压缩包，将任意文件上传到服务器的任意目录。根据搜索引擎结果，早期需要管理员权限，但后续发现存在身份验证绕过漏洞（CVE-2022-37042），允许未经身份验证的攻击者利用该漏洞。提供的POC代码利用了这一漏洞，通过上传JSP webshell来实现远程代码执行。由于POC代码只包含漏洞利用逻辑，不包含任何与漏洞利用无关的恶意代码，因此投毒风险较低。该POC的有效性较高，但需要注意的是，如果目标服务器已经修复了漏洞，则利用会失败。利用方式是，首先判断目标是否为漏洞版本，然后构造包含恶意路径的ZIP文件，上传到服务器指定目录，然后访问上传的JSP webshell，执行任意命令。

POC代码分析：

*   代码通过 `-t` 参数指定目标URL，通过 `-l` 参数指定目标列表。
*   代码首先测试目标URL是否可访问。
*   然后，代码构造恶意的ZIP文件，该ZIP文件包含一个JSP webshell，并将其放置在目标服务器的 `mailboxd/webapps/zimbraAdmin/` 或者 `jetty_base/webapps/zimbraAdmin/` 目录下。
*   代码利用Zimbra的mboximport功能上传ZIP文件，触发路径遍历漏洞。
*   最后，代码尝试访问上传的JSP webshell，如果访问成功，则表示漏洞利用成功，并显示webshell的URL地址，以及执行 `uname -a` 命令的结果。

综上，该漏洞利用有效性较高，但取决于目标是否已修复。POC代码不包含明显投毒代码，因此投毒风险为0%。漏洞利用方式清晰，攻击者可以通过构造恶意的ZIP文件，上传webshell，实现远程代码执行。

**项目地址:** [Josexv1/CVE-2022-27925](https://github.com/Josexv1/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #4

**来源**: [CVE-2022-27925-akincibor_CVE-2022-27925.md](../2022/CVE-2022-27925-akincibor_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历/远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限或借助其他漏洞绕过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite（ZCS）中的目录遍历漏洞。攻击者通过利用mboximport功能，上传包含恶意构造的ZIP压缩包，ZIP压缩包中包含带有目录遍历的jsp文件，上传文件最终解压写入到服务器任意目录。漏洞需要管理员权限，但是存在认证绕过，所以可以未经授权直接访问。

**有效性：**

提供的POC代码是一个nuclei模板，通过发送精心构造的POST请求到`/service/extension/backup/mboximport`端点，上传包含恶意JSP文件的ZIP压缩包。ZIP包里的目录结构为`../../../../mailboxd/webapps/zimbraAdmin/cmd.jsp`，利用目录遍历将JSP文件写入到目标目录。该JSP文件`cmd.jsp`是一个简单的命令执行webshell，允许攻击者通过GET请求的`cmd`参数执行任意系统命令。搜索引擎结果表明该漏洞在野外已被积极利用，该POC利用方式是有效的。

**投毒风险：**

该POC代码本身就是一个漏洞利用程序，目的是在目标服务器上部署webshell。从代码本身来看，不存在额外的、作者隐藏的恶意代码或后门。ZIP压缩包中包含的是一个标准的命令执行JSP webshell，其行为是可预测和可理解的。可以判定此仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  攻击者首先需要访问Zimbra服务器的`/service/extension/backup/mboximport`端点。这个端点通常需要管理员权限，但是可能存在身份验证绕过漏洞（例如CVE-2022-37042），允许未经授权的访问。
2.  攻击者构造一个包含恶意JSP文件的ZIP压缩包，其中JSP文件的路径包含目录遍历序列（`../`），将文件写入到`/mailboxd/webapps/zimbraAdmin/`目录下，命名为`cmd.jsp`。
3.  攻击者将构造好的ZIP文件作为POST请求的内容上传到`/service/extension/backup/mboximport`端点。
4.  Zimbra服务器解压上传的ZIP文件，由于目录遍历漏洞，恶意JSP文件被写入到`/mailboxd/webapps/zimbraAdmin/cmd.jsp`。
5.  攻击者通过访问`/zimbraAdmin/cmd.jsp?cmd=<command>`来执行任意系统命令，从而控制服务器。


**项目地址:** [akincibor/CVE-2022-27925](https://github.com/akincibor/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #5

**来源**: [CVE-2022-27925-jam620_Zimbra.md](../2022/CVE-2022-27925-jam620_Zimbra.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 目录遍历和远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限（初始评估），但后续研究发现存在认证绕过，降低了利用门槛。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925 存在于 Zimbra Collaboration Suite (ZCS) 的 mboximport 功能中，允许经过身份验证的管理员用户通过上传包含恶意路径的 ZIP 归档文件，实现目录遍历，最终上传任意文件到系统。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果（特别是Volexity的博客），此漏洞已被大规模利用。提供的漏洞利用代码（来自 GitHub 仓库 Josexv1/CVE-2022-27925 和 vnhacker1337/CVE-2022-27925-PoC）提供了利用此漏洞的 POC，并且成功实现了远程代码执行。因此，可以判断此POC代码有效。

**投毒风险分析：**
代码仓库`vnhacker1337/CVE-2022-27925-PoC`提供的利用链比较完整，包含目标枚举，漏洞利用，后渗透利用。从给出的信息看，作者进行了后渗透利用，但这些操作不属于投毒行为。代码中直接包含恶意行为的部分可能性较低，所以投毒风险评估为10%。

**利用方式：**
1.  **认证绕过 (CVE-2022-37042):** 最初需要管理员权限，但后续研究揭示存在认证绕过漏洞（CVE-2022-37042），使得未认证的攻击者也能利用该漏洞，降低了利用门槛。
2.  **上传恶意 ZIP 文件：** 利用 mboximport 功能，上传包含恶意构造路径的 ZIP 归档文件。这些路径指向目标文件系统中的特定位置，以便写入或覆盖文件。
3.  **目录遍历：** ZIP 文件中的恶意路径使得解压过程突破目录限制，导致任意文件写入。
4.  **远程代码执行：** 通过写入 Webshell 或其他可执行文件，最终实现远程代码执行。
5.  **后渗透攻击：** 攻击者可以安装后门、窃取数据，甚至部署勒索软件。

**总结：** 该漏洞利用需要上传特定的ZIP文件，利用Zimbra自身的功能进行目录穿越，最终实现代码执行。从搜索结果来看，该漏洞已被广泛利用。

**项目地址:** [jam620/Zimbra](https://github.com/jam620/Zimbra)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #6

**来源**: [CVE-2022-27925-miko550_CVE-2022-27925.md](../2022/CVE-2022-27925-miko550_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限，但可能存在未授权访问利用链（CVE-2022-37042）。 需要能够上传 ZIP 压缩包到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中。一个具有管理员权限的认证用户可以通过上传恶意的ZIP压缩包，利用路径遍历漏洞将任意文件写入系统，最终可能导致远程代码执行。POC代码通过构造包含恶意路径的ZIP文件，并利用mboximport接口上传到服务器。搜索引擎结果显示，此漏洞被大规模利用，并且存在未经身份验证的利用方式（CVE-2022-37042）。

**漏洞利用方式：**

1.  攻击者需要访问Zimbra服务器的mboximport功能。
2.  攻击者构造一个包含恶意路径的ZIP压缩包。该ZIP包中的文件路径包含路径遍历字符（例如`../`），指向服务器文件系统中的目标位置。
3.  攻击者通过mboximport接口上传该ZIP压缩包。
4.  Zimbra服务器解压该ZIP压缩包，由于没有充分验证文件路径，导致恶意文件被写入到指定的位置。
5. 攻击者可以通过上传webshell等文件, 获取服务器的控制权限.

**投毒风险分析：**

虽然POC代码本身功能是实现漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **利用脚本的隐蔽修改：** 攻击者可能在原始利用脚本中添加额外的恶意代码，例如反向shell、数据收集等。用户下载并执行被篡改的脚本后，可能会受到进一步的攻击。
2.  **ZIP文件内容替换：** 攻击者可能会替换POC中使用的ZIP文件，使其包含更具破坏性的恶意代码或文件。
3.  **对cmd.jsp的修改:** 攻击者可能会修改`cmd.jsp`里的内容,植入恶意代码.

基于以上分析，我将投毒风险评定为10%。 虽然poc验证本身是按照漏洞描述进行的, 没有发现明确的后门, 但是用户在使用POC时，仍应保持警惕，验证代码的完整性和安全性。特别注意检查ZIP文件的内容以及利用脚本的来源。

**项目地址:** [miko550/CVE-2022-27925](https://github.com/miko550/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #7

**来源**: [CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md](../2022/CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md)

# CVE-2022-27925

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-路径遍历/任意文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限（根据搜索结果1，6，8表明可以绕过认证，实现未经身份验证的RCE），目标系统存在漏洞，可以访问Zimbra服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Zimbra Collaboration Suite (ZCS) 的mboximport功能中。拥有管理员权限的认证用户（或未经认证的用户，如果存在其他漏洞如CVE-2022-37042）可以上传包含恶意路径的ZIP文件，导致目录遍历，最终写入任意文件。POC通过上传包含JSP Webshell的ZIP文件到服务器，然后通过访问该Webshell执行任意命令。根据Volexity的博客，存在身份验证绕过。

**有效性：** 提供的POC代码似乎有效，因为它利用了 zip 文件解压时的路径遍历漏洞来上传 webshell，并且代码中包含了验证 webshell 是否成功上传并执行命令的逻辑。

**投毒风险：** POC代码本身主要是利用漏洞，没有明显的恶意投毒代码。代码首先构造一个ZIP文件，包含一个JSP webshell，然后通过POST请求上传该ZIP文件。之后，尝试访问上传的webshell并执行命令。投毒风险较低，主要风险在于利用成功后，上传的webshell本身就是后门。代码中的随机webshell文件名和反向shell功能可以被用于恶意目的，但这些都属于漏洞利用的范畴，而非代码投毒。

**利用方式：**

1.  **认证/未认证（取决于是否存在身份认证绕过漏洞）：** 根据漏洞描述，最初需要管理员权限。但根据搜索引擎结果 (例如Volexity博客) ，存在可以绕过身份验证的利用方法，可直接实现未授权RCE。 
2.  **构造恶意ZIP文件：**  创建一个包含恶意JSP文件的ZIP文件。恶意JSP文件包含 webshell 代码，允许远程执行命令。文件名使用路径遍历payload，例如 `../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/shell.jsp`。
3.  **上传ZIP文件：**  使用mboximport功能上传构造的ZIP文件。POC代码中使用了两个不同的URL，都指向mboximport功能，以增加漏洞利用的成功率。
4.  **访问Webshell：**  上传成功后，通过构造的URL访问上传的JSP webshell，从而执行任意命令。
5.  **反向Shell：**  POC代码还包含创建反向shell的功能，允许攻击者获得对受感染服务器的shell访问权限。


**项目地址:** [Chocapikk/CVE-2022-27925-Revshell](https://github.com/Chocapikk/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #2

**来源**: [CVE-2022-27925-Inplex-sys_CVE-2022-27925.md](../2022/CVE-2022-27925-Inplex-sys_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件写入和远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925 漏洞存在于 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 的 mboximport 功能中。该功能允许经过身份验证并具有管理员权限的用户上传 ZIP 压缩包，并从中提取文件。由于未对压缩包中的文件名进行充分的路径验证，攻击者可以构造包含恶意路径的压缩包，从而将任意文件写入服务器的任意位置。根据搜索结果，该漏洞已被大规模利用，甚至存在绕过身份验证的利用方式（虽然漏洞描述本身需要管理员权限）。漏洞利用代码中仅包含Apache License 2.0许可协议，没有发现潜在的投毒代码。

**利用方式：**

1.  攻击者需要拥有 Zimbra ZCS 的管理员账户权限（原始漏洞描述）。但根据搜索结果，存在身份验证绕过方法，攻击者可能无需管理员权限即可利用。
2.  攻击者创建一个恶意的 ZIP 压缩包，该压缩包中的文件名包含路径遍历字符串 (例如 `../../../path/to/target/file`)。
3.  攻击者使用 mboximport 功能上传该 ZIP 压缩包。
4.  Zimbra ZCS 解压该压缩包，并将文件写入攻击者指定的任意位置。

通过写入恶意文件（例如 webshell）到 Web 服务器的可访问目录，攻击者可以实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-27925](https://github.com/Inplex-sys/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #3

**来源**: [CVE-2022-27925-Josexv1_CVE-2022-27925.md](../2022/CVE-2022-27925-Josexv1_CVE-2022-27925.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 任意文件上传导致目录遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Zimbra Collaboration Suite Network Edition 9.0.0 Patch 23 (及更早版本); Zimbra Collaboration Suite Network Edition 8.8.15 Patch 30 (及更早版本)

**利用条件:** 需要目标存在漏洞版本的Zimbra Collaboration Suite，且攻击者可以通过网络访问目标服务器的7071端口(默认管理员端口)。某些情况下需要绕过身份验证 (CVE-2022-37042)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中，该功能接收ZIP压缩包并从中提取文件。由于存在路径遍历漏洞，攻击者可以通过构造恶意的ZIP压缩包，将任意文件上传到服务器的任意目录。根据搜索引擎结果，早期需要管理员权限，但后续发现存在身份验证绕过漏洞（CVE-2022-37042），允许未经身份验证的攻击者利用该漏洞。提供的POC代码利用了这一漏洞，通过上传JSP webshell来实现远程代码执行。由于POC代码只包含漏洞利用逻辑，不包含任何与漏洞利用无关的恶意代码，因此投毒风险较低。该POC的有效性较高，但需要注意的是，如果目标服务器已经修复了漏洞，则利用会失败。利用方式是，首先判断目标是否为漏洞版本，然后构造包含恶意路径的ZIP文件，上传到服务器指定目录，然后访问上传的JSP webshell，执行任意命令。

POC代码分析：

*   代码通过 `-t` 参数指定目标URL，通过 `-l` 参数指定目标列表。
*   代码首先测试目标URL是否可访问。
*   然后，代码构造恶意的ZIP文件，该ZIP文件包含一个JSP webshell，并将其放置在目标服务器的 `mailboxd/webapps/zimbraAdmin/` 或者 `jetty_base/webapps/zimbraAdmin/` 目录下。
*   代码利用Zimbra的mboximport功能上传ZIP文件，触发路径遍历漏洞。
*   最后，代码尝试访问上传的JSP webshell，如果访问成功，则表示漏洞利用成功，并显示webshell的URL地址，以及执行 `uname -a` 命令的结果。

综上，该漏洞利用有效性较高，但取决于目标是否已修复。POC代码不包含明显投毒代码，因此投毒风险为0%。漏洞利用方式清晰，攻击者可以通过构造恶意的ZIP文件，上传webshell，实现远程代码执行。

**项目地址:** [Josexv1/CVE-2022-27925](https://github.com/Josexv1/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #4

**来源**: [CVE-2022-27925-akincibor_CVE-2022-27925.md](../2022/CVE-2022-27925-akincibor_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历/远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限或借助其他漏洞绕过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite（ZCS）中的目录遍历漏洞。攻击者通过利用mboximport功能，上传包含恶意构造的ZIP压缩包，ZIP压缩包中包含带有目录遍历的jsp文件，上传文件最终解压写入到服务器任意目录。漏洞需要管理员权限，但是存在认证绕过，所以可以未经授权直接访问。

**有效性：**

提供的POC代码是一个nuclei模板，通过发送精心构造的POST请求到`/service/extension/backup/mboximport`端点，上传包含恶意JSP文件的ZIP压缩包。ZIP包里的目录结构为`../../../../mailboxd/webapps/zimbraAdmin/cmd.jsp`，利用目录遍历将JSP文件写入到目标目录。该JSP文件`cmd.jsp`是一个简单的命令执行webshell，允许攻击者通过GET请求的`cmd`参数执行任意系统命令。搜索引擎结果表明该漏洞在野外已被积极利用，该POC利用方式是有效的。

**投毒风险：**

该POC代码本身就是一个漏洞利用程序，目的是在目标服务器上部署webshell。从代码本身来看，不存在额外的、作者隐藏的恶意代码或后门。ZIP压缩包中包含的是一个标准的命令执行JSP webshell，其行为是可预测和可理解的。可以判定此仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  攻击者首先需要访问Zimbra服务器的`/service/extension/backup/mboximport`端点。这个端点通常需要管理员权限，但是可能存在身份验证绕过漏洞（例如CVE-2022-37042），允许未经授权的访问。
2.  攻击者构造一个包含恶意JSP文件的ZIP压缩包，其中JSP文件的路径包含目录遍历序列（`../`），将文件写入到`/mailboxd/webapps/zimbraAdmin/`目录下，命名为`cmd.jsp`。
3.  攻击者将构造好的ZIP文件作为POST请求的内容上传到`/service/extension/backup/mboximport`端点。
4.  Zimbra服务器解压上传的ZIP文件，由于目录遍历漏洞，恶意JSP文件被写入到`/mailboxd/webapps/zimbraAdmin/cmd.jsp`。
5.  攻击者通过访问`/zimbraAdmin/cmd.jsp?cmd=<command>`来执行任意系统命令，从而控制服务器。


**项目地址:** [akincibor/CVE-2022-27925](https://github.com/akincibor/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #5

**来源**: [CVE-2022-27925-jam620_Zimbra.md](../2022/CVE-2022-27925-jam620_Zimbra.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 目录遍历和远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限（初始评估），但后续研究发现存在认证绕过，降低了利用门槛。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925 存在于 Zimbra Collaboration Suite (ZCS) 的 mboximport 功能中，允许经过身份验证的管理员用户通过上传包含恶意路径的 ZIP 归档文件，实现目录遍历，最终上传任意文件到系统。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果（特别是Volexity的博客），此漏洞已被大规模利用。提供的漏洞利用代码（来自 GitHub 仓库 Josexv1/CVE-2022-27925 和 vnhacker1337/CVE-2022-27925-PoC）提供了利用此漏洞的 POC，并且成功实现了远程代码执行。因此，可以判断此POC代码有效。

**投毒风险分析：**
代码仓库`vnhacker1337/CVE-2022-27925-PoC`提供的利用链比较完整，包含目标枚举，漏洞利用，后渗透利用。从给出的信息看，作者进行了后渗透利用，但这些操作不属于投毒行为。代码中直接包含恶意行为的部分可能性较低，所以投毒风险评估为10%。

**利用方式：**
1.  **认证绕过 (CVE-2022-37042):** 最初需要管理员权限，但后续研究揭示存在认证绕过漏洞（CVE-2022-37042），使得未认证的攻击者也能利用该漏洞，降低了利用门槛。
2.  **上传恶意 ZIP 文件：** 利用 mboximport 功能，上传包含恶意构造路径的 ZIP 归档文件。这些路径指向目标文件系统中的特定位置，以便写入或覆盖文件。
3.  **目录遍历：** ZIP 文件中的恶意路径使得解压过程突破目录限制，导致任意文件写入。
4.  **远程代码执行：** 通过写入 Webshell 或其他可执行文件，最终实现远程代码执行。
5.  **后渗透攻击：** 攻击者可以安装后门、窃取数据，甚至部署勒索软件。

**总结：** 该漏洞利用需要上传特定的ZIP文件，利用Zimbra自身的功能进行目录穿越，最终实现代码执行。从搜索结果来看，该漏洞已被广泛利用。

**项目地址:** [jam620/Zimbra](https://github.com/jam620/Zimbra)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #6

**来源**: [CVE-2022-27925-miko550_CVE-2022-27925.md](../2022/CVE-2022-27925-miko550_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限，但可能存在未授权访问利用链（CVE-2022-37042）。 需要能够上传 ZIP 压缩包到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中。一个具有管理员权限的认证用户可以通过上传恶意的ZIP压缩包，利用路径遍历漏洞将任意文件写入系统，最终可能导致远程代码执行。POC代码通过构造包含恶意路径的ZIP文件，并利用mboximport接口上传到服务器。搜索引擎结果显示，此漏洞被大规模利用，并且存在未经身份验证的利用方式（CVE-2022-37042）。

**漏洞利用方式：**

1.  攻击者需要访问Zimbra服务器的mboximport功能。
2.  攻击者构造一个包含恶意路径的ZIP压缩包。该ZIP包中的文件路径包含路径遍历字符（例如`../`），指向服务器文件系统中的目标位置。
3.  攻击者通过mboximport接口上传该ZIP压缩包。
4.  Zimbra服务器解压该ZIP压缩包，由于没有充分验证文件路径，导致恶意文件被写入到指定的位置。
5. 攻击者可以通过上传webshell等文件, 获取服务器的控制权限.

**投毒风险分析：**

虽然POC代码本身功能是实现漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **利用脚本的隐蔽修改：** 攻击者可能在原始利用脚本中添加额外的恶意代码，例如反向shell、数据收集等。用户下载并执行被篡改的脚本后，可能会受到进一步的攻击。
2.  **ZIP文件内容替换：** 攻击者可能会替换POC中使用的ZIP文件，使其包含更具破坏性的恶意代码或文件。
3.  **对cmd.jsp的修改:** 攻击者可能会修改`cmd.jsp`里的内容,植入恶意代码.

基于以上分析，我将投毒风险评定为10%。 虽然poc验证本身是按照漏洞描述进行的, 没有发现明确的后门, 但是用户在使用POC时，仍应保持警惕，验证代码的完整性和安全性。特别注意检查ZIP文件的内容以及利用脚本的来源。

**项目地址:** [miko550/CVE-2022-27925](https://github.com/miko550/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #7

**来源**: [CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md](../2022/CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md)

# CVE-2022-27925

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-路径遍历/任意文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限（根据搜索结果1，6，8表明可以绕过认证，实现未经身份验证的RCE），目标系统存在漏洞，可以访问Zimbra服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Zimbra Collaboration Suite (ZCS) 的mboximport功能中。拥有管理员权限的认证用户（或未经认证的用户，如果存在其他漏洞如CVE-2022-37042）可以上传包含恶意路径的ZIP文件，导致目录遍历，最终写入任意文件。POC通过上传包含JSP Webshell的ZIP文件到服务器，然后通过访问该Webshell执行任意命令。根据Volexity的博客，存在身份验证绕过。

**有效性：** 提供的POC代码似乎有效，因为它利用了 zip 文件解压时的路径遍历漏洞来上传 webshell，并且代码中包含了验证 webshell 是否成功上传并执行命令的逻辑。

**投毒风险：** POC代码本身主要是利用漏洞，没有明显的恶意投毒代码。代码首先构造一个ZIP文件，包含一个JSP webshell，然后通过POST请求上传该ZIP文件。之后，尝试访问上传的webshell并执行命令。投毒风险较低，主要风险在于利用成功后，上传的webshell本身就是后门。代码中的随机webshell文件名和反向shell功能可以被用于恶意目的，但这些都属于漏洞利用的范畴，而非代码投毒。

**利用方式：**

1.  **认证/未认证（取决于是否存在身份认证绕过漏洞）：** 根据漏洞描述，最初需要管理员权限。但根据搜索引擎结果 (例如Volexity博客) ，存在可以绕过身份验证的利用方法，可直接实现未授权RCE。 
2.  **构造恶意ZIP文件：**  创建一个包含恶意JSP文件的ZIP文件。恶意JSP文件包含 webshell 代码，允许远程执行命令。文件名使用路径遍历payload，例如 `../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/shell.jsp`。
3.  **上传ZIP文件：**  使用mboximport功能上传构造的ZIP文件。POC代码中使用了两个不同的URL，都指向mboximport功能，以增加漏洞利用的成功率。
4.  **访问Webshell：**  上传成功后，通过构造的URL访问上传的JSP webshell，从而执行任意命令。
5.  **反向Shell：**  POC代码还包含创建反向shell的功能，允许攻击者获得对受感染服务器的shell访问权限。


**项目地址:** [Chocapikk/CVE-2022-27925-Revshell](https://github.com/Chocapikk/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #2

**来源**: [CVE-2022-27925-Inplex-sys_CVE-2022-27925.md](../2022/CVE-2022-27925-Inplex-sys_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件写入和远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925 漏洞存在于 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 的 mboximport 功能中。该功能允许经过身份验证并具有管理员权限的用户上传 ZIP 压缩包，并从中提取文件。由于未对压缩包中的文件名进行充分的路径验证，攻击者可以构造包含恶意路径的压缩包，从而将任意文件写入服务器的任意位置。根据搜索结果，该漏洞已被大规模利用，甚至存在绕过身份验证的利用方式（虽然漏洞描述本身需要管理员权限）。漏洞利用代码中仅包含Apache License 2.0许可协议，没有发现潜在的投毒代码。

**利用方式：**

1.  攻击者需要拥有 Zimbra ZCS 的管理员账户权限（原始漏洞描述）。但根据搜索结果，存在身份验证绕过方法，攻击者可能无需管理员权限即可利用。
2.  攻击者创建一个恶意的 ZIP 压缩包，该压缩包中的文件名包含路径遍历字符串 (例如 `../../../path/to/target/file`)。
3.  攻击者使用 mboximport 功能上传该 ZIP 压缩包。
4.  Zimbra ZCS 解压该压缩包，并将文件写入攻击者指定的任意位置。

通过写入恶意文件（例如 webshell）到 Web 服务器的可访问目录，攻击者可以实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-27925](https://github.com/Inplex-sys/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #3

**来源**: [CVE-2022-27925-Josexv1_CVE-2022-27925.md](../2022/CVE-2022-27925-Josexv1_CVE-2022-27925.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 任意文件上传导致目录遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Zimbra Collaboration Suite Network Edition 9.0.0 Patch 23 (及更早版本); Zimbra Collaboration Suite Network Edition 8.8.15 Patch 30 (及更早版本)

**利用条件:** 需要目标存在漏洞版本的Zimbra Collaboration Suite，且攻击者可以通过网络访问目标服务器的7071端口(默认管理员端口)。某些情况下需要绕过身份验证 (CVE-2022-37042)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中，该功能接收ZIP压缩包并从中提取文件。由于存在路径遍历漏洞，攻击者可以通过构造恶意的ZIP压缩包，将任意文件上传到服务器的任意目录。根据搜索引擎结果，早期需要管理员权限，但后续发现存在身份验证绕过漏洞（CVE-2022-37042），允许未经身份验证的攻击者利用该漏洞。提供的POC代码利用了这一漏洞，通过上传JSP webshell来实现远程代码执行。由于POC代码只包含漏洞利用逻辑，不包含任何与漏洞利用无关的恶意代码，因此投毒风险较低。该POC的有效性较高，但需要注意的是，如果目标服务器已经修复了漏洞，则利用会失败。利用方式是，首先判断目标是否为漏洞版本，然后构造包含恶意路径的ZIP文件，上传到服务器指定目录，然后访问上传的JSP webshell，执行任意命令。

POC代码分析：

*   代码通过 `-t` 参数指定目标URL，通过 `-l` 参数指定目标列表。
*   代码首先测试目标URL是否可访问。
*   然后，代码构造恶意的ZIP文件，该ZIP文件包含一个JSP webshell，并将其放置在目标服务器的 `mailboxd/webapps/zimbraAdmin/` 或者 `jetty_base/webapps/zimbraAdmin/` 目录下。
*   代码利用Zimbra的mboximport功能上传ZIP文件，触发路径遍历漏洞。
*   最后，代码尝试访问上传的JSP webshell，如果访问成功，则表示漏洞利用成功，并显示webshell的URL地址，以及执行 `uname -a` 命令的结果。

综上，该漏洞利用有效性较高，但取决于目标是否已修复。POC代码不包含明显投毒代码，因此投毒风险为0%。漏洞利用方式清晰，攻击者可以通过构造恶意的ZIP文件，上传webshell，实现远程代码执行。

**项目地址:** [Josexv1/CVE-2022-27925](https://github.com/Josexv1/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #4

**来源**: [CVE-2022-27925-akincibor_CVE-2022-27925.md](../2022/CVE-2022-27925-akincibor_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历/远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限或借助其他漏洞绕过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite（ZCS）中的目录遍历漏洞。攻击者通过利用mboximport功能，上传包含恶意构造的ZIP压缩包，ZIP压缩包中包含带有目录遍历的jsp文件，上传文件最终解压写入到服务器任意目录。漏洞需要管理员权限，但是存在认证绕过，所以可以未经授权直接访问。

**有效性：**

提供的POC代码是一个nuclei模板，通过发送精心构造的POST请求到`/service/extension/backup/mboximport`端点，上传包含恶意JSP文件的ZIP压缩包。ZIP包里的目录结构为`../../../../mailboxd/webapps/zimbraAdmin/cmd.jsp`，利用目录遍历将JSP文件写入到目标目录。该JSP文件`cmd.jsp`是一个简单的命令执行webshell，允许攻击者通过GET请求的`cmd`参数执行任意系统命令。搜索引擎结果表明该漏洞在野外已被积极利用，该POC利用方式是有效的。

**投毒风险：**

该POC代码本身就是一个漏洞利用程序，目的是在目标服务器上部署webshell。从代码本身来看，不存在额外的、作者隐藏的恶意代码或后门。ZIP压缩包中包含的是一个标准的命令执行JSP webshell，其行为是可预测和可理解的。可以判定此仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  攻击者首先需要访问Zimbra服务器的`/service/extension/backup/mboximport`端点。这个端点通常需要管理员权限，但是可能存在身份验证绕过漏洞（例如CVE-2022-37042），允许未经授权的访问。
2.  攻击者构造一个包含恶意JSP文件的ZIP压缩包，其中JSP文件的路径包含目录遍历序列（`../`），将文件写入到`/mailboxd/webapps/zimbraAdmin/`目录下，命名为`cmd.jsp`。
3.  攻击者将构造好的ZIP文件作为POST请求的内容上传到`/service/extension/backup/mboximport`端点。
4.  Zimbra服务器解压上传的ZIP文件，由于目录遍历漏洞，恶意JSP文件被写入到`/mailboxd/webapps/zimbraAdmin/cmd.jsp`。
5.  攻击者通过访问`/zimbraAdmin/cmd.jsp?cmd=<command>`来执行任意系统命令，从而控制服务器。


**项目地址:** [akincibor/CVE-2022-27925](https://github.com/akincibor/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #5

**来源**: [CVE-2022-27925-jam620_Zimbra.md](../2022/CVE-2022-27925-jam620_Zimbra.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 目录遍历和远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限（初始评估），但后续研究发现存在认证绕过，降低了利用门槛。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925 存在于 Zimbra Collaboration Suite (ZCS) 的 mboximport 功能中，允许经过身份验证的管理员用户通过上传包含恶意路径的 ZIP 归档文件，实现目录遍历，最终上传任意文件到系统。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果（特别是Volexity的博客），此漏洞已被大规模利用。提供的漏洞利用代码（来自 GitHub 仓库 Josexv1/CVE-2022-27925 和 vnhacker1337/CVE-2022-27925-PoC）提供了利用此漏洞的 POC，并且成功实现了远程代码执行。因此，可以判断此POC代码有效。

**投毒风险分析：**
代码仓库`vnhacker1337/CVE-2022-27925-PoC`提供的利用链比较完整，包含目标枚举，漏洞利用，后渗透利用。从给出的信息看，作者进行了后渗透利用，但这些操作不属于投毒行为。代码中直接包含恶意行为的部分可能性较低，所以投毒风险评估为10%。

**利用方式：**
1.  **认证绕过 (CVE-2022-37042):** 最初需要管理员权限，但后续研究揭示存在认证绕过漏洞（CVE-2022-37042），使得未认证的攻击者也能利用该漏洞，降低了利用门槛。
2.  **上传恶意 ZIP 文件：** 利用 mboximport 功能，上传包含恶意构造路径的 ZIP 归档文件。这些路径指向目标文件系统中的特定位置，以便写入或覆盖文件。
3.  **目录遍历：** ZIP 文件中的恶意路径使得解压过程突破目录限制，导致任意文件写入。
4.  **远程代码执行：** 通过写入 Webshell 或其他可执行文件，最终实现远程代码执行。
5.  **后渗透攻击：** 攻击者可以安装后门、窃取数据，甚至部署勒索软件。

**总结：** 该漏洞利用需要上传特定的ZIP文件，利用Zimbra自身的功能进行目录穿越，最终实现代码执行。从搜索结果来看，该漏洞已被广泛利用。

**项目地址:** [jam620/Zimbra](https://github.com/jam620/Zimbra)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #6

**来源**: [CVE-2022-27925-miko550_CVE-2022-27925.md](../2022/CVE-2022-27925-miko550_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限，但可能存在未授权访问利用链（CVE-2022-37042）。 需要能够上传 ZIP 压缩包到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中。一个具有管理员权限的认证用户可以通过上传恶意的ZIP压缩包，利用路径遍历漏洞将任意文件写入系统，最终可能导致远程代码执行。POC代码通过构造包含恶意路径的ZIP文件，并利用mboximport接口上传到服务器。搜索引擎结果显示，此漏洞被大规模利用，并且存在未经身份验证的利用方式（CVE-2022-37042）。

**漏洞利用方式：**

1.  攻击者需要访问Zimbra服务器的mboximport功能。
2.  攻击者构造一个包含恶意路径的ZIP压缩包。该ZIP包中的文件路径包含路径遍历字符（例如`../`），指向服务器文件系统中的目标位置。
3.  攻击者通过mboximport接口上传该ZIP压缩包。
4.  Zimbra服务器解压该ZIP压缩包，由于没有充分验证文件路径，导致恶意文件被写入到指定的位置。
5. 攻击者可以通过上传webshell等文件, 获取服务器的控制权限.

**投毒风险分析：**

虽然POC代码本身功能是实现漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **利用脚本的隐蔽修改：** 攻击者可能在原始利用脚本中添加额外的恶意代码，例如反向shell、数据收集等。用户下载并执行被篡改的脚本后，可能会受到进一步的攻击。
2.  **ZIP文件内容替换：** 攻击者可能会替换POC中使用的ZIP文件，使其包含更具破坏性的恶意代码或文件。
3.  **对cmd.jsp的修改:** 攻击者可能会修改`cmd.jsp`里的内容,植入恶意代码.

基于以上分析，我将投毒风险评定为10%。 虽然poc验证本身是按照漏洞描述进行的, 没有发现明确的后门, 但是用户在使用POC时，仍应保持警惕，验证代码的完整性和安全性。特别注意检查ZIP文件的内容以及利用脚本的来源。

**项目地址:** [miko550/CVE-2022-27925](https://github.com/miko550/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #7

**来源**: [CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md](../2022/CVE-2022-27925-mohamedbenchikh_CVE-2022-27925.md)

# CVE-2022-27925

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-Chocapikk_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-路径遍历/任意文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限（根据搜索结果1，6，8表明可以绕过认证，实现未经身份验证的RCE），目标系统存在漏洞，可以访问Zimbra服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Zimbra Collaboration Suite (ZCS) 的mboximport功能中。拥有管理员权限的认证用户（或未经认证的用户，如果存在其他漏洞如CVE-2022-37042）可以上传包含恶意路径的ZIP文件，导致目录遍历，最终写入任意文件。POC通过上传包含JSP Webshell的ZIP文件到服务器，然后通过访问该Webshell执行任意命令。根据Volexity的博客，存在身份验证绕过。

**有效性：** 提供的POC代码似乎有效，因为它利用了 zip 文件解压时的路径遍历漏洞来上传 webshell，并且代码中包含了验证 webshell 是否成功上传并执行命令的逻辑。

**投毒风险：** POC代码本身主要是利用漏洞，没有明显的恶意投毒代码。代码首先构造一个ZIP文件，包含一个JSP webshell，然后通过POST请求上传该ZIP文件。之后，尝试访问上传的webshell并执行命令。投毒风险较低，主要风险在于利用成功后，上传的webshell本身就是后门。代码中的随机webshell文件名和反向shell功能可以被用于恶意目的，但这些都属于漏洞利用的范畴，而非代码投毒。

**利用方式：**

1.  **认证/未认证（取决于是否存在身份认证绕过漏洞）：** 根据漏洞描述，最初需要管理员权限。但根据搜索引擎结果 (例如Volexity博客) ，存在可以绕过身份验证的利用方法，可直接实现未授权RCE。 
2.  **构造恶意ZIP文件：**  创建一个包含恶意JSP文件的ZIP文件。恶意JSP文件包含 webshell 代码，允许远程执行命令。文件名使用路径遍历payload，例如 `../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/shell.jsp`。
3.  **上传ZIP文件：**  使用mboximport功能上传构造的ZIP文件。POC代码中使用了两个不同的URL，都指向mboximport功能，以增加漏洞利用的成功率。
4.  **访问Webshell：**  上传成功后，通过构造的URL访问上传的JSP webshell，从而执行任意命令。
5.  **反向Shell：**  POC代码还包含创建反向shell的功能，允许攻击者获得对受感染服务器的shell访问权限。


**项目地址:** [Chocapikk/CVE-2022-27925-Revshell](https://github.com/Chocapikk/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #2

**来源**: [CVE-2022-27925-Inplex-sys_CVE-2022-27925.md](../2022/CVE-2022-27925-Inplex-sys_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件写入和远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925 漏洞存在于 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 的 mboximport 功能中。该功能允许经过身份验证并具有管理员权限的用户上传 ZIP 压缩包，并从中提取文件。由于未对压缩包中的文件名进行充分的路径验证，攻击者可以构造包含恶意路径的压缩包，从而将任意文件写入服务器的任意位置。根据搜索结果，该漏洞已被大规模利用，甚至存在绕过身份验证的利用方式（虽然漏洞描述本身需要管理员权限）。漏洞利用代码中仅包含Apache License 2.0许可协议，没有发现潜在的投毒代码。

**利用方式：**

1.  攻击者需要拥有 Zimbra ZCS 的管理员账户权限（原始漏洞描述）。但根据搜索结果，存在身份验证绕过方法，攻击者可能无需管理员权限即可利用。
2.  攻击者创建一个恶意的 ZIP 压缩包，该压缩包中的文件名包含路径遍历字符串 (例如 `../../../path/to/target/file`)。
3.  攻击者使用 mboximport 功能上传该 ZIP 压缩包。
4.  Zimbra ZCS 解压该压缩包，并将文件写入攻击者指定的任意位置。

通过写入恶意文件（例如 webshell）到 Web 服务器的可访问目录，攻击者可以实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-27925](https://github.com/Inplex-sys/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #3

**来源**: [CVE-2022-27925-Josexv1_CVE-2022-27925.md](../2022/CVE-2022-27925-Josexv1_CVE-2022-27925.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 任意文件上传导致目录遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Zimbra Collaboration Suite Network Edition 9.0.0 Patch 23 (及更早版本); Zimbra Collaboration Suite Network Edition 8.8.15 Patch 30 (及更早版本)

**利用条件:** 需要目标存在漏洞版本的Zimbra Collaboration Suite，且攻击者可以通过网络访问目标服务器的7071端口(默认管理员端口)。某些情况下需要绕过身份验证 (CVE-2022-37042)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中，该功能接收ZIP压缩包并从中提取文件。由于存在路径遍历漏洞，攻击者可以通过构造恶意的ZIP压缩包，将任意文件上传到服务器的任意目录。根据搜索引擎结果，早期需要管理员权限，但后续发现存在身份验证绕过漏洞（CVE-2022-37042），允许未经身份验证的攻击者利用该漏洞。提供的POC代码利用了这一漏洞，通过上传JSP webshell来实现远程代码执行。由于POC代码只包含漏洞利用逻辑，不包含任何与漏洞利用无关的恶意代码，因此投毒风险较低。该POC的有效性较高，但需要注意的是，如果目标服务器已经修复了漏洞，则利用会失败。利用方式是，首先判断目标是否为漏洞版本，然后构造包含恶意路径的ZIP文件，上传到服务器指定目录，然后访问上传的JSP webshell，执行任意命令。

POC代码分析：

*   代码通过 `-t` 参数指定目标URL，通过 `-l` 参数指定目标列表。
*   代码首先测试目标URL是否可访问。
*   然后，代码构造恶意的ZIP文件，该ZIP文件包含一个JSP webshell，并将其放置在目标服务器的 `mailboxd/webapps/zimbraAdmin/` 或者 `jetty_base/webapps/zimbraAdmin/` 目录下。
*   代码利用Zimbra的mboximport功能上传ZIP文件，触发路径遍历漏洞。
*   最后，代码尝试访问上传的JSP webshell，如果访问成功，则表示漏洞利用成功，并显示webshell的URL地址，以及执行 `uname -a` 命令的结果。

综上，该漏洞利用有效性较高，但取决于目标是否已修复。POC代码不包含明显投毒代码，因此投毒风险为0%。漏洞利用方式清晰，攻击者可以通过构造恶意的ZIP文件，上传webshell，实现远程代码执行。

**项目地址:** [Josexv1/CVE-2022-27925](https://github.com/Josexv1/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #4

**来源**: [CVE-2022-27925-akincibor_CVE-2022-27925.md](../2022/CVE-2022-27925-akincibor_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历/远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限或借助其他漏洞绕过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite（ZCS）中的目录遍历漏洞。攻击者通过利用mboximport功能，上传包含恶意构造的ZIP压缩包，ZIP压缩包中包含带有目录遍历的jsp文件，上传文件最终解压写入到服务器任意目录。漏洞需要管理员权限，但是存在认证绕过，所以可以未经授权直接访问。

**有效性：**

提供的POC代码是一个nuclei模板，通过发送精心构造的POST请求到`/service/extension/backup/mboximport`端点，上传包含恶意JSP文件的ZIP压缩包。ZIP包里的目录结构为`../../../../mailboxd/webapps/zimbraAdmin/cmd.jsp`，利用目录遍历将JSP文件写入到目标目录。该JSP文件`cmd.jsp`是一个简单的命令执行webshell，允许攻击者通过GET请求的`cmd`参数执行任意系统命令。搜索引擎结果表明该漏洞在野外已被积极利用，该POC利用方式是有效的。

**投毒风险：**

该POC代码本身就是一个漏洞利用程序，目的是在目标服务器上部署webshell。从代码本身来看，不存在额外的、作者隐藏的恶意代码或后门。ZIP压缩包中包含的是一个标准的命令执行JSP webshell，其行为是可预测和可理解的。可以判定此仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  攻击者首先需要访问Zimbra服务器的`/service/extension/backup/mboximport`端点。这个端点通常需要管理员权限，但是可能存在身份验证绕过漏洞（例如CVE-2022-37042），允许未经授权的访问。
2.  攻击者构造一个包含恶意JSP文件的ZIP压缩包，其中JSP文件的路径包含目录遍历序列（`../`），将文件写入到`/mailboxd/webapps/zimbraAdmin/`目录下，命名为`cmd.jsp`。
3.  攻击者将构造好的ZIP文件作为POST请求的内容上传到`/service/extension/backup/mboximport`端点。
4.  Zimbra服务器解压上传的ZIP文件，由于目录遍历漏洞，恶意JSP文件被写入到`/mailboxd/webapps/zimbraAdmin/cmd.jsp`。
5.  攻击者通过访问`/zimbraAdmin/cmd.jsp?cmd=<command>`来执行任意系统命令，从而控制服务器。


**项目地址:** [akincibor/CVE-2022-27925](https://github.com/akincibor/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #5

**来源**: [CVE-2022-27925-jam620_Zimbra.md](../2022/CVE-2022-27925-jam620_Zimbra.md)

## CVE-2022-27925 - Zimbra Collaboration Suite 目录遍历和远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限（初始评估），但后续研究发现存在认证绕过，降低了利用门槛。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925 存在于 Zimbra Collaboration Suite (ZCS) 的 mboximport 功能中，允许经过身份验证的管理员用户通过上传包含恶意路径的 ZIP 归档文件，实现目录遍历，最终上传任意文件到系统。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果（特别是Volexity的博客），此漏洞已被大规模利用。提供的漏洞利用代码（来自 GitHub 仓库 Josexv1/CVE-2022-27925 和 vnhacker1337/CVE-2022-27925-PoC）提供了利用此漏洞的 POC，并且成功实现了远程代码执行。因此，可以判断此POC代码有效。

**投毒风险分析：**
代码仓库`vnhacker1337/CVE-2022-27925-PoC`提供的利用链比较完整，包含目标枚举，漏洞利用，后渗透利用。从给出的信息看，作者进行了后渗透利用，但这些操作不属于投毒行为。代码中直接包含恶意行为的部分可能性较低，所以投毒风险评估为10%。

**利用方式：**
1.  **认证绕过 (CVE-2022-37042):** 最初需要管理员权限，但后续研究揭示存在认证绕过漏洞（CVE-2022-37042），使得未认证的攻击者也能利用该漏洞，降低了利用门槛。
2.  **上传恶意 ZIP 文件：** 利用 mboximport 功能，上传包含恶意构造路径的 ZIP 归档文件。这些路径指向目标文件系统中的特定位置，以便写入或覆盖文件。
3.  **目录遍历：** ZIP 文件中的恶意路径使得解压过程突破目录限制，导致任意文件写入。
4.  **远程代码执行：** 通过写入 Webshell 或其他可执行文件，最终实现远程代码执行。
5.  **后渗透攻击：** 攻击者可以安装后门、窃取数据，甚至部署勒索软件。

**总结：** 该漏洞利用需要上传特定的ZIP文件，利用Zimbra自身的功能进行目录穿越，最终实现代码执行。从搜索结果来看，该漏洞已被广泛利用。

**项目地址:** [jam620/Zimbra](https://github.com/jam620/Zimbra)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #6

**来源**: [CVE-2022-27925-miko550_CVE-2022-27925.md](../2022/CVE-2022-27925-miko550_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限，但可能存在未授权访问利用链（CVE-2022-37042）。 需要能够上传 ZIP 压缩包到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中。一个具有管理员权限的认证用户可以通过上传恶意的ZIP压缩包，利用路径遍历漏洞将任意文件写入系统，最终可能导致远程代码执行。POC代码通过构造包含恶意路径的ZIP文件，并利用mboximport接口上传到服务器。搜索引擎结果显示，此漏洞被大规模利用，并且存在未经身份验证的利用方式（CVE-2022-37042）。

**漏洞利用方式：**

1.  攻击者需要访问Zimbra服务器的mboximport功能。
2.  攻击者构造一个包含恶意路径的ZIP压缩包。该ZIP包中的文件路径包含路径遍历字符（例如`../`），指向服务器文件系统中的目标位置。
3.  攻击者通过mboximport接口上传该ZIP压缩包。
4.  Zimbra服务器解压该ZIP压缩包，由于没有充分验证文件路径，导致恶意文件被写入到指定的位置。
5. 攻击者可以通过上传webshell等文件, 获取服务器的控制权限.

**投毒风险分析：**

虽然POC代码本身功能是实现漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **利用脚本的隐蔽修改：** 攻击者可能在原始利用脚本中添加额外的恶意代码，例如反向shell、数据收集等。用户下载并执行被篡改的脚本后，可能会受到进一步的攻击。
2.  **ZIP文件内容替换：** 攻击者可能会替换POC中使用的ZIP文件，使其包含更具破坏性的恶意代码或文件。
3.  **对cmd.jsp的修改:** 攻击者可能会修改`cmd.jsp`里的内容,植入恶意代码.

基于以上分析，我将投毒风险评定为10%。 虽然poc验证本身是按照漏洞描述进行的, 没有发现明确的后门, 但是用户在使用POC时，仍应保持警惕，验证代码的完整性和安全性。特别注意检查ZIP文件的内容以及利用脚本的来源。

**项目地址:** [miko550/CVE-2022-27925](https://github.com/miko550/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #7

**来源**: [CVE-2022-27925-navokus_CVE-2022-27925.md](../2022/CVE-2022-27925-navokus_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限的身份验证（但根据搜索结果可能存在绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite 8.8.15和9.0的mboximport功能中。具有管理员权限的已认证用户可以通过上传包含恶意路径的ZIP文件，利用目录遍历漏洞将任意文件写入系统。漏洞利用方式如下：

1.  **漏洞原理：**mboximport功能接收ZIP压缩包并解压，由于未对压缩包内的文件路径进行充分验证，攻击者可以通过构造包含特殊字符（如“../”）的路径，将文件写入任意目录。
2.  **利用步骤：**
    *   构建一个包含恶意JSP shell的ZIP文件，JSP shell的文件名和路径经过精心构造，利用目录遍历写入到Web服务器的可执行目录下。
    *   使用管理员权限登录Zimbra管理界面。
    *   通过mboximport功能上传构造好的ZIP文件。
    *   如果上传成功，JSP shell将被写入指定目录。
    *   通过访问JSP shell的URL来执行任意命令。
3.  **POC代码分析：**
    *   `run.py`脚本使用`zipfile`库创建一个包含JSP shell的ZIP文件。
    *   JSP shell的功能是接收`cmd`参数，并在服务器上执行该命令，然后将结果返回。
    *   脚本尝试将JSP shell写入三个不同的路径：`../../../../mailboxd/webapps/zimbraAdmin/admin.bk.jsp`，`../../../../jetty_base/webapps/zimbraAdmin/admin.bk.jsp`和`../../../../jetty/webapps/zimbraAdmin/admin.bk.jsp`，涵盖了不同的Zimbra部署环境。
    *   脚本使用`requests`库向`/service/extensio3/backup/mboximport`和`/service/extension/backup/mboximport`端点发送POST请求，上传ZIP文件。
    *   最后，脚本尝试通过访问JSP shell的URL（`/zimbraAdmin/admin.bk.jsp?cmd=`）来执行命令`ps aux`或`ls -la`，并打印HTTP状态码以确认漏洞是否利用成功。
4.  **有效性：**
    *   根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被积极利用。
    *   提供的POC代码看起来有效，因为它能够构造恶意ZIP文件，并尝试将其上传到目标服务器，并在成功上传后执行命令。
5.  **投毒风险：**
    *   对提供的POC代码进行了分析，没有发现任何明显的投毒代码。该脚本的主要功能是利用漏洞进行攻击，而不是在目标系统上安装后门或其他恶意软件。因此，投毒风险为0%。
6.  **其他风险:**
    *  搜索结果表明，CVE-2022-27925常与其他漏洞（例如CVE-2022-37042）组合利用，实现未经身份验证的远程代码执行。这意味着即使攻击者没有管理员权限，也可能通过其他漏洞绕过身份验证，然后利用此漏洞上传恶意文件并执行代码。

**项目地址:** [navokus/CVE-2022-27925](https://github.com/navokus/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #8

**来源**: [CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限认证（但部分情况下存在认证绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是Zimbra Collaboration Suite (ZCS) 8.8.15和9.0版本中的一个路径遍历漏洞。该漏洞存在于mboximport功能中，该功能接收ZIP存档并从中提取文件。拥有管理员权限的经过身份验证的用户能够将任意文件上传到系统，从而导致目录遍历。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用是有效的。搜索引擎结果中提到该漏洞已被大规模利用，且CISA已将其列入已知被利用漏洞目录。POC代码提供了利用此漏洞的Python脚本。

**投毒风险：**
查看提供的poc代码，未发现任何恶意投毒代码。POC代码主要功能是通过上传恶意的ZIP文件，利用路径遍历漏洞将webshell写入服务器，从而获得服务器的控制权限。代码本身较为清晰，没有隐藏的后门或恶意逻辑。

**利用方式：**
1.  **认证：** 首先，攻击者需要具有管理员权限的有效Zimbra帐户。然而，根据搜索结果，存在未经身份验证的RCE的利用方式，这意味着在某些情况下可以绕过身份验证。
2.  **构造恶意ZIP文件：**  攻击者需要构造一个包含恶意文件（例如，JSP webshell）的ZIP文件。ZIP文件中的文件名需要包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）来指定目标文件写入位置。
3.  **上传ZIP文件：**  攻击者使用mboximport功能上传构造的恶意ZIP文件。POC代码中的`zimbra-exploit.py`脚本通过向`/service/extension/backup/mboximport`端点发送POST请求来完成上传，`account-name`参数指定一个有效的邮箱地址。
4.  **执行恶意代码：**  成功上传并解压ZIP文件后，攻击者可以通过访问上传的webshell（例如，`/zimbraAdmin/cmd.jsp`）来执行任意命令。POC代码中`checkShell`函数检查webshell是否成功上传，通过发送GET请求验证。
5.  **漏洞利用代码分析：** 代码中使用了两个不同的利用路径（`exploit_path`），并尝试了多个webshell名称（`shell_list`），以提高漏洞利用的成功率。还包含一个检查webshell是否成功部署的步骤。

**总结：** 该漏洞的利用涉及构造包含路径遍历payload的恶意ZIP文件，并通过Zimbra的mboximport功能上传。攻击者利用目录遍历将webshell写入Web目录，从而实现远程代码执行。虽然初始描述要求管理员权限，但搜索结果表明存在无需认证的利用方式。提供的PoC代码提供了一个可用的攻击框架。

**项目地址:** [onlyHerold22/CVE-2022-27925-PoC](https://github.com/onlyHerold22/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #9

**来源**: [CVE-2022-27925-sanan2004_CVE-2022-27925.md](../2022/CVE-2022-27925-sanan2004_CVE-2022-27925.md)

## CVE-2022-27925 Zimbra Collaboration Suite 路径遍历漏洞

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 Patch 30 (及更早版本), 9.0.0 Patch 23 (及更早版本)

**利用条件:** 需要目标系统存在漏洞版本，以及攻击者可以通过网络访问到zimbra的7071端口（默认情况下）。如果利用 CVE-2022-37042 绕过认证，则不需要管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite (ZCS)中的路径遍历漏洞。ZCS的mboximport功能接收ZIP存档并从中提取文件。利用该漏洞，经过身份验证（最初被认为是需要管理员权限，但后来发现存在认证绕过漏洞CVE-2022-37042）的用户可以将任意文件上传到系统，从而导致目录遍历。该POC利用了这一漏洞，通过构造恶意的ZIP文件，将webshell上传到zimbraAdmin目录，从而实现远程代码执行。

**利用方式:**
1.  攻击者首先需要确定目标Zimbra服务器的版本是否在受影响的范围内。
2.  如果目标存在CVE-2022-37042认证绕过漏洞，攻击者可以匿名访问管理员端口7071进行攻击；否则需要具备管理员权限。
3.  攻击者使用POC脚本，指定目标URL。
4.  POC脚本会创建一个包含恶意路径的ZIP文件，该ZIP文件中的文件会被解压到指定目录(例如：../../../../mailboxd/webapps/zimbraAdmin/)，从而写入webshell。
5.  POC脚本会尝试访问上传的webshell，如果成功，则表明漏洞利用成功，并返回webshell的URL和执行uname -a命令的结果。

**有效性:**
根据漏洞信息、搜索结果和漏洞利用代码，提供的POC代码是有效的。搜索结果中提到了该漏洞被大规模利用，并存在公开的POC。

**投毒风险:**
POC代码相对简单，主要功能是生成包含恶意路径的ZIP文件并上传webshell。可能的投毒风险在于：
1.  webshell的内容可能被修改为包含恶意代码，例如下载并执行其他恶意程序。这种可能性很低，因为提供的代码片段明确提到了上传webshell的位置，如果webshell的内容与预期不符，攻击者很容易发现。
2.  脚本可能在上传webshell之后执行其他操作，例如修改系统配置或安装后门。虽然当前的代码片段没有显示这些行为，但不能完全排除。

综合考虑，该POC存在少量投毒风险，可能性约为10%。需要仔细检查POC脚本的完整代码，特别是webshell的内容和后续操作，以确保其安全性。

**项目地址:** [sanan2004/CVE-2022-27925](https://github.com/sanan2004/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #10

**来源**: [CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限，但存在未经身份验证的利用方式

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-27925 是 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 中存在的路径遍历漏洞。攻击者可以通过 mboximport 功能上传包含恶意路径的 ZIP 压缩包，从而将任意文件写入系统。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码尝试利用该漏洞上传 Webshell 或反弹 Shell。代码中包含了构建恶意 ZIP 压缩包的函数 `build_zip`，以及发送 POST 请求的 `exploit` 函数。POC代码利用了mboximport接口上传zip文件，实现了文件上传和RCE。

**投毒风险：**
虽然 POC 代码本身旨在利用漏洞，但存在一定的投毒风险。代码中存在 webshell 的定义，如果攻击者在未经授权的情况下修改了代码，可以替换 webshell 的内容，例如添加恶意代码或后门，从而在成功利用漏洞后进行进一步的恶意活动。但代码整体较为简单，且目标明确，可以判断投毒风险较低。

**利用方式：**
1.  攻击者首先需要构建一个包含恶意路径的 ZIP 压缩包。恶意路径指向 Web 目录下，例如 `../../../../opt/zimbra/jetty/webapps/zimbraAdmin/webshell.jsp`。
2.  攻击者使用 `mboximport` 功能上传此 ZIP 压缩包。如果上传成功，Zimbra 会将 ZIP 压缩包中的文件解压到指定的路径，从而将 Webshell 写入系统。
3.  攻击者通过访问 Webshell 的 URL 来执行任意命令。

**利用流程总结：**

   1.  **构造恶意 ZIP 文件：** ZIP 文件内部包含精心构造的文件路径，使其在解压时能够写入到目标目录（通常是 Web 服务器的可访问目录）。文件内容为 Webshell 代码（例如JSP代码）。
   2.  **利用 `mboximport` 上传：**  利用 Zimbra 的 `mboximport` 功能，将构造好的恶意 ZIP 文件上传到服务器。
   3.  **路径遍历：**  `mboximport` 解压 ZIP 文件时，由于没有充分验证文件路径，导致路径遍历漏洞，恶意文件被写入到指定目录。
   4.  **访问 Webshell：**  攻击者可以通过 Web 浏览器访问上传的 Webshell 文件，从而执行任意命令。

根据搜索结果，此漏洞已经被广泛利用，并存在未经身份验证的利用方式，因此修复此漏洞至关重要。

**项目地址:** [touchmycrazyredhat/CVE-2022-27925-Revshell](https://github.com/touchmycrazyredhat/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #11

**来源**: [CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2022-27925 允许经过身份验证的 Zimbra 管理员用户通过上传包含恶意路径的 ZIP 档案，将文件写入文件系统上的任意位置。漏洞利用方式如下：

1.  **身份验证：** 首先，攻击者需要获得 Zimbra 管理员帐户的凭据。
2.  **构造恶意 ZIP 档案：** 攻击者创建一个 ZIP 档案，其中包含恶意文件，该文件的名称包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）。该文件实际上是一个Webshell。
3.  **上传 ZIP 档案：** 攻击者使用 `mboximport` 功能上传构造的 ZIP 档案。
4.  **利用路径遍历：** Zimbra 解压缩该档案时，路径遍历序列会将文件写入到目标目录中，覆盖或创建文件。
5.  **远程代码执行：** 如果攻击者成功将webshell写入到Web目录，可以通过访问webshell执行任意代码。

`zimbra-exploit.py` 脚本通过构造包含路径遍历的恶意ZIP文件，并利用 `mboximport` 功能上传到服务器，实现任意文件写入。脚本首先替换了 `exploit_path` 变量中的 email。之后循环遍历 `exploit_path`, 通过 POST 请求，将恶意ZIP文件 (`shell_list` 中的 `.zip` 文件)上传到目标服务器。上传成功后，脚本会尝试访问上传的webshell路径 `/zimbraAdmin/cmd.jsp`，检测webshell是否上传成功。

**有效性：** 根据搜索结果和漏洞利用代码，可以判断该POC代码是有效的，可以利用路径遍历漏洞实现任意文件上传。

**投毒风险：** 分析提供的 `zimbra-exploit.py` 脚本，没有发现明显的恶意代码或者后门。该脚本的功能主要是利用路径遍历漏洞上传webshell。因此，该仓库中存在投毒代码的风险较低。

**项目地址:** [vnhacker1337/CVE-2022-27925-PoC](https://github.com/vnhacker1337/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---



---

## POC #8

**来源**: [CVE-2022-27925-navokus_CVE-2022-27925.md](../2022/CVE-2022-27925-navokus_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限的身份验证（但根据搜索结果可能存在绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite 8.8.15和9.0的mboximport功能中。具有管理员权限的已认证用户可以通过上传包含恶意路径的ZIP文件，利用目录遍历漏洞将任意文件写入系统。漏洞利用方式如下：

1.  **漏洞原理：**mboximport功能接收ZIP压缩包并解压，由于未对压缩包内的文件路径进行充分验证，攻击者可以通过构造包含特殊字符（如“../”）的路径，将文件写入任意目录。
2.  **利用步骤：**
    *   构建一个包含恶意JSP shell的ZIP文件，JSP shell的文件名和路径经过精心构造，利用目录遍历写入到Web服务器的可执行目录下。
    *   使用管理员权限登录Zimbra管理界面。
    *   通过mboximport功能上传构造好的ZIP文件。
    *   如果上传成功，JSP shell将被写入指定目录。
    *   通过访问JSP shell的URL来执行任意命令。
3.  **POC代码分析：**
    *   `run.py`脚本使用`zipfile`库创建一个包含JSP shell的ZIP文件。
    *   JSP shell的功能是接收`cmd`参数，并在服务器上执行该命令，然后将结果返回。
    *   脚本尝试将JSP shell写入三个不同的路径：`../../../../mailboxd/webapps/zimbraAdmin/admin.bk.jsp`，`../../../../jetty_base/webapps/zimbraAdmin/admin.bk.jsp`和`../../../../jetty/webapps/zimbraAdmin/admin.bk.jsp`，涵盖了不同的Zimbra部署环境。
    *   脚本使用`requests`库向`/service/extensio3/backup/mboximport`和`/service/extension/backup/mboximport`端点发送POST请求，上传ZIP文件。
    *   最后，脚本尝试通过访问JSP shell的URL（`/zimbraAdmin/admin.bk.jsp?cmd=`）来执行命令`ps aux`或`ls -la`，并打印HTTP状态码以确认漏洞是否利用成功。
4.  **有效性：**
    *   根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被积极利用。
    *   提供的POC代码看起来有效，因为它能够构造恶意ZIP文件，并尝试将其上传到目标服务器，并在成功上传后执行命令。
5.  **投毒风险：**
    *   对提供的POC代码进行了分析，没有发现任何明显的投毒代码。该脚本的主要功能是利用漏洞进行攻击，而不是在目标系统上安装后门或其他恶意软件。因此，投毒风险为0%。
6.  **其他风险:**
    *  搜索结果表明，CVE-2022-27925常与其他漏洞（例如CVE-2022-37042）组合利用，实现未经身份验证的远程代码执行。这意味着即使攻击者没有管理员权限，也可能通过其他漏洞绕过身份验证，然后利用此漏洞上传恶意文件并执行代码。

**项目地址:** [navokus/CVE-2022-27925](https://github.com/navokus/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #9

**来源**: [CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限认证（但部分情况下存在认证绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是Zimbra Collaboration Suite (ZCS) 8.8.15和9.0版本中的一个路径遍历漏洞。该漏洞存在于mboximport功能中，该功能接收ZIP存档并从中提取文件。拥有管理员权限的经过身份验证的用户能够将任意文件上传到系统，从而导致目录遍历。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用是有效的。搜索引擎结果中提到该漏洞已被大规模利用，且CISA已将其列入已知被利用漏洞目录。POC代码提供了利用此漏洞的Python脚本。

**投毒风险：**
查看提供的poc代码，未发现任何恶意投毒代码。POC代码主要功能是通过上传恶意的ZIP文件，利用路径遍历漏洞将webshell写入服务器，从而获得服务器的控制权限。代码本身较为清晰，没有隐藏的后门或恶意逻辑。

**利用方式：**
1.  **认证：** 首先，攻击者需要具有管理员权限的有效Zimbra帐户。然而，根据搜索结果，存在未经身份验证的RCE的利用方式，这意味着在某些情况下可以绕过身份验证。
2.  **构造恶意ZIP文件：**  攻击者需要构造一个包含恶意文件（例如，JSP webshell）的ZIP文件。ZIP文件中的文件名需要包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）来指定目标文件写入位置。
3.  **上传ZIP文件：**  攻击者使用mboximport功能上传构造的恶意ZIP文件。POC代码中的`zimbra-exploit.py`脚本通过向`/service/extension/backup/mboximport`端点发送POST请求来完成上传，`account-name`参数指定一个有效的邮箱地址。
4.  **执行恶意代码：**  成功上传并解压ZIP文件后，攻击者可以通过访问上传的webshell（例如，`/zimbraAdmin/cmd.jsp`）来执行任意命令。POC代码中`checkShell`函数检查webshell是否成功上传，通过发送GET请求验证。
5.  **漏洞利用代码分析：** 代码中使用了两个不同的利用路径（`exploit_path`），并尝试了多个webshell名称（`shell_list`），以提高漏洞利用的成功率。还包含一个检查webshell是否成功部署的步骤。

**总结：** 该漏洞的利用涉及构造包含路径遍历payload的恶意ZIP文件，并通过Zimbra的mboximport功能上传。攻击者利用目录遍历将webshell写入Web目录，从而实现远程代码执行。虽然初始描述要求管理员权限，但搜索结果表明存在无需认证的利用方式。提供的PoC代码提供了一个可用的攻击框架。

**项目地址:** [onlyHerold22/CVE-2022-27925-PoC](https://github.com/onlyHerold22/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #10

**来源**: [CVE-2022-27925-sanan2004_CVE-2022-27925.md](../2022/CVE-2022-27925-sanan2004_CVE-2022-27925.md)

## CVE-2022-27925 Zimbra Collaboration Suite 路径遍历漏洞

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 Patch 30 (及更早版本), 9.0.0 Patch 23 (及更早版本)

**利用条件:** 需要目标系统存在漏洞版本，以及攻击者可以通过网络访问到zimbra的7071端口（默认情况下）。如果利用 CVE-2022-37042 绕过认证，则不需要管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite (ZCS)中的路径遍历漏洞。ZCS的mboximport功能接收ZIP存档并从中提取文件。利用该漏洞，经过身份验证（最初被认为是需要管理员权限，但后来发现存在认证绕过漏洞CVE-2022-37042）的用户可以将任意文件上传到系统，从而导致目录遍历。该POC利用了这一漏洞，通过构造恶意的ZIP文件，将webshell上传到zimbraAdmin目录，从而实现远程代码执行。

**利用方式:**
1.  攻击者首先需要确定目标Zimbra服务器的版本是否在受影响的范围内。
2.  如果目标存在CVE-2022-37042认证绕过漏洞，攻击者可以匿名访问管理员端口7071进行攻击；否则需要具备管理员权限。
3.  攻击者使用POC脚本，指定目标URL。
4.  POC脚本会创建一个包含恶意路径的ZIP文件，该ZIP文件中的文件会被解压到指定目录(例如：../../../../mailboxd/webapps/zimbraAdmin/)，从而写入webshell。
5.  POC脚本会尝试访问上传的webshell，如果成功，则表明漏洞利用成功，并返回webshell的URL和执行uname -a命令的结果。

**有效性:**
根据漏洞信息、搜索结果和漏洞利用代码，提供的POC代码是有效的。搜索结果中提到了该漏洞被大规模利用，并存在公开的POC。

**投毒风险:**
POC代码相对简单，主要功能是生成包含恶意路径的ZIP文件并上传webshell。可能的投毒风险在于：
1.  webshell的内容可能被修改为包含恶意代码，例如下载并执行其他恶意程序。这种可能性很低，因为提供的代码片段明确提到了上传webshell的位置，如果webshell的内容与预期不符，攻击者很容易发现。
2.  脚本可能在上传webshell之后执行其他操作，例如修改系统配置或安装后门。虽然当前的代码片段没有显示这些行为，但不能完全排除。

综合考虑，该POC存在少量投毒风险，可能性约为10%。需要仔细检查POC脚本的完整代码，特别是webshell的内容和后续操作，以确保其安全性。

**项目地址:** [sanan2004/CVE-2022-27925](https://github.com/sanan2004/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #11

**来源**: [CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限，但存在未经身份验证的利用方式

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-27925 是 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 中存在的路径遍历漏洞。攻击者可以通过 mboximport 功能上传包含恶意路径的 ZIP 压缩包，从而将任意文件写入系统。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码尝试利用该漏洞上传 Webshell 或反弹 Shell。代码中包含了构建恶意 ZIP 压缩包的函数 `build_zip`，以及发送 POST 请求的 `exploit` 函数。POC代码利用了mboximport接口上传zip文件，实现了文件上传和RCE。

**投毒风险：**
虽然 POC 代码本身旨在利用漏洞，但存在一定的投毒风险。代码中存在 webshell 的定义，如果攻击者在未经授权的情况下修改了代码，可以替换 webshell 的内容，例如添加恶意代码或后门，从而在成功利用漏洞后进行进一步的恶意活动。但代码整体较为简单，且目标明确，可以判断投毒风险较低。

**利用方式：**
1.  攻击者首先需要构建一个包含恶意路径的 ZIP 压缩包。恶意路径指向 Web 目录下，例如 `../../../../opt/zimbra/jetty/webapps/zimbraAdmin/webshell.jsp`。
2.  攻击者使用 `mboximport` 功能上传此 ZIP 压缩包。如果上传成功，Zimbra 会将 ZIP 压缩包中的文件解压到指定的路径，从而将 Webshell 写入系统。
3.  攻击者通过访问 Webshell 的 URL 来执行任意命令。

**利用流程总结：**

   1.  **构造恶意 ZIP 文件：** ZIP 文件内部包含精心构造的文件路径，使其在解压时能够写入到目标目录（通常是 Web 服务器的可访问目录）。文件内容为 Webshell 代码（例如JSP代码）。
   2.  **利用 `mboximport` 上传：**  利用 Zimbra 的 `mboximport` 功能，将构造好的恶意 ZIP 文件上传到服务器。
   3.  **路径遍历：**  `mboximport` 解压 ZIP 文件时，由于没有充分验证文件路径，导致路径遍历漏洞，恶意文件被写入到指定目录。
   4.  **访问 Webshell：**  攻击者可以通过 Web 浏览器访问上传的 Webshell 文件，从而执行任意命令。

根据搜索结果，此漏洞已经被广泛利用，并存在未经身份验证的利用方式，因此修复此漏洞至关重要。

**项目地址:** [touchmycrazyredhat/CVE-2022-27925-Revshell](https://github.com/touchmycrazyredhat/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #12

**来源**: [CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2022-27925 允许经过身份验证的 Zimbra 管理员用户通过上传包含恶意路径的 ZIP 档案，将文件写入文件系统上的任意位置。漏洞利用方式如下：

1.  **身份验证：** 首先，攻击者需要获得 Zimbra 管理员帐户的凭据。
2.  **构造恶意 ZIP 档案：** 攻击者创建一个 ZIP 档案，其中包含恶意文件，该文件的名称包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）。该文件实际上是一个Webshell。
3.  **上传 ZIP 档案：** 攻击者使用 `mboximport` 功能上传构造的 ZIP 档案。
4.  **利用路径遍历：** Zimbra 解压缩该档案时，路径遍历序列会将文件写入到目标目录中，覆盖或创建文件。
5.  **远程代码执行：** 如果攻击者成功将webshell写入到Web目录，可以通过访问webshell执行任意代码。

`zimbra-exploit.py` 脚本通过构造包含路径遍历的恶意ZIP文件，并利用 `mboximport` 功能上传到服务器，实现任意文件写入。脚本首先替换了 `exploit_path` 变量中的 email。之后循环遍历 `exploit_path`, 通过 POST 请求，将恶意ZIP文件 (`shell_list` 中的 `.zip` 文件)上传到目标服务器。上传成功后，脚本会尝试访问上传的webshell路径 `/zimbraAdmin/cmd.jsp`，检测webshell是否上传成功。

**有效性：** 根据搜索结果和漏洞利用代码，可以判断该POC代码是有效的，可以利用路径遍历漏洞实现任意文件上传。

**投毒风险：** 分析提供的 `zimbra-exploit.py` 脚本，没有发现明显的恶意代码或者后门。该脚本的功能主要是利用路径遍历漏洞上传webshell。因此，该仓库中存在投毒代码的风险较低。

**项目地址:** [vnhacker1337/CVE-2022-27925-PoC](https://github.com/vnhacker1337/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---



---

## POC #8

**来源**: [CVE-2022-27925-navokus_CVE-2022-27925.md](../2022/CVE-2022-27925-navokus_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限的身份验证（但根据搜索结果可能存在绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite 8.8.15和9.0的mboximport功能中。具有管理员权限的已认证用户可以通过上传包含恶意路径的ZIP文件，利用目录遍历漏洞将任意文件写入系统。漏洞利用方式如下：

1.  **漏洞原理：**mboximport功能接收ZIP压缩包并解压，由于未对压缩包内的文件路径进行充分验证，攻击者可以通过构造包含特殊字符（如“../”）的路径，将文件写入任意目录。
2.  **利用步骤：**
    *   构建一个包含恶意JSP shell的ZIP文件，JSP shell的文件名和路径经过精心构造，利用目录遍历写入到Web服务器的可执行目录下。
    *   使用管理员权限登录Zimbra管理界面。
    *   通过mboximport功能上传构造好的ZIP文件。
    *   如果上传成功，JSP shell将被写入指定目录。
    *   通过访问JSP shell的URL来执行任意命令。
3.  **POC代码分析：**
    *   `run.py`脚本使用`zipfile`库创建一个包含JSP shell的ZIP文件。
    *   JSP shell的功能是接收`cmd`参数，并在服务器上执行该命令，然后将结果返回。
    *   脚本尝试将JSP shell写入三个不同的路径：`../../../../mailboxd/webapps/zimbraAdmin/admin.bk.jsp`，`../../../../jetty_base/webapps/zimbraAdmin/admin.bk.jsp`和`../../../../jetty/webapps/zimbraAdmin/admin.bk.jsp`，涵盖了不同的Zimbra部署环境。
    *   脚本使用`requests`库向`/service/extensio3/backup/mboximport`和`/service/extension/backup/mboximport`端点发送POST请求，上传ZIP文件。
    *   最后，脚本尝试通过访问JSP shell的URL（`/zimbraAdmin/admin.bk.jsp?cmd=`）来执行命令`ps aux`或`ls -la`，并打印HTTP状态码以确认漏洞是否利用成功。
4.  **有效性：**
    *   根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被积极利用。
    *   提供的POC代码看起来有效，因为它能够构造恶意ZIP文件，并尝试将其上传到目标服务器，并在成功上传后执行命令。
5.  **投毒风险：**
    *   对提供的POC代码进行了分析，没有发现任何明显的投毒代码。该脚本的主要功能是利用漏洞进行攻击，而不是在目标系统上安装后门或其他恶意软件。因此，投毒风险为0%。
6.  **其他风险:**
    *  搜索结果表明，CVE-2022-27925常与其他漏洞（例如CVE-2022-37042）组合利用，实现未经身份验证的远程代码执行。这意味着即使攻击者没有管理员权限，也可能通过其他漏洞绕过身份验证，然后利用此漏洞上传恶意文件并执行代码。

**项目地址:** [navokus/CVE-2022-27925](https://github.com/navokus/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #9

**来源**: [CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限认证（但部分情况下存在认证绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是Zimbra Collaboration Suite (ZCS) 8.8.15和9.0版本中的一个路径遍历漏洞。该漏洞存在于mboximport功能中，该功能接收ZIP存档并从中提取文件。拥有管理员权限的经过身份验证的用户能够将任意文件上传到系统，从而导致目录遍历。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用是有效的。搜索引擎结果中提到该漏洞已被大规模利用，且CISA已将其列入已知被利用漏洞目录。POC代码提供了利用此漏洞的Python脚本。

**投毒风险：**
查看提供的poc代码，未发现任何恶意投毒代码。POC代码主要功能是通过上传恶意的ZIP文件，利用路径遍历漏洞将webshell写入服务器，从而获得服务器的控制权限。代码本身较为清晰，没有隐藏的后门或恶意逻辑。

**利用方式：**
1.  **认证：** 首先，攻击者需要具有管理员权限的有效Zimbra帐户。然而，根据搜索结果，存在未经身份验证的RCE的利用方式，这意味着在某些情况下可以绕过身份验证。
2.  **构造恶意ZIP文件：**  攻击者需要构造一个包含恶意文件（例如，JSP webshell）的ZIP文件。ZIP文件中的文件名需要包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）来指定目标文件写入位置。
3.  **上传ZIP文件：**  攻击者使用mboximport功能上传构造的恶意ZIP文件。POC代码中的`zimbra-exploit.py`脚本通过向`/service/extension/backup/mboximport`端点发送POST请求来完成上传，`account-name`参数指定一个有效的邮箱地址。
4.  **执行恶意代码：**  成功上传并解压ZIP文件后，攻击者可以通过访问上传的webshell（例如，`/zimbraAdmin/cmd.jsp`）来执行任意命令。POC代码中`checkShell`函数检查webshell是否成功上传，通过发送GET请求验证。
5.  **漏洞利用代码分析：** 代码中使用了两个不同的利用路径（`exploit_path`），并尝试了多个webshell名称（`shell_list`），以提高漏洞利用的成功率。还包含一个检查webshell是否成功部署的步骤。

**总结：** 该漏洞的利用涉及构造包含路径遍历payload的恶意ZIP文件，并通过Zimbra的mboximport功能上传。攻击者利用目录遍历将webshell写入Web目录，从而实现远程代码执行。虽然初始描述要求管理员权限，但搜索结果表明存在无需认证的利用方式。提供的PoC代码提供了一个可用的攻击框架。

**项目地址:** [onlyHerold22/CVE-2022-27925-PoC](https://github.com/onlyHerold22/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #10

**来源**: [CVE-2022-27925-sanan2004_CVE-2022-27925.md](../2022/CVE-2022-27925-sanan2004_CVE-2022-27925.md)

## CVE-2022-27925 Zimbra Collaboration Suite 路径遍历漏洞

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 Patch 30 (及更早版本), 9.0.0 Patch 23 (及更早版本)

**利用条件:** 需要目标系统存在漏洞版本，以及攻击者可以通过网络访问到zimbra的7071端口（默认情况下）。如果利用 CVE-2022-37042 绕过认证，则不需要管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite (ZCS)中的路径遍历漏洞。ZCS的mboximport功能接收ZIP存档并从中提取文件。利用该漏洞，经过身份验证（最初被认为是需要管理员权限，但后来发现存在认证绕过漏洞CVE-2022-37042）的用户可以将任意文件上传到系统，从而导致目录遍历。该POC利用了这一漏洞，通过构造恶意的ZIP文件，将webshell上传到zimbraAdmin目录，从而实现远程代码执行。

**利用方式:**
1.  攻击者首先需要确定目标Zimbra服务器的版本是否在受影响的范围内。
2.  如果目标存在CVE-2022-37042认证绕过漏洞，攻击者可以匿名访问管理员端口7071进行攻击；否则需要具备管理员权限。
3.  攻击者使用POC脚本，指定目标URL。
4.  POC脚本会创建一个包含恶意路径的ZIP文件，该ZIP文件中的文件会被解压到指定目录(例如：../../../../mailboxd/webapps/zimbraAdmin/)，从而写入webshell。
5.  POC脚本会尝试访问上传的webshell，如果成功，则表明漏洞利用成功，并返回webshell的URL和执行uname -a命令的结果。

**有效性:**
根据漏洞信息、搜索结果和漏洞利用代码，提供的POC代码是有效的。搜索结果中提到了该漏洞被大规模利用，并存在公开的POC。

**投毒风险:**
POC代码相对简单，主要功能是生成包含恶意路径的ZIP文件并上传webshell。可能的投毒风险在于：
1.  webshell的内容可能被修改为包含恶意代码，例如下载并执行其他恶意程序。这种可能性很低，因为提供的代码片段明确提到了上传webshell的位置，如果webshell的内容与预期不符，攻击者很容易发现。
2.  脚本可能在上传webshell之后执行其他操作，例如修改系统配置或安装后门。虽然当前的代码片段没有显示这些行为，但不能完全排除。

综合考虑，该POC存在少量投毒风险，可能性约为10%。需要仔细检查POC脚本的完整代码，特别是webshell的内容和后续操作，以确保其安全性。

**项目地址:** [sanan2004/CVE-2022-27925](https://github.com/sanan2004/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #11

**来源**: [CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限，但存在未经身份验证的利用方式

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-27925 是 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 中存在的路径遍历漏洞。攻击者可以通过 mboximport 功能上传包含恶意路径的 ZIP 压缩包，从而将任意文件写入系统。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码尝试利用该漏洞上传 Webshell 或反弹 Shell。代码中包含了构建恶意 ZIP 压缩包的函数 `build_zip`，以及发送 POST 请求的 `exploit` 函数。POC代码利用了mboximport接口上传zip文件，实现了文件上传和RCE。

**投毒风险：**
虽然 POC 代码本身旨在利用漏洞，但存在一定的投毒风险。代码中存在 webshell 的定义，如果攻击者在未经授权的情况下修改了代码，可以替换 webshell 的内容，例如添加恶意代码或后门，从而在成功利用漏洞后进行进一步的恶意活动。但代码整体较为简单，且目标明确，可以判断投毒风险较低。

**利用方式：**
1.  攻击者首先需要构建一个包含恶意路径的 ZIP 压缩包。恶意路径指向 Web 目录下，例如 `../../../../opt/zimbra/jetty/webapps/zimbraAdmin/webshell.jsp`。
2.  攻击者使用 `mboximport` 功能上传此 ZIP 压缩包。如果上传成功，Zimbra 会将 ZIP 压缩包中的文件解压到指定的路径，从而将 Webshell 写入系统。
3.  攻击者通过访问 Webshell 的 URL 来执行任意命令。

**利用流程总结：**

   1.  **构造恶意 ZIP 文件：** ZIP 文件内部包含精心构造的文件路径，使其在解压时能够写入到目标目录（通常是 Web 服务器的可访问目录）。文件内容为 Webshell 代码（例如JSP代码）。
   2.  **利用 `mboximport` 上传：**  利用 Zimbra 的 `mboximport` 功能，将构造好的恶意 ZIP 文件上传到服务器。
   3.  **路径遍历：**  `mboximport` 解压 ZIP 文件时，由于没有充分验证文件路径，导致路径遍历漏洞，恶意文件被写入到指定目录。
   4.  **访问 Webshell：**  攻击者可以通过 Web 浏览器访问上传的 Webshell 文件，从而执行任意命令。

根据搜索结果，此漏洞已经被广泛利用，并存在未经身份验证的利用方式，因此修复此漏洞至关重要。

**项目地址:** [touchmycrazyredhat/CVE-2022-27925-Revshell](https://github.com/touchmycrazyredhat/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #12

**来源**: [CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2022-27925 允许经过身份验证的 Zimbra 管理员用户通过上传包含恶意路径的 ZIP 档案，将文件写入文件系统上的任意位置。漏洞利用方式如下：

1.  **身份验证：** 首先，攻击者需要获得 Zimbra 管理员帐户的凭据。
2.  **构造恶意 ZIP 档案：** 攻击者创建一个 ZIP 档案，其中包含恶意文件，该文件的名称包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）。该文件实际上是一个Webshell。
3.  **上传 ZIP 档案：** 攻击者使用 `mboximport` 功能上传构造的 ZIP 档案。
4.  **利用路径遍历：** Zimbra 解压缩该档案时，路径遍历序列会将文件写入到目标目录中，覆盖或创建文件。
5.  **远程代码执行：** 如果攻击者成功将webshell写入到Web目录，可以通过访问webshell执行任意代码。

`zimbra-exploit.py` 脚本通过构造包含路径遍历的恶意ZIP文件，并利用 `mboximport` 功能上传到服务器，实现任意文件写入。脚本首先替换了 `exploit_path` 变量中的 email。之后循环遍历 `exploit_path`, 通过 POST 请求，将恶意ZIP文件 (`shell_list` 中的 `.zip` 文件)上传到目标服务器。上传成功后，脚本会尝试访问上传的webshell路径 `/zimbraAdmin/cmd.jsp`，检测webshell是否上传成功。

**有效性：** 根据搜索结果和漏洞利用代码，可以判断该POC代码是有效的，可以利用路径遍历漏洞实现任意文件上传。

**投毒风险：** 分析提供的 `zimbra-exploit.py` 脚本，没有发现明显的恶意代码或者后门。该脚本的功能主要是利用路径遍历漏洞上传webshell。因此，该仓库中存在投毒代码的风险较低。

**项目地址:** [vnhacker1337/CVE-2022-27925-PoC](https://github.com/vnhacker1337/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---



---

## POC #8

**来源**: [CVE-2022-27925-navokus_CVE-2022-27925.md](../2022/CVE-2022-27925-navokus_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限的身份验证（但根据搜索结果可能存在绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite 8.8.15和9.0的mboximport功能中。具有管理员权限的已认证用户可以通过上传包含恶意路径的ZIP文件，利用目录遍历漏洞将任意文件写入系统。漏洞利用方式如下：

1.  **漏洞原理：**mboximport功能接收ZIP压缩包并解压，由于未对压缩包内的文件路径进行充分验证，攻击者可以通过构造包含特殊字符（如“../”）的路径，将文件写入任意目录。
2.  **利用步骤：**
    *   构建一个包含恶意JSP shell的ZIP文件，JSP shell的文件名和路径经过精心构造，利用目录遍历写入到Web服务器的可执行目录下。
    *   使用管理员权限登录Zimbra管理界面。
    *   通过mboximport功能上传构造好的ZIP文件。
    *   如果上传成功，JSP shell将被写入指定目录。
    *   通过访问JSP shell的URL来执行任意命令。
3.  **POC代码分析：**
    *   `run.py`脚本使用`zipfile`库创建一个包含JSP shell的ZIP文件。
    *   JSP shell的功能是接收`cmd`参数，并在服务器上执行该命令，然后将结果返回。
    *   脚本尝试将JSP shell写入三个不同的路径：`../../../../mailboxd/webapps/zimbraAdmin/admin.bk.jsp`，`../../../../jetty_base/webapps/zimbraAdmin/admin.bk.jsp`和`../../../../jetty/webapps/zimbraAdmin/admin.bk.jsp`，涵盖了不同的Zimbra部署环境。
    *   脚本使用`requests`库向`/service/extensio3/backup/mboximport`和`/service/extension/backup/mboximport`端点发送POST请求，上传ZIP文件。
    *   最后，脚本尝试通过访问JSP shell的URL（`/zimbraAdmin/admin.bk.jsp?cmd=`）来执行命令`ps aux`或`ls -la`，并打印HTTP状态码以确认漏洞是否利用成功。
4.  **有效性：**
    *   根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被积极利用。
    *   提供的POC代码看起来有效，因为它能够构造恶意ZIP文件，并尝试将其上传到目标服务器，并在成功上传后执行命令。
5.  **投毒风险：**
    *   对提供的POC代码进行了分析，没有发现任何明显的投毒代码。该脚本的主要功能是利用漏洞进行攻击，而不是在目标系统上安装后门或其他恶意软件。因此，投毒风险为0%。
6.  **其他风险:**
    *  搜索结果表明，CVE-2022-27925常与其他漏洞（例如CVE-2022-37042）组合利用，实现未经身份验证的远程代码执行。这意味着即使攻击者没有管理员权限，也可能通过其他漏洞绕过身份验证，然后利用此漏洞上传恶意文件并执行代码。

**项目地址:** [navokus/CVE-2022-27925](https://github.com/navokus/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #9

**来源**: [CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限认证（但部分情况下存在认证绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是Zimbra Collaboration Suite (ZCS) 8.8.15和9.0版本中的一个路径遍历漏洞。该漏洞存在于mboximport功能中，该功能接收ZIP存档并从中提取文件。拥有管理员权限的经过身份验证的用户能够将任意文件上传到系统，从而导致目录遍历。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用是有效的。搜索引擎结果中提到该漏洞已被大规模利用，且CISA已将其列入已知被利用漏洞目录。POC代码提供了利用此漏洞的Python脚本。

**投毒风险：**
查看提供的poc代码，未发现任何恶意投毒代码。POC代码主要功能是通过上传恶意的ZIP文件，利用路径遍历漏洞将webshell写入服务器，从而获得服务器的控制权限。代码本身较为清晰，没有隐藏的后门或恶意逻辑。

**利用方式：**
1.  **认证：** 首先，攻击者需要具有管理员权限的有效Zimbra帐户。然而，根据搜索结果，存在未经身份验证的RCE的利用方式，这意味着在某些情况下可以绕过身份验证。
2.  **构造恶意ZIP文件：**  攻击者需要构造一个包含恶意文件（例如，JSP webshell）的ZIP文件。ZIP文件中的文件名需要包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）来指定目标文件写入位置。
3.  **上传ZIP文件：**  攻击者使用mboximport功能上传构造的恶意ZIP文件。POC代码中的`zimbra-exploit.py`脚本通过向`/service/extension/backup/mboximport`端点发送POST请求来完成上传，`account-name`参数指定一个有效的邮箱地址。
4.  **执行恶意代码：**  成功上传并解压ZIP文件后，攻击者可以通过访问上传的webshell（例如，`/zimbraAdmin/cmd.jsp`）来执行任意命令。POC代码中`checkShell`函数检查webshell是否成功上传，通过发送GET请求验证。
5.  **漏洞利用代码分析：** 代码中使用了两个不同的利用路径（`exploit_path`），并尝试了多个webshell名称（`shell_list`），以提高漏洞利用的成功率。还包含一个检查webshell是否成功部署的步骤。

**总结：** 该漏洞的利用涉及构造包含路径遍历payload的恶意ZIP文件，并通过Zimbra的mboximport功能上传。攻击者利用目录遍历将webshell写入Web目录，从而实现远程代码执行。虽然初始描述要求管理员权限，但搜索结果表明存在无需认证的利用方式。提供的PoC代码提供了一个可用的攻击框架。

**项目地址:** [onlyHerold22/CVE-2022-27925-PoC](https://github.com/onlyHerold22/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #10

**来源**: [CVE-2022-27925-sanan2004_CVE-2022-27925.md](../2022/CVE-2022-27925-sanan2004_CVE-2022-27925.md)

## CVE-2022-27925 Zimbra Collaboration Suite 路径遍历漏洞

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 Patch 30 (及更早版本), 9.0.0 Patch 23 (及更早版本)

**利用条件:** 需要目标系统存在漏洞版本，以及攻击者可以通过网络访问到zimbra的7071端口（默认情况下）。如果利用 CVE-2022-37042 绕过认证，则不需要管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite (ZCS)中的路径遍历漏洞。ZCS的mboximport功能接收ZIP存档并从中提取文件。利用该漏洞，经过身份验证（最初被认为是需要管理员权限，但后来发现存在认证绕过漏洞CVE-2022-37042）的用户可以将任意文件上传到系统，从而导致目录遍历。该POC利用了这一漏洞，通过构造恶意的ZIP文件，将webshell上传到zimbraAdmin目录，从而实现远程代码执行。

**利用方式:**
1.  攻击者首先需要确定目标Zimbra服务器的版本是否在受影响的范围内。
2.  如果目标存在CVE-2022-37042认证绕过漏洞，攻击者可以匿名访问管理员端口7071进行攻击；否则需要具备管理员权限。
3.  攻击者使用POC脚本，指定目标URL。
4.  POC脚本会创建一个包含恶意路径的ZIP文件，该ZIP文件中的文件会被解压到指定目录(例如：../../../../mailboxd/webapps/zimbraAdmin/)，从而写入webshell。
5.  POC脚本会尝试访问上传的webshell，如果成功，则表明漏洞利用成功，并返回webshell的URL和执行uname -a命令的结果。

**有效性:**
根据漏洞信息、搜索结果和漏洞利用代码，提供的POC代码是有效的。搜索结果中提到了该漏洞被大规模利用，并存在公开的POC。

**投毒风险:**
POC代码相对简单，主要功能是生成包含恶意路径的ZIP文件并上传webshell。可能的投毒风险在于：
1.  webshell的内容可能被修改为包含恶意代码，例如下载并执行其他恶意程序。这种可能性很低，因为提供的代码片段明确提到了上传webshell的位置，如果webshell的内容与预期不符，攻击者很容易发现。
2.  脚本可能在上传webshell之后执行其他操作，例如修改系统配置或安装后门。虽然当前的代码片段没有显示这些行为，但不能完全排除。

综合考虑，该POC存在少量投毒风险，可能性约为10%。需要仔细检查POC脚本的完整代码，特别是webshell的内容和后续操作，以确保其安全性。

**项目地址:** [sanan2004/CVE-2022-27925](https://github.com/sanan2004/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #11

**来源**: [CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限，但存在未经身份验证的利用方式

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-27925 是 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 中存在的路径遍历漏洞。攻击者可以通过 mboximport 功能上传包含恶意路径的 ZIP 压缩包，从而将任意文件写入系统。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码尝试利用该漏洞上传 Webshell 或反弹 Shell。代码中包含了构建恶意 ZIP 压缩包的函数 `build_zip`，以及发送 POST 请求的 `exploit` 函数。POC代码利用了mboximport接口上传zip文件，实现了文件上传和RCE。

**投毒风险：**
虽然 POC 代码本身旨在利用漏洞，但存在一定的投毒风险。代码中存在 webshell 的定义，如果攻击者在未经授权的情况下修改了代码，可以替换 webshell 的内容，例如添加恶意代码或后门，从而在成功利用漏洞后进行进一步的恶意活动。但代码整体较为简单，且目标明确，可以判断投毒风险较低。

**利用方式：**
1.  攻击者首先需要构建一个包含恶意路径的 ZIP 压缩包。恶意路径指向 Web 目录下，例如 `../../../../opt/zimbra/jetty/webapps/zimbraAdmin/webshell.jsp`。
2.  攻击者使用 `mboximport` 功能上传此 ZIP 压缩包。如果上传成功，Zimbra 会将 ZIP 压缩包中的文件解压到指定的路径，从而将 Webshell 写入系统。
3.  攻击者通过访问 Webshell 的 URL 来执行任意命令。

**利用流程总结：**

   1.  **构造恶意 ZIP 文件：** ZIP 文件内部包含精心构造的文件路径，使其在解压时能够写入到目标目录（通常是 Web 服务器的可访问目录）。文件内容为 Webshell 代码（例如JSP代码）。
   2.  **利用 `mboximport` 上传：**  利用 Zimbra 的 `mboximport` 功能，将构造好的恶意 ZIP 文件上传到服务器。
   3.  **路径遍历：**  `mboximport` 解压 ZIP 文件时，由于没有充分验证文件路径，导致路径遍历漏洞，恶意文件被写入到指定目录。
   4.  **访问 Webshell：**  攻击者可以通过 Web 浏览器访问上传的 Webshell 文件，从而执行任意命令。

根据搜索结果，此漏洞已经被广泛利用，并存在未经身份验证的利用方式，因此修复此漏洞至关重要。

**项目地址:** [touchmycrazyredhat/CVE-2022-27925-Revshell](https://github.com/touchmycrazyredhat/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #12

**来源**: [CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2022-27925 允许经过身份验证的 Zimbra 管理员用户通过上传包含恶意路径的 ZIP 档案，将文件写入文件系统上的任意位置。漏洞利用方式如下：

1.  **身份验证：** 首先，攻击者需要获得 Zimbra 管理员帐户的凭据。
2.  **构造恶意 ZIP 档案：** 攻击者创建一个 ZIP 档案，其中包含恶意文件，该文件的名称包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）。该文件实际上是一个Webshell。
3.  **上传 ZIP 档案：** 攻击者使用 `mboximport` 功能上传构造的 ZIP 档案。
4.  **利用路径遍历：** Zimbra 解压缩该档案时，路径遍历序列会将文件写入到目标目录中，覆盖或创建文件。
5.  **远程代码执行：** 如果攻击者成功将webshell写入到Web目录，可以通过访问webshell执行任意代码。

`zimbra-exploit.py` 脚本通过构造包含路径遍历的恶意ZIP文件，并利用 `mboximport` 功能上传到服务器，实现任意文件写入。脚本首先替换了 `exploit_path` 变量中的 email。之后循环遍历 `exploit_path`, 通过 POST 请求，将恶意ZIP文件 (`shell_list` 中的 `.zip` 文件)上传到目标服务器。上传成功后，脚本会尝试访问上传的webshell路径 `/zimbraAdmin/cmd.jsp`，检测webshell是否上传成功。

**有效性：** 根据搜索结果和漏洞利用代码，可以判断该POC代码是有效的，可以利用路径遍历漏洞实现任意文件上传。

**投毒风险：** 分析提供的 `zimbra-exploit.py` 脚本，没有发现明显的恶意代码或者后门。该脚本的功能主要是利用路径遍历漏洞上传webshell。因此，该仓库中存在投毒代码的风险较低。

**项目地址:** [vnhacker1337/CVE-2022-27925-PoC](https://github.com/vnhacker1337/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---



---

## POC #8

**来源**: [CVE-2022-27925-navokus_CVE-2022-27925.md](../2022/CVE-2022-27925-navokus_CVE-2022-27925.md)

## CVE-2022-27925-Zimbra-目录遍历文件上传

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限的身份验证（但根据搜索结果可能存在绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite 8.8.15和9.0的mboximport功能中。具有管理员权限的已认证用户可以通过上传包含恶意路径的ZIP文件，利用目录遍历漏洞将任意文件写入系统。漏洞利用方式如下：

1.  **漏洞原理：**mboximport功能接收ZIP压缩包并解压，由于未对压缩包内的文件路径进行充分验证，攻击者可以通过构造包含特殊字符（如“../”）的路径，将文件写入任意目录。
2.  **利用步骤：**
    *   构建一个包含恶意JSP shell的ZIP文件，JSP shell的文件名和路径经过精心构造，利用目录遍历写入到Web服务器的可执行目录下。
    *   使用管理员权限登录Zimbra管理界面。
    *   通过mboximport功能上传构造好的ZIP文件。
    *   如果上传成功，JSP shell将被写入指定目录。
    *   通过访问JSP shell的URL来执行任意命令。
3.  **POC代码分析：**
    *   `run.py`脚本使用`zipfile`库创建一个包含JSP shell的ZIP文件。
    *   JSP shell的功能是接收`cmd`参数，并在服务器上执行该命令，然后将结果返回。
    *   脚本尝试将JSP shell写入三个不同的路径：`../../../../mailboxd/webapps/zimbraAdmin/admin.bk.jsp`，`../../../../jetty_base/webapps/zimbraAdmin/admin.bk.jsp`和`../../../../jetty/webapps/zimbraAdmin/admin.bk.jsp`，涵盖了不同的Zimbra部署环境。
    *   脚本使用`requests`库向`/service/extensio3/backup/mboximport`和`/service/extension/backup/mboximport`端点发送POST请求，上传ZIP文件。
    *   最后，脚本尝试通过访问JSP shell的URL（`/zimbraAdmin/admin.bk.jsp?cmd=`）来执行命令`ps aux`或`ls -la`，并打印HTTP状态码以确认漏洞是否利用成功。
4.  **有效性：**
    *   根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被积极利用。
    *   提供的POC代码看起来有效，因为它能够构造恶意ZIP文件，并尝试将其上传到目标服务器，并在成功上传后执行命令。
5.  **投毒风险：**
    *   对提供的POC代码进行了分析，没有发现任何明显的投毒代码。该脚本的主要功能是利用漏洞进行攻击，而不是在目标系统上安装后门或其他恶意软件。因此，投毒风险为0%。
6.  **其他风险:**
    *  搜索结果表明，CVE-2022-27925常与其他漏洞（例如CVE-2022-37042）组合利用，实现未经身份验证的远程代码执行。这意味着即使攻击者没有管理员权限，也可能通过其他漏洞绕过身份验证，然后利用此漏洞上传恶意文件并执行代码。

**项目地址:** [navokus/CVE-2022-27925](https://github.com/navokus/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #9

**来源**: [CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-onlyHerold22_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限认证（但部分情况下存在认证绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是Zimbra Collaboration Suite (ZCS) 8.8.15和9.0版本中的一个路径遍历漏洞。该漏洞存在于mboximport功能中，该功能接收ZIP存档并从中提取文件。拥有管理员权限的经过身份验证的用户能够将任意文件上传到系统，从而导致目录遍历。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用是有效的。搜索引擎结果中提到该漏洞已被大规模利用，且CISA已将其列入已知被利用漏洞目录。POC代码提供了利用此漏洞的Python脚本。

**投毒风险：**
查看提供的poc代码，未发现任何恶意投毒代码。POC代码主要功能是通过上传恶意的ZIP文件，利用路径遍历漏洞将webshell写入服务器，从而获得服务器的控制权限。代码本身较为清晰，没有隐藏的后门或恶意逻辑。

**利用方式：**
1.  **认证：** 首先，攻击者需要具有管理员权限的有效Zimbra帐户。然而，根据搜索结果，存在未经身份验证的RCE的利用方式，这意味着在某些情况下可以绕过身份验证。
2.  **构造恶意ZIP文件：**  攻击者需要构造一个包含恶意文件（例如，JSP webshell）的ZIP文件。ZIP文件中的文件名需要包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）来指定目标文件写入位置。
3.  **上传ZIP文件：**  攻击者使用mboximport功能上传构造的恶意ZIP文件。POC代码中的`zimbra-exploit.py`脚本通过向`/service/extension/backup/mboximport`端点发送POST请求来完成上传，`account-name`参数指定一个有效的邮箱地址。
4.  **执行恶意代码：**  成功上传并解压ZIP文件后，攻击者可以通过访问上传的webshell（例如，`/zimbraAdmin/cmd.jsp`）来执行任意命令。POC代码中`checkShell`函数检查webshell是否成功上传，通过发送GET请求验证。
5.  **漏洞利用代码分析：** 代码中使用了两个不同的利用路径（`exploit_path`），并尝试了多个webshell名称（`shell_list`），以提高漏洞利用的成功率。还包含一个检查webshell是否成功部署的步骤。

**总结：** 该漏洞的利用涉及构造包含路径遍历payload的恶意ZIP文件，并通过Zimbra的mboximport功能上传。攻击者利用目录遍历将webshell写入Web目录，从而实现远程代码执行。虽然初始描述要求管理员权限，但搜索结果表明存在无需认证的利用方式。提供的PoC代码提供了一个可用的攻击框架。

**项目地址:** [onlyHerold22/CVE-2022-27925-PoC](https://github.com/onlyHerold22/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #10

**来源**: [CVE-2022-27925-sanan2004_CVE-2022-27925.md](../2022/CVE-2022-27925-sanan2004_CVE-2022-27925.md)

## CVE-2022-27925 Zimbra Collaboration Suite 路径遍历漏洞

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 Patch 30 (及更早版本), 9.0.0 Patch 23 (及更早版本)

**利用条件:** 需要目标系统存在漏洞版本，以及攻击者可以通过网络访问到zimbra的7071端口（默认情况下）。如果利用 CVE-2022-37042 绕过认证，则不需要管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite (ZCS)中的路径遍历漏洞。ZCS的mboximport功能接收ZIP存档并从中提取文件。利用该漏洞，经过身份验证（最初被认为是需要管理员权限，但后来发现存在认证绕过漏洞CVE-2022-37042）的用户可以将任意文件上传到系统，从而导致目录遍历。该POC利用了这一漏洞，通过构造恶意的ZIP文件，将webshell上传到zimbraAdmin目录，从而实现远程代码执行。

**利用方式:**
1.  攻击者首先需要确定目标Zimbra服务器的版本是否在受影响的范围内。
2.  如果目标存在CVE-2022-37042认证绕过漏洞，攻击者可以匿名访问管理员端口7071进行攻击；否则需要具备管理员权限。
3.  攻击者使用POC脚本，指定目标URL。
4.  POC脚本会创建一个包含恶意路径的ZIP文件，该ZIP文件中的文件会被解压到指定目录(例如：../../../../mailboxd/webapps/zimbraAdmin/)，从而写入webshell。
5.  POC脚本会尝试访问上传的webshell，如果成功，则表明漏洞利用成功，并返回webshell的URL和执行uname -a命令的结果。

**有效性:**
根据漏洞信息、搜索结果和漏洞利用代码，提供的POC代码是有效的。搜索结果中提到了该漏洞被大规模利用，并存在公开的POC。

**投毒风险:**
POC代码相对简单，主要功能是生成包含恶意路径的ZIP文件并上传webshell。可能的投毒风险在于：
1.  webshell的内容可能被修改为包含恶意代码，例如下载并执行其他恶意程序。这种可能性很低，因为提供的代码片段明确提到了上传webshell的位置，如果webshell的内容与预期不符，攻击者很容易发现。
2.  脚本可能在上传webshell之后执行其他操作，例如修改系统配置或安装后门。虽然当前的代码片段没有显示这些行为，但不能完全排除。

综合考虑，该POC存在少量投毒风险，可能性约为10%。需要仔细检查POC脚本的完整代码，特别是webshell的内容和后续操作，以确保其安全性。

**项目地址:** [sanan2004/CVE-2022-27925](https://github.com/sanan2004/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #11

**来源**: [CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md](../2022/CVE-2022-27925-touchmycrazyredhat_CVE-2022-27925-Revshell.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限，但存在未经身份验证的利用方式

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-27925 是 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 中存在的路径遍历漏洞。攻击者可以通过 mboximport 功能上传包含恶意路径的 ZIP 压缩包，从而将任意文件写入系统。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码尝试利用该漏洞上传 Webshell 或反弹 Shell。代码中包含了构建恶意 ZIP 压缩包的函数 `build_zip`，以及发送 POST 请求的 `exploit` 函数。POC代码利用了mboximport接口上传zip文件，实现了文件上传和RCE。

**投毒风险：**
虽然 POC 代码本身旨在利用漏洞，但存在一定的投毒风险。代码中存在 webshell 的定义，如果攻击者在未经授权的情况下修改了代码，可以替换 webshell 的内容，例如添加恶意代码或后门，从而在成功利用漏洞后进行进一步的恶意活动。但代码整体较为简单，且目标明确，可以判断投毒风险较低。

**利用方式：**
1.  攻击者首先需要构建一个包含恶意路径的 ZIP 压缩包。恶意路径指向 Web 目录下，例如 `../../../../opt/zimbra/jetty/webapps/zimbraAdmin/webshell.jsp`。
2.  攻击者使用 `mboximport` 功能上传此 ZIP 压缩包。如果上传成功，Zimbra 会将 ZIP 压缩包中的文件解压到指定的路径，从而将 Webshell 写入系统。
3.  攻击者通过访问 Webshell 的 URL 来执行任意命令。

**利用流程总结：**

   1.  **构造恶意 ZIP 文件：** ZIP 文件内部包含精心构造的文件路径，使其在解压时能够写入到目标目录（通常是 Web 服务器的可访问目录）。文件内容为 Webshell 代码（例如JSP代码）。
   2.  **利用 `mboximport` 上传：**  利用 Zimbra 的 `mboximport` 功能，将构造好的恶意 ZIP 文件上传到服务器。
   3.  **路径遍历：**  `mboximport` 解压 ZIP 文件时，由于没有充分验证文件路径，导致路径遍历漏洞，恶意文件被写入到指定目录。
   4.  **访问 Webshell：**  攻击者可以通过 Web 浏览器访问上传的 Webshell 文件，从而执行任意命令。

根据搜索结果，此漏洞已经被广泛利用，并存在未经身份验证的利用方式，因此修复此漏洞至关重要。

**项目地址:** [touchmycrazyredhat/CVE-2022-27925-Revshell](https://github.com/touchmycrazyredhat/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

## POC #12

**来源**: [CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md](../2022/CVE-2022-27925-vnhacker1337_CVE-2022-27925-PoC.md)

## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2022-27925 允许经过身份验证的 Zimbra 管理员用户通过上传包含恶意路径的 ZIP 档案，将文件写入文件系统上的任意位置。漏洞利用方式如下：

1.  **身份验证：** 首先，攻击者需要获得 Zimbra 管理员帐户的凭据。
2.  **构造恶意 ZIP 档案：** 攻击者创建一个 ZIP 档案，其中包含恶意文件，该文件的名称包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）。该文件实际上是一个Webshell。
3.  **上传 ZIP 档案：** 攻击者使用 `mboximport` 功能上传构造的 ZIP 档案。
4.  **利用路径遍历：** Zimbra 解压缩该档案时，路径遍历序列会将文件写入到目标目录中，覆盖或创建文件。
5.  **远程代码执行：** 如果攻击者成功将webshell写入到Web目录，可以通过访问webshell执行任意代码。

`zimbra-exploit.py` 脚本通过构造包含路径遍历的恶意ZIP文件，并利用 `mboximport` 功能上传到服务器，实现任意文件写入。脚本首先替换了 `exploit_path` 变量中的 email。之后循环遍历 `exploit_path`, 通过 POST 请求，将恶意ZIP文件 (`shell_list` 中的 `.zip` 文件)上传到目标服务器。上传成功后，脚本会尝试访问上传的webshell路径 `/zimbraAdmin/cmd.jsp`，检测webshell是否上传成功。

**有效性：** 根据搜索结果和漏洞利用代码，可以判断该POC代码是有效的，可以利用路径遍历漏洞实现任意文件上传。

**投毒风险：** 分析提供的 `zimbra-exploit.py` 脚本，没有发现明显的恶意代码或者后门。该脚本的功能主要是利用路径遍历漏洞上传webshell。因此，该仓库中存在投毒代码的风险较低。

**项目地址:** [vnhacker1337/CVE-2022-27925-PoC](https://github.com/vnhacker1337/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)

---

