# CVE-2022-1386

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #2

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**来源**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF(服务器端请求伪造)

**影响应用:** Fusion Builder

**危害等级:** 高危，可能导致内部网络信息泄露，访问内部服务

**影响版本:** < 3.6.2

**利用条件:** 目标站点使用了存在漏洞版本的Fusion Builder插件，且未对请求进行严格的验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386是Fusion Builder插件3.6.2版本之前存在的一个未授权的SSRF漏洞。由于插件未对用户提供的参数进行充分验证，攻击者可以构造恶意请求，使得服务器代表攻击者向任意地址发起请求。根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞利用方式：** 攻击者通过构造包含恶意URL的HTTP请求，发送到存在漏洞的WordPress站点。
2.  **SSRF攻击：** 服务器接收到请求后，会尝试访问攻击者指定的URL，而攻击者可以利用这一点访问内部网络服务，绕过防火墙，读取敏感信息，甚至执行远程命令。
3.  **潜在影响：**
    *   扫描内部网络：攻击者可以扫描内部网络，发现潜在的攻击目标。
    *   访问内部服务：攻击者可以访问内部数据库、管理后台等服务，窃取或篡改数据。
    *   读取敏感文件：攻击者可以读取服务器上的敏感文件，如配置文件、密钥等。
4.  **POC有效性：** 根据漏洞信息，可以构建一个包含目标URL的HTTP请求发送到存在漏洞的服务器。如果服务器返回了目标URL的内容，则表明漏洞利用成功。
5.  **投毒风险：** 提供的代码片段是Apache License 2.0的许可证，没有发现恶意代码，投毒风险为0%。

**项目地址:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**来源**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**来源**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder WordPress plugin (Avada theme)

**危害等级:** 高危，可能允许未授权的攻击者扫描内网，访问内部服务，绕过防火墙和访问控制。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且存在可访问的wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Fusion Builder插件的表单处理逻辑中，由于未充分验证用户提供的URL参数，攻击者可以利用`wp-admin/admin-ajax.php`接口发起SSRF攻击。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。多个来源（NVD、WPScan、Checkmarx等）确认了CVE-2022-1386的存在，并描述了其SSRF的性质。提供的脚本`fubucker.sh`和`single-exploiter.sh`旨在自动化检测和利用该漏洞。脚本通过构造包含恶意URL的POST请求发送到`wp-admin/admin-ajax.php`，并检查响应来确定漏洞是否存在。

**投毒风险：**

`fubucker.sh`脚本的投毒风险评估为10%。虽然脚本本身看起来像是为了利用SSRF漏洞而设计的，但需要谨慎评估。脚本依赖于从目标站点获取`fusion_id`的值，如果攻击者控制了脚本，可能存在以下投毒方式：

*   **修改Payload URL:** 攻击者可以修改脚本中的`fusionAction`参数（如`https://pastebin.com/raw/VaxXtjGV`），指向一个恶意的payload地址，例如包含恶意JavaScript代码或尝试利用其他漏洞的服务器。
*   **修改请求参数:** 攻击者可以修改请求中的其他参数，例如添加额外的请求头或修改数据，以实现更复杂的攻击。
*   **记录目标信息:** 攻击者可以修改脚本，将扫描的目标URL和结果发送到其控制的服务器，从而收集敏感信息。
*   **依赖外部服务:** 虽然脚本使用了`pastebin.com`作为示例，但这使得payload执行依赖于该服务的可用性和内容。若`pastebin`被恶意修改，则会影响所有使用此脚本的目标。

鉴于脚本的开放性和可修改性，以及潜在的恶意利用方式，用户应谨慎使用，并在运行前仔细审查代码。

**利用方式：**

1.  **确定目标：** 寻找安装了Fusion Builder插件（3.6.2版本之前）的WordPress网站。
2.  **获取`fusion_id`：** 通过向`wp-admin/admin-ajax.php`发送`action=fusion_form_update_view`请求获取`fusion-form-nonce-0`的值。
3.  **构造恶意请求：** 使用获取的`fusion_id`构造POST请求，设置`action=fusion_form_submit_form_to_url`，并将`fusionAction`参数设置为攻击者想要访问的内部或外部URL。
4.  **发送请求：** 将构造的请求发送到`wp-admin/admin-ajax.php`。
5.  **分析响应：** 检查响应内容，验证是否成功发起了SSRF攻击。如果服务器返回了目标URL的内容，则表明漏洞存在。

通过SSRF，攻击者可以执行以下操作：

*   **端口扫描：** 扫描目标服务器的内部网络，查找开放的端口和服务。
*   **访问内部服务：** 访问只有内部网络才能访问的服务，例如数据库、管理面板等。
*   **读取本地文件：** 在某些情况下，可以读取服务器上的本地文件。
*   **远程代码执行：** 如果内部服务存在漏洞，攻击者可以通过SSRF利用这些漏洞，最终实现远程代码执行。

**项目地址:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**来源**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**来源**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

