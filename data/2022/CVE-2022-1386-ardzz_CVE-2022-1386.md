# CVE-2022-1386

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

# CVE-2022-1386

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2022-1386-ardzz_CVE-2022-1386.md](../2022/CVE-2022-1386-ardzz_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPress plugin (Avada theme)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…éƒ¨ç½‘ç»œä¿¡æ¯æ³„éœ²ã€å†…éƒ¨æœåŠ¡æ”»å‡»ã€ç»•è¿‡é˜²ç«å¢™ç­‰

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ç‰ˆæœ¬ï¼Œä¸”å…è®¸æœªæˆæƒè®¿é—®wp-admin/admin-ajax.php

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´å‘æœåŠ¡å™¨å‘èµ·ä»»æ„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¿”å›çš„æ•°æ®åæ˜ åœ¨åº”ç”¨ç¨‹åºçš„å“åº”ä¸­ã€‚è¿™å¯ä»¥ç”¨äºä¸æœåŠ¡å™¨æœ¬åœ°ç½‘ç»œä¸Šçš„ä¸»æœºè¿›è¡Œäº¤äº’ï¼Œç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC ä»£ç é€šè¿‡æ„é€ ç‰¹å®šçš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php` å¹¶åˆ©ç”¨ `fusion_form_submit_form_to_url` action å’Œ `fusionAction` å‚æ•°æ³¨å…¥æ¶æ„ URLï¼Œå®ç°äº† SSRFã€‚

**æŠ•æ¯’é£é™©ï¼š**

POC ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨ SSRF æ¼æ´ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **`test_url`å˜é‡:**  POC ä¸­å®šä¹‰äº†ä¸€ä¸ª `test_url = "https://pastebin.com/raw/XNBxNyaU"`ï¼Œè™½ç„¶å½“å‰ä»£ç ä¸­å¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¿™ä¸ª URLï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨åˆ©ç”¨è¿‡ç¨‹ä¸­å°è¯•ä»è¯¥ URL ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚ä½†å¦‚æœä¸æ˜¯æœ¬äººè¿è¡Œæ­¤poc,å¯ä»¥å¿½ç•¥ã€‚
*   **è¾“å‡ºä¿å­˜ï¼š** POCå°†Fusion ID ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…è·å¾—æœåŠ¡å™¨æƒé™å¯ä»¥ä¿®æ”¹ä¿å­˜çš„å†…å®¹ã€‚
*   **ä¾èµ–åº“é£é™©:** ä½¿ç”¨äº† `requests` å’Œ `BeautifulSoup` åº“ï¼Œéœ€è¦ç¡®ä¿è¿™äº›åº“æœ¬èº«æ²¡æœ‰å®‰å…¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è·å– Fusion IDï¼š** POC é¦–å…ˆå°è¯•ä»æœ¬åœ°æ–‡ä»¶åŠ è½½ Fusion IDã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ª POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ï¼Œä½¿ç”¨ `action=fusion_form_update_view` æ¥è·å– `fusion-form-nonce-0` çš„å€¼ï¼Œè¯¥å€¼è¢«ç”¨ä½œ Fusion IDï¼Œå¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** POC ä½¿ç”¨ `encode_multipart_form_data` å‡½æ•°æ„é€ ä¸€ä¸ª `multipart/form-data` è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å…³é”®å‚æ•°ï¼š
    *   `fusionAction`: è¿™æ˜¯åŒ…å«æ¶æ„ URL çš„å‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥å°†ç›®æ ‡ URL è®¾ç½®ä¸ºå†…éƒ¨æœåŠ¡åœ°å€ã€å¤–éƒ¨æ¶æ„æœåŠ¡å™¨ç­‰ã€‚
    *   `fusionActionMethod`: è®¾ç½®ä¸º `GET`ï¼ŒæŒ‡å®šä½¿ç”¨ GET æ–¹æ³•å‘èµ·è¯·æ±‚ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** POC å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ° `/wp-admin/admin-ajax.php`ï¼Œå¹¶å°è¯•è§£æå“åº”çš„ JSON æ•°æ®ã€‚å¦‚æœå“åº”ä¸æ˜¯æœ‰æ•ˆçš„ JSONï¼Œåˆ™è¿”å›ä¸€ä¸ªè¡¨ç¤ºå¤±è´¥çš„å­—å…¸ã€‚

é€šè¿‡ä¿®æ”¹ `fusionAction` å‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥æ§åˆ¶æœåŠ¡å™¨å‘èµ·ä»»æ„ HTTP è¯·æ±‚ï¼Œä»è€Œå®ç° SSRF æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [ardzz/CVE-2022-1386](https://github.com/ardzz/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #2

**æ¥æº**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…éƒ¨ç½‘ç»œä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªå¯¹è¯·æ±‚è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386æ˜¯Fusion Builderæ’ä»¶3.6.2ç‰ˆæœ¬ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªæœªæˆæƒçš„SSRFæ¼æ´ã€‚ç”±äºæ’ä»¶æœªå¯¹ç”¨æˆ·æä¾›çš„å‚æ•°è¿›è¡Œå……åˆ†éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿å¾—æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…å‘ä»»æ„åœ°å€å‘èµ·è¯·æ±‚ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚
2.  **SSRFæ”»å‡»ï¼š** æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°è¯•è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„URLï¼Œè€Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™ï¼Œè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚
3.  **æ½œåœ¨å½±å“ï¼š**
    *   æ‰«æå†…éƒ¨ç½‘ç»œï¼šæ”»å‡»è€…å¯ä»¥æ‰«æå†…éƒ¨ç½‘ç»œï¼Œå‘ç°æ½œåœ¨çš„æ”»å‡»ç›®æ ‡ã€‚
    *   è®¿é—®å†…éƒ¨æœåŠ¡ï¼šæ”»å‡»è€…å¯ä»¥è®¿é—®å†…éƒ¨æ•°æ®åº“ã€ç®¡ç†åå°ç­‰æœåŠ¡ï¼Œçªƒå–æˆ–ç¯¡æ”¹æ•°æ®ã€‚
    *   è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼šæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å¯†é’¥ç­‰ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªåŒ…å«ç›®æ ‡URLçš„HTTPè¯·æ±‚å‘é€åˆ°å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´åˆ©ç”¨æˆåŠŸã€‚
5.  **æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç ç‰‡æ®µæ˜¯Apache License 2.0çš„è®¸å¯è¯ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**æ¥æº**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 â€“ Fusion Builder < 3.6.2 - Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€å†…ç½‘æœåŠ¡æ”»å‡»ï¼Œç»•è¿‡é˜²ç«å¢™ç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å¯ä»¥é€šè¿‡HTTPè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å°äº 3.6.2 ç‰ˆæœ¬ä¸­å­˜åœ¨çš„æœªç»èº«ä»½éªŒè¯çš„æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ `admin-ajax.php` å‘é€ç‰¹åˆ¶çš„ POST è¯·æ±‚ï¼Œåˆ©ç”¨æ­¤æ¼æ´å‘ä»»æ„ URL å‘é€ HTTP è¯·æ±‚ã€‚ç”±äºè¯¥è¯·æ±‚æ˜¯ä»æœåŠ¡å™¨ç«¯å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚è·å– AWS EC2 å…ƒæ•°æ®ï¼Œæ‰«æå†…éƒ¨ç«¯å£ç­‰ã€‚PoC è„šæœ¬é¦–å…ˆä»ç›®æ ‡ç«™ç‚¹è·å–ä¸€ä¸ª nonce å€¼ï¼Œç„¶åä½¿ç”¨è¯¥ nonce å€¼æ„é€ ä¸€ä¸ª multipart/form-data æ ¼å¼çš„ POST è¯·æ±‚ï¼Œå…¶ä¸­ `fusionAction` å‚æ•°åŒ…å«è¦è¯·æ±‚çš„ URLã€‚è¯¥è¯·æ±‚è¢«å‘é€åˆ° `admin-ajax.php` ç«¯ç‚¹ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚ URL çš„å†…å®¹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨äº†ç±»ä¼¼ Interact.sh è¿™æ ·çš„å›è°ƒæœåŠ¡ï¼Œåˆ™ä¼šæ”¶åˆ°æ¥è‡ªå—å®³æœåŠ¡å™¨çš„å›è°ƒã€‚è¯¥PoCæœ¬èº«æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ,åªæ˜¯åˆ©ç”¨äº†SSRFæ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**æ¥æº**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPress plugin (Avada theme)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒçš„æ”»å‡»è€…æ‰«æå†…ç½‘ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºFusion Builderæ’ä»¶çš„è¡¨å•å¤„ç†é€»è¾‘ä¸­ï¼Œç”±äºæœªå……åˆ†éªŒè¯ç”¨æˆ·æä¾›çš„URLå‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`wp-admin/admin-ajax.php`æ¥å£å‘èµ·SSRFæ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºï¼ˆNVDã€WPScanã€Checkmarxç­‰ï¼‰ç¡®è®¤äº†CVE-2022-1386çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶SSRFçš„æ€§è´¨ã€‚æä¾›çš„è„šæœ¬`fubucker.sh`å’Œ`single-exploiter.sh`æ—¨åœ¨è‡ªåŠ¨åŒ–æ£€æµ‹å’Œåˆ©ç”¨è¯¥æ¼æ´ã€‚è„šæœ¬é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„POSTè¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ï¼Œå¹¶æ£€æŸ¥å“åº”æ¥ç¡®å®šæ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`fubucker.sh`è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚è™½ç„¶è„šæœ¬æœ¬èº«çœ‹èµ·æ¥åƒæ˜¯ä¸ºäº†åˆ©ç”¨SSRFæ¼æ´è€Œè®¾è®¡çš„ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚è„šæœ¬ä¾èµ–äºä»ç›®æ ‡ç«™ç‚¹è·å–`fusion_id`çš„å€¼ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è„šæœ¬ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹æŠ•æ¯’æ–¹å¼ï¼š

*   **ä¿®æ”¹Payload URL:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„`fusionAction`å‚æ•°ï¼ˆå¦‚`https://pastebin.com/raw/VaxXtjGV`ï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªæ¶æ„çš„payloadåœ°å€ï¼Œä¾‹å¦‚åŒ…å«æ¶æ„JavaScriptä»£ç æˆ–å°è¯•åˆ©ç”¨å…¶ä»–æ¼æ´çš„æœåŠ¡å™¨ã€‚
*   **ä¿®æ”¹è¯·æ±‚å‚æ•°:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚ä¸­çš„å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚æ·»åŠ é¢å¤–çš„è¯·æ±‚å¤´æˆ–ä¿®æ”¹æ•°æ®ï¼Œä»¥å®ç°æ›´å¤æ‚çš„æ”»å‡»ã€‚
*   **è®°å½•ç›®æ ‡ä¿¡æ¯:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ï¼Œå°†æ‰«æçš„ç›®æ ‡URLå’Œç»“æœå‘é€åˆ°å…¶æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œä»è€Œæ”¶é›†æ•æ„Ÿä¿¡æ¯ã€‚
*   **ä¾èµ–å¤–éƒ¨æœåŠ¡:** è™½ç„¶è„šæœ¬ä½¿ç”¨äº†`pastebin.com`ä½œä¸ºç¤ºä¾‹ï¼Œä½†è¿™ä½¿å¾—payloadæ‰§è¡Œä¾èµ–äºè¯¥æœåŠ¡çš„å¯ç”¨æ€§å’Œå†…å®¹ã€‚è‹¥`pastebin`è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™ä¼šå½±å“æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„ç›®æ ‡ã€‚

é‰´äºè„šæœ¬çš„å¼€æ”¾æ€§å’Œå¯ä¿®æ”¹æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ¶æ„åˆ©ç”¨æ–¹å¼ï¼Œç”¨æˆ·åº”è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨è¿è¡Œå‰ä»”ç»†å®¡æŸ¥ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** å¯»æ‰¾å®‰è£…äº†Fusion Builderæ’ä»¶ï¼ˆ3.6.2ç‰ˆæœ¬ä¹‹å‰ï¼‰çš„WordPressç½‘ç«™ã€‚
2.  **è·å–`fusion_id`ï¼š** é€šè¿‡å‘`wp-admin/admin-ajax.php`å‘é€`action=fusion_form_update_view`è¯·æ±‚è·å–`fusion-form-nonce-0`çš„å€¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨è·å–çš„`fusion_id`æ„é€ POSTè¯·æ±‚ï¼Œè®¾ç½®`action=fusion_form_submit_form_to_url`ï¼Œå¹¶å°†`fusionAction`å‚æ•°è®¾ç½®ä¸ºæ”»å‡»è€…æƒ³è¦è®¿é—®çš„å†…éƒ¨æˆ–å¤–éƒ¨URLã€‚
4.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ã€‚
5.  **åˆ†æå“åº”ï¼š** æ£€æŸ¥å“åº”å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸå‘èµ·äº†SSRFæ”»å‡»ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

é€šè¿‡SSRFï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

*   **ç«¯å£æ‰«æï¼š** æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ã€‚
*   **è®¿é—®å†…éƒ¨æœåŠ¡ï¼š** è®¿é—®åªæœ‰å†…éƒ¨ç½‘ç»œæ‰èƒ½è®¿é—®çš„æœåŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“ã€ç®¡ç†é¢æ¿ç­‰ã€‚
*   **è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š** åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** å¦‚æœå†…éƒ¨æœåŠ¡å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡SSRFåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**æ¥æº**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF (æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€ç«¯å£æ‰«æã€ç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå¦‚æœå†…ç½‘å­˜åœ¨æœªæˆæƒçš„æœåŠ¡ï¼‰

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„/wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ `fusionAction` å‚æ•°ï¼Œå‘èµ·ä»»æ„ HTTP è¯·æ±‚ã€‚ç”±äºè¯·æ±‚æ˜¯ç”±æœåŠ¡å™¨å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† `fusion_form_submit_form_to_url` actionï¼Œé€šè¿‡ä¿®æ”¹ `fusionAction` å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚POC ä»£ç é¦–å…ˆå°è¯•è·å– `fusion_id`ï¼Œå¦‚æœæœ¬åœ°ä¸å­˜åœ¨åˆ™é€šè¿‡è®¿é—® `/wp-admin/admin-ajax.php` æ¥è·å–ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ç„¶åï¼Œå®ƒæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ URL çš„ POST è¯·æ±‚ï¼Œå‘é€åˆ° `/wp-admin/admin-ajax.php`ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå‘æ”»å‡»è€…æŒ‡å®šçš„ URL å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚ å› æ­¤ï¼Œæä¾›çš„POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„`exploit.py`è„šæœ¬ï¼Œå‘ç°å¤§éƒ¨åˆ†ä»£ç ç”¨äºæ„å»ºå’Œå‘é€ SSRF è¯·æ±‚ï¼Œä»¥åŠå¤„ç† WordPress çš„è®¤è¯ç»•è¿‡ã€‚å…¶ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

1. **`make_folder()` å‡½æ•°:** åˆ›å»ºåä¸º `output` çš„æ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ã€‚è™½ç„¶è¿™æœ¬èº«ä¸æ˜¯æ¶æ„è¡Œä¸ºï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ webshellã€‚é£é™©è¾ƒä½ã€‚
2. **`save_fusion_id()` å’Œ `load_fusion_id()` å‡½æ•°:**  ç”¨äºä¿å­˜å’ŒåŠ è½½ `fusion_id`ã€‚ å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†è¿™äº›å‡½æ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ï¼Œä½†ä¸ä¼šç›´æ¥æ„æˆå®‰å…¨å¨èƒã€‚ é£é™©è¾ƒä½ã€‚
3. **Payloadçš„æ„å»º:** æ”»å‡»è€…å¯èƒ½ä¼šåœ¨æ„é€ payloadæ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚å°è¯•æ‰§è¡Œå‘½ä»¤æˆ–å†™å…¥æ–‡ä»¶ã€‚è™½ç„¶POCæœ¬èº«æ²¡æœ‰å±•ç¤ºï¼Œä½†æ˜¯åˆ©ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚é£é™©ä¸­ç­‰ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚ä¸»è¦æ˜¯åˆ©ç”¨ç°æœ‰çš„SSRFæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨ Avada ä¸»é¢˜å’Œ Fusion Builder æ’ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä½äº 3.6.2ã€‚
2.  è¿è¡Œ POC ä»£ç ï¼ŒæŒ‡å®šç›®æ ‡ç½‘ç«™çš„ URL å’Œè¦è®¿é—®çš„å†…éƒ¨èµ„æº (ä¾‹å¦‚ï¼š`http://127.0.0.1:8080`) ä½œä¸º payloadã€‚
3.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†å‘æŒ‡å®šçš„å†…éƒ¨èµ„æºå‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰«æå†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ï¼Œæˆ–è€…åˆ©ç”¨å†…éƒ¨æœåŠ¡ä¸­çš„æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**æ¥æº**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPressæ’ä»¶ (Avadaä¸»é¢˜)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€å†…ç½‘æ‰«æã€ç»•è¿‡é˜²ç«å¢™è®¿é—®å†…éƒ¨æœåŠ¡ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™å®‰è£…äº†å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªåšSSRFç›¸å…³é˜²å¾¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Fusion Builder WordPress æ’ä»¶ 3.6.2 ä¹‹å‰ç‰ˆæœ¬çš„æœªæˆæƒ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„ HTTP è¯·æ±‚ï¼Œä½¿æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…è®¿é—®å†…éƒ¨æˆ–å¤–éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äº Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ— éœ€èº«ä»½éªŒè¯ã€‚æœç´¢ç»“æœä¸­ä¹Ÿæåˆ°äº†åˆ©ç”¨è¯¥æ¼æ´æ‰«æå†…ç½‘ï¼Œç»•è¿‡é˜²ç«å¢™çš„å¯èƒ½æ€§ã€‚æä¾›çš„ bash è„šæœ¬ `fubucker.sh` ä½¿ç”¨ curl å‘½ä»¤ï¼Œé€šè¿‡å‘ `/wp-admin/admin-ajax.php` å‘é€ POST è¯·æ±‚ï¼Œè§¦å‘ SSRF æ¼æ´ã€‚è„šæœ¬é¦–å…ˆè·å– `fusion-form-nonce` å€¼ï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ `fusionAction` çš„è¯·æ±‚ï¼Œ`fusionAction` æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨URLï¼Œå¦‚ `https://pastebin.com/raw/VaxXtjGV`ã€‚æœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚æ­¤URLï¼Œå¹¶å°†ç»“æœè¿”å›ï¼Œæ”»å‡»è€…ä¾¿å¯åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡ŒSSRFã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„åˆ©ç”¨é€»è¾‘æ˜¯ SSRFï¼Œä½†è„šæœ¬ä¸­å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ä»¥ä¸‹åˆ†æ:
* é¦–å…ˆè„šæœ¬åˆ›å»º `vuln.txt` å’Œ `notvuln.txt` æ–‡ä»¶ï¼Œç”¨äºè®°å½•å­˜åœ¨æ¼æ´å’Œä¸å­˜åœ¨æ¼æ´çš„ URLã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸æ“ä½œï¼Œç”¨äºæ‰«æç»“æœçš„ç»Ÿè®¡å’Œæ•´ç†ã€‚
* è„šæœ¬é€šè¿‡ `--insecure` å‚æ•°ç¦ç”¨ SSL è¯ä¹¦éªŒè¯ï¼Œå¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¦‚æœè„šæœ¬æ‰§è¡Œè€…ä¸æ³¨æ„ï¼Œå¯èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
* æœ€ä¸»è¦çš„æ½œåœ¨é£é™©åœ¨äº `fusionAction=https://pastebin.com/raw/VaxXtjGV`ã€‚è„šæœ¬ç›´æ¥ä» pastebin ä¸‹è½½ payloadã€‚å¦‚æœ pastebin ä¸Šçš„å†…å®¹è¢«æ¶æ„ä¿®æ”¹ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ pastebin ä¸Šçš„payloadä¸­åŒ…å«ä»»æ„æ¶æ„ä»£ç ï¼ˆå¦‚åå¼¹shellç­‰ï¼‰ã€‚è™½ç„¶å½“å‰ pastebin çš„å†…å®¹å¯èƒ½æ— å®³ï¼Œä½†æœªæ¥å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨bashè„šæœ¬æ‰¹é‡æ‰§è¡Œç«™ç‚¹æ”»å‡»ï¼Œå®¹æ˜“é€ æˆå¤§é‡ç«™ç‚¹è®¿é—®ï¼Œå±äºéæˆæƒè¡Œä¸ºã€‚

ç»¼åˆä»¥ä¸Šå› ç´ ï¼Œè™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯SSRFæ£€æµ‹ï¼Œä½†æ¥è‡ªå¤–éƒ¨ pastebin çš„ payload å¼•å…¥äº†ä¸ç¡®å®šæ€§ï¼Œå› æ­¤å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º 20%ã€‚å¤§éƒ¨åˆ†ä»£ç é€»è¾‘æ­£å¸¸ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨å¤–éƒ¨èµ„æºçš„ä¾èµ–ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ WordPress ç½‘ç«™ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Fusion Builder æ’ä»¶ (ç‰ˆæœ¬ < 3.6.2)ã€‚**
2.  **è¿è¡Œæä¾›çš„ `fubucker.sh` è„šæœ¬ï¼ŒæŒ‡å®šåŒ…å«ç›®æ ‡ URL åˆ—è¡¨çš„æ–‡ä»¶å’Œçº¿ç¨‹æ•°ã€‚**
3.  **è„šæœ¬ä¼šè‡ªåŠ¨å‘é€åŒ…å«æ¶æ„ `fusionAction` å‚æ•°çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ã€‚**
4.  **å¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚ `fusionAction` æŒ‡å®šçš„ URLï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚**
5.  **æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ†æè¿”å›çš„ç»“æœï¼Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ©ç”¨ SSRF æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œå¦‚å†…ç½‘ç«¯å£æ‰«æã€è¯»å–å†…ç½‘æœåŠ¡ç­‰ã€‚**


**é¡¹ç›®åœ°å€:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**æ¥æº**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…éƒ¨ç½‘ç»œä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªå¯¹è¯·æ±‚è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386æ˜¯Fusion Builderæ’ä»¶3.6.2ç‰ˆæœ¬ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªæœªæˆæƒçš„SSRFæ¼æ´ã€‚ç”±äºæ’ä»¶æœªå¯¹ç”¨æˆ·æä¾›çš„å‚æ•°è¿›è¡Œå……åˆ†éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿å¾—æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…å‘ä»»æ„åœ°å€å‘èµ·è¯·æ±‚ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚
2.  **SSRFæ”»å‡»ï¼š** æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°è¯•è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„URLï¼Œè€Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™ï¼Œè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚
3.  **æ½œåœ¨å½±å“ï¼š**
    *   æ‰«æå†…éƒ¨ç½‘ç»œï¼šæ”»å‡»è€…å¯ä»¥æ‰«æå†…éƒ¨ç½‘ç»œï¼Œå‘ç°æ½œåœ¨çš„æ”»å‡»ç›®æ ‡ã€‚
    *   è®¿é—®å†…éƒ¨æœåŠ¡ï¼šæ”»å‡»è€…å¯ä»¥è®¿é—®å†…éƒ¨æ•°æ®åº“ã€ç®¡ç†åå°ç­‰æœåŠ¡ï¼Œçªƒå–æˆ–ç¯¡æ”¹æ•°æ®ã€‚
    *   è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼šæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å¯†é’¥ç­‰ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªåŒ…å«ç›®æ ‡URLçš„HTTPè¯·æ±‚å‘é€åˆ°å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´åˆ©ç”¨æˆåŠŸã€‚
5.  **æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç ç‰‡æ®µæ˜¯Apache License 2.0çš„è®¸å¯è¯ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**æ¥æº**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 â€“ Fusion Builder < 3.6.2 - Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€å†…ç½‘æœåŠ¡æ”»å‡»ï¼Œç»•è¿‡é˜²ç«å¢™ç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å¯ä»¥é€šè¿‡HTTPè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å°äº 3.6.2 ç‰ˆæœ¬ä¸­å­˜åœ¨çš„æœªç»èº«ä»½éªŒè¯çš„æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ `admin-ajax.php` å‘é€ç‰¹åˆ¶çš„ POST è¯·æ±‚ï¼Œåˆ©ç”¨æ­¤æ¼æ´å‘ä»»æ„ URL å‘é€ HTTP è¯·æ±‚ã€‚ç”±äºè¯¥è¯·æ±‚æ˜¯ä»æœåŠ¡å™¨ç«¯å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚è·å– AWS EC2 å…ƒæ•°æ®ï¼Œæ‰«æå†…éƒ¨ç«¯å£ç­‰ã€‚PoC è„šæœ¬é¦–å…ˆä»ç›®æ ‡ç«™ç‚¹è·å–ä¸€ä¸ª nonce å€¼ï¼Œç„¶åä½¿ç”¨è¯¥ nonce å€¼æ„é€ ä¸€ä¸ª multipart/form-data æ ¼å¼çš„ POST è¯·æ±‚ï¼Œå…¶ä¸­ `fusionAction` å‚æ•°åŒ…å«è¦è¯·æ±‚çš„ URLã€‚è¯¥è¯·æ±‚è¢«å‘é€åˆ° `admin-ajax.php` ç«¯ç‚¹ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚ URL çš„å†…å®¹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨äº†ç±»ä¼¼ Interact.sh è¿™æ ·çš„å›è°ƒæœåŠ¡ï¼Œåˆ™ä¼šæ”¶åˆ°æ¥è‡ªå—å®³æœåŠ¡å™¨çš„å›è°ƒã€‚è¯¥PoCæœ¬èº«æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ,åªæ˜¯åˆ©ç”¨äº†SSRFæ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**æ¥æº**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPress plugin (Avada theme)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒçš„æ”»å‡»è€…æ‰«æå†…ç½‘ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºFusion Builderæ’ä»¶çš„è¡¨å•å¤„ç†é€»è¾‘ä¸­ï¼Œç”±äºæœªå……åˆ†éªŒè¯ç”¨æˆ·æä¾›çš„URLå‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`wp-admin/admin-ajax.php`æ¥å£å‘èµ·SSRFæ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºï¼ˆNVDã€WPScanã€Checkmarxç­‰ï¼‰ç¡®è®¤äº†CVE-2022-1386çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶SSRFçš„æ€§è´¨ã€‚æä¾›çš„è„šæœ¬`fubucker.sh`å’Œ`single-exploiter.sh`æ—¨åœ¨è‡ªåŠ¨åŒ–æ£€æµ‹å’Œåˆ©ç”¨è¯¥æ¼æ´ã€‚è„šæœ¬é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„POSTè¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ï¼Œå¹¶æ£€æŸ¥å“åº”æ¥ç¡®å®šæ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`fubucker.sh`è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚è™½ç„¶è„šæœ¬æœ¬èº«çœ‹èµ·æ¥åƒæ˜¯ä¸ºäº†åˆ©ç”¨SSRFæ¼æ´è€Œè®¾è®¡çš„ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚è„šæœ¬ä¾èµ–äºä»ç›®æ ‡ç«™ç‚¹è·å–`fusion_id`çš„å€¼ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è„šæœ¬ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹æŠ•æ¯’æ–¹å¼ï¼š

*   **ä¿®æ”¹Payload URL:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„`fusionAction`å‚æ•°ï¼ˆå¦‚`https://pastebin.com/raw/VaxXtjGV`ï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªæ¶æ„çš„payloadåœ°å€ï¼Œä¾‹å¦‚åŒ…å«æ¶æ„JavaScriptä»£ç æˆ–å°è¯•åˆ©ç”¨å…¶ä»–æ¼æ´çš„æœåŠ¡å™¨ã€‚
*   **ä¿®æ”¹è¯·æ±‚å‚æ•°:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚ä¸­çš„å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚æ·»åŠ é¢å¤–çš„è¯·æ±‚å¤´æˆ–ä¿®æ”¹æ•°æ®ï¼Œä»¥å®ç°æ›´å¤æ‚çš„æ”»å‡»ã€‚
*   **è®°å½•ç›®æ ‡ä¿¡æ¯:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ï¼Œå°†æ‰«æçš„ç›®æ ‡URLå’Œç»“æœå‘é€åˆ°å…¶æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œä»è€Œæ”¶é›†æ•æ„Ÿä¿¡æ¯ã€‚
*   **ä¾èµ–å¤–éƒ¨æœåŠ¡:** è™½ç„¶è„šæœ¬ä½¿ç”¨äº†`pastebin.com`ä½œä¸ºç¤ºä¾‹ï¼Œä½†è¿™ä½¿å¾—payloadæ‰§è¡Œä¾èµ–äºè¯¥æœåŠ¡çš„å¯ç”¨æ€§å’Œå†…å®¹ã€‚è‹¥`pastebin`è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™ä¼šå½±å“æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„ç›®æ ‡ã€‚

é‰´äºè„šæœ¬çš„å¼€æ”¾æ€§å’Œå¯ä¿®æ”¹æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ¶æ„åˆ©ç”¨æ–¹å¼ï¼Œç”¨æˆ·åº”è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨è¿è¡Œå‰ä»”ç»†å®¡æŸ¥ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** å¯»æ‰¾å®‰è£…äº†Fusion Builderæ’ä»¶ï¼ˆ3.6.2ç‰ˆæœ¬ä¹‹å‰ï¼‰çš„WordPressç½‘ç«™ã€‚
2.  **è·å–`fusion_id`ï¼š** é€šè¿‡å‘`wp-admin/admin-ajax.php`å‘é€`action=fusion_form_update_view`è¯·æ±‚è·å–`fusion-form-nonce-0`çš„å€¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨è·å–çš„`fusion_id`æ„é€ POSTè¯·æ±‚ï¼Œè®¾ç½®`action=fusion_form_submit_form_to_url`ï¼Œå¹¶å°†`fusionAction`å‚æ•°è®¾ç½®ä¸ºæ”»å‡»è€…æƒ³è¦è®¿é—®çš„å†…éƒ¨æˆ–å¤–éƒ¨URLã€‚
4.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ã€‚
5.  **åˆ†æå“åº”ï¼š** æ£€æŸ¥å“åº”å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸå‘èµ·äº†SSRFæ”»å‡»ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

é€šè¿‡SSRFï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

*   **ç«¯å£æ‰«æï¼š** æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ã€‚
*   **è®¿é—®å†…éƒ¨æœåŠ¡ï¼š** è®¿é—®åªæœ‰å†…éƒ¨ç½‘ç»œæ‰èƒ½è®¿é—®çš„æœåŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“ã€ç®¡ç†é¢æ¿ç­‰ã€‚
*   **è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š** åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** å¦‚æœå†…éƒ¨æœåŠ¡å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡SSRFåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**æ¥æº**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF (æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€ç«¯å£æ‰«æã€ç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå¦‚æœå†…ç½‘å­˜åœ¨æœªæˆæƒçš„æœåŠ¡ï¼‰

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„/wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ `fusionAction` å‚æ•°ï¼Œå‘èµ·ä»»æ„ HTTP è¯·æ±‚ã€‚ç”±äºè¯·æ±‚æ˜¯ç”±æœåŠ¡å™¨å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† `fusion_form_submit_form_to_url` actionï¼Œé€šè¿‡ä¿®æ”¹ `fusionAction` å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚POC ä»£ç é¦–å…ˆå°è¯•è·å– `fusion_id`ï¼Œå¦‚æœæœ¬åœ°ä¸å­˜åœ¨åˆ™é€šè¿‡è®¿é—® `/wp-admin/admin-ajax.php` æ¥è·å–ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ç„¶åï¼Œå®ƒæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ URL çš„ POST è¯·æ±‚ï¼Œå‘é€åˆ° `/wp-admin/admin-ajax.php`ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå‘æ”»å‡»è€…æŒ‡å®šçš„ URL å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚ å› æ­¤ï¼Œæä¾›çš„POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„`exploit.py`è„šæœ¬ï¼Œå‘ç°å¤§éƒ¨åˆ†ä»£ç ç”¨äºæ„å»ºå’Œå‘é€ SSRF è¯·æ±‚ï¼Œä»¥åŠå¤„ç† WordPress çš„è®¤è¯ç»•è¿‡ã€‚å…¶ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

1. **`make_folder()` å‡½æ•°:** åˆ›å»ºåä¸º `output` çš„æ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ã€‚è™½ç„¶è¿™æœ¬èº«ä¸æ˜¯æ¶æ„è¡Œä¸ºï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ webshellã€‚é£é™©è¾ƒä½ã€‚
2. **`save_fusion_id()` å’Œ `load_fusion_id()` å‡½æ•°:**  ç”¨äºä¿å­˜å’ŒåŠ è½½ `fusion_id`ã€‚ å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†è¿™äº›å‡½æ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ï¼Œä½†ä¸ä¼šç›´æ¥æ„æˆå®‰å…¨å¨èƒã€‚ é£é™©è¾ƒä½ã€‚
3. **Payloadçš„æ„å»º:** æ”»å‡»è€…å¯èƒ½ä¼šåœ¨æ„é€ payloadæ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚å°è¯•æ‰§è¡Œå‘½ä»¤æˆ–å†™å…¥æ–‡ä»¶ã€‚è™½ç„¶POCæœ¬èº«æ²¡æœ‰å±•ç¤ºï¼Œä½†æ˜¯åˆ©ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚é£é™©ä¸­ç­‰ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚ä¸»è¦æ˜¯åˆ©ç”¨ç°æœ‰çš„SSRFæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨ Avada ä¸»é¢˜å’Œ Fusion Builder æ’ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä½äº 3.6.2ã€‚
2.  è¿è¡Œ POC ä»£ç ï¼ŒæŒ‡å®šç›®æ ‡ç½‘ç«™çš„ URL å’Œè¦è®¿é—®çš„å†…éƒ¨èµ„æº (ä¾‹å¦‚ï¼š`http://127.0.0.1:8080`) ä½œä¸º payloadã€‚
3.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†å‘æŒ‡å®šçš„å†…éƒ¨èµ„æºå‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰«æå†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ï¼Œæˆ–è€…åˆ©ç”¨å†…éƒ¨æœåŠ¡ä¸­çš„æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**æ¥æº**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPressæ’ä»¶ (Avadaä¸»é¢˜)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€å†…ç½‘æ‰«æã€ç»•è¿‡é˜²ç«å¢™è®¿é—®å†…éƒ¨æœåŠ¡ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™å®‰è£…äº†å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªåšSSRFç›¸å…³é˜²å¾¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Fusion Builder WordPress æ’ä»¶ 3.6.2 ä¹‹å‰ç‰ˆæœ¬çš„æœªæˆæƒ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„ HTTP è¯·æ±‚ï¼Œä½¿æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…è®¿é—®å†…éƒ¨æˆ–å¤–éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äº Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ— éœ€èº«ä»½éªŒè¯ã€‚æœç´¢ç»“æœä¸­ä¹Ÿæåˆ°äº†åˆ©ç”¨è¯¥æ¼æ´æ‰«æå†…ç½‘ï¼Œç»•è¿‡é˜²ç«å¢™çš„å¯èƒ½æ€§ã€‚æä¾›çš„ bash è„šæœ¬ `fubucker.sh` ä½¿ç”¨ curl å‘½ä»¤ï¼Œé€šè¿‡å‘ `/wp-admin/admin-ajax.php` å‘é€ POST è¯·æ±‚ï¼Œè§¦å‘ SSRF æ¼æ´ã€‚è„šæœ¬é¦–å…ˆè·å– `fusion-form-nonce` å€¼ï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ `fusionAction` çš„è¯·æ±‚ï¼Œ`fusionAction` æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨URLï¼Œå¦‚ `https://pastebin.com/raw/VaxXtjGV`ã€‚æœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚æ­¤URLï¼Œå¹¶å°†ç»“æœè¿”å›ï¼Œæ”»å‡»è€…ä¾¿å¯åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡ŒSSRFã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„åˆ©ç”¨é€»è¾‘æ˜¯ SSRFï¼Œä½†è„šæœ¬ä¸­å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ä»¥ä¸‹åˆ†æ:
* é¦–å…ˆè„šæœ¬åˆ›å»º `vuln.txt` å’Œ `notvuln.txt` æ–‡ä»¶ï¼Œç”¨äºè®°å½•å­˜åœ¨æ¼æ´å’Œä¸å­˜åœ¨æ¼æ´çš„ URLã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸æ“ä½œï¼Œç”¨äºæ‰«æç»“æœçš„ç»Ÿè®¡å’Œæ•´ç†ã€‚
* è„šæœ¬é€šè¿‡ `--insecure` å‚æ•°ç¦ç”¨ SSL è¯ä¹¦éªŒè¯ï¼Œå¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¦‚æœè„šæœ¬æ‰§è¡Œè€…ä¸æ³¨æ„ï¼Œå¯èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
* æœ€ä¸»è¦çš„æ½œåœ¨é£é™©åœ¨äº `fusionAction=https://pastebin.com/raw/VaxXtjGV`ã€‚è„šæœ¬ç›´æ¥ä» pastebin ä¸‹è½½ payloadã€‚å¦‚æœ pastebin ä¸Šçš„å†…å®¹è¢«æ¶æ„ä¿®æ”¹ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ pastebin ä¸Šçš„payloadä¸­åŒ…å«ä»»æ„æ¶æ„ä»£ç ï¼ˆå¦‚åå¼¹shellç­‰ï¼‰ã€‚è™½ç„¶å½“å‰ pastebin çš„å†…å®¹å¯èƒ½æ— å®³ï¼Œä½†æœªæ¥å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨bashè„šæœ¬æ‰¹é‡æ‰§è¡Œç«™ç‚¹æ”»å‡»ï¼Œå®¹æ˜“é€ æˆå¤§é‡ç«™ç‚¹è®¿é—®ï¼Œå±äºéæˆæƒè¡Œä¸ºã€‚

ç»¼åˆä»¥ä¸Šå› ç´ ï¼Œè™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯SSRFæ£€æµ‹ï¼Œä½†æ¥è‡ªå¤–éƒ¨ pastebin çš„ payload å¼•å…¥äº†ä¸ç¡®å®šæ€§ï¼Œå› æ­¤å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º 20%ã€‚å¤§éƒ¨åˆ†ä»£ç é€»è¾‘æ­£å¸¸ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨å¤–éƒ¨èµ„æºçš„ä¾èµ–ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ WordPress ç½‘ç«™ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Fusion Builder æ’ä»¶ (ç‰ˆæœ¬ < 3.6.2)ã€‚**
2.  **è¿è¡Œæä¾›çš„ `fubucker.sh` è„šæœ¬ï¼ŒæŒ‡å®šåŒ…å«ç›®æ ‡ URL åˆ—è¡¨çš„æ–‡ä»¶å’Œçº¿ç¨‹æ•°ã€‚**
3.  **è„šæœ¬ä¼šè‡ªåŠ¨å‘é€åŒ…å«æ¶æ„ `fusionAction` å‚æ•°çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ã€‚**
4.  **å¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚ `fusionAction` æŒ‡å®šçš„ URLï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚**
5.  **æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ†æè¿”å›çš„ç»“æœï¼Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ©ç”¨ SSRF æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œå¦‚å†…ç½‘ç«¯å£æ‰«æã€è¯»å–å†…ç½‘æœåŠ¡ç­‰ã€‚**


**é¡¹ç›®åœ°å€:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**æ¥æº**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…éƒ¨ç½‘ç»œä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªå¯¹è¯·æ±‚è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386æ˜¯Fusion Builderæ’ä»¶3.6.2ç‰ˆæœ¬ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªæœªæˆæƒçš„SSRFæ¼æ´ã€‚ç”±äºæ’ä»¶æœªå¯¹ç”¨æˆ·æä¾›çš„å‚æ•°è¿›è¡Œå……åˆ†éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿å¾—æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…å‘ä»»æ„åœ°å€å‘èµ·è¯·æ±‚ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚
2.  **SSRFæ”»å‡»ï¼š** æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°è¯•è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„URLï¼Œè€Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™ï¼Œè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚
3.  **æ½œåœ¨å½±å“ï¼š**
    *   æ‰«æå†…éƒ¨ç½‘ç»œï¼šæ”»å‡»è€…å¯ä»¥æ‰«æå†…éƒ¨ç½‘ç»œï¼Œå‘ç°æ½œåœ¨çš„æ”»å‡»ç›®æ ‡ã€‚
    *   è®¿é—®å†…éƒ¨æœåŠ¡ï¼šæ”»å‡»è€…å¯ä»¥è®¿é—®å†…éƒ¨æ•°æ®åº“ã€ç®¡ç†åå°ç­‰æœåŠ¡ï¼Œçªƒå–æˆ–ç¯¡æ”¹æ•°æ®ã€‚
    *   è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼šæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å¯†é’¥ç­‰ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªåŒ…å«ç›®æ ‡URLçš„HTTPè¯·æ±‚å‘é€åˆ°å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´åˆ©ç”¨æˆåŠŸã€‚
5.  **æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç ç‰‡æ®µæ˜¯Apache License 2.0çš„è®¸å¯è¯ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**æ¥æº**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 â€“ Fusion Builder < 3.6.2 - Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€å†…ç½‘æœåŠ¡æ”»å‡»ï¼Œç»•è¿‡é˜²ç«å¢™ç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å¯ä»¥é€šè¿‡HTTPè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å°äº 3.6.2 ç‰ˆæœ¬ä¸­å­˜åœ¨çš„æœªç»èº«ä»½éªŒè¯çš„æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ `admin-ajax.php` å‘é€ç‰¹åˆ¶çš„ POST è¯·æ±‚ï¼Œåˆ©ç”¨æ­¤æ¼æ´å‘ä»»æ„ URL å‘é€ HTTP è¯·æ±‚ã€‚ç”±äºè¯¥è¯·æ±‚æ˜¯ä»æœåŠ¡å™¨ç«¯å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚è·å– AWS EC2 å…ƒæ•°æ®ï¼Œæ‰«æå†…éƒ¨ç«¯å£ç­‰ã€‚PoC è„šæœ¬é¦–å…ˆä»ç›®æ ‡ç«™ç‚¹è·å–ä¸€ä¸ª nonce å€¼ï¼Œç„¶åä½¿ç”¨è¯¥ nonce å€¼æ„é€ ä¸€ä¸ª multipart/form-data æ ¼å¼çš„ POST è¯·æ±‚ï¼Œå…¶ä¸­ `fusionAction` å‚æ•°åŒ…å«è¦è¯·æ±‚çš„ URLã€‚è¯¥è¯·æ±‚è¢«å‘é€åˆ° `admin-ajax.php` ç«¯ç‚¹ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚ URL çš„å†…å®¹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨äº†ç±»ä¼¼ Interact.sh è¿™æ ·çš„å›è°ƒæœåŠ¡ï¼Œåˆ™ä¼šæ”¶åˆ°æ¥è‡ªå—å®³æœåŠ¡å™¨çš„å›è°ƒã€‚è¯¥PoCæœ¬èº«æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ,åªæ˜¯åˆ©ç”¨äº†SSRFæ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**æ¥æº**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPress plugin (Avada theme)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒçš„æ”»å‡»è€…æ‰«æå†…ç½‘ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºFusion Builderæ’ä»¶çš„è¡¨å•å¤„ç†é€»è¾‘ä¸­ï¼Œç”±äºæœªå……åˆ†éªŒè¯ç”¨æˆ·æä¾›çš„URLå‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`wp-admin/admin-ajax.php`æ¥å£å‘èµ·SSRFæ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºï¼ˆNVDã€WPScanã€Checkmarxç­‰ï¼‰ç¡®è®¤äº†CVE-2022-1386çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶SSRFçš„æ€§è´¨ã€‚æä¾›çš„è„šæœ¬`fubucker.sh`å’Œ`single-exploiter.sh`æ—¨åœ¨è‡ªåŠ¨åŒ–æ£€æµ‹å’Œåˆ©ç”¨è¯¥æ¼æ´ã€‚è„šæœ¬é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„POSTè¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ï¼Œå¹¶æ£€æŸ¥å“åº”æ¥ç¡®å®šæ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`fubucker.sh`è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚è™½ç„¶è„šæœ¬æœ¬èº«çœ‹èµ·æ¥åƒæ˜¯ä¸ºäº†åˆ©ç”¨SSRFæ¼æ´è€Œè®¾è®¡çš„ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚è„šæœ¬ä¾èµ–äºä»ç›®æ ‡ç«™ç‚¹è·å–`fusion_id`çš„å€¼ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è„šæœ¬ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹æŠ•æ¯’æ–¹å¼ï¼š

*   **ä¿®æ”¹Payload URL:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„`fusionAction`å‚æ•°ï¼ˆå¦‚`https://pastebin.com/raw/VaxXtjGV`ï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªæ¶æ„çš„payloadåœ°å€ï¼Œä¾‹å¦‚åŒ…å«æ¶æ„JavaScriptä»£ç æˆ–å°è¯•åˆ©ç”¨å…¶ä»–æ¼æ´çš„æœåŠ¡å™¨ã€‚
*   **ä¿®æ”¹è¯·æ±‚å‚æ•°:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚ä¸­çš„å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚æ·»åŠ é¢å¤–çš„è¯·æ±‚å¤´æˆ–ä¿®æ”¹æ•°æ®ï¼Œä»¥å®ç°æ›´å¤æ‚çš„æ”»å‡»ã€‚
*   **è®°å½•ç›®æ ‡ä¿¡æ¯:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ï¼Œå°†æ‰«æçš„ç›®æ ‡URLå’Œç»“æœå‘é€åˆ°å…¶æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œä»è€Œæ”¶é›†æ•æ„Ÿä¿¡æ¯ã€‚
*   **ä¾èµ–å¤–éƒ¨æœåŠ¡:** è™½ç„¶è„šæœ¬ä½¿ç”¨äº†`pastebin.com`ä½œä¸ºç¤ºä¾‹ï¼Œä½†è¿™ä½¿å¾—payloadæ‰§è¡Œä¾èµ–äºè¯¥æœåŠ¡çš„å¯ç”¨æ€§å’Œå†…å®¹ã€‚è‹¥`pastebin`è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™ä¼šå½±å“æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„ç›®æ ‡ã€‚

é‰´äºè„šæœ¬çš„å¼€æ”¾æ€§å’Œå¯ä¿®æ”¹æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ¶æ„åˆ©ç”¨æ–¹å¼ï¼Œç”¨æˆ·åº”è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨è¿è¡Œå‰ä»”ç»†å®¡æŸ¥ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** å¯»æ‰¾å®‰è£…äº†Fusion Builderæ’ä»¶ï¼ˆ3.6.2ç‰ˆæœ¬ä¹‹å‰ï¼‰çš„WordPressç½‘ç«™ã€‚
2.  **è·å–`fusion_id`ï¼š** é€šè¿‡å‘`wp-admin/admin-ajax.php`å‘é€`action=fusion_form_update_view`è¯·æ±‚è·å–`fusion-form-nonce-0`çš„å€¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨è·å–çš„`fusion_id`æ„é€ POSTè¯·æ±‚ï¼Œè®¾ç½®`action=fusion_form_submit_form_to_url`ï¼Œå¹¶å°†`fusionAction`å‚æ•°è®¾ç½®ä¸ºæ”»å‡»è€…æƒ³è¦è®¿é—®çš„å†…éƒ¨æˆ–å¤–éƒ¨URLã€‚
4.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ã€‚
5.  **åˆ†æå“åº”ï¼š** æ£€æŸ¥å“åº”å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸå‘èµ·äº†SSRFæ”»å‡»ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

é€šè¿‡SSRFï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

*   **ç«¯å£æ‰«æï¼š** æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ã€‚
*   **è®¿é—®å†…éƒ¨æœåŠ¡ï¼š** è®¿é—®åªæœ‰å†…éƒ¨ç½‘ç»œæ‰èƒ½è®¿é—®çš„æœåŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“ã€ç®¡ç†é¢æ¿ç­‰ã€‚
*   **è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š** åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** å¦‚æœå†…éƒ¨æœåŠ¡å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡SSRFåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**æ¥æº**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF (æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€ç«¯å£æ‰«æã€ç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå¦‚æœå†…ç½‘å­˜åœ¨æœªæˆæƒçš„æœåŠ¡ï¼‰

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„/wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ `fusionAction` å‚æ•°ï¼Œå‘èµ·ä»»æ„ HTTP è¯·æ±‚ã€‚ç”±äºè¯·æ±‚æ˜¯ç”±æœåŠ¡å™¨å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† `fusion_form_submit_form_to_url` actionï¼Œé€šè¿‡ä¿®æ”¹ `fusionAction` å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚POC ä»£ç é¦–å…ˆå°è¯•è·å– `fusion_id`ï¼Œå¦‚æœæœ¬åœ°ä¸å­˜åœ¨åˆ™é€šè¿‡è®¿é—® `/wp-admin/admin-ajax.php` æ¥è·å–ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ç„¶åï¼Œå®ƒæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ URL çš„ POST è¯·æ±‚ï¼Œå‘é€åˆ° `/wp-admin/admin-ajax.php`ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå‘æ”»å‡»è€…æŒ‡å®šçš„ URL å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚ å› æ­¤ï¼Œæä¾›çš„POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„`exploit.py`è„šæœ¬ï¼Œå‘ç°å¤§éƒ¨åˆ†ä»£ç ç”¨äºæ„å»ºå’Œå‘é€ SSRF è¯·æ±‚ï¼Œä»¥åŠå¤„ç† WordPress çš„è®¤è¯ç»•è¿‡ã€‚å…¶ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

1. **`make_folder()` å‡½æ•°:** åˆ›å»ºåä¸º `output` çš„æ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ã€‚è™½ç„¶è¿™æœ¬èº«ä¸æ˜¯æ¶æ„è¡Œä¸ºï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ webshellã€‚é£é™©è¾ƒä½ã€‚
2. **`save_fusion_id()` å’Œ `load_fusion_id()` å‡½æ•°:**  ç”¨äºä¿å­˜å’ŒåŠ è½½ `fusion_id`ã€‚ å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†è¿™äº›å‡½æ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ï¼Œä½†ä¸ä¼šç›´æ¥æ„æˆå®‰å…¨å¨èƒã€‚ é£é™©è¾ƒä½ã€‚
3. **Payloadçš„æ„å»º:** æ”»å‡»è€…å¯èƒ½ä¼šåœ¨æ„é€ payloadæ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚å°è¯•æ‰§è¡Œå‘½ä»¤æˆ–å†™å…¥æ–‡ä»¶ã€‚è™½ç„¶POCæœ¬èº«æ²¡æœ‰å±•ç¤ºï¼Œä½†æ˜¯åˆ©ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚é£é™©ä¸­ç­‰ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚ä¸»è¦æ˜¯åˆ©ç”¨ç°æœ‰çš„SSRFæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨ Avada ä¸»é¢˜å’Œ Fusion Builder æ’ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä½äº 3.6.2ã€‚
2.  è¿è¡Œ POC ä»£ç ï¼ŒæŒ‡å®šç›®æ ‡ç½‘ç«™çš„ URL å’Œè¦è®¿é—®çš„å†…éƒ¨èµ„æº (ä¾‹å¦‚ï¼š`http://127.0.0.1:8080`) ä½œä¸º payloadã€‚
3.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†å‘æŒ‡å®šçš„å†…éƒ¨èµ„æºå‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰«æå†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ï¼Œæˆ–è€…åˆ©ç”¨å†…éƒ¨æœåŠ¡ä¸­çš„æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**æ¥æº**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPressæ’ä»¶ (Avadaä¸»é¢˜)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€å†…ç½‘æ‰«æã€ç»•è¿‡é˜²ç«å¢™è®¿é—®å†…éƒ¨æœåŠ¡ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™å®‰è£…äº†å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªåšSSRFç›¸å…³é˜²å¾¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Fusion Builder WordPress æ’ä»¶ 3.6.2 ä¹‹å‰ç‰ˆæœ¬çš„æœªæˆæƒ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„ HTTP è¯·æ±‚ï¼Œä½¿æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…è®¿é—®å†…éƒ¨æˆ–å¤–éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äº Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ— éœ€èº«ä»½éªŒè¯ã€‚æœç´¢ç»“æœä¸­ä¹Ÿæåˆ°äº†åˆ©ç”¨è¯¥æ¼æ´æ‰«æå†…ç½‘ï¼Œç»•è¿‡é˜²ç«å¢™çš„å¯èƒ½æ€§ã€‚æä¾›çš„ bash è„šæœ¬ `fubucker.sh` ä½¿ç”¨ curl å‘½ä»¤ï¼Œé€šè¿‡å‘ `/wp-admin/admin-ajax.php` å‘é€ POST è¯·æ±‚ï¼Œè§¦å‘ SSRF æ¼æ´ã€‚è„šæœ¬é¦–å…ˆè·å– `fusion-form-nonce` å€¼ï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ `fusionAction` çš„è¯·æ±‚ï¼Œ`fusionAction` æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨URLï¼Œå¦‚ `https://pastebin.com/raw/VaxXtjGV`ã€‚æœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚æ­¤URLï¼Œå¹¶å°†ç»“æœè¿”å›ï¼Œæ”»å‡»è€…ä¾¿å¯åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡ŒSSRFã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„åˆ©ç”¨é€»è¾‘æ˜¯ SSRFï¼Œä½†è„šæœ¬ä¸­å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ä»¥ä¸‹åˆ†æ:
* é¦–å…ˆè„šæœ¬åˆ›å»º `vuln.txt` å’Œ `notvuln.txt` æ–‡ä»¶ï¼Œç”¨äºè®°å½•å­˜åœ¨æ¼æ´å’Œä¸å­˜åœ¨æ¼æ´çš„ URLã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸æ“ä½œï¼Œç”¨äºæ‰«æç»“æœçš„ç»Ÿè®¡å’Œæ•´ç†ã€‚
* è„šæœ¬é€šè¿‡ `--insecure` å‚æ•°ç¦ç”¨ SSL è¯ä¹¦éªŒè¯ï¼Œå¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¦‚æœè„šæœ¬æ‰§è¡Œè€…ä¸æ³¨æ„ï¼Œå¯èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
* æœ€ä¸»è¦çš„æ½œåœ¨é£é™©åœ¨äº `fusionAction=https://pastebin.com/raw/VaxXtjGV`ã€‚è„šæœ¬ç›´æ¥ä» pastebin ä¸‹è½½ payloadã€‚å¦‚æœ pastebin ä¸Šçš„å†…å®¹è¢«æ¶æ„ä¿®æ”¹ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ pastebin ä¸Šçš„payloadä¸­åŒ…å«ä»»æ„æ¶æ„ä»£ç ï¼ˆå¦‚åå¼¹shellç­‰ï¼‰ã€‚è™½ç„¶å½“å‰ pastebin çš„å†…å®¹å¯èƒ½æ— å®³ï¼Œä½†æœªæ¥å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨bashè„šæœ¬æ‰¹é‡æ‰§è¡Œç«™ç‚¹æ”»å‡»ï¼Œå®¹æ˜“é€ æˆå¤§é‡ç«™ç‚¹è®¿é—®ï¼Œå±äºéæˆæƒè¡Œä¸ºã€‚

ç»¼åˆä»¥ä¸Šå› ç´ ï¼Œè™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯SSRFæ£€æµ‹ï¼Œä½†æ¥è‡ªå¤–éƒ¨ pastebin çš„ payload å¼•å…¥äº†ä¸ç¡®å®šæ€§ï¼Œå› æ­¤å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º 20%ã€‚å¤§éƒ¨åˆ†ä»£ç é€»è¾‘æ­£å¸¸ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨å¤–éƒ¨èµ„æºçš„ä¾èµ–ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ WordPress ç½‘ç«™ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Fusion Builder æ’ä»¶ (ç‰ˆæœ¬ < 3.6.2)ã€‚**
2.  **è¿è¡Œæä¾›çš„ `fubucker.sh` è„šæœ¬ï¼ŒæŒ‡å®šåŒ…å«ç›®æ ‡ URL åˆ—è¡¨çš„æ–‡ä»¶å’Œçº¿ç¨‹æ•°ã€‚**
3.  **è„šæœ¬ä¼šè‡ªåŠ¨å‘é€åŒ…å«æ¶æ„ `fusionAction` å‚æ•°çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ã€‚**
4.  **å¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚ `fusionAction` æŒ‡å®šçš„ URLï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚**
5.  **æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ†æè¿”å›çš„ç»“æœï¼Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ©ç”¨ SSRF æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œå¦‚å†…ç½‘ç«¯å£æ‰«æã€è¯»å–å†…ç½‘æœåŠ¡ç­‰ã€‚**


**é¡¹ç›®åœ°å€:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**æ¥æº**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…éƒ¨ç½‘ç»œä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªå¯¹è¯·æ±‚è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386æ˜¯Fusion Builderæ’ä»¶3.6.2ç‰ˆæœ¬ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªæœªæˆæƒçš„SSRFæ¼æ´ã€‚ç”±äºæ’ä»¶æœªå¯¹ç”¨æˆ·æä¾›çš„å‚æ•°è¿›è¡Œå……åˆ†éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿å¾—æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…å‘ä»»æ„åœ°å€å‘èµ·è¯·æ±‚ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚
2.  **SSRFæ”»å‡»ï¼š** æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°è¯•è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„URLï¼Œè€Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™ï¼Œè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚
3.  **æ½œåœ¨å½±å“ï¼š**
    *   æ‰«æå†…éƒ¨ç½‘ç»œï¼šæ”»å‡»è€…å¯ä»¥æ‰«æå†…éƒ¨ç½‘ç»œï¼Œå‘ç°æ½œåœ¨çš„æ”»å‡»ç›®æ ‡ã€‚
    *   è®¿é—®å†…éƒ¨æœåŠ¡ï¼šæ”»å‡»è€…å¯ä»¥è®¿é—®å†…éƒ¨æ•°æ®åº“ã€ç®¡ç†åå°ç­‰æœåŠ¡ï¼Œçªƒå–æˆ–ç¯¡æ”¹æ•°æ®ã€‚
    *   è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼šæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å¯†é’¥ç­‰ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªåŒ…å«ç›®æ ‡URLçš„HTTPè¯·æ±‚å‘é€åˆ°å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´åˆ©ç”¨æˆåŠŸã€‚
5.  **æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç ç‰‡æ®µæ˜¯Apache License 2.0çš„è®¸å¯è¯ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**æ¥æº**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 â€“ Fusion Builder < 3.6.2 - Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€å†…ç½‘æœåŠ¡æ”»å‡»ï¼Œç»•è¿‡é˜²ç«å¢™ç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å¯ä»¥é€šè¿‡HTTPè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å°äº 3.6.2 ç‰ˆæœ¬ä¸­å­˜åœ¨çš„æœªç»èº«ä»½éªŒè¯çš„æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ `admin-ajax.php` å‘é€ç‰¹åˆ¶çš„ POST è¯·æ±‚ï¼Œåˆ©ç”¨æ­¤æ¼æ´å‘ä»»æ„ URL å‘é€ HTTP è¯·æ±‚ã€‚ç”±äºè¯¥è¯·æ±‚æ˜¯ä»æœåŠ¡å™¨ç«¯å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚è·å– AWS EC2 å…ƒæ•°æ®ï¼Œæ‰«æå†…éƒ¨ç«¯å£ç­‰ã€‚PoC è„šæœ¬é¦–å…ˆä»ç›®æ ‡ç«™ç‚¹è·å–ä¸€ä¸ª nonce å€¼ï¼Œç„¶åä½¿ç”¨è¯¥ nonce å€¼æ„é€ ä¸€ä¸ª multipart/form-data æ ¼å¼çš„ POST è¯·æ±‚ï¼Œå…¶ä¸­ `fusionAction` å‚æ•°åŒ…å«è¦è¯·æ±‚çš„ URLã€‚è¯¥è¯·æ±‚è¢«å‘é€åˆ° `admin-ajax.php` ç«¯ç‚¹ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚ URL çš„å†…å®¹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨äº†ç±»ä¼¼ Interact.sh è¿™æ ·çš„å›è°ƒæœåŠ¡ï¼Œåˆ™ä¼šæ”¶åˆ°æ¥è‡ªå—å®³æœåŠ¡å™¨çš„å›è°ƒã€‚è¯¥PoCæœ¬èº«æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ,åªæ˜¯åˆ©ç”¨äº†SSRFæ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**æ¥æº**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPress plugin (Avada theme)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒçš„æ”»å‡»è€…æ‰«æå†…ç½‘ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºFusion Builderæ’ä»¶çš„è¡¨å•å¤„ç†é€»è¾‘ä¸­ï¼Œç”±äºæœªå……åˆ†éªŒè¯ç”¨æˆ·æä¾›çš„URLå‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`wp-admin/admin-ajax.php`æ¥å£å‘èµ·SSRFæ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºï¼ˆNVDã€WPScanã€Checkmarxç­‰ï¼‰ç¡®è®¤äº†CVE-2022-1386çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶SSRFçš„æ€§è´¨ã€‚æä¾›çš„è„šæœ¬`fubucker.sh`å’Œ`single-exploiter.sh`æ—¨åœ¨è‡ªåŠ¨åŒ–æ£€æµ‹å’Œåˆ©ç”¨è¯¥æ¼æ´ã€‚è„šæœ¬é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„POSTè¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ï¼Œå¹¶æ£€æŸ¥å“åº”æ¥ç¡®å®šæ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`fubucker.sh`è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚è™½ç„¶è„šæœ¬æœ¬èº«çœ‹èµ·æ¥åƒæ˜¯ä¸ºäº†åˆ©ç”¨SSRFæ¼æ´è€Œè®¾è®¡çš„ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚è„šæœ¬ä¾èµ–äºä»ç›®æ ‡ç«™ç‚¹è·å–`fusion_id`çš„å€¼ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è„šæœ¬ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹æŠ•æ¯’æ–¹å¼ï¼š

*   **ä¿®æ”¹Payload URL:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„`fusionAction`å‚æ•°ï¼ˆå¦‚`https://pastebin.com/raw/VaxXtjGV`ï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªæ¶æ„çš„payloadåœ°å€ï¼Œä¾‹å¦‚åŒ…å«æ¶æ„JavaScriptä»£ç æˆ–å°è¯•åˆ©ç”¨å…¶ä»–æ¼æ´çš„æœåŠ¡å™¨ã€‚
*   **ä¿®æ”¹è¯·æ±‚å‚æ•°:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚ä¸­çš„å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚æ·»åŠ é¢å¤–çš„è¯·æ±‚å¤´æˆ–ä¿®æ”¹æ•°æ®ï¼Œä»¥å®ç°æ›´å¤æ‚çš„æ”»å‡»ã€‚
*   **è®°å½•ç›®æ ‡ä¿¡æ¯:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ï¼Œå°†æ‰«æçš„ç›®æ ‡URLå’Œç»“æœå‘é€åˆ°å…¶æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œä»è€Œæ”¶é›†æ•æ„Ÿä¿¡æ¯ã€‚
*   **ä¾èµ–å¤–éƒ¨æœåŠ¡:** è™½ç„¶è„šæœ¬ä½¿ç”¨äº†`pastebin.com`ä½œä¸ºç¤ºä¾‹ï¼Œä½†è¿™ä½¿å¾—payloadæ‰§è¡Œä¾èµ–äºè¯¥æœåŠ¡çš„å¯ç”¨æ€§å’Œå†…å®¹ã€‚è‹¥`pastebin`è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™ä¼šå½±å“æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„ç›®æ ‡ã€‚

é‰´äºè„šæœ¬çš„å¼€æ”¾æ€§å’Œå¯ä¿®æ”¹æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ¶æ„åˆ©ç”¨æ–¹å¼ï¼Œç”¨æˆ·åº”è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨è¿è¡Œå‰ä»”ç»†å®¡æŸ¥ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** å¯»æ‰¾å®‰è£…äº†Fusion Builderæ’ä»¶ï¼ˆ3.6.2ç‰ˆæœ¬ä¹‹å‰ï¼‰çš„WordPressç½‘ç«™ã€‚
2.  **è·å–`fusion_id`ï¼š** é€šè¿‡å‘`wp-admin/admin-ajax.php`å‘é€`action=fusion_form_update_view`è¯·æ±‚è·å–`fusion-form-nonce-0`çš„å€¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨è·å–çš„`fusion_id`æ„é€ POSTè¯·æ±‚ï¼Œè®¾ç½®`action=fusion_form_submit_form_to_url`ï¼Œå¹¶å°†`fusionAction`å‚æ•°è®¾ç½®ä¸ºæ”»å‡»è€…æƒ³è¦è®¿é—®çš„å†…éƒ¨æˆ–å¤–éƒ¨URLã€‚
4.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ã€‚
5.  **åˆ†æå“åº”ï¼š** æ£€æŸ¥å“åº”å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸå‘èµ·äº†SSRFæ”»å‡»ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

é€šè¿‡SSRFï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

*   **ç«¯å£æ‰«æï¼š** æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ã€‚
*   **è®¿é—®å†…éƒ¨æœåŠ¡ï¼š** è®¿é—®åªæœ‰å†…éƒ¨ç½‘ç»œæ‰èƒ½è®¿é—®çš„æœåŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“ã€ç®¡ç†é¢æ¿ç­‰ã€‚
*   **è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š** åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** å¦‚æœå†…éƒ¨æœåŠ¡å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡SSRFåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**æ¥æº**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF (æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€ç«¯å£æ‰«æã€ç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå¦‚æœå†…ç½‘å­˜åœ¨æœªæˆæƒçš„æœåŠ¡ï¼‰

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„/wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ `fusionAction` å‚æ•°ï¼Œå‘èµ·ä»»æ„ HTTP è¯·æ±‚ã€‚ç”±äºè¯·æ±‚æ˜¯ç”±æœåŠ¡å™¨å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† `fusion_form_submit_form_to_url` actionï¼Œé€šè¿‡ä¿®æ”¹ `fusionAction` å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚POC ä»£ç é¦–å…ˆå°è¯•è·å– `fusion_id`ï¼Œå¦‚æœæœ¬åœ°ä¸å­˜åœ¨åˆ™é€šè¿‡è®¿é—® `/wp-admin/admin-ajax.php` æ¥è·å–ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ç„¶åï¼Œå®ƒæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ URL çš„ POST è¯·æ±‚ï¼Œå‘é€åˆ° `/wp-admin/admin-ajax.php`ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå‘æ”»å‡»è€…æŒ‡å®šçš„ URL å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚ å› æ­¤ï¼Œæä¾›çš„POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„`exploit.py`è„šæœ¬ï¼Œå‘ç°å¤§éƒ¨åˆ†ä»£ç ç”¨äºæ„å»ºå’Œå‘é€ SSRF è¯·æ±‚ï¼Œä»¥åŠå¤„ç† WordPress çš„è®¤è¯ç»•è¿‡ã€‚å…¶ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

1. **`make_folder()` å‡½æ•°:** åˆ›å»ºåä¸º `output` çš„æ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ã€‚è™½ç„¶è¿™æœ¬èº«ä¸æ˜¯æ¶æ„è¡Œä¸ºï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ webshellã€‚é£é™©è¾ƒä½ã€‚
2. **`save_fusion_id()` å’Œ `load_fusion_id()` å‡½æ•°:**  ç”¨äºä¿å­˜å’ŒåŠ è½½ `fusion_id`ã€‚ å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†è¿™äº›å‡½æ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ï¼Œä½†ä¸ä¼šç›´æ¥æ„æˆå®‰å…¨å¨èƒã€‚ é£é™©è¾ƒä½ã€‚
3. **Payloadçš„æ„å»º:** æ”»å‡»è€…å¯èƒ½ä¼šåœ¨æ„é€ payloadæ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚å°è¯•æ‰§è¡Œå‘½ä»¤æˆ–å†™å…¥æ–‡ä»¶ã€‚è™½ç„¶POCæœ¬èº«æ²¡æœ‰å±•ç¤ºï¼Œä½†æ˜¯åˆ©ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚é£é™©ä¸­ç­‰ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚ä¸»è¦æ˜¯åˆ©ç”¨ç°æœ‰çš„SSRFæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨ Avada ä¸»é¢˜å’Œ Fusion Builder æ’ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä½äº 3.6.2ã€‚
2.  è¿è¡Œ POC ä»£ç ï¼ŒæŒ‡å®šç›®æ ‡ç½‘ç«™çš„ URL å’Œè¦è®¿é—®çš„å†…éƒ¨èµ„æº (ä¾‹å¦‚ï¼š`http://127.0.0.1:8080`) ä½œä¸º payloadã€‚
3.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†å‘æŒ‡å®šçš„å†…éƒ¨èµ„æºå‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰«æå†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ï¼Œæˆ–è€…åˆ©ç”¨å†…éƒ¨æœåŠ¡ä¸­çš„æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**æ¥æº**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPressæ’ä»¶ (Avadaä¸»é¢˜)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€å†…ç½‘æ‰«æã€ç»•è¿‡é˜²ç«å¢™è®¿é—®å†…éƒ¨æœåŠ¡ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™å®‰è£…äº†å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªåšSSRFç›¸å…³é˜²å¾¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Fusion Builder WordPress æ’ä»¶ 3.6.2 ä¹‹å‰ç‰ˆæœ¬çš„æœªæˆæƒ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„ HTTP è¯·æ±‚ï¼Œä½¿æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…è®¿é—®å†…éƒ¨æˆ–å¤–éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äº Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ— éœ€èº«ä»½éªŒè¯ã€‚æœç´¢ç»“æœä¸­ä¹Ÿæåˆ°äº†åˆ©ç”¨è¯¥æ¼æ´æ‰«æå†…ç½‘ï¼Œç»•è¿‡é˜²ç«å¢™çš„å¯èƒ½æ€§ã€‚æä¾›çš„ bash è„šæœ¬ `fubucker.sh` ä½¿ç”¨ curl å‘½ä»¤ï¼Œé€šè¿‡å‘ `/wp-admin/admin-ajax.php` å‘é€ POST è¯·æ±‚ï¼Œè§¦å‘ SSRF æ¼æ´ã€‚è„šæœ¬é¦–å…ˆè·å– `fusion-form-nonce` å€¼ï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ `fusionAction` çš„è¯·æ±‚ï¼Œ`fusionAction` æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨URLï¼Œå¦‚ `https://pastebin.com/raw/VaxXtjGV`ã€‚æœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚æ­¤URLï¼Œå¹¶å°†ç»“æœè¿”å›ï¼Œæ”»å‡»è€…ä¾¿å¯åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡ŒSSRFã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„åˆ©ç”¨é€»è¾‘æ˜¯ SSRFï¼Œä½†è„šæœ¬ä¸­å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ä»¥ä¸‹åˆ†æ:
* é¦–å…ˆè„šæœ¬åˆ›å»º `vuln.txt` å’Œ `notvuln.txt` æ–‡ä»¶ï¼Œç”¨äºè®°å½•å­˜åœ¨æ¼æ´å’Œä¸å­˜åœ¨æ¼æ´çš„ URLã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸æ“ä½œï¼Œç”¨äºæ‰«æç»“æœçš„ç»Ÿè®¡å’Œæ•´ç†ã€‚
* è„šæœ¬é€šè¿‡ `--insecure` å‚æ•°ç¦ç”¨ SSL è¯ä¹¦éªŒè¯ï¼Œå¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¦‚æœè„šæœ¬æ‰§è¡Œè€…ä¸æ³¨æ„ï¼Œå¯èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
* æœ€ä¸»è¦çš„æ½œåœ¨é£é™©åœ¨äº `fusionAction=https://pastebin.com/raw/VaxXtjGV`ã€‚è„šæœ¬ç›´æ¥ä» pastebin ä¸‹è½½ payloadã€‚å¦‚æœ pastebin ä¸Šçš„å†…å®¹è¢«æ¶æ„ä¿®æ”¹ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ pastebin ä¸Šçš„payloadä¸­åŒ…å«ä»»æ„æ¶æ„ä»£ç ï¼ˆå¦‚åå¼¹shellç­‰ï¼‰ã€‚è™½ç„¶å½“å‰ pastebin çš„å†…å®¹å¯èƒ½æ— å®³ï¼Œä½†æœªæ¥å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨bashè„šæœ¬æ‰¹é‡æ‰§è¡Œç«™ç‚¹æ”»å‡»ï¼Œå®¹æ˜“é€ æˆå¤§é‡ç«™ç‚¹è®¿é—®ï¼Œå±äºéæˆæƒè¡Œä¸ºã€‚

ç»¼åˆä»¥ä¸Šå› ç´ ï¼Œè™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯SSRFæ£€æµ‹ï¼Œä½†æ¥è‡ªå¤–éƒ¨ pastebin çš„ payload å¼•å…¥äº†ä¸ç¡®å®šæ€§ï¼Œå› æ­¤å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º 20%ã€‚å¤§éƒ¨åˆ†ä»£ç é€»è¾‘æ­£å¸¸ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨å¤–éƒ¨èµ„æºçš„ä¾èµ–ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ WordPress ç½‘ç«™ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Fusion Builder æ’ä»¶ (ç‰ˆæœ¬ < 3.6.2)ã€‚**
2.  **è¿è¡Œæä¾›çš„ `fubucker.sh` è„šæœ¬ï¼ŒæŒ‡å®šåŒ…å«ç›®æ ‡ URL åˆ—è¡¨çš„æ–‡ä»¶å’Œçº¿ç¨‹æ•°ã€‚**
3.  **è„šæœ¬ä¼šè‡ªåŠ¨å‘é€åŒ…å«æ¶æ„ `fusionAction` å‚æ•°çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ã€‚**
4.  **å¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚ `fusionAction` æŒ‡å®šçš„ URLï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚**
5.  **æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ†æè¿”å›çš„ç»“æœï¼Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ©ç”¨ SSRF æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œå¦‚å†…ç½‘ç«¯å£æ‰«æã€è¯»å–å†…ç½‘æœåŠ¡ç­‰ã€‚**


**é¡¹ç›®åœ°å€:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---



---

## POC #2

**æ¥æº**: [CVE-2022-1386-cur1y-dev_CVE-2022-1386.md](../2022/CVE-2022-1386-cur1y-dev_CVE-2022-1386.md)

## CVE-2022-1386-Fusion Builder-SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…éƒ¨ç½‘ç»œä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«™ç‚¹ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªå¯¹è¯·æ±‚è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386æ˜¯Fusion Builderæ’ä»¶3.6.2ç‰ˆæœ¬ä¹‹å‰å­˜åœ¨çš„ä¸€ä¸ªæœªæˆæƒçš„SSRFæ¼æ´ã€‚ç”±äºæ’ä»¶æœªå¯¹ç”¨æˆ·æä¾›çš„å‚æ•°è¿›è¡Œå……åˆ†éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿å¾—æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…å‘ä»»æ„åœ°å€å‘èµ·è¯·æ±‚ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚
2.  **SSRFæ”»å‡»ï¼š** æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°è¯•è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„URLï¼Œè€Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™ï¼Œè¯»å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚
3.  **æ½œåœ¨å½±å“ï¼š**
    *   æ‰«æå†…éƒ¨ç½‘ç»œï¼šæ”»å‡»è€…å¯ä»¥æ‰«æå†…éƒ¨ç½‘ç»œï¼Œå‘ç°æ½œåœ¨çš„æ”»å‡»ç›®æ ‡ã€‚
    *   è®¿é—®å†…éƒ¨æœåŠ¡ï¼šæ”»å‡»è€…å¯ä»¥è®¿é—®å†…éƒ¨æ•°æ®åº“ã€ç®¡ç†åå°ç­‰æœåŠ¡ï¼Œçªƒå–æˆ–ç¯¡æ”¹æ•°æ®ã€‚
    *   è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼šæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å¯†é’¥ç­‰ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªåŒ…å«ç›®æ ‡URLçš„HTTPè¯·æ±‚å‘é€åˆ°å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´åˆ©ç”¨æˆåŠŸã€‚
5.  **æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç ç‰‡æ®µæ˜¯Apache License 2.0çš„è®¸å¯è¯ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [cur1y-dev/CVE-2022-1386](https://github.com/cur1y-dev/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #3

**æ¥æº**: [CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md](../2022/CVE-2022-1386-fayassgit_CVE-2022-1386-FusionBuilder-SSRF.md)

## CVE-2022-1386 â€“ Fusion Builder < 3.6.2 - Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€å†…ç½‘æœåŠ¡æ”»å‡»ï¼Œç»•è¿‡é˜²ç«å¢™ç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å¯ä»¥é€šè¿‡HTTPè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å°äº 3.6.2 ç‰ˆæœ¬ä¸­å­˜åœ¨çš„æœªç»èº«ä»½éªŒè¯çš„æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ `admin-ajax.php` å‘é€ç‰¹åˆ¶çš„ POST è¯·æ±‚ï¼Œåˆ©ç”¨æ­¤æ¼æ´å‘ä»»æ„ URL å‘é€ HTTP è¯·æ±‚ã€‚ç”±äºè¯¥è¯·æ±‚æ˜¯ä»æœåŠ¡å™¨ç«¯å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚è·å– AWS EC2 å…ƒæ•°æ®ï¼Œæ‰«æå†…éƒ¨ç«¯å£ç­‰ã€‚PoC è„šæœ¬é¦–å…ˆä»ç›®æ ‡ç«™ç‚¹è·å–ä¸€ä¸ª nonce å€¼ï¼Œç„¶åä½¿ç”¨è¯¥ nonce å€¼æ„é€ ä¸€ä¸ª multipart/form-data æ ¼å¼çš„ POST è¯·æ±‚ï¼Œå…¶ä¸­ `fusionAction` å‚æ•°åŒ…å«è¦è¯·æ±‚çš„ URLã€‚è¯¥è¯·æ±‚è¢«å‘é€åˆ° `admin-ajax.php` ç«¯ç‚¹ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚ URL çš„å†…å®¹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨äº†ç±»ä¼¼ Interact.sh è¿™æ ·çš„å›è°ƒæœåŠ¡ï¼Œåˆ™ä¼šæ”¶åˆ°æ¥è‡ªå—å®³æœåŠ¡å™¨çš„å›è°ƒã€‚è¯¥PoCæœ¬èº«æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ,åªæ˜¯åˆ©ç”¨äº†SSRFæ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #4

**æ¥æº**: [CVE-2022-1386-im-hanzou_fubucker.md](../2022/CVE-2022-1386-im-hanzou_fubucker.md)

## CVE-2022-1386 - Fusion Builder Unauthenticated SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** Server-Side Request Forgery (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPress plugin (Avada theme)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒçš„æ”»å‡»è€…æ‰«æå†…ç½‘ï¼Œè®¿é—®å†…éƒ¨æœåŠ¡ï¼Œç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºFusion Builderæ’ä»¶çš„è¡¨å•å¤„ç†é€»è¾‘ä¸­ï¼Œç”±äºæœªå……åˆ†éªŒè¯ç”¨æˆ·æä¾›çš„URLå‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`wp-admin/admin-ajax.php`æ¥å£å‘èµ·SSRFæ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºï¼ˆNVDã€WPScanã€Checkmarxç­‰ï¼‰ç¡®è®¤äº†CVE-2022-1386çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶SSRFçš„æ€§è´¨ã€‚æä¾›çš„è„šæœ¬`fubucker.sh`å’Œ`single-exploiter.sh`æ—¨åœ¨è‡ªåŠ¨åŒ–æ£€æµ‹å’Œåˆ©ç”¨è¯¥æ¼æ´ã€‚è„šæœ¬é€šè¿‡æ„é€ åŒ…å«æ¶æ„URLçš„POSTè¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ï¼Œå¹¶æ£€æŸ¥å“åº”æ¥ç¡®å®šæ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`fubucker.sh`è„šæœ¬çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚è™½ç„¶è„šæœ¬æœ¬èº«çœ‹èµ·æ¥åƒæ˜¯ä¸ºäº†åˆ©ç”¨SSRFæ¼æ´è€Œè®¾è®¡çš„ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚è„šæœ¬ä¾èµ–äºä»ç›®æ ‡ç«™ç‚¹è·å–`fusion_id`çš„å€¼ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è„šæœ¬ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹æŠ•æ¯’æ–¹å¼ï¼š

*   **ä¿®æ”¹Payload URL:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„`fusionAction`å‚æ•°ï¼ˆå¦‚`https://pastebin.com/raw/VaxXtjGV`ï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªæ¶æ„çš„payloadåœ°å€ï¼Œä¾‹å¦‚åŒ…å«æ¶æ„JavaScriptä»£ç æˆ–å°è¯•åˆ©ç”¨å…¶ä»–æ¼æ´çš„æœåŠ¡å™¨ã€‚
*   **ä¿®æ”¹è¯·æ±‚å‚æ•°:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚ä¸­çš„å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚æ·»åŠ é¢å¤–çš„è¯·æ±‚å¤´æˆ–ä¿®æ”¹æ•°æ®ï¼Œä»¥å®ç°æ›´å¤æ‚çš„æ”»å‡»ã€‚
*   **è®°å½•ç›®æ ‡ä¿¡æ¯:** æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è„šæœ¬ï¼Œå°†æ‰«æçš„ç›®æ ‡URLå’Œç»“æœå‘é€åˆ°å…¶æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œä»è€Œæ”¶é›†æ•æ„Ÿä¿¡æ¯ã€‚
*   **ä¾èµ–å¤–éƒ¨æœåŠ¡:** è™½ç„¶è„šæœ¬ä½¿ç”¨äº†`pastebin.com`ä½œä¸ºç¤ºä¾‹ï¼Œä½†è¿™ä½¿å¾—payloadæ‰§è¡Œä¾èµ–äºè¯¥æœåŠ¡çš„å¯ç”¨æ€§å’Œå†…å®¹ã€‚è‹¥`pastebin`è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™ä¼šå½±å“æ‰€æœ‰ä½¿ç”¨æ­¤è„šæœ¬çš„ç›®æ ‡ã€‚

é‰´äºè„šæœ¬çš„å¼€æ”¾æ€§å’Œå¯ä¿®æ”¹æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ¶æ„åˆ©ç”¨æ–¹å¼ï¼Œç”¨æˆ·åº”è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨è¿è¡Œå‰ä»”ç»†å®¡æŸ¥ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** å¯»æ‰¾å®‰è£…äº†Fusion Builderæ’ä»¶ï¼ˆ3.6.2ç‰ˆæœ¬ä¹‹å‰ï¼‰çš„WordPressç½‘ç«™ã€‚
2.  **è·å–`fusion_id`ï¼š** é€šè¿‡å‘`wp-admin/admin-ajax.php`å‘é€`action=fusion_form_update_view`è¯·æ±‚è·å–`fusion-form-nonce-0`çš„å€¼ã€‚
3.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨è·å–çš„`fusion_id`æ„é€ POSTè¯·æ±‚ï¼Œè®¾ç½®`action=fusion_form_submit_form_to_url`ï¼Œå¹¶å°†`fusionAction`å‚æ•°è®¾ç½®ä¸ºæ”»å‡»è€…æƒ³è¦è®¿é—®çš„å†…éƒ¨æˆ–å¤–éƒ¨URLã€‚
4.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°`wp-admin/admin-ajax.php`ã€‚
5.  **åˆ†æå“åº”ï¼š** æ£€æŸ¥å“åº”å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸå‘èµ·äº†SSRFæ”»å‡»ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›äº†ç›®æ ‡URLçš„å†…å®¹ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

é€šè¿‡SSRFï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

*   **ç«¯å£æ‰«æï¼š** æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ã€‚
*   **è®¿é—®å†…éƒ¨æœåŠ¡ï¼š** è®¿é—®åªæœ‰å†…éƒ¨ç½‘ç»œæ‰èƒ½è®¿é—®çš„æœåŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“ã€ç®¡ç†é¢æ¿ç­‰ã€‚
*   **è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š** åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** å¦‚æœå†…éƒ¨æœåŠ¡å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡SSRFåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [im-hanzou/fubucker](https://github.com/im-hanzou/fubucker)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #5

**æ¥æº**: [CVE-2022-1386-satyasai1460_CVE-2022-1386.md](../2022/CVE-2022-1386-satyasai1460_CVE-2022-1386.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** SSRF (æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )

**å½±å“åº”ç”¨:** Fusion Builder (WordPress plugin)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å†…ç½‘ä¿¡æ¯æ³„éœ²ã€ç«¯å£æ‰«æã€ç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå¦‚æœå†…ç½‘å­˜åœ¨æœªæˆæƒçš„æœåŠ¡ï¼‰

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”å­˜åœ¨å¯è®¿é—®çš„/wp-admin/admin-ajax.phpæ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ Fusion Builder WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ `fusionAction` å‚æ•°ï¼Œå‘èµ·ä»»æ„ HTTP è¯·æ±‚ã€‚ç”±äºè¯·æ±‚æ˜¯ç”±æœåŠ¡å™¨å‘èµ·çš„ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶æªæ–½ï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† `fusion_form_submit_form_to_url` actionï¼Œé€šè¿‡ä¿®æ”¹ `fusionAction` å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚POC ä»£ç é¦–å…ˆå°è¯•è·å– `fusion_id`ï¼Œå¦‚æœæœ¬åœ°ä¸å­˜åœ¨åˆ™é€šè¿‡è®¿é—® `/wp-admin/admin-ajax.php` æ¥è·å–ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ç„¶åï¼Œå®ƒæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ URL çš„ POST è¯·æ±‚ï¼Œå‘é€åˆ° `/wp-admin/admin-ajax.php`ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå‘æ”»å‡»è€…æŒ‡å®šçš„ URL å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚ å› æ­¤ï¼Œæä¾›çš„POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„`exploit.py`è„šæœ¬ï¼Œå‘ç°å¤§éƒ¨åˆ†ä»£ç ç”¨äºæ„å»ºå’Œå‘é€ SSRF è¯·æ±‚ï¼Œä»¥åŠå¤„ç† WordPress çš„è®¤è¯ç»•è¿‡ã€‚å…¶ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

1. **`make_folder()` å‡½æ•°:** åˆ›å»ºåä¸º `output` çš„æ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ã€‚è™½ç„¶è¿™æœ¬èº«ä¸æ˜¯æ¶æ„è¡Œä¸ºï¼Œä½†æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ webshellã€‚é£é™©è¾ƒä½ã€‚
2. **`save_fusion_id()` å’Œ `load_fusion_id()` å‡½æ•°:**  ç”¨äºä¿å­˜å’ŒåŠ è½½ `fusion_id`ã€‚ å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†è¿™äº›å‡½æ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ï¼Œä½†ä¸ä¼šç›´æ¥æ„æˆå®‰å…¨å¨èƒã€‚ é£é™©è¾ƒä½ã€‚
3. **Payloadçš„æ„å»º:** æ”»å‡»è€…å¯èƒ½ä¼šåœ¨æ„é€ payloadæ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚å°è¯•æ‰§è¡Œå‘½ä»¤æˆ–å†™å…¥æ–‡ä»¶ã€‚è™½ç„¶POCæœ¬èº«æ²¡æœ‰å±•ç¤ºï¼Œä½†æ˜¯åˆ©ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚é£é™©ä¸­ç­‰ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚ä¸»è¦æ˜¯åˆ©ç”¨ç°æœ‰çš„SSRFæ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨ Avada ä¸»é¢˜å’Œ Fusion Builder æ’ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä½äº 3.6.2ã€‚
2.  è¿è¡Œ POC ä»£ç ï¼ŒæŒ‡å®šç›®æ ‡ç½‘ç«™çš„ URL å’Œè¦è®¿é—®çš„å†…éƒ¨èµ„æº (ä¾‹å¦‚ï¼š`http://127.0.0.1:8080`) ä½œä¸º payloadã€‚
3.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†å‘æŒ‡å®šçš„å†…éƒ¨èµ„æºå‘èµ·è¯·æ±‚ï¼Œå¹¶å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰«æå†…éƒ¨ç½‘ç»œï¼ŒæŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ï¼Œæˆ–è€…åˆ©ç”¨å†…éƒ¨æœåŠ¡ä¸­çš„æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

## POC #6

**æ¥æº**: [CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md](../2022/CVE-2022-1386-zycoder0day_CVE-2022-1386-Mass_Vulnerability.md)

## CVE-2022-1386 - Fusion Builder SSRF

**æ¼æ´ç¼–å·:** CVE-2022-1386

**æ¼æ´ç±»å‹:** æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF)

**å½±å“åº”ç”¨:** Fusion Builder WordPressæ’ä»¶ (Avadaä¸»é¢˜)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€å†…ç½‘æ‰«æã€ç»•è¿‡é˜²ç«å¢™è®¿é—®å†…éƒ¨æœåŠ¡ã€‚

**å½±å“ç‰ˆæœ¬:** < 3.6.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç½‘ç«™å®‰è£…äº†å­˜åœ¨æ¼æ´çš„Fusion Builderæ’ä»¶ï¼Œä¸”æœªåšSSRFç›¸å…³é˜²å¾¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2022-1386 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Fusion Builder WordPress æ’ä»¶ 3.6.2 ä¹‹å‰ç‰ˆæœ¬çš„æœªæˆæƒ SSRF æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„ HTTP è¯·æ±‚ï¼Œä½¿æœåŠ¡å™¨ä»£è¡¨æ”»å‡»è€…è®¿é—®å†…éƒ¨æˆ–å¤–éƒ¨ç½‘ç»œèµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äº Fusion Builder 3.6.2 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ— éœ€èº«ä»½éªŒè¯ã€‚æœç´¢ç»“æœä¸­ä¹Ÿæåˆ°äº†åˆ©ç”¨è¯¥æ¼æ´æ‰«æå†…ç½‘ï¼Œç»•è¿‡é˜²ç«å¢™çš„å¯èƒ½æ€§ã€‚æä¾›çš„ bash è„šæœ¬ `fubucker.sh` ä½¿ç”¨ curl å‘½ä»¤ï¼Œé€šè¿‡å‘ `/wp-admin/admin-ajax.php` å‘é€ POST è¯·æ±‚ï¼Œè§¦å‘ SSRF æ¼æ´ã€‚è„šæœ¬é¦–å…ˆè·å– `fusion-form-nonce` å€¼ï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ `fusionAction` çš„è¯·æ±‚ï¼Œ`fusionAction` æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨URLï¼Œå¦‚ `https://pastebin.com/raw/VaxXtjGV`ã€‚æœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚æ­¤URLï¼Œå¹¶å°†ç»“æœè¿”å›ï¼Œæ”»å‡»è€…ä¾¿å¯åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡ŒSSRFã€‚

**æŠ•æ¯’é£é™©ï¼š**

è™½ç„¶ä¸»è¦çš„åˆ©ç”¨é€»è¾‘æ˜¯ SSRFï¼Œä½†è„šæœ¬ä¸­å­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ä»¥ä¸‹åˆ†æ:
* é¦–å…ˆè„šæœ¬åˆ›å»º `vuln.txt` å’Œ `notvuln.txt` æ–‡ä»¶ï¼Œç”¨äºè®°å½•å­˜åœ¨æ¼æ´å’Œä¸å­˜åœ¨æ¼æ´çš„ URLã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸æ“ä½œï¼Œç”¨äºæ‰«æç»“æœçš„ç»Ÿè®¡å’Œæ•´ç†ã€‚
* è„šæœ¬é€šè¿‡ `--insecure` å‚æ•°ç¦ç”¨ SSL è¯ä¹¦éªŒè¯ï¼Œå¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¦‚æœè„šæœ¬æ‰§è¡Œè€…ä¸æ³¨æ„ï¼Œå¯èƒ½åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
* æœ€ä¸»è¦çš„æ½œåœ¨é£é™©åœ¨äº `fusionAction=https://pastebin.com/raw/VaxXtjGV`ã€‚è„šæœ¬ç›´æ¥ä» pastebin ä¸‹è½½ payloadã€‚å¦‚æœ pastebin ä¸Šçš„å†…å®¹è¢«æ¶æ„ä¿®æ”¹ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ pastebin ä¸Šçš„payloadä¸­åŒ…å«ä»»æ„æ¶æ„ä»£ç ï¼ˆå¦‚åå¼¹shellç­‰ï¼‰ã€‚è™½ç„¶å½“å‰ pastebin çš„å†…å®¹å¯èƒ½æ— å®³ï¼Œä½†æœªæ¥å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨bashè„šæœ¬æ‰¹é‡æ‰§è¡Œç«™ç‚¹æ”»å‡»ï¼Œå®¹æ˜“é€ æˆå¤§é‡ç«™ç‚¹è®¿é—®ï¼Œå±äºéæˆæƒè¡Œä¸ºã€‚

ç»¼åˆä»¥ä¸Šå› ç´ ï¼Œè™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯SSRFæ£€æµ‹ï¼Œä½†æ¥è‡ªå¤–éƒ¨ pastebin çš„ payload å¼•å…¥äº†ä¸ç¡®å®šæ€§ï¼Œå› æ­¤å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º 20%ã€‚å¤§éƒ¨åˆ†ä»£ç é€»è¾‘æ­£å¸¸ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨å¤–éƒ¨èµ„æºçš„ä¾èµ–ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ WordPress ç½‘ç«™ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Fusion Builder æ’ä»¶ (ç‰ˆæœ¬ < 3.6.2)ã€‚**
2.  **è¿è¡Œæä¾›çš„ `fubucker.sh` è„šæœ¬ï¼ŒæŒ‡å®šåŒ…å«ç›®æ ‡ URL åˆ—è¡¨çš„æ–‡ä»¶å’Œçº¿ç¨‹æ•°ã€‚**
3.  **è„šæœ¬ä¼šè‡ªåŠ¨å‘é€åŒ…å«æ¶æ„ `fusionAction` å‚æ•°çš„ POST è¯·æ±‚åˆ° `/wp-admin/admin-ajax.php`ã€‚**
4.  **å¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨ä¼šå°è¯•è¯·æ±‚ `fusionAction` æŒ‡å®šçš„ URLï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚**
5.  **æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ†æè¿”å›çš„ç»“æœï¼Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ©ç”¨ SSRF æ¼æ´è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œå¦‚å†…ç½‘ç«¯å£æ‰«æã€è¯»å–å†…ç½‘æœåŠ¡ç­‰ã€‚**


**é¡¹ç›®åœ°å€:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)

---

