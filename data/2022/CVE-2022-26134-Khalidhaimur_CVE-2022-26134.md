## CVE-2022-26134 - Atlassian Confluence Server and Data Center RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** RCE

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** All supported versions before the patched release

**利用条件:** Unauthenticated network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134是Atlassian Confluence Server和Data Center中的一个严重远程代码执行(RCE)漏洞。该漏洞允许未经身份验证的攻击者通过将OGNL表达式注入到易受攻击的端点来执行任意代码。POC利用了Java的Nashorn引擎执行反向shell。该POC的有效性很高，因为它提供了一个可以直接使用的curl命令，可以很容易地执行反向shell。利用步骤如下：首先，在攻击机上设置一个监听器(例如，使用`nc -lvnp 1270`)。然后，执行提供的curl命令，将目标IP地址和端口替换为攻击机的IP地址和端口。如果漏洞利用成功，攻击者将收到一个反向shell，从而可以完全控制受影响的Confluence服务器。POC中提供的curl命令包含一个OGNL表达式，该表达式使用Java的`javax.script.ScriptEngineManager`和`java.lang.ProcessBuilder`类来执行任意代码。具体来说，它使用Nashorn JavaScript引擎来评估一个命令，该命令启动一个反向shell连接回攻击者。虽然此POC易于使用并且有效，但它依赖于在目标系统上执行任意命令的能力。这使得它成为一个高风险漏洞，攻击者可以利用它来窃取敏感数据、安装恶意软件或完全控制受影响的系统。

投毒风险分析：此POC的投毒风险较低，约为15%。主要原因是该POC的代码清晰易懂，没有发现明显的混淆或恶意行为。POC仅使用标准的Java库和bash命令来执行反向shell，没有涉及任何外部脚本或可疑请求。然而，仍然存在一些小的投毒风险。例如，攻击者可能会修改POC中的curl命令以包含额外的恶意代码，例如下载和执行其他可执行文件。此外，反向shell本身可以被视为一种恶意行为，因为它允许攻击者在目标系统上执行任意命令。尽管存在这些风险，但总的来说，此POC的投毒风险相对较低，因为它不包含任何明显的恶意代码或行为。如果组织使用此POC进行漏洞评估，建议仔细检查代码并确保它没有被篡改。此外，建议仅在受控环境中执行此POC，以防止对生产系统造成任何损害。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
