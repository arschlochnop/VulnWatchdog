# CVE-2022-22536

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md](../2022/CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md)

## CVE-2022-22536: SAP NetWeaver HTTP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可导致权限绕过、缓存投毒、信息泄露、完全控制系统

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22 及受影响的 SAP Web Dispatcher 和 SAP Content Server 版本

**利用条件:** 需要能够访问受影响的 SAP NetWeaver 组件的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536 是 SAP NetWeaver 中一个严重 HTTP 请求走私漏洞。攻击者可以通过操纵 Content-Length 或 Transfer-Encoding 头部，在前端服务器和后端服务器之间造成请求解析差异，从而将恶意请求“走私”到后端。\n\n**有效性分析：** 根据漏洞库信息和提供的漏洞利用代码（SAPGateBreaker-Exploit），该漏洞利用尝试利用 Content-Length 头部进行请求走私。漏洞利用代码的描述提到，传统的 chunked 编码方式可能被 SAP ICM 拒绝，因此该 PoC 转向使用 Content-Length 进行 desynchronization。由于CISA KEV已收录，说明漏洞真实存在且利用较为广泛。该 PoC 的基本思路是通过发送一个精心构造的 POST 请求，其中包含一个嵌入式的 GET 请求，目标是访问内部资源。这种方法通常有效，因为前端服务器可能根据 Content-Length 只读取部分请求，而将剩余部分作为下一个请求发送到后端服务器。如果目标系统存在漏洞，PoC 大概率有效。\n\n**投毒风险分析：** 查看提供的文件列表，主要包含 LICENSE、README.md 和 exploit 脚本。LICENSE 声明了 MIT 许可，表明代码开源。README.md 文件描述了漏洞和 PoC 的基本信息。没有直接发现恶意代码。但是，由于HTTP请求走私本身的复杂性，以及SAP系统的复杂性，不排除作者可能在代码中植入不易察觉的后门或漏洞利用。例如，该 PoC 可能会尝试访问一些不应该访问的内部端点，或者在特定条件下触发一些意外行为。需要对PoC代码进行仔细分析，特别是网络请求部分。因此，投毒风险评估为10%，主要是考虑到代码中可能存在未知的漏洞或不安全行为。\n\n**利用方式：**\n1.  攻击者构造包含恶意负载的 HTTP 请求。\n2.  恶意负载利用 Content-Length 或 Transfer-Encoding 头部，使得前端服务器和后端服务器对请求边界的解析不一致。\n3.  前端服务器将部分恶意请求转发到后端服务器。\n4.  后端服务器将恶意请求作为合法请求处理，从而导致攻击者可以执行未授权操作，例如绕过身份验证、访问内部资源或篡改数据。

**项目地址:** [BecodoExploit-mrCAT/SAPGateBreaker-Exploit](https://github.com/BecodoExploit-mrCAT/SAPGateBreaker-Exploit)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #2

**来源**: [CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md](../2022/CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md)

## CVE-2022-22536 - SAP NetWeaver Request Smuggling/Concatenation

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling/Concatenation

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致信息泄露、权限提升、缓存投毒、拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22536 是 SAP NetWeaver 平台上的一个 HTTP 请求走私/串联漏洞。未经身份验证的攻击者可以将恶意数据添加到受害者的请求中，从而冒充受害者执行功能或毒化中间 Web 缓存，可能导致系统完全崩溃。 

**漏洞利用方式分析：**

1.  **漏洞原理：** 该漏洞的根本原因是 SAP Web Dispatcher 或 SAP 应用服务器在处理 HTTP 请求时，对 Content-Length 和 Transfer-Encoding 等头部解析不一致，导致请求边界混淆。攻击者可以构造特殊的 HTTP 请求，将多个请求拼接在一起，服务器错误地将恶意请求的一部分解释为下一个用户的请求。

2.  **POC 代码分析：** 提供的 POC 代码旨在利用此漏洞。该代码首先尝试验证和缓存资源。然后，它构造一个包含填充数据和代理对齐请求的恶意 HTTP 请求。填充数据旨在利用 Content-Length 的差异，而代理对齐请求旨在确保服务器正确处理响应。代码发送这个恶意请求，并解析服务器的响应，以判断漏洞是否存在。具体来说:
    * `craft_payload` 函数构造恶意 payload，包含了填充数据和代理对齐请求。
    * `validate_resource_and_cache` 函数验证资源是否有效并缓存，为后续攻击做准备。
    * `send_payload` 函数负责发送payload并接收响应。
    * `parse_response` 函数解析响应，提取状态码等信息。

3. **有效性:** 根据漏洞库信息和提供的POC代码, 此POC代码可以验证并利用 CVE-2022-22536。

4. **投毒风险:** 检查了整个代码，没有发现明显的投毒代码。代码逻辑主要集中在构建和发送恶意 HTTP 请求，以及解析服务器响应。所有操作都在漏洞利用的范畴内。因此，投毒风险评估为 0%。

**项目地址:** [ZZ-SOCMAP/CVE-2022-22536](https://github.com/ZZ-SOCMAP/CVE-2022-22536)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #3

**来源**: [CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md](../2022/CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md)

## CVE-2022-22536 SAP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** 请求走私 (Request Smuggling)

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致权限提升、数据泄露、缓存投毒和拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在受影响的SAP组件，且允许HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536是SAP NetWeaver和ABAP平台中的一个请求走私漏洞。未经验证的攻击者可以通过在受害者请求前添加恶意数据来利用此漏洞，从而冒充受害者执行功能或污染中间Web缓存。漏洞利用代码scanner.py是一个针对CVE-2022-22536的扫描器，它通过发送特制的HTTP请求来检测目标系统是否存在请求走私漏洞。这个POC代码通过构造畸形的HTTP请求，利用服务器对Content-Length和Transfer-Encoding处理不一致的问题，将恶意请求隐藏在看似正常的请求中，当服务器处理完第一个请求后，会将恶意请求当做下一个请求进行处理，从而达到走私请求的目的。

**有效性：**
根据漏洞描述和POC代码，该漏洞利用代码是有效的，因为它旨在验证目标系统是否容易受到请求走私攻击。该代码通过发送构造的HTTP请求并分析响应来检测此漏洞。

**投毒风险：**
代码中存在极低的投毒风险（约10%）。风险点在于：

1.  **依赖项：** 代码依赖于`tqdm`库。虽然`tqdm`是一个常见的库，但始终存在依赖项被劫持或恶意版本替代的风险。
2.  **证书验证控制：** 脚本允许禁用SSL证书验证 (`cert_verify=False`)。虽然这在测试环境中很有用，但在生产环境中可能会引入中间人攻击的风险。

总体而言，代码相对简单且易于审计。主要功能是构造和发送HTTP请求以进行漏洞检测，而不是执行恶意操作。然而，始终建议在运行任何第三方代码之前进行彻底审查。

**利用方式：**

1.  **目标列表：** 扫描器从文件中读取目标IP地址和端口列表。
2.  **协议协商：** 扫描器支持通过HTTP或HTTPS进行连接，并可选地验证SSL证书。
3.  **漏洞验证：** 扫描器通过发送特制的HTTP请求（包含填充数据和代理对齐有效负载）来触发请求走私漏洞。这些请求旨在利用服务器对Content-Length和Transfer-Encoding的处理差异。
4.  **结果分析：** 扫描器分析服务器的响应，以确定目标系统是否容易受到攻击。如果服务器以意外的方式处理请求，则可能存在请求走私漏洞。
5.  **报告：** 扫描器生成CSV格式的报告，其中包含有关扫描结果的信息。

**项目地址:** [abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner](https://github.com/abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #4

**来源**: [CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md](../2022/CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md)

# CVE-2022-22536

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md](../2022/CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md)

## CVE-2022-22536: SAP NetWeaver HTTP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可导致权限绕过、缓存投毒、信息泄露、完全控制系统

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22 及受影响的 SAP Web Dispatcher 和 SAP Content Server 版本

**利用条件:** 需要能够访问受影响的 SAP NetWeaver 组件的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536 是 SAP NetWeaver 中一个严重 HTTP 请求走私漏洞。攻击者可以通过操纵 Content-Length 或 Transfer-Encoding 头部，在前端服务器和后端服务器之间造成请求解析差异，从而将恶意请求“走私”到后端。\n\n**有效性分析：** 根据漏洞库信息和提供的漏洞利用代码（SAPGateBreaker-Exploit），该漏洞利用尝试利用 Content-Length 头部进行请求走私。漏洞利用代码的描述提到，传统的 chunked 编码方式可能被 SAP ICM 拒绝，因此该 PoC 转向使用 Content-Length 进行 desynchronization。由于CISA KEV已收录，说明漏洞真实存在且利用较为广泛。该 PoC 的基本思路是通过发送一个精心构造的 POST 请求，其中包含一个嵌入式的 GET 请求，目标是访问内部资源。这种方法通常有效，因为前端服务器可能根据 Content-Length 只读取部分请求，而将剩余部分作为下一个请求发送到后端服务器。如果目标系统存在漏洞，PoC 大概率有效。\n\n**投毒风险分析：** 查看提供的文件列表，主要包含 LICENSE、README.md 和 exploit 脚本。LICENSE 声明了 MIT 许可，表明代码开源。README.md 文件描述了漏洞和 PoC 的基本信息。没有直接发现恶意代码。但是，由于HTTP请求走私本身的复杂性，以及SAP系统的复杂性，不排除作者可能在代码中植入不易察觉的后门或漏洞利用。例如，该 PoC 可能会尝试访问一些不应该访问的内部端点，或者在特定条件下触发一些意外行为。需要对PoC代码进行仔细分析，特别是网络请求部分。因此，投毒风险评估为10%，主要是考虑到代码中可能存在未知的漏洞或不安全行为。\n\n**利用方式：**\n1.  攻击者构造包含恶意负载的 HTTP 请求。\n2.  恶意负载利用 Content-Length 或 Transfer-Encoding 头部，使得前端服务器和后端服务器对请求边界的解析不一致。\n3.  前端服务器将部分恶意请求转发到后端服务器。\n4.  后端服务器将恶意请求作为合法请求处理，从而导致攻击者可以执行未授权操作，例如绕过身份验证、访问内部资源或篡改数据。

**项目地址:** [BecodoExploit-mrCAT/SAPGateBreaker-Exploit](https://github.com/BecodoExploit-mrCAT/SAPGateBreaker-Exploit)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #2

**来源**: [CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md](../2022/CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md)

## CVE-2022-22536 - SAP NetWeaver Request Smuggling/Concatenation

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling/Concatenation

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致信息泄露、权限提升、缓存投毒、拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22536 是 SAP NetWeaver 平台上的一个 HTTP 请求走私/串联漏洞。未经身份验证的攻击者可以将恶意数据添加到受害者的请求中，从而冒充受害者执行功能或毒化中间 Web 缓存，可能导致系统完全崩溃。 

**漏洞利用方式分析：**

1.  **漏洞原理：** 该漏洞的根本原因是 SAP Web Dispatcher 或 SAP 应用服务器在处理 HTTP 请求时，对 Content-Length 和 Transfer-Encoding 等头部解析不一致，导致请求边界混淆。攻击者可以构造特殊的 HTTP 请求，将多个请求拼接在一起，服务器错误地将恶意请求的一部分解释为下一个用户的请求。

2.  **POC 代码分析：** 提供的 POC 代码旨在利用此漏洞。该代码首先尝试验证和缓存资源。然后，它构造一个包含填充数据和代理对齐请求的恶意 HTTP 请求。填充数据旨在利用 Content-Length 的差异，而代理对齐请求旨在确保服务器正确处理响应。代码发送这个恶意请求，并解析服务器的响应，以判断漏洞是否存在。具体来说:
    * `craft_payload` 函数构造恶意 payload，包含了填充数据和代理对齐请求。
    * `validate_resource_and_cache` 函数验证资源是否有效并缓存，为后续攻击做准备。
    * `send_payload` 函数负责发送payload并接收响应。
    * `parse_response` 函数解析响应，提取状态码等信息。

3. **有效性:** 根据漏洞库信息和提供的POC代码, 此POC代码可以验证并利用 CVE-2022-22536。

4. **投毒风险:** 检查了整个代码，没有发现明显的投毒代码。代码逻辑主要集中在构建和发送恶意 HTTP 请求，以及解析服务器响应。所有操作都在漏洞利用的范畴内。因此，投毒风险评估为 0%。

**项目地址:** [ZZ-SOCMAP/CVE-2022-22536](https://github.com/ZZ-SOCMAP/CVE-2022-22536)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #3

**来源**: [CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md](../2022/CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md)

## CVE-2022-22536 SAP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** 请求走私 (Request Smuggling)

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致权限提升、数据泄露、缓存投毒和拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在受影响的SAP组件，且允许HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536是SAP NetWeaver和ABAP平台中的一个请求走私漏洞。未经验证的攻击者可以通过在受害者请求前添加恶意数据来利用此漏洞，从而冒充受害者执行功能或污染中间Web缓存。漏洞利用代码scanner.py是一个针对CVE-2022-22536的扫描器，它通过发送特制的HTTP请求来检测目标系统是否存在请求走私漏洞。这个POC代码通过构造畸形的HTTP请求，利用服务器对Content-Length和Transfer-Encoding处理不一致的问题，将恶意请求隐藏在看似正常的请求中，当服务器处理完第一个请求后，会将恶意请求当做下一个请求进行处理，从而达到走私请求的目的。

**有效性：**
根据漏洞描述和POC代码，该漏洞利用代码是有效的，因为它旨在验证目标系统是否容易受到请求走私攻击。该代码通过发送构造的HTTP请求并分析响应来检测此漏洞。

**投毒风险：**
代码中存在极低的投毒风险（约10%）。风险点在于：

1.  **依赖项：** 代码依赖于`tqdm`库。虽然`tqdm`是一个常见的库，但始终存在依赖项被劫持或恶意版本替代的风险。
2.  **证书验证控制：** 脚本允许禁用SSL证书验证 (`cert_verify=False`)。虽然这在测试环境中很有用，但在生产环境中可能会引入中间人攻击的风险。

总体而言，代码相对简单且易于审计。主要功能是构造和发送HTTP请求以进行漏洞检测，而不是执行恶意操作。然而，始终建议在运行任何第三方代码之前进行彻底审查。

**利用方式：**

1.  **目标列表：** 扫描器从文件中读取目标IP地址和端口列表。
2.  **协议协商：** 扫描器支持通过HTTP或HTTPS进行连接，并可选地验证SSL证书。
3.  **漏洞验证：** 扫描器通过发送特制的HTTP请求（包含填充数据和代理对齐有效负载）来触发请求走私漏洞。这些请求旨在利用服务器对Content-Length和Transfer-Encoding的处理差异。
4.  **结果分析：** 扫描器分析服务器的响应，以确定目标系统是否容易受到攻击。如果服务器以意外的方式处理请求，则可能存在请求走私漏洞。
5.  **报告：** 扫描器生成CSV格式的报告，其中包含有关扫描结果的信息。

**项目地址:** [abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner](https://github.com/abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #4

**来源**: [CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md](../2022/CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md)

# CVE-2022-22536

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md](../2022/CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md)

## CVE-2022-22536: SAP NetWeaver HTTP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可导致权限绕过、缓存投毒、信息泄露、完全控制系统

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22 及受影响的 SAP Web Dispatcher 和 SAP Content Server 版本

**利用条件:** 需要能够访问受影响的 SAP NetWeaver 组件的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536 是 SAP NetWeaver 中一个严重 HTTP 请求走私漏洞。攻击者可以通过操纵 Content-Length 或 Transfer-Encoding 头部，在前端服务器和后端服务器之间造成请求解析差异，从而将恶意请求“走私”到后端。\n\n**有效性分析：** 根据漏洞库信息和提供的漏洞利用代码（SAPGateBreaker-Exploit），该漏洞利用尝试利用 Content-Length 头部进行请求走私。漏洞利用代码的描述提到，传统的 chunked 编码方式可能被 SAP ICM 拒绝，因此该 PoC 转向使用 Content-Length 进行 desynchronization。由于CISA KEV已收录，说明漏洞真实存在且利用较为广泛。该 PoC 的基本思路是通过发送一个精心构造的 POST 请求，其中包含一个嵌入式的 GET 请求，目标是访问内部资源。这种方法通常有效，因为前端服务器可能根据 Content-Length 只读取部分请求，而将剩余部分作为下一个请求发送到后端服务器。如果目标系统存在漏洞，PoC 大概率有效。\n\n**投毒风险分析：** 查看提供的文件列表，主要包含 LICENSE、README.md 和 exploit 脚本。LICENSE 声明了 MIT 许可，表明代码开源。README.md 文件描述了漏洞和 PoC 的基本信息。没有直接发现恶意代码。但是，由于HTTP请求走私本身的复杂性，以及SAP系统的复杂性，不排除作者可能在代码中植入不易察觉的后门或漏洞利用。例如，该 PoC 可能会尝试访问一些不应该访问的内部端点，或者在特定条件下触发一些意外行为。需要对PoC代码进行仔细分析，特别是网络请求部分。因此，投毒风险评估为10%，主要是考虑到代码中可能存在未知的漏洞或不安全行为。\n\n**利用方式：**\n1.  攻击者构造包含恶意负载的 HTTP 请求。\n2.  恶意负载利用 Content-Length 或 Transfer-Encoding 头部，使得前端服务器和后端服务器对请求边界的解析不一致。\n3.  前端服务器将部分恶意请求转发到后端服务器。\n4.  后端服务器将恶意请求作为合法请求处理，从而导致攻击者可以执行未授权操作，例如绕过身份验证、访问内部资源或篡改数据。

**项目地址:** [BecodoExploit-mrCAT/SAPGateBreaker-Exploit](https://github.com/BecodoExploit-mrCAT/SAPGateBreaker-Exploit)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #2

**来源**: [CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md](../2022/CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md)

## CVE-2022-22536 - SAP NetWeaver Request Smuggling/Concatenation

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling/Concatenation

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致信息泄露、权限提升、缓存投毒、拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22536 是 SAP NetWeaver 平台上的一个 HTTP 请求走私/串联漏洞。未经身份验证的攻击者可以将恶意数据添加到受害者的请求中，从而冒充受害者执行功能或毒化中间 Web 缓存，可能导致系统完全崩溃。 

**漏洞利用方式分析：**

1.  **漏洞原理：** 该漏洞的根本原因是 SAP Web Dispatcher 或 SAP 应用服务器在处理 HTTP 请求时，对 Content-Length 和 Transfer-Encoding 等头部解析不一致，导致请求边界混淆。攻击者可以构造特殊的 HTTP 请求，将多个请求拼接在一起，服务器错误地将恶意请求的一部分解释为下一个用户的请求。

2.  **POC 代码分析：** 提供的 POC 代码旨在利用此漏洞。该代码首先尝试验证和缓存资源。然后，它构造一个包含填充数据和代理对齐请求的恶意 HTTP 请求。填充数据旨在利用 Content-Length 的差异，而代理对齐请求旨在确保服务器正确处理响应。代码发送这个恶意请求，并解析服务器的响应，以判断漏洞是否存在。具体来说:
    * `craft_payload` 函数构造恶意 payload，包含了填充数据和代理对齐请求。
    * `validate_resource_and_cache` 函数验证资源是否有效并缓存，为后续攻击做准备。
    * `send_payload` 函数负责发送payload并接收响应。
    * `parse_response` 函数解析响应，提取状态码等信息。

3. **有效性:** 根据漏洞库信息和提供的POC代码, 此POC代码可以验证并利用 CVE-2022-22536。

4. **投毒风险:** 检查了整个代码，没有发现明显的投毒代码。代码逻辑主要集中在构建和发送恶意 HTTP 请求，以及解析服务器响应。所有操作都在漏洞利用的范畴内。因此，投毒风险评估为 0%。

**项目地址:** [ZZ-SOCMAP/CVE-2022-22536](https://github.com/ZZ-SOCMAP/CVE-2022-22536)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #3

**来源**: [CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md](../2022/CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md)

## CVE-2022-22536 SAP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** 请求走私 (Request Smuggling)

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致权限提升、数据泄露、缓存投毒和拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在受影响的SAP组件，且允许HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536是SAP NetWeaver和ABAP平台中的一个请求走私漏洞。未经验证的攻击者可以通过在受害者请求前添加恶意数据来利用此漏洞，从而冒充受害者执行功能或污染中间Web缓存。漏洞利用代码scanner.py是一个针对CVE-2022-22536的扫描器，它通过发送特制的HTTP请求来检测目标系统是否存在请求走私漏洞。这个POC代码通过构造畸形的HTTP请求，利用服务器对Content-Length和Transfer-Encoding处理不一致的问题，将恶意请求隐藏在看似正常的请求中，当服务器处理完第一个请求后，会将恶意请求当做下一个请求进行处理，从而达到走私请求的目的。

**有效性：**
根据漏洞描述和POC代码，该漏洞利用代码是有效的，因为它旨在验证目标系统是否容易受到请求走私攻击。该代码通过发送构造的HTTP请求并分析响应来检测此漏洞。

**投毒风险：**
代码中存在极低的投毒风险（约10%）。风险点在于：

1.  **依赖项：** 代码依赖于`tqdm`库。虽然`tqdm`是一个常见的库，但始终存在依赖项被劫持或恶意版本替代的风险。
2.  **证书验证控制：** 脚本允许禁用SSL证书验证 (`cert_verify=False`)。虽然这在测试环境中很有用，但在生产环境中可能会引入中间人攻击的风险。

总体而言，代码相对简单且易于审计。主要功能是构造和发送HTTP请求以进行漏洞检测，而不是执行恶意操作。然而，始终建议在运行任何第三方代码之前进行彻底审查。

**利用方式：**

1.  **目标列表：** 扫描器从文件中读取目标IP地址和端口列表。
2.  **协议协商：** 扫描器支持通过HTTP或HTTPS进行连接，并可选地验证SSL证书。
3.  **漏洞验证：** 扫描器通过发送特制的HTTP请求（包含填充数据和代理对齐有效负载）来触发请求走私漏洞。这些请求旨在利用服务器对Content-Length和Transfer-Encoding的处理差异。
4.  **结果分析：** 扫描器分析服务器的响应，以确定目标系统是否容易受到攻击。如果服务器以意外的方式处理请求，则可能存在请求走私漏洞。
5.  **报告：** 扫描器生成CSV格式的报告，其中包含有关扫描结果的信息。

**项目地址:** [abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner](https://github.com/abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #4

**来源**: [CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md](../2022/CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md)

# CVE-2022-22536

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md](../2022/CVE-2022-22536-BecodoExploit-mrCAT_SAPGateBreaker-Exploit.md)

## CVE-2022-22536: SAP NetWeaver HTTP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可导致权限绕过、缓存投毒、信息泄露、完全控制系统

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22 及受影响的 SAP Web Dispatcher 和 SAP Content Server 版本

**利用条件:** 需要能够访问受影响的 SAP NetWeaver 组件的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536 是 SAP NetWeaver 中一个严重 HTTP 请求走私漏洞。攻击者可以通过操纵 Content-Length 或 Transfer-Encoding 头部，在前端服务器和后端服务器之间造成请求解析差异，从而将恶意请求“走私”到后端。\n\n**有效性分析：** 根据漏洞库信息和提供的漏洞利用代码（SAPGateBreaker-Exploit），该漏洞利用尝试利用 Content-Length 头部进行请求走私。漏洞利用代码的描述提到，传统的 chunked 编码方式可能被 SAP ICM 拒绝，因此该 PoC 转向使用 Content-Length 进行 desynchronization。由于CISA KEV已收录，说明漏洞真实存在且利用较为广泛。该 PoC 的基本思路是通过发送一个精心构造的 POST 请求，其中包含一个嵌入式的 GET 请求，目标是访问内部资源。这种方法通常有效，因为前端服务器可能根据 Content-Length 只读取部分请求，而将剩余部分作为下一个请求发送到后端服务器。如果目标系统存在漏洞，PoC 大概率有效。\n\n**投毒风险分析：** 查看提供的文件列表，主要包含 LICENSE、README.md 和 exploit 脚本。LICENSE 声明了 MIT 许可，表明代码开源。README.md 文件描述了漏洞和 PoC 的基本信息。没有直接发现恶意代码。但是，由于HTTP请求走私本身的复杂性，以及SAP系统的复杂性，不排除作者可能在代码中植入不易察觉的后门或漏洞利用。例如，该 PoC 可能会尝试访问一些不应该访问的内部端点，或者在特定条件下触发一些意外行为。需要对PoC代码进行仔细分析，特别是网络请求部分。因此，投毒风险评估为10%，主要是考虑到代码中可能存在未知的漏洞或不安全行为。\n\n**利用方式：**\n1.  攻击者构造包含恶意负载的 HTTP 请求。\n2.  恶意负载利用 Content-Length 或 Transfer-Encoding 头部，使得前端服务器和后端服务器对请求边界的解析不一致。\n3.  前端服务器将部分恶意请求转发到后端服务器。\n4.  后端服务器将恶意请求作为合法请求处理，从而导致攻击者可以执行未授权操作，例如绕过身份验证、访问内部资源或篡改数据。

**项目地址:** [BecodoExploit-mrCAT/SAPGateBreaker-Exploit](https://github.com/BecodoExploit-mrCAT/SAPGateBreaker-Exploit)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #2

**来源**: [CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md](../2022/CVE-2022-22536-ZZ-SOCMAP_CVE-2022-22536.md)

## CVE-2022-22536 - SAP NetWeaver Request Smuggling/Concatenation

**漏洞编号:** CVE-2022-22536

**漏洞类型:** HTTP Request Smuggling/Concatenation

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致信息泄露、权限提升、缓存投毒、拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22536 是 SAP NetWeaver 平台上的一个 HTTP 请求走私/串联漏洞。未经身份验证的攻击者可以将恶意数据添加到受害者的请求中，从而冒充受害者执行功能或毒化中间 Web 缓存，可能导致系统完全崩溃。 

**漏洞利用方式分析：**

1.  **漏洞原理：** 该漏洞的根本原因是 SAP Web Dispatcher 或 SAP 应用服务器在处理 HTTP 请求时，对 Content-Length 和 Transfer-Encoding 等头部解析不一致，导致请求边界混淆。攻击者可以构造特殊的 HTTP 请求，将多个请求拼接在一起，服务器错误地将恶意请求的一部分解释为下一个用户的请求。

2.  **POC 代码分析：** 提供的 POC 代码旨在利用此漏洞。该代码首先尝试验证和缓存资源。然后，它构造一个包含填充数据和代理对齐请求的恶意 HTTP 请求。填充数据旨在利用 Content-Length 的差异，而代理对齐请求旨在确保服务器正确处理响应。代码发送这个恶意请求，并解析服务器的响应，以判断漏洞是否存在。具体来说:
    * `craft_payload` 函数构造恶意 payload，包含了填充数据和代理对齐请求。
    * `validate_resource_and_cache` 函数验证资源是否有效并缓存，为后续攻击做准备。
    * `send_payload` 函数负责发送payload并接收响应。
    * `parse_response` 函数解析响应，提取状态码等信息。

3. **有效性:** 根据漏洞库信息和提供的POC代码, 此POC代码可以验证并利用 CVE-2022-22536。

4. **投毒风险:** 检查了整个代码，没有发现明显的投毒代码。代码逻辑主要集中在构建和发送恶意 HTTP 请求，以及解析服务器响应。所有操作都在漏洞利用的范畴内。因此，投毒风险评估为 0%。

**项目地址:** [ZZ-SOCMAP/CVE-2022-22536](https://github.com/ZZ-SOCMAP/CVE-2022-22536)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #3

**来源**: [CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md](../2022/CVE-2022-22536-abrewer251_CVE-2022-22536_SAP_Request_Smuggling_Scanner.md)

## CVE-2022-22536 SAP Request Smuggling

**漏洞编号:** CVE-2022-22536

**漏洞类型:** 请求走私 (Request Smuggling)

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致权限提升、数据泄露、缓存投毒和拒绝服务

**影响版本:** KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22

**利用条件:** 目标系统存在受影响的SAP组件，且允许HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536是SAP NetWeaver和ABAP平台中的一个请求走私漏洞。未经验证的攻击者可以通过在受害者请求前添加恶意数据来利用此漏洞，从而冒充受害者执行功能或污染中间Web缓存。漏洞利用代码scanner.py是一个针对CVE-2022-22536的扫描器，它通过发送特制的HTTP请求来检测目标系统是否存在请求走私漏洞。这个POC代码通过构造畸形的HTTP请求，利用服务器对Content-Length和Transfer-Encoding处理不一致的问题，将恶意请求隐藏在看似正常的请求中，当服务器处理完第一个请求后，会将恶意请求当做下一个请求进行处理，从而达到走私请求的目的。

**有效性：**
根据漏洞描述和POC代码，该漏洞利用代码是有效的，因为它旨在验证目标系统是否容易受到请求走私攻击。该代码通过发送构造的HTTP请求并分析响应来检测此漏洞。

**投毒风险：**
代码中存在极低的投毒风险（约10%）。风险点在于：

1.  **依赖项：** 代码依赖于`tqdm`库。虽然`tqdm`是一个常见的库，但始终存在依赖项被劫持或恶意版本替代的风险。
2.  **证书验证控制：** 脚本允许禁用SSL证书验证 (`cert_verify=False`)。虽然这在测试环境中很有用，但在生产环境中可能会引入中间人攻击的风险。

总体而言，代码相对简单且易于审计。主要功能是构造和发送HTTP请求以进行漏洞检测，而不是执行恶意操作。然而，始终建议在运行任何第三方代码之前进行彻底审查。

**利用方式：**

1.  **目标列表：** 扫描器从文件中读取目标IP地址和端口列表。
2.  **协议协商：** 扫描器支持通过HTTP或HTTPS进行连接，并可选地验证SSL证书。
3.  **漏洞验证：** 扫描器通过发送特制的HTTP请求（包含填充数据和代理对齐有效负载）来触发请求走私漏洞。这些请求旨在利用服务器对Content-Length和Transfer-Encoding的处理差异。
4.  **结果分析：** 扫描器分析服务器的响应，以确定目标系统是否容易受到攻击。如果服务器以意外的方式处理请求，则可能存在请求走私漏洞。
5.  **报告：** 扫描器生成CSV格式的报告，其中包含有关扫描结果的信息。

**项目地址:** [abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner](https://github.com/abrewer251/CVE-2022-22536_SAP_Request_Smuggling_Scanner)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---

## POC #4

**来源**: [CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md](../2022/CVE-2022-22536-tess-ss_SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536.md)

## CVE-2022-22536 - SAP NetWeaver Request Smuggling/Concatenation

**漏洞编号:** CVE-2022-22536

**漏洞类型:** 请求走私/请求串联

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致信息泄露、权限提升、拒绝服务以及中间Web缓存投毒

**影响版本:** 受影响版本包括：KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22 (以及 Web Dispatcher 7.49, 7.53, 7.77, 7.81, 7.85, 7.22EXT, 7.86, 7.87 和 Content Server 7.53)

**利用条件:** 需要目标系统存在受影响的SAP组件，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536 漏洞是 SAP NetWeaver 及其相关组件中的请求走私和请求串联漏洞。攻击者可以通过在受害者请求前添加恶意数据来利用此漏洞，从而冒充受害者执行功能或毒化中间 Web 缓存。攻击者发送构造好的HTTP请求，利用服务器对Content-Length的处理差异，实现请求走私，后续合法的用户请求可能会受到攻击者恶意请求的影响。PoC利用了 Content-Length 字段，通过发送大量'A'字符来尝试造成 Desynchronization，从而影响后续请求。高危性体现在，未经身份验证的攻击者可以通过此漏洞获得对系统的完全控制，包括数据的机密性、完整性和可用性。投毒风险评估为10%，主要原因是虽然原理上可以通过篡改缓存等方式投毒，但提供的PoC 主要目的是验证漏洞的存在，直接包含恶意代码的可能性较低，但仍然存在一定风险，比如利用该漏洞实施进一步的攻击，比如缓存投毒等。此仓库中包含指向 Onapsis 和 antx-code 提供的漏洞验证脚本的链接。

**项目地址:** [tess-ss/SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536](https://github.com/tess-ss/SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)

---



---



---



---

