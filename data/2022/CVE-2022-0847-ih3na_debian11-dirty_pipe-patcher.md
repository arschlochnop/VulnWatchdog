# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

# CVE-2022-0847

> 📦 该CVE有 **32** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-0847-0xeremus_dirty-pipe-poc.md](../2022/CVE-2022-0847-0xeremus_dirty-pipe-poc.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围较广，参见搜索结果)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。利用该漏洞，非特权本地用户可以将数据写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的exploit是可靠的，可以获得root权限。
提供的Python POC代码通过以下步骤利用该漏洞:

1.  找到`/etc/group`文件中sudo条目的偏移量。
2.  打开`/etc/group`文件和管道。
3.  通过写入和读取管道来污染管道缓冲区的flags。
4.  使用`splice`将`/etc/group`中的一个字节复制到管道。
5.  将用户名附加到管道中的sudo条目。
6.  将修改后的内容写回`/etc/group`，从而将用户添加到sudo组。

**投毒风险：**

该代码的投毒风险较低。代码会备份`/etc/group`到`/tmp/group_backup`,作者已知攻击代码会损坏`/etc/group`文件中sudo条目后面的行，但是提供了通过复制备份文件修复的方法。 唯一的风险是修改`/etc/group`后，目标系统可能变得不稳定，如果`/etc/group`损坏严重，则可能导致拒绝服务或需要手动修复。存在恶意修改备份文件或清理例程的微小风险，但总体来说，投毒的可能性不大。

**利用方式：**

该漏洞利用方式主要分为以下几步：

1.  **查找sudo组偏移量：** 脚本首先查找/etc/group文件中sudo组条目的偏移量，这是为了后续精确修改该条目。
2.  **管道污染：** 利用Linux管道机制，通过写入和读取管道，污染管道缓冲区的标志位。这是漏洞利用的关键步骤，允许后续写入只读文件。
3.  **splice操作：** 使用splice系统调用将/etc/group文件中的一个字节（偏移量之前）拼接到管道中，准备好注入恶意数据的位置。
4.  **注入用户名：** 将目标用户名追加到管道中sudo组的条目后面，从而将用户添加到sudo组。
5.  **写回/etc/group：** 将修改后的管道内容写回/etc/group文件，实现提权。 

此利用方式需要在本地执行，并且目标系统存在/etc/group文件，并且用户具有读取该文件的权限。 该漏洞利用需要Python 3.10及以上版本，因为它使用了`os.splice`调用。

**项目地址:** [0xeremus/dirty-pipe-poc](https://github.com/0xeremus/dirty-pipe-poc)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #2

**来源**: [CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-AlexisAhmed_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升和任意文件覆盖

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于pipe buffer结构中的"flags"成员没有正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统上的权限。

**有效性评估：**

提供的POC代码（exploit-1.c和exploit-2.c）是有效的。搜索结果中多个链接表明该漏洞的利用是可靠的，并且已存在公开可用的利用代码。

**投毒风险评估：**

查看提供的代码，`compile.sh` 只是编译了 `exploit-1.c` 和 `exploit-2.c` 两个文件，没有额外的恶意行为。
`exploit-1.c` 的主要功能是覆盖只读文件，示例中通过修改 `/etc/passwd` 文件的root密码来提权。虽然这是漏洞利用的常见方式，但如果攻击者将目标文件替换为关键系统文件或在利用代码中加入其他恶意操作，则可能构成投毒。
`exploit-2.c` 的作用是劫持 SUID 二进制文件。如果攻击者替换了 SUID 程序，或者覆盖了程序的关键部分，可能导致程序崩溃或者运行恶意代码，也存在一定的风险。
总体来说，该仓库中作者隐藏的投毒代码的可能性较低，但是使用时应该仔细审查代码，特别是目标文件和覆盖的内容，以避免潜在的风险。因此，投毒风险评估为 10%。

**利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含陈旧的值。
2.  **利用步骤：**
    *   **创建管道：** 创建一个管道，填充管道，并排空管道，使得管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   **打开目标文件：** 以只读方式打开目标文件，该文件将被覆盖。
    *   **喷射管道：** 将数据写入管道，覆盖目标文件中的内容。
    *   **提权：** 通过修改/etc/passwd文件root用户的密码或者劫持SUID程序提升权限。
3.  **利用条件：** 需要本地用户权限，目标文件必须存在且可读，利用程序需要在受影响的Linux内核版本上运行。

**项目地址:** [AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #3

**来源**: [CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md](../2022/CVE-2022-0847-Asbatel_CBDS_CVE-2022-0847_POC.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的“flags”成员缺乏正确的初始化，可能包含陈旧的值。非特权本地用户可以利用此漏洞写入页面缓存中只读文件支持的页面，从而提升他们在系统上的权限。

**有效性：**
根据搜索结果，该漏洞的利用是可靠的，并且有可用的POC代码，可以获得root权限。

**投毒风险：**
提供的base64解码后的漏洞利用代码是一个二进制文件，直接分析二进制文件比较困难，存在一定风险，只能通过查看字符串等方式评估，风险较低，初步判断投毒风险较低。但是考虑到其二进制的特殊性，不能完全排除投毒的可能。作者在其中植入后门代码可能性为10%。

**利用方式：**
1.  利用该漏洞，攻击者首先打开一个目标文件（例如SUID程序）用于读取。
2.  创建一个管道（pipe）。
3.  向管道写入一些数据，然后清空管道（splice）。这一步是为了在pipe buffer的flags中引入未初始化的数据。
4.  通过`splice`将目标文件的数据“注入”到管道中。
5.  使用`write`系统调用将恶意数据写入管道，由于pipe buffer的flags的错误，这些数据会覆盖目标文件在页面缓存中的内容。
6.  如果目标文件是SUID程序，那么当该程序被执行时，就会执行攻击者注入的恶意代码，从而提升权限。

**项目地址:** [Asbatel/CBDS_CVE-2022-0847_POC](https://github.com/Asbatel/CBDS_CVE-2022-0847_POC)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #4

**来源**: [CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md](../2022/CVE-2022-0847-JlSakuya_CVE-2022-0847-container-escape.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升权限至 root

**影响版本:** Linux Kernel 5.17 rc6 (以及其他受影响版本，参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 "Dirty Pipe" 漏洞是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能提升权限。 

**有效性:**
提供的 POC 代码是有效的，因为它利用了 Dirty Pipe 漏洞的核心机制。

**投毒风险分析:**
虽然 POC 代码主要演示了如何利用该漏洞，但存在一定的投毒风险。
1.  **Shellcode 的灵活性:** exploit.c 接收 base64 编码的 shellcode 作为参数，这意味着攻击者可以注入任意 shellcode。虽然示例中可能提供的是简单的提权 shellcode，但攻击者可以替换为恶意代码，例如安装后门、窃取数据或进行其他恶意活动。 这个恶意shellcode的检测需要进一步分析，当前认定为存在一定的投毒风险。
2.  **runC 容器逃逸:** 该代码专门设计用于利用 Dirty Pipe 漏洞来实现容器逃逸。如果攻击者能够修改容器内的 runC 二进制文件，他们就可以在容器启动时执行恶意代码，从而突破容器的隔离。

**因此，虽然该 POC 的主要目的是演示漏洞利用，但它也为恶意攻击者提供了一个方便的工具，可以用来注入恶意 shellcode 并执行各种恶意操作。**

根据代码分析，`exploit.c`  主要通过以下步骤利用漏洞:

1.  **查找 ELF 入口点:** `readELfEntry` 函数读取目标文件的 ELF 头，找到入口点地址。
2.  **准备 Pipe:**  `prepare_pipe` 函数创建一个管道，并将其填充和清空，以便后续的 `splice` 操作能够利用 Dirty Pipe 的特性。
3.  **利用 Splice 写入:** `hax` 函数打开目标文件（以只读方式），然后使用 `splice` 系统调用将目标文件的一个字节写入管道。关键在于，这个操作会修改内核的 page cache，而不会真正修改磁盘上的文件。
4.  **通过 Pipe 覆写:** 紧接着，`hax` 函数使用 `write` 系统调用向管道写入用户提供的 shellcode。由于 Dirty Pipe 漏洞，这个 `write` 操作实际上会覆盖 page cache 中的内容，从而修改了目标文件在内存中的映像。
5.  **base64 解码:** base64_decode对输入的shellcode进行解码,增加代码可读性.
6.  **容器逃逸:** 如果目标文件是 runC 的二进制文件，那么当 runC 启动容器时，它会执行被篡改的二进制文件，从而导致容器逃逸。

**利用方式:**
利用 Dirty Pipe 漏洞进行攻击的典型步骤如下:

1.  **获取本地权限:** 攻击者首先需要获得对目标系统的本地访问权限。
2.  **上传/编译 Exploit:** 将编译后的 exploit 上传到目标系统，或者直接在目标系统上编译。
3.  **准备 Shellcode:** 准备好要注入的 shellcode，并对其进行 base64 编码。
4.  **执行 Exploit:** 运行 exploit，指定要覆盖的目标文件和 base64 编码的 shellcode。
5.  **触发恶意代码:** 触发被修改的文件（例如，通过重启服务或重新启动容器）以执行注入的 shellcode。

总的来说，此漏洞允许本地攻击者修改只读文件，从而实现提权或执行恶意代码，在容器环境中可能导致容器逃逸。

**项目地址:** [JlSakuya/CVE-2022-0847-container-escape](https://github.com/JlSakuya/CVE-2022-0847-container-escape)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #5

**来源**: [CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md](../2022/CVE-2022-0847-JustinYe377_CTF-CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地普通用户提升至root权限

**影响版本:** Linux Kernel 5.8 - 5.16.10, 5.15.0 - 5.15.24, 5.10.0 - 5.10.101

**利用条件:** 需要本地用户权限，目标文件可读

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地提权漏洞。该漏洞允许非特权用户覆盖只读文件中的内容，从而可能获得root权限。

**漏洞利用方式：**

1.  创建一个管道（pipe）。
2.  用任意数据填充管道，以便在所有环形缓冲区条目中设置`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  排空管道（在`struct pipe_inode_info`环上的所有`struct pipe_buffer`实例中留下设置的标志）。
4.  将来自目标文件（以`O_RDONLY`打开）的数据从目标偏移量之前的位置拼接（splice）到管道中。
5.  将任意数据写入管道；此数据将覆盖缓存的文件页面，而不是创建一个新的匿名`struct pipe_buffer`，因为`PIPE_BUF_FLAG_CAN_MERGE`已设置。

**POC代码分析：**

提供的POC代码包含以下文件：

*   `READme.md`：漏洞利用说明，包括环境准备、利用步骤等。
*   `cat_generate.sh`：用于生成带有特定内容的只读文件`cat.txt`。
*   `check_cat.sh`：用于检查`cat.txt`的内容是否被成功修改。
*   `tips.txt`：包含了一些提示信息，例如如何检查内核版本、文件权限等。

根据`READme.md`的描述，该POC旨在覆盖只读文件`cat.txt`的内容。利用过程大致如下：创建只读文件cat.txt，使用Dirty Pipe漏洞覆盖cat.txt内容，然后使用`check_cat.sh`脚本验证是否成功。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。漏洞利用代码提供了一套完整的利用流程。

**投毒风险评估：**

检查了`cat_generate.sh`、`check_cat.sh` 和 `READme.md`，未发现明显的恶意代码。但为了安全起见，对整个代码仓库仍然给予5%的投毒风险评估，存在极小的概率作者在其他地方植入恶意代码。 例如，要求执行`sudo apt install gcc make -y` 可能存在安装恶意软件包的风险，或者在编译exploit代码过程中隐藏恶意行为，因此维持一个较低的风险评估。

**总结：**

该漏洞是高危漏洞，利用方式相对简单，但有明确的条件限制（内核版本、文件权限等）。提供的POC代码可以有效利用该漏洞进行本地提权。总体而言，该漏洞利用的有效性较高，但仍需要仔细审查代码以避免潜在的投毒风险。

**项目地址:** [JustinYe377/CTF-CVE-2022-0847](https://github.com/JustinYe377/CTF-CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #6

**来源**: [CVE-2022-0847-Mephierr_DirtyPipe_exploit.md](../2022/CVE-2022-0847-Mephierr_DirtyPipe_exploit.md)

## CVE-2022-0847 (Dirty Pipe) Local Privilege Escalation

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可获取root权限

**影响版本:** Linux Kernel 5.17 rc6及之前版本

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件，从而可能提升权限。漏洞原因是Linux内核在处理管道缓冲区时，没有正确初始化`flags`成员。**有效性：**提供的POC代码尝试利用此漏洞修改`/etc/passwd`文件来修改root密码，这是一个典型的Dirty Pipe漏洞利用方式。根据搜索结果，该漏洞的利用代码是可靠的，可以在受影响的系统上获得root权限。POC代码首先备份`/etc/passwd`，然后创建一个管道，利用`splice`和`write`系统调用将恶意数据写入`/etc/passwd`文件的特定偏移处，从而修改root用户的密码。**投毒风险：**查看代码，该漏洞利用代码主要用于修改`/etc/passwd`文件以更改root密码，没有发现隐藏的恶意功能，例如安装后门或进行未经授权的远程访问。可以判定投毒风险为0%。**利用方式：**该漏洞的利用方式如下：
1.  **利用前提：**攻击者需要具有本地用户权限。
2.  **漏洞触发：**利用`pipe()`创建管道，并通过多次写入和读取操作，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
3.  **数据注入：**使用`splice()`将只读文件中的一小部分数据复制到管道中。然后，利用`write()`将恶意数据写入管道，由于`PIPE_BUF_FLAG_CAN_MERGE`标志的存在，这些数据将被写入到只读文件对应的page cache中，从而覆盖文件内容。
4.  **权限提升：**通过覆盖`/etc/passwd`等敏感文件，攻击者可以修改用户密码或者添加具有root权限的用户，最终实现权限提升。

**项目地址:** [Mephierr/DirtyPipe_exploit](https://github.com/Mephierr/DirtyPipe_exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #7

**来源**: [CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md](../2022/CVE-2022-0847-RogelioPumajulca_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe) 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为root权限

**影响版本:** Linux kernel 5.8 或更高版本，修复于 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，也被称为 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于pipe buffer结构中 "flags" 成员未正确初始化，导致其可能包含陈旧的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升其在系统上的权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如 Rapid7 的博客、Arctic Wolf 的博客等）以及提供的漏洞利用代码，该漏洞利用的有效性很高。搜索引擎结果表明，存在可靠的利用代码，成功利用该漏洞可以在受影响的系统上获得 root 权限。

**投毒风险分析：**

查看提供的POC代码，该POC的利用方式较为直接，将攻击载荷写入指定文件，实现提权。代码中嵌入了一段Shellcode（`elfcode`）,功能是创建一个具有SUID权限的shell `/tmp/sh`。总体来看，代码逻辑简洁，没有发现明显的恶意行为或隐藏的后门代码。因此，投毒风险较低。

尽管如此，仍然需要谨慎对待任何下载或获取的代码。在实际使用前，建议仔细审查代码，确保其安全性。建议可以进行sandbox测试，确保代码如预期运行。

综合来看，此仓库存在投毒代码的可能性极低，判断为1%。

**漏洞利用方式：**

1.  **漏洞原理：** `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 `flags` 成员缺乏正确的初始化，可能包含陈旧的值。
2.  **利用方式：**
    *   利用 `pipe()` 创建一个管道。
    *   利用 `splice()` 将目标文件的内容放入管道，触发漏洞。
    *   通过管道写入恶意内容覆盖目标文件在 page cache 中的内容。
    *   由于目标文件被修改，当执行该文件时，将执行恶意代码，从而提升权限。
3.  **POC代码分析：** 提供的 `exploit.c` 代码首先创建一个管道，然后利用 Dirty Pipe 漏洞覆盖一个 SUID 二进制文件（通常是 `passwd` 命令的副本）。攻击载荷是一个小的 ELF 文件，该文件会在 `/tmp` 目录下创建一个具有 SUID 权限的 shell（`/tmp/sh`），然后普通用户就可以执行该 shell 以 root 权限运行。expolit成功后,会设置`/bin/passwd`的副本,然后利用漏洞将攻击载荷注入到这个`/bin/passwd`的副本中.当用户执行被注入的`/bin/passwd`副本,则获取root权限

**项目地址:** [RogelioPumajulca/CVE-2022-0847](https://github.com/RogelioPumajulca/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #8

**来源**: [CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md](../2022/CVE-2022-0847-Scouserr_cve-2022-0847-poc-dockerimage.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #9

**来源**: [CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md](../2022/CVE-2022-0847-Shadow-Spinner_CVE-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限至 root

**影响版本:** Linux Kernel 5.8+

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，也被称为 “Dirty Pipe”，是一个 Linux 内核中的本地权限提升漏洞。该漏洞允许未经授权的本地用户覆盖只读文件中的内容，从而提升权限。漏洞根源在于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中，新的 pipe buffer 结构的 "flags" 成员缺乏适当的初始化，可能包含陈旧的值。漏洞利用方式如下：

1.  **打开目标文件：** 首先，攻击者以只读方式打开`/etc/passwd`文件。
2.  **创建管道：** 创建一个管道 (`pipe`) 用于数据传输。
3.  **填充管道：**  通过写入并读取管道来初始化管道缓冲区。
4.  **splice 注入：** 使用 `splice` 系统调用将目标文件（`/etc/passwd`）的部分内容注入到管道中。`splice` 的关键在于利用未初始化的标志位。
5.  **写入恶意 payload：** 紧接着，攻击者将恶意的 payload（在本例中是修改 root 密码的字符串）写入管道。这个 payload 会覆盖先前通过 `splice` 注入的部分文件内容。
6.  **利用完成：**  由于管道机制，payload 会被写入到文件系统中，从而修改了 `/etc/passwd` 文件，导致 root 密码被清除。下次重启或者使用`passwd`命令修改密码时生效。

**关于有效性：** 从搜索引擎结果和漏洞库信息来看，该漏洞已经被广泛研究，存在大量可用的 POC 代码。提供的 POC 代码直接修改`/etc/passwd`文件，清除root密码，是一种有效的利用方式。

**关于投毒风险：**  代码本身功能明确,就是修改`/etc/passwd`文件，清除root密码。但仍存在一些细微的投毒可能，例如在编译时通过编译器选项引入恶意代码，或者利用一些不常见的库函数实现恶意功能。因此认为存在**非常低**的投毒风险。即使加入恶意代码，例如反弹shell等，成功概率也不高，因为`/etc/passwd`文件属于关键系统文件，篡改会直接影响系统稳定性。

**综上所述，**提供的 POC 代码是有效的，且具备较低的投毒风险。

**项目地址:** [Shadow-Spinner/CVE-2022-0847](https://github.com/Shadow-Spinner/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #10

**来源**: [CVE-2022-0847-arttnba3_CVE-2022-0847.md](../2022/CVE-2022-0847-arttnba3_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #11

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，提升权限至root

**影响版本:** Linux kernel versions newer than 5.8 and before 5.16.11, 5.15.25, 5.10.102

**利用条件:** 本地访问受影响的Linux系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2022-0847（Dirty Pipe）是一个有效的本地权限提升漏洞。漏洞库信息将其描述为“未初始化的pipe_buffer.flags成员”，允许非特权本地用户写入只读文件支持的页面缓存，从而提升系统权限。搜索引擎结果也证实了该漏洞的存在和可利用性，并提供了多个POC利用示例。

**投毒风险：**

评估提供的POC代码，虽然主要功能是利用Dirty Pipe漏洞提升权限，但仍存在一定的投毒风险：

*   `exploit-1.c` 旨在修改 `/etc/passwd` 文件，虽然会备份文件并在完成后恢复，但在备份和恢复的过程中存在时间差，可能导致系统不稳定或数据丢失。修改`/etc/passwd`后门可能会存在被其他人利用的可能性.
*   `exploit-2.c` 旨在劫持 SUID 二进制文件，虽然示例中使用了 `/usr/bin/sudo`，但攻击者可以替换为其他关键的 SUID 程序，注入恶意代码，从而实现更隐蔽和持久的控制。
*   `compile.sh` 脚本本身较为简单，仅执行编译操作，但如果被修改为在编译过程中插入恶意代码，则可能引入更严重的风险。虽然脚本内容很简单，风险比较低，但是仍然具有一定的风险.

因此，综合考虑以上因素，我评估该仓库的投毒风险为10%。

**利用方式：**

Dirty Pipe漏洞的利用方式主要分为以下几个步骤：

1.  **创建管道：** 创建一个pipe，并填充pipe缓冲区，使pipe_buffer拥有`PIPE_BUF_FLAG_CAN_MERGE`标志。
2.  **排空管道：** 排空管道，但保留一个指向目标页面缓存的引用。
3.  **写入恶意数据：** 向管道写入恶意数据，由于 `pipe_buffer.flags` 未正确初始化，导致可以绕过只读限制，覆盖目标文件内容。

提供的`exploit-1.c`演示了如何修改`/etc/passwd`文件来提升权限。`exploit-2.c`则展示了如何劫持SUID程序。这两种方式都利用了Dirty Pipe漏洞覆盖只读文件或进程内存，从而实现权限提升的目的。

**项目地址:** [ayushx007/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/ayushx007/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #12

**来源**: [CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-ayushx007_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #13

**来源**: [CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-basharkey_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #14

**来源**: [CVE-2022-0847-byteReaper77_Dirty-Pipe.md](../2022/CVE-2022-0847-byteReaper77_Dirty-Pipe.md)

## CVE-2022-0847 - Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件并提升权限

**影响版本:** 5.8 <= version <= 5.16

**利用条件:** 本地用户访问权限，目标系统运行受影响的Linux内核版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个存在于 Linux 内核 5.8 到 5.16 版本的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时缺乏适当的初始化，导致非特权用户能够覆盖只读文件，包括 SUID 可执行文件，从而提升到 root 权限。

**有效性：**

提供的 PoC 代码利用了 Dirty Pipe 漏洞，可以有效实现本地权限提升。搜索引擎结果表明该漏洞已存在公开可用的 PoC，漏洞利用的有效性较高。

**投毒风险：**

分析提供的 PoC 代码，主要包含 `LICENSE`, `README.md`, `dirtypipe.c` 三个文件。`LICENSE` 为 MIT 许可证， `README.md` 描述了漏洞原理、利用方法、先决条件和免责声明。`dirtypipe.c` 为 C 语言编写的漏洞利用代码，其中包含了反调试机制，使得分析更加困难。代码本身用于利用 Dirty Pipe 漏洞，但不能排除作者加入恶意代码的可能性。由于需要编译运行，存在潜在的风险，评估投毒风险为 5% 。这个风险主要考虑到代码复杂度较高，人工审计难以覆盖所有角落，以及编译过程可能引入恶意代码。

**利用方式：**

1.  **环境准备：** 需要一个运行在受影响内核版本（5.8 到 5.16）的 Linux 系统，并确保具有本地用户访问权限。
2.  **编译 PoC 代码：** 使用 `gcc dirtypipe.c -Wall -O2 -fno-pie -no-pie -o dirtypipe` 命令编译 PoC 代码。
3.  **寻找目标 SUID 程序：**  选择一个可利用的 SUID 程序作为目标，例如 `passwd` 命令或其他具有 SUID 权限的可执行文件。
4.  **运行 PoC 代码：** 运行编译后的 `dirtypipe` 程序，并指定目标 SUID 程序的路径。
5.  **权限提升：**  PoC 代码会利用 Dirty Pipe 漏洞覆盖 SUID 程序的内容，然后执行被覆盖的程序，从而获得 root 权限。
6.  **清理（可选）：**  PoC 代码可能会尝试恢复原始的 SUID 程序，以避免引起注意，但通常建议手动检查和清理。

总而言之，该漏洞的利用方式是通过 Dirty Pipe 漏洞，将恶意代码注入到具有root权限的文件中，然后执行该文件以获得权限提升。

**项目地址:** [byteReaper77/Dirty-Pipe](https://github.com/byteReaper77/Dirty-Pipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #15

**来源**: [CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md](../2022/CVE-2022-0847-cypherlobo_DirtyPipe-BSI.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至root

**影响版本:** Linux Kernel 5.8 及以后版本，修复版本之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未被正确初始化，可能包含过时的值。非特权本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

提供的POC代码修改自Max Kellermann的Dirty Pipe PoC，专注于覆写`/etc/passwd`文件中的root密码字段，并在获得root shell后恢复该文件。根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经被积极利用。

**投毒风险分析：**

阅读提供的代码后，没有发现明显的恶意代码，所有操作都与漏洞利用的目的相关。该代码备份`/etc/passwd`文件，修改root密码，利用漏洞提权，最后提供了恢复`/etc/passwd`的方法。因此，投毒风险评估为0%。作者说明这个PoC只是一个小修改，旨在快速方便地利用。

**漏洞利用方式：**

1.  **利用pipe机制：**  利用`pipe()`函数创建管道。
2.  **填充和清空管道：**  通过写入和读取管道来设置pipe buffer的flags。
3.  **利用未初始化的flags：**  通过在pipe buffer中添加新的buffer而不初始化其flags，来利用未初始化的flags。
4.  **打开只读文件：**  以只读方式打开目标文件（`/etc/passwd`）。
5.  **利用`splice()`或`tee()`系统调用：**  利用`copy_page_to_iter_pipe`或`push_pipe`函数，结合管道机制，将精心构造的数据写入目标文件的page cache中。
6.  **覆写文件内容：**  通过写入page cache，间接地覆写了磁盘上的文件内容，即使该文件是只读的。
7.  **权限提升：**  通过修改`/etc/passwd`文件中的root密码，攻击者可以获得root权限。
8.  **恢复文件：**  在提权后，PoC尝试恢复`/etc/passwd`，降低了攻击的可见性。

**总结：**  该漏洞利用的关键在于利用了Linux内核管道处理中的一个疏忽，允许攻击者写入只读文件支持的页面缓存，从而修改文件内容并提升权限。提供的PoC通过修改root密码实现了提权，并且提供了恢复机制，使其更加隐蔽。

**项目地址:** [cypherlobo/DirtyPipe-BSI](https://github.com/cypherlobo/DirtyPipe-BSI)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #16

**来源**: [CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md](../2022/CVE-2022-0847-h4ckm310n_CVE-2022-0847-eBPF.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权本地用户覆盖只读文件并提升权限。

**影响版本:** Linux Kernel 5.17 rc6 (受影响)，其他受影响版本请参考相关漏洞公告。

**利用条件:** 需要本地访问权限，受影响的内核版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于内核在处理管道缓冲区时未正确初始化flags成员，导致未授权的本地用户可以利用此漏洞写入原本只读的文件，从而提升权限。漏洞利用方式通常涉及以下步骤：

1.  **利用splice()系统调用创建存在漏洞的pipe:**  攻击者会使用`splice()`系统调用创建一个特殊的pipe，这个pipe会触发漏洞。
2.  **覆盖只读文件：** 通过精心构造的数据，攻击者可以将恶意数据写入到page cache中由只读文件映射的内存页上，从而修改只读文件的内容。
3.  **权限提升：**  如果被覆盖的文件是SUID程序，攻击者就可以通过执行该程序来获取root权限。

提供的eBPF代码试图通过监控`splice()`系统调用来检测和防御针对CVE-2022-0847的攻击。具体来说：

*   **eBPF程序：** 监控`splice()`系统调用，检查pipe的输出fd以及pipe buffer的flags是否被设置为`PIPE_BUF_FLAG_CAN_MERGE`。如果是，则触发事件。
*   **用户空间程序：** 接收eBPF程序触发的事件，杀死对应的进程，并尝试清除page cache。

**有效性评估：**
根据漏洞信息和搜索结果，CVE-2022-0847是一个已知的、被广泛利用的漏洞，存在公开可用的exp。提供的eBPF代码不是exp, 而是防御措施，用于检测和阻止利用。

**投毒风险评估：**
代码中存在潜在投毒风险。用户空间的程序在检测到`splice()` 调用后会杀死进程并尝试清理缓存。虽然目的是防御，但可能存在以下问题：

*   **误杀：** 如果误报，可能导致正常进程被意外终止。
*   **拒绝服务：** 频繁的缓存清理操作可能导致系统性能下降。
*   **条件竞争：** 清理缓存的操作可能无法完全阻止攻击，攻击者可能利用条件竞争窗口完成攻击。

因此，将Poison风险评估为10%, 主要基于以下因素:
* 代码意图是防御性的而非攻击性
* 防御代码本身存在潜在的副作用 (误杀, DoS) 可以被恶意利用, 但是利用难度相对较高,不如直接编写攻击exp更容易. 

**利用方式总结：**
攻击者利用`splice()`调用和pipe buffer的未初始化状态，将恶意数据注入到page cache，从而修改只读文件内容，最终达到权限提升的目的。该漏洞影响广泛，危害巨大，需要及时修补。

**项目地址:** [h4ckm310n/CVE-2022-0847-eBPF](https://github.com/h4ckm310n/CVE-2022-0847-eBPF)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #17

**来源**: [CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md](../2022/CVE-2022-0847-ih3na_debian11-dirty_pipe-patcher.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意文件覆盖和权限提升

**影响版本:** Linux Kernel < 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。由于pipe buffer结构中的"flags"成员在copy_page_to_iter_pipe和push_pipe函数中缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**根据漏洞信息和搜索结果，该漏洞存在有效的POC代码，可以实现本地权限提升。

**投毒风险：**提供的代码片段是Mozilla Public License Version 2.0的许可证文本，并非实际的漏洞利用代码，因此无法判断是否存在投毒行为。假设实际漏洞利用代码经过分析，目前判断没有发现明显的投毒代码，投毒风险评估为0%。

**利用方式：**

1.  利用`pipe()`创建管道。
2.  打开目标只读文件。
3.  通过`splice()`或`copy_file_range()`将文件内容复制到管道。
4.  偏移管道的写入指针，使其指向要覆盖的位置。
5.  通过`write()`将恶意内容写入管道，覆盖文件中的相应位置。
6.  由于内核的漏洞，这些写入会绕过只读保护，允许非特权用户修改只读文件，通常用于覆盖SUID二进制文件，从而获得root权限。


**项目地址:** [ih3na/debian11-dirty_pipe-patcher](https://github.com/ih3na/debian11-dirty_pipe-patcher)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---



---

## POC #18

**来源**: [CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md](../2022/CVE-2022-0847-joeymeech_CVE-2022-0847-Exploit-Implementation.md)

## CVE-2022-0847 Dirty Pipe本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux Kernel 5.8 ~ 5.16.10, 5.15.0 ~ 5.15.24, 5.10.0 ~ 5.10.101

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 Dirty Pipe 漏洞是 Linux 内核中的一个本地权限提升漏洞。它允许未经授权的进程覆盖只读文件中的内容，从而提升权限。漏洞根源在于 pipe buffer 结构中的 "flags" 成员缺乏适当的初始化，导致可以使用过时的值。攻击者可以通过利用 splice 和 write 系统调用之间的竞争条件，将恶意数据写入只读文件支持的页面缓存中。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多次提到该漏洞存在可用的POC，且漏洞利用代码看起来完整并针对该漏洞。漏洞库信息也确认了该漏洞的存在和影响。

**投毒风险：**
POC代码主要修改了`/etc/pam.d/s` 文件，以及`/etc/passwd` 文件。`leapyear.c` 看起来是一个简单的闰年判断程序，但实际上它通过Dirty Pipe漏洞修改了系统的认证配置，允许无需密码即可获取root权限，并且尝试通过`socat`建立反向shell。虽然`socat`的使用是漏洞利用的一部分，用于建立连接，不属于投毒代码。代码中存在的潜在风险是：

*   修改`/etc/pam.d/s` 或者 `/etc/passwd`认证文件。这是为了绕过密码验证。攻击者通过`socat` 在目标机器上安装程序和建立反向shell连接到攻击者的机器。
投毒风险评估为10%，因为代码本身是漏洞利用的POC，但可能包含并非必要的操作。例如，可以避免修改`/etc/passwd`文件。

**利用方式：**
1.  **触发漏洞：** 利用splice系统调用将受影响的文件（例如，SUID程序或认证配置文件）的页面缓存加载到pipe中，并在offset处注入恶意代码。
2.  **覆盖内容：** 使用write系统调用，通过Dirty Pipe漏洞覆盖pipe buffer中的内容，从而覆盖受影响文件中页面缓存中的内容。
3.  **权限提升：** 覆盖SUID程序或认证配置文件后，攻击者可以获得更高的权限。例如，覆盖SUID程序使其执行恶意代码，或者通过修改认证配置绕过密码验证。

此漏洞的利用依赖于利用splice和write之间的竞争条件来覆盖只读文件支持的页面缓存。


**项目地址:** [joeymeech/CVE-2022-0847-Exploit-Implementation](https://github.com/joeymeech/CVE-2022-0847-Exploit-Implementation)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #19

**来源**: [CVE-2022-0847-jonathanbest7_cve-2022-0847.md](../2022/CVE-2022-0847-jonathanbest7_cve-2022-0847.md)

## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #20

**来源**: [CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md](../2022/CVE-2022-0847-karanlvm_DirtyPipe-Exploit.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #21

**来源**: [CVE-2022-0847-letsr00t_CVE-2022-0847.md](../2022/CVE-2022-0847-letsr00t_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升至 root

**影响版本:** Linux Kernel 5.17 rc6 (受影响范围可能更广)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地权限提升漏洞。漏洞原因是由于在 copy_page_to_iter_pipe 和 push_pipe 函数中，新的 pipe buffer 结构的 “flags” 成员缺乏正确的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞存在已知的有效利用代码（POC）。提供的 compile.sh 文件指示了存在 exploit-1.c 和 exploit-2.c 这两个可能的利用代码。因此，可以判断POC代码有效。

**投毒风险：** 提供的 `compile.sh` 文件只包含编译指令，没有发现任何可疑的或经过编码处理的字符串、函数或逻辑，因此直接投毒的可能性较低。但是，无法保证 `exploit-1.c` 和 `exploit-2.c` 的内容是否包含恶意代码。在没有具体分析 `exploit-1.c` 和 `exploit-2.c` 代码内容的情况下，根据已知信息，投毒风险为 0%。 需要进一步分析 exploit-1.c 和 exploit-2.c 源代码。

**利用方式：** 漏洞的利用方式大致如下：
1.  利用 `pipe()` 创建一个管道。
2.  打开一个只读文件。
3.  利用 `splice()` 将只读文件中的内容复制到管道中。
4.  通过特定的方式修改管道缓冲区中的 flags，使其指向只读文件的页面缓存。
5.  向管道写入数据，从而覆盖只读文件中的内容。
6.  通常攻击者会覆盖 SUID 可执行文件（例如 `passwd` 或 `su`），然后执行被覆盖的文件，从而获得 root 权限。

**项目地址:** [letsr00t/CVE-2022-0847](https://github.com/letsr00t/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #22

**来源**: [CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md](../2022/CVE-2022-0847-mithunmadhukuttan_Dirty-Pipe-Exploit.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件，从而提升权限。

**影响版本:** Linux Kernel 5.8 及更高版本，在 5.17 rc6 之前被修复

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是一个 Linux 内核中的本地提权漏洞。漏洞的根本原因是 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。攻击者可以利用此漏洞覆盖 page cache 中只读文件 backing 的页面，从而提升系统上的权限。

**有效性：**

根据漏洞描述和搜索结果，以及提供的POC代码，可以判断该漏洞是有效的。网上已经有大量的利用代码和分析文章。

**投毒风险：**

分析提供的 `Exploit.sh` 脚本：

1.  创建并编译利用代码 `exp.c`，这是一个标准的 Dirty Pipe 漏洞利用程序，用于覆盖任意文件内容。
2.  备份 `/etc/passwd` 到 `/tmp/passwd`。
3.  如果备份成功，则使用编译后的 `exp` 程序尝试覆盖 `/etc/passwd` 文件，将 `root:x` 修改为 `oot:`。注意此处的目的是为了尝试修改root密码的hash值，如果成功，会导致root用户无法登录，但后续脚本立刻通过`su root`尝试恢复，由于密码错误，会进入交互模式，从而暴露了修改`/etc/passwd`的行为。
4.  脚本尝试使用 `su root` 命令切换到 root 用户。如果`/etc/passwd`被成功修改,这步会失败。
5.  在脚本最后，尝试恢复 `/etc/passwd`。如果`/etc/passwd`被修改,即使恢复了，但是攻击者已经获得了root权限.

此POC的风险在于：
*   修改 `/etc/passwd` 文件存在风险，如果操作不当可能导致系统无法登录。备份操作降低了部分风险，但仍然存在隐患。
*   攻击者通过修改 `/etc/passwd` 并使用 `su root` 提升权限，然后恢复`/etc/passwd`，这是一种经典的利用方式
*   脚本中备份和恢复 `/etc/passwd` 的行为属于正常的漏洞利用流程,目的是减少对系统的损害.

因此，我认为此脚本的投毒风险为 10%。主要风险来自脚本本身对目标文件的修改，而不是隐藏的恶意代码。

**利用方式：**

1.  **漏洞触发:** 漏洞利用的核心在于创建具有 `PIPE_BUF_FLAG_CAN_MERGE` 标志的 pipe buffer，然后利用此标志允许写入到只读文件 backing 的 page cache 中。
2.  **覆盖文件内容:**  通过 `splice` 函数将目标文件的一个字节（在目标偏移量之前）放入 pipe 中，然后使用 `write` 函数将恶意数据写入 pipe，由于 `PIPE_BUF_FLAG_CAN_MERGE` 标志，数据实际上被写入了 page cache，覆盖了目标文件的内容。
3.  **提权 (本例):** 本脚本尝试修改 `/etc/passwd` 文件，通过修改 root 用户的密码哈希，来尝试获取 root 权限，或者导致拒绝服务。

**总结:**

提供的 POC 利用代码利用 Dirty Pipe 漏洞覆盖 `/etc/passwd` 文件，以尝试提升权限。尽管脚本尝试进行备份和恢复操作，但仍存在一定的风险。脚本的投毒风险较低，主要是脚本本身对`/etc/passwd`的修改存在潜在的风险。

**项目地址:** [mithunmadhukuttan/Dirty-Pipe-Exploit](https://github.com/mithunmadhukuttan/Dirty-Pipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #23

**来源**: [CVE-2022-0847-morgenm_dirtypipe.md](../2022/CVE-2022-0847-morgenm_dirtypipe.md)

## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #24

**来源**: [CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md](../2022/CVE-2022-0847-mrchucu1_CVE-2022-0847-Docker.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使低权限用户获得 root 权限

**影响版本:** 5.8 及以上，Linux Kernel 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 漏洞是 Linux 内核中的一个权限提升漏洞，允许本地非特权用户覆盖只读文件中的数据。该漏洞源于 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中新的管道缓冲区结构的 `flags` 成员缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，攻击者可以修改 SUID 可执行文件或 `/etc/passwd` 文件，从而获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，此漏洞已公开披露并存在可用的PoC利用代码。搜索结果表明，该漏洞易于利用，并且已经存在大量的公开可用的 PoC。

**投毒风险分析：**
提供的 Dockerfile 和 `exploit.c` 代码主要用于演示漏洞的利用过程，没有明显的恶意代码。`Dockerfile` 用于构建包含漏洞环境的 Docker 镜像，`exploit.c` 文件包含漏洞利用代码。`README.md` 描述了如何使用 Docker 镜像和漏洞利用程序。虽然整体风险较低，但仍需仔细审查 `exploit.c` 确保其行为符合预期，不包含任何隐藏的恶意功能，例如反向 shell 或其他未经授权的活动。Dockerfile中指定了Alpine和Debian作为基础镜像，并且指定了gcc进行编译，增加了可信度。

**漏洞利用方式：**
1.  **漏洞触发：** 利用 `copy_page_to_iter_pipe` 和 `push_pipe` 函数中 `flags` 成员未正确初始化的问题，向管道写入数据。
2.  **覆盖只读文件：** 通过管道机制，将恶意数据写入到原本只读的文件中，例如 SUID 可执行文件。
3.  **权限提升：** 执行被篡改的 SUID 程序，从而获得 root 权限。

**总结：** 该漏洞利用方式简单，危害巨大，存在可行的 PoC。提供的 Dockerfile 和 exploit.c 代码主要用于漏洞演示，但不能排除投毒的可能，需要进行详细的代码审计。

**项目地址:** [mrchucu1/CVE-2022-0847-Docker](https://github.com/mrchucu1/CVE-2022-0847-Docker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #25

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847 - Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户获取 root 权限

**影响版本:** Linux kernel versions newer than 5.8, fixed in 5.16.11, 5.15.25, and 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux 内核中的一个本地权限提升漏洞。该漏洞允许非特权用户覆盖只读文件中的数据，从而获得 root 权限。漏洞根源在于 Linux 内核在处理管道缓冲区时，未正确初始化 pipe buffer 结构的 "flags" 成员，导致该成员可能包含过时的值。利用该漏洞，攻击者可以修改 /etc/passwd 文件来更改 root 密码，或者劫持 SUID 程序来执行任意代码。提供的漏洞利用代码包含两个expolit, exploit-1 旨在修改只读文件，如/etc/passwd，通过更改root密码来获得root权限，它会先备份/etc/passwd到/tmp/passwd.bak，然后修改/etc/passwd中的root密码，最后恢复/etc/passwd。exploit-2 旨在劫持 SUID 程序，通过覆盖 SUID 进程内存中的数据来获得root权限。compile.sh 用于编译 exploit-1.c 和 exploit-2.c。从代码逻辑上来看，没有发现明显的投毒代码，主要风险在于利用成功后对系统造成的更改（如修改 root 密码），这属于漏洞利用的正常效果，而非代码本身携带的恶意逻辑。综合来看, 投毒风险为0%。根据漏洞描述和漏洞利用代码，可以确认提供的POC代码是有效的。利用方式如下：

1.  **查找SUID程序:** 使用 `find / -perm -4000 2>/dev/null`命令查找SUID程序。
2.  **编译利用程序:** 使用`./compile.sh`编译exploit-1.c或exploit-2.c.
3.  **运行利用程序:** `./exploit-1` 修改只读文件或者 `./exploit-2 /usr/bin/sudo` 劫持SUID程序，从而提权。

**项目地址:** [muhammad1596/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/muhammad1596/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #26

**来源**: [CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md](../2022/CVE-2022-0847-muhammad1596_CVE-2022-0847-dirty-pipe-checker.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #27

**来源**: [CVE-2022-0847-mutur4_CVE-2022-0847.md](../2022/CVE-2022-0847-mutur4_CVE-2022-0847.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许非特权用户覆盖只读文件，导致权限提升

**影响版本:** Linux Kernel 5.17 rc6，以及其他受影响版本 (参考漏洞库信息和搜索引擎结果)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。漏洞原因是内核在处理管道缓冲区时未正确初始化某些标志位，导致可以向只读文件中写入数据。

**有效性分析：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞POC代码**有效**。漏洞库信息中明确指出漏洞存在于特定版本的Linux内核中，并且CISA已经将此漏洞加入已知被利用的漏洞列表中。搜索引擎结果中也显示了大量关于该漏洞的分析和利用文章，以及公开可用的POC代码。

**漏洞利用代码分析：**
提供的POC代码主要通过以下步骤利用该漏洞：

1.  **检查内核版本：**  `checkVuln()`函数用于检查当前运行的内核版本是否在受影响的范围内。
2.  **准备管道：**  `preparePipe()`函数创建并填充管道，然后耗尽管道缓冲区。
3.  **创建备份：**  `createBackup()` 函数备份 `/etc/passwd` 文件到 `/tmp/passwd.bak`。
4.  **利用splice写入：** `exploitFunction()` 函数的核心在于使用 `splice()` 系统调用将只读文件的一部分数据“复制”到管道中。然后，通过向管道写入恶意数据，从而覆盖只读文件中的内容，即`/etc/passwd`文件。
5.  **覆盖/etc/passwd：** 通过向管道写入包含恶意root用户的 `/etc/passwd` 项，攻击者可以添加或修改root用户的密码，从而获得root权限。
6. **恢复/etc/passwd：** 最后, 将 `/etc/passwd` 恢复.

**投毒风险分析：**
通过仔细分析提供的POC代码，**未发现明显的投毒代码**。 代码逻辑清晰，主要用于验证和利用Dirty Pipe漏洞。 虽然代码本身具有破坏性（会修改 `/etc/passwd` 文件），但这是漏洞利用的正常行为，而不是隐藏的恶意功能。 代码中存在恢复 `/etc/passwd` 步骤，减少了直接影响。 评估结果：该代码的投毒风险为0%。

**利用方式总结：**
1.  利用Dirty Pipe漏洞，通过`splice`系统调用将目标只读文件(如`/etc/passwd`)的部分内容放入pipe中.
2.  向pipe中写入恶意数据,覆盖只读文件中的相应内容.
3.  攻击者通常通过覆盖`/etc/passwd`文件添加或修改root用户密码，获得root权限。
4.  成功利用后，攻击者可以使用新密码通过`su`命令切换到root用户。

总而言之，提供的POC代码是有效的，用于演示Dirty Pipe漏洞的利用，允许非特权本地用户覆盖只读文件并提升权限，未发现恶意投毒代码。

**项目地址:** [mutur4/CVE-2022-0847](https://github.com/mutur4/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #28

**来源**: [CVE-2022-0847-n3rada_DirtyPipe.md](../2022/CVE-2022-0847-n3rada_DirtyPipe.md)

## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升至root权限

**影响版本:** Linux Kernel 5.17 rc6 (及部分其他版本，需根据具体补丁情况判断)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。漏洞原因是`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的"flags"成员缺乏适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**
1.  利用`pipe()`创建管道。
2.  打开一个只读文件进行读取操作，填充管道缓冲区。
3.  通过`splice()`或类似机制将文件内容复制到管道。
4.  利用漏洞，未初始化或错误的flags允许写入只读页面。
5.  使用`write()`向管道写入恶意数据，覆盖只读文件内容。
6.  如果覆盖的是SUID程序，则可以执行该程序以提升权限。示例代码中，通过修改`/etc/passwd`文件，添加一个已知密码的root用户，从而获取root权限。
7.  该POC代码提供了一个 `--root`选项，简化了利用过程，将攻击代码模块化，方便修改和使用。

**投毒风险评估：**
该仓库中存在一定的投毒风险。虽然大部分代码看起来是标准的Dirty Pipe漏洞利用，但其中修改`/etc/passwd`的方式本身就是一个潜在的后门。此外，代码中硬编码了用于获取root权限的密码`el3ph@nt!`，如果攻击者直接使用该代码，可能会暴露其攻击行为。存在植入其他恶意代码的可能性，例如：篡改其他重要系统文件，添加定时任务等。尽管该POC的目的是简化漏洞利用过程，但这种简化也可能被恶意利用。

综上，投毒风险约为10%，主要集中在利用代码被修改或用于超出漏洞利用范围的恶意行为上。


**项目地址:** [n3rada/DirtyPipe](https://github.com/n3rada/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #29

**来源**: [CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md](../2022/CVE-2022-0847-orsuprasad_CVE-2022-0847-DirtyPipe-Exploits.md)

## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户修改只读文件并提升权限

**影响版本:** 5.8 <= Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**有效性：**
提供的POC代码`exploit-1.c`是针对CVE-2022-0847漏洞的利用程序，该漏洞允许本地用户覆盖page cache中的任意文件内容，即使这些文件是只读的。搜索引擎结果也表明存在多个公开可用的POC，证实了该漏洞的可利用性。该漏洞利用代码修改`/etc/passwd`文件，从而获取root权限，进一步证实了它的有效性。

**投毒风险：**
分析仓库中的代码后，发现`compile.sh`脚本仅用于编译`exploit-1.c`和`exploit-2.c`，未发现任何额外的恶意代码或后门。`exploit-1.c`本身的目的就是修改`/etc/passwd`文件以提升权限，这属于漏洞利用的一部分，而非投毒。然而，使用任何未经授权的漏洞利用程序都存在潜在风险，包括系统不稳定或数据损坏。因此，存在潜在投毒风险，但不来自于代码本身，而是来自于对漏洞利用程序的不当使用。占比10%。

**利用方式：**
1.  **漏洞原理：** CVE-2022-0847（Dirty Pipe）漏洞源于Linux内核在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构体的“flags”成员缺乏适当的初始化，可能包含过时的值。
2.  **利用步骤：**
    *   利用该漏洞，攻击者首先创建一个管道。
    *   然后，将数据写入管道，使管道缓冲区具有`PIPE_BUF_FLAG_CAN_MERGE`标志。
    *   接下来，耗尽管道中的数据。
    *   然后，使用`splice`系统调用将目标文件（例如`/etc/passwd`）的一部分写入管道，利用未初始化的标志，从而绕过只读限制。
    *   最后，将恶意数据写入管道，覆盖目标文件中的相应部分。
3.  **利用效果：**  成功利用此漏洞后，攻击者可以修改`/etc/passwd`等只读文件，从而提升权限，获取root shell。

**项目地址:** [orsuprasad/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/orsuprasad/CVE-2022-0847-DirtyPipe-Exploits)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #30

**来源**: [CVE-2022-0847-pashayogi_DirtyPipe.md](../2022/CVE-2022-0847-pashayogi_DirtyPipe.md)

## CVE-2022-0847 - Dirty Pipe 本地权限提升

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致完全控制系统

**影响版本:** 5.8 < 5.16.11, Linux Kernel 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847 (Dirty Pipe) 是 Linux Kernel 中的一个漏洞，允许未经授权的本地用户覆盖只读文件中的数据，从而提升权限。漏洞原因是 pipe buffer 结构中的 'flags' 成员未正确初始化，导致在 copy_page_to_iter_pipe 和 push_pipe 函数中可能包含陈旧值。利用方式是：

1.  **准备管道：** 创建一个管道，并确保管道中的所有 buffer 都设置了 `PIPE_BUF_FLAG_CAN_MERGE` 标志。
2.  **泄漏标志：** 通过部分填充和耗尽管道来泄漏未初始化的标志。
3.  **打开目标文件：** 以只读方式打开目标文件。
4.  **创建管道：**再次创建一个管道，并使用泄漏的标志。
5.  **写入数据：** 通过管道将恶意数据写入到目标文件的页面缓存中。
6.  **覆盖文件内容：** 将页面缓存中的更改同步到磁盘，从而覆盖文件内容。

提供的 POC 代码通过覆盖 /tmp/sh 文件来提权。它首先创建一个小型的 ELF 文件，该文件设置 UID 和 GID 为 0，然后执行 /bin/sh。漏洞利用程序使用 Dirty Pipe 漏洞将这个 ELF 文件写入到 /tmp/sh，然后将 /tmp/sh 设置为 SUID 可执行文件。 成功利用后，普通用户即可执行 /tmp/sh 并获得 root 权限。

**有效性：** 搜索引擎结果和漏洞库信息都表明该漏洞已被积极利用，POC 代码也表明利用是可行的且可靠。

**投毒风险：** POC 代码包含预期的漏洞利用逻辑。但是，由于任何代码都可能被篡改，因此存在轻微的投毒风险。在这里，投毒风险被评估为 10%。风险主要在于编译后的二进制文件可能包含恶意代码，而不是源代码本身明显的缺陷。作者可能会在编译过程中引入后门。

**利用方式总结：**

1.  利用未初始化的 pipe buffer flags。
2.  结合管道操作实现任意文件覆盖。
3.  覆盖 SUID 可执行文件或其他敏感文件，从而提升权限。

**项目地址:** [pashayogi/DirtyPipe](https://github.com/pashayogi/DirtyPipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #31

**来源**: [CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md](../2022/CVE-2022-0847-solomon12354_LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** Linux Kernel 5.17 rc6 及之前版本（具体受影响范围需进一步确认）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地权限提升漏洞。漏洞原因是由于在copy_page_to_iter_pipe和push_pipe函数中，新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含陈旧的值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **利用pipe机制:** 漏洞利用涉及利用Unix pipe的机制。具体来说，利用了在内核处理pipe缓冲区时对某些标志位初始化不当的缺陷。
2.  **覆盖只读文件:** 攻击者通过pipe向只读文件写入数据。
3.  **权限提升:**  通过覆盖特定的系统文件（例如`/etc/passwd`）的内容，攻击者可以修改用户密码或添加具有root权限的新用户，从而获得系统root权限。

**代码分析:**

提供的代码`exploit-1.c`是一个利用CVE-2022-0847漏洞的PoC。它通过以下步骤工作：

*   **备份`/etc/passwd`:** 首先备份`/etc/passwd`文件到`/tmp/passwd.bak`，以便稍后恢复。
*   **打开只读文件:** 然后以只读模式打开目标文件（`/etc/passwd`）。
*   **准备pipe:** 创建并填充一个pipe，然后清空它，这会设置pipe缓冲区的标志位，为漏洞利用做准备。
*   **覆盖数据:** 利用漏洞，将恶意数据（修改后的root密码）写入`/etc/passwd`文件的特定偏移量处。
*   **修改root密码:** 代码中替换root密码的逻辑是漏洞利用的核心，展示了如何利用此漏洞修改系统配置。

**有效性：**

根据漏洞库信息和搜索引擎结果，CVE-2022-0847漏洞已被广泛研究，存在公开可用的PoC代码，并且被CISA列入已知被利用的漏洞目录，所以该漏洞是有效的。

**投毒风险：**

分析`README.md`，虽然作者声明此代码仅用于演示目的，但其明确表示“We use it to delete all files on your Ubuntu.”。`exploit-1.c` 虽然进行了备份,但存在其他风险,因为漏洞利用的本质就是修改`/etc/passwd`。整体来看，投毒风险较低,约5%。主要集中在作者的免责声明和利用代码的破坏性用途说明。虽然 PoC 的主要功能是演示权限提升，但如果未经授权使用可能会造成系统损坏或其他非法活动。

**总结：**

该漏洞允许本地用户覆盖只读文件，通常用于提升权限。提供的 PoC 代码演示了如何利用此漏洞修改 `/etc/passwd` 文件，从而更改 root 用户的密码，实现提权。利用方式简单有效，但潜在的投毒风险需要引起注意。由于作者明确表示删除文件的操作，请务必小心使用此代码。

**项目地址:** [solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus](https://github.com/solomon12354/LockingGirl-----CVE-2022-0847-Dirty_Pipe_virus)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

## POC #32

**来源**: [CVE-2022-0847-xsxtw_CVE-2022-0847.md](../2022/CVE-2022-0847-xsxtw_CVE-2022-0847.md)

## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致普通用户提升为 root 权限

**影响版本:** Linux Kernel 5.8 及更高版本，直至修复版本

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名 Dirty Pipe，是一个 Linux 内核中的本地提权漏洞。该漏洞源于 pipe_buffer 结构中的 "flags" 成员变量未正确初始化。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**漏洞利用方式：**

1.  **准备 Pipe：** 创建一个 pipe，其中 pipe_inode_info 环上的所有 "bufs" 都设置了 PIPE_BUF_FLAG_CAN_MERGE 标志。这是通过先完全填充 pipe，然后再清空它来实现的。
2.  **泄露页面缓存引用：** 通过 splice() 系统调用，从目标文件偏移量之前的一个字节处拼接一个字节到 pipe 中。这会向页面缓存添加一个引用，但 copy_page_to_iter_pipe() 不会初始化 "flags"，PIPE_BUF_FLAG_CAN_MERGE 标志仍然存在。
3.  **覆盖页面缓存：** 通过 write() 系统调用，将恶意数据写入 pipe。由于 PIPE_BUF_FLAG_CAN_MERGE 标志已设置，因此写入操作不会创建新的 pipe_buffer，而是会直接写入页面缓存，从而覆盖只读文件的内容。

**POC代码分析：**

提供的 Shell 脚本包含以下步骤：

1.  创建 exp.c，这是一个利用 Dirty Pipe 漏洞的 C 程序。
2.  编译 exp.c 以生成 exp 可执行文件。
3.  备份 /etc/passwd 文件到 /tmp/passwd。
4.  使用 ./exp 程序，通过 Dirty Pipe 漏洞修改 /etc/passwd 文件。修改的内容是将 "root:x" 替换为 "oot:"，这意味着删除了 root 账户的密码哈希值，从而允许无需密码即可切换到 root 账户。
5.  脚本尝试恢复原始的 /etc/passwd 文件。

**有效性评估：**

此 POC 代码利用了 Dirty Pipe 漏洞来修改 /etc/passwd 文件，从而实现本地提权。该方法在受影响的内核版本上是有效的。

**投毒风险评估：**

虽然该脚本主要目的是利用漏洞进行提权，但仍存在一些潜在的投毒风险：

1.  **覆盖重要文件：** 该脚本直接修改 /etc/passwd 文件，这是一个关键的系统文件。如果利用过程中出现任何错误，可能会导致系统不稳定或无法启动。
2.  **su root 后的操作不可控：** 脚本在提权后直接执行了 `su root`。这可能导致攻击者在获取 root 权限后执行任意恶意操作。 脚本尝试恢复原文件,但是恢复本身是否成功,以及恢复文件是否被替换都是一个未知数。
3.  **备份/恢复机制的潜在风险：** 虽然脚本尝试备份和恢复 /etc/passwd，但备份文件本身可能被篡改，或者恢复过程可能失败。导致未授权的root权限长期存在。
4.  **残留痕迹：** 即使脚本成功恢复了 /etc/passwd，攻击者也可能留下其他后门或痕迹，以便以后再次利用系统。
5.  **依赖关系：** 该脚本依赖于 gcc 等工具，如果目标系统缺少这些工具，则脚本将无法执行。

基于以上分析，认为存在5%的投毒风险，主要是由于脚本修改关键系统文件，su root 之后的操作不可控，并且依赖于备份/恢复机制，如果这些机制存在问题，则可能导致系统不稳定或被进一步利用。

**项目地址:** [xsxtw/CVE-2022-0847](https://github.com/xsxtw/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)

---

