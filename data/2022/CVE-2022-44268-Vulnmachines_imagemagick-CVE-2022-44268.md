# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

# CVE-2022-44268

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md](../2022/CVE-2022-44268-Ashifcoder_CVE-2022-44268-automated-poc.md)

## CVE-2022-44268 ImageMagick Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 及之前版本

**利用条件:** 目标系统安装了受影响的 ImageMagick 版本，并且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，可能在生成的图像中嵌入任意文件的内容（如果 ImageMagick 进程具有读取该文件的权限）。

**有效性评估：**

提供的 POC 代码似乎有效。它使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。然后，使用 `convert` 命令处理这个被修改过的 PNG 图像，使得嵌入的文件内容可以被提取出来。

**投毒风险分析：**

该仓库中存在一定投毒风险，但风险较低。

*   **README.md：** 存在恶意链接的可能性极低，但不能排除。
*   **CVE-2022-44268_poc.sh：** 该脚本主要利用已知的 ImageMagick 漏洞，脚本本身没有明显的恶意代码。但用户需要手动输入要读取的文件路径，这本身存在风险（例如，如果用户输入了不应该读取的文件路径）。脚本中使用的命令 `pngcrush`, `exiv2`, `convert`, `identify`, `sed`, `xxd` 都是常见的系统命令，本身不是恶意代码。

总体评估，该仓库的投毒风险较低，大约为 5%。主要是因为脚本依赖用户输入，且执行的命令都是常见的系统命令，隐藏恶意行为比较困难。

**漏洞利用方式：**

1.  攻击者需要准备一个 PNG 图像文件。
2.  攻击者运行 POC 脚本，脚本会提示输入 PNG 文件路径和要读取的目标文件路径。
3.  脚本使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的文本元数据中。
4.  脚本使用 `convert` 命令处理修改后的 PNG 图像。
5.  脚本使用 `identify` 命令提取嵌入在图像中的数据，并使用 `xxd` 命令将十六进制数据转换为原始文件内容。
6.  攻击者可以从输出中获取目标文件的内容。

**项目地址:** [Ashifcoder/CVE-2022-44268-automated-poc](https://github.com/Ashifcoder/CVE-2022-44268-automated-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #2

**来源**: [CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md](../2022/CVE-2022-44268-Baikuya_CVE-2022-44268-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限，受影响的应用需要使用存在漏洞的ImageMagick版本处理用户上传的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，为了调整大小）时，如果magick二进制文件具有读取权限，生成的图像可能会嵌入任意文件的内容。 

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞是存在的，并且POC代码旨在验证该漏洞。POC代码提供的`pngout.png`文件应该包含一个恶意构造的PNG图像，该图像在被ImageMagick处理后，会将服务器上的`/etc/passwd`文件（或其他指定文件）的内容嵌入到输出图像中。 通过`identify -verbose edit_image.png`命令检查输出图像的Raw profile type是否包含目标文件的内容，即可判断漏洞是否存在。

**投毒风险：**  提供的漏洞利用代码本身似乎没有包含恶意代码。 仓库中只有一个README.md和一个 pngout.png 文件， README.md 文件只是解释了如何使用 pngout.png 进行测试。pngout.png 是漏洞的触发文件，其本身也不是恶意代码。因此，投毒的概率为0%。

**利用方式：**
1.  **上传恶意PNG图像：** 攻击者需要上传特制的PNG图像（例如，`pngout.png`）到使用了存在漏洞的ImageMagick版本的Web应用程序中。 
2.  **触发图像处理：** Web应用程序需要对上传的图像进行处理，例如调整大小、裁剪或编辑等操作，以触发ImageMagick解析该PNG图像。
3.  **下载处理后的图像：** 攻击者需要下载经过处理后的图像。
4.  **提取嵌入的文件内容：**  攻击者可以使用`identify -verbose`命令或其他方法来检查下载的图像，以提取嵌入的任意文件内容（例如`/etc/passwd`）。通过分析图像的元数据或原始数据，可以找到被泄露的文件内容。

**项目地址:** [Baikuya/CVE-2022-44268-PoC](https://github.com/Baikuya/CVE-2022-44268-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #3

**来源**: [CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md](../2022/CVE-2022-44268-CygnusX-26_CVE-2022-44268-fixed-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析 PNG 图像时，如果攻击者能够控制 PNG 图像的内容，则可以将任意文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，且POC代码可用。提供的POC代码看起来有效，它使用 Pillow 库来创建和修改 PNG 图像，将指定文件的内容添加到 PNG 图像的文本块中。然后，当 ImageMagick 处理该 PNG 图像时，会将嵌入的文件内容输出到结果图像中，从而实现任意文件读取。

**投毒风险：**
分析提供的POC代码和相关文件，发现存在一定的投毒风险，但概率较低（10%）。

*   **README.md:** 提到了 "fixed version"，这可能暗示原始PoC存在问题。但该仓库同时声明修复了某些文件内容无法使用原始PoC的问题，并且提供了提取数据的方法，不能直接定义为投毒。
*   **MagickPNG.py:** 该脚本本身实现了漏洞利用的功能，但没有发现明显的恶意代码。脚本利用 `PIL` 库进行图像处理，功能相对简单。但如果攻击者修改了脚本，例如，在提取文件内容时添加额外的操作（如将提取的内容发送到远程服务器），则可能存在投毒行为。虽然如此，但当前的代码主要实现了POC。
*   **requirements.txt:**  依赖库 `Pillow` 的版本是明确指定的，降低了供应链投毒的风险。

考虑到代码的简洁性以及修复已知PoC问题的说明，投毒风险较低，但不排除经过精心设计的隐蔽恶意代码的存在。

**利用方式：**
1.  准备一张基础图片（例如PNG）。
2.  使用提供的 `MagickPNG.py` 脚本，利用 `-i` 参数指定基础图片，`-f` 参数指定要读取的任意文件，`-o` 参数指定输出的恶意PNG图片。例如：`python3 MagickPNG.py -i base.png -f /etc/passwd -o evil.png`
3.  将生成的 `evil.png` 图片上传到目标服务器，并触发 ImageMagick 对其进行处理（例如，进行缩放、转换等操作）。
4.  如果目标服务器存在漏洞，ImageMagick 在处理 `evil.png` 时，会将 `/etc/passwd` 文件的内容嵌入到结果图像中。
5.  攻击者可以下载处理后的图像，并从中提取 `/etc/passwd` 文件的内容，从而实现任意文件读取。可以使用提供的脚本的`-d`参数提取数据,或使用`exiftool`提取。

总而言之，该漏洞允许攻击者通过上传特制的PNG图像，诱使存在漏洞的ImageMagick服务读取服务器上的任意文件内容。

**项目地址:** [CygnusX-26/CVE-2022-44268-fixed-PoC](https://github.com/CygnusX-26/CVE-2022-44268-fixed-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #4

**来源**: [CVE-2022-44268-FlojBoj_CVE-2022-44268.md](../2022/CVE-2022-44268-FlojBoj_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #5

**来源**: [CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md](../2022/CVE-2022-44268-J0ey17_Automate_Exploit_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统运行受影响版本的ImageMagick，且允许上传和处理图片

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。攻击者可以构造一个恶意的 PNG 文件，诱使 ImageMagick 读取目标文件（如 /etc/passwd），然后通过某种方式获取处理后的图片（可能通过web应用返回），并从中提取目标文件的内容。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的利用代码，该漏洞是有效的。利用代码提供了一个自动化脚本，它使用 VoidZone Security 的 Rust PoC 生成恶意 PNG 文件，将其上传到目标 Web 应用程序，然后检索处理后的图像并使用 `exiftool` 提取泄露的文件内容。

**投毒风险：**
脚本本身看起来比较直接，主要步骤是：
1. 调用外部的 Rust PoC 程序生成恶意的 PNG 文件。
2. 上传 PNG 文件到目标。
3. 下载处理后的 PNG 文件。
4. 使用 `exiftool` 提取文件内容。

潜在的投毒风险点在于：
*   **VoidZone Security 的 Rust PoC：** 虽然脚本本身逻辑清晰，但它依赖于一个外部的 Rust 程序。如果 Rust 程序被篡改，则可能引入恶意行为。但是目前假设该git仓库是可信的,风险较低.
*   **`exiftool`命令：** 脚本调用了`exiftool`，虽然`exiftool`本身是一个常见的工具，如果目标机器上的`exiftool`被恶意替换，则可能导致问题。

总体来看，该仓库中存在作者隐藏的恶意代码可能性较低，但不能完全排除，风险预估为1%。

**利用方式：**
1.  **准备环境：** 安装 Python 依赖库 (`requests`)，克隆 VoidZone Security 的 PoC 仓库，并编译 Rust PoC (`cargo build`)，安装 `exiftool` 和 `wget`。
2.  **配置脚本：** 修改脚本中的 `payload` (恶意 PNG 文件路径), `url` (目标上传地址), `proxies` (代理，如果需要) 和 `Host` header。
3.  **执行脚本：** 运行脚本，并提供目标文件路径作为参数 (例如，`python3 automate_exploit.py /etc/passwd`)。
4.  **提取信息：** 脚本将自动生成恶意 PNG，上传，下载处理后的图片，并使用 `exiftool` 提取文件内容并打印。

**项目地址:** [J0ey17/Automate_Exploit_CVE-2022-44268](https://github.com/J0ey17/Automate_Exploit_CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #6

**来源**: [CVE-2022-44268-NataliSemi_-CVE-2022-44268.md](../2022/CVE-2022-44268-NataliSemi_-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，用于调整大小）时，如果 ImageMagick 进程具有读取文件的权限，则生成的图像可能会嵌入任意文件的内容。

**有效性：**
提供的 Python 脚本 `create_image.py` 使用 Pillow 库生成一个 PNG 图像，并将指定的文件路径作为元数据嵌入到图像中。此脚本能够创建包含文件路径的 PNG 文件。漏洞利用的关键在于，当易受攻击的 ImageMagick 版本处理这个 PNG 文件时，会试图读取元数据中指定的文件，并将文件内容嵌入到处理后的图像中。因此，提供的 POC 代码**有效**。

**投毒风险：**
查看 `create_image.py` 脚本和 `README.md` 文件，该脚本主要是利用 Pillow 库生成 PNG 文件，并将指定的文件路径以文本形式嵌入 PNG 文件的元数据中。脚本功能简单，没有发现任何可疑的代码执行或后门逻辑。`README.md` 仅包含如何运行脚本的说明。不过考虑到攻击者可能会修改脚本，例如添加额外的网络请求或者执行命令的行为，因此存在一定的投毒风险，评估约为 5%。

**利用方式：**
1.  攻击者使用 `create_image.py` 脚本生成一个特制的 PNG 图像，其中嵌入了目标服务器上要读取的文件的路径（例如 `/etc/passwd`）。
2.  攻击者将此 PNG 图像上传到使用存在漏洞的 ImageMagick 版本的服务器。这可以通过多种方式实现，例如上传为头像、图片附件等。
3.  服务器使用 ImageMagick 处理上传的 PNG 图像（例如，调整大小、转换格式）。
4.  当 ImageMagick 处理该 PNG 图像时，它会尝试读取 PNG 元数据中指定的文件内容，并将该内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像。
6.  攻击者从下载的图像中提取嵌入的文件内容，从而实现任意文件读取。

通过搜索引擎结果得知,此漏洞已经存在EXP代码, 风险等级较高。

**项目地址:** [NataliSemi/-CVE-2022-44268](https://github.com/NataliSemi/-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #7

**来源**: [CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md](../2022/CVE-2022-44268-PanAdamski_CVE-2022-44268-automated.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick 需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，进行缩放），如果 ImageMagick 进程有权读取任意文件，则可以将该文件的内容嵌入到生成的图像中。 

**利用方式：**

1.  **构造恶意 PNG：**  利用 `pngcrush` 工具，将想要读取的文件内容嵌入到 PNG 图像的 `profile` 文本块中。POC代码中使用了 `pngcrush -text a profile {目标文件} image.png` 命令。  
2.  **上传恶意 PNG：**  通过网站上传功能（本例中模拟 TryHackMe 上的 DockMagic 靶机环境），将包含文件内容的 PNG 图像作为头像上传。  POC 代码中模拟了对 `http://site.empman.thm/users` 的上传过程，包括获取 CSRF token，构造 POST 请求，并设置 `files` 参数。 
3.  **下载并解析图像：**  从服务器下载上传后的图像。由于 ImageMagick 处理 PNG 图像时会提取并处理嵌入的 `profile`，恶意文件会被读取并编码到图片中。 
4.  **提取文件内容：**  使用 `identify -verbose` 命令获取图像的详细信息，提取 Raw profile type 下面的十六进制数据，这部分是嵌入的文件内容。POC代码通过正则表达式 `r'Raw profile type:.*

(.*?)(?=
{2})'` 匹配并提取十六进制数据，然后解码得到文件内容。 
5.  **输出文件内容：**  将解码后的文件内容打印到控制台。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中包含了多个关于此漏洞的描述和分析，漏洞利用代码也提供了一个可行的 PoC。

**投毒风险：**

分析POC代码，虽然主要功能是利用漏洞读取文件，但存在少量潜在的投毒风险。  
*   POC脚本中包含了自动安装 `graphicsmagick-imagemagick-compat` 和 `pngcrush` 的代码。在某些情况下，如果用户不小心运行了此脚本，可能会安装恶意版本的软件源或被篡改的软件包。虽然可能性不大，但存在这种风险。
*   POC脚本针对特定的 TryHackMe 靶机环境 (`http://site.empman.thm`)，如果用户直接在生产环境中使用此脚本，可能会导致意想不到的问题。  
*   脚本中从URL下载图片到本地，存在被中间人篡改图片的风险，存在执行恶意代码的可能性，但是概率较低。

因此，评估投毒风险为 10%。 主要基于以上分析。


**项目地址:** [PanAdamski/CVE-2022-44268-automated](https://github.com/PanAdamski/CVE-2022-44268-automated)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #8

**来源**: [CVE-2022-44268-Pog-Frog_cve-2022-44268.md](../2022/CVE-2022-44268-Pog-Frog_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #9

**来源**: [CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md](../2022/CVE-2022-44268-Sybil-Scan_imagemagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick binary需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。当ImageMagick解析PNG图像时，攻击者可以通过在PNG文件中嵌入指向目标文件的payload，使ImageMagick读取该文件内容。利用方式如下：

1.  **生成恶意PNG图片：** 使用提供的`generate.py`脚本，指定要读取的文件路径（`-f`参数）和输出文件名（`-o`参数）。该脚本首先创建一个空白PNG图片，然后将文件路径嵌入到PNG的text chunk中。
2.  **使用ImageMagick转换PNG图片：** 使用`convert`命令处理生成的PNG图片。这个步骤会触发漏洞，ImageMagick尝试读取PNG文件中指定的路径。
3.  **读取转换后的图片信息：** 使用`identify -verbose`命令查看转换后的PNG图片的详细信息。目标文件的内容会被编码后包含在Raw profile type字段中。
4.  **解码文件内容：** 使用Python脚本解码Raw profile type字段中的内容，即可获取目标文件的内容。

**有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的，可以读取服务器上ImageMagick进程有权限访问的任意文件。

**投毒风险：**  分析`generate.py`脚本，该脚本的功能主要是生成包含payload的PNG文件，没有发现任何恶意代码或者后门，因此，投毒风险为0%。 脚本的主要流程为：生成一个基础png图片(gradient.png)，然后使用PIL库将要读取的文件路径作为文本信息添加到png图片的PngInfo中，最后保存图片。没有发现任何可疑操作。

**利用方式：** 该漏洞通过在PNG图片中嵌入指向目标文件的路径，当ImageMagick处理该图片时，会尝试读取目标文件，并将文件内容嵌入到输出图片的元数据中，攻击者可以通过读取输出图片的元数据来获取目标文件的内容。

**项目地址:** [Sybil-Scan/imagemagick-lfi-poc](https://github.com/Sybil-Scan/imagemagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #10

**来源**: [CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md](../2022/CVE-2022-44268-Vagebondcur_IMAGE-MAGICK-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图像，且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像（例如，用于调整大小）时，生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞允许攻击者读取服务器上的任意文件。提供的PoC代码 `exploit.py` 尝试利用此漏洞。它创建一个PNG图像，并在PNG的文本元数据中嵌入要读取的文件路径。当易受攻击的ImageMagick版本处理此PNG图像时，它会尝试读取指定的文件并将内容嵌入到输出图像中，从而实现任意文件读取。

**投毒风险：**
查看提供的`README.md`和`exploit.py`代码，没有发现明显的恶意代码或后门。`exploit.py` 的功能就是生成包含文件路径的PNG文件，用于触发ImageMagick的任意文件读取漏洞。因此，投毒的风险较低。

**利用方式：**
1.  攻击者使用`exploit.py`脚本生成恶意PNG图像，指定要读取的目标文件路径（例如`/etc/passwd`）。
2.  攻击者将此恶意PNG图像上传到易受攻击的服务器或应用程序。
3.  易受攻击的服务器或应用程序使用ImageMagick处理（例如调整大小）此PNG图像。
4.  ImageMagick尝试读取攻击者指定的文件，并将文件内容嵌入到处理后的图像中。
5.  攻击者下载处理后的图像，提取嵌入的文件内容，从而实现任意文件读取。

**项目地址:** [Vagebondcur/IMAGE-MAGICK-CVE-2022-44268](https://github.com/Vagebondcur/IMAGE-MAGICK-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #11

**来源**: [CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md](../2022/CVE-2022-44268-Vulnmachines_imagemagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意PNG图像

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 允许攻击者通过构造特制的PNG图像，利用 ImageMagick 的漏洞读取服务器上的任意文件。漏洞存在于 ImageMagick 解析 PNG 图像的过程中。当 ImageMagick 处理包含特定格式的文本块的 PNG 图像时，它会尝试读取文本块中指定的文件内容，并将其嵌入到输出图像中。

**有效性：** 提供的 POC 代码 `poc.py` 似乎有效。它包含生成和解析恶意 PNG 图像的功能。`write` 函数用于生成包含指向目标文件的文本块的 PNG 图像。`read` 函数用于从包含文本块的 PNG 图像中提取文件内容。

**投毒风险：** 查看了提供的python脚本`poc.py`，该脚本主要功能为生成包含恶意文件路径的png图片，以及解析包含恶意文件路径的png图片，实现任意文件读取。该脚本的投毒风险较低，主要风险点在于生成的图片可能会被用于非法用途，例如未经授权的访问。在提供的`README.md`文件中, 也没有任何恶意代码。因此总体投毒风险较低，为10%。

**利用方式：**

1.  **生成恶意PNG图像：** 使用 `poc.py` 脚本的 `generate` 动作，指定要读取的目标文件（例如 `/etc/passwd`）。脚本会创建一个 PNG 图像，其中包含一个文本块，该文本块包含目标文件的路径。
2.  **诱导ImageMagick处理恶意PNG图像：** 将生成的恶意PNG图像发送给目标系统，并诱导目标系统使用 ImageMagick 处理该图像。例如，攻击者可以将恶意PNG图像上传到使用 ImageMagick 处理图像的网站。
3.  **读取文件内容：** 当 ImageMagick 处理恶意PNG图像时，它会读取目标文件的内容，并将其嵌入到输出图像中（或者在某些情况下直接输出到标准输出）。攻击者可以通过下载或查看处理后的图像来获取目标文件的内容。

**缓解措施：**

*   更新 ImageMagick 到最新版本。
*   使用安全策略限制 ImageMagick 可以访问的文件。
*   禁用或限制 ImageMagick 中不必要的功能（例如文本块处理）。

**项目地址:** [Vulnmachines/imagemagick-CVE-2022-44268](https://github.com/Vulnmachines/imagemagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---



---

## POC #12

**来源**: [CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md](../2022/CVE-2022-44268-adhikara13_CVE-2022-44268-MagiLeak.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #13

**来源**: [CVE-2022-44268-agathanon_cve-2022-44268.md](../2022/CVE-2022-44268-agathanon_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意PNG图片，且具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果 ImageMagick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。 

**1. 有效性：**
提供的 PoC 代码是有效的。`craft.py` 脚本用于创建一个恶意 PNG 图像，该图像的元数据中包含要读取的文件的路径。`extract.py` 脚本用于从处理后的 PNG 图像中提取文件内容。

**2. 投毒风险：**
分析 PoC 代码，该仓库中存在作者隐藏的投毒代码的可能性较低。 虽然无法完全排除，但代码结构简单，主要功能集中在生成和提取数据上。 
    *   `craft.py` 的功能是创建一个包含文件路径作为元数据的PNG图片，本身不涉及恶意代码。
    *   `extract.py` 的功能是从PNG图片中提取数据，没有可疑操作。
    *   README.md 文件只是说明如何使用脚本。 
    因此，初步判断该仓库投毒的可能性较低， 但是考虑到安全风险，仍然需要保持警惕。 给出5%的投毒风险可能，主要是由于作者可能通过一些不明显的方式添加后门。

**3. 利用方式：**
1.  攻击者使用 `craft.py` 脚本创建一个恶意的 PNG 图像，并将要读取的文件的路径（例如，`/etc/passwd`）作为元数据嵌入到 PNG 图像中。
2.  攻击者将此恶意 PNG 图像发送给目标系统，目标系统使用易受攻击的 ImageMagick 版本处理该图像（例如，调整大小）。
3.  ImageMagick 在处理图像时，会尝试读取 PNG 图像元数据中指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者使用 `extract.py` 脚本从处理后的图像中提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的根本原因在于 ImageMagick 在处理 PNG 图像时，没有对元数据中指定的文件路径进行充分的验证和过滤，导致可以读取任意文件。

**项目地址:** [agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #14

**来源**: [CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md](../2022/CVE-2022-44268-atici_Exploit-for-ImageMagick-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (受影响版本)

**利用条件:** 需要ImageMagick能够解析攻击者提供的PNG图片，且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当它解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响 ImageMagick 7.1.0-49。提供的POC代码旨在利用此漏洞。

**投毒风险：**
分析 `script.sh` 脚本：

1.  **常规操作：** 脚本的主要功能是使用 `pngcrush` 工具将指定文件的内容作为文本元数据嵌入到 PNG 图像中。这个操作本身是利用漏洞的关键。
2.  **依赖外部工具：** 脚本依赖于 `imagemagick`、`exiftool`、`pngcrush` 和 `exiv2`，这些工具本身是常见的图像处理工具。如果这些工具被篡改，可能存在投毒风险。但是，脚本本身没有主动去下载或安装这些工具，只是检查它们是否存在。
3.  **提取数据：**  脚本包含一个提取数据的选项 `-d`，它从修改后的PNG文件中提取嵌入的文件内容。提取是通过`identify`命令和一系列文本处理命令完成的，没有发现恶意操作。
4.  **潜在风险：** 虽然脚本本身的功能看起来没有明显的恶意代码，但是如果攻击者诱导用户下载并执行此脚本，而用户又恰好以 root 权限运行，那么脚本可能会读取一些敏感文件（例如 `/etc/passwd`），从而导致信息泄露。 另一种风险存在于脚本对用户输入（路径和文件名）的直接使用，如果输入不经过充分的验证，可能导致一些意想不到的问题，但这些问题主要属于脚本的健壮性问题，而非主动投毒。

**综合评估：**
*   此仓库中存在作者隐藏的投毒代码的可能性较低。风险主要集中在用户误用脚本，或者系统上依赖的外部工具被篡改的情况。 我认为有百分之10的可能性存在我没有发现的隐藏投毒代码。

**利用方式：**
1.  **准备PNG图片：** 准备一个合法的PNG图片作为基础。
2.  **执行脚本：** 运行`script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]`，例如 `./script.sh -p /etc/passwd sample.png output.png`。
3.  **利用`pngcrush`嵌入文件：** 脚本使用`pngcrush`将指定的文件（例如 `/etc/passwd`）的内容以文本元数据的方式嵌入到PNG图像中。
4.  **触发漏洞：** 将生成的PNG图像提交给使用存在漏洞的 ImageMagick 版本的服务或应用。当 ImageMagick 处理此PNG图像时，会读取嵌入的文件内容。
5.  **提取文件内容：** 运行`script.sh -d [PNG Image]` 从包含注入数据的PNG文件中提取文件内容。 例如 `./script.sh -d pngout.png`

**项目地址:** [atici/Exploit-for-ImageMagick-CVE-2022-44268](https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #15

**来源**: [CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md](../2022/CVE-2022-44268-betillogalvanfbc_POC-CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #16

**来源**: [CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md](../2022/CVE-2022-44268-bhavikmalhotra_CVE-2022-44268-Exploit.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，并且ImageMagick进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick中的一个信息泄露漏洞。当ImageMagick解析PNG图像时（例如，为了调整大小），生成的图像可能会嵌入任意文件的内容（如果magick二进制文件具有读取该文件的权限）。

**有效性：** 提供的PoC代码是有效的。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了此漏洞的存在，并且提供了相关的漏洞描述和修复建议。PoC代码利用`pngcrush`命令将目标文件的内容嵌入到PNG图像的文本块中，然后上传到服务器。服务器使用存在漏洞的ImageMagick版本处理该图像，导致目标文件的内容被提取出来。最后，PoC代码从ImageMagick的输出中提取嵌入的内容，并进行解码以显示读取的文件内容。

**投毒风险：** 此仓库存在一定的投毒风险，约10%。

*   **README.md:**  该文件包含有关漏洞利用的信息，并建议用户编辑`mal_file`变量。虽然这是一个标准做法，但如果用户不小心使用了错误的`mal_file`值，可能会导致意外的文件读取。虽然这是用户错误,但是可能被利用. *   **lfi.py:**  该脚本包含一些需要用户修改的变量（例如，`mal_file`和`cmd`变量）。虽然这些变量是合法的，但恶意攻击者可能会修改这些变量，然后将其发送给不知情的用户。如果用户执行被篡改的脚本，可能会导致意外的文件读取或命令执行。同时上传文件的URL是写死的，有可能会被不法分子劫持。

尽管存在上述风险，但总体而言，该仓库中的代码相对简单且易于理解，因此，隐藏恶意代码的可能性较低。因此判断投毒风险为10%.

**利用方式：**

1.  **构造恶意PNG图像：** 使用`pngcrush`工具，将要读取的目标文件内容嵌入到PNG图像的文本块中。PoC代码中使用了`-text a 'profile' {args.file} {args.image}`命令来实现这一点。
2.  **上传恶意PNG图像：** 将构造好的PNG图像上传到目标服务器。目标服务器需要使用存在漏洞的ImageMagick版本来处理上传的图像。PoC代码使用`requests.post`方法来上传图像。
3.  **触发漏洞：** 当ImageMagick处理恶意PNG图像时，它会将嵌入的文件内容提取出来，并将其包含在图像的元数据中。
4.  **提取文件内容：** PoC代码使用`magick identify -verbose image.png`命令来获取图像的元数据。然后，它从元数据中提取嵌入的文件内容，并进行解码以显示读取的文件内容。

**项目地址:** [bhavikmalhotra/CVE-2022-44268-Exploit](https://github.com/bhavikmalhotra/CVE-2022-44268-Exploit)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #17

**来源**: [CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md](../2022/CVE-2022-44268-chairat095_CVE-2022-44268_By_Kyokito.md)

## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #18

**来源**: [CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md](../2022/CVE-2022-44268-duc-nt_CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个任意文件读取漏洞。当ImageMagick解析PNG图片（例如，进行resize操作）时，如果PNG图片被恶意构造，攻击者可以嵌入任意文件的内容到结果图片中。漏洞利用方式如下：

1.  **安装依赖:** 安装 `pngcrush`, `imagemagick`, `exiftool`, 和 `exiv2`。
2.  **构造恶意PNG图片:** 使用`pngcrush`命令将想要读取的文件内容嵌入到PNG图片的文本块中。例如，读取`/etc/hosts`文件：
    ```bash
    pngcrush -text a "profile" "/etc/hosts" vjp.png
    ```
3.  **验证构造:** 使用`exiv2`确认文本块已成功写入。
    ```bash
    exiv2 -pS pngout.png
    ```
4.  **触发漏洞:** 使用`convert`命令处理恶意PNG图片，生成新的图片。这将触发ImageMagick解析PNG图片，并将嵌入的文件内容写入到新的图片中。
    ```bash
    convert pngout.png gopro.png
    ```
5.  **提取文件内容:** 使用`identify -verbose`命令查看新生成的图片，文件内容将以某种形式（通常是十六进制编码）嵌入在图片元数据中。
    ```bash
    identify -verbose gopro.png
    ```
6.  **解码文件内容:** 使用Python脚本或其他工具将十六进制编码的内容解码为可读的文本。
    ```python
    python3 -c 'print(bytes.fromhex("23202f6574632f686f7374730a3132372e302e302e31096c6f63616c686f73740a0a232054686520666f6c6c6f77696e67206c696e65732061726520646573697261626c6520666f7220495076362063617061626c6520686f7374730a3a3a3109096c6f63616c686f7374206970362d6c6f63616c686f7374206970362d6c6f6f706261636b0a666630323a3a3109096970362d616c6c6e6f6465730a666630323a3a3209096970362d616c6c726f75746572730a6475636e740a").decode("utf-8"))'
    ```

**有效性评估:**

提供的PoC代码有效，可以成功读取目标文件。通过构造特殊的PNG图片，可以欺骗ImageMagick将文件内容嵌入到输出图片中。

**投毒风险评估:**

该PoC主要提供漏洞利用方法，本身不存在明显的恶意代码。投毒风险主要体现在两个方面：

1.  **依赖包风险:** 安装脚本中使用的 `apt-get install` 命令依赖于软件源的安全性。如果软件源被篡改，可能会安装包含恶意代码的软件包。但是这个风险是所有软件安装都存在的，并非此PoC特有。
2.  **Payload构造风险:** 攻击者可能会将读取到的敏感信息发送到恶意服务器，或者利用此漏洞进行进一步的攻击。
3.  **隐蔽后门：** 在readme文件中，作者声明不负任何责任，存在免责声明，可能存在隐藏的风险。例如，通过修改命令执行过程中的参数来实现反向shell等。 考虑到以上风险，投毒风险评估为10%。这个数值相对较低，因为提供的代码主要是利用现有的工具链来完成漏洞利用，恶意行为依赖于攻击者如何使用这个PoC。

**总结:**

该漏洞允许攻击者读取服务器上的任意文件，可能导致敏感信息泄露。攻击者需要上传特制的PNG图片到使用了存在漏洞的ImageMagick版本的服务器上，并触发图片处理操作（例如resize）。修复方案是升级ImageMagick到安全版本或者禁用处理用户上传的图片的功能。

**项目地址:** [duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC](https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #19

**来源**: [CVE-2022-44268-entr0pie_CVE-2022-44268.md](../2022/CVE-2022-44268-entr0pie_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装了存在漏洞版本的ImageMagick，且ImageMagick进程有权限读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能嵌入了任意文件的内容（如果 magick 二进制文件具有读取它的权限）。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何构造一个恶意的PNG文件，该文件在被 ImageMagick 处理后，会将指定文件的内容嵌入到输出图像中。

**投毒风险：**
分析提供的PoC代码和相关文件（LICENSE、README.md），未发现作者隐藏的恶意代码或后门。 PoC 代码的功能是生成包含文件读取路径的 PNG 文件，利用方式清晰，LICENSE 采用的是公共领域许可，允许自由使用，README 也明确说明了漏洞利用方式。因此，投毒风险评估为0%。

**利用方式：**
1.  **构造恶意PNG文件：** 使用提供的 Python 脚本 `CVE-2022-44268.py`，指定想要读取的文件路径作为参数，生成一个 `output.png` 文件。该脚本修改 PNG 文件的 tEXt 块，将 “Profile” 关键字的值设置为目标文件路径。
2.  **使用ImageMagick处理该PNG文件：** 使用 `convert` 命令或其他 ImageMagick 工具对 `output.png` 进行图像处理操作，例如调整大小。 `convert output.png -resize 50% leak.png`
3.  **提取泄露的文件内容：**  使用 `identify -verbose leak.png` 命令查看 `leak.png` 文件的详细信息，找到 `Raw profile type` 字段，该字段的值即为被读取的文件内容的十六进制表示。然后，可以使用 Python 等工具将十六进制数据转换为原始文件内容。

**总结：**
该漏洞允许攻击者在目标系统上读取任意文件，前提是 ImageMagick 进程具有读取该文件的权限。攻击者可以通过上传特制的PNG文件，诱导服务器上的 ImageMagick 处理该文件，从而实现任意文件读取。

**项目地址:** [entr0pie/CVE-2022-44268](https://github.com/entr0pie/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #20

**来源**: [CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md](../2022/CVE-2022-44268-fanbyprinciple_ImageMagick-lfi-poc.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标服务器运行存在漏洞的ImageMagick版本，且ImageMagick进程有权读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 及之前版本中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 ImageMagick 二进制文件具有读取该文件的权限）。

**漏洞利用方式：**

1.  **生成恶意 PNG 文件：**  使用 `magick_exploit.py` 脚本生成一个包含恶意 profile 的 PNG 文件。该脚本将目标文件的路径嵌入到 PNG 文件的文本 chunk 中。
2.  **上传恶意 PNG 文件：**  将生成的 PNG 文件上传到目标服务器。服务器需要使用存在漏洞的 ImageMagick 版本来处理该图像，例如进行缩放或其他图像处理操作。
3.  **下载处理后的图像：**  从目标服务器下载经过 ImageMagick 处理后的 PNG 文件。
4.  **提取文件内容：**  使用 `decode_profile.py` 脚本从下载的 PNG 文件中提取嵌入的文件内容。该脚本读取 PNG 文件的 verbose 信息，解析 Raw profile type字段，提取十六进制数据，并尝试将其解码为 UTF-8 字符串。如果解码失败，则将其作为二进制数据保存到文件中。

**投毒风险分析：**

该POC的主要功能是利用ImageMagick的漏洞读取文件，`magick_exploit.py`的功能是生成含有文件路径的PNG图片，`decode_profile.py`的功能是从处理后的图片中提取信息。代码逻辑相对简单，主要依赖于pillow和subprocess模块，没有发现明显的恶意代码或后门。

但是，仍然存在一些潜在的投毒风险：

*   **依赖项风险：**  `pip install pillow`可能存在依赖项被替换的风险，攻击者可能会通过篡改 pillow 包来植入恶意代码。
*   **subprocess 风险：** `magick_exploit.py`脚本使用了`subprocess.check_output`来执行`identify`命令。如果攻击者能够控制输入的文件名（`input_file`），则有可能通过命令注入执行任意代码。但是在这个POC中，`input_file`是下载下来的文件名，一般情况下文件名不会被攻击者直接控制。风险较低。
*   **decode_profile.py:** 如果目标文件不是UTF-8编码，脚本会尝试以二进制方式读取，并将数据保存到`extracted`文件。如果攻击者能够控制读取的文件路径，可能会覆盖服务器上的其他文件。
*   **脚本作者的风险:** 脚本作者可以在代码中加入不易察觉的恶意代码，例如收集用户信息或执行其他恶意操作。但是从代码结构和逻辑来看，这种可能性较低。

综合来看，该POC的投毒风险较低，但仍然需要保持警惕，特别是对于pillow这个依赖项。


**项目地址:** [fanbyprinciple/ImageMagick-lfi-poc](https://github.com/fanbyprinciple/ImageMagick-lfi-poc)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #21

**来源**: [CVE-2022-44268-jkobierczynski_cve-2022-44268.md](../2022/CVE-2022-44268-jkobierczynski_cve-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理受控的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时，通过构造恶意PNG文件，可以将任意文件的内容嵌入到结果图像中，导致信息泄露。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞是有效的。漏洞利用代码 `cve-2022-44268.py` 实现了利用该漏洞读取服务器上任意文件的功能。代码首先构造一个恶意的PNG文件，其中包含要读取的文件名，然后将该PNG文件通过Burp Suite捕获的请求发送给目标服务器。服务器上的 ImageMagick 处理该PNG文件时，会将指定文件的内容嵌入到结果图像中，然后脚本从响应中提取文件内容。

**投毒风险：**
代码本身执行了读取任意文件并将其添加到图像中的操作。对代码进行分析后，发现其主要功能为漏洞利用。虽然发现了一些常见的代码片段，例如文件操作和网络请求，但没有直接证据表明存在恶意代码或后门。需要注意，该脚本依赖于目标系统上 ImageMagick 的配置以及 ImageMagick 对 PNG 文件的处理方式。如果目标系统使用了存在漏洞的版本且允许 ImageMagick 读取任意文件，则漏洞利用很可能成功。根据对代码的审查，投毒风险评估较低，约为5%。可能存在的风险在于，如果使用者未经验证就直接在生产环境中使用该脚本，可能会导致意料之外的文件读取或数据泄露，但这不是代码本身的投毒行为，而是使用不当造成的风险。

**利用方式：**
1.  **准备基础PNG文件：** 准备一个正常的PNG图片作为基础。
2.  **构造恶意PNG文件：** 使用漏洞利用代码 `cve-2022-44268.py`，指定基础PNG文件路径、要读取的目标文件路径，以及生成恶意PNG文件的路径。该脚本会将要读取的文件名嵌入到PNG文件的元数据中。
3.  **捕获上传请求：** 使用 Burp Suite 或类似工具捕获向目标服务器上传PNG文件的请求。该请求通常是一个multipart/form-data请求。
4.  **替换上传文件：** 将捕获到的请求中的PNG文件替换为构造的恶意PNG文件。
5.  **发送请求：** 将修改后的请求发送到目标服务器。
6.  **提取文件内容：** 目标服务器上的 ImageMagick 处理该PNG文件后，会将目标文件的内容嵌入到结果图像中。漏洞利用代码会从响应中提取嵌入的文件内容，并保存到本地文件中。

**修复建议：**
1.  升级 ImageMagick 到不受漏洞影响的版本。
2.  限制 ImageMagick 的权限，防止其读取敏感文件。
3.  对上传的图片进行严格的安全检查，防止恶意文件上传。

**项目地址:** [jkobierczynski/cve-2022-44268](https://github.com/jkobierczynski/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #22

**来源**: [CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md](../2022/CVE-2022-44268-jnschaeffer_cve-2022-44268-detector.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #23

**来源**: [CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md](../2022/CVE-2022-44268-katseyres2_CVE-2022-44268-pilgrimage.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49 (以及可能更早的版本，例如6.9.11-60)

**利用条件:** ImageMagick需要解析攻击者可控的PNG图像。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 中，当其解析 PNG 图像时，可能允许攻击者读取服务器上的任意文件。漏洞利用方式是构造一个特殊的 PNG 图像，该图像的 text chunk 中包含了要读取的文件路径。当 ImageMagick 处理此图像（例如，进行缩放）时，会将指定文件的内容嵌入到生成的图像中，从而实现信息泄露。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方法是有效的。PoC 代码通过以下步骤利用该漏洞：

1.  **生成恶意 PNG 图像 (`src/main.rs`)：**  `src/main.rs`  使用 `png` crate 生成一个 PNG 图像。关键之处在于，它使用 `encoder.add_text_chunk` 函数将目标文件路径（例如 `/etc/passwd`）作为 `profile` 文本 chunk 的值嵌入到 PNG 图像的 header 中。这个恶意构造的PNG图片命名为 `image.png`。
2.  **上传 PNG 图像 (`script.py`)：** `script.py` 脚本将 `image.png` 上传到目标服务器的 `/` 路径，通过 `requests` 库模拟 HTTP POST 请求，服务器处理该图像。
3.  **下载处理后的图像 (`script.py`)：** 服务器使用 ImageMagick 处理上传的图像，由于漏洞的存在，目标文件的内容被嵌入到图像中。脚本从服务器下载处理后的图像(`infected.png`)。
4.  **提取嵌入的文件内容 (`script.py`)：** 脚本使用 `identify -verbose` 命令（ImageMagick 的一部分）来提取 PNG 图像中的文本数据，然后提取包含文件内容的长十六进制字符串并将其解码，最后保存到 `decoded` 文件中。
5.  **自动化流程 (`main.sh`)**: `main.sh` 通过循环运行 `script.py` 三次，然后将 `decoded` 文件的内容打印到标准输出。

根据README的描述，该POC已经在 ImageMagick v. 7.1.0-48 和 6.9.11-60上测试通过。

**投毒风险分析：**

评估仓库中作者隐藏的投毒代码的风险，风险较低：1%。代码整体结构比较简单，`script.py` 的主要功能是上传、下载和解码图像，恶意行为不太容易隐藏。
主要风险点在于  `subprocess.Popen`  的使用，尤其是  `shell=True` 。虽然这里执行的命令看起来无害（`cargo run`、`identify`），但如果攻击者能够控制 `file_to_read` 变量，仍然可能通过命令注入执行恶意代码。但是，因为这个 `file_to_read` 来源于外部输入，属于漏洞利用的一部分，而不是作者恶意添加的后门，所以判定投毒风险较低。

**漏洞利用方式总结：**

1.  利用 ImageMagick 处理 PNG 图像时存在的任意文件读取漏洞 (CVE-2022-44268)。
2.  通过构造包含目标文件路径的 PNG 图像，诱使 ImageMagick 读取该文件。
3.  从处理后的图像中提取文件内容。

**项目地址:** [katseyres2/CVE-2022-44268-pilgrimage](https://github.com/katseyres2/CVE-2022-44268-pilgrimage)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #24

**来源**: [CVE-2022-44268-kljunowsky_CVE-2022-44268.md](../2022/CVE-2022-44268-kljunowsky_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要解析攻击者上传的PNG图片，且运行ImageMagick的进程需要有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图片时（例如，进行resize操作），攻击者可以构造恶意的PNG图片，使得在处理该图片时，会将服务器上任意文件的内容嵌入到处理后的图片中。攻击者通过上传该恶意PNG图片，并下载处理后的图片，即可读取服务器上的任意文件。 

**有效性:**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码展示了如何构造包含目标文件内容的恶意PNG图片，以及如何从处理后的图片中提取目标文件内容。

**投毒风险:**
通过检查提供的POC代码，Dockerfile和README文件，没有发现明显的恶意代码，例如反弹shell、下载执行恶意程序等。主要的风险在于攻击者可能会利用该漏洞读取服务器上的敏感信息，例如配置文件、密钥等。考虑到代码作者在安全公司工作，以及代码的清晰性，投毒的可能性较低，约为5%。Dockerfile只是配置了环境，没有可疑操作。

**利用方式:**
1.  **生成恶意PNG图片:**  攻击者使用提供的POC脚本（`CVE-2022-44268.py`），通过`--image`参数指定一个PNG图片，通过`--file-to-read`参数指定要读取的目标文件，通过`--output`参数指定输出的恶意PNG图片的文件名。脚本会将目标文件的内容嵌入到PNG图片的元数据中。
2.  **上传恶意PNG图片:**  攻击者将生成的恶意PNG图片上传到存在漏洞的ImageMagick服务器。服务器在处理该图片时，会将目标文件的内容嵌入到处理后的图片中。
3.  **获取目标文件内容:**  攻击者通过URL访问处理后的图片，并使用提供的POC脚本（`CVE-2022-44268.py`），通过`--url`参数指定处理后的图片的URL。脚本会从图片的元数据中提取目标文件的内容。

总的来说，利用方式相对简单，但前提是ImageMagick服务器存在漏洞，并且攻击者知道目标文件的路径，并且目标文件可以被运行ImageMagick的账户读取。

**项目地址:** [kljunowsky/CVE-2022-44268](https://github.com/kljunowsky/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #25

**来源**: [CVE-2022-44268-mouftan_CVE-2022-44268.md](../2022/CVE-2022-44268-mouftan_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** ImageMagick需要处理恶意构造的PNG图片，且运行ImageMagick的账户需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞。攻击者可以通过上传特制的PNG图像，利用ImageMagick解析PNG图片时的缺陷，将指定文件的内容嵌入到处理后的图像中。这个POC代码包含两个主要功能：

1.  **图像投毒 (Poison the image):**  `--image`、`--file-to-read` 和 `--output` 参数用于生成包含被读取文件内容的恶意PNG图片。它使用 Pillow 库来创建 PNG 图片，并将要读取的文件路径添加到 PNG 文件的元数据（PngInfo）中。这部分没有发现投毒代码。
2.  **漏洞验证 (Check if exploit was successful):**  `--url` 参数用于从远程服务器下载PNG图片（假设是先前投毒的），然后从图片的元数据中提取嵌入的文件内容。它首先获取 `Raw profile type`，对其进行十六进制解码，并打印解码后的内容。这部分没有发现投毒代码。

**利用方式：**

1.  攻击者首先使用POC脚本生成一个“投毒”的PNG文件，其中包含要读取的目标文件的路径。
2.  攻击者将这个恶意PNG文件上传到目标服务器，该服务器使用存在漏洞的ImageMagick版本处理上传的图片（例如，进行缩放）。
3.  当ImageMagick处理这个恶意PNG文件时，它会读取指定的文件，并将文件内容嵌入到处理后的图像中。
4.  攻击者下载处理后的图像，并使用POC脚本从图像中提取嵌入的文件内容。

**投毒风险评估：**

分析提供的Dockerfile、Python脚本、README和requirements.txt，没有发现明显的恶意代码或后门。该代码的主要目的是演示和验证CVE-2022-44268漏洞，没有执行任何与漏洞利用无关的操作，因此判断投毒风险较低，风险概率为0%。虽然使用了docker进行快速部署运行,但主要还是为了poc验证环境.requirements.txt只是常规的poc脚本依赖库。

**项目地址:** [mouftan/CVE-2022-44268](https://github.com/mouftan/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #26

**来源**: [CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md](../2022/CVE-2022-44268-narekkay_auto-cve-2022-44268.sh.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要目标系统使用存在漏洞的ImageMagick版本，并允许上传图片文件且使用ImageMagick处理该图片

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，该漏洞是有效的，并且存在公开的PoC。

**投毒风险：**
提供的PoC代码主要包含一个shell脚本 `auto-cve-2022-44268.sh`。该脚本的目的是自动化漏洞利用过程，它首先使用 `pngcrush` 将目标文件的内容嵌入到 PNG 图像的 "profile" EXIF 字段中，然后上传到存在漏洞的服务器，服务器处理后，下载处理后的图片，使用 `exiftool` 提取嵌入的文件内容，并将十六进制数据转换为 ASCII 文本。

代码中可能存在的投毒风险点很小，主要集中在使用 `pngcrush`, `exiftool`, `xxd` 命令，以及脚本的逻辑是否存在恶意修改。风险如下:
1.  **对下载链接的替换**：脚本通过 `wget` 命令下载其他资源。如果 `wget` 下载的链接被替换为包含恶意代码的脚本，则可能存在投毒风险。
2. **脚本本身被篡改**:  如果脚本本身被篡改，例如加入反弹shell或者恶意文件操作等。

总体来说，直接的、明显的恶意代码注入风险较低，风险比例约为 5%。 这个比例主要考虑了脚本中可能存在的细微的安全隐患以及依赖的外部命令潜在风险。

**利用方式：**
1.  **准备恶意PNG图像：** 使用 PoC 脚本（`auto-cve-2022-44268.sh`）和一个原始 PNG 图像（例如，`flag.png`），以及要读取的目标文件（例如，`/etc/passwd`）。脚本会将目标文件的内容嵌入到 PNG 图像的 “profile” EXIF 字段中。
2.  **上传恶意PNG图像：** 将生成的恶意 PNG 图像（`backdoored.png`）上传到运行存在漏洞的 ImageMagick 版本的服务器。
3.  **触发图像处理：** 触发服务器使用 ImageMagick 处理上传的图像。这可能涉及调整图像大小、转换格式或其他图像处理操作。
4.  **下载处理后的图像：** 下载服务器处理后的图像（假设名为 `final.png`）。
5.  **提取文件内容：** 使用 `exiftool` 从下载的图像中提取 “Raw Profile Type” 字段，该字段包含目标文件的十六进制编码内容。
6.  **解码文件内容：** 使用 `xxd` 或类似的工具将十六进制编码的内容解码为 ASCII 文本，从而获取目标文件的内容。

通过这种方式，攻击者可以读取服务器上的任意文件，前提是 ImageMagick 进程具有读取这些文件的权限。

**项目地址:** [narekkay/auto-cve-2022-44268.sh](https://github.com/narekkay/auto-cve-2022-44268.sh)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #27

**来源**: [CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md](../2022/CVE-2022-44268-nfm_heroku-CVE-2022-44268-reproduction.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理PNG图片的权限，且Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ImageMagick 7.1.0-49版本中。当ImageMagick解析PNG图片（例如，用于调整大小）时，攻击者可以通过构造恶意的PNG文件，将任意文件的内容嵌入到结果图片中。攻击者可以使用`pngcrush -text a "profile" "/etc/hosts" any-png-you-have.png`命令构造恶意PNG文件，其中`/etc/hosts`为要读取的目标文件。上传该恶意PNG文件后，下载处理后的图片，然后使用`exiftool`提取Raw Profile Type数据，最后可以使用CyberChef的From Hex功能将提取的数据转换为可读的文本，从而实现任意文件读取。

**利用方式：**

1.  使用`pngcrush`（或其他PNG编辑工具）创建一个包含恶意文本块的PNG文件，该文本块包含要读取的文件的路径（例如，`/etc/passwd`或`/app/super-secret`）。文本块类型应为`profile`。
2.  将此PNG文件上传到易受攻击的ImageMagick实例。
3.  ImageMagick将尝试处理此图像，并将指定文件的内容嵌入到输出图像的元数据中。
4.  下载处理后的图像。
5.  使用`exiftool`或其他元数据提取工具从图像中提取嵌入的文件内容。如果输出过大，可以使用`exiftool -b`来获取原始数据。
6.  使用CyberChef（From Hex with Delimiter: auto）或类似的工具将提取的十六进制数据解码为原始文件内容。

**有效性：**

根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞利用是有效的。POC代码提供了一个简单的Web界面，允许用户上传PNG文件，然后使用ImageMagick进行处理。处理后的图片会作为附件下载，用户可以使用`exiftool`提取文件内容。

**投毒风险：**

在提供的代码中，并没有发现明显的恶意代码或后门。所有代码都是为了演示该漏洞的利用过程，没有发现任何试图损害服务器或窃取用户信息的行为。因此，评估的投毒风险为0%。代码的功能仅限于接收上传的PNG文件，调用ImageMagick处理，然后返回处理后的图片。

**排序优先级依据：**

搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [nfm/heroku-CVE-2022-44268-reproduction](https://github.com/nfm/heroku-CVE-2022-44268-reproduction)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #28

**来源**: [CVE-2022-44268-voidz0r_CVE-2022-44268.md](../2022/CVE-2022-44268-voidz0r_CVE-2022-44268.md)

## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

## POC #29

**来源**: [CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md](../2022/CVE-2022-44268-y1nglamore_CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment.md)

## CVE-2022-44268-ImageMagick-Arbitrary File Read

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** Magick二进制文件需要有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 存在于 ImageMagick 7.1.0-49 版本中，是一个任意文件读取漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果它有权限读取该文件，则生成的图像可能嵌入任意文件的内容。

**漏洞利用方式：**

1.  攻击者需要上传或者提供一个特制的 PNG 图像。
2.  该 PNG 图像利用 `pngcrush` 工具插入包含目标文件路径的文本元数据。
3.  `exiv2` 用于处理PNG文件。
4.  `convert` (ImageMagick的一部分) 被调用，处理这个包含特殊元数据的 PNG 文件。
5.  ImageMagick 在处理 PNG 文件时，会读取并嵌入指定文件的内容到处理后的图像中。
6.  攻击者可以通过 `identify -verbose` 命令查看生成图像的详细信息，从而获取读取的文件内容, 通过grep和xxd命令处理输出结果。

**有效性评估：**

提供的 Dockerfile 和 README.md 描述了一个可用于复现该漏洞的 PoC 环境。Dockerfile 安装了必要的工具 (pngcrush, imagemagick, exiftool, exiv2, wget, xxd) , 下载了一个基础 PNG 文件, 并创建了一个 `run.sh` 脚本，用于自动化利用流程。根据 README 的描述，该 PoC 允许读取 `/etc/passwd` 或指定的任何其他文件 (如果 ImageMagick 进程具有相应的读取权限)。因此，该 PoC 代码是有效的。

**投毒风险评估：**

该 Dockerfile 主要执行以下操作：

1.  安装必要的软件包：`pngcrush`, `imagemagick`, `exiftool`, `exiv2`, `wget`, `xxd`。
2.  下载一个名为 `1.png` 的图片。
3.  创建一个名为 `run.sh` 的 shell 脚本，该脚本使用 `pngcrush` 将指定文件（默认为 `/etc/passwd`）的内容作为文本数据嵌入到 PNG 图像中，然后使用 `exiv2`，`convert`和`identify`命令以及`grep`和`xxd`命令提取文件内容。

潜在的投毒点可能存在于以下几个方面：

*   **下载的 `1.png` 文件：**  这个文件可能包含恶意代码，虽然不太可能直接构成威胁，但值得注意。风险较低。
*   **`run.sh` 脚本：**  该脚本经过 base64 编码，解码后的内容包含了利用漏洞的核心逻辑，但也可能包含一些隐藏的恶意指令。风险相对较高。
*   **依赖的软件包：**  虽然 Dockerfile 使用了 Ubuntu 官方源，但理论上存在软件包被篡改的可能性，虽然几率很小。

脚本`run.sh`的内容为:
```bash
#!/bin/bash

if [ -z "$1" ]; then
    file="/etc/passwd"
else
    file="$1"
fi

pngcrush -text a "profile" "$file" 1.png
exiv2 -pS pngout.png
convert pngout.png gopro.png

identify -verbose gopro.png | grep -e "^[0-9a-f]$" | grep . | xxd -r -p
```
此脚本没有发现明显的投毒代码,但是`grep -e "^[0-9a-f]$"`这段命令过滤了十六进制字符串,存在一定风险,因此判定投毒风险为10%。

**项目地址:** [y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment](https://github.com/y1nglamore/CVE-2022-44268-ImageMagick-Vulnerable-Docker-Environment)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)

---

