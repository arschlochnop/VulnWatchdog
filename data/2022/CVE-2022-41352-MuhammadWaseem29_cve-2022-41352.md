# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md](../2022/CVE-2022-41352-MuhammadWaseem29_cve-2022-41352.md)

# CVE-2022-41352

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-Cr4ckC4t_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <9.0.0.p27和 <8.8.15.p34

**利用条件:** 需要目标Zimbra服务器开启邮件接收功能，且未安装相应的补丁或pax

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个远程代码执行漏洞，源于使用存在漏洞的`cpio`版本处理上传的压缩包。攻击者可以构造一个恶意的tar压缩包，其中包含指向`/opt/zimbra/jetty/webapps/zimbra/public`目录的符号链接，从而将恶意JSP文件写入该目录，进而通过访问该JSP文件执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，此漏洞利用代码是有效的。漏洞描述中提到可以通过 cpio 的 loophole 上传任意文件，从而导致 RCE。 搜索引擎结果中也显示此漏洞被广泛利用。

**投毒风险：**
代码的主要功能是构造一个恶意的tar文件，其中包含webshell，然后通过SMTP协议将该文件作为邮件附件发送给目标服务器。以下是对投毒风险的分析：

*   **Payload 植入:** POC代码本身包含恶意代码（webshell）。用户在使用此POC时，实际上就是在目标系统上部署一个webshell，这本身就是一种攻击行为。从这个意义上说，该POC *包含* 了恶意负载。
*   **配置信息:** POC代码中包含一些配置信息，例如目标服务器地址、webshell路径、文件名、发件人、收件人等。如果攻击者恶意修改这些配置信息，例如将webshell路径修改为其他敏感目录，可能会导致更严重的后果。
*   **SMTP配置：**POC代码需要配置SMTP服务器信息才能发送邮件。如果攻击者在未授权的情况下使用他人的SMTP服务器，可能会导致法律问题。

综合以上因素，我评估该POC代码存在 **10%** 的投毒风险。主要风险点在于使用者可能会被诱导使用默认配置或者被恶意配置导致更严重的后果，或是滥用他人SMTP。

**利用方式：**

1.  **配置目标信息：** 修改POC代码中的`TARGET`（目标Zimbra服务器地址）、`WEBSHELL_PATH`和`WEBSHELL_NAME`（webshell的存放路径和名称）、`SENDER`和`RECIPIENT`（发件人和收件人邮箱地址）等参数。
2.  **构造恶意Tar文件：** POC代码会创建一个包含恶意JSP webshell的tar文件。该tar文件利用了`cpio`命令处理符号链接时的漏洞，将webshell写入到`/opt/zimbra/jetty/webapps/zimbra/public`目录下。
3.  **发送邮件：** POC代码通过SMTP协议将构造好的tar文件作为附件发送给目标Zimbra服务器。即使收件人不存在，只要邮件被Zimbra服务器处理，漏洞就会被触发。
4.  **触发漏洞：** Zimbra服务器的amavis组件使用存在漏洞的`cpio`命令解压收到的tar文件，恶意JSP文件被写入到指定目录。
5.  **远程代码执行：** 攻击者通过Web浏览器访问上传的JSP webshell，从而在Zimbra服务器上执行任意代码。

**项目地址:** [Cr4ckC4t/cve-2022-41352-zimbra-rce](https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #2

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #3

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---



---

## POC #3

**来源**: [CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md](../2022/CVE-2022-41352-qailanet_cve-2022-41352-zimbra-rce.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致服务器完全控制和数据泄露

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要能够上传文件到 Zimbra 服务器，利用 amavis 组件的 cpio 解压漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中存在的一个远程代码执行漏洞。攻击者可以通过 amavis 组件的 cpio 解压漏洞上传恶意文件，最终导致任意代码执行。

**有效性：**
提供的 JSP Webshell 代码是有效的。攻击者可以通过构造包含恶意路径的 cpio 压缩包，将其上传到 Zimbra 服务器，利用 amavis 解压时的路径穿越漏洞，将 JSP Webshell 写入到 /opt/zimbra/jetty/webapps/zimbra/public 目录下。然后，攻击者可以通过访问该 Webshell，执行任意系统命令。

**投毒风险：**
该POC代码本身是一个标准的JSP Webshell，风险主要在于其被用于非法目的，例如远程控制服务器，窃取数据等。但从代码本身来看，直接植入恶意代码的风险较低。5% 的风险评估主要考虑到代码部署过程中可能存在的潜在风险，例如作者可能诱导使用者修改代码，从而引入恶意功能。

**利用方式：**
1.  构造恶意的 cpio 压缩包，其中包含一个精心设计的目录结构和 JSP Webshell 文件 (shell.jsp)，该目录结构包含相对路径，例如 `../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`。
2.  通过 Zimbra 的某个允许文件上传的接口（通常是邮件附件功能），将恶意的 cpio 压缩包上传到服务器。
3.  Zimbra 的 amavis 组件会使用 cpio 命令解压该压缩包，由于 cpio 没有正确处理相对路径，JSP Webshell 文件会被写入到 /opt/zimbra/jetty/webapps/zimbra/public/shell.jsp。
4.  攻击者可以通过访问 `https://<zimbra_server>/zimbra/public/shell.jsp?cmd=<command>` 来执行任意系统命令。

**搜索引擎结果分析：**
搜索引擎结果确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。
- 多个网页 (NVD, Rapid7, Fortinet, Securelist, Kaspersky) 描述了该漏洞以及利用方式.
- CISA KEV 目录也收录了该漏洞, 证实其已被广泛利用。
- Github上存在相关的POC代码。


**项目地址:** [qailanet/cve-2022-41352-zimbra-rce](https://github.com/qailanet/cve-2022-41352-zimbra-rce)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #4

**来源**: [CVE-2022-41352-rxerium_CVE-2022-41352.md](../2022/CVE-2022-41352-rxerium_CVE-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 目标服务器运行受影响的Zimbra版本，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite 8.8.15和9.0版本中存在的远程代码执行漏洞。攻击者可以通过上传恶意文件，利用cpio的漏洞（提取到/opt/zimbra/jetty/webapps/zimbra/public）来覆盖或创建文件，从而获得未经授权的访问权限。搜索结果显示该漏洞在野外被积极利用。漏洞利用方式是通过构造包含恶意路径的cpio文件，上传到Zimbra服务器，利用amavis组件处理该文件时，将文件解压到指定目录，从而实现任意文件写入，进而可能执行恶意代码。提供的POC代码 `template.yaml` 是一个 Nuclei 模板，用于检测目标 Zimbra 服务器是否存在此漏洞。它通过发送 GET 请求到 `/js/zimbraMail/share/model/ZmSettings.js` 并检查响应头和响应体中是否包含特定的关键字，例如 'Zimbra Collaboration Suite Web Client'，'application/x-javascript' 和版本号 '8.8.15' 或 '9.0' 来判断目标是否受影响。POC代码本身不包含任何可疑或恶意的代码，它仅仅是检测漏洞是否存在。因此，可以认为投毒风险较低，为0%。

根据CISA ADP的分析，此漏洞的威胁程度评分为Critical, 并且已知被积极利用。


**项目地址:** [rxerium/CVE-2022-41352](https://github.com/rxerium/CVE-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

## POC #5

**来源**: [CVE-2022-41352-segfault-it_cve-2022-41352.md](../2022/CVE-2022-41352-segfault-it_cve-2022-41352.md)

## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)

---

