# CVE-2022-39299

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md](../2022/CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md)

## CVE-2022-39299 - passport-saml 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过

**影响版本:** < 3.2.2

**利用条件:** 需要目标系统使用存在漏洞版本的passport-saml库，且攻击者能够构造或获取任意IDP签名的XML元素。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299 允许远程攻击者通过在 SAML 响应中包含多个根元素来绕过身份验证。漏洞存在于 `passport-saml` 库的签名验证逻辑中，该逻辑未能正确处理包含多个根元素的 XML 文档。攻击者可以利用此漏洞，通过构造包含恶意负载的 SAML 响应，绕过身份验证并冒充任意用户。

**有效性：**
根据搜索引擎结果，存在公开的PoC利用代码（https://github.com/doyensec/CVE-2022-39299_PoC_Generator）。这意味着漏洞利用的有效性较高，存在可利用的工具。

**投毒风险：**
提供的漏洞利用代码片段 `/tmp/69f5ed06165383c768ca5368c904221b/README.md` 仅仅是一个 README 文件，内容是关于漏洞的研究整理，本身不包含任何可执行代码，因此直接的投毒风险较低。但是考虑到漏洞利用代码仓库通常包含复杂的逻辑，并且攻击者可能通过其他方式（例如，在PoC生成器中嵌入恶意代码）进行投毒，因此仍然存在一定的风险。根据经验，考虑到当前PoC文件的简洁性,推断投毒风险为10%。

**利用方式：**
1.  攻击者需要确定目标系统使用的 `passport-saml` 版本低于 3.2.2。
2.  攻击者需要构造一个包含多个根元素的恶意 SAML 响应。该响应包含一个合法的签名元素，以及一个包含恶意负载的根元素。
3.  攻击者将构造的恶意 SAML 响应发送到目标系统。
4.  目标系统使用存在漏洞的 `passport-saml` 库验证 SAML 响应的签名。
5.  由于签名验证逻辑的缺陷，`passport-saml` 可能会错误地验证签名，并允许攻击者绕过身份验证。

**项目地址:** [KaztoRay/CVE-2022-39299-Research](https://github.com/KaztoRay/CVE-2022-39299-Research)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---

## POC #2

**来源**: [CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md](../2022/CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md)

# CVE-2022-39299

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md](../2022/CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md)

## CVE-2022-39299 - passport-saml 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过

**影响版本:** < 3.2.2

**利用条件:** 需要目标系统使用存在漏洞版本的passport-saml库，且攻击者能够构造或获取任意IDP签名的XML元素。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299 允许远程攻击者通过在 SAML 响应中包含多个根元素来绕过身份验证。漏洞存在于 `passport-saml` 库的签名验证逻辑中，该逻辑未能正确处理包含多个根元素的 XML 文档。攻击者可以利用此漏洞，通过构造包含恶意负载的 SAML 响应，绕过身份验证并冒充任意用户。

**有效性：**
根据搜索引擎结果，存在公开的PoC利用代码（https://github.com/doyensec/CVE-2022-39299_PoC_Generator）。这意味着漏洞利用的有效性较高，存在可利用的工具。

**投毒风险：**
提供的漏洞利用代码片段 `/tmp/69f5ed06165383c768ca5368c904221b/README.md` 仅仅是一个 README 文件，内容是关于漏洞的研究整理，本身不包含任何可执行代码，因此直接的投毒风险较低。但是考虑到漏洞利用代码仓库通常包含复杂的逻辑，并且攻击者可能通过其他方式（例如，在PoC生成器中嵌入恶意代码）进行投毒，因此仍然存在一定的风险。根据经验，考虑到当前PoC文件的简洁性,推断投毒风险为10%。

**利用方式：**
1.  攻击者需要确定目标系统使用的 `passport-saml` 版本低于 3.2.2。
2.  攻击者需要构造一个包含多个根元素的恶意 SAML 响应。该响应包含一个合法的签名元素，以及一个包含恶意负载的根元素。
3.  攻击者将构造的恶意 SAML 响应发送到目标系统。
4.  目标系统使用存在漏洞的 `passport-saml` 库验证 SAML 响应的签名。
5.  由于签名验证逻辑的缺陷，`passport-saml` 可能会错误地验证签名，并允许攻击者绕过身份验证。

**项目地址:** [KaztoRay/CVE-2022-39299-Research](https://github.com/KaztoRay/CVE-2022-39299-Research)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---

## POC #2

**来源**: [CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md](../2022/CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md)

# CVE-2022-39299

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md](../2022/CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md)

## CVE-2022-39299 - passport-saml 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过

**影响版本:** < 3.2.2

**利用条件:** 需要目标系统使用存在漏洞版本的passport-saml库，且攻击者能够构造或获取任意IDP签名的XML元素。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299 允许远程攻击者通过在 SAML 响应中包含多个根元素来绕过身份验证。漏洞存在于 `passport-saml` 库的签名验证逻辑中，该逻辑未能正确处理包含多个根元素的 XML 文档。攻击者可以利用此漏洞，通过构造包含恶意负载的 SAML 响应，绕过身份验证并冒充任意用户。

**有效性：**
根据搜索引擎结果，存在公开的PoC利用代码（https://github.com/doyensec/CVE-2022-39299_PoC_Generator）。这意味着漏洞利用的有效性较高，存在可利用的工具。

**投毒风险：**
提供的漏洞利用代码片段 `/tmp/69f5ed06165383c768ca5368c904221b/README.md` 仅仅是一个 README 文件，内容是关于漏洞的研究整理，本身不包含任何可执行代码，因此直接的投毒风险较低。但是考虑到漏洞利用代码仓库通常包含复杂的逻辑，并且攻击者可能通过其他方式（例如，在PoC生成器中嵌入恶意代码）进行投毒，因此仍然存在一定的风险。根据经验，考虑到当前PoC文件的简洁性,推断投毒风险为10%。

**利用方式：**
1.  攻击者需要确定目标系统使用的 `passport-saml` 版本低于 3.2.2。
2.  攻击者需要构造一个包含多个根元素的恶意 SAML 响应。该响应包含一个合法的签名元素，以及一个包含恶意负载的根元素。
3.  攻击者将构造的恶意 SAML 响应发送到目标系统。
4.  目标系统使用存在漏洞的 `passport-saml` 库验证 SAML 响应的签名。
5.  由于签名验证逻辑的缺陷，`passport-saml` 可能会错误地验证签名，并允许攻击者绕过身份验证。

**项目地址:** [KaztoRay/CVE-2022-39299-Research](https://github.com/KaztoRay/CVE-2022-39299-Research)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---

## POC #2

**来源**: [CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md](../2022/CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md)

# CVE-2022-39299

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md](../2022/CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md)

## CVE-2022-39299 - passport-saml 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过

**影响版本:** < 3.2.2

**利用条件:** 需要目标系统使用存在漏洞版本的passport-saml库，且攻击者能够构造或获取任意IDP签名的XML元素。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299 允许远程攻击者通过在 SAML 响应中包含多个根元素来绕过身份验证。漏洞存在于 `passport-saml` 库的签名验证逻辑中，该逻辑未能正确处理包含多个根元素的 XML 文档。攻击者可以利用此漏洞，通过构造包含恶意负载的 SAML 响应，绕过身份验证并冒充任意用户。

**有效性：**
根据搜索引擎结果，存在公开的PoC利用代码（https://github.com/doyensec/CVE-2022-39299_PoC_Generator）。这意味着漏洞利用的有效性较高，存在可利用的工具。

**投毒风险：**
提供的漏洞利用代码片段 `/tmp/69f5ed06165383c768ca5368c904221b/README.md` 仅仅是一个 README 文件，内容是关于漏洞的研究整理，本身不包含任何可执行代码，因此直接的投毒风险较低。但是考虑到漏洞利用代码仓库通常包含复杂的逻辑，并且攻击者可能通过其他方式（例如，在PoC生成器中嵌入恶意代码）进行投毒，因此仍然存在一定的风险。根据经验，考虑到当前PoC文件的简洁性,推断投毒风险为10%。

**利用方式：**
1.  攻击者需要确定目标系统使用的 `passport-saml` 版本低于 3.2.2。
2.  攻击者需要构造一个包含多个根元素的恶意 SAML 响应。该响应包含一个合法的签名元素，以及一个包含恶意负载的根元素。
3.  攻击者将构造的恶意 SAML 响应发送到目标系统。
4.  目标系统使用存在漏洞的 `passport-saml` 库验证 SAML 响应的签名。
5.  由于签名验证逻辑的缺陷，`passport-saml` 可能会错误地验证签名，并允许攻击者绕过身份验证。

**项目地址:** [KaztoRay/CVE-2022-39299-Research](https://github.com/KaztoRay/CVE-2022-39299-Research)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---

## POC #2

**来源**: [CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md](../2022/CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md)

# CVE-2022-39299

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md](../2022/CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md)

## CVE-2022-39299 - passport-saml 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过

**影响版本:** < 3.2.2

**利用条件:** 需要目标系统使用存在漏洞版本的passport-saml库，且攻击者能够构造或获取任意IDP签名的XML元素。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299 允许远程攻击者通过在 SAML 响应中包含多个根元素来绕过身份验证。漏洞存在于 `passport-saml` 库的签名验证逻辑中，该逻辑未能正确处理包含多个根元素的 XML 文档。攻击者可以利用此漏洞，通过构造包含恶意负载的 SAML 响应，绕过身份验证并冒充任意用户。

**有效性：**
根据搜索引擎结果，存在公开的PoC利用代码（https://github.com/doyensec/CVE-2022-39299_PoC_Generator）。这意味着漏洞利用的有效性较高，存在可利用的工具。

**投毒风险：**
提供的漏洞利用代码片段 `/tmp/69f5ed06165383c768ca5368c904221b/README.md` 仅仅是一个 README 文件，内容是关于漏洞的研究整理，本身不包含任何可执行代码，因此直接的投毒风险较低。但是考虑到漏洞利用代码仓库通常包含复杂的逻辑，并且攻击者可能通过其他方式（例如，在PoC生成器中嵌入恶意代码）进行投毒，因此仍然存在一定的风险。根据经验，考虑到当前PoC文件的简洁性,推断投毒风险为10%。

**利用方式：**
1.  攻击者需要确定目标系统使用的 `passport-saml` 版本低于 3.2.2。
2.  攻击者需要构造一个包含多个根元素的恶意 SAML 响应。该响应包含一个合法的签名元素，以及一个包含恶意负载的根元素。
3.  攻击者将构造的恶意 SAML 响应发送到目标系统。
4.  目标系统使用存在漏洞的 `passport-saml` 库验证 SAML 响应的签名。
5.  由于签名验证逻辑的缺陷，`passport-saml` 可能会错误地验证签名，并允许攻击者绕过身份验证。

**项目地址:** [KaztoRay/CVE-2022-39299-Research](https://github.com/KaztoRay/CVE-2022-39299-Research)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---

## POC #2

**来源**: [CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md](../2022/CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md)

# CVE-2022-39299

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md](../2022/CVE-2022-39299-KaztoRay_CVE-2022-39299-Research.md)

## CVE-2022-39299 - passport-saml 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过

**影响版本:** < 3.2.2

**利用条件:** 需要目标系统使用存在漏洞版本的passport-saml库，且攻击者能够构造或获取任意IDP签名的XML元素。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299 允许远程攻击者通过在 SAML 响应中包含多个根元素来绕过身份验证。漏洞存在于 `passport-saml` 库的签名验证逻辑中，该逻辑未能正确处理包含多个根元素的 XML 文档。攻击者可以利用此漏洞，通过构造包含恶意负载的 SAML 响应，绕过身份验证并冒充任意用户。

**有效性：**
根据搜索引擎结果，存在公开的PoC利用代码（https://github.com/doyensec/CVE-2022-39299_PoC_Generator）。这意味着漏洞利用的有效性较高，存在可利用的工具。

**投毒风险：**
提供的漏洞利用代码片段 `/tmp/69f5ed06165383c768ca5368c904221b/README.md` 仅仅是一个 README 文件，内容是关于漏洞的研究整理，本身不包含任何可执行代码，因此直接的投毒风险较低。但是考虑到漏洞利用代码仓库通常包含复杂的逻辑，并且攻击者可能通过其他方式（例如，在PoC生成器中嵌入恶意代码）进行投毒，因此仍然存在一定的风险。根据经验，考虑到当前PoC文件的简洁性,推断投毒风险为10%。

**利用方式：**
1.  攻击者需要确定目标系统使用的 `passport-saml` 版本低于 3.2.2。
2.  攻击者需要构造一个包含多个根元素的恶意 SAML 响应。该响应包含一个合法的签名元素，以及一个包含恶意负载的根元素。
3.  攻击者将构造的恶意 SAML 响应发送到目标系统。
4.  目标系统使用存在漏洞的 `passport-saml` 库验证 SAML 响应的签名。
5.  由于签名验证逻辑的缺陷，`passport-saml` 可能会错误地验证签名，并允许攻击者绕过身份验证。

**项目地址:** [KaztoRay/CVE-2022-39299-Research](https://github.com/KaztoRay/CVE-2022-39299-Research)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---

## POC #2

**来源**: [CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md](../2022/CVE-2022-39299-doyensec_CVE-2022-39299_PoC_Generator.md)

## CVE-2022-39299 - Passport-SAML 签名绕过

**漏洞编号:** CVE-2022-39299

**漏洞类型:** 签名绕过

**影响应用:** passport-saml

**危害等级:** 高危，可能导致身份验证绕过和未授权访问

**影响版本:** < 3.2.2

**利用条件:** 目标应用使用passport-saml进行SAML SSO集成，并且租户管理员可以配置自定义IdP。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-39299漏洞存在于passport-saml 3.2.2之前的版本中。攻击者可以利用多根XML元素绕过签名验证，从而伪造SAML响应，欺骗应用进行身份验证。攻击者需要拥有任意IDP签名的XML元素，或者能够触发生成签名消息。该漏洞的利用方式是构造包含多个根元素的SAML响应，其中一个根元素包含有效的签名（例如，错误消息），另一个根元素包含伪造的身份验证和授权信息。由于passport-saml只验证第一个根元素的签名，而XPath可以遍历多个根元素，因此可以绕过签名验证，篡改身份验证信息。

POC代码通过payloadGenerator.py生成包含恶意负载的SAML响应。根据代码，投毒风险较低，主要是因为POC依赖于用户自定义`payload_appendix.xml`来插入恶意认证/授权信息，且`openssl`证书生成也由用户控制。潜在的投毒点可能存在于`payloadGenerator.py`，但代码相对简单，人工审计和复现可以验证其安全性。README文件和相关链接指向了漏洞的详细信息和修复补丁，方便用户了解和修复漏洞。因此，投毒风险评估为较低。

**项目地址:** [doyensec/CVE-2022-39299_PoC_Generator](https://github.com/doyensec/CVE-2022-39299_PoC_Generator)

**漏洞详情:** [CVE-2022-39299](https://nvd.nist.gov/vuln/detail/CVE-2022-39299)

---



---



---



---



---



---

