# CVE-2022-22978

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22978-DeEpinGh0st_CVE-2022-22978.md](../2022/CVE-2022-22978-DeEpinGh0st_CVE-2022-22978.md)

## CVE-2022-22978-Spring Security权限绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 权限绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring Security 5.5.x < 5.5.7, Spring Security 5.6.x < 5.6.4, Spring security versions 5.4.x prior to 5.4.11+ and all earlier unsupported versions

**利用条件:** 使用了RegexRequestMatcher，并且正则表达式中包含"."

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978 是 Spring Security 中的一个权限绕过漏洞。当使用 RegexRequestMatcher 并配置不当，特别是当正则表达式包含`.`时，可能被绕过。攻击者可以通过构造包含换行符（%0a）的恶意请求，绕过身份验证。提供的POC Dockerfile 描述了如何构建和运行受影响的 Spring Security 应用程序的镜像。README.md 文件展示了如何使用 payload `http://localhost:8080/admin/index%0a` 绕过身份验证访问 /admin/index 路径。尽管POC文件mvnw 是 Maven 的包装脚本，通常用于构建项目，但该脚本本身没有明显的投毒迹象。但是，考虑到代码仓库的复杂性，以及自动构建过程中可能存在的风险，例如，构建时可以执行任意命令，因此仍然存在一定的投毒风险。此风险很低，约为5%，因为没有直接证据表明存在恶意代码。利用方式是发送带有换行符的恶意请求，绕过 RegexRequestMatcher 的检查。

**项目地址:** [DeEpinGh0st/CVE-2022-22978](https://github.com/DeEpinGh0st/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #2

**来源**: [CVE-2022-22978-Raghvendra1207_CVE-2022-22978.md](../2022/CVE-2022-22978-Raghvendra1207_CVE-2022-22978.md)

## CVE-2022-22978 - Spring Security Authorization Bypass

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用了RegexRequestMatcher，并且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22978 漏洞存在于Spring Security的RegexRequestMatcher中。当使用RegexRequestMatcher并且正则表达式包含`.`时，攻击者可以通过在URL中插入换行符（\r或\n，编码为%0d或%0a）来绕过授权验证。提供的PoC代码通过创建一个简单的Spring Boot应用程序，配置Spring Security来保护/admin/*路径，并使用存在漏洞的版本来演示如何通过插入%0d或%0a绕过身份验证。 

**有效性：** PoC代码有效，可以重现漏洞。

**投毒风险：** 仔细分析PoC代码后，发现其主要目的是为了演示漏洞，并无明显的恶意代码。但是，由于gradle脚本存在远程依赖的风险，且demo中使用了特定的spring security版本。作者可能存在隐藏的投毒代码或依赖后门，例如通过恶意依赖项植入，考虑到漏洞利用的便捷性，以及spring框架的安全性，投毒风险相对较低。 此处将风险设置为10%。

**利用方式：** 
1. 应用程序使用Spring Security，并且使用了RegexRequestMatcher进行URL匹配。
2. RegexRequestMatcher中的正则表达式包含`.`。
3. 攻击者构造包含%0d或%0a的URL，例如/admin/%0dxyz，绕过身份验证，访问受保护的资源。

**项目地址:** [Raghvendra1207/CVE-2022-22978](https://github.com/Raghvendra1207/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #3

**来源**: [CVE-2022-22978-aeifkz_CVE-2022-22978.md](../2022/CVE-2022-22978-aeifkz_CVE-2022-22978.md)

# CVE-2022-22978

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-22978-DeEpinGh0st_CVE-2022-22978.md](../2022/CVE-2022-22978-DeEpinGh0st_CVE-2022-22978.md)

## CVE-2022-22978-Spring Security权限绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 权限绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring Security 5.5.x < 5.5.7, Spring Security 5.6.x < 5.6.4, Spring security versions 5.4.x prior to 5.4.11+ and all earlier unsupported versions

**利用条件:** 使用了RegexRequestMatcher，并且正则表达式中包含"."

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978 是 Spring Security 中的一个权限绕过漏洞。当使用 RegexRequestMatcher 并配置不当，特别是当正则表达式包含`.`时，可能被绕过。攻击者可以通过构造包含换行符（%0a）的恶意请求，绕过身份验证。提供的POC Dockerfile 描述了如何构建和运行受影响的 Spring Security 应用程序的镜像。README.md 文件展示了如何使用 payload `http://localhost:8080/admin/index%0a` 绕过身份验证访问 /admin/index 路径。尽管POC文件mvnw 是 Maven 的包装脚本，通常用于构建项目，但该脚本本身没有明显的投毒迹象。但是，考虑到代码仓库的复杂性，以及自动构建过程中可能存在的风险，例如，构建时可以执行任意命令，因此仍然存在一定的投毒风险。此风险很低，约为5%，因为没有直接证据表明存在恶意代码。利用方式是发送带有换行符的恶意请求，绕过 RegexRequestMatcher 的检查。

**项目地址:** [DeEpinGh0st/CVE-2022-22978](https://github.com/DeEpinGh0st/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #2

**来源**: [CVE-2022-22978-Raghvendra1207_CVE-2022-22978.md](../2022/CVE-2022-22978-Raghvendra1207_CVE-2022-22978.md)

## CVE-2022-22978 - Spring Security Authorization Bypass

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用了RegexRequestMatcher，并且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22978 漏洞存在于Spring Security的RegexRequestMatcher中。当使用RegexRequestMatcher并且正则表达式包含`.`时，攻击者可以通过在URL中插入换行符（\r或\n，编码为%0d或%0a）来绕过授权验证。提供的PoC代码通过创建一个简单的Spring Boot应用程序，配置Spring Security来保护/admin/*路径，并使用存在漏洞的版本来演示如何通过插入%0d或%0a绕过身份验证。 

**有效性：** PoC代码有效，可以重现漏洞。

**投毒风险：** 仔细分析PoC代码后，发现其主要目的是为了演示漏洞，并无明显的恶意代码。但是，由于gradle脚本存在远程依赖的风险，且demo中使用了特定的spring security版本。作者可能存在隐藏的投毒代码或依赖后门，例如通过恶意依赖项植入，考虑到漏洞利用的便捷性，以及spring框架的安全性，投毒风险相对较低。 此处将风险设置为10%。

**利用方式：** 
1. 应用程序使用Spring Security，并且使用了RegexRequestMatcher进行URL匹配。
2. RegexRequestMatcher中的正则表达式包含`.`。
3. 攻击者构造包含%0d或%0a的URL，例如/admin/%0dxyz，绕过身份验证，访问受保护的资源。

**项目地址:** [Raghvendra1207/CVE-2022-22978](https://github.com/Raghvendra1207/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #3

**来源**: [CVE-2022-22978-aeifkz_CVE-2022-22978.md](../2022/CVE-2022-22978-aeifkz_CVE-2022-22978.md)

## CVE-2022-22978-Spring Security-授权绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用RegexRequestMatcher，且正则表达式中包含"."

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22978是Spring Security中的一个授权绕过漏洞。当使用RegexRequestMatcher时，如果正则表达式配置不当（例如包含"."），攻击者可以通过构造特殊的URL来绕过安全检查。根据漏洞利用代码中的README.md，攻击者可以尝试使用`%0a`或`%0d`等字符进行换行，以欺骗RegexRequestMatcher，从而绕过身份验证。例如，`http://localhost:9090/login%0a` 尝试绕过login验证。

**有效性：**
根据POC代码中的README.md的描述，其中一个利用方式是成功的，其余是失败的，所以POC的有效性有一定的局限性。

**投毒风险：**
查看提供的文件列表，其中包含了Maven wrapper（`mvnw`），`HELP.md`和`README.md`等文件。Maven wrapper本身是为了方便构建和运行项目，`HELP.md`提供了参考文档链接，`README.md`提供了漏洞利用的简单说明。

虽然没有明显的恶意代码，但需要注意的是，任何引入的第三方库或构建脚本都存在潜在的风险。`mvnw`脚本在执行时会下载Maven依赖，如果依赖源被篡改，则可能引入恶意依赖。这个仓库相对简单，投毒的可能性较低，但不能完全排除，风险评估大约10%。

**利用方式：**
利用方式是构造包含特殊字符（例如换行符`%0a`或`%0d`）的URL，以绕过RegexRequestMatcher的检查。攻击者需要找到使用了存在漏洞的RegexRequestMatcher的端点，并尝试通过精心构造的URL来访问受保护的资源。核心在于利用不同Servlet容器对换行符处理的差异，造成正则匹配失效。

**总结：**
该漏洞的关键在于对RegexRequestMatcher的不当使用，以及不同Servlet容器对特殊字符处理的差异。攻击者利用这些差异，构造特定的URL，从而绕过授权检查。

**项目地址:** [aeifkz/CVE-2022-22978](https://github.com/aeifkz/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #4

**来源**: [CVE-2022-22978-ducluongtran9121_CVE-2022-22978-PoC.md](../2022/CVE-2022-22978-ducluongtran9121_CVE-2022-22978-PoC.md)

## CVE-2022-22978 - Spring Security Authorization Bypass

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring Security 5.4.x prior to 5.4.11, 5.5.x prior to 5.5.7, 5.6.x prior to 5.6.4 以及所有更早的未支持版本

**利用条件:** 应用程序使用RegexRequestMatcher，且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978 漏洞存在于 Spring Security 的 RegexRequestMatcher 类中。当应用程序使用 RegexRequestMatcher，且正则表达式中包含 `.` 时，由于 servlet 容器对换行符处理的差异，攻击者可以通过在 URL 中插入 \r (%0d) 或 \n (%0a) 字符来绕过授权。 

**利用方式：**

1.  应用程序使用 Spring Security，且版本在受影响范围内（5.4.x < 5.4.11, 5.5.x < 5.5.7, 5.6.x < 5.6.4）。
2.  Spring Security 配置中使用了 RegexRequestMatcher 来进行 URL 匹配和授权控制。
3.  RegexRequestMatcher 的正则表达式包含 `.` 字符，用于匹配任意字符。
4.  攻击者构造包含 `%0d` 或 `%0a` 的恶意 URL，例如 `/admin/%0dxyz`。
5.  由于 Spring Security 默认的正则表达式引擎无法正确处理这些换行符，导致授权检查被绕过，攻击者可以访问 `/admin/xyz` 资源，而无需经过身份验证。

**POC有效性分析：**
提供的POC代码通过创建一个简单的 Spring Boot Web 应用程序，并使用 RegexRequestMatcher 配置对 `/admin/*` 路径进行保护。POC 演示了如何在受影响的 Spring Security 版本中，使用 `%0d` 或 `%0a` 绕过授权。因此，提供的 POC 代码是有效的，它重现了漏洞并证明了其可利用性。

**投毒风险分析：**
分析提供的 `build.gradle` 和 `README.md` 文件，以及给出的POC代码，看起来是一个简单的漏洞演示，用于重现和验证 CVE-2022-22978 漏洞。`build.gradle` 文件指定了存在漏洞的 Spring Security 版本（5.6.3），`README.md` 提供了漏洞描述、分析、演示和修复方法。由于是漏洞验证代码，因此作者可能通过一些方式来绕过spring security 的安全验证，从而实现漏洞的验证。虽然该仓库的主要目的是演示漏洞，但仍然存在作者在其他地方（例如图片链接指向恶意网站或在Demo程序埋藏后门）进行投毒的风险，但这种可能性较小。因此，投毒风险约为 5%。

**项目地址:** [ducluongtran9121/CVE-2022-22978-PoC](https://github.com/ducluongtran9121/CVE-2022-22978-PoC)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #5

**来源**: [CVE-2022-22978-he-ewo_CVE-2022-22978.md](../2022/CVE-2022-22978-he-ewo_CVE-2022-22978.md)

## CVE-2022-22978: Spring Security Authorization Bypass

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用了RegexRequestMatcher，且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22978是Spring Security中的一个授权绕过漏洞。当使用`RegexRequestMatcher`进行请求匹配时，如果正则表达式中包含`.`，并且Servlet容器对URL中的换行符处理不当，攻击者可以通过在URL中插入编码后的换行符（例如`%0a`或`%0d`）来绕过授权检查。

**有效性:** 提供的POC代码有效，它演示了如何通过在URL中插入`%0a`来绕过对`/admin`页面的访问限制。

**投毒风险:**  代码仓库本身主要是漏洞验证的演示代码，但存在一定的风险，因为攻击者可能会复制该仓库，并在此基础上添加恶意代码，然后传播出去。因此，不能完全排除投毒的可能性。代码仓库中展示的利用方式本身并不属于投毒，但是由于该仓库可能被二次修改，存在一定的投毒风险。例如，在docker-compose文件中修改镜像来源指向恶意镜像，或者在启动脚本中添加恶意行为。

**利用方式:**
1.  应用程序使用Spring Security，并且使用了`RegexRequestMatcher`进行权限控制。
2.  `RegexRequestMatcher`的正则表达式中包含`.`，这使得换行符可以被匹配。
3.  攻击者构造包含`%0a`或`%0d`等编码后换行符的恶意URL，例如`/admin/%0atest`。
4.  Servlet容器未正确处理URL中的换行符，导致`RegexRequestMatcher`的匹配结果被绕过。
5.  攻击者未经授权访问受保护的资源，例如管理页面。

**项目地址:** [he-ewo/CVE-2022-22978](https://github.com/he-ewo/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #6

**来源**: [CVE-2022-22978-umakant76705_CVE-2022-22978.md](../2022/CVE-2022-22978-umakant76705_CVE-2022-22978.md)

## CVE-2022-22978: Spring Security RegexRequestMatcher 身份验证绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 身份验证绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Spring Security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用 RegexRequestMatcher 并且正则表达式中包含 `.`

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22978 漏洞是 Spring Security 中的 RegexRequestMatcher 类的一个身份验证绕过漏洞。当应用程序使用 RegexRequestMatcher 并使用包含 `.` 的正则表达式时，攻击者可以通过在 URL 中插入换行符 (`\n` 或 `%0a`) 或回车符 (`\r` 或 `%0d`) 来绕过身份验证。这是因为默认情况下，`.` 不匹配换行符和回车符。漏洞利用代码演示了如何通过修改 URL 来绕过身份验证，从而访问受保护的资源。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞是有效的。PoC 代码清晰地展示了如何利用该漏洞绕过身份验证。

**投毒风险分析：**
分析 PoC 代码，主要包括 `README.md` 和 `build.gradle` 两个文件。
*   `README.md` 文件包含漏洞的描述、分析、演示和使用说明，没有发现恶意代码。
*   `build.gradle` 文件是 Gradle 构建脚本，指定了 Spring Boot 和 Spring Security 的版本以及其他依赖项。其中，`ext['spring-security.version'] = '5.6.3'` 指定了存在漏洞的 Spring Security 版本，但这只是为了演示漏洞，不是投毒行为。
总体来说，该 PoC 代码的投毒风险很低，约为 1%。主要风险可能在于下载和运行第三方代码本身带来的潜在风险，但就代码本身内容而言，未发现明显的投毒迹象。

**利用方式分析：**
1.  应用程序使用 Spring Security，并配置了使用 RegexRequestMatcher 进行身份验证。
2.  RegexRequestMatcher 的正则表达式中包含 `.`。
3.  攻击者构造包含 `%0a` 或 `%0d` 的恶意 URL。
4.  应用程序错误地将恶意 URL 视为已通过身份验证，从而允许攻击者访问受保护的资源。

**项目地址:** [umakant76705/CVE-2022-22978](https://github.com/umakant76705/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #7

**来源**: [CVE-2022-22978-wan9xx_CVE-2022-22978-demo.md](../2022/CVE-2022-22978-wan9xx_CVE-2022-22978-demo.md)

## CVE-2022-22978-Spring Security RegexRequestMatcher 身份验证绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 身份验证绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 1. Spring Security在漏洞影响范围内。
2. 使用spring-security的正则匹配器regexMatchers或者直接使用RegexRequestMatcher，并且使用了`.` 匹配路径，例如regexMatcher("/api/.*")。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978是一个Spring Security中的身份验证绕过漏洞。当应用程序使用`RegexRequestMatcher`并且在正则表达式中使用了`.`时，攻击者可以通过在URL中注入换行符（`%0a`或`%0d`）来绕过身份验证。漏洞利用代码显示，通过访问类似`http://127.0.0.1:8080/admin/admin%0a`的URL，可以绕过登录验证。但是，如果绕过的URL没有对应的Controller处理请求，会返回404错误。

**有效性：**提供的POC代码是有效的，可以成功绕过身份验证，但前提是目标应用程序使用了存在漏洞的`RegexRequestMatcher`配置，并且绕过的路径有对应的处理器。

**投毒风险：**提供的代码主要是演示漏洞利用，没有发现明显的恶意代码。代码主要是一些配置和示例，用于演示漏洞。但是，由于代码来自外部，存在极小的潜在风险（例如构建脚本或配置文件中的隐蔽依赖），因此评估为5%。

**利用方式：**
1.  确认目标应用程序使用受影响版本的Spring Security，并且使用了`RegexRequestMatcher`且包含`.`的配置，例如 `regexMatcher("/api/.*")`。
2.  构造包含换行符的URL，例如 `/admin/admin%0a`，尝试绕过身份验证。
3.  验证是否成功绕过身份验证，并可以访问受保护的资源。如果绕过成功，但服务器返回 404 错误，则说明绕过的路径没有相应的控制器处理。

**项目地址:** [wan9xx/CVE-2022-22978-demo](https://github.com/wan9xx/CVE-2022-22978-demo)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---



---

## POC #4

**来源**: [CVE-2022-22978-ducluongtran9121_CVE-2022-22978-PoC.md](../2022/CVE-2022-22978-ducluongtran9121_CVE-2022-22978-PoC.md)

## CVE-2022-22978 - Spring Security Authorization Bypass

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring Security 5.4.x prior to 5.4.11, 5.5.x prior to 5.5.7, 5.6.x prior to 5.6.4 以及所有更早的未支持版本

**利用条件:** 应用程序使用RegexRequestMatcher，且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978 漏洞存在于 Spring Security 的 RegexRequestMatcher 类中。当应用程序使用 RegexRequestMatcher，且正则表达式中包含 `.` 时，由于 servlet 容器对换行符处理的差异，攻击者可以通过在 URL 中插入 \r (%0d) 或 \n (%0a) 字符来绕过授权。 

**利用方式：**

1.  应用程序使用 Spring Security，且版本在受影响范围内（5.4.x < 5.4.11, 5.5.x < 5.5.7, 5.6.x < 5.6.4）。
2.  Spring Security 配置中使用了 RegexRequestMatcher 来进行 URL 匹配和授权控制。
3.  RegexRequestMatcher 的正则表达式包含 `.` 字符，用于匹配任意字符。
4.  攻击者构造包含 `%0d` 或 `%0a` 的恶意 URL，例如 `/admin/%0dxyz`。
5.  由于 Spring Security 默认的正则表达式引擎无法正确处理这些换行符，导致授权检查被绕过，攻击者可以访问 `/admin/xyz` 资源，而无需经过身份验证。

**POC有效性分析：**
提供的POC代码通过创建一个简单的 Spring Boot Web 应用程序，并使用 RegexRequestMatcher 配置对 `/admin/*` 路径进行保护。POC 演示了如何在受影响的 Spring Security 版本中，使用 `%0d` 或 `%0a` 绕过授权。因此，提供的 POC 代码是有效的，它重现了漏洞并证明了其可利用性。

**投毒风险分析：**
分析提供的 `build.gradle` 和 `README.md` 文件，以及给出的POC代码，看起来是一个简单的漏洞演示，用于重现和验证 CVE-2022-22978 漏洞。`build.gradle` 文件指定了存在漏洞的 Spring Security 版本（5.6.3），`README.md` 提供了漏洞描述、分析、演示和修复方法。由于是漏洞验证代码，因此作者可能通过一些方式来绕过spring security 的安全验证，从而实现漏洞的验证。虽然该仓库的主要目的是演示漏洞，但仍然存在作者在其他地方（例如图片链接指向恶意网站或在Demo程序埋藏后门）进行投毒的风险，但这种可能性较小。因此，投毒风险约为 5%。

**项目地址:** [ducluongtran9121/CVE-2022-22978-PoC](https://github.com/ducluongtran9121/CVE-2022-22978-PoC)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #5

**来源**: [CVE-2022-22978-he-ewo_CVE-2022-22978.md](../2022/CVE-2022-22978-he-ewo_CVE-2022-22978.md)

## CVE-2022-22978: Spring Security Authorization Bypass

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 授权绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用了RegexRequestMatcher，且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22978是Spring Security中的一个授权绕过漏洞。当使用`RegexRequestMatcher`进行请求匹配时，如果正则表达式中包含`.`，并且Servlet容器对URL中的换行符处理不当，攻击者可以通过在URL中插入编码后的换行符（例如`%0a`或`%0d`）来绕过授权检查。

**有效性:** 提供的POC代码有效，它演示了如何通过在URL中插入`%0a`来绕过对`/admin`页面的访问限制。

**投毒风险:**  代码仓库本身主要是漏洞验证的演示代码，但存在一定的风险，因为攻击者可能会复制该仓库，并在此基础上添加恶意代码，然后传播出去。因此，不能完全排除投毒的可能性。代码仓库中展示的利用方式本身并不属于投毒，但是由于该仓库可能被二次修改，存在一定的投毒风险。例如，在docker-compose文件中修改镜像来源指向恶意镜像，或者在启动脚本中添加恶意行为。

**利用方式:**
1.  应用程序使用Spring Security，并且使用了`RegexRequestMatcher`进行权限控制。
2.  `RegexRequestMatcher`的正则表达式中包含`.`，这使得换行符可以被匹配。
3.  攻击者构造包含`%0a`或`%0d`等编码后换行符的恶意URL，例如`/admin/%0atest`。
4.  Servlet容器未正确处理URL中的换行符，导致`RegexRequestMatcher`的匹配结果被绕过。
5.  攻击者未经授权访问受保护的资源，例如管理页面。

**项目地址:** [he-ewo/CVE-2022-22978](https://github.com/he-ewo/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #6

**来源**: [CVE-2022-22978-umakant76705_CVE-2022-22978.md](../2022/CVE-2022-22978-umakant76705_CVE-2022-22978.md)

## CVE-2022-22978: Spring Security RegexRequestMatcher 身份验证绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 身份验证绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Spring Security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用 RegexRequestMatcher 并且正则表达式中包含 `.`

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22978 漏洞是 Spring Security 中的 RegexRequestMatcher 类的一个身份验证绕过漏洞。当应用程序使用 RegexRequestMatcher 并使用包含 `.` 的正则表达式时，攻击者可以通过在 URL 中插入换行符 (`\n` 或 `%0a`) 或回车符 (`\r` 或 `%0d`) 来绕过身份验证。这是因为默认情况下，`.` 不匹配换行符和回车符。漏洞利用代码演示了如何通过修改 URL 来绕过身份验证，从而访问受保护的资源。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞是有效的。PoC 代码清晰地展示了如何利用该漏洞绕过身份验证。

**投毒风险分析：**
分析 PoC 代码，主要包括 `README.md` 和 `build.gradle` 两个文件。
*   `README.md` 文件包含漏洞的描述、分析、演示和使用说明，没有发现恶意代码。
*   `build.gradle` 文件是 Gradle 构建脚本，指定了 Spring Boot 和 Spring Security 的版本以及其他依赖项。其中，`ext['spring-security.version'] = '5.6.3'` 指定了存在漏洞的 Spring Security 版本，但这只是为了演示漏洞，不是投毒行为。
总体来说，该 PoC 代码的投毒风险很低，约为 1%。主要风险可能在于下载和运行第三方代码本身带来的潜在风险，但就代码本身内容而言，未发现明显的投毒迹象。

**利用方式分析：**
1.  应用程序使用 Spring Security，并配置了使用 RegexRequestMatcher 进行身份验证。
2.  RegexRequestMatcher 的正则表达式中包含 `.`。
3.  攻击者构造包含 `%0a` 或 `%0d` 的恶意 URL。
4.  应用程序错误地将恶意 URL 视为已通过身份验证，从而允许攻击者访问受保护的资源。

**项目地址:** [umakant76705/CVE-2022-22978](https://github.com/umakant76705/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

## POC #7

**来源**: [CVE-2022-22978-wan9xx_CVE-2022-22978-demo.md](../2022/CVE-2022-22978-wan9xx_CVE-2022-22978-demo.md)

## CVE-2022-22978-Spring Security RegexRequestMatcher 身份验证绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 身份验证绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Spring security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 1. Spring Security在漏洞影响范围内。
2. 使用spring-security的正则匹配器regexMatchers或者直接使用RegexRequestMatcher，并且使用了`.` 匹配路径，例如regexMatcher("/api/.*")。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978是一个Spring Security中的身份验证绕过漏洞。当应用程序使用`RegexRequestMatcher`并且在正则表达式中使用了`.`时，攻击者可以通过在URL中注入换行符（`%0a`或`%0d`）来绕过身份验证。漏洞利用代码显示，通过访问类似`http://127.0.0.1:8080/admin/admin%0a`的URL，可以绕过登录验证。但是，如果绕过的URL没有对应的Controller处理请求，会返回404错误。

**有效性：**提供的POC代码是有效的，可以成功绕过身份验证，但前提是目标应用程序使用了存在漏洞的`RegexRequestMatcher`配置，并且绕过的路径有对应的处理器。

**投毒风险：**提供的代码主要是演示漏洞利用，没有发现明显的恶意代码。代码主要是一些配置和示例，用于演示漏洞。但是，由于代码来自外部，存在极小的潜在风险（例如构建脚本或配置文件中的隐蔽依赖），因此评估为5%。

**利用方式：**
1.  确认目标应用程序使用受影响版本的Spring Security，并且使用了`RegexRequestMatcher`且包含`.`的配置，例如 `regexMatcher("/api/.*")`。
2.  构造包含换行符的URL，例如 `/admin/admin%0a`，尝试绕过身份验证。
3.  验证是否成功绕过身份验证，并可以访问受保护的资源。如果绕过成功，但服务器返回 404 错误，则说明绕过的路径没有相应的控制器处理。

**项目地址:** [wan9xx/CVE-2022-22978-demo](https://github.com/wan9xx/CVE-2022-22978-demo)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)

---

