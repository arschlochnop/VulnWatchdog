# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

# CVE-2022-23093

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-23093-Symbolexe_DrayTek-Exploit.md](../2022/CVE-2022-23093-Symbolexe_DrayTek-Exploit.md)

## CVE-2022-23093 FreeBSD ping Stack-Based Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** 栈溢出

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致程序崩溃或有限的代码执行

**影响版本:** FreeBSD 13.1-RELEASE < p5, 12.4-RC2 < p2, 12.3-RELEASE < p10

**利用条件:** 需要能够向目标系统发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-23093是FreeBSD ping实用程序中的一个栈溢出漏洞。根据漏洞库信息和搜索结果，`ping`在处理ICMP响应的`pr_pack()`函数中，由于没有充分考虑IP选项头的存在，导致在复制IP和ICMP头到栈缓冲区时发生溢出。这个漏洞可以被远程主机触发，导致`ping`程序崩溃。虽然`ping`进程运行在capability模式sandbox中，限制了其与系统的交互，但仍然存在一定风险。

**POC代码分析：**

提供的Python脚本`DrayTek-Exploit.py`尝试利用此漏洞。它构造一个包含shellcode的ICMP包，并通过raw socket发送到目标地址。该shellcode是来自Gitsnik的FreeBSD/x86-64 execve代码，执行`/bin/sh`。脚本还打印IP和ICMP头信息，如果存在，还打印引用数据包。  

**漏洞利用方式：**

1.  攻击者使用raw socket创建一个ICMP数据包。
2.  攻击者在ICMP数据包的数据部分嵌入shellcode。脚本中包含的shellcode旨在执行/bin/sh，但可以替换为其他恶意代码。
3.  攻击者将构造好的ICMP数据包发送到目标FreeBSD系统。
4.  目标系统上的ping实用程序在处理收到的ICMP数据包时，由于栈缓冲区溢出，shellcode将被执行（如果绕过sandbox）。

**有效性评估：**

提供的POC代码似乎是有效的，因为它尝试利用CVE-2022-23093中描述的栈溢出漏洞，通过发送包含shellcode的特制ICMP包来尝试执行任意代码。但是，FreeBSD capability sandbox可能会限制shellcode的执行。

**投毒风险评估：**

尽管漏洞利用代码本身似乎是为了利用漏洞，但代码中包含执行`/bin/sh`的shellcode，默认shellcode行为具有不确定性，存在潜在风险。如果用户未意识到这一点直接使用，或者在不清楚shellcode作用的情况下使用，可能导致意外的系统修改或恶意行为。考虑到这种情况，将投毒风险评估为10%。README中存在提示更换shellcode，相对降低了误用风险，进一步降低了投毒风险。

**项目地址:** [Symbolexe/DrayTek-Exploit](https://github.com/Symbolexe/DrayTek-Exploit)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---



---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---



---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---



---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---



---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---



---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---



---

## POC #2

**来源**: [CVE-2022-23093-SystemVll_CVE-2022-23093.md](../2022/CVE-2022-23093-SystemVll_CVE-2022-23093.md)

## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)

---

