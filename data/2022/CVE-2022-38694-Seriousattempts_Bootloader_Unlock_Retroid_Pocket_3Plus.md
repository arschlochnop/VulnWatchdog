# CVE-2022-38694

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-38694-Seriousattempts_Bootloader_Unlock_Retroid_Pocket_3Plus.md](../2022/CVE-2022-38694-Seriousattempts_Bootloader_Unlock_Retroid_Pocket_3Plus.md)

# CVE-2022-38694

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-38694-Seriousattempts_Bootloader_Unlock_Retroid_Pocket_3Plus.md](../2022/CVE-2022-38694-Seriousattempts_Bootloader_Unlock_Retroid_Pocket_3Plus.md)

## CVE-2022-38694-Unisoc BootROM Bootloader Unlocking

**漏洞编号:** CVE-2022-38694

**漏洞类型:** BootROM漏洞/Bootloader解锁

**影响应用:** Unisoc T618 (Retroid Pocket 3+)

**危害等级:** 高危，允许未授权的Bootloader解锁和代码执行

**影响版本:** 受影响的Unisoc设备，具体版本信息需要进一步确定

**利用条件:** 需要物理访问设备，且可能需要进入特定模式（例如：Android Recovery/Download Mode）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-38694是一个Unisoc BootROM漏洞，允许攻击者绕过Bootloader锁。根据搜索结果和提供的漏洞利用代码（来自GitHub仓库TomKing062/CVE-2022-38694_unlock_bootloader以及TheGammaSqueeze仓库中的README.md），此漏洞可用于解锁Retroid Pocket 3+等设备的Bootloader。 

**利用方式:**
1.  **准备工作：** 安装Unisoc USB驱动，ADB工具。
2.  **进入特定模式：** 将设备置于Android Recovery/Download Mode。
3.  **执行漏洞利用代码：** 运行`unlock_autopatch_512.bat`脚本。 该脚本可能会推送`fdl1-dl.bin`和`fdl2-dl.bin`文件到设备的`/data/local/tmp/`目录。
4.  **Fastboot解锁：**  脚本完成后，设备进入fastboot模式，然后执行fastboot命令来解锁bootloader。
5.  **Hovatek 方法：** 另外一种利用方式是使用 Hovatek 修改的 fastboot 工具在 Linux 环境下执行。

**有效性评估：**
提供的POC代码基于TomKing062的GitHub仓库，并且已经被用于Retroid Pocket 3+设备的Bootloader解锁。因此，该POC代码被认为是有效的。

**投毒风险评估：**
虽然漏洞利用代码本身是为了解锁Bootloader，但考虑到以下因素，存在一定的投毒风险：

1.  **来源不明的文件：** 脚本中可能包含来路不明的二进制文件（例如`fdl1-dl.bin`，`fdl2-dl.bin`），这些文件可能包含恶意代码。虽然看起来与漏洞利用相关，但无法保证其安全性。
2.  **破坏设备：** 不正确的操作可能导致设备变砖。
3.  **第三方链接：** 代码中引用了多个第三方链接，例如Google Drive的.pac文件，这些链接存在被替换为恶意文件的风险。

综合来看，虽然主要目的是利用漏洞，但存在作者植入后门的风险，尤其体现在对未知来源二进制文件的使用上。虽然该代码已经被用户成功利用，但是考虑到安全性，仍然存在一定的投毒风险，预估投毒风险为10%。

**项目地址:** [Seriousattempts/Bootloader_Unlock_Retroid_Pocket_3Plus](https://github.com/Seriousattempts/Bootloader_Unlock_Retroid_Pocket_3Plus)

**漏洞详情:** [CVE-2022-38694](https://nvd.nist.gov/vuln/detail/CVE-2022-38694)

---

## POC #2

**来源**: [CVE-2022-38694-TheGammaSqueeze_Bootloader_Unlock_Anbernic_T820.md](../2022/CVE-2022-38694-TheGammaSqueeze_Bootloader_Unlock_Anbernic_T820.md)

## CVE-2022-38694 - Unisoc BootROM 漏洞

**漏洞编号:** CVE-2022-38694

**漏洞类型:** BootROM漏洞，Bootloader解锁

**影响应用:** Unisoc SoC

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** 受影响的Unisoc设备BootROM版本

**利用条件:** 需要物理访问设备，安装Unisoc USB驱动

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-38694是一个Unisoc SoC的BootROM漏洞，允许攻击者未经授权解锁Bootloader。根据搜索结果和提供的漏洞利用代码（unlock.bat脚本），利用方式如下：

1.  **漏洞利用方式：**
    *   攻击者需要物理访问目标设备。
    *   安装Unisoc USB驱动，以便计算机能够与设备通信。
    *   设备关机状态下，运行`unlock.bat`脚本。
    *   在脚本运行的30秒内，按住设备的HOME/BACK键并连接USB数据线。
    *   脚本将利用BootROM漏洞覆盖函数指针或返回地址，从而解锁Bootloader。
    *   设备重启后，会提示擦除数据，执行擦除操作即可完成解锁。

2.  **有效性：**
    *   根据搜索结果，尤其是GitHub链接，以及漏洞利用代码中的描述，该POC代码是有效的，可以用来解锁受影响的Unisoc设备的Bootloader。

3.  **投毒风险：**
    *   分析`README.md`和脚本内容，主要风险点在于下载链接和第三方驱动程序。
    *   驱动程序和解锁工具本身可能被篡改，包含恶意代码。即使是原作者也可能存在恶意。
    *   虽然代码参考了`TomKing062/CVE-2022-38694_unlock_bootloader`，但经过修改，增加了潜在的投毒风险。
    *   链接引导用户下载固件，链接可能为钓鱼链接，引导用户下载恶意固件。
    *   `unlock.bat`脚本需要仔细检查，以确认其只执行解锁Bootloader的必要操作，没有执行其他恶意行为。
    *   综合判断，投毒风险存在，评估为10%。主要基于该仓库的代码是针对特定设备修改过的，可能包含后门或恶意代码。
    *   此处的投毒风险主要指该仓库作者在解锁脚本或固件链接中加入恶意代码的可能性，而非POC验证的后门代码。

**项目地址:** [TheGammaSqueeze/Bootloader_Unlock_Anbernic_T820](https://github.com/TheGammaSqueeze/Bootloader_Unlock_Anbernic_T820)

**漏洞详情:** [CVE-2022-38694](https://nvd.nist.gov/vuln/detail/CVE-2022-38694)

---

## POC #3

**来源**: [CVE-2022-38694-TomKing062_CVE-2022-38694_unlock_bootloader.md](../2022/CVE-2022-38694-TomKing062_CVE-2022-38694_unlock_bootloader.md)

## CVE-2022-38694-Unisoc BootROM Bootloader Unlock

**漏洞编号:** CVE-2022-38694

**漏洞类型:** BootROM漏洞

**影响应用:** Unisoc SoC

**危害等级:** 高危，可完全控制设备

**影响版本:** 受影响的Unisoc设备

**利用条件:** 需要物理访问设备和USB连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据搜索结果，CVE-2022-38694是一个Unisoc BootROM漏洞，允许未授权解锁Bootloader。攻击者可以通过物理访问设备，利用此漏洞覆盖BootROM数据段中的函数指针或返回地址，从而实现代码执行。漏洞利用代码 `chsize.c` 和 `gen_fdl1-dl.c` 用于调整或生成特定格式的固件文件，这可能与利用此漏洞有关。`chsize.c`修改sprd trusted firmware文件大小，`gen_fdl1-dl.c`代码功能类似，结合搜索结果判断为辅助漏洞利用的工具，用于准备漏洞利用所需的固件镜像。投毒风险较低，因为代码主要操作固件文件，没有发现明显的恶意代码或后门，但是作者具有加入投毒代码的可能性。漏洞利用方式包括：1. 物理访问目标设备。2. 使用`gen_fdl1-dl.c`或者其他工具生成修改过的FDL1下载文件。3. 利用BootROM漏洞（如CVE-2022-38693中描述的缓冲区溢出）将恶意代码注入到设备中。4. 覆盖BootROM中的关键指针或返回地址，以执行恶意代码，最终解锁Bootloader或执行任意代码。

**项目地址:** [TomKing062/CVE-2022-38694_unlock_bootloader](https://github.com/TomKing062/CVE-2022-38694_unlock_bootloader)

**漏洞详情:** [CVE-2022-38694](https://nvd.nist.gov/vuln/detail/CVE-2022-38694)

---



---

## POC #2

**来源**: [CVE-2022-38694-TheGammaSqueeze_Bootloader_Unlock_Anbernic_T820.md](../2022/CVE-2022-38694-TheGammaSqueeze_Bootloader_Unlock_Anbernic_T820.md)

## CVE-2022-38694 - Unisoc BootROM 漏洞

**漏洞编号:** CVE-2022-38694

**漏洞类型:** BootROM漏洞，Bootloader解锁

**影响应用:** Unisoc SoC

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** 受影响的Unisoc设备BootROM版本

**利用条件:** 需要物理访问设备，安装Unisoc USB驱动

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-38694是一个Unisoc SoC的BootROM漏洞，允许攻击者未经授权解锁Bootloader。根据搜索结果和提供的漏洞利用代码（unlock.bat脚本），利用方式如下：

1.  **漏洞利用方式：**
    *   攻击者需要物理访问目标设备。
    *   安装Unisoc USB驱动，以便计算机能够与设备通信。
    *   设备关机状态下，运行`unlock.bat`脚本。
    *   在脚本运行的30秒内，按住设备的HOME/BACK键并连接USB数据线。
    *   脚本将利用BootROM漏洞覆盖函数指针或返回地址，从而解锁Bootloader。
    *   设备重启后，会提示擦除数据，执行擦除操作即可完成解锁。

2.  **有效性：**
    *   根据搜索结果，尤其是GitHub链接，以及漏洞利用代码中的描述，该POC代码是有效的，可以用来解锁受影响的Unisoc设备的Bootloader。

3.  **投毒风险：**
    *   分析`README.md`和脚本内容，主要风险点在于下载链接和第三方驱动程序。
    *   驱动程序和解锁工具本身可能被篡改，包含恶意代码。即使是原作者也可能存在恶意。
    *   虽然代码参考了`TomKing062/CVE-2022-38694_unlock_bootloader`，但经过修改，增加了潜在的投毒风险。
    *   链接引导用户下载固件，链接可能为钓鱼链接，引导用户下载恶意固件。
    *   `unlock.bat`脚本需要仔细检查，以确认其只执行解锁Bootloader的必要操作，没有执行其他恶意行为。
    *   综合判断，投毒风险存在，评估为10%。主要基于该仓库的代码是针对特定设备修改过的，可能包含后门或恶意代码。
    *   此处的投毒风险主要指该仓库作者在解锁脚本或固件链接中加入恶意代码的可能性，而非POC验证的后门代码。

**项目地址:** [TheGammaSqueeze/Bootloader_Unlock_Anbernic_T820](https://github.com/TheGammaSqueeze/Bootloader_Unlock_Anbernic_T820)

**漏洞详情:** [CVE-2022-38694](https://nvd.nist.gov/vuln/detail/CVE-2022-38694)

---

## POC #3

**来源**: [CVE-2022-38694-TomKing062_CVE-2022-38694_unlock_bootloader.md](../2022/CVE-2022-38694-TomKing062_CVE-2022-38694_unlock_bootloader.md)

## CVE-2022-38694-Unisoc BootROM Bootloader Unlock

**漏洞编号:** CVE-2022-38694

**漏洞类型:** BootROM漏洞

**影响应用:** Unisoc SoC

**危害等级:** 高危，可完全控制设备

**影响版本:** 受影响的Unisoc设备

**利用条件:** 需要物理访问设备和USB连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据搜索结果，CVE-2022-38694是一个Unisoc BootROM漏洞，允许未授权解锁Bootloader。攻击者可以通过物理访问设备，利用此漏洞覆盖BootROM数据段中的函数指针或返回地址，从而实现代码执行。漏洞利用代码 `chsize.c` 和 `gen_fdl1-dl.c` 用于调整或生成特定格式的固件文件，这可能与利用此漏洞有关。`chsize.c`修改sprd trusted firmware文件大小，`gen_fdl1-dl.c`代码功能类似，结合搜索结果判断为辅助漏洞利用的工具，用于准备漏洞利用所需的固件镜像。投毒风险较低，因为代码主要操作固件文件，没有发现明显的恶意代码或后门，但是作者具有加入投毒代码的可能性。漏洞利用方式包括：1. 物理访问目标设备。2. 使用`gen_fdl1-dl.c`或者其他工具生成修改过的FDL1下载文件。3. 利用BootROM漏洞（如CVE-2022-38693中描述的缓冲区溢出）将恶意代码注入到设备中。4. 覆盖BootROM中的关键指针或返回地址，以执行恶意代码，最终解锁Bootloader或执行任意代码。

**项目地址:** [TomKing062/CVE-2022-38694_unlock_bootloader](https://github.com/TomKing062/CVE-2022-38694_unlock_bootloader)

**漏洞详情:** [CVE-2022-38694](https://nvd.nist.gov/vuln/detail/CVE-2022-38694)

---

