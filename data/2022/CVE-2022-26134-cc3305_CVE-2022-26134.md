## CVE-2022-26134 - Atlassian Confluence OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 所有受影响的版本在披露时均未修复。修复版本为：7.4.17, 7.13.7, 7.14.3, 7.15.2, 7.16.0, 7.17.0, 7.18.0。

**利用条件:** 无需身份验证，可通过网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134是Atlassian Confluence Server和Data Center中的一个OGNL注入漏洞。攻击者可以通过发送特制的HTTP请求，在目标系统上执行任意代码。该漏洞的严重性评级为严重，CVSS评分为9.8，因为它允许未经身份验证的远程攻击者完全控制受影响的系统。根据nvd.nist.gov的信息，该漏洞首次发布于2022年6月3日，并在2025年2月9日进行了最后一次修改。

POC有效性分析：提供的Python脚本是一个完整的漏洞利用程序，可以用来检测目标系统是否存在CVE-2022-26134漏洞，并在成功利用后执行任意命令。脚本通过发送包含恶意OGNL表达式的HTTP请求，利用Confluence服务器中的OGNL注入漏洞。脚本包含了参数解析、HTTP请求构造、漏洞检测和命令执行等功能。该脚本使用了requests库发送HTTP请求，urllib3库禁用SSL警告，argparse库解析命令行参数。脚本的质量很高，代码清晰，易于理解和使用。

利用步骤：
1.  安装Python 3环境和requests库。
2.  下载或复制提供的Python脚本。
3.  运行脚本，指定目标URL和要执行的命令。例如：python CVE-2022-26134.py http://target.com -C "whoami"
4.  如果目标系统存在漏洞，脚本将执行指定的命令，并将结果输出到控制台。

投毒风险分析：
该POC脚本的投毒风险较低，因为其主要功能是利用已知的漏洞执行命令，而没有明显的恶意行为。脚本中使用了标准Python库，没有调用未知的外部脚本或服务。但是，任何能够执行任意代码的漏洞利用程序都存在一定的风险，因为攻击者可能会修改脚本以执行恶意操作。例如，攻击者可以修改脚本以下载和执行恶意软件，或者窃取敏感数据。因此，在使用该脚本时，应谨慎操作，并确保从可信的来源获取脚本。

该脚本使用argparse处理命令行参数，使得URL，command，headers，cookie等参数容易被篡改。虽然代码本身没有明显恶意行为，但运行任意命令的能力本身就存在高风险。在实际环境中，需要对运行该脚本的环境进行严格的安全控制，以防止脚本被恶意使用。脚本中对请求头和cookie的处理也存在一定的风险，如果攻击者能够控制这些参数，可能会利用这些参数进行恶意操作。综上所述，该POC脚本的投毒风险较低，但仍然需要谨慎使用。

**项目地址:** https://github.com/topics/cve-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
