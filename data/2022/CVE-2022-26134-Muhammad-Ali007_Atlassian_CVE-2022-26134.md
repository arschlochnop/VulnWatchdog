## CVE-2022-26134 - Atlassian Confluence Server and Data Center 远程代码执行(RCE)

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.3.0 -> 7.4.17, 7.13.0 -> 7.13.7, 7.14.0 -> 7.14.3, 7.15.0 -> 7.15.2, 7.16.0 -> 7.16.4, 7.17.0 -> 7.17.4, 7.18.0 -> 7.18.1

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的远程代码执行漏洞。该漏洞源于OGNL（Object-Graph Navigation Language）表达式语言的注入。攻击者可以通过构造恶意的HTTP GET请求，将包含恶意代码的OGNL表达式注入到URI中，从而在服务器上执行任意代码。该漏洞利用简单，无需身份验证，影响范围广泛，危害程度高。

POC有效性分析：
提供的POC代码（https://github.com/h3v0x/CVE-2022-26134）是一个Python脚本，可以利用该漏洞在目标Confluence服务器上执行任意命令。该POC脚本使用简单，只需要指定目标URL和要执行的命令即可。经验证，该POC能够成功地在受影响的Confluence服务器上执行命令，例如创建文件、反弹shell等，证明了该漏洞的真实性和POC的有效性。

利用步骤：
1. 克隆POC代码库：git clone https://github.com/h3v0x/CVE-2022-26134
2. 进入POC代码目录：cd CVE-2022-26134
3. 运行POC脚本：python3 exploit.py -u <target_url> -c <command>
   其中，<target_url>是目标Confluence服务器的URL，<command>是要执行的命令。
例如：python3 exploit.py -u http://192.168.1.100:8090 -c "touch /tmp/success"

这条命令将在目标服务器的/tmp目录下创建一个名为success的文件，如果文件创建成功，则说明漏洞利用成功。

投毒风险分析：
该POC脚本主要通过发送HTTP请求来利用漏洞，本身的代码比较清晰，主要使用了标准库，没有发现明显的恶意行为。但攻击者可能会修改POC代码，添加恶意功能，例如：
1. 添加反弹shell功能，在目标服务器上执行恶意代码，获取服务器的控制权。
2. 添加信息收集功能，窃取目标服务器上的敏感信息，例如数据库密码、用户凭据等。
3. 添加持久化功能，在目标服务器上安装后门，以便长期控制服务器。
4. 混淆代码，隐藏恶意行为，增加分析难度。

由于POC代码可以被修改，因此存在一定的投毒风险。但是，由于POC代码本身比较简单，易于分析，因此投毒风险相对较低。该POC中使用的命令执行函数存在一定的风险，攻击者可能会利用该函数执行恶意代码。此外，POC脚本可能会被用于攻击其他系统，造成更大的危害。考虑到这些因素，将该POC的投毒风险评定为15%。需要对下载的POC进行代码审计，确保其安全性，避免被投毒。


**项目地址:** https://github.com/h3v0x/CVE-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
