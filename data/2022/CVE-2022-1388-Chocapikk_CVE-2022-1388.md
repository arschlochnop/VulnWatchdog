# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **26** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-Chocapikk_CVE-2022-1388.md](../2022/CVE-2022-1388-Chocapikk_CVE-2022-1388.md)

# CVE-2022-1388

> 📦 该CVE有 **25** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-1388-0xf4n9x_CVE-2022-1388.md](../2022/CVE-2022-1388-0xf4n9x_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #2

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #3

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---



---

## POC #3

**来源**: [CVE-2022-1388-EvilLizard666_CVE-2022-1388.md](../2022/CVE-2022-1388-EvilLizard666_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #4

**来源**: [CVE-2022-1388-Henry4E36_CVE-2022-1388.md](../2022/CVE-2022-1388-Henry4E36_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #5

**来源**: [CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md](../2022/CVE-2022-1388-Luchoane_CVE-2022-1388_refresh.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #6

**来源**: [CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md](../2022/CVE-2022-1388-M4fiaB0y_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高，未经授权的远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, < 16.1.2.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。漏洞位于iControl REST API，攻击者可以发送特制的HTTP请求，从而绕过身份验证检查，进而可以执行任意命令，创建/删除文件，禁用服务等，完全控制受影响的系统。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的PoC代码，可以确认该漏洞的有效性。搜索引擎结果中多个链接表明该漏洞已被广泛利用，CISA 也发布了相关的安全公告。提供的PoC代码是一个扫描器，它通过检测目标IP的`/mgmt/shared/authn/login`路径下的响应来判断是否存在漏洞。虽然提供的代码只是一个扫描器，但它验证了未经身份验证即可访问该路径的事实，为进一步的利用（例如执行任意命令）奠定了基础。

**投毒风险分析：**
提供的PoC代码主要包含以下几个部分：
1.  `F5_BigIP_Scanner.py`:  用于扫描指定IP范围内是否存在CVE-2022-1388漏洞的Python脚本。它发送一个GET请求到目标系统的`/mgmt/shared/authn/login`路径，并检查响应中是否包含`resterrorresponse`字符串。
2.  `README.md`:  包含关于该扫描器的简单描述。
代码中没有发现任何可疑的恶意代码或者后门，例如执行恶意操作、回连外部服务器等。 因此，投毒风险较低，评估为 0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送特制的HTTP请求到iControl REST API，绕过身份验证。
2.  **远程代码执行：** 成功绕过身份验证后，攻击者可以利用API执行任意命令。
3.  **完全控制：** 攻击者可以利用远程代码执行能力来完全控制受影响的 F5 BIG-IP 设备，包括读取敏感数据、修改系统配置、安装恶意软件等。

**项目地址:** [M4fiaB0y/CVE-2022-1388](https://github.com/M4fiaB0y/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #7

**来源**: [CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md](../2022/CVE-2022-1388-On-Cyber-War_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #8

**来源**: [CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md](../2022/CVE-2022-1388-PsychoSec2_CVE-2022-1388-POC.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统存在漏洞版本，并且可以通过网络访问其iControl REST接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST 的身份验证，从而执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性很高**。漏洞库信息将其评级为“严重”，CVSS v3.1 评分为 9.8，并且CISA的已知被利用漏洞目录中包含此漏洞，表明该漏洞已被广泛利用。

提供的 Python 漏洞利用代码 `CVE-2022-1388.py` 针对此漏洞。 该代码通过发送特制的 HTTP 请求绕过身份验证，然后执行任意命令。搜索引擎结果也确认了该漏洞的存在和利用。

**投毒风险分析：**

代码本身看起来是一个直接的漏洞利用程序，根据快速审查，直接植入后门的可能性较小。 然而，重要的是要注意到以下几点：

*   **依赖关系：** 代码依赖于 `requests` 库。 虽然 `requests` 本身是安全的，但是需要检查是否存在对 `requirements.txt` 或者类似文件的恶意修改，以从恶意源安装了篡改过的 `requests` 版本。 在提供的代码中，没有发现requirements.txt文件
*   **远程服务器通信：** 代码会与目标 F5 BIG-IP 设备进行通信。 如果目标系统受到攻击，代码可能会被修改以将信息发送到攻击者控制的服务器。 但此风险不在本存储库中。
*   **作者信誉：** 漏洞利用作者的信誉未知。 虽然代码可能看起来无害，但始终存在作者在代码中包含隐藏的恶意功能的可能性。

综合考虑这些因素，**投毒风险较低，约 5%**。 但是，用户应始终谨慎并仔细审查来自不受信任来源的代码。

**漏洞利用方式：**

1.  **未经身份验证的访问：** 漏洞利用的关键在于绕过 iControl REST API 的身份验证。 这可以通过设置特定的HTTP头部来实现，例如 `Host: 127.0.0.1`，`X-F5-Auth-Token: asdf` 以及 `Connection: X-F5-Auth-Token`，以及一个带有任意密码的认证头 `Authorization: Basic YWRtaW46aG9yaXpvbjM=`。 这些头部的组合会导致身份验证机制失效，从而允许未经身份验证的请求。
2.  **命令执行：** 绕过身份验证后，漏洞利用代码使用 `/mgmt/tm/util/bash` 端点执行任意 bash 命令。  它构造一个包含要执行的命令的 JSON payload，并将其发送到此端点。
3.  **交互式 Shell：** 提供的漏洞利用代码包含一个交互式 shell 选项 (`-s`)，允许攻击者在目标系统上执行连续的命令。  这使得攻击者能够完全控制受影响的 F5 BIG-IP 设备。

**项目地址:** [PsychoSec2/CVE-2022-1388-POC](https://github.com/PsychoSec2/CVE-2022-1388-POC)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #9

**来源**: [CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md](../2022/CVE-2022-1388-Vulnmachines_F5-Big-IP-CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #10

**来源**: [CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md](../2022/CVE-2022-1388-XiaomingX_cve-2022-1388-poc.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 和 11.6.x (<= 11.6.5)

**利用条件:** 需要网络可达，目标系统运行受影响的F5 BIG-IP版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是一个存在于F5 BIG-IP中的iControl REST身份验证绕过漏洞。未授权的攻击者可以利用此漏洞绕过身份验证，从而执行任意命令。 

**有效性：** 漏洞利用代码通过发送特制的HTTP POST请求到`/mgmt/tm/util/bash`端点，利用了iControl REST API的身份验证绕过漏洞，未经授权即可执行命令。

**投毒风险：** 提供的Python脚本本身看起来比较直接，目标是利用漏洞，并没有明显的恶意代码。但任何公开可用的漏洞利用代码都可能被修改并重新分发，因此存在极低的投毒风险，这里评估为1%。 风险主要在于用户下载后，未能仔细审查代码，直接使用来自不可信来源的代码。

**利用方式：**
1.  脚本通过`requests`库发送POST请求到目标BIG-IP系统的`/mgmt/tm/util/bash`端点。
2.  构造包含`X-F5-Auth-Token`和`Authorization`头部信息的HTTP请求，其中`X-F5-Auth-Token`被设置为`CVE-2022-1388 Exploit`绕过认证，`Authorization` 头部是默认的base64编码的"admin:vaekwlf", 该头部不是必需的。
3.  在请求体中，通过`command`参数指定`run`，并通过`utilCmdArgs`参数传递要执行的命令。 例如执行反弹shell命令
4.  如果目标存在漏洞，系统将执行`utilCmdArgs`中指定的命令，并将结果返回在`commandResult`字段中 (如果不是反弹shell)。

**缓解措施：**
*   升级到F5 BIG-IP的修复版本。
*   实施网络分段，限制对iControl REST API的访问。
*   监控系统日志，检测潜在的攻击活动。

**项目地址:** [XiaomingX/cve-2022-1388-poc](https://github.com/XiaomingX/cve-2022-1388-poc)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #11

**来源**: [CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md](../2022/CVE-2022-1388-ZephrFish_F5-CVE-2022-1388-Exploit.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #12

**来源**: [CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md](../2022/CVE-2022-1388-Zeyad-Azima_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过, 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且可通过网络访问 iControl REST API (通常为 443 端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个关键漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的 POC 代码（Java 编写）实现了漏洞利用。该POC包含以下功能：

*   **目标扫描:** 扫描单个或多个目标来检测漏洞。
*   **漏洞利用:** 通过发送特制的 HTTP 请求绕过身份验证，并在目标系统上执行任意 shell 命令，从而获得远程 shell 访问权限。

**利用方式:**

1.  攻击者发送包含特定标头的 HTTP POST 请求到 iControl REST API 端点（`/mgmt/tm/util/bash`）。这些标头包括 `X-F5-Auth-Token` 和 `Authorization`，它们被设计用于绕过身份验证检查。
2.  请求的主体包含一个 JSON 对象，该对象指定要执行的命令。在该POC中，`command` 设置为 "run" 并且 `utilCmdArgs` 设置为需要执行的命令。利用了 `mgmt/tm/util/bash` 端点来执行命令。
3.  由于身份验证绕过，BIG-IP 系统会执行请求中的命令，并将结果返回给攻击者。

**投毒风险分析:**

分析提供的代码，该仓库主要由Java代码组成, 存在一些风险，但整体的投毒风险较低。风险点在于：

*   **代码编译和执行:** 需要用户手动编译和执行 Java 代码，这本身就存在一定的风险。恶意代码可能在编译或执行过程中被引入。
*   **依赖风险:** 虽然提供的代码没有明确的外部依赖，但用户在使用前需要确保 Java 环境的安全性，防止受到恶意 Java 库的影响。

综合评估，代码投毒的风险较低，约为 5%。风险主要来自使用者本身的环境安全。


**项目地址:** [Zeyad-Azima/CVE-2022-1388](https://github.com/Zeyad-Azima/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #13

**来源**: [CVE-2022-1388-amitlttwo_CVE-2022-1388.md](../2022/CVE-2022-1388-amitlttwo_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #14

**来源**: [CVE-2022-1388-battleofthebots_refresh.md](../2022/CVE-2022-1388-battleofthebots_refresh.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #15

**来源**: [CVE-2022-1388-devengpk_CVE-2022-1388.md](../2022/CVE-2022-1388-devengpk_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过与远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，且可以通过网络访问其iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而执行任意命令。从搜索引擎结果和漏洞库信息来看，这是一个已经被广泛利用的漏洞。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：**
提供的POC代码（exploit.py）看起来是有效的。它通过构造特定的HTTP请求，绕过身份验证，并利用`/mgmt/tm/util/bash`接口执行系统命令。代码中包含检查目标是否漏洞存在的功能（`-v true`）和执行命令的功能（`-a true`）。漏洞利用代码中包含了目标URL，以及需要执行的命令，可以对目标服务器执行远程命令。

**投毒风险：**
仔细审查了`exploit.py`脚本，未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要包含以下几个部分：

*   **参数解析：** 使用`argparse`模块解析命令行参数，包括目标URL、命令等。
*   **HTTP请求构造：** 构造带有特定header的HTTP POST请求，发送到目标URL的`/mgmt/tm/util/bash`接口。
*   **命令执行：** 将要执行的命令嵌入到JSON数据中，通过POST请求发送给目标。
*   **结果处理：** 解析响应结果，并输出命令执行的结果。

虽然未发现明显的恶意代码，但仍然存在一定的风险：

*   **依赖风险：** 脚本依赖于`requests`库。如果该库被篡改，可能引入恶意代码。
*   **命令注入风险：** 如果未对用户输入的命令进行充分的验证和过滤，可能存在命令注入风险，导致执行意外的命令。

综合来看，投毒风险较低，约为5%。 风险主要来源于用户使用不当。

**利用方式：**

1.  **确定目标系统存在漏洞：** 通过版本信息或其他方式，确认目标系统运行着受影响的 F5 BIG-IP 版本。
2.  **构造恶意HTTP请求：** 使用提供的POC代码或其他工具，构造包含要执行命令的HTTP POST请求。
3.  **发送请求：** 将构造好的请求发送到目标系统的`/mgmt/tm/util/bash`接口。
4.  **执行命令：** 由于认证绕过，目标系统会执行请求中的命令。
5.  **获取结果：** 从响应中获取命令执行的结果。

由于漏洞影响严重，建议及时修补受影响的 F5 BIG-IP 系统。

**项目地址:** [devengpk/CVE-2022-1388](https://github.com/devengpk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #16

**来源**: [CVE-2022-1388-forktheplanet_CVE-2022-1388.md](../2022/CVE-2022-1388-forktheplanet_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #17

**来源**: [CVE-2022-1388-gotr00t0day_CVE-2022-1388.md](../2022/CVE-2022-1388-gotr00t0day_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (详见漏洞库信息)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，且可通过网络访问其iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 漏洞是 F5 BIG-IP 设备 iControl REST API 中的一个身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未经授权的操作，包括执行任意命令。 

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断此PoC具有有效性。漏洞库信息和搜索结果都表明这是一个已公开且被积极利用的漏洞。PoC代码通过构造特定的HTTP头部绕过身份验证，并执行命令。

**投毒风险：**

PoC代码主要功能是扫描和验证目标是否存在CVE-2022-1388漏洞。代码首先使用Shodan API 搜索暴露在外的F5 BIG-IP 设备，然后尝试利用漏洞，通过构造恶意请求在目标系统上执行 `id` 命令来验证漏洞是否存在。代码本身功能明确，但可能存在以下投毒风险：

1.  **Shodan API Key 泄露风险：** PoC需要用户提供Shodan API Key，如果使用者不小心将包含API Key的代码或扫描结果泄露，可能导致API Key被滥用。
2.  **扫描行为风险：** 大规模扫描可能引起目标系统的注意，并被视为恶意行为。
3.  **潜在的漏洞利用风险：** 虽然PoC只是执行了`id`命令进行验证，但如果攻击者修改PoC，则可以利用该漏洞执行任意命令，造成严重的安全威胁。

综合考虑，该PoC的投毒风险较低，大约为10%。风险主要集中在使用者的不当使用和潜在的恶意修改。

**利用方式：**

1.  **漏洞定位：** 通过Shodan等搜索引擎，搜索暴露在公网上的F5 BIG-IP设备。
2.  **构造恶意请求：**  向目标设备的iControl REST API发送包含特定Header的POST请求，例如`X-F5-Auth-Token: abc` 和 `Authorization: Basic YWRtaW46`，以及`Content-Type: application/json`。
3.  **命令执行：**  在请求的JSON数据中，指定要执行的命令。例如，`{"command": "run",'utilCmdArgs':"-c id"}` 将执行 `id` 命令。
4.  **获取结果：**  解析响应，获取命令执行的结果。
5.  **远程代码执行：** 成功绕过认证后，可以利用该漏洞执行任意命令，从而实现远程代码执行。

该漏洞的利用依赖于未经身份验证的访问iControl REST API，攻击者通过精心构造的请求，绕过身份验证并执行任意命令。

**项目地址:** [gotr00t0day/CVE-2022-1388](https://github.com/gotr00t0day/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #18

**来源**: [CVE-2022-1388-impost0r_CVE-2022-1388.md](../2022/CVE-2022-1388-impost0r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** BIG-IP 16.1.x (prior to 16.1.2.2), 15.1.x (prior to 15.1.5.1), 14.1.x (prior to 14.1.4.6), 13.1.x (prior to 13.1.5), and all 12.1.x and 11.6.x versions

**利用条件:** 需要网络访问到iControl REST API接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中 iControl REST API 的一个认证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过认证，从而执行未授权的操作，包括远程代码执行。根据搜索结果，该漏洞已经被广泛利用。提供的漏洞利用代码仅包含 GNU GPL 许可协议，不包含任何实际的漏洞利用代码，因此无法直接判断漏洞利用的有效性。但根据漏洞库信息和搜索结果，可以确认漏洞的有效性，并且已被积极利用。漏洞利用方式通常是通过构造特殊的 HTTP 请求头，欺骗 iControl REST API 绕过认证检查。分析提供的license文件，未发现恶意代码，故投毒风险为0%。
利用方式：
1.  攻击者向易受攻击的 F5 BIG-IP 设备的 iControl REST API 发送恶意构造的 HTTP 请求。
2.  恶意请求绕过身份验证机制。
3.  攻击者可以执行未经授权的操作，例如执行命令、创建或删除文件以及禁用服务。

**项目地址:** [impost0r/CVE-2022-1388](https://github.com/impost0r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #19

**来源**: [CVE-2022-1388-j-baines_tippa-my-tongue.md](../2022/CVE-2022-1388-j-baines_tippa-my-tongue.md)

## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #20

**来源**: [CVE-2022-1388-jbharucha05_CVE-2022-1388.md](../2022/CVE-2022-1388-jbharucha05_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #21

**来源**: [CVE-2022-1388-li8u99_CVE-2022-1388.md](../2022/CVE-2022-1388-li8u99_CVE-2022-1388.md)

## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (受影响版本详见漏洞库信息)

**利用条件:** 目标系统存在漏洞且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证机制，从而可以执行任意命令。漏洞利用方式是通过发送特制的 HTTP 请求，其中包含特定的头部，例如 `Host: 127.0.0.1` 和伪造的身份验证头部，从而欺骗服务器进行身份验证。提供的 Python 脚本通过构造包含恶意命令的 JSON 数据包，并将其发送到 `/mgmt/tm/util/bash` 接口，来实现远程代码执行。 投毒风险极低，因为POC代码只利用漏洞执行命令，没有发现恶意代码如反弹shell等。 脚本尝试执行用户指定的命令，因此主要的风险在于用户执行恶意命令的可能性，而不是脚本本身包含后门。

**项目地址:** [li8u99/CVE-2022-1388](https://github.com/li8u99/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #22

**来源**: [CVE-2022-1388-nico989_CVE-2022-1388.md](../2022/CVE-2022-1388-nico989_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP-iControl REST 认证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本，攻击者需要能够访问目标系统的iControl REST API接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个认证绕过漏洞。攻击者可以通过发送特制的 HTTP 请求绕过身份验证，从而执行未授权的操作，例如执行任意命令。提供的 PoC 代码包含一个 bash 脚本 (poc.sh)，该脚本首先扫描目标 IP 以检测其是否暴露了 API 接口，然后尝试利用该漏洞在目标系统上执行命令。脚本通过发送包含特定 header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径来实现远程命令执行。 由于该PoC没有发现任何恶意代码，投毒的可能性是0%。利用方式为：发送带有特定header的POST请求，绕过认证，在/mgmt/tm/util/bash路径执行任意命令。

**项目地址:** [nico989/CVE-2022-1388](https://github.com/nico989/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #23

**来源**: [CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md](../2022/CVE-2022-1388-nvk0x_CVE-2022-1388-exploit.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #24

**来源**: [CVE-2022-1388-r0otk3r_CVE-2022-1388.md](../2022/CVE-2022-1388-r0otk3r_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过，远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，允许未经身份验证的远程攻击者完全控制受影响的系统。

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问目标系统的管理端口或自IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST 接口中的一个关键漏洞。攻击者可以通过发送特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过设置伪造的`X-F5-Auth-Token`和`Authorization`头部来绕过身份验证。它向`/mgmt/tm/util/bash`发送POST请求，执行指定的shell命令。根据漏洞信息和POC描述，以及大量已公开的利用案例，该POC代码是有效的。

**投毒风险：**
查看提供的README.md文件内容，其中只包含漏洞描述、利用方法、缓解措施和免责声明。没有发现任何恶意代码或后门。因此，投毒风险极低。脚本本身的目的就是执行命令，本身就具有一定的风险，但不是投毒。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过在HTTP请求中设置特定的头部字段（`X-F5-Auth-Token`和`Authorization`）来欺骗iControl REST接口，从而绕过身份验证。
2.  **命令执行：** 成功绕过身份验证后，攻击者可以向`/mgmt/tm/util/bash`端点发送POST请求，并在请求体中包含要执行的shell命令。
3.  **远程控制：** 通过执行任意命令，攻击者可以获取对目标系统的完全控制权，包括读取敏感信息、修改系统配置、安装恶意软件等。

**总结：**
CVE-2022-1388是一个高危漏洞，利用简单，影响广泛。由于漏洞利用的简易性和潜在的严重影响，务必及时修补。根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**项目地址:** [r0otk3r/CVE-2022-1388](https://github.com/r0otk3r/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #25

**来源**: [CVE-2022-1388-revanmalang_CVE-2022-1388.md](../2022/CVE-2022-1388-revanmalang_CVE-2022-1388.md)

## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

## POC #26

**来源**: [CVE-2022-1388-vaelwolf_CVE-2022-1388.md](../2022/CVE-2022-1388-vaelwolf_CVE-2022-1388.md)

## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)

---

