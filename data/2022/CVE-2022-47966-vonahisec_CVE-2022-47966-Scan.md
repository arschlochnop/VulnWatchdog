## CVE-2022-47966 - Zoho ManageEngine (包括 ADAudit Plus, ADManager Plus, Endpoint Central, ServiceDesk Plus 等24款产品) 远程代码执行 (RCE)

**漏洞编号:** CVE-2022-47966

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zoho ManageEngine (包括 ADAudit Plus, ADManager Plus, Endpoint Central, ServiceDesk Plus 等24款产品)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 各产品受影响版本不一，通常为2022年10月更新前的版本（如 AdSelfService Plus 6210及以下）

**利用条件:** 受影响产品必须启用了SAML单点登录（SSO），或在某些产品中曾经启用过SAML

**POC 可用性:** 8/10

**POC 类型:** 概念验证/扫描工具

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-47966是一个存在于Apache Santuario第三方库中的关键漏洞，该库用于处理XML签名。由于ManageEngine多款产品在实现SAML SSO时使用了过时的Apache Santuario版本，攻击者可以通过发送伪造的XML签名响应，利用Java反序列化或签名验证绕过实现未经身份验证的远程代码执行。从POC有效性分析来看，提供的代码库（CVE-2022-47966-Scan）主要功能是扫描器，它通过检测目标系统的特定路径、版本号以及SAML配置状态来识别脆弱性。该扫描脚本利用Python的requests库对目标URL发起请求，分析响应头和页面内容。针对不同的ManageEngine产品，它采用了分段的检测逻辑，例如对ADAudit Plus和ADManager Plus有专门的API路径探测。虽然该POC不直接包含Payload注入模块，但它能精准定位开启了SAML的易损实例，是攻击链中的关键前期工具。利用步骤通常包括：1. 确认目标系统版本及是否开启SAML；2. 构造恶意SAML Response，其中包含利用Apache Santuario解析缺陷的XML结构；3. 将该XML通过POST请求发送至目标的Assertion Consumer Service (ACS) 接口；4. 触发后端解析并执行嵌入的恶意代码。该漏洞因涉及面广（24款产品）且无需凭据，在野利用极其活跃。

关于投毒风险分析，该POC代码库（vonahisec/CVE-2022-47966-Scan）目前表现为低风险。经过对脚本源码的审查，其逻辑清晰，主要依赖标准的Python库如requests、argparse和urllib3。代码中未发现混淆处理、Base64加密的恶意Payload或未经授权的外连请求。安装过程依赖简单的requirements.txt，未包含可疑的第三方轮子。然而，安全研究人员在使用此类扫描脚本时仍需保持警惕，因为在GitHub等平台上，常有攻击者发布名为‘CVE-2022-47966-Full-Exploit’的项目，此类项目往往会通过伪装成编译后的二进制文件、混淆的Python字节码或在利用代码中嵌入反弹Shell至攻击者服务器。本项目作为纯Python脚本，风险点主要在于其提供的requirements.txt是否存在‘抢注包（Typosquatting）’风险。当前分析结果显示，该脚本是合法的防御性扫描工具。但在实际防御场景中，建议在隔离环境运行任何下载的POC，并严格监控其网络流向，防止由于POC工具本身的后门导致研究机沦陷。

**项目地址:** [https://github.com/vonahisec/CVE-2022-47966-Scan](https://github.com/vonahisec/CVE-2022-47966-Scan)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2022-47966](https://nvd.nist.gov/vuln/detail/CVE-2022-47966)
