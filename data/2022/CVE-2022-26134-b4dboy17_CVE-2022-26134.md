## CVE-2022-26134 - Atlassian Confluence Server and Data Center OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危

**CVSS评分:** 10

**影响版本:** 1.3.0 <= version <= 7.18.0

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2022-26134是Atlassian Confluence Server和Data Center产品中存在的OGNL注入漏洞。该漏洞允许未经身份验证的攻击者在Confluence Server或Data Center实例上执行任意代码。根据POC代码，该漏洞影响Confluence Server和Data Center的多个版本，包括1.3.0到7.18.0之间的所有版本。Atlassian已发布了包含此问题补丁的版本，包括7.4.17、7.13.7、7.14.3、7.15.2、7.16.4、7.17.4和7.18.1。

POC的有效性分析：提供的Python脚本（cve-2022-26134.py）展示了如何利用此漏洞。它允许攻击者通过发送特制的HTTP请求来执行任意命令。利用步骤如下：
1. 克隆包含PoC代码的GitHub仓库。
2. 安装所需的Python依赖项（requirements.txt）。
3. 使用脚本，指定目标Confluence服务器的URL，并提供要执行的命令。例如：`python3 cve-2022-26134.py https://target.com id`。
4. 命令的执行结果将通过HTTP响应头中的`X-Cmd-Response`字段返回。

该PoC的质量很高，因为它提供了完整的利用链，包括可执行的Python脚本和详细的使用说明。此外，它还包括一个视频PoC，展示了漏洞的实际利用过程。

漏洞利用步骤：
1. 确定目标Confluence服务器的版本是否在受影响范围内。
2. 部署PoC脚本并配置目标URL。
3. 构造包含恶意OGNL表达式的HTTP请求。
4. 发送请求到目标服务器。
5. 从响应头中提取命令执行结果。

投毒风险分析：该PoC的投毒风险较低。虽然脚本允许执行任意命令，但它本身不包含任何恶意代码或后门。但是，用户在使用该PoC时应谨慎，避免执行未经授权的命令或上传恶意文件。由于该POC主要使用标准库，并且代码相对清晰，因此投毒风险较低，估计在10%左右。风险主要来源于使用者可能会利用此POC进行非授权的渗透测试，或是在渗透测试过程中植入后门，但是POC本身不包含后门。

**项目地址:** https://github.com/Nwqda/CVE-2022-26134

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2022-26134
