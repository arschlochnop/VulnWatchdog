# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-J0hnbX_CVE-2022-30333.md](../2022/CVE-2022-30333-J0hnbX_CVE-2022-30333.md)

# CVE-2022-30333

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #2

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---



---

## POC #2

**来源**: [CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md](../2022/CVE-2022-30333-TheL1ghtVn_CVE-2022-30333-PoC.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #3

**来源**: [CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md](../2022/CVE-2022-30333-aslitsecurity_Zimbra-CVE-2022-30333.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且攻击者可以控制RAR文件的内容

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是一个存在于Linux和UNIX系统上UnRAR 6.12之前版本的目录遍历漏洞。该漏洞允许攻击者在解压（unpack）操作期间写入任意文件，如创建~/.ssh/authorized_keys文件。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高，并且存在一定的投毒风险。

**有效性：**

根据搜索结果，CVE-2022-30333已被CISA添加到已知被利用的漏洞目录中，并且被用于攻击Zimbra等软件。提供的POC代码旨在利用此漏洞在目标系统的特定目录下写入任意文件，通常是Web根目录，以植入JSP webshell。该POC代码通过构造包含目录遍历字符的RAR文件来实现这一点。因此，提供的POC代码在特定条件下是有效的。

**投毒风险：**

代码中存在轻微的投毒风险。具体体现在以下几个方面：

1.  **依赖特定路径：** POC代码假设Zimbra安装在默认路径`/opt/zimbra/jetty_base/webapps/zimbra`下。如果Zimbra安装在其他路径，则利用会失败。虽然这不是恶意行为，但限制了利用范围。
2. **webshell自身风险:**  POC文档中明确说明，需要保证webshell 未被检测。存在植入恶意webshell的风险。

考虑到POC的主要目的是演示漏洞，而非隐藏恶意代码，因此投毒风险较低，大约为5%。

**利用方式：**

1.  **准备恶意RAR文件：** 攻击者首先创建一个包含恶意JSP webshell的目录（如`root_ver`）。
2.  **构造RAR文件：**  攻击者使用提供的Python脚本`CVE-2022-30333_webroot.py`，该脚本修改原始RAR文件，在文件头中插入包含目录遍历序列的字符串，使UnRAR在解压时将webshell写入到目标系统的Web根目录。
3.  **触发解压：** 攻击者诱使用户或系统（如Zimbra服务器）使用存在漏洞的UnRAR版本解压该恶意RAR文件。
4.  **利用webshell：** 一旦webshell被写入Web根目录，攻击者就可以通过Web浏览器访问该webshell，从而执行任意命令。

总而言之，CVE-2022-30333是一个严重的安全漏洞，攻击者可以利用它在目标系统上写入任意文件，从而导致远程代码执行等严重后果。提供的POC代码展示了该漏洞的利用方法，虽然存在轻微的限制，但总体而言是有效的。由于漏洞利用的简易性，建议受影响的用户尽快升级UnRAR到最新版本。

**项目地址:** [aslitsecurity/Zimbra-CVE-2022-30333](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #4

**来源**: [CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md](../2022/CVE-2022-30333-paradox0909_cve-2022-30333_online_rar_extracor.md)

## CVE-2022-30333-UnRAR路径遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 路径遍历

**影响应用:** UnRAR

**危害等级:** 高危，允许攻击者在目标文件系统上写入任意文件，可能导致远程代码执行。

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 需要目标系统运行受影响版本的UnRAR，且攻击者能够控制RAR文件的内容，通常结合其他漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本（Linux和UNIX）中的路径遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件路径，将文件写入到目标文件系统的任意位置，例如，创建`~/.ssh/authorized_keys`文件来实现SSH免密登录。\n\n根据搜索引擎结果，此漏洞已被CISA列入已知被利用漏洞目录中，并且被用于攻击Zimbra等应用。\n\n提供的漏洞利用代码包含一个Ruby脚本(`cve-2022-30333.rb`)，该脚本可以生成包含恶意路径的RAR文件。脚本接收两个参数：目标文件路径和要写入的文件内容。脚本会将文件内容写入到指定的目标路径。\n\n利用方式：\n1.  攻击者构造包含恶意路径的RAR文件。恶意路径指向目标文件系统上的敏感位置。\n2.  诱使用户或系统使用UnRAR解压该RAR文件。\n3.  UnRAR在解压过程中，会将文件写入到恶意路径所指定的位置。\n\n投毒风险分析：\n查看POC代码，发现`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/src/extract.php`文件中使用了`shell_exec`函数，并且拼接了用户上传的文件名，虽然使用了`escapeshellarg`函数进行转义，但是仍然存在一定的风险，例如编码问题或者其他绕过方式，如果利用不当，可能造成命令注入。\n`flag.c`文件中存在`DH{**REMOVE**}\n`，可能为了混淆或者作为示例。\n`/tmp/9d35847d0e3708c158a7a50cc53b0747/501496cd-bc48-4cdf-a628-b6ee60d29be3/<svg onload=alert(document.domain)>.php`存在XSS的风险，同样存在投毒的可能。\n综合来看，该仓库存在一定的投毒风险，主要集中在`extract.php`的命令注入和`<svg onload=alert(document.domain)>.php`的XSS，以及`flag.c`文件的flag可能存在误导性。\n\n有效性：\n根据漏洞描述和提供的POC代码，该漏洞利用是有效的。POC能够生成恶意的RAR文件，并利用UnRAR的路径遍历漏洞将文件写入到指定位置。需要注意的是，该漏洞只影响Linux/UNIX平台上的UnRAR，不影响WinRAR和Android RAR。

**项目地址:** [paradox0909/cve-2022-30333_online_rar_extracor](https://github.com/paradox0909/cve-2022-30333_online_rar_extracor)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #5

**来源**: [CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md](../2022/CVE-2022-30333-rbowes-r7_unrar-cve-2022-30333-poc.md)

## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，可覆盖任意文件，可能导致RCE

**影响版本:** < 6.12

**利用条件:** 需要目标系统安装受影响的UnRAR版本，且允许解压RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30333是UnRAR在Linux和UNIX系统上的一个目录遍历漏洞。该漏洞允许攻击者在解压RAR文件时，通过构造恶意的文件名，将文件写入到文件系统的任意位置。根据漏洞库信息和搜索结果，攻击者可以利用该漏洞创建`~/.ssh/authorized_keys`文件或者在Web服务器的Web目录写入后门文件，从而实现远程代码执行。

**有效性评估：**
根据提供的POC代码和搜索结果，该POC代码是有效的。POC代码通过创建一个恶意的RAR文件，其中包含一个指向目标位置的符号链接和一个包含实际数据的文件。当UnRAR解压这个RAR文件时，会首先创建符号链接，然后将数据写入符号链接指向的位置，从而实现任意文件写入。

**投毒风险评估：**
POC代码本身的主要功能是生成恶意RAR文件以利用目录遍历漏洞，没有明显的恶意或后门代码，风险相对较低。`cve-2022-30333.rb`脚本通过ruby实现生成恶意rar压缩包，该压缩包在解压时会将指定文件写入指定目录，其中`PAYLOAD_SYMLINK`变量是写入文件的目标地址，`PAYLOAD_DATA`变量是要写入的内容。恶意行为依赖于使用者提供的目标文件路径和payload，本身不会主动产生恶意行为。仓库中提供的README.md文件也只是使用msfvenom生成后门，并使用ruby脚本生成恶意的rar文件，没有隐藏投毒代码。因此,投毒风险较低，估计为5%。

**利用方式分析：**
1.  **构造恶意RAR文件：**  使用POC代码（`cve-2022-30333.rb`）生成一个包含恶意符号链接的RAR文件。符号链接指向目标系统上的任意文件路径，攻击者希望覆盖该文件。
2.  **目标文件覆盖：**  当受害者使用存在漏洞的UnRAR版本解压该RAR文件时，UnRAR会跟随符号链接，将RAR文件中包含的数据写入到符号链接指向的目标文件，从而实现任意文件覆盖。
3.  **权限提升或远程代码执行：**  攻击者可以通过覆盖系统关键文件（如`~/.ssh/authorized_keys`）来实现权限提升，或者通过覆盖Web服务器的Web目录中的文件（如JSP文件）来执行任意代码。


**项目地址:** [rbowes-r7/unrar-cve-2022-30333-poc](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

## POC #6

**来源**: [CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md](../2022/CVE-2022-30333-tuaandatt_CVE-2022-30333---UnRAR.md)

## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)

---

