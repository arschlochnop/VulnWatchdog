# CVE-2022-21661

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md](../2022/CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户才能触发，依赖插件或主题以特定方式使用WP_Query

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类中由于不正确的输入清理导致的SQL注入漏洞。漏洞存在于WordPress 5.8.3之前的版本。攻击者需要具备高权限，并且需要精心构造的恶意SQL查询，通过特定的插件或主题才能触发此漏洞。根据漏洞信息，攻击复杂度较高。漏洞利用代码（Dockerfile）主要用于搭建存在漏洞的WordPress环境（5.8.2版本），方便漏洞复现和验证，而非直接的漏洞利用payload。因此，这个Dockerfile本身不构成直接的攻击，而是用于创建一个易受攻击的环境。存在的风险是，如果这个Dockerfile被恶意修改，例如添加后门代码，那么基于这个Dockerfile构建的WordPress实例就会被植入后门。Dockerfile的内容主要是安装和配置WordPress 5.8.2，以及一些PHP扩展和Apache模块。虽然看起来没有明显的恶意代码，但是不能排除在安装过程中或者配置过程中插入恶意代码的可能性。例如，替换WordPress的安装包，或者修改WordPress的核心文件。但是总的来说直接投毒的可能性比较低，因为代码非常规范，而且大部分操作都是标准的安装步骤。考虑到其构建环境的特殊性，恶意代码难以隐藏，因此投毒风险评估为10%。根据搜索引擎结果和漏洞库信息，该漏洞的利用方式主要是通过构造恶意的SQL查询，利用WP_Query中的缺陷执行未授权的数据库操作。虽然漏洞的利用需要高权限用户，但一旦成功，可能导致敏感数据泄露，甚至远程代码执行。

**项目地址:** [0x4E0x650x6F/Wordpress-cve-CVE-2022-21661](https://github.com/0x4E0x650x6F/Wordpress-cve-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #2

**来源**: [CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md](../2022/CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件或主题，且用户具有足够权限（例如，管理员权限，虽然利用并不一定需要管理员权限，但CVSS评分显示需要高权限）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress Core 5.8.3 之前版本中 WP_Query 类中由于不正确的输入验证而产生的 SQL 注入漏洞。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Exploit-DB的页面）和提供的漏洞利用代码，此漏洞是有效的。存在公开的PoC利用代码，并且多个安全厂商和研究人员已经确认并分析了该漏洞。

**投毒风险：**
检查了提供的PoC代码，包括`README.md`、视频目录下的文件和`50663.txt`（包含Exploit），没有发现明显的恶意代码或后门。

*   `README.md`: 主要提供漏洞描述和PoC视频的链接，本身不包含可执行代码。
*   视频目录下的文件:仅包含作者的个人信息和联系方式，没有发现任何恶意代码。
*   `50663.txt`: 包含漏洞利用的详细信息和示例HTTP请求。虽然可以利用它来攻击目标，但它本身不是投毒代码，而是一个合法的漏洞利用脚本。

因此，投毒风险很低，估计为1%。这主要是因为PoC代码本身相对简单，目的是演示漏洞，而非植入后门。

**利用方式：**
利用方式如下：

1.  **漏洞位置:** 漏洞存在于 `WP_Query` 类中，该类用于执行数据库查询。
2.  **攻击向量:** 攻击者可以通过 `admin-ajax.php` 接口，利用 `tax_query` 参数传递恶意的 SQL 代码。
3.  **利用过程:** 通过构造包含恶意 SQL 语句的 `query_vars` 参数发送 POST 请求到 `/wp-admin/admin-ajax.php`。该请求需要 `action` 和 `nonce` 参数。
4.  **影响:** 成功的利用可能允许攻击者执行任意 SQL 查询，从而泄露数据库信息，甚至可能导致远程代码执行。

**总结:**
该漏洞是一个高危 SQL 注入漏洞，存在公开的PoC代码，未经授权的攻击者可以利用它来获取敏感信息或执行恶意代码。建议受影响的用户尽快升级到 WordPress 5.8.3 或更高版本。

**项目地址:** [CharonDefalt/WordPress--CVE-2022-21661](https://github.com/CharonDefalt/WordPress--CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #3

**来源**: [CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md](../2022/CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在漏洞，且攻击者能够通过网络访问该站点的/wp-admin/admin-ajax.php接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类中由于不当的输入清理而导致的 SQL 注入漏洞。该漏洞允许经过身份验证的攻击者 (需要高权限，如管理员)通过构造恶意的 SQL 查询语句来执行任意 SQL 代码。根据漏洞库信息，攻击复杂度高，需要高权限用户，但是搜索引擎结果显示该漏洞影响广泛，可以被利用于未经授权的数据访问，甚至可能远程代码执行。提供的 PoC 代码 (main.py) 使用了两种方式来验证漏洞的存在：

1.  **基于错误的 SQL 注入 (Error-based SQL Injection):** 尝试使用 `extractvalue` 函数和 `concat` 函数来触发 SQL 错误，并将 MD5 哈希值嵌入到错误消息中。如果响应中包含正确的 MD5 哈希值，则表明存在漏洞。
2.  **基于时间的盲注 (Time-based Blind SQL Injection):** 尝试使用 `sleep()` 函数来引入延迟。如果服务器响应时间变长，则表明存在漏洞。

该 PoC 尝试访问 `/wp-admin/admin-ajax.php`，并使用 `action=test` 和包含恶意 SQL 查询的 JSON 数据发送 POST 请求。

**关于有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在可用的 PoC。提供的 PoC 代码尝试通过 SQL 注入来验证漏洞的存在，因此在合适的条件下是有效的。

**关于投毒风险：**

PoC 代码本身包含一个随机数生成和 MD5 哈希加密的过程，这部分代码是为了验证 SQL 注入是否成功，而不是后门或恶意代码。但代码中存在以下潜在的投毒风险：

1.  **依赖项风险：** `requirements.txt` 文件中可能会包含恶意或过时的依赖项，这些依赖项可能会引入安全漏洞。
2.  **代码修改：** 下载的 PoC 代码可以被修改，以包含恶意代码。例如，攻击者可以修改 PoC 代码，在成功利用漏洞后，安装后门或执行其他恶意操作。
3.  **随机数的弱点：** `random.randint` 产生的随机数可能不够随机，如果攻击者能够预测随机数，就可以绕过 MD5 验证。
4.  **基于时间的盲注风险：** 基于时间的盲注依赖于服务器的响应时间，如果服务器负载过高或网络延迟不稳定，可能会导致误报。

综合考虑，该仓库存在一定投毒风险，约为10%，主要风险在于使用者在使用脚本时未检查脚本内容，直接运行导致被投毒。

**关于利用方式：**

1.  确定目标 WordPress 站点版本低于 5.8.3。
2.  确保目标站点启用了 `admin-ajax.php` 接口。
3.  运行 PoC 代码，并提供目标站点的 URL。
4.  PoC 代码将尝试通过 SQL 注入来验证漏洞的存在。
5.  如果漏洞存在，攻击者可以构造恶意的 SQL 查询语句来执行任意 SQL 代码，从而获取敏感数据、修改数据库内容，甚至执行远程代码。

**项目地址:** [Fauzan-Aldi/CVE-2022-21661](https://github.com/Fauzan-Aldi/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #4

**来源**: [CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md](../2022/CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md)

## CVE-2022-21661-WordPress-WP_Query-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器控制

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点使用受影响的版本，并允许未授权用户访问admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类由于不正确的输入验证导致的SQL注入漏洞。攻击者可以通过向wp-admin/admin-ajax.php发送包含恶意SQL语句的POST请求，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC代码显示了构造恶意请求的payload，攻击者可以将SQL注入语句放在`<inject>`的位置。搜索引擎结果中的链接表明该漏洞可以被利用来执行任意SQL查询，从而泄露数据库信息。尽管PoC相对简单，但仍然存在一定程度的投毒风险，因为攻击者可能在利用过程中引入额外的恶意代码或模块，例如用于持久化控制、隐藏攻击行为等。PoC中使用的参数是标准WordPress功能的一部分，但恶意构造的`query_vars`参数导致了SQL注入。PoC的有效性较高，因为多个来源都确认了该漏洞的存在，并提供了利用示例。

关于投毒风险的评估：PoC代码本身看起来比较直接，主要是演示如何构造恶意请求。但是，在实际利用过程中，攻击者可能会修改PoC代码，例如添加收集目标系统信息的代码、尝试执行其他恶意操作的代码、或者使用更隐蔽的注入方式。因此，不能完全排除投毒风险。这里给出10%的投毒风险是考虑了实际攻击场景中可能存在的变数。

**项目地址:** [TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection](https://github.com/TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #5

**来源**: [CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md](../2022/CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md)

# CVE-2022-21661

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md](../2022/CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户才能触发，依赖插件或主题以特定方式使用WP_Query

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类中由于不正确的输入清理导致的SQL注入漏洞。漏洞存在于WordPress 5.8.3之前的版本。攻击者需要具备高权限，并且需要精心构造的恶意SQL查询，通过特定的插件或主题才能触发此漏洞。根据漏洞信息，攻击复杂度较高。漏洞利用代码（Dockerfile）主要用于搭建存在漏洞的WordPress环境（5.8.2版本），方便漏洞复现和验证，而非直接的漏洞利用payload。因此，这个Dockerfile本身不构成直接的攻击，而是用于创建一个易受攻击的环境。存在的风险是，如果这个Dockerfile被恶意修改，例如添加后门代码，那么基于这个Dockerfile构建的WordPress实例就会被植入后门。Dockerfile的内容主要是安装和配置WordPress 5.8.2，以及一些PHP扩展和Apache模块。虽然看起来没有明显的恶意代码，但是不能排除在安装过程中或者配置过程中插入恶意代码的可能性。例如，替换WordPress的安装包，或者修改WordPress的核心文件。但是总的来说直接投毒的可能性比较低，因为代码非常规范，而且大部分操作都是标准的安装步骤。考虑到其构建环境的特殊性，恶意代码难以隐藏，因此投毒风险评估为10%。根据搜索引擎结果和漏洞库信息，该漏洞的利用方式主要是通过构造恶意的SQL查询，利用WP_Query中的缺陷执行未授权的数据库操作。虽然漏洞的利用需要高权限用户，但一旦成功，可能导致敏感数据泄露，甚至远程代码执行。

**项目地址:** [0x4E0x650x6F/Wordpress-cve-CVE-2022-21661](https://github.com/0x4E0x650x6F/Wordpress-cve-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #2

**来源**: [CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md](../2022/CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件或主题，且用户具有足够权限（例如，管理员权限，虽然利用并不一定需要管理员权限，但CVSS评分显示需要高权限）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress Core 5.8.3 之前版本中 WP_Query 类中由于不正确的输入验证而产生的 SQL 注入漏洞。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Exploit-DB的页面）和提供的漏洞利用代码，此漏洞是有效的。存在公开的PoC利用代码，并且多个安全厂商和研究人员已经确认并分析了该漏洞。

**投毒风险：**
检查了提供的PoC代码，包括`README.md`、视频目录下的文件和`50663.txt`（包含Exploit），没有发现明显的恶意代码或后门。

*   `README.md`: 主要提供漏洞描述和PoC视频的链接，本身不包含可执行代码。
*   视频目录下的文件:仅包含作者的个人信息和联系方式，没有发现任何恶意代码。
*   `50663.txt`: 包含漏洞利用的详细信息和示例HTTP请求。虽然可以利用它来攻击目标，但它本身不是投毒代码，而是一个合法的漏洞利用脚本。

因此，投毒风险很低，估计为1%。这主要是因为PoC代码本身相对简单，目的是演示漏洞，而非植入后门。

**利用方式：**
利用方式如下：

1.  **漏洞位置:** 漏洞存在于 `WP_Query` 类中，该类用于执行数据库查询。
2.  **攻击向量:** 攻击者可以通过 `admin-ajax.php` 接口，利用 `tax_query` 参数传递恶意的 SQL 代码。
3.  **利用过程:** 通过构造包含恶意 SQL 语句的 `query_vars` 参数发送 POST 请求到 `/wp-admin/admin-ajax.php`。该请求需要 `action` 和 `nonce` 参数。
4.  **影响:** 成功的利用可能允许攻击者执行任意 SQL 查询，从而泄露数据库信息，甚至可能导致远程代码执行。

**总结:**
该漏洞是一个高危 SQL 注入漏洞，存在公开的PoC代码，未经授权的攻击者可以利用它来获取敏感信息或执行恶意代码。建议受影响的用户尽快升级到 WordPress 5.8.3 或更高版本。

**项目地址:** [CharonDefalt/WordPress--CVE-2022-21661](https://github.com/CharonDefalt/WordPress--CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #3

**来源**: [CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md](../2022/CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在漏洞，且攻击者能够通过网络访问该站点的/wp-admin/admin-ajax.php接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类中由于不当的输入清理而导致的 SQL 注入漏洞。该漏洞允许经过身份验证的攻击者 (需要高权限，如管理员)通过构造恶意的 SQL 查询语句来执行任意 SQL 代码。根据漏洞库信息，攻击复杂度高，需要高权限用户，但是搜索引擎结果显示该漏洞影响广泛，可以被利用于未经授权的数据访问，甚至可能远程代码执行。提供的 PoC 代码 (main.py) 使用了两种方式来验证漏洞的存在：

1.  **基于错误的 SQL 注入 (Error-based SQL Injection):** 尝试使用 `extractvalue` 函数和 `concat` 函数来触发 SQL 错误，并将 MD5 哈希值嵌入到错误消息中。如果响应中包含正确的 MD5 哈希值，则表明存在漏洞。
2.  **基于时间的盲注 (Time-based Blind SQL Injection):** 尝试使用 `sleep()` 函数来引入延迟。如果服务器响应时间变长，则表明存在漏洞。

该 PoC 尝试访问 `/wp-admin/admin-ajax.php`，并使用 `action=test` 和包含恶意 SQL 查询的 JSON 数据发送 POST 请求。

**关于有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在可用的 PoC。提供的 PoC 代码尝试通过 SQL 注入来验证漏洞的存在，因此在合适的条件下是有效的。

**关于投毒风险：**

PoC 代码本身包含一个随机数生成和 MD5 哈希加密的过程，这部分代码是为了验证 SQL 注入是否成功，而不是后门或恶意代码。但代码中存在以下潜在的投毒风险：

1.  **依赖项风险：** `requirements.txt` 文件中可能会包含恶意或过时的依赖项，这些依赖项可能会引入安全漏洞。
2.  **代码修改：** 下载的 PoC 代码可以被修改，以包含恶意代码。例如，攻击者可以修改 PoC 代码，在成功利用漏洞后，安装后门或执行其他恶意操作。
3.  **随机数的弱点：** `random.randint` 产生的随机数可能不够随机，如果攻击者能够预测随机数，就可以绕过 MD5 验证。
4.  **基于时间的盲注风险：** 基于时间的盲注依赖于服务器的响应时间，如果服务器负载过高或网络延迟不稳定，可能会导致误报。

综合考虑，该仓库存在一定投毒风险，约为10%，主要风险在于使用者在使用脚本时未检查脚本内容，直接运行导致被投毒。

**关于利用方式：**

1.  确定目标 WordPress 站点版本低于 5.8.3。
2.  确保目标站点启用了 `admin-ajax.php` 接口。
3.  运行 PoC 代码，并提供目标站点的 URL。
4.  PoC 代码将尝试通过 SQL 注入来验证漏洞的存在。
5.  如果漏洞存在，攻击者可以构造恶意的 SQL 查询语句来执行任意 SQL 代码，从而获取敏感数据、修改数据库内容，甚至执行远程代码。

**项目地址:** [Fauzan-Aldi/CVE-2022-21661](https://github.com/Fauzan-Aldi/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #4

**来源**: [CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md](../2022/CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md)

## CVE-2022-21661-WordPress-WP_Query-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器控制

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点使用受影响的版本，并允许未授权用户访问admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类由于不正确的输入验证导致的SQL注入漏洞。攻击者可以通过向wp-admin/admin-ajax.php发送包含恶意SQL语句的POST请求，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC代码显示了构造恶意请求的payload，攻击者可以将SQL注入语句放在`<inject>`的位置。搜索引擎结果中的链接表明该漏洞可以被利用来执行任意SQL查询，从而泄露数据库信息。尽管PoC相对简单，但仍然存在一定程度的投毒风险，因为攻击者可能在利用过程中引入额外的恶意代码或模块，例如用于持久化控制、隐藏攻击行为等。PoC中使用的参数是标准WordPress功能的一部分，但恶意构造的`query_vars`参数导致了SQL注入。PoC的有效性较高，因为多个来源都确认了该漏洞的存在，并提供了利用示例。

关于投毒风险的评估：PoC代码本身看起来比较直接，主要是演示如何构造恶意请求。但是，在实际利用过程中，攻击者可能会修改PoC代码，例如添加收集目标系统信息的代码、尝试执行其他恶意操作的代码、或者使用更隐蔽的注入方式。因此，不能完全排除投毒风险。这里给出10%的投毒风险是考虑了实际攻击场景中可能存在的变数。

**项目地址:** [TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection](https://github.com/TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #5

**来源**: [CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md](../2022/CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md)

# CVE-2022-21661

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md](../2022/CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户才能触发，依赖插件或主题以特定方式使用WP_Query

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类中由于不正确的输入清理导致的SQL注入漏洞。漏洞存在于WordPress 5.8.3之前的版本。攻击者需要具备高权限，并且需要精心构造的恶意SQL查询，通过特定的插件或主题才能触发此漏洞。根据漏洞信息，攻击复杂度较高。漏洞利用代码（Dockerfile）主要用于搭建存在漏洞的WordPress环境（5.8.2版本），方便漏洞复现和验证，而非直接的漏洞利用payload。因此，这个Dockerfile本身不构成直接的攻击，而是用于创建一个易受攻击的环境。存在的风险是，如果这个Dockerfile被恶意修改，例如添加后门代码，那么基于这个Dockerfile构建的WordPress实例就会被植入后门。Dockerfile的内容主要是安装和配置WordPress 5.8.2，以及一些PHP扩展和Apache模块。虽然看起来没有明显的恶意代码，但是不能排除在安装过程中或者配置过程中插入恶意代码的可能性。例如，替换WordPress的安装包，或者修改WordPress的核心文件。但是总的来说直接投毒的可能性比较低，因为代码非常规范，而且大部分操作都是标准的安装步骤。考虑到其构建环境的特殊性，恶意代码难以隐藏，因此投毒风险评估为10%。根据搜索引擎结果和漏洞库信息，该漏洞的利用方式主要是通过构造恶意的SQL查询，利用WP_Query中的缺陷执行未授权的数据库操作。虽然漏洞的利用需要高权限用户，但一旦成功，可能导致敏感数据泄露，甚至远程代码执行。

**项目地址:** [0x4E0x650x6F/Wordpress-cve-CVE-2022-21661](https://github.com/0x4E0x650x6F/Wordpress-cve-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #2

**来源**: [CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md](../2022/CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件或主题，且用户具有足够权限（例如，管理员权限，虽然利用并不一定需要管理员权限，但CVSS评分显示需要高权限）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress Core 5.8.3 之前版本中 WP_Query 类中由于不正确的输入验证而产生的 SQL 注入漏洞。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Exploit-DB的页面）和提供的漏洞利用代码，此漏洞是有效的。存在公开的PoC利用代码，并且多个安全厂商和研究人员已经确认并分析了该漏洞。

**投毒风险：**
检查了提供的PoC代码，包括`README.md`、视频目录下的文件和`50663.txt`（包含Exploit），没有发现明显的恶意代码或后门。

*   `README.md`: 主要提供漏洞描述和PoC视频的链接，本身不包含可执行代码。
*   视频目录下的文件:仅包含作者的个人信息和联系方式，没有发现任何恶意代码。
*   `50663.txt`: 包含漏洞利用的详细信息和示例HTTP请求。虽然可以利用它来攻击目标，但它本身不是投毒代码，而是一个合法的漏洞利用脚本。

因此，投毒风险很低，估计为1%。这主要是因为PoC代码本身相对简单，目的是演示漏洞，而非植入后门。

**利用方式：**
利用方式如下：

1.  **漏洞位置:** 漏洞存在于 `WP_Query` 类中，该类用于执行数据库查询。
2.  **攻击向量:** 攻击者可以通过 `admin-ajax.php` 接口，利用 `tax_query` 参数传递恶意的 SQL 代码。
3.  **利用过程:** 通过构造包含恶意 SQL 语句的 `query_vars` 参数发送 POST 请求到 `/wp-admin/admin-ajax.php`。该请求需要 `action` 和 `nonce` 参数。
4.  **影响:** 成功的利用可能允许攻击者执行任意 SQL 查询，从而泄露数据库信息，甚至可能导致远程代码执行。

**总结:**
该漏洞是一个高危 SQL 注入漏洞，存在公开的PoC代码，未经授权的攻击者可以利用它来获取敏感信息或执行恶意代码。建议受影响的用户尽快升级到 WordPress 5.8.3 或更高版本。

**项目地址:** [CharonDefalt/WordPress--CVE-2022-21661](https://github.com/CharonDefalt/WordPress--CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #3

**来源**: [CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md](../2022/CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在漏洞，且攻击者能够通过网络访问该站点的/wp-admin/admin-ajax.php接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类中由于不当的输入清理而导致的 SQL 注入漏洞。该漏洞允许经过身份验证的攻击者 (需要高权限，如管理员)通过构造恶意的 SQL 查询语句来执行任意 SQL 代码。根据漏洞库信息，攻击复杂度高，需要高权限用户，但是搜索引擎结果显示该漏洞影响广泛，可以被利用于未经授权的数据访问，甚至可能远程代码执行。提供的 PoC 代码 (main.py) 使用了两种方式来验证漏洞的存在：

1.  **基于错误的 SQL 注入 (Error-based SQL Injection):** 尝试使用 `extractvalue` 函数和 `concat` 函数来触发 SQL 错误，并将 MD5 哈希值嵌入到错误消息中。如果响应中包含正确的 MD5 哈希值，则表明存在漏洞。
2.  **基于时间的盲注 (Time-based Blind SQL Injection):** 尝试使用 `sleep()` 函数来引入延迟。如果服务器响应时间变长，则表明存在漏洞。

该 PoC 尝试访问 `/wp-admin/admin-ajax.php`，并使用 `action=test` 和包含恶意 SQL 查询的 JSON 数据发送 POST 请求。

**关于有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在可用的 PoC。提供的 PoC 代码尝试通过 SQL 注入来验证漏洞的存在，因此在合适的条件下是有效的。

**关于投毒风险：**

PoC 代码本身包含一个随机数生成和 MD5 哈希加密的过程，这部分代码是为了验证 SQL 注入是否成功，而不是后门或恶意代码。但代码中存在以下潜在的投毒风险：

1.  **依赖项风险：** `requirements.txt` 文件中可能会包含恶意或过时的依赖项，这些依赖项可能会引入安全漏洞。
2.  **代码修改：** 下载的 PoC 代码可以被修改，以包含恶意代码。例如，攻击者可以修改 PoC 代码，在成功利用漏洞后，安装后门或执行其他恶意操作。
3.  **随机数的弱点：** `random.randint` 产生的随机数可能不够随机，如果攻击者能够预测随机数，就可以绕过 MD5 验证。
4.  **基于时间的盲注风险：** 基于时间的盲注依赖于服务器的响应时间，如果服务器负载过高或网络延迟不稳定，可能会导致误报。

综合考虑，该仓库存在一定投毒风险，约为10%，主要风险在于使用者在使用脚本时未检查脚本内容，直接运行导致被投毒。

**关于利用方式：**

1.  确定目标 WordPress 站点版本低于 5.8.3。
2.  确保目标站点启用了 `admin-ajax.php` 接口。
3.  运行 PoC 代码，并提供目标站点的 URL。
4.  PoC 代码将尝试通过 SQL 注入来验证漏洞的存在。
5.  如果漏洞存在，攻击者可以构造恶意的 SQL 查询语句来执行任意 SQL 代码，从而获取敏感数据、修改数据库内容，甚至执行远程代码。

**项目地址:** [Fauzan-Aldi/CVE-2022-21661](https://github.com/Fauzan-Aldi/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #4

**来源**: [CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md](../2022/CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md)

## CVE-2022-21661-WordPress-WP_Query-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器控制

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点使用受影响的版本，并允许未授权用户访问admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类由于不正确的输入验证导致的SQL注入漏洞。攻击者可以通过向wp-admin/admin-ajax.php发送包含恶意SQL语句的POST请求，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC代码显示了构造恶意请求的payload，攻击者可以将SQL注入语句放在`<inject>`的位置。搜索引擎结果中的链接表明该漏洞可以被利用来执行任意SQL查询，从而泄露数据库信息。尽管PoC相对简单，但仍然存在一定程度的投毒风险，因为攻击者可能在利用过程中引入额外的恶意代码或模块，例如用于持久化控制、隐藏攻击行为等。PoC中使用的参数是标准WordPress功能的一部分，但恶意构造的`query_vars`参数导致了SQL注入。PoC的有效性较高，因为多个来源都确认了该漏洞的存在，并提供了利用示例。

关于投毒风险的评估：PoC代码本身看起来比较直接，主要是演示如何构造恶意请求。但是，在实际利用过程中，攻击者可能会修改PoC代码，例如添加收集目标系统信息的代码、尝试执行其他恶意操作的代码、或者使用更隐蔽的注入方式。因此，不能完全排除投毒风险。这里给出10%的投毒风险是考虑了实际攻击场景中可能存在的变数。

**项目地址:** [TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection](https://github.com/TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #5

**来源**: [CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md](../2022/CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md)

# CVE-2022-21661

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md](../2022/CVE-2022-21661-0x4E0x650x6F_Wordpress-cve-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户才能触发，依赖插件或主题以特定方式使用WP_Query

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类中由于不正确的输入清理导致的SQL注入漏洞。漏洞存在于WordPress 5.8.3之前的版本。攻击者需要具备高权限，并且需要精心构造的恶意SQL查询，通过特定的插件或主题才能触发此漏洞。根据漏洞信息，攻击复杂度较高。漏洞利用代码（Dockerfile）主要用于搭建存在漏洞的WordPress环境（5.8.2版本），方便漏洞复现和验证，而非直接的漏洞利用payload。因此，这个Dockerfile本身不构成直接的攻击，而是用于创建一个易受攻击的环境。存在的风险是，如果这个Dockerfile被恶意修改，例如添加后门代码，那么基于这个Dockerfile构建的WordPress实例就会被植入后门。Dockerfile的内容主要是安装和配置WordPress 5.8.2，以及一些PHP扩展和Apache模块。虽然看起来没有明显的恶意代码，但是不能排除在安装过程中或者配置过程中插入恶意代码的可能性。例如，替换WordPress的安装包，或者修改WordPress的核心文件。但是总的来说直接投毒的可能性比较低，因为代码非常规范，而且大部分操作都是标准的安装步骤。考虑到其构建环境的特殊性，恶意代码难以隐藏，因此投毒风险评估为10%。根据搜索引擎结果和漏洞库信息，该漏洞的利用方式主要是通过构造恶意的SQL查询，利用WP_Query中的缺陷执行未授权的数据库操作。虽然漏洞的利用需要高权限用户，但一旦成功，可能导致敏感数据泄露，甚至远程代码执行。

**项目地址:** [0x4E0x650x6F/Wordpress-cve-CVE-2022-21661](https://github.com/0x4E0x650x6F/Wordpress-cve-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #2

**来源**: [CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md](../2022/CVE-2022-21661-CharonDefalt_WordPress--CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件或主题，且用户具有足够权限（例如，管理员权限，虽然利用并不一定需要管理员权限，但CVSS评分显示需要高权限）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress Core 5.8.3 之前版本中 WP_Query 类中由于不正确的输入验证而产生的 SQL 注入漏洞。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Exploit-DB的页面）和提供的漏洞利用代码，此漏洞是有效的。存在公开的PoC利用代码，并且多个安全厂商和研究人员已经确认并分析了该漏洞。

**投毒风险：**
检查了提供的PoC代码，包括`README.md`、视频目录下的文件和`50663.txt`（包含Exploit），没有发现明显的恶意代码或后门。

*   `README.md`: 主要提供漏洞描述和PoC视频的链接，本身不包含可执行代码。
*   视频目录下的文件:仅包含作者的个人信息和联系方式，没有发现任何恶意代码。
*   `50663.txt`: 包含漏洞利用的详细信息和示例HTTP请求。虽然可以利用它来攻击目标，但它本身不是投毒代码，而是一个合法的漏洞利用脚本。

因此，投毒风险很低，估计为1%。这主要是因为PoC代码本身相对简单，目的是演示漏洞，而非植入后门。

**利用方式：**
利用方式如下：

1.  **漏洞位置:** 漏洞存在于 `WP_Query` 类中，该类用于执行数据库查询。
2.  **攻击向量:** 攻击者可以通过 `admin-ajax.php` 接口，利用 `tax_query` 参数传递恶意的 SQL 代码。
3.  **利用过程:** 通过构造包含恶意 SQL 语句的 `query_vars` 参数发送 POST 请求到 `/wp-admin/admin-ajax.php`。该请求需要 `action` 和 `nonce` 参数。
4.  **影响:** 成功的利用可能允许攻击者执行任意 SQL 查询，从而泄露数据库信息，甚至可能导致远程代码执行。

**总结:**
该漏洞是一个高危 SQL 注入漏洞，存在公开的PoC代码，未经授权的攻击者可以利用它来获取敏感信息或执行恶意代码。建议受影响的用户尽快升级到 WordPress 5.8.3 或更高版本。

**项目地址:** [CharonDefalt/WordPress--CVE-2022-21661](https://github.com/CharonDefalt/WordPress--CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #3

**来源**: [CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md](../2022/CVE-2022-21661-Fauzan-Aldi_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在漏洞，且攻击者能够通过网络访问该站点的/wp-admin/admin-ajax.php接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类中由于不当的输入清理而导致的 SQL 注入漏洞。该漏洞允许经过身份验证的攻击者 (需要高权限，如管理员)通过构造恶意的 SQL 查询语句来执行任意 SQL 代码。根据漏洞库信息，攻击复杂度高，需要高权限用户，但是搜索引擎结果显示该漏洞影响广泛，可以被利用于未经授权的数据访问，甚至可能远程代码执行。提供的 PoC 代码 (main.py) 使用了两种方式来验证漏洞的存在：

1.  **基于错误的 SQL 注入 (Error-based SQL Injection):** 尝试使用 `extractvalue` 函数和 `concat` 函数来触发 SQL 错误，并将 MD5 哈希值嵌入到错误消息中。如果响应中包含正确的 MD5 哈希值，则表明存在漏洞。
2.  **基于时间的盲注 (Time-based Blind SQL Injection):** 尝试使用 `sleep()` 函数来引入延迟。如果服务器响应时间变长，则表明存在漏洞。

该 PoC 尝试访问 `/wp-admin/admin-ajax.php`，并使用 `action=test` 和包含恶意 SQL 查询的 JSON 数据发送 POST 请求。

**关于有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在可用的 PoC。提供的 PoC 代码尝试通过 SQL 注入来验证漏洞的存在，因此在合适的条件下是有效的。

**关于投毒风险：**

PoC 代码本身包含一个随机数生成和 MD5 哈希加密的过程，这部分代码是为了验证 SQL 注入是否成功，而不是后门或恶意代码。但代码中存在以下潜在的投毒风险：

1.  **依赖项风险：** `requirements.txt` 文件中可能会包含恶意或过时的依赖项，这些依赖项可能会引入安全漏洞。
2.  **代码修改：** 下载的 PoC 代码可以被修改，以包含恶意代码。例如，攻击者可以修改 PoC 代码，在成功利用漏洞后，安装后门或执行其他恶意操作。
3.  **随机数的弱点：** `random.randint` 产生的随机数可能不够随机，如果攻击者能够预测随机数，就可以绕过 MD5 验证。
4.  **基于时间的盲注风险：** 基于时间的盲注依赖于服务器的响应时间，如果服务器负载过高或网络延迟不稳定，可能会导致误报。

综合考虑，该仓库存在一定投毒风险，约为10%，主要风险在于使用者在使用脚本时未检查脚本内容，直接运行导致被投毒。

**关于利用方式：**

1.  确定目标 WordPress 站点版本低于 5.8.3。
2.  确保目标站点启用了 `admin-ajax.php` 接口。
3.  运行 PoC 代码，并提供目标站点的 URL。
4.  PoC 代码将尝试通过 SQL 注入来验证漏洞的存在。
5.  如果漏洞存在，攻击者可以构造恶意的 SQL 查询语句来执行任意 SQL 代码，从而获取敏感数据、修改数据库内容，甚至执行远程代码。

**项目地址:** [Fauzan-Aldi/CVE-2022-21661](https://github.com/Fauzan-Aldi/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #4

**来源**: [CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md](../2022/CVE-2022-21661-TAPESH-TEAM_CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection.md)

## CVE-2022-21661-WordPress-WP_Query-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器控制

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点使用受影响的版本，并允许未授权用户访问admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类由于不正确的输入验证导致的SQL注入漏洞。攻击者可以通过向wp-admin/admin-ajax.php发送包含恶意SQL语句的POST请求，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC代码显示了构造恶意请求的payload，攻击者可以将SQL注入语句放在`<inject>`的位置。搜索引擎结果中的链接表明该漏洞可以被利用来执行任意SQL查询，从而泄露数据库信息。尽管PoC相对简单，但仍然存在一定程度的投毒风险，因为攻击者可能在利用过程中引入额外的恶意代码或模块，例如用于持久化控制、隐藏攻击行为等。PoC中使用的参数是标准WordPress功能的一部分，但恶意构造的`query_vars`参数导致了SQL注入。PoC的有效性较高，因为多个来源都确认了该漏洞的存在，并提供了利用示例。

关于投毒风险的评估：PoC代码本身看起来比较直接，主要是演示如何构造恶意请求。但是，在实际利用过程中，攻击者可能会修改PoC代码，例如添加收集目标系统信息的代码、尝试执行其他恶意操作的代码、或者使用更隐蔽的注入方式。因此，不能完全排除投毒风险。这里给出10%的投毒风险是考虑了实际攻击场景中可能存在的变数。

**项目地址:** [TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection](https://github.com/TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #5

**来源**: [CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md](../2022/CVE-2022-21661-WellingtonEspindula_SSI-CVE-2022-21661.md)

## CVE-2022-21661 - WordPress SQL 注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL 注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和权限提升

**影响版本:** < 5.8.3

**利用条件:** 需要受影响的 WordPress 站点，以及能够向 `WP_Query` 传递恶意参数的能力 (通常通过插件或主题)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21661 是 WordPress 中由于 `WP_Query` 不当的输入清理导致的 SQL 注入漏洞。攻击者可以利用此漏洞执行任意 SQL 查询。根据漏洞库信息，利用的复杂性较高 (需要 High Attack Complexity 和 High Privileges Required)。漏洞利用代码只包含GNU通用公共许可证的文本内容,没有发现可执行的payload,无法判断提供的POC代码是否有效。搜索结果表明该漏洞影响 WordPress 5.8.3 之前的版本。利用方式通常涉及通过插件或主题，向 `WP_Query` 传递构造好的恶意 SQL 语句。由于POC代码只包含LICENSE信息，因此判断其中存在投毒代码的可能性为0%。

**项目地址:** [WellingtonEspindula/SSI-CVE-2022-21661](https://github.com/WellingtonEspindula/SSI-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #6

**来源**: [CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md](../2022/CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress网站存在易受攻击的插件或主题，且插件或主题的代码中存在将未经过滤的用户输入传递给 WP_Query 的情况, 并需要高权限用户。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于 WordPress 5.8.3 之前的版本中，是由于 `WP_Query` 类中对用户输入的不当清理导致的 SQL 注入漏洞。漏洞利用需要满足一定条件：

1.  **特定插件或主题：** 必须存在一个使用 `WP_Query` 且未能正确清理用户输入的插件或主题。
2.  **未过滤的输入：** 插件或主题必须将未经过滤的用户输入传递给 `$terms` 变量，该变量用于构造 SQL 查询。
3. **高权限用户:** 需要网站管理员权限才能激活恶意的插件。

**利用方式：**

1.  攻击者需要找到或创建一个满足上述条件的插件或主题。
2.  通过构造恶意的 HTTP 请求（如 `newexploit_req.txt` 所示），将包含 SQL 注入代码的参数传递给 `admin-ajax.php`，并指定 `action=sql&inject_terms=...`。
3.  服务器将执行恶意 SQL 查询，攻击者可利用该查询执行任意 SQL 操作，例如读取数据库中的敏感信息（如用户密码哈希）或进行数据篡改。

**有效性：**

提供的 PoC 代码基本有效，但需要满足特定的条件（插件/主题易受攻击，未过滤的用户输入）。`newexploit_req.txt` 展示了如何利用时间延迟的盲注来验证漏洞和提取数据。

**投毒风险：**

PoC 代码中存在一定的投毒风险，约为 20%。风险主要来自于以下几个方面：

*   **`evil.php`:** 这是一个恶意的插件，旨在演示漏洞。如果攻击者修改此插件，可以在其中添加其他恶意功能，例如植入后门或执行任意代码。
*   **环境配置：** `compose.yml` 文件使用 Docker 快速搭建环境。攻击者可能会篡改 Dockerfile 或其他配置文件，从而在不知情的情况下安装其他恶意软件。
*  **`newexploit_req.txt`**: 该文件包含了SQL注入的payload, 攻击者可以修改其中的注入语句,达到其他恶意目的,例如删除数据。
总而言之，在使用此 PoC 代码时，应仔细检查所有文件，确保没有未经授权的修改，并在隔离的环境中进行测试。特别是`evil.php`，应仔细审查，避免引入潜在的后门代码。

**项目地址:** [daniel616/CVE-2022-21661-Demo](https://github.com/daniel616/CVE-2022-21661-Demo)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #7

**来源**: [CVE-2022-21661-guestzz_CVE-2022-21661.md](../2022/CVE-2022-21661-guestzz_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件（如ele-custom-skin）且插件使用了易受攻击的WP_Query方式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 中由于 WP_Query 中不正确的清理而导致的 SQL 注入漏洞。此漏洞允许攻击者执行任意 SQL 查询，从而可能导致未经授权的数据访问或修改。漏洞存在于 WordPress 5.8.3 之前的版本中。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的PoC利用代码（如Exploit-DB上的50663）。提供的Python脚本`CVE-2022-21661.py`也证实了这一点，该脚本尝试利用此漏洞从数据库中提取信息，如用户名。脚本通过时间盲注的方式爆破数据。

**投毒风险：**

仔细审查提供的Python脚本后，发现其主要功能是利用SQL注入漏洞。脚本包含以下功能：

*   **信息收集：** 脚本可以检测WordPress版本和是否存在`ele-custom-skin`插件。
*   **SQL注入：** 脚本利用时间盲注从数据库中提取信息，例如用户名。通过构造包含`sleep()`函数的SQL查询实现时间盲注。

没有发现明显的恶意或后门代码。脚本中的延时阈值和目标域名可以通过参数进行修改，这是正常的功能，不属于投毒行为。但是，由于脚本能被用于攻击，依然存在一定的安全风险，例如被攻击者恶意利用。

因此，评估投毒风险较低，大概在1%左右，主要是指被恶意利用的风险，而非代码本身包含恶意代码。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于 `WP_Query` 类中，当插件或主题以不安全的方式使用它时，可能导致 SQL 注入。
2.  **利用前提：** 目标 WordPress 站点需要安装存在漏洞的插件（比如`ele-custom-skin`），且该插件使用了存在漏洞的`WP_Query`方式。高权限用户才可能触发漏洞。
3.  **攻击步骤：**
    *   攻击者首先需要确定目标站点上是否存在易受攻击的插件。
    *   然后，攻击者通过构造恶意的 `tax_query` 参数，将 SQL 注入到 `WP_Query` 查询中。
    *   利用时间盲注的方法，逐步提取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **PoC脚本分析:**
    *  脚本首先定义了请求头，包括User-Agent和X-Forwarded-For，用于模拟正常请求。
    *  `get_info`函数用于获取wordpress版本信息和elementor插件信息。
    *  `payload_format`函数用于生成SQL注入的payload，使用了时间盲注的方法，如果条件成立，则sleep一段时间。
    *  `get_userlogin`函数用于破解用户名，通过二分法和时间盲注逐步猜测用户名。

**项目地址:** [guestzz/CVE-2022-21661](https://github.com/guestzz/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #8

**来源**: [CVE-2022-21661-kittypurrnaz_cve-2022-21661.md](../2022/CVE-2022-21661-kittypurrnaz_cve-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要安装了Elementor插件或使用了存在漏洞利用点的其他插件/主题，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 存在的一个 SQL 注入漏洞，位于 WP_Query 中，由于不正确的过滤，允许经过身份验证的攻击者（需要高权限，例如管理员）通过精心设计的请求执行任意 SQL 查询。该漏洞的利用依赖于特定的插件或主题以某种方式使用 WP_Query ，根据漏洞库信息，攻击复杂度较高。

**有效性评估：**

根据提供的漏洞利用代码和搜索结果，该漏洞是有效的。搜索结果中多个来源（NVD, Vicarius, pentest-tools, Rapid7, Exploit-DB）都确认了该漏洞的存在和风险。提供的 `exploit.py` 脚本利用了 Elementor 插件的 ecsload action，通过注入恶意的 tax_query 参数中的 term_taxonomy_id 字段进行时间盲注，从而获取数据库信息。

**投毒风险评估：**

分析提供的 `exploit.py` 脚本，该脚本主要实现了以下功能：

1.  **数据库长度爆破：** 通过 `PAYLOAD_DB_LEN` 构造 SQL 注入 payload，使用时间盲注来确定数据库名称的长度。
2.  **数据库名称提取：** 通过 `PAYLOAD_DB_NAME` 构造 SQL 注入 payload，使用时间盲注逐字符提取数据库名称。
3.  **用户数据爆破：** 通过 `PAYLOAD_USR_DMP_LEN` 构造 SQL 注入 payload，使用时间盲注来确定 `wp_users` 表中所有用户信息的长度（ID、用户名、密码哈希）。
4.  **用户数据提取：** 通过 `PAYLOAD_USR_DUMP` 构造 SQL 注入 payload，使用时间盲注逐字符提取 `wp_users` 表中所有用户的信息。

`docker-compose.yml` 文件用于搭建一个存在漏洞的 WordPress 环境，方便进行漏洞验证。

`README.md` 文件是占位符。

**潜在投毒风险：**代码中并没有明显的恶意代码或后门。风险主要在于利用脚本本身被用于非法目的，而非作者植入的恶意代码。脚本中存在与目标服务器进行交互和睡眠的函数，理论上会增加服务器的负担，存在轻微的拒绝服务风险。代码中利用了time.sleep，如果被滥用确实可能对服务器资源造成消耗，但是总体上可以判定投毒风险极低。

**利用方式：**

1.  **环境搭建：** 使用 `docker-compose.yml` 搭建一个存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  **漏洞触发：** 确保安装了 Elementor 插件并开启，或者存在能够触发WP_Query的漏洞利用点的其它插件/主题。
3.  **SQL 注入：** 利用 `exploit.py` 脚本，通过 Elementor 插件的 ecsload action，向 `tax_query` 参数中的 `term_taxonomy_id` 字段注入恶意的 SQL 代码。
4.  **信息泄露：** 脚本通过时间盲注，可以获取数据库名称、用户表信息（用户名、密码哈希）等敏感数据。攻击者可进一步利用这些信息进行恶意操作，如登录后台、篡改数据等。


**项目地址:** [kittypurrnaz/cve-2022-21661](https://github.com/kittypurrnaz/cve-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #9

**来源**: [CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md](../2022/CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据库信息泄露和任意代码执行

**影响版本:** < 5.8.3

**利用条件:** 目标WordPress站点存在/wp-admin/admin-ajax.php，需要网络访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是一个 WordPress 核心中 WP_Query 类在处理某些输入时，由于不正确的过滤，导致可能发生 SQL 注入的漏洞。攻击者可以利用该漏洞执行任意 SQL 查询，从而可能泄露敏感数据，甚至在某些情况下执行恶意代码。

**有效性：**
提供的 POC 代码是一个 Python 脚本，用于检测目标 WordPress 站点是否存在 CVE-2022-21661 漏洞。它通过构造包含恶意 SQL 语句的 `tax_query` 参数，并向 `/wp-admin/admin-ajax.php` 发送 POST 请求，来判断目标站点是否存在漏洞。

代码中 `r0` 函数检查站点是否返回400 错误代码，且包含`0`，作为一个预检测。
`r1` 函数使用 `extractvalue` 函数进行盲注检测。如果返回结果包含计算得到的 MD5 值，则认为存在漏洞。
`r2` 函数通过 `sleep` 函数判断是否存在时间盲注。

**投毒风险：**
该仓库的投毒风险较低，约为 1%。理由如下：
*   代码功能相对独立，主要功能是发送 payload 进行漏洞检测。
*   代码逻辑清晰，没有发现明显的恶意代码或后门。
*   虽然可以将扫描结果写入日志文件，但这种行为是合理的，并非恶意行为。

当然，依旧存在风险，例如作者在未来的版本中添加恶意代码，或者利用该扫描器收集的信息进行其他攻击。

**利用方式：**
1.  **确定目标：** 确定运行 WordPress 且版本低于 5.8.3 的目标站点。
2.  **发送 Payload：** 使用提供的 POC 代码或类似的工具，向目标站点的 `/wp-admin/admin-ajax.php` 发送包含恶意 SQL 语句的 POST 请求。Payload 的核心是 `tax_query` 参数，它包含一个精心构造的 SQL 注入语句。
3.  **验证漏洞：** 通过分析响应状态码、响应时间或响应内容，判断目标站点是否存在漏洞。
4.  **数据提取/代码执行：** 如果漏洞存在，攻击者可以利用 SQL 注入漏洞执行任意 SQL 查询，从而获取数据库中的敏感数据。在某些情况下，攻击者还可以利用该漏洞执行任意代码，完全控制目标站点。

**项目地址:** [p4ncontomat3/CVE-2022-21661](https://github.com/p4ncontomat3/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #10

**来源**: [CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md](../2022/CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21661 是 WordPress 中的一个 SQL 注入漏洞，存在于 WP_Query 类中，由于不正确的清理，攻击者可以通过插件或主题以特定的方式利用该漏洞，向 `tax_query` 传入恶意参数，导致执行任意 SQL 查询。根据漏洞库信息，成功利用该漏洞可能导致未经授权的数据访问，修改甚至远程代码执行。

**有效性评估：**

根据提供的 POC 代码，攻击者需要构造一个包含恶意 SQL 语句的 POST 请求，并将其发送到 `/wp-admin/admin-ajax.php` 接口。POC 使用了 DNSLog 技术，通过 `load_file` 函数尝试将数据库版本信息发送到攻击者控制的域名 (`ceye.io`)，以此来验证漏洞的存在。搜索引擎结果也表明该漏洞存在公开的利用方法，证明POC代码的有效性。

**投毒风险分析：**

提供的漏洞利用代码只包含一个 `README.md` 文件，其中描述了漏洞的利用方法和 POC 代码。该文件中没有发现任何可疑的或恶意代码，因此，可以认为该仓库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式分析：**

1.  **漏洞位置：** `WP_Query` 类中的 SQL 语句构造。
2.  **攻击向量：** 通过 `admin-ajax.php` 接口，发送包含恶意 `tax_query` 参数的 POST 请求。
3.  **攻击目标：** WordPress 数据库。
4.  **攻击效果：** 执行任意 SQL 查询，可能导致数据泄露，数据篡改，甚至远程代码执行。
5.  **利用条件：** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query，攻击复杂度较高 (CVSS Attack Complexity: HIGH)。
6. **防御措施：** 升级WordPress版本到5.8.3或更高，启用自动更新，使用Web应用防火墙（WAF）以及对输入进行严格的过滤和验证。

**项目地址:** [purple-WL/wordpress-CVE-2022-21661](https://github.com/purple-WL/wordpress-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #11

**来源**: [CVE-2022-21661-safe3s_CVE-2022-21661.md](../2022/CVE-2022-21661-safe3s_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启`wp-admin/admin-ajax.php`接口，且攻击者能构造包含恶意SQL的请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-21661是WordPress 5.8.3之前的版本中存在的一个SQL注入漏洞。该漏洞源于`WP_Query`类中对用户输入的不当清理，导致攻击者可以通过构造恶意的`tax_query`参数，向`wp-admin/admin-ajax.php`发送包含恶意SQL语句的POST请求，从而执行任意SQL查询。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的POC代码可用。POC代码中提供的示例请求显示了如何构造包含恶意SQL语句的POST请求，通过`query_vars`参数中的`tax_query`子参数，可以注入SQL语句。

**投毒风险分析：**
查看提供的POC代码文件，主要包含以下内容：
*   `README.md`: 包含POC视频的链接和漏洞描述
*   `/POC/Video/APTIRAN`: 包含APT IRAN Research Center的联系方式
*   `/Exploit/50663.txt`: 包含漏洞的详细信息、利用方法和示例请求

经过分析，这些文件主要提供漏洞信息和利用方法，未发现明显的恶意代码或后门。风险点在于，该POC由APTIRAN发布，可能存在作者植入隐蔽后门的风险，例如在视频链接或联系方式中隐藏恶意链接或脚本。结合github上投毒事件频发，对第三方来源的工具，特别是来自安全研究团队的工具，应保持谨慎。因此，我判断此仓库中存在作者隐藏的投毒代码的风险较低，约为5%。

**利用方式分析：**
1.  攻击者需要找到一个未升级到5.8.3或更高版本的WordPress站点。
2.  攻击者构造一个POST请求，发送到`wp-admin/admin-ajax.php`。
3.  在POST请求的`query_vars`参数中，使用`tax_query`子参数，并注入恶意的SQL语句。
4.  服务器接收到请求后，由于`WP_Query`类对输入没有进行充分的清理，导致恶意的SQL语句被执行。
5.  攻击者可以通过SQL注入漏洞，获取数据库中的敏感信息，甚至可以执行任意SQL命令，导致服务器被完全控制。


**项目地址:** [safe3s/CVE-2022-21661](https://github.com/safe3s/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #12

**来源**: [CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md](../2022/CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改甚至远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启了`wp-admin/admin-ajax.php`接口，且服务器运行着存在漏洞的WordPress版本。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661是WordPress中`WP_Query`类由于不当的输入过滤导致的SQL注入漏洞。攻击者可以利用此漏洞，通过构造恶意的SQL查询语句，影响数据库操作。根据漏洞库信息和搜索引擎结果，此漏洞的利用复杂度较高(CVSS Attack Complexity: HIGH)，需要具有一定权限(CVSS Privileges Required: HIGH)。提供的PoC代码 `main.py` 尝试通过两种方式验证漏洞的存在：首先，它发送一个包含恶意SQL语句的POST请求到`wp-admin/admin-ajax.php`，利用`extractvalue()`函数尝试提取数据库信息，如果返回结果中包含随机字符串的MD5哈希值，则判断为存在漏洞。其次，如果第一个测试失败，它会尝试基于时间的盲注，通过`sleep(5)`函数来判断是否存在SQL注入。如果服务器响应时间超过5秒，则也判断为存在漏洞。

**有效性：**根据漏洞信息和PoC代码分析，此PoC具有较高的有效性，可以用于检测目标WordPress站点是否存在CVE-2022-21661漏洞。

**投毒风险：** 代码主要功能是发送特制的HTTP请求以验证SQL注入漏洞。未发现明显的恶意代码，例如文件写入，系统命令执行等。但是，`requirements.txt`文件缺失，无法完整评估是否存在依赖库投毒的可能。代码逻辑相对简单，主要是发送HTTP请求并判断响应，直接构成严重危害的可能性较低。因此，投毒风险较低，估计在1%以下。尽管如此，仍然建议仔细审查依赖项，并在受控环境中运行PoC。

**利用方式：** 攻击者首先访问`/wp-admin/admin-ajax.php`，如果返回400错误且包含'0'，则继续尝试利用SQL注入。攻击者通过构造包含恶意SQL语句的POST请求到`/wp-admin/admin-ajax.php`，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC尝试使用`extractvalue()`函数提取信息或使用`sleep()`函数进行时间盲注来验证漏洞的存在。

**项目地址:** [sealldeveloper/CVE-2022-21661-PoC](https://github.com/sealldeveloper/CVE-2022-21661-PoC)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #13

**来源**: [CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md](../2022/CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户（例如管理员）访问 `wp-admin/admin-ajax.php`，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 5.8.3 之前版本中 `WP_Query` 类中由于不正确的输入清理而导致的一个SQL注入漏洞。攻击者可以利用此漏洞执行任意SQL查询。根据漏洞信息和搜索结果，POC代码是有效的。利用方式是通过构造恶意的 `tax_query` 参数，向 `wp-admin/admin-ajax.php` 发送 POST 请求，绕过 `WP_Query` 的 sanitization 从而执行 SQL 注入。具体来说，POC 使用 `extractvalue` 函数来提取数据库版本信息。

**有效性：**
提供的POC代码有效，可以通过POST请求触发SQL注入，并利用 `extractvalue` 函数提取数据库版本信息。

**投毒风险：**
该仓库主要包含：
*   `LICENSE`: MIT许可，允许自由使用和修改代码。
*   `README.md`: 漏洞说明和POC的使用方法。
*   `docker-compose.yml`: 用于快速搭建存在漏洞的WordPress环境。
*   `functions.php`: 替换WordPress镜像中原本的functions.php文件，该文件包含了修改后的functions.php.

`docker-compose.yml` 中挂载了 `functions.php` 文件，替换了 WordPress 镜像中原本的文件。攻击者可能在 `functions.php` 文件中添加后门代码，从而实现更深层次的攻击。由于`functions.php`并非官方文件，存在潜在的风险，但目前的代码来看，主要是为了配合POC演示，没有明显的恶意行为。因此，投毒风险较低，大约1%。

**利用方式：**
1.  搭建存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  确保拥有具有访问 `wp-admin/admin-ajax.php` 权限的用户账户（通常是管理员账户）。
3.  使用提供的 POST 请求，修改请求中的 `your-ip:8080` 为目标 WordPress 站点的地址。
4.  发送 POST 请求到 `/wp-admin/admin-ajax.php`，其中包含恶意的 `tax_query` 参数。
5.  成功利用漏洞后，可以执行任意 SQL 查询，例如获取数据库版本信息，甚至可以读取或修改数据库中的数据。

**项目地址:** [w0r1i0g1ht/CVE-2022-21661](https://github.com/w0r1i0g1ht/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #14

**来源**: [CVE-2022-21661-z92g_CVE-2022-21661.md](../2022/CVE-2022-21661-z92g_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在/wp-admin/admin-ajax.php接口，并且未进行必要的安全配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类由于不正确的清理而导致的一个 SQL 注入漏洞。此漏洞允许攻击者通过插件或主题在特定方式下使用 WP_Query 时执行任意 SQL 查询。从搜索引擎的结果和漏洞库信息中可以得知，该漏洞影响 WordPress 5.8.3 之前的版本。提供的 POC 代码（Go 语言编写）通过构造恶意的 `tax_query` 参数，并发送到 `wp-admin/admin-ajax.php` 接口来触发 SQL 注入。代码中包含两种利用方式：一种是利用 `extractvalue` 函数尝试获取数据库信息（基于报错），另一种是利用 `sleep` 函数进行时间盲注。代码首先检查目标是否存在 `wp-admin/admin-ajax.php` 接口，然后尝试利用上述两种 payload 进行攻击。如果成功，则会输出漏洞存在的提示信息，并将结果写入日志文件。批量扫描功能也已实现，可以从文件中读取 IP 地址列表进行扫描。

**有效性：** 根据POC代码中的逻辑，它首先检查/wp-admin/admin-ajax.php是否存在，然后通过两种方法(extractvalue报错注入和sleep时间盲注)验证漏洞，相对有效。

**投毒风险：** 代码主要功能是漏洞扫描，但也存在一定的投毒风险。例如，日志记录功能可能被滥用，在扫描过程中搜集到的信息被记录到日志文件中，如果日志文件被恶意访问，可能导致信息泄露。此外，虽然代码本身未发现明显的恶意后门，但如果编译环境被污染，或者引入了恶意的第三方依赖库，也可能导致安全风险。考虑到代码的功能和潜在的风险，我给出的投毒风险评分为 10%。

**利用方式：**
1.  攻击者需要能够访问目标 WordPress 站点的 `/wp-admin/admin-ajax.php` 接口。
2.  攻击者构造包含恶意 SQL 代码的 `tax_query` 参数，并将其作为 POST 请求的 body 发送到 `/wp-admin/admin-ajax.php`。
3.  服务器端 WP_Query 类在处理 `tax_query` 参数时，由于缺少必要的安全检查，会将恶意 SQL 代码拼接到 SQL 查询语句中。
4.  如果攻击成功，攻击者可以执行任意 SQL 查询，从而获取数据库中的敏感信息，甚至控制整个 WordPress 站点。

**项目地址:** [z92g/CVE-2022-21661](https://github.com/z92g/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---



---

## POC #6

**来源**: [CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md](../2022/CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress网站存在易受攻击的插件或主题，且插件或主题的代码中存在将未经过滤的用户输入传递给 WP_Query 的情况, 并需要高权限用户。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于 WordPress 5.8.3 之前的版本中，是由于 `WP_Query` 类中对用户输入的不当清理导致的 SQL 注入漏洞。漏洞利用需要满足一定条件：

1.  **特定插件或主题：** 必须存在一个使用 `WP_Query` 且未能正确清理用户输入的插件或主题。
2.  **未过滤的输入：** 插件或主题必须将未经过滤的用户输入传递给 `$terms` 变量，该变量用于构造 SQL 查询。
3. **高权限用户:** 需要网站管理员权限才能激活恶意的插件。

**利用方式：**

1.  攻击者需要找到或创建一个满足上述条件的插件或主题。
2.  通过构造恶意的 HTTP 请求（如 `newexploit_req.txt` 所示），将包含 SQL 注入代码的参数传递给 `admin-ajax.php`，并指定 `action=sql&inject_terms=...`。
3.  服务器将执行恶意 SQL 查询，攻击者可利用该查询执行任意 SQL 操作，例如读取数据库中的敏感信息（如用户密码哈希）或进行数据篡改。

**有效性：**

提供的 PoC 代码基本有效，但需要满足特定的条件（插件/主题易受攻击，未过滤的用户输入）。`newexploit_req.txt` 展示了如何利用时间延迟的盲注来验证漏洞和提取数据。

**投毒风险：**

PoC 代码中存在一定的投毒风险，约为 20%。风险主要来自于以下几个方面：

*   **`evil.php`:** 这是一个恶意的插件，旨在演示漏洞。如果攻击者修改此插件，可以在其中添加其他恶意功能，例如植入后门或执行任意代码。
*   **环境配置：** `compose.yml` 文件使用 Docker 快速搭建环境。攻击者可能会篡改 Dockerfile 或其他配置文件，从而在不知情的情况下安装其他恶意软件。
*  **`newexploit_req.txt`**: 该文件包含了SQL注入的payload, 攻击者可以修改其中的注入语句,达到其他恶意目的,例如删除数据。
总而言之，在使用此 PoC 代码时，应仔细检查所有文件，确保没有未经授权的修改，并在隔离的环境中进行测试。特别是`evil.php`，应仔细审查，避免引入潜在的后门代码。

**项目地址:** [daniel616/CVE-2022-21661-Demo](https://github.com/daniel616/CVE-2022-21661-Demo)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #7

**来源**: [CVE-2022-21661-guestzz_CVE-2022-21661.md](../2022/CVE-2022-21661-guestzz_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件（如ele-custom-skin）且插件使用了易受攻击的WP_Query方式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 中由于 WP_Query 中不正确的清理而导致的 SQL 注入漏洞。此漏洞允许攻击者执行任意 SQL 查询，从而可能导致未经授权的数据访问或修改。漏洞存在于 WordPress 5.8.3 之前的版本中。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的PoC利用代码（如Exploit-DB上的50663）。提供的Python脚本`CVE-2022-21661.py`也证实了这一点，该脚本尝试利用此漏洞从数据库中提取信息，如用户名。脚本通过时间盲注的方式爆破数据。

**投毒风险：**

仔细审查提供的Python脚本后，发现其主要功能是利用SQL注入漏洞。脚本包含以下功能：

*   **信息收集：** 脚本可以检测WordPress版本和是否存在`ele-custom-skin`插件。
*   **SQL注入：** 脚本利用时间盲注从数据库中提取信息，例如用户名。通过构造包含`sleep()`函数的SQL查询实现时间盲注。

没有发现明显的恶意或后门代码。脚本中的延时阈值和目标域名可以通过参数进行修改，这是正常的功能，不属于投毒行为。但是，由于脚本能被用于攻击，依然存在一定的安全风险，例如被攻击者恶意利用。

因此，评估投毒风险较低，大概在1%左右，主要是指被恶意利用的风险，而非代码本身包含恶意代码。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于 `WP_Query` 类中，当插件或主题以不安全的方式使用它时，可能导致 SQL 注入。
2.  **利用前提：** 目标 WordPress 站点需要安装存在漏洞的插件（比如`ele-custom-skin`），且该插件使用了存在漏洞的`WP_Query`方式。高权限用户才可能触发漏洞。
3.  **攻击步骤：**
    *   攻击者首先需要确定目标站点上是否存在易受攻击的插件。
    *   然后，攻击者通过构造恶意的 `tax_query` 参数，将 SQL 注入到 `WP_Query` 查询中。
    *   利用时间盲注的方法，逐步提取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **PoC脚本分析:**
    *  脚本首先定义了请求头，包括User-Agent和X-Forwarded-For，用于模拟正常请求。
    *  `get_info`函数用于获取wordpress版本信息和elementor插件信息。
    *  `payload_format`函数用于生成SQL注入的payload，使用了时间盲注的方法，如果条件成立，则sleep一段时间。
    *  `get_userlogin`函数用于破解用户名，通过二分法和时间盲注逐步猜测用户名。

**项目地址:** [guestzz/CVE-2022-21661](https://github.com/guestzz/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #8

**来源**: [CVE-2022-21661-kittypurrnaz_cve-2022-21661.md](../2022/CVE-2022-21661-kittypurrnaz_cve-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要安装了Elementor插件或使用了存在漏洞利用点的其他插件/主题，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 存在的一个 SQL 注入漏洞，位于 WP_Query 中，由于不正确的过滤，允许经过身份验证的攻击者（需要高权限，例如管理员）通过精心设计的请求执行任意 SQL 查询。该漏洞的利用依赖于特定的插件或主题以某种方式使用 WP_Query ，根据漏洞库信息，攻击复杂度较高。

**有效性评估：**

根据提供的漏洞利用代码和搜索结果，该漏洞是有效的。搜索结果中多个来源（NVD, Vicarius, pentest-tools, Rapid7, Exploit-DB）都确认了该漏洞的存在和风险。提供的 `exploit.py` 脚本利用了 Elementor 插件的 ecsload action，通过注入恶意的 tax_query 参数中的 term_taxonomy_id 字段进行时间盲注，从而获取数据库信息。

**投毒风险评估：**

分析提供的 `exploit.py` 脚本，该脚本主要实现了以下功能：

1.  **数据库长度爆破：** 通过 `PAYLOAD_DB_LEN` 构造 SQL 注入 payload，使用时间盲注来确定数据库名称的长度。
2.  **数据库名称提取：** 通过 `PAYLOAD_DB_NAME` 构造 SQL 注入 payload，使用时间盲注逐字符提取数据库名称。
3.  **用户数据爆破：** 通过 `PAYLOAD_USR_DMP_LEN` 构造 SQL 注入 payload，使用时间盲注来确定 `wp_users` 表中所有用户信息的长度（ID、用户名、密码哈希）。
4.  **用户数据提取：** 通过 `PAYLOAD_USR_DUMP` 构造 SQL 注入 payload，使用时间盲注逐字符提取 `wp_users` 表中所有用户的信息。

`docker-compose.yml` 文件用于搭建一个存在漏洞的 WordPress 环境，方便进行漏洞验证。

`README.md` 文件是占位符。

**潜在投毒风险：**代码中并没有明显的恶意代码或后门。风险主要在于利用脚本本身被用于非法目的，而非作者植入的恶意代码。脚本中存在与目标服务器进行交互和睡眠的函数，理论上会增加服务器的负担，存在轻微的拒绝服务风险。代码中利用了time.sleep，如果被滥用确实可能对服务器资源造成消耗，但是总体上可以判定投毒风险极低。

**利用方式：**

1.  **环境搭建：** 使用 `docker-compose.yml` 搭建一个存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  **漏洞触发：** 确保安装了 Elementor 插件并开启，或者存在能够触发WP_Query的漏洞利用点的其它插件/主题。
3.  **SQL 注入：** 利用 `exploit.py` 脚本，通过 Elementor 插件的 ecsload action，向 `tax_query` 参数中的 `term_taxonomy_id` 字段注入恶意的 SQL 代码。
4.  **信息泄露：** 脚本通过时间盲注，可以获取数据库名称、用户表信息（用户名、密码哈希）等敏感数据。攻击者可进一步利用这些信息进行恶意操作，如登录后台、篡改数据等。


**项目地址:** [kittypurrnaz/cve-2022-21661](https://github.com/kittypurrnaz/cve-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #9

**来源**: [CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md](../2022/CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据库信息泄露和任意代码执行

**影响版本:** < 5.8.3

**利用条件:** 目标WordPress站点存在/wp-admin/admin-ajax.php，需要网络访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是一个 WordPress 核心中 WP_Query 类在处理某些输入时，由于不正确的过滤，导致可能发生 SQL 注入的漏洞。攻击者可以利用该漏洞执行任意 SQL 查询，从而可能泄露敏感数据，甚至在某些情况下执行恶意代码。

**有效性：**
提供的 POC 代码是一个 Python 脚本，用于检测目标 WordPress 站点是否存在 CVE-2022-21661 漏洞。它通过构造包含恶意 SQL 语句的 `tax_query` 参数，并向 `/wp-admin/admin-ajax.php` 发送 POST 请求，来判断目标站点是否存在漏洞。

代码中 `r0` 函数检查站点是否返回400 错误代码，且包含`0`，作为一个预检测。
`r1` 函数使用 `extractvalue` 函数进行盲注检测。如果返回结果包含计算得到的 MD5 值，则认为存在漏洞。
`r2` 函数通过 `sleep` 函数判断是否存在时间盲注。

**投毒风险：**
该仓库的投毒风险较低，约为 1%。理由如下：
*   代码功能相对独立，主要功能是发送 payload 进行漏洞检测。
*   代码逻辑清晰，没有发现明显的恶意代码或后门。
*   虽然可以将扫描结果写入日志文件，但这种行为是合理的，并非恶意行为。

当然，依旧存在风险，例如作者在未来的版本中添加恶意代码，或者利用该扫描器收集的信息进行其他攻击。

**利用方式：**
1.  **确定目标：** 确定运行 WordPress 且版本低于 5.8.3 的目标站点。
2.  **发送 Payload：** 使用提供的 POC 代码或类似的工具，向目标站点的 `/wp-admin/admin-ajax.php` 发送包含恶意 SQL 语句的 POST 请求。Payload 的核心是 `tax_query` 参数，它包含一个精心构造的 SQL 注入语句。
3.  **验证漏洞：** 通过分析响应状态码、响应时间或响应内容，判断目标站点是否存在漏洞。
4.  **数据提取/代码执行：** 如果漏洞存在，攻击者可以利用 SQL 注入漏洞执行任意 SQL 查询，从而获取数据库中的敏感数据。在某些情况下，攻击者还可以利用该漏洞执行任意代码，完全控制目标站点。

**项目地址:** [p4ncontomat3/CVE-2022-21661](https://github.com/p4ncontomat3/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #10

**来源**: [CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md](../2022/CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21661 是 WordPress 中的一个 SQL 注入漏洞，存在于 WP_Query 类中，由于不正确的清理，攻击者可以通过插件或主题以特定的方式利用该漏洞，向 `tax_query` 传入恶意参数，导致执行任意 SQL 查询。根据漏洞库信息，成功利用该漏洞可能导致未经授权的数据访问，修改甚至远程代码执行。

**有效性评估：**

根据提供的 POC 代码，攻击者需要构造一个包含恶意 SQL 语句的 POST 请求，并将其发送到 `/wp-admin/admin-ajax.php` 接口。POC 使用了 DNSLog 技术，通过 `load_file` 函数尝试将数据库版本信息发送到攻击者控制的域名 (`ceye.io`)，以此来验证漏洞的存在。搜索引擎结果也表明该漏洞存在公开的利用方法，证明POC代码的有效性。

**投毒风险分析：**

提供的漏洞利用代码只包含一个 `README.md` 文件，其中描述了漏洞的利用方法和 POC 代码。该文件中没有发现任何可疑的或恶意代码，因此，可以认为该仓库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式分析：**

1.  **漏洞位置：** `WP_Query` 类中的 SQL 语句构造。
2.  **攻击向量：** 通过 `admin-ajax.php` 接口，发送包含恶意 `tax_query` 参数的 POST 请求。
3.  **攻击目标：** WordPress 数据库。
4.  **攻击效果：** 执行任意 SQL 查询，可能导致数据泄露，数据篡改，甚至远程代码执行。
5.  **利用条件：** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query，攻击复杂度较高 (CVSS Attack Complexity: HIGH)。
6. **防御措施：** 升级WordPress版本到5.8.3或更高，启用自动更新，使用Web应用防火墙（WAF）以及对输入进行严格的过滤和验证。

**项目地址:** [purple-WL/wordpress-CVE-2022-21661](https://github.com/purple-WL/wordpress-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #11

**来源**: [CVE-2022-21661-safe3s_CVE-2022-21661.md](../2022/CVE-2022-21661-safe3s_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启`wp-admin/admin-ajax.php`接口，且攻击者能构造包含恶意SQL的请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-21661是WordPress 5.8.3之前的版本中存在的一个SQL注入漏洞。该漏洞源于`WP_Query`类中对用户输入的不当清理，导致攻击者可以通过构造恶意的`tax_query`参数，向`wp-admin/admin-ajax.php`发送包含恶意SQL语句的POST请求，从而执行任意SQL查询。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的POC代码可用。POC代码中提供的示例请求显示了如何构造包含恶意SQL语句的POST请求，通过`query_vars`参数中的`tax_query`子参数，可以注入SQL语句。

**投毒风险分析：**
查看提供的POC代码文件，主要包含以下内容：
*   `README.md`: 包含POC视频的链接和漏洞描述
*   `/POC/Video/APTIRAN`: 包含APT IRAN Research Center的联系方式
*   `/Exploit/50663.txt`: 包含漏洞的详细信息、利用方法和示例请求

经过分析，这些文件主要提供漏洞信息和利用方法，未发现明显的恶意代码或后门。风险点在于，该POC由APTIRAN发布，可能存在作者植入隐蔽后门的风险，例如在视频链接或联系方式中隐藏恶意链接或脚本。结合github上投毒事件频发，对第三方来源的工具，特别是来自安全研究团队的工具，应保持谨慎。因此，我判断此仓库中存在作者隐藏的投毒代码的风险较低，约为5%。

**利用方式分析：**
1.  攻击者需要找到一个未升级到5.8.3或更高版本的WordPress站点。
2.  攻击者构造一个POST请求，发送到`wp-admin/admin-ajax.php`。
3.  在POST请求的`query_vars`参数中，使用`tax_query`子参数，并注入恶意的SQL语句。
4.  服务器接收到请求后，由于`WP_Query`类对输入没有进行充分的清理，导致恶意的SQL语句被执行。
5.  攻击者可以通过SQL注入漏洞，获取数据库中的敏感信息，甚至可以执行任意SQL命令，导致服务器被完全控制。


**项目地址:** [safe3s/CVE-2022-21661](https://github.com/safe3s/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #12

**来源**: [CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md](../2022/CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改甚至远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启了`wp-admin/admin-ajax.php`接口，且服务器运行着存在漏洞的WordPress版本。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661是WordPress中`WP_Query`类由于不当的输入过滤导致的SQL注入漏洞。攻击者可以利用此漏洞，通过构造恶意的SQL查询语句，影响数据库操作。根据漏洞库信息和搜索引擎结果，此漏洞的利用复杂度较高(CVSS Attack Complexity: HIGH)，需要具有一定权限(CVSS Privileges Required: HIGH)。提供的PoC代码 `main.py` 尝试通过两种方式验证漏洞的存在：首先，它发送一个包含恶意SQL语句的POST请求到`wp-admin/admin-ajax.php`，利用`extractvalue()`函数尝试提取数据库信息，如果返回结果中包含随机字符串的MD5哈希值，则判断为存在漏洞。其次，如果第一个测试失败，它会尝试基于时间的盲注，通过`sleep(5)`函数来判断是否存在SQL注入。如果服务器响应时间超过5秒，则也判断为存在漏洞。

**有效性：**根据漏洞信息和PoC代码分析，此PoC具有较高的有效性，可以用于检测目标WordPress站点是否存在CVE-2022-21661漏洞。

**投毒风险：** 代码主要功能是发送特制的HTTP请求以验证SQL注入漏洞。未发现明显的恶意代码，例如文件写入，系统命令执行等。但是，`requirements.txt`文件缺失，无法完整评估是否存在依赖库投毒的可能。代码逻辑相对简单，主要是发送HTTP请求并判断响应，直接构成严重危害的可能性较低。因此，投毒风险较低，估计在1%以下。尽管如此，仍然建议仔细审查依赖项，并在受控环境中运行PoC。

**利用方式：** 攻击者首先访问`/wp-admin/admin-ajax.php`，如果返回400错误且包含'0'，则继续尝试利用SQL注入。攻击者通过构造包含恶意SQL语句的POST请求到`/wp-admin/admin-ajax.php`，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC尝试使用`extractvalue()`函数提取信息或使用`sleep()`函数进行时间盲注来验证漏洞的存在。

**项目地址:** [sealldeveloper/CVE-2022-21661-PoC](https://github.com/sealldeveloper/CVE-2022-21661-PoC)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #13

**来源**: [CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md](../2022/CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户（例如管理员）访问 `wp-admin/admin-ajax.php`，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 5.8.3 之前版本中 `WP_Query` 类中由于不正确的输入清理而导致的一个SQL注入漏洞。攻击者可以利用此漏洞执行任意SQL查询。根据漏洞信息和搜索结果，POC代码是有效的。利用方式是通过构造恶意的 `tax_query` 参数，向 `wp-admin/admin-ajax.php` 发送 POST 请求，绕过 `WP_Query` 的 sanitization 从而执行 SQL 注入。具体来说，POC 使用 `extractvalue` 函数来提取数据库版本信息。

**有效性：**
提供的POC代码有效，可以通过POST请求触发SQL注入，并利用 `extractvalue` 函数提取数据库版本信息。

**投毒风险：**
该仓库主要包含：
*   `LICENSE`: MIT许可，允许自由使用和修改代码。
*   `README.md`: 漏洞说明和POC的使用方法。
*   `docker-compose.yml`: 用于快速搭建存在漏洞的WordPress环境。
*   `functions.php`: 替换WordPress镜像中原本的functions.php文件，该文件包含了修改后的functions.php.

`docker-compose.yml` 中挂载了 `functions.php` 文件，替换了 WordPress 镜像中原本的文件。攻击者可能在 `functions.php` 文件中添加后门代码，从而实现更深层次的攻击。由于`functions.php`并非官方文件，存在潜在的风险，但目前的代码来看，主要是为了配合POC演示，没有明显的恶意行为。因此，投毒风险较低，大约1%。

**利用方式：**
1.  搭建存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  确保拥有具有访问 `wp-admin/admin-ajax.php` 权限的用户账户（通常是管理员账户）。
3.  使用提供的 POST 请求，修改请求中的 `your-ip:8080` 为目标 WordPress 站点的地址。
4.  发送 POST 请求到 `/wp-admin/admin-ajax.php`，其中包含恶意的 `tax_query` 参数。
5.  成功利用漏洞后，可以执行任意 SQL 查询，例如获取数据库版本信息，甚至可以读取或修改数据库中的数据。

**项目地址:** [w0r1i0g1ht/CVE-2022-21661](https://github.com/w0r1i0g1ht/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #14

**来源**: [CVE-2022-21661-z92g_CVE-2022-21661.md](../2022/CVE-2022-21661-z92g_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在/wp-admin/admin-ajax.php接口，并且未进行必要的安全配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类由于不正确的清理而导致的一个 SQL 注入漏洞。此漏洞允许攻击者通过插件或主题在特定方式下使用 WP_Query 时执行任意 SQL 查询。从搜索引擎的结果和漏洞库信息中可以得知，该漏洞影响 WordPress 5.8.3 之前的版本。提供的 POC 代码（Go 语言编写）通过构造恶意的 `tax_query` 参数，并发送到 `wp-admin/admin-ajax.php` 接口来触发 SQL 注入。代码中包含两种利用方式：一种是利用 `extractvalue` 函数尝试获取数据库信息（基于报错），另一种是利用 `sleep` 函数进行时间盲注。代码首先检查目标是否存在 `wp-admin/admin-ajax.php` 接口，然后尝试利用上述两种 payload 进行攻击。如果成功，则会输出漏洞存在的提示信息，并将结果写入日志文件。批量扫描功能也已实现，可以从文件中读取 IP 地址列表进行扫描。

**有效性：** 根据POC代码中的逻辑，它首先检查/wp-admin/admin-ajax.php是否存在，然后通过两种方法(extractvalue报错注入和sleep时间盲注)验证漏洞，相对有效。

**投毒风险：** 代码主要功能是漏洞扫描，但也存在一定的投毒风险。例如，日志记录功能可能被滥用，在扫描过程中搜集到的信息被记录到日志文件中，如果日志文件被恶意访问，可能导致信息泄露。此外，虽然代码本身未发现明显的恶意后门，但如果编译环境被污染，或者引入了恶意的第三方依赖库，也可能导致安全风险。考虑到代码的功能和潜在的风险，我给出的投毒风险评分为 10%。

**利用方式：**
1.  攻击者需要能够访问目标 WordPress 站点的 `/wp-admin/admin-ajax.php` 接口。
2.  攻击者构造包含恶意 SQL 代码的 `tax_query` 参数，并将其作为 POST 请求的 body 发送到 `/wp-admin/admin-ajax.php`。
3.  服务器端 WP_Query 类在处理 `tax_query` 参数时，由于缺少必要的安全检查，会将恶意 SQL 代码拼接到 SQL 查询语句中。
4.  如果攻击成功，攻击者可以执行任意 SQL 查询，从而获取数据库中的敏感信息，甚至控制整个 WordPress 站点。

**项目地址:** [z92g/CVE-2022-21661](https://github.com/z92g/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---



---

## POC #6

**来源**: [CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md](../2022/CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress网站存在易受攻击的插件或主题，且插件或主题的代码中存在将未经过滤的用户输入传递给 WP_Query 的情况, 并需要高权限用户。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于 WordPress 5.8.3 之前的版本中，是由于 `WP_Query` 类中对用户输入的不当清理导致的 SQL 注入漏洞。漏洞利用需要满足一定条件：

1.  **特定插件或主题：** 必须存在一个使用 `WP_Query` 且未能正确清理用户输入的插件或主题。
2.  **未过滤的输入：** 插件或主题必须将未经过滤的用户输入传递给 `$terms` 变量，该变量用于构造 SQL 查询。
3. **高权限用户:** 需要网站管理员权限才能激活恶意的插件。

**利用方式：**

1.  攻击者需要找到或创建一个满足上述条件的插件或主题。
2.  通过构造恶意的 HTTP 请求（如 `newexploit_req.txt` 所示），将包含 SQL 注入代码的参数传递给 `admin-ajax.php`，并指定 `action=sql&inject_terms=...`。
3.  服务器将执行恶意 SQL 查询，攻击者可利用该查询执行任意 SQL 操作，例如读取数据库中的敏感信息（如用户密码哈希）或进行数据篡改。

**有效性：**

提供的 PoC 代码基本有效，但需要满足特定的条件（插件/主题易受攻击，未过滤的用户输入）。`newexploit_req.txt` 展示了如何利用时间延迟的盲注来验证漏洞和提取数据。

**投毒风险：**

PoC 代码中存在一定的投毒风险，约为 20%。风险主要来自于以下几个方面：

*   **`evil.php`:** 这是一个恶意的插件，旨在演示漏洞。如果攻击者修改此插件，可以在其中添加其他恶意功能，例如植入后门或执行任意代码。
*   **环境配置：** `compose.yml` 文件使用 Docker 快速搭建环境。攻击者可能会篡改 Dockerfile 或其他配置文件，从而在不知情的情况下安装其他恶意软件。
*  **`newexploit_req.txt`**: 该文件包含了SQL注入的payload, 攻击者可以修改其中的注入语句,达到其他恶意目的,例如删除数据。
总而言之，在使用此 PoC 代码时，应仔细检查所有文件，确保没有未经授权的修改，并在隔离的环境中进行测试。特别是`evil.php`，应仔细审查，避免引入潜在的后门代码。

**项目地址:** [daniel616/CVE-2022-21661-Demo](https://github.com/daniel616/CVE-2022-21661-Demo)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #7

**来源**: [CVE-2022-21661-guestzz_CVE-2022-21661.md](../2022/CVE-2022-21661-guestzz_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件（如ele-custom-skin）且插件使用了易受攻击的WP_Query方式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 中由于 WP_Query 中不正确的清理而导致的 SQL 注入漏洞。此漏洞允许攻击者执行任意 SQL 查询，从而可能导致未经授权的数据访问或修改。漏洞存在于 WordPress 5.8.3 之前的版本中。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的PoC利用代码（如Exploit-DB上的50663）。提供的Python脚本`CVE-2022-21661.py`也证实了这一点，该脚本尝试利用此漏洞从数据库中提取信息，如用户名。脚本通过时间盲注的方式爆破数据。

**投毒风险：**

仔细审查提供的Python脚本后，发现其主要功能是利用SQL注入漏洞。脚本包含以下功能：

*   **信息收集：** 脚本可以检测WordPress版本和是否存在`ele-custom-skin`插件。
*   **SQL注入：** 脚本利用时间盲注从数据库中提取信息，例如用户名。通过构造包含`sleep()`函数的SQL查询实现时间盲注。

没有发现明显的恶意或后门代码。脚本中的延时阈值和目标域名可以通过参数进行修改，这是正常的功能，不属于投毒行为。但是，由于脚本能被用于攻击，依然存在一定的安全风险，例如被攻击者恶意利用。

因此，评估投毒风险较低，大概在1%左右，主要是指被恶意利用的风险，而非代码本身包含恶意代码。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于 `WP_Query` 类中，当插件或主题以不安全的方式使用它时，可能导致 SQL 注入。
2.  **利用前提：** 目标 WordPress 站点需要安装存在漏洞的插件（比如`ele-custom-skin`），且该插件使用了存在漏洞的`WP_Query`方式。高权限用户才可能触发漏洞。
3.  **攻击步骤：**
    *   攻击者首先需要确定目标站点上是否存在易受攻击的插件。
    *   然后，攻击者通过构造恶意的 `tax_query` 参数，将 SQL 注入到 `WP_Query` 查询中。
    *   利用时间盲注的方法，逐步提取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **PoC脚本分析:**
    *  脚本首先定义了请求头，包括User-Agent和X-Forwarded-For，用于模拟正常请求。
    *  `get_info`函数用于获取wordpress版本信息和elementor插件信息。
    *  `payload_format`函数用于生成SQL注入的payload，使用了时间盲注的方法，如果条件成立，则sleep一段时间。
    *  `get_userlogin`函数用于破解用户名，通过二分法和时间盲注逐步猜测用户名。

**项目地址:** [guestzz/CVE-2022-21661](https://github.com/guestzz/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #8

**来源**: [CVE-2022-21661-kittypurrnaz_cve-2022-21661.md](../2022/CVE-2022-21661-kittypurrnaz_cve-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要安装了Elementor插件或使用了存在漏洞利用点的其他插件/主题，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 存在的一个 SQL 注入漏洞，位于 WP_Query 中，由于不正确的过滤，允许经过身份验证的攻击者（需要高权限，例如管理员）通过精心设计的请求执行任意 SQL 查询。该漏洞的利用依赖于特定的插件或主题以某种方式使用 WP_Query ，根据漏洞库信息，攻击复杂度较高。

**有效性评估：**

根据提供的漏洞利用代码和搜索结果，该漏洞是有效的。搜索结果中多个来源（NVD, Vicarius, pentest-tools, Rapid7, Exploit-DB）都确认了该漏洞的存在和风险。提供的 `exploit.py` 脚本利用了 Elementor 插件的 ecsload action，通过注入恶意的 tax_query 参数中的 term_taxonomy_id 字段进行时间盲注，从而获取数据库信息。

**投毒风险评估：**

分析提供的 `exploit.py` 脚本，该脚本主要实现了以下功能：

1.  **数据库长度爆破：** 通过 `PAYLOAD_DB_LEN` 构造 SQL 注入 payload，使用时间盲注来确定数据库名称的长度。
2.  **数据库名称提取：** 通过 `PAYLOAD_DB_NAME` 构造 SQL 注入 payload，使用时间盲注逐字符提取数据库名称。
3.  **用户数据爆破：** 通过 `PAYLOAD_USR_DMP_LEN` 构造 SQL 注入 payload，使用时间盲注来确定 `wp_users` 表中所有用户信息的长度（ID、用户名、密码哈希）。
4.  **用户数据提取：** 通过 `PAYLOAD_USR_DUMP` 构造 SQL 注入 payload，使用时间盲注逐字符提取 `wp_users` 表中所有用户的信息。

`docker-compose.yml` 文件用于搭建一个存在漏洞的 WordPress 环境，方便进行漏洞验证。

`README.md` 文件是占位符。

**潜在投毒风险：**代码中并没有明显的恶意代码或后门。风险主要在于利用脚本本身被用于非法目的，而非作者植入的恶意代码。脚本中存在与目标服务器进行交互和睡眠的函数，理论上会增加服务器的负担，存在轻微的拒绝服务风险。代码中利用了time.sleep，如果被滥用确实可能对服务器资源造成消耗，但是总体上可以判定投毒风险极低。

**利用方式：**

1.  **环境搭建：** 使用 `docker-compose.yml` 搭建一个存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  **漏洞触发：** 确保安装了 Elementor 插件并开启，或者存在能够触发WP_Query的漏洞利用点的其它插件/主题。
3.  **SQL 注入：** 利用 `exploit.py` 脚本，通过 Elementor 插件的 ecsload action，向 `tax_query` 参数中的 `term_taxonomy_id` 字段注入恶意的 SQL 代码。
4.  **信息泄露：** 脚本通过时间盲注，可以获取数据库名称、用户表信息（用户名、密码哈希）等敏感数据。攻击者可进一步利用这些信息进行恶意操作，如登录后台、篡改数据等。


**项目地址:** [kittypurrnaz/cve-2022-21661](https://github.com/kittypurrnaz/cve-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #9

**来源**: [CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md](../2022/CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据库信息泄露和任意代码执行

**影响版本:** < 5.8.3

**利用条件:** 目标WordPress站点存在/wp-admin/admin-ajax.php，需要网络访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是一个 WordPress 核心中 WP_Query 类在处理某些输入时，由于不正确的过滤，导致可能发生 SQL 注入的漏洞。攻击者可以利用该漏洞执行任意 SQL 查询，从而可能泄露敏感数据，甚至在某些情况下执行恶意代码。

**有效性：**
提供的 POC 代码是一个 Python 脚本，用于检测目标 WordPress 站点是否存在 CVE-2022-21661 漏洞。它通过构造包含恶意 SQL 语句的 `tax_query` 参数，并向 `/wp-admin/admin-ajax.php` 发送 POST 请求，来判断目标站点是否存在漏洞。

代码中 `r0` 函数检查站点是否返回400 错误代码，且包含`0`，作为一个预检测。
`r1` 函数使用 `extractvalue` 函数进行盲注检测。如果返回结果包含计算得到的 MD5 值，则认为存在漏洞。
`r2` 函数通过 `sleep` 函数判断是否存在时间盲注。

**投毒风险：**
该仓库的投毒风险较低，约为 1%。理由如下：
*   代码功能相对独立，主要功能是发送 payload 进行漏洞检测。
*   代码逻辑清晰，没有发现明显的恶意代码或后门。
*   虽然可以将扫描结果写入日志文件，但这种行为是合理的，并非恶意行为。

当然，依旧存在风险，例如作者在未来的版本中添加恶意代码，或者利用该扫描器收集的信息进行其他攻击。

**利用方式：**
1.  **确定目标：** 确定运行 WordPress 且版本低于 5.8.3 的目标站点。
2.  **发送 Payload：** 使用提供的 POC 代码或类似的工具，向目标站点的 `/wp-admin/admin-ajax.php` 发送包含恶意 SQL 语句的 POST 请求。Payload 的核心是 `tax_query` 参数，它包含一个精心构造的 SQL 注入语句。
3.  **验证漏洞：** 通过分析响应状态码、响应时间或响应内容，判断目标站点是否存在漏洞。
4.  **数据提取/代码执行：** 如果漏洞存在，攻击者可以利用 SQL 注入漏洞执行任意 SQL 查询，从而获取数据库中的敏感数据。在某些情况下，攻击者还可以利用该漏洞执行任意代码，完全控制目标站点。

**项目地址:** [p4ncontomat3/CVE-2022-21661](https://github.com/p4ncontomat3/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #10

**来源**: [CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md](../2022/CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21661 是 WordPress 中的一个 SQL 注入漏洞，存在于 WP_Query 类中，由于不正确的清理，攻击者可以通过插件或主题以特定的方式利用该漏洞，向 `tax_query` 传入恶意参数，导致执行任意 SQL 查询。根据漏洞库信息，成功利用该漏洞可能导致未经授权的数据访问，修改甚至远程代码执行。

**有效性评估：**

根据提供的 POC 代码，攻击者需要构造一个包含恶意 SQL 语句的 POST 请求，并将其发送到 `/wp-admin/admin-ajax.php` 接口。POC 使用了 DNSLog 技术，通过 `load_file` 函数尝试将数据库版本信息发送到攻击者控制的域名 (`ceye.io`)，以此来验证漏洞的存在。搜索引擎结果也表明该漏洞存在公开的利用方法，证明POC代码的有效性。

**投毒风险分析：**

提供的漏洞利用代码只包含一个 `README.md` 文件，其中描述了漏洞的利用方法和 POC 代码。该文件中没有发现任何可疑的或恶意代码，因此，可以认为该仓库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式分析：**

1.  **漏洞位置：** `WP_Query` 类中的 SQL 语句构造。
2.  **攻击向量：** 通过 `admin-ajax.php` 接口，发送包含恶意 `tax_query` 参数的 POST 请求。
3.  **攻击目标：** WordPress 数据库。
4.  **攻击效果：** 执行任意 SQL 查询，可能导致数据泄露，数据篡改，甚至远程代码执行。
5.  **利用条件：** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query，攻击复杂度较高 (CVSS Attack Complexity: HIGH)。
6. **防御措施：** 升级WordPress版本到5.8.3或更高，启用自动更新，使用Web应用防火墙（WAF）以及对输入进行严格的过滤和验证。

**项目地址:** [purple-WL/wordpress-CVE-2022-21661](https://github.com/purple-WL/wordpress-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #11

**来源**: [CVE-2022-21661-safe3s_CVE-2022-21661.md](../2022/CVE-2022-21661-safe3s_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启`wp-admin/admin-ajax.php`接口，且攻击者能构造包含恶意SQL的请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-21661是WordPress 5.8.3之前的版本中存在的一个SQL注入漏洞。该漏洞源于`WP_Query`类中对用户输入的不当清理，导致攻击者可以通过构造恶意的`tax_query`参数，向`wp-admin/admin-ajax.php`发送包含恶意SQL语句的POST请求，从而执行任意SQL查询。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的POC代码可用。POC代码中提供的示例请求显示了如何构造包含恶意SQL语句的POST请求，通过`query_vars`参数中的`tax_query`子参数，可以注入SQL语句。

**投毒风险分析：**
查看提供的POC代码文件，主要包含以下内容：
*   `README.md`: 包含POC视频的链接和漏洞描述
*   `/POC/Video/APTIRAN`: 包含APT IRAN Research Center的联系方式
*   `/Exploit/50663.txt`: 包含漏洞的详细信息、利用方法和示例请求

经过分析，这些文件主要提供漏洞信息和利用方法，未发现明显的恶意代码或后门。风险点在于，该POC由APTIRAN发布，可能存在作者植入隐蔽后门的风险，例如在视频链接或联系方式中隐藏恶意链接或脚本。结合github上投毒事件频发，对第三方来源的工具，特别是来自安全研究团队的工具，应保持谨慎。因此，我判断此仓库中存在作者隐藏的投毒代码的风险较低，约为5%。

**利用方式分析：**
1.  攻击者需要找到一个未升级到5.8.3或更高版本的WordPress站点。
2.  攻击者构造一个POST请求，发送到`wp-admin/admin-ajax.php`。
3.  在POST请求的`query_vars`参数中，使用`tax_query`子参数，并注入恶意的SQL语句。
4.  服务器接收到请求后，由于`WP_Query`类对输入没有进行充分的清理，导致恶意的SQL语句被执行。
5.  攻击者可以通过SQL注入漏洞，获取数据库中的敏感信息，甚至可以执行任意SQL命令，导致服务器被完全控制。


**项目地址:** [safe3s/CVE-2022-21661](https://github.com/safe3s/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #12

**来源**: [CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md](../2022/CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改甚至远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启了`wp-admin/admin-ajax.php`接口，且服务器运行着存在漏洞的WordPress版本。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661是WordPress中`WP_Query`类由于不当的输入过滤导致的SQL注入漏洞。攻击者可以利用此漏洞，通过构造恶意的SQL查询语句，影响数据库操作。根据漏洞库信息和搜索引擎结果，此漏洞的利用复杂度较高(CVSS Attack Complexity: HIGH)，需要具有一定权限(CVSS Privileges Required: HIGH)。提供的PoC代码 `main.py` 尝试通过两种方式验证漏洞的存在：首先，它发送一个包含恶意SQL语句的POST请求到`wp-admin/admin-ajax.php`，利用`extractvalue()`函数尝试提取数据库信息，如果返回结果中包含随机字符串的MD5哈希值，则判断为存在漏洞。其次，如果第一个测试失败，它会尝试基于时间的盲注，通过`sleep(5)`函数来判断是否存在SQL注入。如果服务器响应时间超过5秒，则也判断为存在漏洞。

**有效性：**根据漏洞信息和PoC代码分析，此PoC具有较高的有效性，可以用于检测目标WordPress站点是否存在CVE-2022-21661漏洞。

**投毒风险：** 代码主要功能是发送特制的HTTP请求以验证SQL注入漏洞。未发现明显的恶意代码，例如文件写入，系统命令执行等。但是，`requirements.txt`文件缺失，无法完整评估是否存在依赖库投毒的可能。代码逻辑相对简单，主要是发送HTTP请求并判断响应，直接构成严重危害的可能性较低。因此，投毒风险较低，估计在1%以下。尽管如此，仍然建议仔细审查依赖项，并在受控环境中运行PoC。

**利用方式：** 攻击者首先访问`/wp-admin/admin-ajax.php`，如果返回400错误且包含'0'，则继续尝试利用SQL注入。攻击者通过构造包含恶意SQL语句的POST请求到`/wp-admin/admin-ajax.php`，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC尝试使用`extractvalue()`函数提取信息或使用`sleep()`函数进行时间盲注来验证漏洞的存在。

**项目地址:** [sealldeveloper/CVE-2022-21661-PoC](https://github.com/sealldeveloper/CVE-2022-21661-PoC)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #13

**来源**: [CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md](../2022/CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户（例如管理员）访问 `wp-admin/admin-ajax.php`，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 5.8.3 之前版本中 `WP_Query` 类中由于不正确的输入清理而导致的一个SQL注入漏洞。攻击者可以利用此漏洞执行任意SQL查询。根据漏洞信息和搜索结果，POC代码是有效的。利用方式是通过构造恶意的 `tax_query` 参数，向 `wp-admin/admin-ajax.php` 发送 POST 请求，绕过 `WP_Query` 的 sanitization 从而执行 SQL 注入。具体来说，POC 使用 `extractvalue` 函数来提取数据库版本信息。

**有效性：**
提供的POC代码有效，可以通过POST请求触发SQL注入，并利用 `extractvalue` 函数提取数据库版本信息。

**投毒风险：**
该仓库主要包含：
*   `LICENSE`: MIT许可，允许自由使用和修改代码。
*   `README.md`: 漏洞说明和POC的使用方法。
*   `docker-compose.yml`: 用于快速搭建存在漏洞的WordPress环境。
*   `functions.php`: 替换WordPress镜像中原本的functions.php文件，该文件包含了修改后的functions.php.

`docker-compose.yml` 中挂载了 `functions.php` 文件，替换了 WordPress 镜像中原本的文件。攻击者可能在 `functions.php` 文件中添加后门代码，从而实现更深层次的攻击。由于`functions.php`并非官方文件，存在潜在的风险，但目前的代码来看，主要是为了配合POC演示，没有明显的恶意行为。因此，投毒风险较低，大约1%。

**利用方式：**
1.  搭建存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  确保拥有具有访问 `wp-admin/admin-ajax.php` 权限的用户账户（通常是管理员账户）。
3.  使用提供的 POST 请求，修改请求中的 `your-ip:8080` 为目标 WordPress 站点的地址。
4.  发送 POST 请求到 `/wp-admin/admin-ajax.php`，其中包含恶意的 `tax_query` 参数。
5.  成功利用漏洞后，可以执行任意 SQL 查询，例如获取数据库版本信息，甚至可以读取或修改数据库中的数据。

**项目地址:** [w0r1i0g1ht/CVE-2022-21661](https://github.com/w0r1i0g1ht/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #14

**来源**: [CVE-2022-21661-z92g_CVE-2022-21661.md](../2022/CVE-2022-21661-z92g_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在/wp-admin/admin-ajax.php接口，并且未进行必要的安全配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类由于不正确的清理而导致的一个 SQL 注入漏洞。此漏洞允许攻击者通过插件或主题在特定方式下使用 WP_Query 时执行任意 SQL 查询。从搜索引擎的结果和漏洞库信息中可以得知，该漏洞影响 WordPress 5.8.3 之前的版本。提供的 POC 代码（Go 语言编写）通过构造恶意的 `tax_query` 参数，并发送到 `wp-admin/admin-ajax.php` 接口来触发 SQL 注入。代码中包含两种利用方式：一种是利用 `extractvalue` 函数尝试获取数据库信息（基于报错），另一种是利用 `sleep` 函数进行时间盲注。代码首先检查目标是否存在 `wp-admin/admin-ajax.php` 接口，然后尝试利用上述两种 payload 进行攻击。如果成功，则会输出漏洞存在的提示信息，并将结果写入日志文件。批量扫描功能也已实现，可以从文件中读取 IP 地址列表进行扫描。

**有效性：** 根据POC代码中的逻辑，它首先检查/wp-admin/admin-ajax.php是否存在，然后通过两种方法(extractvalue报错注入和sleep时间盲注)验证漏洞，相对有效。

**投毒风险：** 代码主要功能是漏洞扫描，但也存在一定的投毒风险。例如，日志记录功能可能被滥用，在扫描过程中搜集到的信息被记录到日志文件中，如果日志文件被恶意访问，可能导致信息泄露。此外，虽然代码本身未发现明显的恶意后门，但如果编译环境被污染，或者引入了恶意的第三方依赖库，也可能导致安全风险。考虑到代码的功能和潜在的风险，我给出的投毒风险评分为 10%。

**利用方式：**
1.  攻击者需要能够访问目标 WordPress 站点的 `/wp-admin/admin-ajax.php` 接口。
2.  攻击者构造包含恶意 SQL 代码的 `tax_query` 参数，并将其作为 POST 请求的 body 发送到 `/wp-admin/admin-ajax.php`。
3.  服务器端 WP_Query 类在处理 `tax_query` 参数时，由于缺少必要的安全检查，会将恶意 SQL 代码拼接到 SQL 查询语句中。
4.  如果攻击成功，攻击者可以执行任意 SQL 查询，从而获取数据库中的敏感信息，甚至控制整个 WordPress 站点。

**项目地址:** [z92g/CVE-2022-21661](https://github.com/z92g/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---



---

## POC #6

**来源**: [CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md](../2022/CVE-2022-21661-daniel616_CVE-2022-21661-Demo.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress网站存在易受攻击的插件或主题，且插件或主题的代码中存在将未经过滤的用户输入传递给 WP_Query 的情况, 并需要高权限用户。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于 WordPress 5.8.3 之前的版本中，是由于 `WP_Query` 类中对用户输入的不当清理导致的 SQL 注入漏洞。漏洞利用需要满足一定条件：

1.  **特定插件或主题：** 必须存在一个使用 `WP_Query` 且未能正确清理用户输入的插件或主题。
2.  **未过滤的输入：** 插件或主题必须将未经过滤的用户输入传递给 `$terms` 变量，该变量用于构造 SQL 查询。
3. **高权限用户:** 需要网站管理员权限才能激活恶意的插件。

**利用方式：**

1.  攻击者需要找到或创建一个满足上述条件的插件或主题。
2.  通过构造恶意的 HTTP 请求（如 `newexploit_req.txt` 所示），将包含 SQL 注入代码的参数传递给 `admin-ajax.php`，并指定 `action=sql&inject_terms=...`。
3.  服务器将执行恶意 SQL 查询，攻击者可利用该查询执行任意 SQL 操作，例如读取数据库中的敏感信息（如用户密码哈希）或进行数据篡改。

**有效性：**

提供的 PoC 代码基本有效，但需要满足特定的条件（插件/主题易受攻击，未过滤的用户输入）。`newexploit_req.txt` 展示了如何利用时间延迟的盲注来验证漏洞和提取数据。

**投毒风险：**

PoC 代码中存在一定的投毒风险，约为 20%。风险主要来自于以下几个方面：

*   **`evil.php`:** 这是一个恶意的插件，旨在演示漏洞。如果攻击者修改此插件，可以在其中添加其他恶意功能，例如植入后门或执行任意代码。
*   **环境配置：** `compose.yml` 文件使用 Docker 快速搭建环境。攻击者可能会篡改 Dockerfile 或其他配置文件，从而在不知情的情况下安装其他恶意软件。
*  **`newexploit_req.txt`**: 该文件包含了SQL注入的payload, 攻击者可以修改其中的注入语句,达到其他恶意目的,例如删除数据。
总而言之，在使用此 PoC 代码时，应仔细检查所有文件，确保没有未经授权的修改，并在隔离的环境中进行测试。特别是`evil.php`，应仔细审查，避免引入潜在的后门代码。

**项目地址:** [daniel616/CVE-2022-21661-Demo](https://github.com/daniel616/CVE-2022-21661-Demo)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #7

**来源**: [CVE-2022-21661-guestzz_CVE-2022-21661.md](../2022/CVE-2022-21661-guestzz_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件（如ele-custom-skin）且插件使用了易受攻击的WP_Query方式。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 中由于 WP_Query 中不正确的清理而导致的 SQL 注入漏洞。此漏洞允许攻击者执行任意 SQL 查询，从而可能导致未经授权的数据访问或修改。漏洞存在于 WordPress 5.8.3 之前的版本中。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的PoC利用代码（如Exploit-DB上的50663）。提供的Python脚本`CVE-2022-21661.py`也证实了这一点，该脚本尝试利用此漏洞从数据库中提取信息，如用户名。脚本通过时间盲注的方式爆破数据。

**投毒风险：**

仔细审查提供的Python脚本后，发现其主要功能是利用SQL注入漏洞。脚本包含以下功能：

*   **信息收集：** 脚本可以检测WordPress版本和是否存在`ele-custom-skin`插件。
*   **SQL注入：** 脚本利用时间盲注从数据库中提取信息，例如用户名。通过构造包含`sleep()`函数的SQL查询实现时间盲注。

没有发现明显的恶意或后门代码。脚本中的延时阈值和目标域名可以通过参数进行修改，这是正常的功能，不属于投毒行为。但是，由于脚本能被用于攻击，依然存在一定的安全风险，例如被攻击者恶意利用。

因此，评估投毒风险较低，大概在1%左右，主要是指被恶意利用的风险，而非代码本身包含恶意代码。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于 `WP_Query` 类中，当插件或主题以不安全的方式使用它时，可能导致 SQL 注入。
2.  **利用前提：** 目标 WordPress 站点需要安装存在漏洞的插件（比如`ele-custom-skin`），且该插件使用了存在漏洞的`WP_Query`方式。高权限用户才可能触发漏洞。
3.  **攻击步骤：**
    *   攻击者首先需要确定目标站点上是否存在易受攻击的插件。
    *   然后，攻击者通过构造恶意的 `tax_query` 参数，将 SQL 注入到 `WP_Query` 查询中。
    *   利用时间盲注的方法，逐步提取数据库中的敏感信息，例如用户名、密码哈希等。
4.  **PoC脚本分析:**
    *  脚本首先定义了请求头，包括User-Agent和X-Forwarded-For，用于模拟正常请求。
    *  `get_info`函数用于获取wordpress版本信息和elementor插件信息。
    *  `payload_format`函数用于生成SQL注入的payload，使用了时间盲注的方法，如果条件成立，则sleep一段时间。
    *  `get_userlogin`函数用于破解用户名，通过二分法和时间盲注逐步猜测用户名。

**项目地址:** [guestzz/CVE-2022-21661](https://github.com/guestzz/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #8

**来源**: [CVE-2022-21661-kittypurrnaz_cve-2022-21661.md](../2022/CVE-2022-21661-kittypurrnaz_cve-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要安装了Elementor插件或使用了存在漏洞利用点的其他插件/主题，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 存在的一个 SQL 注入漏洞，位于 WP_Query 中，由于不正确的过滤，允许经过身份验证的攻击者（需要高权限，例如管理员）通过精心设计的请求执行任意 SQL 查询。该漏洞的利用依赖于特定的插件或主题以某种方式使用 WP_Query ，根据漏洞库信息，攻击复杂度较高。

**有效性评估：**

根据提供的漏洞利用代码和搜索结果，该漏洞是有效的。搜索结果中多个来源（NVD, Vicarius, pentest-tools, Rapid7, Exploit-DB）都确认了该漏洞的存在和风险。提供的 `exploit.py` 脚本利用了 Elementor 插件的 ecsload action，通过注入恶意的 tax_query 参数中的 term_taxonomy_id 字段进行时间盲注，从而获取数据库信息。

**投毒风险评估：**

分析提供的 `exploit.py` 脚本，该脚本主要实现了以下功能：

1.  **数据库长度爆破：** 通过 `PAYLOAD_DB_LEN` 构造 SQL 注入 payload，使用时间盲注来确定数据库名称的长度。
2.  **数据库名称提取：** 通过 `PAYLOAD_DB_NAME` 构造 SQL 注入 payload，使用时间盲注逐字符提取数据库名称。
3.  **用户数据爆破：** 通过 `PAYLOAD_USR_DMP_LEN` 构造 SQL 注入 payload，使用时间盲注来确定 `wp_users` 表中所有用户信息的长度（ID、用户名、密码哈希）。
4.  **用户数据提取：** 通过 `PAYLOAD_USR_DUMP` 构造 SQL 注入 payload，使用时间盲注逐字符提取 `wp_users` 表中所有用户的信息。

`docker-compose.yml` 文件用于搭建一个存在漏洞的 WordPress 环境，方便进行漏洞验证。

`README.md` 文件是占位符。

**潜在投毒风险：**代码中并没有明显的恶意代码或后门。风险主要在于利用脚本本身被用于非法目的，而非作者植入的恶意代码。脚本中存在与目标服务器进行交互和睡眠的函数，理论上会增加服务器的负担，存在轻微的拒绝服务风险。代码中利用了time.sleep，如果被滥用确实可能对服务器资源造成消耗，但是总体上可以判定投毒风险极低。

**利用方式：**

1.  **环境搭建：** 使用 `docker-compose.yml` 搭建一个存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  **漏洞触发：** 确保安装了 Elementor 插件并开启，或者存在能够触发WP_Query的漏洞利用点的其它插件/主题。
3.  **SQL 注入：** 利用 `exploit.py` 脚本，通过 Elementor 插件的 ecsload action，向 `tax_query` 参数中的 `term_taxonomy_id` 字段注入恶意的 SQL 代码。
4.  **信息泄露：** 脚本通过时间盲注，可以获取数据库名称、用户表信息（用户名、密码哈希）等敏感数据。攻击者可进一步利用这些信息进行恶意操作，如登录后台、篡改数据等。


**项目地址:** [kittypurrnaz/cve-2022-21661](https://github.com/kittypurrnaz/cve-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #9

**来源**: [CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md](../2022/CVE-2022-21661-p4ncontomat3_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据库信息泄露和任意代码执行

**影响版本:** < 5.8.3

**利用条件:** 目标WordPress站点存在/wp-admin/admin-ajax.php，需要网络访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是一个 WordPress 核心中 WP_Query 类在处理某些输入时，由于不正确的过滤，导致可能发生 SQL 注入的漏洞。攻击者可以利用该漏洞执行任意 SQL 查询，从而可能泄露敏感数据，甚至在某些情况下执行恶意代码。

**有效性：**
提供的 POC 代码是一个 Python 脚本，用于检测目标 WordPress 站点是否存在 CVE-2022-21661 漏洞。它通过构造包含恶意 SQL 语句的 `tax_query` 参数，并向 `/wp-admin/admin-ajax.php` 发送 POST 请求，来判断目标站点是否存在漏洞。

代码中 `r0` 函数检查站点是否返回400 错误代码，且包含`0`，作为一个预检测。
`r1` 函数使用 `extractvalue` 函数进行盲注检测。如果返回结果包含计算得到的 MD5 值，则认为存在漏洞。
`r2` 函数通过 `sleep` 函数判断是否存在时间盲注。

**投毒风险：**
该仓库的投毒风险较低，约为 1%。理由如下：
*   代码功能相对独立，主要功能是发送 payload 进行漏洞检测。
*   代码逻辑清晰，没有发现明显的恶意代码或后门。
*   虽然可以将扫描结果写入日志文件，但这种行为是合理的，并非恶意行为。

当然，依旧存在风险，例如作者在未来的版本中添加恶意代码，或者利用该扫描器收集的信息进行其他攻击。

**利用方式：**
1.  **确定目标：** 确定运行 WordPress 且版本低于 5.8.3 的目标站点。
2.  **发送 Payload：** 使用提供的 POC 代码或类似的工具，向目标站点的 `/wp-admin/admin-ajax.php` 发送包含恶意 SQL 语句的 POST 请求。Payload 的核心是 `tax_query` 参数，它包含一个精心构造的 SQL 注入语句。
3.  **验证漏洞：** 通过分析响应状态码、响应时间或响应内容，判断目标站点是否存在漏洞。
4.  **数据提取/代码执行：** 如果漏洞存在，攻击者可以利用 SQL 注入漏洞执行任意 SQL 查询，从而获取数据库中的敏感数据。在某些情况下，攻击者还可以利用该漏洞执行任意代码，完全控制目标站点。

**项目地址:** [p4ncontomat3/CVE-2022-21661](https://github.com/p4ncontomat3/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #10

**来源**: [CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md](../2022/CVE-2022-21661-purple-WL_wordpress-CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21661 是 WordPress 中的一个 SQL 注入漏洞，存在于 WP_Query 类中，由于不正确的清理，攻击者可以通过插件或主题以特定的方式利用该漏洞，向 `tax_query` 传入恶意参数，导致执行任意 SQL 查询。根据漏洞库信息，成功利用该漏洞可能导致未经授权的数据访问，修改甚至远程代码执行。

**有效性评估：**

根据提供的 POC 代码，攻击者需要构造一个包含恶意 SQL 语句的 POST 请求，并将其发送到 `/wp-admin/admin-ajax.php` 接口。POC 使用了 DNSLog 技术，通过 `load_file` 函数尝试将数据库版本信息发送到攻击者控制的域名 (`ceye.io`)，以此来验证漏洞的存在。搜索引擎结果也表明该漏洞存在公开的利用方法，证明POC代码的有效性。

**投毒风险分析：**

提供的漏洞利用代码只包含一个 `README.md` 文件，其中描述了漏洞的利用方法和 POC 代码。该文件中没有发现任何可疑的或恶意代码，因此，可以认为该仓库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式分析：**

1.  **漏洞位置：** `WP_Query` 类中的 SQL 语句构造。
2.  **攻击向量：** 通过 `admin-ajax.php` 接口，发送包含恶意 `tax_query` 参数的 POST 请求。
3.  **攻击目标：** WordPress 数据库。
4.  **攻击效果：** 执行任意 SQL 查询，可能导致数据泄露，数据篡改，甚至远程代码执行。
5.  **利用条件：** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query，攻击复杂度较高 (CVSS Attack Complexity: HIGH)。
6. **防御措施：** 升级WordPress版本到5.8.3或更高，启用自动更新，使用Web应用防火墙（WAF）以及对输入进行严格的过滤和验证。

**项目地址:** [purple-WL/wordpress-CVE-2022-21661](https://github.com/purple-WL/wordpress-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #11

**来源**: [CVE-2022-21661-safe3s_CVE-2022-21661.md](../2022/CVE-2022-21661-safe3s_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启`wp-admin/admin-ajax.php`接口，且攻击者能构造包含恶意SQL的请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-21661是WordPress 5.8.3之前的版本中存在的一个SQL注入漏洞。该漏洞源于`WP_Query`类中对用户输入的不当清理，导致攻击者可以通过构造恶意的`tax_query`参数，向`wp-admin/admin-ajax.php`发送包含恶意SQL语句的POST请求，从而执行任意SQL查询。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的POC代码可用。POC代码中提供的示例请求显示了如何构造包含恶意SQL语句的POST请求，通过`query_vars`参数中的`tax_query`子参数，可以注入SQL语句。

**投毒风险分析：**
查看提供的POC代码文件，主要包含以下内容：
*   `README.md`: 包含POC视频的链接和漏洞描述
*   `/POC/Video/APTIRAN`: 包含APT IRAN Research Center的联系方式
*   `/Exploit/50663.txt`: 包含漏洞的详细信息、利用方法和示例请求

经过分析，这些文件主要提供漏洞信息和利用方法，未发现明显的恶意代码或后门。风险点在于，该POC由APTIRAN发布，可能存在作者植入隐蔽后门的风险，例如在视频链接或联系方式中隐藏恶意链接或脚本。结合github上投毒事件频发，对第三方来源的工具，特别是来自安全研究团队的工具，应保持谨慎。因此，我判断此仓库中存在作者隐藏的投毒代码的风险较低，约为5%。

**利用方式分析：**
1.  攻击者需要找到一个未升级到5.8.3或更高版本的WordPress站点。
2.  攻击者构造一个POST请求，发送到`wp-admin/admin-ajax.php`。
3.  在POST请求的`query_vars`参数中，使用`tax_query`子参数，并注入恶意的SQL语句。
4.  服务器接收到请求后，由于`WP_Query`类对输入没有进行充分的清理，导致恶意的SQL语句被执行。
5.  攻击者可以通过SQL注入漏洞，获取数据库中的敏感信息，甚至可以执行任意SQL命令，导致服务器被完全控制。


**项目地址:** [safe3s/CVE-2022-21661](https://github.com/safe3s/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #12

**来源**: [CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md](../2022/CVE-2022-21661-sealldeveloper_CVE-2022-21661-PoC.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改甚至远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点开启了`wp-admin/admin-ajax.php`接口，且服务器运行着存在漏洞的WordPress版本。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661是WordPress中`WP_Query`类由于不当的输入过滤导致的SQL注入漏洞。攻击者可以利用此漏洞，通过构造恶意的SQL查询语句，影响数据库操作。根据漏洞库信息和搜索引擎结果，此漏洞的利用复杂度较高(CVSS Attack Complexity: HIGH)，需要具有一定权限(CVSS Privileges Required: HIGH)。提供的PoC代码 `main.py` 尝试通过两种方式验证漏洞的存在：首先，它发送一个包含恶意SQL语句的POST请求到`wp-admin/admin-ajax.php`，利用`extractvalue()`函数尝试提取数据库信息，如果返回结果中包含随机字符串的MD5哈希值，则判断为存在漏洞。其次，如果第一个测试失败，它会尝试基于时间的盲注，通过`sleep(5)`函数来判断是否存在SQL注入。如果服务器响应时间超过5秒，则也判断为存在漏洞。

**有效性：**根据漏洞信息和PoC代码分析，此PoC具有较高的有效性，可以用于检测目标WordPress站点是否存在CVE-2022-21661漏洞。

**投毒风险：** 代码主要功能是发送特制的HTTP请求以验证SQL注入漏洞。未发现明显的恶意代码，例如文件写入，系统命令执行等。但是，`requirements.txt`文件缺失，无法完整评估是否存在依赖库投毒的可能。代码逻辑相对简单，主要是发送HTTP请求并判断响应，直接构成严重危害的可能性较低。因此，投毒风险较低，估计在1%以下。尽管如此，仍然建议仔细审查依赖项，并在受控环境中运行PoC。

**利用方式：** 攻击者首先访问`/wp-admin/admin-ajax.php`，如果返回400错误且包含'0'，则继续尝试利用SQL注入。攻击者通过构造包含恶意SQL语句的POST请求到`/wp-admin/admin-ajax.php`，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC尝试使用`extractvalue()`函数提取信息或使用`sleep()`函数进行时间盲注来验证漏洞的存在。

**项目地址:** [sealldeveloper/CVE-2022-21661-PoC](https://github.com/sealldeveloper/CVE-2022-21661-PoC)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #13

**来源**: [CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md](../2022/CVE-2022-21661-w0r1i0g1ht_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户（例如管理员）访问 `wp-admin/admin-ajax.php`，且WordPress版本低于5.8.3

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress 5.8.3 之前版本中 `WP_Query` 类中由于不正确的输入清理而导致的一个SQL注入漏洞。攻击者可以利用此漏洞执行任意SQL查询。根据漏洞信息和搜索结果，POC代码是有效的。利用方式是通过构造恶意的 `tax_query` 参数，向 `wp-admin/admin-ajax.php` 发送 POST 请求，绕过 `WP_Query` 的 sanitization 从而执行 SQL 注入。具体来说，POC 使用 `extractvalue` 函数来提取数据库版本信息。

**有效性：**
提供的POC代码有效，可以通过POST请求触发SQL注入，并利用 `extractvalue` 函数提取数据库版本信息。

**投毒风险：**
该仓库主要包含：
*   `LICENSE`: MIT许可，允许自由使用和修改代码。
*   `README.md`: 漏洞说明和POC的使用方法。
*   `docker-compose.yml`: 用于快速搭建存在漏洞的WordPress环境。
*   `functions.php`: 替换WordPress镜像中原本的functions.php文件，该文件包含了修改后的functions.php.

`docker-compose.yml` 中挂载了 `functions.php` 文件，替换了 WordPress 镜像中原本的文件。攻击者可能在 `functions.php` 文件中添加后门代码，从而实现更深层次的攻击。由于`functions.php`并非官方文件，存在潜在的风险，但目前的代码来看，主要是为了配合POC演示，没有明显的恶意行为。因此，投毒风险较低，大约1%。

**利用方式：**
1.  搭建存在漏洞的 WordPress 环境（版本低于 5.8.3）。
2.  确保拥有具有访问 `wp-admin/admin-ajax.php` 权限的用户账户（通常是管理员账户）。
3.  使用提供的 POST 请求，修改请求中的 `your-ip:8080` 为目标 WordPress 站点的地址。
4.  发送 POST 请求到 `/wp-admin/admin-ajax.php`，其中包含恶意的 `tax_query` 参数。
5.  成功利用漏洞后，可以执行任意 SQL 查询，例如获取数据库版本信息，甚至可以读取或修改数据库中的数据。

**项目地址:** [w0r1i0g1ht/CVE-2022-21661](https://github.com/w0r1i0g1ht/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

## POC #14

**来源**: [CVE-2022-21661-z92g_CVE-2022-21661.md](../2022/CVE-2022-21661-z92g_CVE-2022-21661.md)

## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在/wp-admin/admin-ajax.php接口，并且未进行必要的安全配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661 是 WordPress 中 WP_Query 类由于不正确的清理而导致的一个 SQL 注入漏洞。此漏洞允许攻击者通过插件或主题在特定方式下使用 WP_Query 时执行任意 SQL 查询。从搜索引擎的结果和漏洞库信息中可以得知，该漏洞影响 WordPress 5.8.3 之前的版本。提供的 POC 代码（Go 语言编写）通过构造恶意的 `tax_query` 参数，并发送到 `wp-admin/admin-ajax.php` 接口来触发 SQL 注入。代码中包含两种利用方式：一种是利用 `extractvalue` 函数尝试获取数据库信息（基于报错），另一种是利用 `sleep` 函数进行时间盲注。代码首先检查目标是否存在 `wp-admin/admin-ajax.php` 接口，然后尝试利用上述两种 payload 进行攻击。如果成功，则会输出漏洞存在的提示信息，并将结果写入日志文件。批量扫描功能也已实现，可以从文件中读取 IP 地址列表进行扫描。

**有效性：** 根据POC代码中的逻辑，它首先检查/wp-admin/admin-ajax.php是否存在，然后通过两种方法(extractvalue报错注入和sleep时间盲注)验证漏洞，相对有效。

**投毒风险：** 代码主要功能是漏洞扫描，但也存在一定的投毒风险。例如，日志记录功能可能被滥用，在扫描过程中搜集到的信息被记录到日志文件中，如果日志文件被恶意访问，可能导致信息泄露。此外，虽然代码本身未发现明显的恶意后门，但如果编译环境被污染，或者引入了恶意的第三方依赖库，也可能导致安全风险。考虑到代码的功能和潜在的风险，我给出的投毒风险评分为 10%。

**利用方式：**
1.  攻击者需要能够访问目标 WordPress 站点的 `/wp-admin/admin-ajax.php` 接口。
2.  攻击者构造包含恶意 SQL 代码的 `tax_query` 参数，并将其作为 POST 请求的 body 发送到 `/wp-admin/admin-ajax.php`。
3.  服务器端 WP_Query 类在处理 `tax_query` 参数时，由于缺少必要的安全检查，会将恶意 SQL 代码拼接到 SQL 查询语句中。
4.  如果攻击成功，攻击者可以执行任意 SQL 查询，从而获取数据库中的敏感信息，甚至控制整个 WordPress 站点。

**项目地址:** [z92g/CVE-2022-21661](https://github.com/z92g/CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)

---

