## CVE-2014-6271 - Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 1.14 <= bash <= 4.3

**利用条件:** 无需认证，通过HTTP请求即可利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的命令注入漏洞。该漏洞源于Bash在处理环境变量定义时，允许在函数定义后附加额外的命令。当Bash执行这些环境变量时，附加的命令也会被执行，从而导致攻击者可以在目标系统上执行任意命令。

POC有效性分析：提供的Python脚本`exploit.py`通过构造包含恶意命令的环境变量，并将其作为HTTP请求的User-Agent发送到目标服务器。如果目标服务器上的CGI脚本或其他程序使用Bash来处理User-Agent，那么Bash就会执行恶意命令。该POC的有效性取决于目标系统是否使用了存在漏洞的Bash版本，以及是否存在允许通过HTTP请求传递环境变量的CGI脚本或其他接口。

利用步骤：
1. 确定目标系统是否使用了存在漏洞的Bash版本，并且存在可以通过HTTP请求传递环境变量的CGI脚本或其他接口。
2. 运行`exploit.py`脚本，并提供目标URL作为参数。例如：`python3 exploit.py http://10.10.14.24/cgi-bin/test.cgi`
3. 脚本会提示用户输入要执行的命令。
4. 脚本会将包含恶意命令的环境变量作为User-Agent发送到目标服务器。
5. 如果目标服务器存在漏洞，Bash会执行恶意命令，并将结果返回给攻击者。

投毒风险分析：该POC的投毒风险较低。因为它主要依赖于构造包含恶意命令的环境变量，而不是直接执行恶意代码。脚本本身的代码比较简单，主要使用了`requests`库来发送HTTP请求，以及`termcolor`库来美化输出。脚本中唯一可能存在风险的地方是`system('clear')`，但这个命令只是用于清除屏幕，不会对系统造成危害。此外，由于脚本需要用户手动输入要执行的命令，因此攻击者无法通过修改脚本来自动执行恶意操作。总体来说，该POC的投毒风险较低，约为10%。主要风险在于攻击者可能会伪造该POC，并将其用于传播恶意软件或进行其他恶意活动，但这与POC本身的风险无关。

**项目地址:** 无

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
