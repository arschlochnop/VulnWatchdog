## CVE-2014-6271 - Bash 远程命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令注入

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 所有版本，直至修复

**利用条件:** 无需认证，通过HTTP请求即可触发

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash中的远程命令注入漏洞。该漏洞允许攻击者通过构造恶意环境变量，在目标系统上执行任意命令。该漏洞源于Bash在处理环境变量定义时，会将函数定义后的字符串作为命令执行。如果Web服务器使用CGI脚本并且CGI脚本调用了Bash，那么攻击者可以通过HTTP请求头注入恶意环境变量来利用此漏洞。

POC有效性分析：提供的POC代码是一个Python脚本，可以用来测试和利用Shellshock漏洞。脚本支持两种payload：reverse shell和文件浏览。reverse shell payload允许攻击者在目标系统上执行任意命令，并获得一个反向shell。文件浏览payload允许攻击者读取目标系统上的文件。POC代码使用requests库发送HTTP请求，并在请求头中注入恶意环境变量。脚本需要指定目标IP地址、受影响的CGI页面、攻击者IP地址和端口号（reverse shell payload），或者要执行的命令（文件浏览payload）。

利用步骤：
1. 确定目标系统上存在受影响的CGI脚本。
2. 使用POC代码构造包含恶意环境变量的HTTP请求。
3. 发送HTTP请求到目标系统。
4. 如果漏洞存在，攻击者将在目标系统上执行任意命令。

投毒风险分析：该POC代码主要使用Python标准库，如requests和sys，代码逻辑较为清晰，主要功能是构造HTTP请求并注入特定格式的header，实现漏洞利用。代码本身没有明显的恶意行为，如删除文件、安装后门等。但是，由于该POC可以执行任意命令，攻击者可能利用它来植入恶意代码。此外，如果攻击者修改POC代码，例如添加外部脚本的引用，可能会引入投毒风险。考虑到代码的清晰性和标准库的使用，以及没有发现其他可疑行为，将投毒风险评估为较低，大约10%。主要风险在于利用该POC进行漏洞利用后的行为，而非POC本身。

**项目地址:** https://github.com/null

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
