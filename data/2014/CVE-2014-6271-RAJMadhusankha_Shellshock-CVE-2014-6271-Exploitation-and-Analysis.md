## CVE-2014-6271 - GNU Bash 远程代码执行 (RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GNU Bash

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** 1.14–4.3

**利用条件:** 无需认证，通过构造环境变量，通常通过HTTP头传递给CGI脚本。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash shell中的一个严重漏洞，允许攻击者通过注入恶意代码到环境变量中来执行任意命令。该漏洞影响Bash的1.14到4.3版本。攻击者通常利用此漏洞通过HTTP头部将恶意代码传递给CGI脚本，因为HTTP头部会被设置为环境变量。在存在漏洞的系统上，Bash会错误地处理环境变量中包含的函数定义，并执行函数体之后的额外命令，导致远程代码执行。POC的有效性分析表明，该POC提供了一个完整的利用流程，包括扫描目标、启动Metasploit、加载exploit模块、配置exploit以及运行exploit。通过Nmap扫描可以确定目标系统是否运行着存在漏洞的Bash版本，Metasploit模块`exploit/multi/http/apache_mod_cgi_bash_env_exec`专门用于利用此漏洞。POC中详细的步骤说明了如何配置RHOST（目标IP地址）、TARGETURI（CGI脚本路径）、LHOST（攻击者Kali Linux IP地址）以及PAYLOAD（例如，`cmd/unix/reverse_netcat`，用于建立反向Shell）。成功执行exploit后，攻击者可以获得目标系统的反向shell，从而执行任意命令，如`whoami`、`uname -a`和`ifconfig`，以验证漏洞利用的成功。此POC质量较高，因为它提供了一个即时可用的利用方法，并且文档齐全，易于理解和操作。然而，该POC的投毒风险较低，因为代码主要是Metasploit配置，没有发现混淆代码或恶意行为。所使用的payload `cmd/unix/reverse_netcat` 是Metasploit的标准模块，不太可能包含恶意后门。此POC主要依赖于已知的漏洞利用模块，而不是引入新的、潜在危险的代码。该漏洞的利用步骤包括：首先，使用Nmap扫描目标系统以确定是否存在CGI脚本和Bash版本。然后，启动Metasploit并加载相应的exploit模块。配置RHOST、TARGETURI和LHOST等参数，并选择适当的payload（例如，反向Shell）。最后，运行exploit，如果目标系统存在漏洞，则攻击者将获得一个反向shell，可以执行任意命令。投毒风险分析：尽管该POC的直接投毒风险较低，但用户仍然需要谨慎。从不受信任的来源下载或使用POC可能会导致风险。攻击者可能会修改POC，添加恶意代码，例如，植入后门或执行其他恶意活动。因此，建议仅从可信来源获取POC，并在隔离环境中进行测试和分析，以确保其安全性。此外，应始终保持系统和软件的更新，以修复已知的漏洞。

**项目地址:** https://github.com/vulnwatchdog_3fecb598b9ed359ed52b551867d625f5

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
