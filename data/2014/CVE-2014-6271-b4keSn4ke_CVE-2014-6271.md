## CVE-2014-6271 - Bash 远程代码执行

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** < 4.3

**利用条件:** 需要目标系统存在mod_cgi支持的web服务器，并且bash版本低于4.3。攻击者可以通过构造恶意的HTTP请求，将包含恶意代码的环境变量传递给bash执行。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的严重漏洞。该漏洞允许攻击者通过构造特定的环境变量，在目标系统上执行任意代码。该漏洞的根源在于Bash在处理环境变量时，没有正确地过滤和转义其中的特殊字符，导致攻击者可以将恶意代码注入到环境变量中，并由Bash执行。该漏洞影响所有使用Bash作为默认shell的系统，包括Linux、macOS等。

POC代码分析：提供的POC代码是一个Python脚本，名为shellshock.py。该脚本利用了Shellshock漏洞，通过构造恶意的HTTP请求，在目标系统上执行任意命令。脚本首先会设置一个监听端口，然后向目标URL发送包含恶意代码的HTTP请求。当目标系统执行该请求时，会将恶意代码传递给Bash执行，从而建立一个反向shell连接到攻击者的监听端口。从POC代码来看，其有效性较高，可以实现远程代码执行，利用步骤简单，只需要提供目标URL和监听端口即可。

利用步骤：
1. 准备：确保目标系统存在mod_cgi支持的web服务器，并且bash版本低于4.3。
2. 设置监听：在攻击者机器上设置一个TCP监听端口，例如使用nc -lvp 4444。
3. 执行POC：运行shellshock.py脚本，指定目标URL和监听端口，例如python shellshock.py [攻击者IP] 4444 [目标URL]。
4. 获取shell：如果漏洞利用成功，攻击者将在监听端口上收到一个反向shell连接。

投毒风险分析：
该POC代码的投毒风险较低，主要原因如下：
1. 代码清晰：POC代码结构清晰，逻辑简单，易于理解和审查。
2. 使用标准库：POC代码主要使用了Python的标准库，例如urllib、ssl等，没有使用任何可疑的第三方库。
3. 无可疑行为：POC代码的功能明确，只是利用Shellshock漏洞执行远程代码，没有进行任何其他恶意操作，例如窃取数据、篡改文件等。
4. 代码中存在部分字符串拼接，存在一定的风险，但总体风险可控。

但是，仍然存在一定的投毒风险，攻击者可能会在POC代码中插入恶意代码，例如：
1. 修改反向shell的执行命令，使其执行其他恶意操作。
2. 添加额外的网络请求，向其他服务器发送敏感信息。
3. 混淆代码，使代码难以理解和审查。

因此，在使用该POC代码时，务必进行仔细的审查，确保代码的安全性。

**项目地址:** /tmp/vulnwatchdog_4c10610113f275a079b5bc8c5e3c41b2

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
