## CVE-2014-6271 - GNU Bash 远程命令执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行(RCE)

**影响应用:** GNU Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** <= 4.3

**利用条件:** 取决于目标系统，通常需要目标系统存在CGI脚本或其他方式允许通过环境变量传递参数给Bash

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞允许攻击者通过构造特定的环境变量来执行任意命令。当Bash解析环境变量时，如果环境变量的值包含函数定义，Bash会执行该函数定义后的命令。如果Web服务器或其他应用程序使用Bash来处理请求，攻击者可以通过HTTP请求或其他方式设置恶意的环境变量，从而在服务器上执行任意命令。此漏洞影响了大量Linux和Unix系统，以及与bash交互的各种应用程序，如HTTP, FTP, DHCP等等。

POC有效性分析：提供的POC代码是一个Python脚本，它利用Shellshock漏洞尝试在目标服务器上执行反向shell。该脚本通过构造包含恶意payload的HTTP请求头（User-Agent, Cookie, Referer）来利用漏洞。该POC通过发送带有恶意header的HTTP请求到目标CGI页面，如果目标服务器上的CGI脚本使用Bash处理请求，则Bash会解析恶意header中的payload，从而执行反向shell命令。POC的有效性取决于目标系统上Bash的版本和配置，以及CGI脚本是否容易受到攻击。

利用步骤：
1.  设置攻击者的监听IP地址和端口（lhost和lport）。
2.  确定目标服务器上存在可利用的CGI脚本路径（pages）。
3.  运行POC脚本，指定目标IP地址、监听IP地址、监听端口和CGI脚本路径。
4.  POC脚本会发送包含恶意payload的HTTP请求到目标服务器。
5.  如果目标服务器存在漏洞，攻击者会收到反向shell连接。

投毒风险分析：该POC代码主要用于漏洞验证和利用，本身不包含明显的恶意行为。但如果该POC被恶意修改或用于攻击生产系统，可能存在以下投毒风险：
1.  修改反向shell payload，植入恶意软件或后门。
2.  添加额外的HTTP请求，扫描内网或其他敏感信息。
3.  利用漏洞窃取目标服务器上的敏感数据。
4.  使用代理服务器隐藏攻击者的真实IP地址。
5.  该POC使用了`requests`库，存在一定的依赖风险，如果requests库本身存在漏洞，可能会被利用。
6.  尽管Payload较为清晰，但仍存在一定的混淆空间，例如对反向连接的IP和端口进行编码，增加分析难度。该POC的投毒风险较低，约为15%。

**项目地址:** https://github.com/vulnwatchdog_fd2687e5da234577f60b9f68f132ddf1/CVE-2014-6271.py

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
