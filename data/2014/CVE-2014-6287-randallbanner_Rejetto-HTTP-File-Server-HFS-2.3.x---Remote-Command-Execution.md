# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md](../2014/CVE-2014-6287-randallbanner_Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution.md)

# CVE-2014-6287

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6287-10cks_CVE-2014-6287.md](../2014/CVE-2014-6287-10cks_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #2

**来源**: [CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md](../2014/CVE-2014-6287-Nicoslo_Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #3

**来源**: [CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md](../2014/CVE-2014-6287-Z3R0-0x30_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HttpFileServer-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HttpFileServer

**危害等级:** 高危，允许未经身份验证的攻击者执行任意系统命令

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且攻击者可以访问该服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于Rejetto HTTP File Server 2.3x版本(低于2.3c)的parserLib.pas文件中的findMacroMarker函数中。该漏洞允许远程攻击者通过搜索操作中的%00序列执行任意程序。利用方式是构造包含恶意代码的URL，利用HFS的搜索功能中的漏洞执行系统命令。提供的POC代码通过URL编码将命令注入到搜索查询中，从而利用此漏洞。漏洞利用代码检查了是否存在python3环境,并使用了urllib3库发送恶意构造的GET请求。检查了POC代码和readme，没有发现明显的投毒代码。

**项目地址:** [Z3R0-0x30/CVE-2014-6287](https://github.com/Z3R0-0x30/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #4

**来源**: [CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md](../2014/CVE-2014-6287-francescobrina_hfs-cve-2014-6287-exploit.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #5

**来源**: [CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md](../2014/CVE-2014-6287-hadrian3689_rejetto_hfs_rce.md)

## CVE-2014-6287 Rejetto HFS 2.3.x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的Rejetto HFS，并且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本直到 2.3c 之前的版本中。漏洞位于 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以利用 `%00` 序列在搜索操作中执行任意程序。

**有效性：**
根据漏洞信息、搜索结果（尤其是 Exploit-DB 的链接）以及提供的 POC 代码，可以判断此漏洞是有效的。Metasploit 也有相应的模块（根据 github.com/rapid7/metasploit-framework/pull/3793）。提供的 Python 脚本 `hfs.py` 实现了漏洞利用，通过构造包含恶意命令的 URL 发送到目标服务器，从而执行任意命令。

**投毒风险：**
POC 代码本身主要是构造payload，没有发现明显的投毒代码，只有一个很小的风险。
代码分析：
1.  使用 argparse 解析命令行参数：目标 URL、lhost（攻击者 IP 地址）和 lport（攻击者监听端口）。
2.  定义了 `HFS` 类，用于处理漏洞利用。
3.  `check_url` 函数：确保目标 URL 以 `/` 结尾。
4.  `hfs_exploit` 函数：
    *   构造 PowerShell 反向 shell payload，其中包含攻击者的 IP 地址和端口。
    *   使用 base64 编码 payload。
    *   使用 `requests.utils.quote` 对 payload 进行 URL 编码。
    *   构造包含 payload 的 URL：`?search=%00{{.exec|...payload...}}.}}`
    *   发送 GET 请求到构造的 URL。
5.  `rev_shell` 函数：在本地启动 netcat 监听指定端口。
6.  使用线程同时运行 `hfs_exploit` 和 `rev_shell` 函数。

**利用方式：**
1.  攻击者首先需要确认目标服务器运行着受影响版本的 Rejetto HFS。
2.  攻击者需要准备一个可以接受反向 shell 的监听器（例如，netcat）。
3.  攻击者运行提供的 Python 脚本，指定目标 URL、攻击者 IP 地址和监听端口。
4.  脚本会构造一个特殊的 URL，其中包含经过编码的 PowerShell 命令，用于在目标服务器上建立反向 shell。
5.  脚本将构造的 URL 发送到目标服务器。
6.  目标服务器解析 URL 中的命令，由于漏洞的存在，执行 PowerShell 命令，并建立与攻击者机器的反向 shell 连接。
7.  攻击者通过反向 shell 控制目标服务器。

**项目地址:** [hadrian3689/rejetto_hfs_rce](https://github.com/hadrian3689/rejetto_hfs_rce)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #6

**来源**: [CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md](../2014/CVE-2014-6287-mrintern_thm_steelmountain_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #7

**来源**: [CVE-2014-6287-nika0x38_CVE-2014-6287.md](../2014/CVE-2014-6287-nika0x38_CVE-2014-6287.md)

## CVE-2014-6287 Rejetto HFS 2.3x 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在搜索操作中插入`%00`序列来执行任意程序。

**有效性：**
根据漏洞库信息、搜索引擎结果（如Exploit-DB链接、Packet Storm Security链接、vicarius.io的分析等）以及CISA KEV catalog，该漏洞的POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目依赖的确切版本。该文件本身不包含可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式是向Rejetto HFS服务器发送包含恶意构造的搜索请求，该请求中包含`%00`序列，从而绕过`findMacroMarker`函数的检查，允许执行任意命令。攻击者可以构造恶意宏，例如执行系统命令，从而实现远程命令执行。 Metasploit框架中存在利用此漏洞的模块，简化了利用过程。具体来说，攻击者可以在搜索框或URL中插入包含`%00{command}`的字符串，其中`{command}`是要执行的系统命令。

**项目地址:** [nika0x38/CVE-2014-6287](https://github.com/nika0x38/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #8

**来源**: [CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md](../2014/CVE-2014-6287-rahisec_rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #9

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #10

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---



---

## POC #10

**来源**: [CVE-2014-6287-roughiz_cve-2014-6287.py.md](../2014/CVE-2014-6287-roughiz_cve-2014-6287.py.md)

## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #11

**来源**: [CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md](../2014/CVE-2014-6287-wizardy0ga_THM-Steel_Mountain-CVE-2014-6287.md)

## CVE-2014-6287 - Rejetto HTTP File Server 远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行受影响版本的HFS，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。具体利用方式是构造一个包含 null 字节和 `{ .exec|command. }` 结构的 URL，发送到目标服务器。服务器在处理该 URL 时，由于正则表达式处理 null 字节不当，导致执行 `command` 中的命令。虽然提供的POC文档本身没有明显的投毒代码，但由于远程命令执行的性质，攻击者可以利用此漏洞植入恶意软件。关于投毒风险，考虑到POC只是一个漏洞的原理说明和简单的利用方式展示，恶意作者可能会在实际攻击中，使用该POC作为基础，构建更复杂的攻击载荷，例如下载和执行恶意脚本，或者修改系统文件。因此，虽然POC本身没有明显投毒行为，仍然存在一定的投毒风险。

**项目地址:** [wizardy0ga/THM-Steel_Mountain-CVE-2014-6287](https://github.com/wizardy0ga/THM-Steel_Mountain-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

## POC #12

**来源**: [CVE-2014-6287-zhsh9_CVE-2014-6287.md](../2014/CVE-2014-6287-zhsh9_CVE-2014-6287.md)

## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可执行任意命令

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标运行存在漏洞的Rejetto HFS版本，攻击者可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本（2.3c之前）中的一个远程命令执行漏洞。该漏洞存在于`parserLib.pas`文件中的`findMacroMarker`函数中。攻击者可以通过在搜索操作中使用`%00`序列来执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，其中恶意命令嵌入在`search`参数中，并以`%00{.exec|...}`格式编码。
2.  HFS服务器解析URL时，由于`findMacroMarker`函数对NULL字节的处理不当，导致恶意命令被执行。

提供的PoC代码`exp.py`利用了该漏洞。PoC需要以下参数：

*   `--rhost`: 目标IP地址。
*   `--rport`: 目标端口号。
*   `--lhost`: 攻击者控制的SMB服务器的IP地址，用于托管`nc.exe`。
*   `--lport`: 攻击者监听反向shell的端口号。
*   `--smb_workgroup`: SMB workgroup，默认为"share"。
*   `--nc_name`: nc.exe文件名, 默认为"nc.exe"

PoC首先从攻击者的SMB服务器下载`nc.exe`到目标机器上的`C:\Users\Public\`目录。然后，PoC使用`nc.exe`在目标机器上执行反向shell，连接回攻击者的机器。

**有效性：**

根据漏洞信息和提供的PoC代码，该漏洞利用是有效的。多个来源 (Exploit-DB, PacketStorm) 证实了该漏洞的存在，以及PoC的有效性。该漏洞还被CISA列入已知被利用漏洞目录(KEV)。

**投毒风险：**

PoC代码的主要目的是利用漏洞实现远程命令执行，虽然代码需要从攻击者控制的SMB服务器下载`nc.exe`，但该过程本身是漏洞利用的一部分，不是后门或投毒行为。作者可能植入投毒代码的风险较低，约10%。风险主要来自于以下几点：

* 下载的`nc.exe`可能被替换为恶意版本。用户需要自行验证下载的`nc.exe`的完整性。
* 代码中的`base_dir`写死为`C:\Users\Public\`，如果用户没有修改，可能因为目录权限等原因，导致payload运行失败，不算是投毒，但是限制了payload的通用性。

总体而言，该仓库的投毒风险较低。用户在使用该PoC代码时，应当注意验证所使用工具的来源和完整性。

**项目地址:** [zhsh9/CVE-2014-6287](https://github.com/zhsh9/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)

---

