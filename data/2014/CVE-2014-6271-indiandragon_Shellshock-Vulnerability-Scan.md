## CVE-2014-6271 - Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 严重

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (推测)

**影响版本:** 1.14 through 4.3

**利用条件:** 无需认证，可通过多种方式触发（如HTTP请求，环境变量等）

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash（Bourne-Again Shell）中的严重命令注入漏洞。该漏洞源于Bash在处理环境变量定义时，可以执行任意命令。具体来说，攻击者可以将恶意代码附加到环境变量的值中，当Bash解析这些变量时，会将附加的代码作为命令执行。

POC有效性分析：
提供的POC代码是一个Android应用程序，旨在扫描设备是否存在Shellshock漏洞。虽然该应用本身已经停止维护，但它的存在表明利用该漏洞的概念验证已经存在，并且相对容易实现。大量的公开资料和可用的exploit进一步证实了该漏洞的有效性。通过搜索结果可以发现，该漏洞影响广泛，并且存在多种攻击方式。

利用步骤：
1. 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; echo vulnerable`
2. 攻击者通过HTTP请求、SSH、或其他任何允许设置环境变量的途径，将该恶意环境变量传递给目标系统。
3. 目标系统上的Bash解析该环境变量，执行其中的恶意代码。
4. 攻击者可以利用该漏洞执行任意命令，例如：读取敏感信息、修改系统配置、安装恶意软件等。

由于该漏洞可以在无需认证的情况下通过多种途径触发，因此攻击者可以很容易地利用该漏洞进行远程攻击。例如，攻击者可以修改HTTP请求的User-Agent字段，在其中包含恶意代码，从而攻击Web服务器。

投毒风险分析：
提供的POC代码主要用于检测Shellshock漏洞，不包含恶意代码。然而，利用Shellshock漏洞本身具有很高的投毒风险。攻击者可以利用该漏洞在目标系统上安装恶意软件，例如：后门程序、僵尸网络客户端等。此外，攻击者还可以利用该漏洞篡改系统文件，植入恶意代码，从而实现持久化控制。

该POC的投毒风险较低，主要在于其目的是检测漏洞而非利用漏洞。但是，如果攻击者修改该POC，将其用于攻击，则投毒风险会显著增加。考虑到Shellshock漏洞的严重性和广泛影响，攻击者可能会利用该漏洞进行大规模攻击，因此需要高度重视该漏洞的防御。

该POC项目本身的代码比较清晰，主要使用Java和Gradle构建Android应用，没有发现明显的恶意行为或混淆代码。因此，该POC的投毒风险较低，估计在10%左右。

**项目地址:** https://github.com/retyuk/Shellshock-Vulnerability-Scan

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
