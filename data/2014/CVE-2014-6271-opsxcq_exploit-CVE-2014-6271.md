## CVE-2014-6271 - Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** <= 4.3

**利用条件:** 无需认证，通过CGI脚本或SSH等接口利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的命令注入漏洞。该漏洞源于Bash在处理环境变量时，允许将函数定义附加到环境变量中。当Bash解析以函数定义开头的环境变量时，它会执行函数定义后面的任意命令。如果Web服务器使用CGI脚本且CGI脚本调用Bash，则攻击者可以通过修改HTTP请求中的User-Agent或其他环境变量来注入恶意代码。攻击者可以利用这个漏洞在服务器上执行任意命令，从而获取敏感信息、修改网站内容或完全控制服务器。

POC代码分析：提供的Dockerfile文件创建了一个包含易受攻击的Bash版本的Docker镜像。该镜像安装了Apache2 Web服务器，并将一个名为`vulnerable`的CGI脚本放置在`/usr/lib/cgi-bin/`目录下。`index.html`文件用于在Web浏览器中显示一个简单的页面。`main.sh`脚本是容器的入口点，它启动Apache2 Web服务器。README.md文件提供了有关如何运行易受攻击的环境以及如何利用Shellshock漏洞的说明。其中提供了一个使用curl命令的单行利用示例，该示例通过User-Agent头注入恶意代码来执行`cat /etc/passwd`命令。此外，还提供了一个`exploit-deface.sh`脚本，可以用于修改Web服务器上显示的页面，实现网页篡改。

利用步骤：
1. 启动包含易受攻击的Bash版本的Docker容器。
2. 使用curl命令或`exploit-deface.sh`脚本，通过修改HTTP请求中的User-Agent或其他环境变量来注入恶意代码。
3. 执行任意命令，例如读取`/etc/passwd`文件或修改网站内容。

投毒风险分析：该POC代码的投毒风险较低。Dockerfile和README.md文件没有包含任何可疑的代码或行为。`exploit-deface.sh`脚本虽然可以修改网站内容，但其目的是演示漏洞的利用，而不是进行恶意攻击。curl命令示例中使用的命令`cat /etc/passwd`也是一个常见的用于测试漏洞的命令，而不是用于窃取敏感信息或进行破坏性操作。虽然攻击者可以使用该漏洞执行任意命令，但POC本身没有提供任何恶意代码或工具。综合来看，该POC代码的投毒风险较低，约为10%。但需要注意的是，在实际使用中，攻击者可能会使用该漏洞注入更具破坏性的恶意代码，因此需要采取相应的安全措施来防范Shellshock攻击。例如，及时更新Bash版本，限制CGI脚本的使用，对输入数据进行严格的验证和过滤等。

**项目地址:** https://hub.docker.com/r/vulnerables/cve-2014-6271/

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
