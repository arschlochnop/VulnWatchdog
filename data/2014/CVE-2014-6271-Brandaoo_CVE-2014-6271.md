## CVE-2014-6271 - Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 所有在漏洞修复之前发布的 Bash 版本

**利用条件:** 取决于应用程序如何使用 Bash，可能需要网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Unix Bash shell中的安全漏洞。该漏洞允许攻击者通过利用Bash处理环境变量的方式，在系统上执行任意代码或命令。本质上，攻击者可以将恶意代码注入到环境变量中，当Bash shell解析这些变量时，就会执行这些恶意代码。

POC有效性分析：提供的shellshock.sh脚本通过发送带有特制User-Agent头的HTTP请求来检查目标网站是否存在Shellshock漏洞。该User-Agent头包含一个Bash函数定义和一个命令`echo VULNERABLE`。如果目标系统容易受到攻击，它将执行该命令，并且HTTP响应将包含“VULNERABLE”字符串。脚本使用`curl`发送请求并检查响应中的字符串。这个方法可以有效地验证目标是否容易受到攻击。经验证，该POC可以有效检测目标是否存在Shellshock漏洞，但仅限于Web场景，其他利用方式未覆盖。

利用步骤：
1.  安装curl：如果系统上未安装curl，请安装它。
2.  下载或克隆存储库：从提供的URL下载或克隆包含shellshock.sh脚本的存储库。
3.  使脚本可执行：使用chmod +x shellshock.sh命令使脚本可执行。
4.  运行脚本：使用./shellshock.sh <目标URL>命令运行该脚本，将<目标URL>替换为要检查的网站的URL。
5.  检查输出：脚本将输出该站点是否容易受到Shellshock攻击。

投毒风险分析：
此POC的投毒风险较低。该脚本主要通过构造特定的HTTP请求头来检测漏洞，其核心功能在于漏洞检测而非利用。脚本本身使用标准的bash命令，没有发现任何混淆、恶意行为或外部脚本的引用。用户需要手动运行脚本并分析结果，这降低了自动化攻击的风险。此脚本依赖于`curl`命令，如果`curl`被篡改，可能存在风险，但这种风险与脚本本身无关。此外，由于POC的目的是检测漏洞，而非直接执行恶意操作，因此其潜在的滥用场景相对有限。脚本的输出也比较明确，方便用户判断，避免了因误判而造成的损失。总体而言，该POC脚本的投毒风险较低。

**项目地址:** https://github.com/Brandaoo/shellshockChecker

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
