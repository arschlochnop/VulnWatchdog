## CVE-2014-6271 - GNU Bash 远程代码执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GNU Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本或其它方式允许Bash执行，且攻击者可以控制环境变量。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞允许攻击者通过构造恶意环境变量，在目标系统上执行任意命令。当Bash解析环境变量时，如果环境变量包含函数定义，Bash会在执行函数定义之前执行函数名后面的命令。这导致了远程代码执行的风险。

POC有效性分析：提供的POC代码是一个完整的、可复现的漏洞利用演示。它使用Kali Linux作为攻击者，Metasploitable2作为目标服务器，并通过curl、Burp Suite和Netcat等工具展示了漏洞的利用过程。POC包含了一个手动创建的基于Bash的CGI脚本，用于模拟存在漏洞的环境。通过修改环境变量，攻击者可以执行任意命令。该POC不仅提供了curl和Burp Suite的利用方法，还展示了如何获得反向shell，并升级到完全交互式的TTY。

利用步骤：
1.  在Metasploitable2上创建一个存在漏洞的CGI脚本（shellshock.sh）。
2.  使用Kali Linux，通过curl或Burp Suite等工具，向目标服务器发送包含恶意环境变量的HTTP请求。
3.  恶意环境变量中的命令将在目标服务器上执行。
4.  如果环境变量中包含反向shell命令，攻击者可以在Kali Linux上获得一个shell。

投毒风险分析：该POC的投毒风险较低。主要原因是：代码清晰，利用过程明确，没有混淆或隐藏的恶意行为。POC使用标准库和工具，没有包含任何可疑的外部脚本或eval语句。主要的风险在于，如果攻击者利用该漏洞在目标系统上写入恶意文件或安装后门，可能会导致持久性的危害。因此，在使用该POC进行测试时，务必确保在隔离的环境中进行，并采取适当的安全措施，以防止意外的损害。此外，如果将该POC集成到自动化扫描工具中，需要仔细审查和控制扫描目标，避免误伤。
虽然POC本身风险较低，但如果被恶意攻击者利用，可能会造成严重的安全事件。因此，及时修补Bash漏洞至关重要。

**项目地址:** https://github.com/opsxcq/exploit-CVE-2014-6271

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
