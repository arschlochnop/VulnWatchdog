## CVE-2014-6271 - Bash 远程代码执行

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 1.14.0 to 4.3

**利用条件:** 通过CGI脚本可远程利用，无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个影响Bash的严重远程代码执行漏洞。该漏洞源于Bash在解析环境变量时存在缺陷，允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。此POC提供了一个完整的、可复现的演示环境，利用Kali Linux作为攻击者，Metasploitable2作为目标，并通过curl、Burp Suite和Netcat等工具进行攻击。利用步骤包括：1. 在Metasploitable2上创建一个CGI脚本，该脚本会显示环境变量。2. 使用curl向该CGI脚本发送包含恶意代码的环境变量，例如，`curl -H "User-Agent: () { :; }; echo vulnerable" http://192.168.1.5/cgi-bin/shellshock.sh`。3. 恶意代码将会被执行。通过Burp Suite可以拦截和修改HTTP请求，从而更方便地注入恶意代码。还可以利用Netcat建立反向shell，从而完全控制目标系统。该POC的有效性经过验证，可以成功地在Metasploitable2上执行任意命令。攻击者可以利用此漏洞获取敏感信息、修改系统配置或执行恶意代码。此外，Metasploit也提供了利用该漏洞的模块，可以简化攻击过程。

投毒风险分析：此POC的投毒风险较低。虽然该POC涉及到执行任意命令，但其主要目的是演示漏洞的利用过程。POC中使用的代码清晰易懂，没有明显的恶意行为。此外，该POC使用了常见的网络工具，如curl、Burp Suite和Netcat，这些工具本身并不具有恶意性。然而，攻击者可能会利用该POC进行恶意攻击，例如，通过修改POC中的代码来执行恶意操作。因此，在使用该POC时，需要谨慎操作，并确保了解其潜在的风险。该POC主要依赖于标准的系统工具和bash的功能，并未发现任何试图从外部源下载或执行其他可疑脚本的行为。代码结构相对简单，易于审查，降低了隐藏恶意代码的可能性。总体而言，该POC的投毒风险较低，但用户仍需保持警惕，防范潜在的恶意利用。

**项目地址:** https://github.com/vulhub/vulhub/tree/master/bash/shellshock

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
