## CVE-2014-6271 - GNU Bash 远程命令执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行(RCE)

**影响应用:** GNU Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** GNU Bash <= 4.3

**利用条件:** 取决于Bash的使用方式，如HTTP请求、SSH等，无需认证即可触发，但需要目标系统调用Bash处理相关请求。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock漏洞，是一个存在于GNU Bash shell中的严重安全漏洞。攻击者可以利用此漏洞，通过构造特定的环境变量，在目标系统上执行任意命令。该漏洞影响广泛，包括Linux和Unix系统，以及与Bash交互的各种应用程序，如HTTP、FTP、DHCP等。 

POC有效性分析：提供的Python POC代码通过设置恶意的HTTP头（User-Agent、Referer、Cookie）来触发Shellshock漏洞。它首先检查目标系统是否存在漏洞，如果存在，则允许攻击者输入命令并在目标系统上执行。POC通过发送包含特定格式的字符串的HTTP请求，该字符串利用了Bash解析环境变量的缺陷，从而执行注入的命令。 

利用步骤：
1.  运行POC脚本，指定目标URL。
2.  脚本首先尝试检测目标是否存在Shellshock漏洞，通过发送包含特定字符串的HTTP请求，检查响应中是否包含该字符串。
3.  如果检测到漏洞，脚本进入交互模式，允许攻击者输入要执行的命令。
4.  攻击者输入的命令被Base64编码，并通过恶意构造的HTTP头发送到目标系统。
5.  目标系统上的Bash解析HTTP头时，会执行注入的命令，并将结果返回给攻击者。

投毒风险分析：
该POC的投毒风险较低，约为10%。
1. 代码清晰，主要功能是利用Shellshock漏洞执行命令，没有明显的恶意行为。
2.  使用了标准库（requests、base64等），没有引入外部的、未知的依赖。
3.  虽然使用了base64编码，但这是为了传输命令，并非为了隐藏恶意代码。 
4.  POC中使用的BASE64_PATH变量默认指向/usr/bin/base64，如果攻击者修改该变量指向其他恶意程序，则可能存在风险。该风险较低，因为需要修改POC代码。
5. 该POC未包含任何后门代码或者其他恶意payload，主要用于验证漏洞的存在以及执行用户指定的命令。
6. 该脚本交互部分具有一定风险，如果利用该脚本获得服务器权限后植入后门程序，将造成更大的危害，但这不属于POC本身投毒风险评估范围。

**项目地址:** https://github.com/vulnwatchdog/a13d0d8df10df7fc70d0e1fd9e8745e8

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
