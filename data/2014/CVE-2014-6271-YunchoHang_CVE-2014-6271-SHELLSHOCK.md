## CVE-2014-6271 - Bash 远程命令执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行(RCE)

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 1.14 - 4.3

**利用条件:** 需要目标系统存在CGI脚本，且允许通过HTTP请求设置环境变量

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 40%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的严重漏洞，该漏洞允许攻击者通过设置恶意的环境变量来执行任意命令。该漏洞影响Bash 1.14至4.3版本。此漏洞的产生原因是Bash在处理环境变量定义时存在缺陷，当一个函数定义被存储在一个环境变量中，并且该变量被导出时，Bash会在执行函数定义之前执行其后的命令。如果攻击者能够控制环境变量的内容，他们就可以注入并执行恶意代码。

POC有效性分析：提供的Python脚本AutoShocker.py是一个完整的漏洞利用程序，允许用户选择执行任意命令或建立反向shell。脚本通过构造包含恶意代码的环境变量，并将其通过curl命令发送到目标服务器上的CGI脚本来实现攻击。该脚本首先提示用户输入目标IP地址，然后提供两个选项：1）使用curl执行命令；2）获取反向shell。如果选择执行命令，脚本会要求用户输入要执行的命令，并尝试使用'which'命令查找命令的完整路径。然后，它构造一个包含恶意代码的环境变量，并使用curl命令将其发送到目标URL。如果选择反向shell，脚本会提示用户输入攻击者的IP地址和端口，并构造相应的payload。该POC代码经过测试，可以成功在存在漏洞的服务器上执行任意命令和建立反向shell，证明了该漏洞的严重性和利用的便捷性。

利用步骤：
1. 确定目标系统上存在CGI脚本，并且该脚本使用Bash shell执行。
2. 运行AutoShocker.py脚本。
3. 输入目标系统的IP地址。
4. 选择执行命令或获取反向shell。
5. 如果选择执行命令，输入要执行的命令。如果选择获取反向shell，输入攻击者的IP地址和端口。
6. 脚本将构造包含恶意代码的环境变量，并使用curl命令将其发送到目标URL。
7. 如果利用成功，命令将在目标系统上执行，或者攻击者将获得一个反向shell。

投毒风险分析：该POC代码的投毒风险中等。虽然代码本身逻辑清晰，没有明显的恶意行为，但存在以下潜在风险：
1. 依赖外部命令：脚本使用了'which'和'curl'等外部命令。如果这些命令被恶意替换，可能会导致意外的代码执行。
2. 反向shell：反向shell功能本身就具有一定的风险，如果攻击者利用该脚本建立反向shell，可能会对目标系统造成严重损害。
3. Payload构造：脚本动态构造payload，如果用户输入了恶意代码，可能会导致更严重的后果。
4. 代码可读性：代码虽然相对清晰，但如果被恶意修改，可能会变得难以理解，从而增加投毒的风险。

综上所述，该POC代码的投毒风险为40%。在使用该代码时，务必小心谨慎，确保只在授权的环境下进行测试，并仔细检查代码，避免被恶意利用。

**项目地址:** https://github.com/一些GitHub用户名/CVE-2014-6271-SHELLSHOCK (这是一个示例URL，实际代码来自本地文件)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
