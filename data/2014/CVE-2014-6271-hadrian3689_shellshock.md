## CVE-2014-6271 - Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 1.1 through 4.3

**利用条件:** 无需认证，可通过HTTP请求利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的命令注入漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。该漏洞影响Bash 1.1到4.3版本。POC有效性分析：提供的Python脚本是一个完整可用的漏洞利用程序，它可以利用Shellshock漏洞在目标系统上执行命令。该脚本通过构造包含恶意代码的HTTP请求头，然后将其发送到目标服务器。如果目标服务器运行的是受影响的Bash版本，并且使用了CGI脚本或其他调用Bash的方式，那么恶意代码将被执行。脚本提供了两种利用方式：反向shell和正向shell（通过mkfifo绕过防火墙）。利用步骤：1. 运行脚本：`python3 shellshock.py -t <目标URL> -lhost <攻击者IP> -lport <攻击者端口>`。2. 如果需要使用正向shell绕过防火墙，则使用`-fs`选项。3. 脚本将发送包含恶意代码的HTTP请求到目标服务器。4. 如果漏洞利用成功，攻击者将在指定的IP地址和端口上获得一个反向shell，或者可以通过创建的fifo管道执行命令。投毒风险分析：该POC脚本主要使用Python标准库，例如`requests`和`base64`。脚本本身没有明显的恶意行为，例如下载或执行其他程序。但是，需要注意的是，该脚本可以被用于在目标系统上执行任意命令，因此存在被用于恶意目的的风险。例如，攻击者可能会修改脚本，使其在成功利用漏洞后下载并执行恶意软件。此外，如果攻击者控制了脚本的运行环境，他们可能会通过修改脚本或添加额外的代码来引入恶意行为。总的来说，该POC脚本的投毒风险较低，但仍然需要保持警惕，并采取适当的安全措施来防止其被滥用。由于脚本逻辑清晰，只使用了标准库，没有发现可疑行为，因此投毒风险评定为低风险。

利用该漏洞，攻击者可以修改HTTP请求头，注入恶意的bash命令。当服务器处理这些请求时，如果服务器使用了Bash来处理这些请求（例如，通过CGI脚本），那么注入的命令就会被执行。这使得攻击者可以在服务器上执行任意代码，从而导致服务器被完全控制。该漏洞的利用非常简单，只需要发送一个特制的HTTP请求即可。因此，攻击复杂度较低。

该脚本没有混淆代码，使用了标准的Python库，功能明确，风险较低。因此，投毒风险百分比为15%。

**项目地址:** https://github.com/opsdisk/exploit-cve-2014-6271

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
