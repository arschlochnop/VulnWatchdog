## CVE-2014-6271 - Bash 远程命令执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行(RCE)

**影响应用:** Bash

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在Bash，且允许通过某些方式（例如HTTP请求头）传递环境变量。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的严重漏洞。该漏洞允许攻击者通过设置环境变量来执行任意命令。当Bash解析环境变量时，它会执行变量值中包含的命令，这使得攻击者能够注入恶意代码。攻击者可以利用该漏洞远程执行命令，获取系统控制权。该漏洞影响广泛，包括使用Bash作为默认shell的Linux和Unix系统，以及依赖Bash处理请求的Web服务器。通过分析提供的POC代码，可以确认漏洞的可利用性。POC中包含Python和Bash两种脚本，用于利用Shellshock漏洞。这些脚本通过构造包含恶意命令的HTTP请求头，发送到目标服务器。服务器上的Bash会解析这些请求头，执行其中的命令。利用步骤如下：1. 克隆POC代码仓库。2. 根据目标URL，使用Bash或Python脚本构造恶意请求。例如，使用Bash脚本：`bash shellshock.sh -u <url> -h <lhost> -p <lport>`，或者使用Python脚本：`python3 shellshock.py -u <url> -lh <lhost> -lp <lport>`。3. 如果只提供URL，脚本将执行RCE；如果提供lhost和lport，脚本将尝试建立反向shell。该漏洞的PoC质量很高，提供了完整的利用方式，可以快速验证漏洞的存在。攻击复杂度较低，只需要一个简单的HTTP请求即可触发漏洞。关于投毒风险，该POC代码主要利用了系统自身的bash程序，没有发现明显的恶意代码或后门。虽然脚本可以执行任意命令，但这是漏洞本身所允许的，而不是POC代码引入的恶意行为。脚本依赖于curl和requests等标准库，没有发现外部脚本或可疑请求。然而，由于该漏洞可能被用于执行恶意命令，因此存在一定的投毒风险。例如，攻击者可能修改脚本，添加额外的恶意功能，或者使用该脚本攻击其他系统。但总体来说，该POC的投毒风险较低。

**项目地址:** https://github.com/Gurguii/shellshock.sh

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
