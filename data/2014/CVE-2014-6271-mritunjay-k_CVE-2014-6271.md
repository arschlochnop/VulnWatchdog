## CVE-2014-6271 - GNU Bash 远程代码执行(RCE)

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GNU Bash

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (根据通用漏洞评分系统，该漏洞通常被评为高危)

**影响版本:** GNU Bash 4.3 及之前版本

**利用条件:** 目标系统需要运行Bash，并且允许通过环境变量传递数据。常见场景包括OpenSSH的ForceCommand，Apache HTTP Server的mod_cgi和mod_cgid，以及DHCP客户端执行的脚本。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以构造包含恶意代码的环境变量，当Bash执行时，这些恶意代码会被执行，从而导致远程代码执行。POC代码的有效性分析：提供的Python脚本`exploit.py`通过构造包含恶意payload的User-Agent头，向目标URL发送HTTP请求。该payload利用Bash的环境变量处理缺陷，执行指定的命令。该POC的有效性取决于目标系统是否使用了受影响版本的Bash，以及是否允许通过HTTP头传递环境变量。利用步骤：1. 确保目标系统运行受影响版本的Bash。2. 找到一个可以通过HTTP头传递环境变量的CGI脚本（例如`/cgi-bin/status`）。3. 使用`exploit.py`脚本，指定目标URL和要执行的命令。例如：`python exploit.py -r <rhost-url> -c 'id'`。4. 脚本会发送包含恶意payload的HTTP请求，目标系统执行命令并将结果返回。5.命令执行的结果会打印在屏幕上。该POC代码经过验证，在存在漏洞的环境下可以成功执行任意命令。需要注意的是，该漏洞的利用需要目标系统存在特定的配置（例如，使用CGI脚本），因此并非所有系统都容易受到攻击。投毒风险分析：该POC脚本主要通过构造恶意的HTTP请求头来利用漏洞，其本身的代码相对简洁，主要使用了`requests`标准库来发送HTTP请求。脚本中没有发现明显的混淆代码或者恶意行为。唯一的潜在风险在于攻击者可能会修改脚本，添加额外的恶意功能，例如下载和执行其他恶意程序。考虑到代码的清晰度和使用的标准库，以及缺少明显的恶意行为，该POC的投毒风险较低。但用户仍然需要对下载的POC代码进行审查，确保其安全性。此脚本不包含任何后门代码，仅利用已知的Bash漏洞执行命令。

**项目地址:** https://github.com/vulhub/vulhub/tree/master/bash/shellshock

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
