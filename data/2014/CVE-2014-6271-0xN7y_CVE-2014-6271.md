## CVE-2014-6271 - Bash 命令注入

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** Bash

**危害等级:** 高危

**CVSS评分:** 10.0

**影响版本:** 1.14.x to 4.3

**利用条件:** 需要网络访问，取决于Bash的使用场景

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于Bash shell中的严重漏洞，允许攻击者执行任意命令。该漏洞源于Bash处理环境变量的方式，特别是当这些环境变量包含函数定义时。当Bash接收到一个以函数定义开头的环境变量时，它会在执行函数定义之前执行函数定义之后的命令。这使得攻击者可以通过构造恶意环境变量来注入和执行任意命令。

POC有效性分析：提供的POC代码是一个Python脚本，它利用了Shellshock漏洞。脚本接受两个参数：目标主机和要执行的命令。它通过构造一个包含恶意函数定义的HTTP请求头，然后将其发送到目标主机。如果目标主机上的Bash易受攻击，它将执行请求头中嵌入的命令。

利用步骤：
1.  使用提供的Python脚本，指定目标主机和要执行的命令。
2.  运行脚本，脚本将发送包含恶意函数定义的HTTP请求头到目标主机。
3.  如果目标主机易受攻击，它将执行命令。
4.  攻击者可以通过命令执行来获取敏感信息、修改系统配置或执行其他恶意操作。

投毒风险分析：该POC代码主要功能是利用已知的Shellshock漏洞执行命令，本身没有明显的恶意行为，比如下载恶意文件或执行破坏性操作。脚本使用了requests库发送HTTP请求，以及sys库处理命令行参数，均为标准库。代码相对清晰，易于理解，没有发现混淆或加密。考虑到其功能是利用远程命令执行漏洞，存在被滥用的风险，例如被修改为执行恶意命令或传播恶意软件，因此存在一定的投毒风险。例如，攻击者可能修改脚本，使其在成功利用漏洞后，下载并执行恶意payload。此外，如果该POC被用于扫描大量目标，可能会对目标系统造成拒绝服务。
综上，该POC代码的投毒风险较低，约为10%。

**项目地址:** N/A (代码直接提供)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2014-6271
