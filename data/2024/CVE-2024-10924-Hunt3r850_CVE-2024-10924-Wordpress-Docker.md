## CVE-2024-10924 - Really Simple Security (Free, Pro, and Pro Multisite) plugins for WordPress 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) plugins for WordPress

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 需要目标网站启用双因子验证 (2FA) 功能（默认禁用），且攻击者需知道目标用户的 ID。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC提供了一个完整的Docker化测试环境，极大地降低了复现难度。通过分析README和配置文件，该漏洞源于Really Simple Security插件在处理REST API的双因子验证（2FA）请求时，其check_login_and_get_user函数存在严重的逻辑错误。具体而言，当API请求中缺乏必要的验证参数或处理特定错误响应时，程序未能正确中断流程，反而因逻辑直通导致返回了有效的用户认证凭据。利用步骤：1. 部署提供的Docker环境，启动WordPress及MySQL实例。2. 进入WordPress后台安装并激活受影响版本的Really Simple Security插件，并开启2FA功能。3. 攻击者通过构造恶意的REST API请求（针对 /wp-json/really-simple-security/v1/two_factor 端点），并在请求参数中包含目标用户ID（如admin的ID通常为1）。4. 插件在处理该请求时，由于异常处理不当，会绕过正常的认证逻辑直接通过check_login_and_get_user函数验证用户身份。5. 攻击者将获得该用户的登录Cookie，从而实现以管理员身份登录。此POC不仅包含了环境搭建脚本，还提供了演示视频，证实了利用链的完整性和高效性，在野外环境下具有极高的威胁。 投毒风险分析：经过对提供的POC代码（Dockerfile、docker-compose.yml、entrypoint.sh）进行详细审查，未发现恶意混淆或后门植入行为。代码库主要基于标准的开源镜像（wordpress:latest, mysql:5.7）和官方的WP-CLI工具。所有的脚本操作如wp core download、wp config create均属于标准的WordPress自动化安装流程。虽然Dockerfile中包含了从外部GitHub地址下载wp-cli.phar的操作，但该地址为官方仓库（wp-cli/builds），属于受信任的源。脚本中不存在eval、base64编码的隐藏payload或向不明IP发送心跳包的逻辑。整体而言，该仓库是一个纯粹的防御性安全研究工具包，用于漏洞复现和验证，投毒风险极低。但研究人员在使用此类包含复杂Shell脚本的项目时，仍建议在隔离的沙箱环境或虚拟机中运行，并检查环境变量中是否存在异常的凭据泄露风险。

**项目地址:** [https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker.git](https://www.google.com/search?q=https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2024-10924](https://nvd.nist.gov/vuln/detail/cve-2024-10924)
