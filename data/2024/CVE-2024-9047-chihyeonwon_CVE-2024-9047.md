# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-chihyeonwon_CVE-2024-9047.md](../2024/CVE-2024-9047-chihyeonwon_CVE-2024-9047.md)

# CVE-2024-9047

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md](../2024/CVE-2024-9047-Nxploited_CVE-2024-9047-Exploit.md)

## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œä»»æ„æ–‡ä»¶åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº† WordPress File Upload æ’ä»¶ï¼Œç‰ˆæœ¬å°äºç­‰äº4.24.11ï¼Œä¸”è¿è¡Œåœ¨ PHP 7.4 æˆ–æ›´æ—©ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047 å­˜åœ¨äº WordPress File Upload æ’ä»¶çš„ wfu_file_downloader.php æ–‡ä»¶ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚ä¸­çš„ `file` å‚æ•°ï¼Œä½¿å…¶åŒ…å«è¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰ï¼Œä»è€Œçªç ´æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ HTTP POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
2.  è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„cookiesï¼Œå…¶ä¸­åŒ…å«äº†éœ€è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰å……åˆ†éªŒè¯ `file` å‚æ•°ï¼Œå¯¼è‡´è·¯å¾„éå†æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ WordPress çš„é…ç½®æ–‡ä»¶ `wp-config.php`ï¼Œä»è€Œè·å–æ•°æ®åº“å‡­æ®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç ç»éªŒè¯æœ‰æ•ˆï¼Œèƒ½å¤Ÿè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚PoC ä»£ç é¦–å…ˆæ£€æŸ¥ç›®æ ‡ç«™ç‚¹æ˜¯å¦å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WordPress File Upload æ’ä»¶ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ `file` å‚æ•°çš„ POST è¯·æ±‚åˆ° `wfu_file_downloader.php`ï¼Œä»è€Œåˆ©ç”¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPoCä»£ç ä»“åº“ï¼Œå‘ç°README.mdæ–‡ä»¶å†…å®¹æ˜¯æ¼æ´çš„è¯¦ç»†è¯´æ˜å’Œåˆ©ç”¨æ­¥éª¤ï¼Œè„šæœ¬çš„åŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„URLå’Œcommandå‚æ•°å‘é€HTTPè¯·æ±‚ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯ä½œè€…å¯èƒ½ä¼šåœ¨åç»­ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå¼¹shellæˆ–è€…å…¶ä»–æ¶æ„è¡Œä¸ºã€‚åˆæ­¥ä¼°è®¡æŠ•æ¯’çš„å¯èƒ½æ€§åœ¨ 10% å·¦å³ã€‚


**é¡¹ç›®åœ°å€:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #2

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #3

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---



---

## POC #3

**æ¥æº**: [CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md](../2024/CVE-2024-9047-iSee857_CVE-2024-9047-PoC.md)

## CVE-2024-9047-WordPress File Upload-Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** WordPress File Upload

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** PHPç‰ˆæœ¬ <= 7.4

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-9047 æ˜¯ WordPress File Upload æ’ä»¶ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ `wfu_file_downloader.php` è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æ–‡ä»¶ï¼š**  `wfu_file_downloader.php`
2.  **æ¼æ´å‚æ•°ï¼š**  `file`ã€`ticket`ã€`handler`ã€`session_legacy`ã€`dboption_base`ã€`dboption_useold`ã€`wfu_cookie`
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†çš„ `wfu_cookie` å‚æ•°ï¼Œä¾‹å¦‚ `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   æ”»å‡»è€…å‘é€ç²¾å¿ƒè®¾è®¡çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php`ã€‚
    *   æœåŠ¡å™¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰çš„å†…å®¹ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š**  æä¾›çš„Pythonè„šæœ¬å°è¯•åˆ©ç”¨æ­¤æ¼æ´è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆå°è¯•ä» `release_notes.txt` æ–‡ä»¶ä¸­è·å–æ’ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬å°äºç­‰äº 4.24.11ï¼Œåˆ™å‘é€åŒ…å«æ¶æ„cookieçš„è¯·æ±‚ã€‚ å¦‚æœè¿”å›åŒ…å«`/bin/bash`å’Œ`root:x:0:0`è¯æ˜æ¼æ´å­˜åœ¨
5.  **æŠ•æ¯’é£é™©ï¼š**  ä»£ç æœªå‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ã€‚è¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ï¼Œå±äºå¸¸è§„æ¼æ´åˆ©ç”¨æ¨¡å¼ã€‚ä»£ç ä¸­æ£€æµ‹ç‰ˆæœ¬å·ï¼Œä»¥åŠè¯»å–ç‰¹å®šæ–‡ä»¶å†…å®¹æ¥åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ— å‘ç›®æ ‡ä¸»æœºå†™å…¥æ–‡ä»¶çš„è¡Œä¸ºã€‚å› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©è¾ƒä½ã€‚
6.  **åˆ©ç”¨å‰æï¼š** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´çš„ WordPress File Upload æ’ä»¶ï¼Œä¸”PHPç‰ˆæœ¬ä¸º7.4æˆ–æ›´ä½ã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

## POC #4

**æ¥æº**: [CVE-2024-9047-verylazytech_CVE-2024-9047.md](../2024/CVE-2024-9047-verylazytech_CVE-2024-9047.md)

## CVE-2024-9047 - WordPress File Uploadæ’ä»¶è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-9047

**æ¼æ´ç±»å‹:** è·¯å¾„éå† (Path Traversal)

**å½±å“åº”ç”¨:** WordPress File Uploadæ’ä»¶

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²æˆ–åˆ é™¤

**å½±å“ç‰ˆæœ¬:** <= 4.24.11

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„WordPress File Uploadæ’ä»¶ï¼Œä¸”è¿è¡Œåœ¨PHP 7.4æˆ–æ›´æ—©ç‰ˆæœ¬ä¸Šã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„WordPressç«™ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9047æ˜¯WordPress File Uploadæ’ä»¶ï¼ˆç‰ˆæœ¬<= 4.24.11ï¼‰ä¸­wfu_file_downloader.phpæ–‡ä»¶å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œè¯»å–æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚PoCä»£ç  `cve-2024-9047.sh` è„šæœ¬åˆ©ç”¨äº†`wfu_file_downloader.php` ä¸­çš„è·¯å¾„éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚åˆ©ç”¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥è„šæœ¬æœ¬èº«åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œé£é™©è¾ƒä½ã€‚æ£€æŸ¥äº† `cve-2024-9047.sh` è„šæœ¬ï¼Œ ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„çš„HTTPè¯·æ±‚åˆ° `wfu_file_downloader.php` ã€‚è¯¥è„šæœ¬æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`README.md` æ–‡ä»¶ä¹Ÿä¸»è¦æ˜¯æ¼æ´æè¿°å’Œä½¿ç”¨è¯´æ˜ï¼Œæœªå‘ç°å¯ç–‘å†…å®¹ã€‚ ä½†è€ƒè™‘åˆ°Githubä»“åº“å¯èƒ½è¢«ç¯¡æ”¹æˆ–æ›¿æ¢,æ‰€ä»¥å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œæ­¤é£é™©ä¸»è¦æ¥è‡ªä¸‹è½½äº†è¢«ç¯¡æ”¹çš„è„šæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ä½¿ç”¨Fofaç­‰æœç´¢å¼•æ“æŸ¥æ‰¾å®‰è£…äº†å—å½±å“ç‰ˆæœ¬WordPress File Uploadæ’ä»¶çš„ç½‘ç«™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†payloadçš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ° `wfu_file_downloader.php` æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `..` æ¥è·³å‡ºç›®å½•é™åˆ¶ï¼Œè®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚ `/etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚å¹¶è·å–æ–‡ä»¶å†…å®¹ï¼š**  æœåŠ¡å™¨åœ¨æœªè¿›è¡Œå……åˆ†éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ–‡ä»¶åˆ é™¤** ç”±äºæ¼æ´ä¹Ÿå¯ä»¥è¿›è¡Œæ–‡ä»¶åˆ é™¤,æ”»å‡»è€…å¯ä»¥å‘é€æ¶æ„è¯·æ±‚,åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶,é€ æˆæ‹’ç»æœåŠ¡æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)

---

