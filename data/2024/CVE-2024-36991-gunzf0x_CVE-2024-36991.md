# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **10** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-gunzf0x_CVE-2024-36991.md](../2024/CVE-2024-36991-gunzf0x_CVE-2024-36991.md)

# CVE-2024-36991

> ğŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md](../2024/CVE-2024-36991-Cappricio-Securities_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬ä¸ºå—å½±å“ç‰ˆæœ¬ã€‚éœ€è¦ç½‘ç»œè®¿é—®SplunkæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ `**/modules/messaging/**` ç«¯ç‚¹æ„é€ æ¶æ„è¯·æ±‚ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“Splunk Enterpriseçš„9.2.2ä¹‹å‰çš„9.2ç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„9.1ç‰ˆæœ¬ä»¥åŠ9.0.10ä¹‹å‰çš„9.0ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„URLï¼Œå‘é€åˆ° `/modules/messaging/` ç«¯ç‚¹ã€‚
2.  Splunk Enterprise æ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–è¿‡æ»¤è¾“å…¥ï¼Œå¯¼è‡´å¯ä»¥è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æœåŠ¡å™¨è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œæ—¨åœ¨æ‰«æå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚è„šæœ¬åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

*   **URLæ‰«æï¼š** å…è®¸æ‰«æå•ä¸ªURLï¼Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚
*   **æ‰¹é‡æ‰«æï¼š** å…è®¸ä»æ–‡ä»¶ä¸­è¯»å–URLåˆ—è¡¨ï¼Œè¿›è¡Œæ‰¹é‡æ‰«æã€‚
*   **Telegramé€šçŸ¥ï¼š** å¯ä»¥é…ç½®Telegram Botï¼Œåœ¨å‘ç°æ¼æ´æ—¶å‘é€é€šçŸ¥ã€‚
*   **æ–‡ä»¶è¯»å–ï¼š** é€šè¿‡æ„é€ payloadè¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œè¯¥POCå…·å¤‡æ¼æ´éªŒè¯å’Œåˆ©ç”¨çš„èƒ½åŠ›ï¼Œå› æ­¤åˆ¤å®šä¸ºæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­ `includes/bot.py` åŒ…å«å‘è¿œç¨‹æœåŠ¡å™¨å‘é€æ•°æ®çš„ä»£ç æ®µï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

è¿™é‡Œï¼Œ`const.Data.api` å®šä¹‰äº†ç”¨äºå‘é€æ¼æ´ä¿¡æ¯çš„APIç«¯ç‚¹ã€‚`const.Data` çš„å…·ä½“å†…å®¹éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼Œä»¥ç¡®è®¤æ˜¯å¦å­˜åœ¨æ¶æ„ç«¯ç‚¹ã€‚ç”¨æˆ·é…ç½®çš„ `chatid` ä¹Ÿä¼šè¢«å‘é€ï¼Œå¦‚æœ `const.Data.api` è¢«æ¶æ„æ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·éšç§æ³„éœ²ã€‚
`configure.get_chatid()`å‡½æ•°ä¹Ÿéœ€è¦å®¡æŸ¥ï¼Œç¡®å®šå…¶è¡Œä¸ºæ˜¯å¦å®‰å…¨ã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªåº“æœ¬èº«çš„åŠŸèƒ½æ˜¯å®ç°æ¼æ´çš„åˆ©ç”¨ï¼Œå¹¶æŠŠç»“æœé€šçŸ¥ç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿æ¼æ´æŒ–æ˜ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æ½œåœ¨é£é™©ï¼Œä½†è¯¥POCçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼æ´æ‰«æå’ŒéªŒè¯ã€‚å¹¶æ²¡æœ‰å‘ç°ç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç æˆ–ç ´åç³»ç»Ÿçš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**é¡¹ç›®åœ°å€:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #2

**æ¥æº**: [CVE-2024-36991-Mr-xn_CVE-2024-36991.md](../2024/CVE-2024-36991-Mr-xn_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š9.2.x (ä½äº 9.2.2), 9.1.x (ä½äº 9.1.5), 9.0.x (ä½äº 9.0.10)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `/modules/messaging/` æ¥å£ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¾ç¤ºäº†æ„é€ åŒ…å« `C:../` åºåˆ—çš„ URL æ¥è¿›è¡Œè·¯å¾„éå†çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº† Python `os.path.join` å‡½æ•°åœ¨å¤„ç† Windows è·¯å¾„æ—¶çš„ç‰¹æ€§ï¼Œå³å¦‚æœåç»­è·¯å¾„ç‰‡æ®µä¸­åŒ…å«é©±åŠ¨å™¨å·ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰æ„å»ºè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å·éƒ¨åˆ†ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­åŒ…å« LICENSEã€README.md æ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Splunk Enterprise æœåŠ¡å™¨æ­£åœ¨è¿è¡Œå—å½±å“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šã€‚
2.  æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„ URLï¼Œä¾‹å¦‚ï¼š`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` æˆ– `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` ã€‚
3.  å‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ„é€ çš„ HTTP GET è¯·æ±‚ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¢«è¯·æ±‚æ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Splunk é»˜è®¤è¿è¡Œæƒé™ï¼Œå¯èƒ½åªèƒ½è¯»å–éƒ¨åˆ†æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #3

**æ¥æº**: [CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md](../2024/CVE-2024-36991-TcchSquad_CVE-2024-36991-Tool.md)

## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Windowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿä¸ºWindowsæ“ä½œç³»ç»Ÿï¼Œä¸”è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œå¹¶å¯é€šè¿‡ç½‘ç»œè®¿é—®/modules/messaging/ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå½±å“Splunk Enterpriseåœ¨Windowsä¸Šçš„è·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ¼æ´å­˜åœ¨äº/modules/messaging/ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚`../`ï¼‰çš„æ¶æ„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„POCä»£ç å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯githubä¸Šçš„é“¾æ¥ï¼‰ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡å‘é€ç‰¹åˆ¶çš„curlè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„Splunkå®ä¾‹ï¼Œèƒ½å¤Ÿæ£€ç´¢æ•æ„Ÿæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

POCä»£ç æœ¬èº«çš„åŠŸèƒ½æè¿°ä¸ºä»ç›®æ ‡ä¸»æœºæ‹‰å–æ–‡ä»¶ï¼Œå¹¶æ— å‘ç°ç›´æ¥çš„åé—¨ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

1.  **æ¶æ„æ–‡ä»¶ç›®æ ‡ï¼š**  POCçš„ç¬¬4/5 section å¯ä»¥è®¾ç½®ä¸“é—¨æ‹‰å–splunkç³»ç»Ÿä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶,å¦‚æœæ”»å‡»è€…ä¼ªé€ splunk äºŒè¿›åˆ¶æ–‡ä»¶æˆ–splunkç›¸å…³ç»„ä»¶,ä¼šå¯¼è‡´splunkç³»ç»Ÿè¢«æ›¿æ¢æ¶æ„ç»„ä»¶,å¯¼è‡´åé—¨ã€‚
2.  **ä¾èµ–åŒ…æŠ•æ¯’ï¼š** è™½ç„¶ç›®å‰POCæ²¡æœ‰å‘ç°ä¾èµ–åŒ…ï¼Œä½†åç»­ä½¿ç”¨è€…å¯èƒ½å¼•å…¥æ¶æ„çš„ä¾èµ–åŒ…ã€‚
3.  **Payloadä¿®æ”¹ï¼š**  æ”»å‡»è€…åœ¨åˆ†å‘POCæ—¶ï¼Œå¯èƒ½ä¼šä¿®æ”¹è¯·æ±‚çš„payloadï¼Œä¾‹å¦‚å¢åŠ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„åŠŸèƒ½ï¼ˆè™½ç„¶ç›®å‰ä»£ç ä¸å…·å¤‡ï¼Œä½†å¯ä»¥è½»æ˜“æ·»åŠ ï¼‰ã€‚

åŸºäºä»¥ä¸Šï¼Œæˆ‘è¯„ä¼°è¯¥ä»“åº“å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **ç›®æ ‡ç¡®å®šï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Splunk Enterpriseå®ä¾‹çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆWindowsç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼Œæ„é€ åŒ…å«è·¯å¾„éå†å­—ç¬¦çš„HTTP GETè¯·æ±‚ï¼Œå‘é€åˆ°/modules/messaging/ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼š
    `https://vulnerable-splunk.com/modules/messaging/../../../../windows/win.ini`
3.  **æ–‡ä»¶è¯»å–ï¼š**  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒSplunk Enterpriseå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
4.  **æ•æ„Ÿä¿¡æ¯æå–ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼Œå¦‚web.confï¼ˆå¯èƒ½åŒ…å«ç®¡ç†å‘˜å‡­æ®ï¼‰ï¼Œsplunk.secretï¼ˆç”¨äºåŠ å¯†splunkå†…éƒ¨æ•°æ®ï¼‰ï¼Œä»¥åŠå…¶ä»–å¯èƒ½åŒ…å«å¯†é’¥æˆ–å¯†ç çš„æ–‡ä»¶ã€‚
5.  **æƒé™æå‡/æ¨ªå‘ç§»åŠ¨ï¼š** è·å–çš„å‡­æ®æˆ–å¯†é’¥å¯ç”¨äºè¿›ä¸€æ­¥æå‡æƒé™æˆ–åœ¨å†…ç½‘è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TcchSquad/CVE-2024-36991-Tool](https://github.com/TcchSquad/CVE-2024-36991-Tool)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #4

**æ¥æº**: [CVE-2024-36991-Zin0D_CVE-2024-36991.md](../2024/CVE-2024-36991-Zin0D_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Splunk Enterpriseçš„/modules/messaging/ endpoint

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsä¸Šçš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå½±å“9.2.2ã€9.1.5å’Œ9.0.10ä¹‹å‰çš„ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`/modules/messaging/`ç«¯ç‚¹æ‰§è¡Œè·¯å¾„éå†ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚SonicWallçš„åšå®¢å’ŒWiz.ioçš„æ•°æ®åº“æ¡ç›®éƒ½å¼ºè°ƒäº†è¯¥æ¼æ´çš„ä¸¥é‡æ€§ï¼Œå¹¶å»ºè®®å°½å¿«ä¿®è¡¥ã€‚Foregenixæåˆ°æ‰‹åŠ¨æ¸—é€æµ‹è¯•å¯ä»¥å‘ç°è‡ªåŠ¨æ‰«æå™¨é—æ¼çš„æ¼æ´ï¼Œè€ŒAPTORIå¼ºè°ƒè¾“å…¥éªŒè¯å¯¹äºé˜²æ­¢æ­¤ç±»æ”»å‡»çš„é‡è¦æ€§ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å®é™…ä¸Šæ˜¯GNU GPL v3çš„è®¸å¯è¯æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«ã€‚è¿™è¡¨æ˜æä¾›çš„ä»£ç ä»“åº“å¯èƒ½ä¸åŒ…å«çœŸæ­£çš„æ¼æ´åˆ©ç”¨ç¨‹åºï¼Œæˆ–è€…æ¼æ´åˆ©ç”¨ä»£ç åœ¨å…¶ä»–ä½ç½®ã€‚

ç”±äºæä¾›çš„ä»£ç ä¸æ˜¯å®é™…çš„POCï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`../`åºåˆ—çš„æ¶æ„è·¯å¾„ï¼Œä»è€Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ç”±äºæä¾›çš„ä»£ç å¹¶éPOC,ä¸”ä»…åŒ…å«åè®®è¯´æ˜æ–‡ä»¶,æ‰€ä»¥æŠ•æ¯’é£é™©ä¸º0%ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLå‘é€åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨æœªå……åˆ†è¿‡æ»¤çš„è·¯å¾„å‚æ•°æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [Zin0D/CVE-2024-36991](https://github.com/Zin0D/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #5

**æ¥æº**: [CVE-2024-36991-bigb0x_CVE-2024-36991.md](../2024/CVE-2024-36991-bigb0x_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise on Windows-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise on Windows

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® Splunk Enterprise çš„/modules/messaging/ ç«¯å£

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterprise on Windowsç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è·¯å¾„ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“9.2.2ä¹‹å‰çš„æ‰€æœ‰9.2.xç‰ˆæœ¬ï¼Œ9.1.5ä¹‹å‰çš„æ‰€æœ‰9.1.xç‰ˆæœ¬ï¼Œä»¥åŠ9.0.10ä¹‹å‰çš„æ‰€æœ‰9.0.xç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ã€‚
2.  æ¶æ„è·¯å¾„åˆ©ç”¨`../`åºåˆ—å°è¯•è·³å‡ºé¢„æœŸçš„ç›®å½•ã€‚
3.  å¦‚æœè·¯å¾„éå†æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼ŒPOCä»£ç ä¸­ä½¿ç”¨çš„payloadæ˜¯`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ï¼Œè¯¥payloadå°è¯•è¯»å–Windowsç³»ç»Ÿçš„`/etc/passwd`æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†è·¯å¾„éå†æ¼æ´è¯»å–`/etc/passwd`æ–‡ä»¶ï¼Œå¦‚æœèƒ½æˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ‰§è¡Œæ¼æ´éªŒè¯å’Œåˆ©ç”¨ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ã€‚ ä»£ç ä¸­å­˜åœ¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯èƒ½ä¼šæ³„éœ²æ‰«æç›®æ ‡ã€‚ç†è®ºä¸Šï¼Œä½œè€…å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ï¼š

*   **æ•°æ®å›ä¼ ï¼š**  å°†æ‰«æç»“æœï¼ˆåŒ…æ‹¬å­˜åœ¨æ¼æ´çš„ä¸»æœºåˆ—è¡¨å’Œè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
*   **åå¼¹shellï¼š**  å°è¯•åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼Œä¾‹å¦‚åå¼¹shellã€‚
*   **æ¤å…¥åé—¨ï¼š**  ä¿®æ”¹ç›®æ ‡ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶æˆ–å®‰è£…æ¶æ„è½¯ä»¶ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ç›®æ ‡ä¸»æœºã€‚
è™½ç„¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜å­˜åœ¨æŠ•æ¯’ä»£ç ï¼Œä½†ä»¥ä¸‹å› ç´ å¢åŠ äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼šä»£ç æ¥è‡ªä¸ªäººå¼€å‘è€…ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ã€‚ä»£ç ä½¿ç”¨äº†`requests`åº“ï¼Œå­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½, ä½†æ¦‚ç‡è¾ƒä½ï¼Œ ä¼°è®¡åœ¨10%å·¦å³ã€‚ ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®åœ¨ä½¿ç”¨POCä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œç¡®ä¿ä»£ç çš„å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #6

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #7

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---



---

## POC #7

**æ¥æº**: [CVE-2024-36991-jaytiwari05_CVE-2024-36991.md](../2024/CVE-2024-36991-jaytiwari05_CVE-2024-36991.md)

## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä¸ºWindowsï¼Œä¸”è¿è¡Œå—å½±å“çš„Splunk Enterpriseç‰ˆæœ¬ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®Splunk WebæœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-36991æ˜¯ä¸€ä¸ªå­˜åœ¨äºSplunk Enterprise on Windowsä¸­çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`/modules/messaging/`ç«¯ç‚¹ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„URLï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œæœç´¢ç»“æœä¸­åŒ…å«å¤šä¸ªéªŒè¯äº†è¯¥æ¼æ´çš„é¡µé¢ï¼ŒåŒ…æ‹¬PoCä»£ç çš„GitHubä»“åº“ã€‚æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒé€šè¿‡æ„é€ åŒ…å«è·¯å¾„éå†åºåˆ—çš„URLæ¥åˆ©ç”¨æ¼æ´ï¼Œä»è€Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„Pythonä»£ç ï¼ˆexploit.pyï¼‰ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚ï¼Œä»¥ä¸‹æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼š
*   **æ˜ç¡®çš„åŠŸèƒ½ï¼š** è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨curlå‘½ä»¤å‘èµ·HTTPè¯·æ±‚ï¼Œåˆ©ç”¨è·¯å¾„éå†æ¼æ´è¯»å–æ–‡ä»¶ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ˜ç¡®çš„ï¼Œä¸”ä¸æ¼æ´æè¿°ç›¸ç¬¦ã€‚
*   **ç½‘ç»œè¯·æ±‚ï¼š** è„šæœ¬ä½¿ç”¨äº†`curl`å‘½ä»¤å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†`curl`å‘½ä»¤æœ¬èº«åªæ˜¯ç”¨æ¥å‘é€HTTPè¯·æ±‚ï¼Œè¯·æ±‚å†…å®¹ç”±è„šæœ¬æ§åˆ¶ã€‚åªè¦è„šæœ¬ä¸­æ²¡æœ‰éšè—çš„æ¶æ„URLæˆ–payloadï¼Œé£é™©è¾ƒä½ã€‚
*   **å‚æ•°åŒ–ï¼š** è„šæœ¬ä½¿ç”¨äº†å‚æ•°åŒ–ï¼Œä¾‹å¦‚ `-u` è®¾ç½®URLï¼Œ`-s` è®¾ç½®è¯»å–çš„æ•æ„Ÿä¿¡æ¯åŒºæ®µã€‚è¿™å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ï¼Œé™ä½æ¶æ„ä»£ç éšè—çš„æ¦‚ç‡ã€‚
*   **ä¾èµ–ï¼š** è„šæœ¬ä¾èµ– `curl` å‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§ä¸”å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨ã€‚

è€ƒè™‘åˆ°ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸”ä¸»è¦ä¾èµ–å¤–éƒ¨å‘½ä»¤ `curl` å®Œæˆç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥åˆ¤æ–­è®¤ä¸ºï¼Œæ­¤ä»“åº“å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œåœ¨Windowsä¸Šçš„Splunk Enterpriseå®ä¾‹çš„URLã€‚
2.  **é€‰æ‹©ç›®æ ‡æ–‡ä»¶ï¼š** é€‰æ‹©è¦è¯»å–çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…é€‰æ‹©è„šæœ¬ä¸­é¢„å®šä¹‰çš„sectionï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«å¯†ç çš„æ–‡ä»¶ï¼‰ã€‚
3.  **è¿è¡Œæ¼æ´åˆ©ç”¨ä»£ç ï¼š** è¿è¡Œæä¾›çš„Pythonè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡URLå’Œè¦è¯»å–çš„sectionã€‚
4.  **åˆ†æç»“æœï¼š** è„šæœ¬ä¼šè¾“å‡ºè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…å¯ä»¥åˆ†æè¿™äº›å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç æˆ–å…¶ä»–é…ç½®ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #8

**æ¥æº**: [CVE-2024-36991-sardine-web_CVE-2024-36991.md](../2024/CVE-2024-36991-sardine-web_CVE-2024-36991.md)

## CVE-2024-36991-Splunk Enterprise-è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”æ”»å‡»è€…å¯ä»¥è®¿é—® /modules/messaging/ æ¥å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ä¸€ä¸ª Splunk Enterprise on Windows å¹³å°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Splunk Enterprise on Windows ç‰ˆæœ¬ä½äº 9.2.2ã€9.1.5 å’Œ 9.0.10 çš„ç‰ˆæœ¬ã€‚æ¼æ´å­˜åœ¨äº `/modules/messaging/` æ¥å£ã€‚æä¾›çš„Nucleiæ¨¡ç‰ˆPOCä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„URLï¼Œè®¿é—®`/etc/passwd`æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„POCä»£ç å†…å®¹ï¼Œè¯¥ä»“åº“ä¸­æ²¡æœ‰å‘ç°ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚åˆ°`/modules/messaging/`ç«¯ç‚¹ï¼Œåˆ©ç”¨è·¯å¾„éå†ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šå—é™çš„æ–‡ä»¶ã€‚

**æ€»ç»“åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡ç¡®è®¤ï¼š** ç¡®è®¤ç›®æ ‡ Splunk Enterprise æœåŠ¡è¿è¡Œåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸”ç‰ˆæœ¬å—æ¼æ´å½±å“ã€‚
2.  **æ„é€  Payloadï¼š** æ„é€ åŒ…å«å¤šä¸ª `../` çš„ URLï¼ŒæŒ‡å‘ç›®æ ‡æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** é€šè¿‡ HTTP GET æ–¹æ³•å°†æ„é€ å¥½çš„ URL å‘é€ç»™ Splunk Enterprise æœåŠ¡å™¨çš„ `/modules/messaging/` æ¥å£ã€‚
4.  **éªŒè¯ç»“æœï¼š** å¦‚æœè¿”å›çŠ¶æ€ç ä¸º 200ï¼Œä¸”å“åº”å†…å®¹åŒ…å«ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚ ç¤ºä¾‹ï¼š`/etc/passwd` æ–‡ä»¶åŒ…å« `root:x:0:0:root:/root:/bin/bash` æˆ– `admin:`ã€‚


**é¡¹ç›®åœ°å€:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #9

**æ¥æº**: [CVE-2024-36991-th3gokul_CVE-2024-36991.md](../2024/CVE-2024-36991-th3gokul_CVE-2024-36991.md)

## CVE-2024-36991 Splunk Enterprise on Windows è·¯å¾„éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶è¯»å–

**å½±å“ç‰ˆæœ¬:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991æ˜¯Splunk Enterpriseåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯å¾„éå†æ¼æ´ï¼Œå­˜åœ¨äº`/modules/messaging/`ç«¯ç‚¹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`../`çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥ä»£ç å¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æå’Œæ¼æ´åˆ©ç”¨ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸Šä¼ æ¶æ„æ–‡ä»¶æˆ–æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è™½ç„¶ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ç”¨äºæ£€æµ‹æ¼æ´ï¼Œä½†ä½¿ç”¨è€…å¦‚æœä»ä¸å¯ä¿¡çš„æ¥æºä¸‹è½½å¹¶ä½¿ç”¨ï¼Œå¯èƒ½é¢ä¸´å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  **æ„é€ æ¶æ„URL:** æ”»å‡»è€…æ„é€ åŒ…å«`../`åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`ã€‚
2.  **å‘é€HTTPè¯·æ±‚:** æ”»å‡»è€…å°†æ„é€ çš„URLå‘é€åˆ°å—å½±å“çš„Splunk Enterpriseå®ä¾‹ã€‚
3.  **è¯»å–æ–‡ä»¶:** å¦‚æœæ¼æ´å­˜åœ¨ä¸”åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚`win.ini`æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

æä¾›çš„POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€åŒ…å«è·¯å¾„éå†çš„HTTPè¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **æ¶æ„æ–‡ä»¶ä¸‹è½½/æ‰§è¡Œ:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œä»æŒ‡å®šURLä¸‹è½½æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚
*   **ä¿¡æ¯çªƒå–:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨æ‰«ææˆ–åˆ©ç”¨è¿‡ç¨‹ä¸­çªƒå–ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å·²å®‰è£…è½¯ä»¶åˆ—è¡¨ç­‰ã€‚
*   **åé—¨æ¤å…¥:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ¤å…¥åé—¨ï¼Œä»¥ä¾¿é•¿æœŸæ§åˆ¶ã€‚
*   **èµ„æºæ¶ˆè€—:** æ”»å‡»è€…å¯èƒ½ä¿®æ”¹ä»£ç ï¼Œå‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ‹’ç»æœåŠ¡ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶POCçš„ä¸»è¦åŠŸèƒ½æ˜¯æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨ï¼Œä½†ç”±äºä»£ç çš„å¼€æºæ€§ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹å’ŒäºŒæ¬¡åˆ†å‘ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚è€ƒè™‘åˆ°githubä»“åº“çš„ä»£ç ä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¹¶ä¸”ä½œè€…ä¹Ÿå£°æ˜äº†å…è´£å£°æ˜,æ‰€ä»¥åˆ¤æ–­æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

## POC #10

**æ¥æº**: [CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md](../2024/CVE-2024-36991-xploitnik_CVE-2024-36991-modified.md)

## CVE-2024-36991 - Splunk Enterprise Windows è·¯å¾„éå†

**æ¼æ´ç¼–å·:** CVE-2024-36991

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** Splunk Enterprise

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ã€é…ç½®ä¿¡æ¯ç­‰

**å½±å“ç‰ˆæœ¬:** Splunk Enterprise Windows ç‰ˆæœ¬ä½äº 9.2.2, 9.1.5, å’Œ 9.0.10

**åˆ©ç”¨æ¡ä»¶:** Splunk Enterprise WindowsæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-36991 æ˜¯ Splunk Enterprise åœ¨ Windows å¹³å°ä¸Šå‘ç°çš„è·¯å¾„éå†æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„URLï¼Œè®¿é—®`/modules/messaging/` æ¥å£ï¼Œå¹¶ä½¿ç”¨`../` åºåˆ—ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«æ¶æ„è·¯å¾„çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Splunk Enterprise å®ä¾‹çš„ `/modules/messaging/` ç«¯ç‚¹æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­æä¾›äº†å¤šä¸ªå¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬è®¤è¯æ–‡ä»¶ã€LDAPé…ç½®å’ŒæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¢åŠ äº†æ¼æ´åˆ©ç”¨çš„æˆåŠŸç‡ã€‚ æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä»£ç ä¸­åŒ…å«äº†å¤šä¸ªå·²çŸ¥splunké…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹è¿™äº›é…ç½®ï¼Œä¾‹å¦‚authentication.confæˆ–ldap.confï¼Œæ¥å®ç°åé—¨æˆ–æƒé™æå‡ã€‚

**é¡¹ç›®åœ°å€:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)

---

