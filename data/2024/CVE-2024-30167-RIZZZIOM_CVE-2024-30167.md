## CVE-2024-30167 - Atlona AT-OME-RX21 AV Switcher 命令注入 (Command Injection)

**漏洞编号:** CVE-2024-30167

**漏洞类型:** 命令注入 (Command Injection)

**影响应用:** Atlona AT-OME-RX21 AV Switcher

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Firmware versions <= 1.5.1

**利用条件:** 需要有效的认证凭据（默认账号 admin/Atlona 往往未修改）；需要网络访问目标设备的 Web 管理界面。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Atlona AT-OME-RX21 的时间配置接口中。根据提供的 POC 代码（Go 语言编写），攻击者可以通过在时间设置参数中注入 OS 命令来实现远程代码执行。代码展示了清晰的利用逻辑：首先利用提供的凭据（支持默认凭据）进行身份验证，随后向目标 URL 发送构造的 HTTP 请求，将命令注入到后台执行。该 POC 的有效性极高，因为它不仅包含了完整的注入向量，还实现了一个回显监听器（Reverse Shell/Response Listener），通过 -P 参数在本地开放端口接收命令执行结果。代码结构清晰，使用了 Go 标准库和常见网络库，能够直接编译运行。这种漏洞在 IoT 和 AV 设备中非常典型，由于后台缺乏对 shell 元字符的过滤，导致可以直接提权至 root。 利用步骤：1. 准备环境，使用 go build 编译 cve-2024-30167.exe；2. 确认目标 IP 地址及 Web 端口（默认通常为 80/443）；3. 执行 POC 命令，指定目标 URL (-t)、监听 IP (-l) 和端口 (-P) 以及待执行的命令 (-c)；4. POC 会自动处理登录会话，并向脆弱接口发送 payload；5. 攻击者在控制台即可看到以 root 权限执行的结果。 投毒风险分析：该 POC 来源于 GitHub 用户 RIZZZIOM。从代码片段分析，其逻辑透明且专注于漏洞复现。代码中虽然涉及了网络监听，但这是为了获取命令回显，属于合法的安全研究功能。然而，在实际下载和运行此类预编译二进制文件或从第三方仓库拉取代码时，仍存在低中度风险。首先，该工具支持执行任意命令，如果被恶意修改，可能会在执行攻击者指令的同时，在研究员的机器上静默安装后门（如在 init() 函数中加入恶意逻辑）。当前的 README 和代码片段显示其没有明显的混淆或外部恶意请求，因此判定投毒风险为 15%。建议安全从业者在隔离的沙箱环境中运行该 POC，或直接审计 Go 源代码后自行编译。鉴于此类漏洞针对的是专业视听设备，攻击者可能通过此类 POC 开发针对特定企业内网的蠕虫，风险点在于攻击脚本的自动化扩散能力而非 POC 本身包含恶意载荷。

**项目地址:** [https://github.com/RIZZZIOM/cve-2024-30167](https://www.google.com/search?q=https://github.com/RIZZZIOM/cve-2024-30167)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-30167](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2024-30167)
