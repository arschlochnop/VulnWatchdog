## CVE-2024-30167 - Atlona AT-OME-RX21 AV Switcher 命令注入 (Command Injection)

**漏洞编号:** CVE-2024-30167

**漏洞类型:** 命令注入 (Command Injection)

**影响应用:** Atlona AT-OME-RX21 AV Switcher

**危害等级:** CRITICAL

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8)

**影响版本:** Atlona AT-OME-RX21 (Time Configuration Interface)

**利用条件:** 需要有效的用户凭证进行认证 (Authenticated)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于Atlona AT-OME-RX21 AV切换器的时间配置界面（/cgi-bin/time.cgi）。根据提供的Go语言POC代码分析，漏洞源于对用户输入参数的处理不当，允许经过身份验证的攻击者通过构造恶意请求将操作系统命令注入到后台执行。POC代码逻辑清晰，通过HTTP POST请求将Base64编码的Payload发送至目标接口。代码中使用了标准的Go HTTP库和信号处理机制，展示了从建立监听器到发送利用载荷并接收回显的完整过程。该POC包含了自动化的Base64编码逻辑，用于规避简单的字符过滤，并尝试将命令执行结果回传至攻击者控制的监听地址。从代码成熟度来看，该工具具备极高的可用性，能够稳定复现root权限的命令执行。利用步骤：1. 准备一台可接收TCP连接的监听主机；2. 编译并运行Go程序，通过-t参数指定目标URL，-u和-p指定有效的Web管理凭证，-l和-P指定监听回传的IP与端口，-c指定待执行的命令；3. 程序将首先在本地启动临时HTTP服务器以接收回显，随后向目标发送恶意POST请求；4. 目标解析请求并在root权限下执行注入命令，结果通过网络回传。投毒风险分析：该POC代码表现出极低的投毒风险。通过对源码的静态审查，代码主要使用了Go标准库（如net/http, os, os/signal, encoding/base64），并未引入任何可疑的第三方依赖或经过混淆的二进制包。代码逻辑完全透明，主要功能集中在Payload构建和结果接收上，未发现隐藏的网络外发行为、自我复制逻辑或敏感信息窃取代码。POC库中的go.mod文件仅声明了模块路径，没有引入恶意的外部库。尽管包含了一个带有字符画的Banner，但这属于安全研究员常见的个性化签名，不具恶意。整体而言，该代码是一个纯粹的漏洞验证工具，不包含针对使用者环境的后门。在防御建议方面，组织应立即检查此类AV设备是否暴露于公网，并更新至厂商提供的最新补丁，同时限制对Web管理界面的访问源IP。

**项目地址:** [https://github.com/RIZZZIOM/CVE-2024-30167](https://www.google.com/search?q=https://github.com/RIZZZIOM/CVE-2024-30167)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-30167](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2024-30167)
