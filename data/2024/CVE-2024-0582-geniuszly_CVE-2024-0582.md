# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

# CVE-2024-0582

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0582-0ptyx_cve-2024-0582.md](../2024/CVE-2024-0582-0ptyx_cve-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权和拒绝服务

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，该漏洞存在于用户通过 IORING_REGISTER_PBUF_RING 注册buffer ring, mmap() 之后释放的情况下。

**有效性分析：**
提供的POC代码尝试利用此漏洞。`exp.c` 中的代码展示了注册 buffer ring, mmap 映射，可能存在释放后的访问。结合搜索结果中`ysanatomic/io_uring_LPE-CVE-2024-0582`项目以及`Mind the Patch Gap: Exploiting an io_uring Vulnerability in Ubuntu`文章，可以推断POC具有一定的有效性。

**投毒风险分析：**
分析提供的Makefile文件，脚本 `run_dbg.sh` 和C代码 `exp.c`, `test.c`，并未发现明显的恶意代码。
*   `Makefile` 只是编译exp和test程序。
*   `run_dbg.sh` 是一个qemu调试脚本，用于在虚拟机环境中运行和调试内核，方便利用，不存在投毒代码。
*   `exp.c` 通过 io_uring 接口注册、映射和释放 buffer ring，核心利用逻辑基于公开的漏洞信息。

但是，`PoC for CVE-2024-0582`代码中 `I will not be releasing a write-up for this vulnerability as my method of exploitation is almost the same as for CVE-2023-2598.` 这句话表明作者可能借鉴了之前的漏洞利用方法，为了增加成功率和绕过检测，作者可能隐藏了一些细节,因此有一定的投毒风险。总体风险较低,判断为10%。

**利用方式：**
1.  **注册 Buffer Ring：** 使用 `io_uring_register_buf_ring` 注册一个 buffer ring。
2.  **内存映射 (mmap)：** 使用 `mmap` 将注册的 buffer ring 映射到用户空间。
3.  **释放 Buffer Ring：** 触发漏洞，释放 buffer ring 后，在某些情况下可能仍然存在对该内存区域的访问。
4.  **Use-After-Free：**  利用释放后仍然存在的指针，执行恶意操作，例如修改其他内核数据结构，从而实现提权或拒绝服务。

总的来说，该漏洞利用需要对 io_uring 机制有一定的了解，并且需要根据具体的内核版本和配置进行调整。提供的PoC代码为本地提权漏洞利用提供了基础。

**项目地址:** [0ptyx/cve-2024-0582](https://github.com/0ptyx/cve-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #2

**来源**: [CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md](../2024/CVE-2024-0582-101010zyl_CVE-2024-0582-dataonly.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，对其进行 mmap() 操作，然后释放它时，可能出现此漏洞。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被公开披露，并且存在可用的利用代码。从提供的漏洞利用代码来看，该PoC利用data-only攻击方式，通过io_uring接口注册buffer ring，并尝试利用UAF漏洞修改文件系统相关的数据结构（`ext4_file_operations`），从而实现权限提升。

**投毒风险：**
尽管代码本身实现了利用 CVE-2024-0582 的功能，但仍存在一些潜在的投毒风险：

1.  **硬编码偏移量：** 代码中 `ext4_fops_offset` 是一个硬编码的偏移量。这个偏移量在不同的内核版本和配置下可能会有所不同。如果攻击者提供一个错误的偏移量，可能会导致系统崩溃，或者利用失败，从而误导用户。
2.  **后门用户：** 利用成功后，代码会向 `/etc/passwd` 文件添加一个后门用户。这种行为本身就是一种攻击行为，但如果攻击者修改后门用户的用户名或密码，可能会导致受害者难以发现并清除后门。
3.  **潜在的隐藏代码：** 虽然对提供的代码进行了分析，未发现明显的恶意代码，但仍不能排除作者在其他地方隐藏恶意代码的可能性，例如通过复杂的编译选项或外部依赖。

综合考虑，投毒风险评估为10%。主要风险在于硬编码偏移量的适配性和后门用户，以及潜在的未被发现的恶意代码。

**利用方式：**
1.  **漏洞触发：** 利用 io_uring 接口注册 buffer ring，触发 use-after-free 漏洞。
2.  **内存损坏：** 通过 UAF 漏洞，覆盖或修改内核内存中的关键数据结构。
3.  **权限提升：** 通过修改 `ext4_file_operations` 结构，劫持文件操作，实现权限提升，并向 `/etc/passwd` 文件添加后门用户。
4.  **清理或维持访问：** 攻击者可能会清理利用痕迹，或者通过后门用户长期维持对系统的访问。

**项目地址:** [101010zyl/CVE-2024-0582-dataonly](https://github.com/101010zyl/CVE-2024-0582-dataonly)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #3

**来源**: [CVE-2024-0582-geniuszly_CVE-2024-0582.md](../2024/CVE-2024-0582-geniuszly_CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个use-after-free 漏洞。该漏洞源于不当的 buffer ring 处理。攻击者可以通过注册一个 buffer ring，对其进行 mmap()，然后释放它来触发此漏洞。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞的POC是可用的。GitHub 上有相关的利用代码(ysanatomic/io_uring_LPE-CVE-2024-0582)。其他搜索结果也表明该漏洞已被公开讨论和分析(例如，Exodus Intelligence 的博客文章)。提供的C代码片段是POC的一部分，展示了如何设置和利用io_uring的buffer ring。

**投毒风险：**

由于提供的代码片段来自一个GitHub仓库，存在潜在的投毒风险。虽然代码本身看起来是针对该漏洞的利用，但是难以完全保证没有隐藏的恶意代码。考虑到代码可能被修改过，存在大约10%的投毒风险。这种风险通常包括添加后门，收集信息或执行其他恶意操作。 最好在使用前仔细审查所有代码，并从可信来源获取。

**利用方式：**

1.  **注册 buffer ring：**  攻击者使用 `IORING_REGISTER_PBUF_RING` 注册一个 buffer ring。
2.  **mmap()：**  注册的 buffer ring 被映射到用户空间。
3.  **释放：**  在 buffer ring 仍然被映射的情况下，释放该 buffer ring。
4.  **Use-After-Free：**  当内核尝试访问已释放的 buffer ring 时，会发生 use-after-free 漏洞。这可能允许攻击者覆盖内核内存，从而导致权限提升或系统崩溃。

提供的 C 代码片段展示了如何初始化 io_uring 实例，设置 buffer ring，并可能触发该漏洞。关键步骤包括使用 `io_uring_register_buf_ring` 注册 buffer ring 和使用 `mmap` 映射该 ring。

**项目地址:** [geniuszly/CVE-2024-0582](https://github.com/geniuszly/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---



---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---



---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---



---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---



---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---



---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---



---

## POC #4

**来源**: [CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md](../2024/CVE-2024-0582-kuzeyardabulut_CVE-2024-0582.md)

## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

## POC #5

**来源**: [CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md](../2024/CVE-2024-0582-ysanatomic_io_uring_LPE-CVE-2024-0582.md)

## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。当用户使用 IORING_REGISTER_PBUF_RING 注册 buffer ring，并使用 mmap() 映射它，然后释放它时，会发生此漏洞。

**有效性分析：**
根据漏洞库信息，该漏洞存在于 Linux kernel 6.4 之前的版本。提供的 POC 代码（`exploit.c`）利用了该漏洞，并参考了 CVE-2023-2598 的利用方式。从搜索结果来看，该漏洞已被公开披露，并且存在多个可用的 Exploit 代码。

**投毒风险分析：**

该 POC 代码相对复杂，涉及 io_uring 接口的大量使用，代码量也比较大，增加分析难度。

*   代码中存在大量的系统调用和内存操作，这增加了代码的潜在风险，即攻击者可能利用这些操作来执行恶意代码。
*   POC 代码本身的目标是提升权限，本质上就具有一定的“破坏性”。
*   代码中包含`#define target_tty_dev "/dev/ttyS0"`，`/dev/ttyS0`一般是串口设备，攻击者可能会利用它进行控制或窃取信息
*  代码大量使用偏移地址 `#define sk_data_ready_off 680` `#define TCP_OFFSET 1400` `#define IOCTL_OFFSET 40` `#define call_usermodehelper_exec 0xa38f0` `#define call_usermodehelper_exec_work 0xa3cb0` 这些硬编码的偏移地址，可能会导致代码在不同内核版本上失效，也可能被利用进行恶意操作。

因此，综合考虑，该 POC 代码可能存在一定投毒风险，风险占比大约为 10%。

**利用方式分析：**

1.  **Buffer Ring 注册与映射：** 利用 `io_uring_register_buf_ring` 注册 buffer ring，然后使用 `mmap()` 将其映射到用户空间。
2.  **Use-After-Free 触发：** 释放 buffer ring 后，仍然可以访问已释放的内存，从而触发 use-after-free 漏洞。
3.  **权限提升：** 通过精心构造的数据，覆盖内核中的敏感数据结构，例如 `task_struct` 的 `cred` 字段，从而提升权限。具体利用方式参考 CVE-2023-2598 的利用方法。
4. **call_usermodehelper:** 代码定义了 `call_usermodehelper_exec` 和 `call_usermodehelper_exec_work` 偏移量，这表明该漏洞利用可能涉及调用 `call_usermodehelper` 函数来执行用户态代码，实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2024-0582](https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)

---

