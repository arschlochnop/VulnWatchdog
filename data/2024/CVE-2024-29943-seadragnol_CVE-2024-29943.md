# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---



---



---



---

