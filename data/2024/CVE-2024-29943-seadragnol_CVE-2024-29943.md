# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

# CVE-2024-29943

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-29943-bjrjk_CVE-2024-29943.md](../2024/CVE-2024-29943-bjrjk_CVE-2024-29943.md)

## CVE-2024-29943 - Firefox JavaScriptå¼•æ“ Out-of-bounds Read/Write

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** Out-of-bounds Read/Write

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æµè§ˆæ¶æ„ç½‘é¡µ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox JavaScript å¼•æ“ä¸­çš„æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç»•è¿‡åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤æ¥æ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ JavaScript ä»£ç æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ¼æ´åˆ©ç”¨ PoCã€‚å®ƒåˆ©ç”¨äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ç¼ºé™·ï¼Œå…·ä½“æ¥è¯´æ˜¯èŒƒå›´åˆ†æçš„ç»•è¿‡ã€‚ä»£ç é¦–å…ˆé€šè¿‡ `opt` å‡½æ•°ä¸­çš„ä¸€ç³»åˆ—ä½è¿ç®—å’Œå¾ªç¯æ¥å°è¯•è§¦å‘æ¼æ´ï¼Œç²¾å¿ƒæ„é€ çš„æ•°å€¼ä¼šå¯¼è‡´ç±»å‹æ··æ·†æˆ–è€…è¶Šç•Œè®¿é—®ã€‚åé¢çš„ä»£ç ä½¿ç”¨å †å–·å°„ï¼ˆHeap Sprayingï¼‰æ¥åœ¨å†…å­˜ä¸­å¸ƒç½®ç‰¹å®šçš„æ•°æ®ç»“æ„ï¼Œä¸ºè¿›ä¸€æ­¥åˆ©ç”¨åˆ›é€ æ¡ä»¶ã€‚`addrof` å’Œ `fakeobj` å‡½æ•°ç”¨äºå®ç°ä»»æ„åœ°å€è¯»å†™ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨ä¸­çš„å¸¸è§æŠ€æœ¯ã€‚æœ€åï¼Œä»£ç é€šè¿‡ä¼ªé€  JSString å¯¹è±¡æ¥è¾¾åˆ°è¯»å–ä»»æ„å†…å­˜çš„ç›®çš„ã€‚æ ¹æ®ä»£ç çš„å¤æ‚æ€§ä»¥åŠä¸æ¼æ´æè¿°çš„å¯¹åº”å…³ç³»ï¼Œè¯¥PoCå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ä»£ç ä¸»è¦ç›®æ ‡æ˜¯åˆ©ç”¨æ¼æ´ï¼Œä½†å­˜åœ¨å¾®å°çš„æŠ•æ¯’é£é™©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

*   **å¤æ‚æ€§å’Œæ··æ·†ï¼š** ä»£ç ä¸­å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ã€ç±»å‹è½¬æ¢å’Œå †å–·å°„æ“ä½œï¼Œè¿™å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å¾—äººå·¥å®¡è®¡å˜å¾—å›°éš¾ï¼Œä¸ºéšè—æ¶æ„ä»£ç æä¾›äº†ç©ºé—´ã€‚
*   **è¿œç¨‹ä»£ç æ‰§è¡Œå¯èƒ½æ€§ï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™å¯ä»¥ç”¨æ¥å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
*   **ä¾èµ–æ€§ï¼š**PoC å¯èƒ½ä¾èµ–äºç‰¹å®šçš„ Firefox ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€ç‚¹æ¥éƒ¨ç½²é’ˆå¯¹ç‰¹å®šç›®æ ‡ç¯å¢ƒçš„æ¶æ„ä»£ç ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ä¸»è¦æ˜¯ç”±äºä»£ç æœ¬èº«è¾ƒä¸ºå¤æ‚ï¼Œå…·æœ‰ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œå¯èƒ½å­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„åé—¨ã€‚ ä½†ä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ä¸ºäº†å®ç°æ¼æ´åˆ©ç”¨ï¼Œå› æ­¤æŠ•æ¯’æ¦‚ç‡è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** `opt` å‡½æ•°ä¸­çš„é€»è¾‘ç¼ºé™·å¯¼è‡´JavaScriptå¼•æ“çš„èŒƒå›´åˆ†æå¤±æ•ˆï¼Œå…è®¸è¶Šç•Œè®¿é—®æ•°ç»„ã€‚
2.  **å †å–·å°„ï¼š** é€šè¿‡åˆ›å»ºå¤§é‡å¯¹è±¡ï¼ˆ`sprayRefArr`ï¼‰ï¼Œåœ¨å†…å­˜ä¸­é¢„å…ˆåˆ†é…ç©ºé—´ï¼Œä¸ºåç»­çš„æ¼æ´åˆ©ç”¨åšå¥½å‡†å¤‡ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼ˆAddrofï¼‰ï¼š** é€šè¿‡æ„é€ ç‰¹å®šçš„å¯¹è±¡ï¼Œåˆ©ç”¨è¶Šç•Œè®¿é—®æ¼æ´ï¼Œæ³„æ¼å†…å­˜åœ°å€ã€‚`addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
4.  **ä»»æ„åœ°å€è¯»å†™ï¼ˆFakeobjï¼‰ï¼š** é€šè¿‡ä¼ªé€ å¯¹è±¡ï¼ˆ`fakeobj`ï¼‰ï¼Œå®ç°ä»»æ„å†…å­˜åœ°å€çš„è¯»å†™ã€‚`fakeobj`å‡½æ•°æ¥å—ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥åœ°å€çš„å¯¹è±¡ã€‚
5.  **åˆ©ç”¨åŸè¯­ï¼š** ä»£ç é€šè¿‡æ³„æ¼çš„åœ°å€å’Œæ„é€ çš„å‡å¯¹è±¡ï¼Œå¯ä»¥è¯»å–å’Œä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚
6.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆå‡è®¾ï¼‰ï¼š** å‡è®¾åœ¨å®ç°ä»»æ„åœ°å€è¯»å†™ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥ä¿®æ”¹å‡½æ•°æŒ‡é’ˆæˆ–è€…å…¶ä»–å…³é”®æ•°æ®ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚ PoCä»£ç é€šè¿‡`fakeJSExternalStringContainer`ä¼ªé€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¯»å–ä»»æ„å†…å­˜çš„æ•°æ®ã€‚

æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦å¯¹JavaScriptå¼•æ“çš„å†…éƒ¨æœºåˆ¶æœ‰æ·±å…¥çš„äº†è§£ã€‚å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œå¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œé£é™©æé«˜ã€‚

**é¡¹ç›®åœ°å€:** [bjrjk/CVE-2024-29943](https://github.com/bjrjk/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---

## POC #2

**æ¥æº**: [CVE-2024-29943-seadragnol_CVE-2024-29943.md](../2024/CVE-2024-29943-seadragnol_CVE-2024-29943.md)

## CVE-2024-29943-Firefox-ç±»å‹æ··æ·†

**æ¼æ´ç¼–å·:** CVE-2024-29943

**æ¼æ´ç±»å‹:** ç±»å‹æ··æ·†

**å½±å“åº”ç”¨:** Firefox

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 124.0.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åœ¨å—å½±å“çš„Firefoxç‰ˆæœ¬ä¸­æ‰§è¡Œæ¶æ„JavaScriptä»£ç 

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-29943 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox 124.0.1 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­çš„æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ¬ºéª—åŸºäºèŒƒå›´çš„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤ï¼Œåœ¨ JavaScript å¯¹è±¡ä¸Šæ‰§è¡Œè¶Šç•Œè¯»å–æˆ–å†™å…¥æ“ä½œã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥PoCåˆ©ç”¨äº† Firefox çš„ JavaScript å¼•æ“ä¸­çš„ç±»å‹æ··æ·†æ¼æ´ã€‚ä»£ç é¦–å…ˆé€šè¿‡å †å–·å°„ï¼ˆHeap sprayingï¼‰åœ¨å†…å­˜ä¸­å¸ƒç½®ä¸€äº›å¯¹è±¡ï¼Œç„¶ååˆ©ç”¨æ¼æ´è¿›è¡Œè¶Šç•Œè®¿é—®ï¼ˆOut-of-bounds accessï¼‰ï¼Œæœ€ç»ˆå®ç°ä»»æ„åœ°å€è¯»å†™ã€‚PoC ä¸­åŒ…å« addrof å’Œ fakeobj å‡½æ•°ï¼Œè¡¨æ˜å…¶ç›®æ ‡æ˜¯å®ç°åœ°å€æ³„éœ²å’Œä¼ªé€ å¯¹è±¡ï¼Œä»è€Œè·å¾—å¯¹å†…å­˜çš„æ§åˆ¶ã€‚å› æ­¤ï¼Œä»ä»£ç é€»è¾‘ä¸Šçœ‹ï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„ JavaScript ä»£ç ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ã€‚ä»£ç ä¸­åŒ…å«å¤§é‡çš„å †å–·å°„å’Œå†…å­˜æ“ä½œï¼Œè¿™äº›æ“ä½œæœ¬èº«å°±æ¯”è¾ƒå¤æ‚ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºéšè—æ¶æ„è¡Œä¸ºã€‚æ­¤å¤–ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€äº›ç¡¬ç¼–ç çš„åœ°å€å’Œåç§»é‡ï¼Œè¿™äº›å€¼å¯èƒ½ä¼šè¢«ç”¨äºç‰¹å®šç¯å¢ƒä¸‹çš„åˆ©ç”¨ï¼Œä¹Ÿå¯èƒ½åŒ…å«åé—¨æˆ–è€…å…¶ä»–æ¶æ„è´Ÿè½½ã€‚
è™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ç›´æ¥æ‰§è¡Œ shell å‘½ä»¤ï¼Œä½†åˆ©ç”¨è¶Šç•Œè¯»å†™æ“ä½œå¯ä»¥å®ç°å¾ˆå¤šæ¶æ„ç›®çš„ï¼Œä¾‹å¦‚ç¯¡æ”¹å‡½æ•°æŒ‡é’ˆã€åŠ«æŒæ§åˆ¶æµç­‰ã€‚æ­¤å¤–ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€äº›çœ‹ä¼¼æ— å®³ä½†å¯èƒ½è¢«åˆ©ç”¨çš„å‡½æ•°ï¼Œä¾‹å¦‚`addrof`å’Œ`fakeobj`ï¼Œè¿™äº›å‡½æ•°å¯ä»¥è¢«ç”¨äºè¯»å–å†…å­˜åœ°å€å’Œä¼ªé€ å¯¹è±¡ï¼Œä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚
ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©çº¦ä¸º 10%ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **å †å–·å°„ (Heap Spraying):** ä»£ç é¦–å…ˆè¿›è¡Œå †å–·å°„ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…å¤§é‡çš„ BigUint64Array å¯¹è±¡ï¼Œä»¥ä¾¿åœ¨åç»­çš„åˆ©ç”¨è¿‡ç¨‹ä¸­æ›´å®¹æ˜“æ‰¾åˆ°ç›®æ ‡å¯¹è±¡ã€‚
2.  **è§¦å‘è¶Šç•Œè®¿é—®:** é€šè¿‡`opt`å‡½æ•°ä¸­çš„ç±»å‹æ··æ·†æ¼æ´ï¼Œè§¦å‘è¶Šç•Œè¯»å†™ã€‚
3.  **åœ°å€æ³„éœ² (Address Leak):** åˆ©ç”¨è¶Šç•Œè¯»å–ï¼Œæ³„éœ²ç›®æ ‡å¯¹è±¡çš„åœ°å€ã€‚PoCä¸­çš„ `addrof` å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„åœ°å€ã€‚
4.  **ä¼ªé€ å¯¹è±¡ (Fake Object):** åˆ©ç”¨è¶Šç•Œå†™å…¥ï¼Œä¼ªé€ å¯¹è±¡ã€‚PoCä¸­çš„ `fakeobj` å‡½æ•°ç”¨äºåœ¨æŒ‡å®šåœ°å€å¤„ä¼ªé€ å¯¹è±¡ã€‚
5.  **ä»»æ„ä»£ç æ‰§è¡Œ:** åœ¨è·å–äº†å¯¹è±¡åœ°å€å’Œä¼ªé€ å¯¹è±¡çš„èƒ½åŠ›ä¹‹åï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›èƒ½åŠ›å®ç°ä»»æ„ä»£ç æ‰§è¡Œï¼Œä¾‹å¦‚ï¼Œå¯ä»¥ä¼ªé€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„å‡½æ•°å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æ¯”è¾ƒå…¸å‹ï¼Œåˆ©ç”¨äº†ç±»å‹æ··æ·†æ¼æ´å®ç°è¶Šç•Œè¯»å†™ï¼Œè¿›è€Œå®ç°åœ°å€æ³„éœ²å’Œä»»æ„ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [seadragnol/CVE-2024-29943](https://github.com/seadragnol/CVE-2024-29943)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-29943](https://nvd.nist.gov/vuln/detail/CVE-2024-29943)

---



---



---



---



---



---



---



---



---



---



---



---



---

