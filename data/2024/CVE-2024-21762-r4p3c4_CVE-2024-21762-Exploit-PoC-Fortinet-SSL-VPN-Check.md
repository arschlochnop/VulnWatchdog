# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md](../2024/CVE-2024-21762-r4p3c4_CVE-2024-21762-Exploit-PoC-Fortinet-SSL-VPN-Check.md)

# CVE-2024-21762

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-21762-BishopFox_cve-2024-21762-check.md](../2024/CVE-2024-21762-BishopFox_cve-2024-21762-check.md)

## CVE-2024-21762 - FortiOS/FortiProxy 越界写入漏洞

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需身份验证，网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSLVPNd 守护程序中的一个越界写入漏洞。根据搜索结果和漏洞库信息，该漏洞允许未经身份验证的远程攻击者通过特制请求执行任意代码或命令。

**有效性：**

根据多个搜索结果（Tenable, Rapid7, Wiz.io, Assetnote等），该漏洞已被积极利用。

**投毒风险：**

提供的漏洞利用代码片段仅包含 GNU 通用公共许可证，并未发现任何直接的恶意代码。因此，判断存在投毒代码的可能性较低，约为1%。 但是，完整的利用链中其他部分可能包含恶意代码，需谨慎分析。

**利用方式：**

1.  **目标：** 攻击目标是运行存在漏洞的 FortiOS 或 FortiProxy 版本的设备。
2.  **漏洞点：** 漏洞存在于 `sslvpnd` 进程中。
3.  **攻击向量：** 远程、无需身份验证。
4.  **利用方式：** 攻击者发送特制的恶意请求到目标设备，触发越界写入漏洞，进而执行任意代码或命令。
5.  **影响：** 成功利用该漏洞可以导致完全控制受影响的设备，包括数据泄露、服务中断和后门植入等。

综上所述，CVE-2024-21762 是一个高危漏洞，应尽快修复。

**项目地址:** [BishopFox/cve-2024-21762-check](https://github.com/BishopFox/cve-2024-21762-check)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #2

**来源**: [CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md](../2024/CVE-2024-21762-XiaomingX_cve-2024-21762-poc.md)

## CVE-2024-21762-Fortinet-RCE

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令。

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17；FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 无需认证，网络可达即可。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21762是一个存在于Fortinet FortiOS和FortiProxy的SSL-VPN中的越界写入漏洞。未经身份验证的远程攻击者可以通过发送特制请求来利用此漏洞，从而执行任意代码或命令。根据CISA的通告，该漏洞已经被积极利用。Assetnote的研究表明，该漏洞只需要修改两个字节即可实现RCE。提供的漏洞利用代码仅包含Apache 2.0许可协议，本身不具备漏洞利用功能，因此没有投毒风险。利用方式是通过构造恶意的SSL VPN请求，触发sslvpnd进程中的越界写入，从而执行攻击者指定的代码。

**项目地址:** [XiaomingX/cve-2024-21762-poc](https://github.com/XiaomingX/cve-2024-21762-poc)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #3

**来源**: [CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md](../2024/CVE-2024-21762-abrewer251_CVE-2024-21762_FortiNet_PoC.md)

## CVE-2024-21762 FortiOS SSL VPN 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 远程代码执行

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程未授权攻击者可以执行任意代码或命令

**影响版本:** FortiOS：7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy：7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从外部网络访问 FortiOS 或 FortiProxy 设备的 SSL VPN 功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 Fortinet FortiOS 和 FortiProxy 中的一个越界写入漏洞，存在于 SSL VPN 的 `sslvpnd` 守护进程中。攻击者可以通过构造特制的请求，利用 `/remote/hostcheck_validate` 接口中的漏洞，实现远程代码执行。漏洞利用通过向目标服务器的 `/remote/hostcheck_validate` 端点发送包含恶意代码的 POST 请求，该代码作为 `host` 参数的值进行注入。`User-Agent` 和 `Cookie` 头部用于绕过简单的请求过滤。

**漏洞利用有效性分析：**
提供的 PoC 代码旨在扫描并利用 CVE-2024-21762。它通过向 `/remote/hostcheck_validate` 端点注入反向 shell payload 来实现远程代码执行，通过模拟 `User-Agent` 和 `Cookie` 头部来绕过简单的请求过滤。根据搜索结果，该漏洞已经被积极利用，存在公开的漏洞利用代码和扫描器。

**投毒风险分析：**
提供的 PoC 包含 `LICENSE`、`README.md`、`exploit.py` 和 `http_c2_server.py` 文件。

*   `exploit.py`: 实现了漏洞利用的核心逻辑，用于发送包含反向 shell payload 的恶意请求。
*   `http_c2_server.py`: 这是一个简单的 HTTP 服务器，用于接收反向 shell 连接。其默认命令为 "id"，可能被修改。
    
代码本身是漏洞的PoC，`http_c2_server.py` 文件可以通过修改`COMMAND`变量来执行其他命令，具有一定的风险。PoC 的作者信息中包含了“PoC automation nerd”，暗示了自动化和脚本化的能力，使得大规模利用成为可能。整体来看，该 PoC 的投毒风险较低，主要风险在于被滥用执行恶意命令。

**漏洞利用方式总结：**
1.  攻击者构造包含恶意 payload 的 HTTP POST 请求，目标端点为 `/remote/hostcheck_validate`。
2.  Payload 通常是反向 shell 命令，用于在目标系统上执行任意代码。
3.  攻击者监听指定的 IP 地址和端口，等待反向 shell 连接。
4.  如果漏洞利用成功，攻击者可以在目标系统上执行命令。

**项目地址:** [abrewer251/CVE-2024-21762_FortiNet_PoC](https://github.com/abrewer251/CVE-2024-21762_FortiNet_PoC)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #4

**来源**: [CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md](../2024/CVE-2024-21762-cleverg0d_CVE-2024-21762-Checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 6.0.0 - 7.4.2, FortiProxy: 1.0.0 - 7.4.2 (受影响版本详见漏洞库信息)

**利用条件:** 目标设备必须开启SSL VPN功能，且攻击者需要能够发起网络请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2024-21762是FortiOS和FortiProxy中的一个越界写漏洞。该漏洞存在于SSL VPN (sslvpnd) 组件中，允许未经身份验证的远程攻击者通过精心构造的请求执行任意代码或命令。

**有效性：**
漏洞利用的有效性很高。根据搜索结果，该漏洞已经被公开利用 (in-the-wild)。Bishop Fox 发布了漏洞扫描器，Assetnote 发布了漏洞分析和利用方法。CISA 已将此漏洞添加到已知被利用漏洞目录中，表明其威胁程度很高。

**投毒风险：**
提供的漏洞利用代码片段仅包含 GNU GPL 许可证，没有发现恶意代码。考虑到通常的开源协议，作者隐藏的投毒代码的可能性极低，推测投毒风险约为1%。但需要注意的是，完整的漏洞利用代码可能包含其他文件，仅凭当前信息无法完全排除投毒的可能性。

**利用方式：**
利用方式涉及向目标设备的SSL VPN服务发送特制的请求。该请求会触发越界写入漏洞，允许攻击者覆盖内存中的数据，从而执行任意代码。

**简而言之：**
CVE-2024-21762是一个严重的安全漏洞，可以被远程利用，具有高危风险。官方已经发布了补丁，建议尽快升级到安全版本。

**项目地址:** [cleverg0d/CVE-2024-21762-Checker](https://github.com/cleverg0d/CVE-2024-21762-Checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #5

**来源**: [CVE-2024-21762-d0rb_CVE-2024-21762.md](../2024/CVE-2024-21762-d0rb_CVE-2024-21762.md)

## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #6

**来源**: [CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md](../2024/CVE-2024-21762-h4x0r-dz_CVE-2024-21762.md)

## CVE-2024-21762 FortiOS/FortiProxy 远程代码执行

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入 (Out-of-Bounds Write)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 需要网络访问，目标设备开启SSL VPN功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件中的一个越界写入漏洞。未经身份验证的远程攻击者可以通过精心设计的请求利用此漏洞执行任意代码或命令。

**漏洞利用方式：**

1.  **触发漏洞：** 攻击者发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 路径，利用chunked编码处理中的缺陷触发越界写入。
2.  **内存破坏：** 通过构造包含特定 ROP 链和 shellcode 的请求体，攻击者覆盖内存中的关键数据，控制程序执行流程。
3.  **代码执行：** ROP 链用于禁用地址空间布局随机化 (ASLR) 并执行 shellcode，从而获得系统权限并执行恶意代码。
4.  **反弹shell:**  通过执行`/bin/node`命令来执行一段 JavaScript payload，该payload尝试连接到攻击者控制的IP地址和端口 (192.168.1.197:4242)，从而建立反弹shell。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞已被积极利用。多个安全厂商（如Tenable、Rapid7、Bishop Fox、Assetnote）都发布了关于此漏洞的分析报告和利用工具，证明了POC代码的有效性。

**投毒风险：**

代码中存在与远程主机建立连接的反弹 shell 代码，但这是漏洞验证的一部分，用于证明远程代码执行。将此代码判定为投毒代码不合理。
综合评估，该代码库存在一定投毒的可能性，可能性为5%。主要考虑到以下因素：
    * 漏洞验证使用反弹shell, 具有一定的隐蔽性。
    * 其他未知的恶意行为。

**修复建议：**

尽快升级到 FortiOS 和 FortiProxy 的修复版本，如 FortiOS 7.6.0 或更高版本，或者 FortiOS 7.4.3 或更高版本。


**项目地址:** [h4x0r-dz/CVE-2024-21762](https://github.com/h4x0r-dz/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

## POC #7

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---



---

## POC #8

**来源**: [CVE-2024-21762-rdoix_cve-2024-21762-checker.md](../2024/CVE-2024-21762-rdoix_cve-2024-21762-checker.md)

## CVE-2024-21762 - Fortinet FortiOS/FortiProxy 越界写入

**漏洞编号:** CVE-2024-21762

**漏洞类型:** 越界写入

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标设备开启SSL VPN服务且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21762是一个Fortinet FortiOS和FortiProxy中的越界写入漏洞。未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。该漏洞存在于SSL VPN的sslvpnd守护进程中。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞已经被积极利用。提供的POC代码是一个漏洞检测脚本，它利用Shodan API查找运行易受攻击的Fortigate SSL VPN的设备，并发送特定的HTTP请求来检查漏洞是否存在。具体检测方式是通过发送`control_req`和`check_req` 两个请求,根据返回状态判断是否存在漏洞。

**投毒风险分析：**
代码主要功能是查找并验证漏洞，没有发现明显的恶意代码，但存在以下潜在风险：
1.  **依赖风险：** `requirements.txt` 文件中列出的依赖库可能存在安全问题，如果安装了包含恶意代码的依赖项，可能导致投毒。
2.  **API密钥泄露：** 该脚本要求用户设置Shodan API密钥作为环境变量。如果用户的API密钥泄露，攻击者可以使用该密钥进行恶意活动。
3.  **滥用Shodan API：** 大规模扫描可能会被Shodan限制。
4.  **误报/漏报：** POC 代码的检测逻辑可能存在缺陷，导致误报或漏报。
考虑到代码的功能主要是漏洞检测而非利用，且依赖项比较常见，直接投毒的可能性较低，但以上潜在风险仍然存在。因此，投毒风险估计为5%。

**利用方式：**
1.  **信息收集：** 使用Shodan等搜索引擎查找暴露在互联网上的Fortinet SSL VPN设备。
2.  **漏洞验证：** 使用POC代码或类似工具验证目标设备是否存在CVE-2024-21762漏洞。
3.  **漏洞利用：** 如果设备存在漏洞，攻击者可以构造特制的HTTP请求来触发越界写入，从而执行任意代码或命令。
4.  **权限提升和持久化：** 在成功执行代码后，攻击者可以尝试提升权限，并在目标系统中建立持久化连接。

**缓解措施：**
1.  及时更新FortiOS和FortiProxy版本到安全版本。
2.  禁用或限制SSL VPN的访问。
3.  使用入侵检测系统（IDS）或入侵防御系统（IPS）来检测和阻止恶意流量。

**项目地址:** [rdoix/cve-2024-21762-checker](https://github.com/rdoix/cve-2024-21762-checker)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)

---

