## CVE-2024-XXXX - js2py RCE

**漏洞编号:** CVE-2024-XXXX

**漏洞类型:** RCE

**影响应用:** js2py

**危害等级:** Critical

**CVSS评分:** 未提供，需要进一步分析确定

**影响版本:** <=0.74

**利用条件:** 需要目标解析恶意JavaScript代码。可以通过托管恶意JavaScript文件的网站或通过HTTP API发送恶意脚本来触发。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

该漏洞存在于js2py包中，允许攻击者逃逸JavaScript环境并在主机上执行任意命令。js2py是一个流行的Python包，用于在Python解释器中评估JavaScript代码。许多网络爬虫使用它来解析网站上的JavaScript代码。漏洞的根本原因是js2py中的一个全局变量的实现存在缺陷，允许攻击者获得对js2py环境中Python对象的引用。利用此漏洞，攻击者可以绕过`js2py.disable_pyimport()`的限制，该限制旨在阻止JavaScript代码调用Python模块，从而防止沙箱逃逸。

POC有效性分析：
提供的POC代码（poc.py）演示了如何利用此漏洞。它尝试在主机上执行`head -n 1 /etc/passwd; calc; gnome-calculator; kcalc;`命令。如果漏洞存在，脚本将打印“Success! the vulnerability exists...”或弹出计算器。README文件提供了重现漏洞的明确步骤，包括安装受影响的js2py版本（<=0.74）和运行POC脚本。

利用步骤：
1. 安装Python 3（版本低于3.12，因为js2py不支持Python 3.12）。
2. 使用`pip install js2py`安装受影响的js2py版本。
3. 运行提供的`poc.py`脚本。

投毒风险分析：
该漏洞的投毒风险适中。虽然POC代码本身并不包含明显的恶意行为，但攻击者可能会利用此漏洞通过JavaScript代码执行恶意操作。以下是一些潜在的投毒场景：
*   **代码混淆：** 攻击者可以使用代码混淆技术来隐藏恶意JavaScript代码的目的，使其更难以检测。
*   **后门植入：** 攻击者可以使用此漏洞在受害者的系统上植入后门，以便稍后进行未经授权的访问。
*   **数据窃取：** 攻击者可以使用此漏洞窃取敏感数据，例如密码、信用卡号或其他个人信息。
*   **供应链攻击：**如果使用了受影响的js2py包的应用程序被攻击，那么攻击者也可以通过该漏洞投毒供应链，影响所有使用该应用程序的用户。

漏洞利用的难易程度较低，只需将恶意JavaScript代码注入到目标解析的环境中即可。由于js2py被广泛用于网络爬虫和其他应用程序中，因此该漏洞具有广泛的影响。

风险降低措施：
*   升级到js2py的修复版本（如果可用）。
*   使用提供的补丁（fix.py或patch.txt）来修复js2py的源代码。
*   谨慎处理来自不受信任来源的JavaScript代码。
*   限制js2py的权限，以防止其访问敏感资源。
*   使用静态代码分析工具来检测恶意JavaScript代码。

**项目地址:** 未提供，需要进一步搜索

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2024-XXXX
