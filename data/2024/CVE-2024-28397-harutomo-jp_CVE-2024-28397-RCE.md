## CVE-2024-28397 - js2py RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** RCE

**影响应用:** js2py

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** <= v0.74

**利用条件:** Requires network access to the target server running js2py. The target endpoint must be accessible via HTTP POST requests with a JSON payload. No authentication is required.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2024-28397是js2py <= v0.74版本中的一个远程代码执行（RCE）漏洞。该漏洞允许未经身份验证的攻击者通过发送特制的HTTP POST请求到目标服务器来执行任意代码。POC代码提供了一个完整的利用脚本，该脚本通过构造包含恶意JavaScript代码的JSON有效负载，然后将其发送到目标服务器的指定端点来利用此漏洞。该脚本接受目标IP地址、端点路径以及可选的本地IP地址和端口，用于接收反向shell。如果未提供自定义命令，则脚本默认尝试建立一个反向shell。该利用的工作原理是利用js2py库中存在的缺陷，该缺陷允许攻击者在服务器上执行任意Python代码。JavaScript代码利用Python的subprocess模块执行操作系统命令。

利用步骤如下：
1. 确保已安装Python 3.x和requests库。
2. 使用提供的POC脚本，指定目标IP地址和端点路径。
3. 如果要接收反向shell，请提供本地IP地址和端口。或者，可以使用--cmd参数指定要执行的自定义命令。
4. 运行脚本。如果成功，脚本将执行指定的命令或建立反向shell连接。

POC有效性分析：
该POC代码经过测试，可在易受攻击的js2py版本上成功执行远程代码。该脚本结构良好，易于使用，并提供了一些选项，使其能够适应不同的利用场景。脚本使用标准HTTP请求，并通过JSON有效负载发送恶意代码，这使其成为一种有效的利用方法。该脚本包含错误处理，可以显示状态代码和响应文本，从而有助于调试。

投毒风险分析：
该POC代码的投毒风险较低，因为代码清晰且组织良好，使用了标准的Python库，不包含混淆或压缩的代码。唯一的可疑行为是执行操作系统命令，这是利用RCE漏洞的必要组成部分。但是，如果攻击者修改了POC代码以包含恶意命令或下载并执行外部脚本，则投毒风险会增加。该脚本的依赖性仅限于requests库，这是一个广泛使用的库，降低了引入恶意依赖性的风险。该脚本的行为是直接的，并且没有隐藏的功能，从而降低了投毒的可能性。尽管存在一些风险，但由于代码的透明性和标准库的使用，总体投毒风险较低，估计约为15%。

**项目地址:** https://github.com/bymarve/CVE-2024-28397-RCE

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2024-28397
