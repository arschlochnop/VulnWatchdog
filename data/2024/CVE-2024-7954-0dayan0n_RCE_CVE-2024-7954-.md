# CVE-2024-7954

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md](../2024/CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md)

# CVE-2024-7954

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md](../2024/CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md)

# CVE-2024-7954

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md](../2024/CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md)

# CVE-2024-7954

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md](../2024/CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md)

# CVE-2024-7954

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md](../2024/CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md)

# CVE-2024-7954

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md](../2024/CVE-2024-7954-0dayan0n_RCE_CVE-2024-7954-.md)

## CVE-2024-7954-SPIP Porte Plume Plugin-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且已安装并启用 porte_plume 插件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过向 `/index.php?action=porte_plume_previsu` 发送精心构造的 HTTP POST 请求，在目标服务器上执行任意 PHP 代码。

**有效性：**
提供的 Nuclei 模板 `CVE-2024-7954.yml` 看起来有效。它发送一个包含 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`，并检查响应中是否包含 `/etc/passwd` 文件的内容，以及是否包含 `Composed-By: SPIP` 头，以及状态码是否为 200。这些检查可以确认漏洞是否成功利用。

**投毒风险：**
该POC代码主要用于验证漏洞是否存在，payload 使用 `system('cat /etc/passwd')` 读取敏感文件。评估投毒风险时，需要考虑仓库作者是否在其他地方隐藏了恶意代码。根据目前的信息，主要的风险在于使用者可能会直接在生产环境中使用此POC，从而暴露敏感信息或导致其他安全问题。直接投毒风险较低，初步估计为10%。

**利用方式：**
1.  确定目标系统正在运行受影响的 SPIP 版本，并且安装并启用了 porte_plume 插件。
2.  使用提供的 Nuclei 模板或手动构造 HTTP POST 请求，将恶意 PHP 代码注入到 `data` 参数中。示例请求如下：

```
POST /index.php?action=porte_plume_previsu HTTP/1.1
Host: {{Hostname}}
Content-Type: application/x-www-form-urlencoded

data=AA_[<img111111>->URL`<?php system('cat /etc/passwd'); ?>`]_BB
```

3.  发送请求到目标服务器。
4.  如果漏洞利用成功，服务器将执行恶意 PHP 代码，并将结果返回到响应中。例如，使用 `system('cat /etc/passwd')`，攻击者将在响应中看到 `/etc/passwd` 文件的内容。

**项目地址:** [0dayan0n/RCE_CVE-2024-7954-](https://github.com/0dayan0n/RCE_CVE-2024-7954-)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #2

**来源**: [CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md)

## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #3

**来源**: [CVE-2024-7954-Chocapikk_CVE-2024-7954.md](../2024/CVE-2024-7954-Chocapikk_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #4

**来源**: [CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #5

**来源**: [CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md](../2024/CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md)

## CVE-2024-7954 SPIP Porte Plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且安装了porte_plume插件，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造特殊的HTTP请求，执行任意PHP代码。

**有效性:**
提供的POC代码是有效的，它通过向`/index.php?action=porte_plume_previsu`发送POST请求，并在`data`参数中嵌入包含PHP代码的恶意URL，从而实现远程代码执行。请求头中的`Content-Type`必须为`application/x-www-form-urlencoded`。

**投毒风险:**
分析提供的POC代码和相关的README文件，未发现作者有明显隐藏的恶意代码或后门。该仓库提供的文件主要是漏洞验证的PoC，用于检测目标是否存在该漏洞。因此，投毒风险很低，可以评估为0%。

**利用方式:**
1.  确定目标系统运行受影响的SPIP版本，且安装了`porte_plume`插件。
2.  构造包含恶意PHP代码的POST请求，发送到`/index.php?action=porte_plume_previsu`。
3.  恶意PHP代码会被执行，攻击者可以控制服务器。

**搜索引擎结果分析:**
搜索结果确认了漏洞的存在和严重性，并提供了有关受影响版本的信息。GitHub上的搜索结果表明已经有人发布了公开可用的漏洞利用代码。

**项目地址:** [TheCyberguy-17/RCE_CVE-2024-7954](https://github.com/TheCyberguy-17/RCE_CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #6

**来源**: [CVE-2024-7954-bigb0x_CVE-2024-7954.md](../2024/CVE-2024-7954-bigb0x_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #7

**来源**: [CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md](../2024/CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md)

## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #8

**来源**: [CVE-2024-7954-issamjr_CVE-2024-7954.md](../2024/CVE-2024-7954-issamjr_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume Plugin

**危害等级:** 高危，未经身份验证的攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且porte_plume插件已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 框架的 porte_plume 插件中，允许未经身份验证的远程攻击者执行任意 PHP 代码。漏洞原因是由于对用户输入过滤不足，允许在特定参数中注入恶意代码。利用方式是向 `/index.php?action=porte_plume_previsu` 发送精心构造的 POST 请求，其中 `data` 参数包含嵌入 PHP 代码的 payload。提供的 Python POC 脚本和 Nuclei YAML 模板都验证了这一点。Python脚本使用一系列包含PHP命令的payload（读取/etc/passwd, whoami, uname -a, id, ls -la, /var/log/auth.log）。YAML模板使用`cat /etc/passwd` 。 投毒风险较低，主要集中在脚本是否会执行额外恶意操作，以及yaml文件中是否包含恶意命令（如反弹shell）。

**项目地址:** [issamjr/CVE-2024-7954](https://github.com/issamjr/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #9

**来源**: [CVE-2024-7954-r0otk3r_CVE-2024-7954.md](../2024/CVE-2024-7954-r0otk3r_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #10

**来源**: [CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md](../2024/CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md)

## CVE-2024-7954 SPIP porte_plume 插件任意代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume 插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意 PHP 代码

**影响版本:** SPIP 4.30-alpha2 之前, 4.2.13 之前, 4.1.16 之前

**利用条件:** 目标系统运行受影响的 SPIP 版本，且 porte_plume 插件已启用。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 是 SPIP porte_plume 插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求来执行任意 PHP 代码，权限为 SPIP 用户。

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞被标记为严重，且已经存在公开的利用代码。从github链接中可以看到包含利用脚本。

**投毒风险：**
提供的漏洞利用代码只有`/tmp/18b46db66a1b040bcb36d2d699ec7c9a/README.md`，其内容仅为漏洞描述，不包含任何可执行代码。但是，考虑到这是一个RCE漏洞，攻击者可以在利用过程中注入恶意代码，因此存在一定的投毒风险。例如，攻击者可以将恶意代码写入服务器的配置文件或数据库中，从而实现持久化控制。因此，在利用此漏洞时，务必谨慎，避免引入恶意代码。
风险评估：较低(10%)，主要风险在于后续利用过程中引入恶意payload的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 SPIP 实例。
2.  **代码注入：** 特制的 HTTP 请求包含恶意的 PHP 代码。
3.  **代码执行：** SPIP 服务器执行注入的 PHP 代码，从而允许攻击者在服务器上执行任意命令。

**总结：**
CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。受影响的 SPIP 用户应立即升级到不受影响的版本。利用代码的存在使得攻击变得更加容易，但用户需要仔细验证和审计利用过程，防止被植入后门。

**项目地址:** [zxj-hub/CVE-2024-7954POC](https://github.com/zxj-hub/CVE-2024-7954POC)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---



---

## POC #2

**来源**: [CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md)

## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #3

**来源**: [CVE-2024-7954-Chocapikk_CVE-2024-7954.md](../2024/CVE-2024-7954-Chocapikk_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #4

**来源**: [CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #5

**来源**: [CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md](../2024/CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md)

## CVE-2024-7954 SPIP Porte Plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且安装了porte_plume插件，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造特殊的HTTP请求，执行任意PHP代码。

**有效性:**
提供的POC代码是有效的，它通过向`/index.php?action=porte_plume_previsu`发送POST请求，并在`data`参数中嵌入包含PHP代码的恶意URL，从而实现远程代码执行。请求头中的`Content-Type`必须为`application/x-www-form-urlencoded`。

**投毒风险:**
分析提供的POC代码和相关的README文件，未发现作者有明显隐藏的恶意代码或后门。该仓库提供的文件主要是漏洞验证的PoC，用于检测目标是否存在该漏洞。因此，投毒风险很低，可以评估为0%。

**利用方式:**
1.  确定目标系统运行受影响的SPIP版本，且安装了`porte_plume`插件。
2.  构造包含恶意PHP代码的POST请求，发送到`/index.php?action=porte_plume_previsu`。
3.  恶意PHP代码会被执行，攻击者可以控制服务器。

**搜索引擎结果分析:**
搜索结果确认了漏洞的存在和严重性，并提供了有关受影响版本的信息。GitHub上的搜索结果表明已经有人发布了公开可用的漏洞利用代码。

**项目地址:** [TheCyberguy-17/RCE_CVE-2024-7954](https://github.com/TheCyberguy-17/RCE_CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #6

**来源**: [CVE-2024-7954-bigb0x_CVE-2024-7954.md](../2024/CVE-2024-7954-bigb0x_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #7

**来源**: [CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md](../2024/CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md)

## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #8

**来源**: [CVE-2024-7954-issamjr_CVE-2024-7954.md](../2024/CVE-2024-7954-issamjr_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume Plugin

**危害等级:** 高危，未经身份验证的攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且porte_plume插件已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 框架的 porte_plume 插件中，允许未经身份验证的远程攻击者执行任意 PHP 代码。漏洞原因是由于对用户输入过滤不足，允许在特定参数中注入恶意代码。利用方式是向 `/index.php?action=porte_plume_previsu` 发送精心构造的 POST 请求，其中 `data` 参数包含嵌入 PHP 代码的 payload。提供的 Python POC 脚本和 Nuclei YAML 模板都验证了这一点。Python脚本使用一系列包含PHP命令的payload（读取/etc/passwd, whoami, uname -a, id, ls -la, /var/log/auth.log）。YAML模板使用`cat /etc/passwd` 。 投毒风险较低，主要集中在脚本是否会执行额外恶意操作，以及yaml文件中是否包含恶意命令（如反弹shell）。

**项目地址:** [issamjr/CVE-2024-7954](https://github.com/issamjr/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #9

**来源**: [CVE-2024-7954-r0otk3r_CVE-2024-7954.md](../2024/CVE-2024-7954-r0otk3r_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #10

**来源**: [CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md](../2024/CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md)

## CVE-2024-7954 SPIP porte_plume 插件任意代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume 插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意 PHP 代码

**影响版本:** SPIP 4.30-alpha2 之前, 4.2.13 之前, 4.1.16 之前

**利用条件:** 目标系统运行受影响的 SPIP 版本，且 porte_plume 插件已启用。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 是 SPIP porte_plume 插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求来执行任意 PHP 代码，权限为 SPIP 用户。

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞被标记为严重，且已经存在公开的利用代码。从github链接中可以看到包含利用脚本。

**投毒风险：**
提供的漏洞利用代码只有`/tmp/18b46db66a1b040bcb36d2d699ec7c9a/README.md`，其内容仅为漏洞描述，不包含任何可执行代码。但是，考虑到这是一个RCE漏洞，攻击者可以在利用过程中注入恶意代码，因此存在一定的投毒风险。例如，攻击者可以将恶意代码写入服务器的配置文件或数据库中，从而实现持久化控制。因此，在利用此漏洞时，务必谨慎，避免引入恶意代码。
风险评估：较低(10%)，主要风险在于后续利用过程中引入恶意payload的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 SPIP 实例。
2.  **代码注入：** 特制的 HTTP 请求包含恶意的 PHP 代码。
3.  **代码执行：** SPIP 服务器执行注入的 PHP 代码，从而允许攻击者在服务器上执行任意命令。

**总结：**
CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。受影响的 SPIP 用户应立即升级到不受影响的版本。利用代码的存在使得攻击变得更加容易，但用户需要仔细验证和审计利用过程，防止被植入后门。

**项目地址:** [zxj-hub/CVE-2024-7954POC](https://github.com/zxj-hub/CVE-2024-7954POC)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---



---

## POC #2

**来源**: [CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md)

## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #3

**来源**: [CVE-2024-7954-Chocapikk_CVE-2024-7954.md](../2024/CVE-2024-7954-Chocapikk_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #4

**来源**: [CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #5

**来源**: [CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md](../2024/CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md)

## CVE-2024-7954 SPIP Porte Plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且安装了porte_plume插件，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造特殊的HTTP请求，执行任意PHP代码。

**有效性:**
提供的POC代码是有效的，它通过向`/index.php?action=porte_plume_previsu`发送POST请求，并在`data`参数中嵌入包含PHP代码的恶意URL，从而实现远程代码执行。请求头中的`Content-Type`必须为`application/x-www-form-urlencoded`。

**投毒风险:**
分析提供的POC代码和相关的README文件，未发现作者有明显隐藏的恶意代码或后门。该仓库提供的文件主要是漏洞验证的PoC，用于检测目标是否存在该漏洞。因此，投毒风险很低，可以评估为0%。

**利用方式:**
1.  确定目标系统运行受影响的SPIP版本，且安装了`porte_plume`插件。
2.  构造包含恶意PHP代码的POST请求，发送到`/index.php?action=porte_plume_previsu`。
3.  恶意PHP代码会被执行，攻击者可以控制服务器。

**搜索引擎结果分析:**
搜索结果确认了漏洞的存在和严重性，并提供了有关受影响版本的信息。GitHub上的搜索结果表明已经有人发布了公开可用的漏洞利用代码。

**项目地址:** [TheCyberguy-17/RCE_CVE-2024-7954](https://github.com/TheCyberguy-17/RCE_CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #6

**来源**: [CVE-2024-7954-bigb0x_CVE-2024-7954.md](../2024/CVE-2024-7954-bigb0x_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #7

**来源**: [CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md](../2024/CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md)

## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #8

**来源**: [CVE-2024-7954-issamjr_CVE-2024-7954.md](../2024/CVE-2024-7954-issamjr_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume Plugin

**危害等级:** 高危，未经身份验证的攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且porte_plume插件已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 框架的 porte_plume 插件中，允许未经身份验证的远程攻击者执行任意 PHP 代码。漏洞原因是由于对用户输入过滤不足，允许在特定参数中注入恶意代码。利用方式是向 `/index.php?action=porte_plume_previsu` 发送精心构造的 POST 请求，其中 `data` 参数包含嵌入 PHP 代码的 payload。提供的 Python POC 脚本和 Nuclei YAML 模板都验证了这一点。Python脚本使用一系列包含PHP命令的payload（读取/etc/passwd, whoami, uname -a, id, ls -la, /var/log/auth.log）。YAML模板使用`cat /etc/passwd` 。 投毒风险较低，主要集中在脚本是否会执行额外恶意操作，以及yaml文件中是否包含恶意命令（如反弹shell）。

**项目地址:** [issamjr/CVE-2024-7954](https://github.com/issamjr/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #9

**来源**: [CVE-2024-7954-r0otk3r_CVE-2024-7954.md](../2024/CVE-2024-7954-r0otk3r_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #10

**来源**: [CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md](../2024/CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md)

## CVE-2024-7954 SPIP porte_plume 插件任意代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume 插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意 PHP 代码

**影响版本:** SPIP 4.30-alpha2 之前, 4.2.13 之前, 4.1.16 之前

**利用条件:** 目标系统运行受影响的 SPIP 版本，且 porte_plume 插件已启用。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 是 SPIP porte_plume 插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求来执行任意 PHP 代码，权限为 SPIP 用户。

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞被标记为严重，且已经存在公开的利用代码。从github链接中可以看到包含利用脚本。

**投毒风险：**
提供的漏洞利用代码只有`/tmp/18b46db66a1b040bcb36d2d699ec7c9a/README.md`，其内容仅为漏洞描述，不包含任何可执行代码。但是，考虑到这是一个RCE漏洞，攻击者可以在利用过程中注入恶意代码，因此存在一定的投毒风险。例如，攻击者可以将恶意代码写入服务器的配置文件或数据库中，从而实现持久化控制。因此，在利用此漏洞时，务必谨慎，避免引入恶意代码。
风险评估：较低(10%)，主要风险在于后续利用过程中引入恶意payload的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 SPIP 实例。
2.  **代码注入：** 特制的 HTTP 请求包含恶意的 PHP 代码。
3.  **代码执行：** SPIP 服务器执行注入的 PHP 代码，从而允许攻击者在服务器上执行任意命令。

**总结：**
CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。受影响的 SPIP 用户应立即升级到不受影响的版本。利用代码的存在使得攻击变得更加容易，但用户需要仔细验证和审计利用过程，防止被植入后门。

**项目地址:** [zxj-hub/CVE-2024-7954POC](https://github.com/zxj-hub/CVE-2024-7954POC)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---



---

## POC #2

**来源**: [CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md)

## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #3

**来源**: [CVE-2024-7954-Chocapikk_CVE-2024-7954.md](../2024/CVE-2024-7954-Chocapikk_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #4

**来源**: [CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #5

**来源**: [CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md](../2024/CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md)

## CVE-2024-7954 SPIP Porte Plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且安装了porte_plume插件，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造特殊的HTTP请求，执行任意PHP代码。

**有效性:**
提供的POC代码是有效的，它通过向`/index.php?action=porte_plume_previsu`发送POST请求，并在`data`参数中嵌入包含PHP代码的恶意URL，从而实现远程代码执行。请求头中的`Content-Type`必须为`application/x-www-form-urlencoded`。

**投毒风险:**
分析提供的POC代码和相关的README文件，未发现作者有明显隐藏的恶意代码或后门。该仓库提供的文件主要是漏洞验证的PoC，用于检测目标是否存在该漏洞。因此，投毒风险很低，可以评估为0%。

**利用方式:**
1.  确定目标系统运行受影响的SPIP版本，且安装了`porte_plume`插件。
2.  构造包含恶意PHP代码的POST请求，发送到`/index.php?action=porte_plume_previsu`。
3.  恶意PHP代码会被执行，攻击者可以控制服务器。

**搜索引擎结果分析:**
搜索结果确认了漏洞的存在和严重性，并提供了有关受影响版本的信息。GitHub上的搜索结果表明已经有人发布了公开可用的漏洞利用代码。

**项目地址:** [TheCyberguy-17/RCE_CVE-2024-7954](https://github.com/TheCyberguy-17/RCE_CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #6

**来源**: [CVE-2024-7954-bigb0x_CVE-2024-7954.md](../2024/CVE-2024-7954-bigb0x_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #7

**来源**: [CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md](../2024/CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md)

## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #8

**来源**: [CVE-2024-7954-issamjr_CVE-2024-7954.md](../2024/CVE-2024-7954-issamjr_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume Plugin

**危害等级:** 高危，未经身份验证的攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且porte_plume插件已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 框架的 porte_plume 插件中，允许未经身份验证的远程攻击者执行任意 PHP 代码。漏洞原因是由于对用户输入过滤不足，允许在特定参数中注入恶意代码。利用方式是向 `/index.php?action=porte_plume_previsu` 发送精心构造的 POST 请求，其中 `data` 参数包含嵌入 PHP 代码的 payload。提供的 Python POC 脚本和 Nuclei YAML 模板都验证了这一点。Python脚本使用一系列包含PHP命令的payload（读取/etc/passwd, whoami, uname -a, id, ls -la, /var/log/auth.log）。YAML模板使用`cat /etc/passwd` 。 投毒风险较低，主要集中在脚本是否会执行额外恶意操作，以及yaml文件中是否包含恶意命令（如反弹shell）。

**项目地址:** [issamjr/CVE-2024-7954](https://github.com/issamjr/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #9

**来源**: [CVE-2024-7954-r0otk3r_CVE-2024-7954.md](../2024/CVE-2024-7954-r0otk3r_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #10

**来源**: [CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md](../2024/CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md)

## CVE-2024-7954 SPIP porte_plume 插件任意代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume 插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意 PHP 代码

**影响版本:** SPIP 4.30-alpha2 之前, 4.2.13 之前, 4.1.16 之前

**利用条件:** 目标系统运行受影响的 SPIP 版本，且 porte_plume 插件已启用。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 是 SPIP porte_plume 插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求来执行任意 PHP 代码，权限为 SPIP 用户。

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞被标记为严重，且已经存在公开的利用代码。从github链接中可以看到包含利用脚本。

**投毒风险：**
提供的漏洞利用代码只有`/tmp/18b46db66a1b040bcb36d2d699ec7c9a/README.md`，其内容仅为漏洞描述，不包含任何可执行代码。但是，考虑到这是一个RCE漏洞，攻击者可以在利用过程中注入恶意代码，因此存在一定的投毒风险。例如，攻击者可以将恶意代码写入服务器的配置文件或数据库中，从而实现持久化控制。因此，在利用此漏洞时，务必谨慎，避免引入恶意代码。
风险评估：较低(10%)，主要风险在于后续利用过程中引入恶意payload的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 SPIP 实例。
2.  **代码注入：** 特制的 HTTP 请求包含恶意的 PHP 代码。
3.  **代码执行：** SPIP 服务器执行注入的 PHP 代码，从而允许攻击者在服务器上执行任意命令。

**总结：**
CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。受影响的 SPIP 用户应立即升级到不受影响的版本。利用代码的存在使得攻击变得更加容易，但用户需要仔细验证和审计利用过程，防止被植入后门。

**项目地址:** [zxj-hub/CVE-2024-7954POC](https://github.com/zxj-hub/CVE-2024-7954POC)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---



---

## POC #2

**来源**: [CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md)

## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #3

**来源**: [CVE-2024-7954-Chocapikk_CVE-2024-7954.md](../2024/CVE-2024-7954-Chocapikk_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #4

**来源**: [CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #5

**来源**: [CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md](../2024/CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md)

## CVE-2024-7954 SPIP Porte Plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且安装了porte_plume插件，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造特殊的HTTP请求，执行任意PHP代码。

**有效性:**
提供的POC代码是有效的，它通过向`/index.php?action=porte_plume_previsu`发送POST请求，并在`data`参数中嵌入包含PHP代码的恶意URL，从而实现远程代码执行。请求头中的`Content-Type`必须为`application/x-www-form-urlencoded`。

**投毒风险:**
分析提供的POC代码和相关的README文件，未发现作者有明显隐藏的恶意代码或后门。该仓库提供的文件主要是漏洞验证的PoC，用于检测目标是否存在该漏洞。因此，投毒风险很低，可以评估为0%。

**利用方式:**
1.  确定目标系统运行受影响的SPIP版本，且安装了`porte_plume`插件。
2.  构造包含恶意PHP代码的POST请求，发送到`/index.php?action=porte_plume_previsu`。
3.  恶意PHP代码会被执行，攻击者可以控制服务器。

**搜索引擎结果分析:**
搜索结果确认了漏洞的存在和严重性，并提供了有关受影响版本的信息。GitHub上的搜索结果表明已经有人发布了公开可用的漏洞利用代码。

**项目地址:** [TheCyberguy-17/RCE_CVE-2024-7954](https://github.com/TheCyberguy-17/RCE_CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #6

**来源**: [CVE-2024-7954-bigb0x_CVE-2024-7954.md](../2024/CVE-2024-7954-bigb0x_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #7

**来源**: [CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md](../2024/CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md)

## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #8

**来源**: [CVE-2024-7954-issamjr_CVE-2024-7954.md](../2024/CVE-2024-7954-issamjr_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume Plugin

**危害等级:** 高危，未经身份验证的攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且porte_plume插件已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 框架的 porte_plume 插件中，允许未经身份验证的远程攻击者执行任意 PHP 代码。漏洞原因是由于对用户输入过滤不足，允许在特定参数中注入恶意代码。利用方式是向 `/index.php?action=porte_plume_previsu` 发送精心构造的 POST 请求，其中 `data` 参数包含嵌入 PHP 代码的 payload。提供的 Python POC 脚本和 Nuclei YAML 模板都验证了这一点。Python脚本使用一系列包含PHP命令的payload（读取/etc/passwd, whoami, uname -a, id, ls -la, /var/log/auth.log）。YAML模板使用`cat /etc/passwd` 。 投毒风险较低，主要集中在脚本是否会执行额外恶意操作，以及yaml文件中是否包含恶意命令（如反弹shell）。

**项目地址:** [issamjr/CVE-2024-7954](https://github.com/issamjr/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #9

**来源**: [CVE-2024-7954-r0otk3r_CVE-2024-7954.md](../2024/CVE-2024-7954-r0otk3r_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #10

**来源**: [CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md](../2024/CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md)

## CVE-2024-7954 SPIP porte_plume 插件任意代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume 插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意 PHP 代码

**影响版本:** SPIP 4.30-alpha2 之前, 4.2.13 之前, 4.1.16 之前

**利用条件:** 目标系统运行受影响的 SPIP 版本，且 porte_plume 插件已启用。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 是 SPIP porte_plume 插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求来执行任意 PHP 代码，权限为 SPIP 用户。

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞被标记为严重，且已经存在公开的利用代码。从github链接中可以看到包含利用脚本。

**投毒风险：**
提供的漏洞利用代码只有`/tmp/18b46db66a1b040bcb36d2d699ec7c9a/README.md`，其内容仅为漏洞描述，不包含任何可执行代码。但是，考虑到这是一个RCE漏洞，攻击者可以在利用过程中注入恶意代码，因此存在一定的投毒风险。例如，攻击者可以将恶意代码写入服务器的配置文件或数据库中，从而实现持久化控制。因此，在利用此漏洞时，务必谨慎，避免引入恶意代码。
风险评估：较低(10%)，主要风险在于后续利用过程中引入恶意payload的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 SPIP 实例。
2.  **代码注入：** 特制的 HTTP 请求包含恶意的 PHP 代码。
3.  **代码执行：** SPIP 服务器执行注入的 PHP 代码，从而允许攻击者在服务器上执行任意命令。

**总结：**
CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。受影响的 SPIP 用户应立即升级到不受影响的版本。利用代码的存在使得攻击变得更加容易，但用户需要仔细验证和审计利用过程，防止被植入后门。

**项目地址:** [zxj-hub/CVE-2024-7954POC](https://github.com/zxj-hub/CVE-2024-7954POC)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---



---

## POC #2

**来源**: [CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-Arthikw3b_RCE-CVE-2024-7954.md)

## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #3

**来源**: [CVE-2024-7954-Chocapikk_CVE-2024-7954.md](../2024/CVE-2024-7954-Chocapikk_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #4

**来源**: [CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md](../2024/CVE-2024-7954-MuhammadWaseem29_RCE-CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #5

**来源**: [CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md](../2024/CVE-2024-7954-TheCyberguy-17_RCE_CVE-2024-7954.md)

## CVE-2024-7954 SPIP Porte Plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且安装了porte_plume插件，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的远程攻击者可以通过构造特殊的HTTP请求，执行任意PHP代码。

**有效性:**
提供的POC代码是有效的，它通过向`/index.php?action=porte_plume_previsu`发送POST请求，并在`data`参数中嵌入包含PHP代码的恶意URL，从而实现远程代码执行。请求头中的`Content-Type`必须为`application/x-www-form-urlencoded`。

**投毒风险:**
分析提供的POC代码和相关的README文件，未发现作者有明显隐藏的恶意代码或后门。该仓库提供的文件主要是漏洞验证的PoC，用于检测目标是否存在该漏洞。因此，投毒风险很低，可以评估为0%。

**利用方式:**
1.  确定目标系统运行受影响的SPIP版本，且安装了`porte_plume`插件。
2.  构造包含恶意PHP代码的POST请求，发送到`/index.php?action=porte_plume_previsu`。
3.  恶意PHP代码会被执行，攻击者可以控制服务器。

**搜索引擎结果分析:**
搜索结果确认了漏洞的存在和严重性，并提供了有关受影响版本的信息。GitHub上的搜索结果表明已经有人发布了公开可用的漏洞利用代码。

**项目地址:** [TheCyberguy-17/RCE_CVE-2024-7954](https://github.com/TheCyberguy-17/RCE_CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #6

**来源**: [CVE-2024-7954-bigb0x_CVE-2024-7954.md](../2024/CVE-2024-7954-bigb0x_CVE-2024-7954.md)

## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #7

**来源**: [CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md](../2024/CVE-2024-7954-gh-ost00_CVE-2024-7954-RCE.md)

## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #8

**来源**: [CVE-2024-7954-issamjr_CVE-2024-7954.md](../2024/CVE-2024-7954-issamjr_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume Plugin

**危害等级:** 高危，未经身份验证的攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，且porte_plume插件已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 框架的 porte_plume 插件中，允许未经身份验证的远程攻击者执行任意 PHP 代码。漏洞原因是由于对用户输入过滤不足，允许在特定参数中注入恶意代码。利用方式是向 `/index.php?action=porte_plume_previsu` 发送精心构造的 POST 请求，其中 `data` 参数包含嵌入 PHP 代码的 payload。提供的 Python POC 脚本和 Nuclei YAML 模板都验证了这一点。Python脚本使用一系列包含PHP命令的payload（读取/etc/passwd, whoami, uname -a, id, ls -la, /var/log/auth.log）。YAML模板使用`cat /etc/passwd` 。 投毒风险较低，主要集中在脚本是否会执行额外恶意操作，以及yaml文件中是否包含恶意命令（如反弹shell）。

**项目地址:** [issamjr/CVE-2024-7954](https://github.com/issamjr/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #9

**来源**: [CVE-2024-7954-r0otk3r_CVE-2024-7954.md](../2024/CVE-2024-7954-r0otk3r_CVE-2024-7954.md)

## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

## POC #10

**来源**: [CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md](../2024/CVE-2024-7954-zxj-hub_CVE-2024-7954POC.md)

## CVE-2024-7954 SPIP porte_plume 插件任意代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP porte_plume 插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意 PHP 代码

**影响版本:** SPIP 4.30-alpha2 之前, 4.2.13 之前, 4.1.16 之前

**利用条件:** 目标系统运行受影响的 SPIP 版本，且 porte_plume 插件已启用。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 是 SPIP porte_plume 插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求来执行任意 PHP 代码，权限为 SPIP 用户。

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞被标记为严重，且已经存在公开的利用代码。从github链接中可以看到包含利用脚本。

**投毒风险：**
提供的漏洞利用代码只有`/tmp/18b46db66a1b040bcb36d2d699ec7c9a/README.md`，其内容仅为漏洞描述，不包含任何可执行代码。但是，考虑到这是一个RCE漏洞，攻击者可以在利用过程中注入恶意代码，因此存在一定的投毒风险。例如，攻击者可以将恶意代码写入服务器的配置文件或数据库中，从而实现持久化控制。因此，在利用此漏洞时，务必谨慎，避免引入恶意代码。
风险评估：较低(10%)，主要风险在于后续利用过程中引入恶意payload的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的 HTTP 请求到受影响的 SPIP 实例。
2.  **代码注入：** 特制的 HTTP 请求包含恶意的 PHP 代码。
3.  **代码执行：** SPIP 服务器执行注入的 PHP 代码，从而允许攻击者在服务器上执行任意命令。

**总结：**
CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。受影响的 SPIP 用户应立即升级到不受影响的版本。利用代码的存在使得攻击变得更加容易，但用户需要仔细验证和审计利用过程，防止被植入后门。

**项目地址:** [zxj-hub/CVE-2024-7954POC](https://github.com/zxj-hub/CVE-2024-7954POC)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)

---

