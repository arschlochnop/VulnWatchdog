# CVE-2024-32002

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md](../2024/CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且允许递归克隆包含恶意submodule的仓库。利用需要case-insensitive文件系统，且默认开启了symlink(core.symlinks=true)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002是Git中一个严重的安全漏洞，它允许攻击者通过构造恶意的Git仓库，在目标系统上执行任意代码。攻击的核心在于利用了Git处理submodule时的不严谨性，特别是在大小写不敏感的文件系统上。

**漏洞利用方式：**

1.  **恶意仓库构造：** 攻击者创建一个包含submodule的Git仓库。该submodule的URL被精心构造，包含恶意payload。利用`ssh://-oProxyCommand=payload/`格式的URL，使得在submodule初始化时，`ProxyCommand`会被执行，从而达到远程命令执行的效果。
2.  **受害者克隆：** 受害者使用Git克隆该恶意仓库，并使用 `--recurse-submodules` 参数或者配置`git config --global submodule.recurse true`。递归克隆submodules.
3.  **触发漏洞：** 在克隆过程中，Git会尝试初始化submodule。由于submodule的URL包含恶意payload，Git会执行`ProxyCommand`指定的命令，从而在受害者系统上执行攻击者预设的恶意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是[webpage 4 begin]到[webpage 6 begin]）和提供的漏洞利用代码，可以确认该漏洞是有效的。多个来源都提供了关于此漏洞的分析、利用方式和缓解措施。POC代码利用Metasploit框架模拟了恶意Git服务器，展示了如何通过构造恶意的submodule URL来执行任意命令。

**投毒风险：**

提供的Metasploit模块本身用于漏洞利用演示，主要功能是搭建一个包含恶意submodule配置的Git仓库。该模块将payload插入到`.gitmodules`文件中，并通过`ProxyCommand`执行。

虽然没有明显的“投毒”代码，但依然存在以下风险：

*   **payload隐蔽性：**攻击者可能在payload中嵌入看似无害但实则具有恶意行为的代码，例如下载执行其他恶意程序、窃取敏感信息等。这种payload可以通过混淆、加密等技术来逃避检测，因此存在一定的投毒风险。

综合评估，投毒风险较低，大约为5%。主要风险在于Payload部分可能包含恶意指令。


**项目地址:** [Basyaact/CVE-2024-32002-PoC_Chinese](https://github.com/Basyaact/CVE-2024-32002-PoC_Chinese)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #2

**来源**: [CVE-2024-32002-FlojBoj_CVE-2024-32002.md](../2024/CVE-2024-32002-FlojBoj_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** v2.45.0, v2.44.0, <=v2.43.3, <=v2.42.1, v2.41.0, <=v2.40.1, <=v2.39.3

**利用条件:** 目标系统需要安装存在漏洞的Git版本，并且文件系统大小写不敏感且支持符号链接(或配置`core.symlinks=true`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块功能中。攻击者可以构造包含恶意子模块的仓库，利用 Git 在处理子模块时可能将文件写入 `.git/` 目录而不是子模块工作目录的漏洞。通过精心构造的子模块，攻击者可以在目标机器上执行任意代码。利用过程如下：

1.  **恶意仓库准备：** 攻击者创建两个仓库 rep1 和 rep2。
2.  **rep1 (恶意子模块)：** 在 rep1 中，创建一个 `executable/hooks/post-checkout` 文件，该文件包含要执行的恶意代码（例如，启动计算器应用）。使用`git update-index --chmod=+x executable/hooks/post-checkout`命令赋予该文件执行权限，并推送到 rep1 仓库。
3.  **rep2 (主仓库)：** 在 rep2 中，将 rep1 作为子模块添加到 `A/modules/exploit` 路径下。
4.  **漏洞触发：**  关键在于创建 `dotgit.txt` 文件，内容为 `.git`，计算其哈希值，然后构造 `index.info` 文件，该文件将 `A/modules/exploit/.git` 设置为符号链接指向计算出的哈希对象，以此欺骗 Git。
5.  **克隆触发：** 当受害者使用 `git clone --recursive $REP2` 命令克隆 rep2 仓库时，Git 会尝试递归克隆子模块 rep1。
6.  **代码执行：** 由于 rep2 中 `A/modules/exploit/.git` 被伪造成符号链接，Git 在处理子模块时会将 rep1 中的 `executable/hooks/post-checkout` 文件错误地写入 `.git/hooks` 目录，从而使其成为一个 Git 钩子。`post-checkout` 钩子会在 `git clone` 操作完成后自动执行，从而触发恶意代码。

**投毒风险分析：**

  此POC本身旨在利用漏洞，但其中存在潜在的投毒风险。例如，`exploit.sh` 中定义的 `exploit` 变量决定了执行的恶意代码。虽然当前 POC 中是启动计算器，但攻击者完全可以替换为更具危害性的命令，例如下载并执行恶意脚本。虽然代码中声明“USE ONLY FOR EDUCATIONAL PURPOSES!”，但仍需谨慎使用。

**有效性分析：**

 根据漏洞描述和搜索结果，该 POC 有效。提供的 POC 代码展示了如何利用此漏洞在目标机器上执行任意代码。

**风险缓解：**

*   升级 Git 到修复后的版本。
*   避免克隆来自不受信任来源的仓库。
*   禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
*   对克隆的仓库进行安全审查。

**项目地址:** [FlojBoj/CVE-2024-32002](https://github.com/FlojBoj/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #3

**来源**: [CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md](../2024/CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md)

## CVE-2024-32002 - Git Submodule Remote Code Execution

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行，完全控制受影响系统

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 需要目标系统使用受影响的 Git 版本，且支持符号链接。利用依赖于递归克隆包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个严重的远程代码执行漏洞，它允许攻击者通过恶意构造包含子模块的 Git 仓库来执行任意代码。漏洞的核心在于 Git 在处理子模块路径时存在缺陷，攻击者可以利用此缺陷将恶意文件写入 `.git/` 目录，从而劫持 Git 的行为。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。关键在于构造一个恶意的 `.gitmodules` 文件。此文件中定义的子模块路径会被操纵，指向 `.git/` 目录内的某个位置。
2.  **符号链接欺骗：** 攻击者会创建一个符号链接，将仓库中的某个目录链接到 `.git/` 目录。例如，创建一个名为 `A` 的目录的符号链接，使其指向 `.git/`。
3.  **路径注入：** 通过组合恶意 `.gitmodules` 文件和符号链接，攻击者可以欺骗 Git 将子模块的内容写入 `.git/modules/` 目录。这允许攻击者注入恶意 hook 脚本。
4.  **触发执行：** 当受害者递归克隆（`git clone --recursive`）恶意仓库时，Git 将初始化子模块，并将恶意 hook 脚本复制到 `.git/hooks/` 目录。然后，当受害者执行诸如 `git checkout` 之类的 Git 操作时，这些恶意 hook 脚本会被触发执行，从而导致远程代码执行。

**POC 分析：**

提供的 POC 代码通过 Dockerfile 构建了一个包含漏洞 Git 版本的环境，并使用 `setup.sh` 脚本自动化了漏洞利用过程。该脚本创建了一个包含恶意 `post-checkout` hook 的子模块，修改 `.gitmodules` 文件，创建必要的符号链接，并将恶意 hook 注入到受害者的 `.git/hooks/` 目录中。当执行 `git checkout HEAD` 时，hook 脚本会被触发，在 `/tmp/teste.txt` 中写入 "joao was here"，从而验证了漏洞的存在。

**投毒风险分析：**

虽然 POC 代码的主要目的是演示漏洞，但仍然存在潜在的投毒风险。`setup.sh` 脚本包含以下可疑行为：

*   向 `/etc/sudoers` 文件添加用户，允许用户无密码执行 sudo 命令。虽然这可能是为了方便演示，但在实际环境中会带来安全风险。

考虑到这些因素，我将投毒风险评估为 10%。

**项目地址:** [JoaoLeonello/cve-2024-32002-poc](https://github.com/JoaoLeonello/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #4

**来源**: [CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md](../2024/CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致完全控制受害者机器

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 受害者需要使用受影响的Git版本克隆恶意构造的包含submodule的仓库，并且需要在大小写不敏感的文件系统上克隆。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理中。恶意攻击者可以构造包含恶意 submodule 的 Git 仓库，当受害者使用 `git clone --recurse-submodules` 命令克隆该仓库时，Git 会被诱导将文件写入 `.git/` 目录而不是 submodule 的工作目录。攻击者可以在 `.git/hooks` 目录下写入恶意 hook 脚本，这些脚本会在克隆操作期间执行，从而实现远程代码执行。攻击成功的关键在于利用了大小写不敏感文件系统的特性，使得恶意文件能够覆盖 `.git/` 目录下的合法文件。

**有效性评估：** 根据漏洞库信息和搜索结果（特别是 webpage 5），该漏洞的PoC是可用的，并且描述了利用方式。

**投毒风险评估：** 提供的 PoC 代码 `post-checkout` 脚本主要执行以下操作：

*   显示一段消息。
*   打开计算器程序 (`calc.exe`)，这是一个常见的 PoC 行为。
*   打开 Edge 浏览器并播放 YouTube 视频，同样是 PoC 行为，表明代码执行。
*   在用户 Home 目录下的每个目录中创建一个名为 `trace.txt` 的文件，写入一段消息。

虽然 PoC 代码本身没有明显的恶意行为，但创建 `trace.txt` 文件的操作可能被滥用。如果攻击者精心构造 `trace.txt` 的内容，例如包含恶意脚本或者利用其他漏洞的 payload，可能会造成进一步的危害。因此，存在一定的投毒风险，但风险相对较低，因为其行为是比较明显的。所以判定投毒概率为20%。

**利用方式：**

1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  恶意 submodule 中包含一个精心构造的 `.git/hooks/post-checkout` 脚本，该脚本包含攻击 payload。
3.  攻击者诱导受害者使用 `git clone --recurse-submodules` 命令克隆该仓库。
4.  当 Git 处理 submodule 时，会将恶意 `post-checkout` 脚本写入受害者机器的 `.git/hooks` 目录下。
5.  Git 在克隆完成后会自动执行 `post-checkout` 脚本，从而执行攻击 payload，实现远程代码执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)，但这可能会影响正常的 Git 使用。
*   避免克隆来自不受信任来源的仓库。


**项目地址:** [Julian-gmz/hook_CVE-2024-32002](https://github.com/Julian-gmz/hook_CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #5

**来源**: [CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md](../2024/CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需要使用受影响的Git版本，并且文件系统区分大小写，支持符号链接，用户需要克隆恶意仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以创建一个恶意仓库，其中包含特殊的子模块配置，使得在克隆仓库时，Git 将文件写入 `.git/` 目录而非子模块的工作目录。这允许攻击者放置一个恶意 hook 脚本到 `.git/hooks` 目录，该脚本会在克隆过程执行时被触发，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意子模块配置的Git仓库。
2.  该恶意配置指向一个包含 hook 脚本的子模块。
3.  受害者使用 `git clone --recursive` 命令克隆该仓库。
4.  Git 在处理子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
5.  克隆过程执行到一定阶段时，恶意 hook 脚本被触发，执行攻击者指定的任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞真实存在，并且有公开的PoC（例如vsociety提供的PoC）。提供的PoC代码`git clone --recursive "git@github.com:masamuneee/CVE-2024-32002-POC.git"` 可以触发漏洞。

**投毒风险：**

提供的 PoC 代码仅仅是一个 README 文件，用于演示漏洞利用的克隆命令。但是， `masamuneee/CVE-2024-32002-POC.git` 仓库本身可能包含恶意 payload（例如 hook 脚本）。虽然目前的PoC只是一个说明文件，不构成直接威胁，但是如果用户真的去克隆`git@github.com:masamuneee/CVE-2024-32002-POC.git`这个仓库,存在被投毒的风险。即使作者本意是提供PoC，也可能被其他人修改后上传带有恶意代码的版本。 因此，投毒风险评估为10%，主要源于克隆远程仓库的潜在风险，以及对作者上传的poc完整性的怀疑，毕竟用户克隆的是远程仓库，本地进行验证。

**参考链接：**

*   [https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv](https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv)
*   [https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)
*   [https://www.wiz.io/vulnerability-database/cve/cve-2024-32002](https://www.wiz.io/vulnerability-database/cve/cve-2024-32002)

**项目地址:** [Masamuneee/CVE-2024-32002-POC](https://github.com/Masamuneee/CVE-2024-32002-POC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #6

**来源**: [CVE-2024-32002-Masamuneee_hook.md](../2024/CVE-2024-32002-Masamuneee_hook.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：2.45.0, 2.44.0, >= 2.43.0 < 2.43.4, >= 2.42.0 < 2.42.2, 2.41.0, >= 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统安装Git，并且clone包含恶意submodule的仓库，利用依赖于对大小写不敏感的文件系统，并启用符号链接。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002是Git中存在的一个远程代码执行漏洞，它允许攻击者通过精心构造包含恶意submodule的Git仓库，诱导受害者clone该仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式：**
1.  攻击者创建一个包含submodule的恶意Git仓库。
2.  该submodule包含一个恶意的`.git/hooks/post-checkout` hook。
3.  利用了Git在处理submodule时，可能将文件写入`.git/`目录而不是submodule的工作目录的缺陷。
4.  当受害者在对大小写不敏感的文件系统上，且启用符号链接的情况下，clone这个仓库并检出（checkout）或者更新 submodule时，恶意hook会被执行，导致远程代码执行。

**有效性：**
提供的POC代码是有效的，因为它展示了如何创建一个包含恶意`post-checkout` hook的submodule，并在clone时触发该hook，从而执行任意命令。其中`/tmp/hacked`用于linux环境下的测试，powershell命令用于windows环境下的测试。

**投毒风险：**
虽然提供的POC代码本身是用于验证漏洞的，但如果攻击者在真实的恶意仓库中，除了POC代码之外还包含其他隐藏的恶意代码，则存在投毒风险。当前提供的POC代码中，`/tmp/e81041e852bc4e53c491bef3aef35e69/README.md` 文件和 `/tmp/e81041e852bc4e53c491bef3aef35e69/fast/hooks/post-checkout` 都可能被写入隐藏的恶意代码。假设作者有意隐藏投毒代码，可能性为20%。

**缓解措施：**
1.  升级Git到已修复的版本（>= 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, 2.39.4）。
2.  避免clone来自不受信任来源的仓库。
3.  禁用Git的符号链接支持（`git config --global core.symlinks false`）。
4.  在clone仓库后，仔细检查submodule的内容，特别是`.git/hooks`目录下的文件。

**项目地址:** [Masamuneee/hook](https://github.com/Masamuneee/hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #7

**来源**: [CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.39.4之前，以及2.40.0到2.40.2，2.41.0，2.42.0到2.42.2，2.43.0到2.43.4，2.44.0和2.45.0版本

**利用条件:** 需要目标系统启用符号链接支持，并且从恶意Git仓库克隆包含恶意submodule的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个远程代码执行 (RCE) 漏洞。该漏洞源于 Git 处理 submodules 的方式存在缺陷，攻击者可以构造恶意的 Git 仓库，其中包含一个精心设计的 submodule，该 submodule 利用了 Git 的漏洞，可以将文件写入 `.git/` 目录而不是 submodule 的工作目录。这允许攻击者在克隆操作期间执行恶意 hook，从而在受害者机器上执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的PoC是有效的。搜索结果中的 [webpage 6] 提到了一个演示如何利用该漏洞的PoC。
提供的PoC代码首先配置 Git 允许 file 协议和启用符号链接。然后，它创建一个包含恶意 post-checkout hook 的仓库 repo1。此 hook 包含一个 Payload，将在克隆 repo1 后执行。接下来，它创建一个包含 submodule 的仓库 repo2，该 submodule 指向 repo1。关键步骤是创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。最后，克隆 repo2 会触发恶意 hook，导致执行 Payload。

**投毒风险：**

该PoC本身就包含恶意代码(`<Payload>`)，用于在受害者机器上执行命令。投毒风险的评估旨在判断作者是否在PoC代码之外，还隐藏了其他的恶意代码或逻辑，用于进一步攻击或控制受害者系统。代码中可能存在潜在的投毒风险，但根据现有代码，没有找到明确的投毒代码。考虑到README中作者的个人站点链接，存在一定的概率通过其他方式植入后门，因此投毒风险预估为10%。

**利用方式：**

1.  **攻击者创建一个恶意 Git 仓库（例如 repo1），其中包含一个恶意 hook。** hook 的作用是在克隆仓库后执行 Payload。
2.  **攻击者创建一个包含 submodule 的 Git 仓库（例如 repo2），该 submodule 指向恶意仓库 repo1。**
3.  **攻击者创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。** 这一步是漏洞利用的关键，它欺骗 Git 将文件写入 `.git/` 目录。
4.  **受害者克隆仓库 repo2。** 在克隆过程中，Git 会尝试更新 submodule，由于存在符号链接，恶意 hook 将被写入 `.git/` 目录并执行，从而在受害者机器上执行 Payload。

该漏洞利用的先决条件是目标系统必须启用符号链接支持。如果 `core.symlinks` 设置为 `false`，则该漏洞无法利用。


**项目地址:** [NishanthAnand21/CVE-2024-32002-PoC](https://github.com/NishanthAnand21/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #8

**来源**: [CVE-2024-32002-SpycioKon_CVE-2024-32002.md](../2024/CVE-2024-32002-SpycioKon_CVE-2024-32002.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要存在受影响版本的Git，并且允许递归克隆包含恶意submodule的仓库，文件系统对大小写不敏感，支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个 Git 中的远程代码执行 (RCE) 漏洞，它允许攻击者通过精心制作的包含恶意 submodule 的 Git 仓库来执行任意代码。该漏洞的利用方式如下：

1.  **创建恶意仓库 (repo1)：** 攻击者创建一个包含恶意 hook 的 Git 仓库 (repo1)。在该 POC 代码中，`exp` 脚本首先克隆一个名为 `repo1` 的仓库，然后在 `y/hooks/post-checkout` 路径下创建一个恶意的 `post-checkout` hook。该 hook 包含经过 base64 编码的 PowerShell 代码，这段代码会尝试建立一个反向 shell 连接到攻击者的机器 (10.10.15.68:9999)。注意，`git config --global core.symlinks true` 启用了符号链接支持，这是利用此漏洞的关键。

2.  **创建包含恶意 submodule 的仓库 (repo2)：** 攻击者创建第二个仓库 (repo2)，并将第一个仓库 (repo1) 作为 submodule 添加进去。  POC代码执行了`git submodule add --name x/y "http://10.10.11.26:3000/admin123/repo1.git" A/modules/x`，将`repo1` 添加为 `repo2` 的子模块。然后，它创建一个名为 `dotgit.txt` 的文件，内容为 `.git`。接着，它计算该文件的哈希值，并利用该哈希值创建一个 `index.info` 文件，该文件用于创建一个指向 `.git` 目录的符号链接。

3.  **利用符号链接欺骗 Git：** 攻击者创建一个指向 `.git` 目录的符号链接。 当受害者递归克隆包含恶意 submodule 的仓库时，Git 会错误地将 hook 写入 `.git/` 目录，而不是 submodule 的工作目录。由于 `.git/` 目录下的 hook 会在克隆操作期间执行，因此攻击者可以在受害者的系统上执行任意代码。

4.  **克隆触发漏洞：** 受害者使用 `git clone --recursive repo2` 命令克隆包含恶意 submodule 的仓库 (repo2)。 当 Git 初始化 submodule 时，它会执行 `.git/` 目录中的 hook，从而触发攻击者预先植入的恶意代码。

**有效性：**根据搜索结果和漏洞描述，提供的 POC 代码是有效的，可以用来复现和验证 CVE-2024-32002 漏洞。搜索结果中多篇文章提到了利用 submodules 和符号链接将文件写入 `.git/` 目录，并执行恶意 hook。

**投毒风险：** POC 中存在一定的投毒风险。虽然主要目的是演示漏洞利用，但攻击者可能在 `post-checkout` hook 中植入额外的恶意代码，例如收集受害者系统信息、安装后门等。由于该POC主要目的是复现漏洞，其核心代码部分是漏洞利用所需的，因此判定投毒风险为10%。

**漏洞利用方式总结：**

*   攻击者创建一个包含恶意 hook 的 Git 仓库。
*   攻击者创建一个包含恶意 submodule（指向第一个仓库）的 Git 仓库。
*   攻击者在第二个仓库中创建一个指向 `.git` 目录的符号链接。
*   受害者递归克隆第二个仓库。
*   Git 错误地将 hook 写入 `.git/` 目录。
*   克隆操作期间，hook 被执行，导致 RCE。

**项目地址:** [SpycioKon/CVE-2024-32002](https://github.com/SpycioKon/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #9

**来源**: [CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md](../2024/CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标服务器需要安装受影响的Git版本，且文件系统区分大小写并支持符号链接，需要克隆包含恶意子模块的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以构造恶意的 Git 仓库，其中包含一个带有恶意配置的子模块。当用户递归克隆这个仓库时，Git 会将恶意文件写入 `.git/` 目录，而不是子模块的工作目录，导致可以执行恶意的 hook 脚本，实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 `post-checkout` hook 脚本，它会在 `git checkout` 操作后执行。脚本的内容是将 "amal_was_here" 写入 `/tmp/pwnd` 文件，并且打开计算器程序。如果目标系统成功执行了这个脚本，就可以证明该漏洞的有效性。

**投毒风险：**
POC 代码本身不包含明显的投毒行为，它只是一个简单的示例，用于验证漏洞的存在。但是，考虑到漏洞利用方式，攻击者可以修改 hook 脚本，使其包含更具破坏性的恶意代码。例如，可以执行系统命令、窃取敏感信息或者植入后门。因此，从远程仓库克隆代码时，始终存在一定的风险。
投毒风险评估为 10%，因为这个示例代码更像是概念验证，而非恶意利用，但实际攻击中，攻击者完全可以将hook脚本编写为恶意的脚本。

**利用方式：**
1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  子模块的 `.gitmodules` 文件中包含指向恶意仓库的 URL。
3.  恶意仓库的 `hooks/post-checkout` 目录包含攻击者想要执行的恶意脚本。
4.  受害者递归克隆包含恶意子模块的 Git 仓库（例如，使用 `git clone --recurse-submodules` 命令）。
5.  Git 在克隆子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
6.  当执行 `git checkout` 操作时，恶意 hook 脚本被执行，导致远程代码执行。

**项目地址:** [TSY244/CVE-2024-32002-git-rce-father-poc](https://github.com/TSY244/CVE-2024-32002-git-rce-father-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #10

**来源**: [CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md](../2024/CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 < version < 2.40.2, 2.41.0, 2.42.0 < version < 2.42.2, 2.43.0 < version < 2.43.4, 2.44.0, 2.45.0, <= 2.45.0

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统区分大小写并支持符号链接，攻击者可控的Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002是一个Git中的远程代码执行漏洞，该漏洞源于Git处理包含子模块的仓库时存在缺陷。攻击者可以构造恶意仓库，利用子模块机制，将恶意文件写入`.git/`目录而不是子模块的工作目录。由于`.git/`目录下的文件可能包含Git钩子(hooks)，这些钩子会在特定的Git操作期间被执行，从而导致任意代码执行。如果目标系统禁用了符号链接（`core.symlinks = false`），则该漏洞无法利用。从搜索结果和漏洞描述来看，多个安全厂商和社区已经公开了漏洞分析和利用方法，证明了该漏洞的有效性。提供的漏洞利用代码是Apache License 2.0的许可协议，并非实际的PoC代码，因此无法直接评估投毒风险。但根据漏洞原理，攻击者需要在恶意仓库中植入恶意的子模块和钩子脚本，才能实现远程代码执行。由于提供的代码是许可证文件，所以投毒风险判定为0%。漏洞利用方式：1. 构造包含恶意子模块的Git仓库。2. 在恶意子模块中包含恶意的Git钩子（例如 pre-commit, post-receive等）。3. 诱导受害者克隆该恶意仓库并递归初始化子模块。4. 当Git执行相关操作时，恶意的钩子脚本被触发，导致远程代码执行。

**项目地址:** [XiaomingX/cve-2024-32002-poc](https://github.com/XiaomingX/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #11

**来源**: [CVE-2024-32002-ashutosh0408_CVE-2024-32002.md](../2024/CVE-2024-32002-ashutosh0408_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需使用受影响的Git版本，且文件系统为大小写不敏感（如Windows或macOS），并允许符号链接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 是 Git 中一个允许远程代码执行的漏洞，它与子模块有关。恶意仓库可以精心构造，利用大小写不敏感文件系统上的符号链接处理缺陷，将文件写入 `.git/` 目录，进而执行恶意 hooks。

**有效性：**

根据漏洞描述和PoC代码，此PoC代码有效。多个搜索结果（如webpage 6和 webpage 7）表明存在针对此漏洞的利用，并且提供了利用成功的案例。PoC代码的 `README.md` 文件也提供了在Windows和Mac上的成功执行截图。 PoC 明确指出只能在 Windows 或 Mac 系统上工作, 这与漏洞描述中依赖大小写不敏感的文件系统相符。

**投毒风险：**

PoC代码主要由以下几个部分组成：

1.  `create_poc.sh`：用于创建利用此漏洞的恶意Git仓库。
2.  `hook/y/hooks/post-checkout` 和 `post-checkout`：这些文件包含了实际的恶意代码，也就是将在目标机器上执行的代码。这段代码会创建一个文件 `/tmp/pwnd`，并尝试运行 `calc.exe` （Windows）或 `open -a Calculator.app` （Mac）。
3.  `README.md`：提供漏洞描述和利用方法。

分析 `create_poc.sh` 脚本，其中包含一些git配置，创建一个恶意hook，并添加到git仓库中。该脚本的主要目的是自动化生成一个可被利用的恶意仓库，其本身并不包含任何隐藏的、与PoC目的无关的代码。

恶意代码部分，也就是`hook/y/hooks/post-checkout` 和 `post-checkout`脚本，其功能是创建文件和打开计算器程序。 虽然这些操作本身是无害的，但是攻击者可以替换成任何其他恶意代码，例如植入后门程序、窃取敏感数据等。

因此，判断此仓库中存在作者隐藏的投毒代码的风险较低。PoC本身包含的恶意代码是为了验证漏洞，并非隐藏的恶意功能。风险主要在于用户如果直接使用此PoC，没有意识到其潜在的危害，则可能导致安全问题。由于是公开的 PoC，其目的是演示漏洞利用，因此作者故意隐藏恶意代码的可能性较低，风险评估为5%。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个包含特殊构造路径的子模块。
2.  子模块路径使用大小写变体，以利用大小写不敏感的文件系统。
3.  子模块包含一个指向其 `.git/` 目录的符号链接，该目录包含一个恶意 hook（例如 `post-checkout`）。
4.  当用户克隆恶意仓库时，`git clone --recursive` 命令会递归初始化和更新子模块。
5.  在大小写不敏感的文件系统上，Git 会跟随符号链接，并将恶意 hook 写入 `.git/` 目录。
6.  当执行 `git checkout` 等操作时，恶意 hook 会被执行，从而导致远程代码执行。

利用成功的关键点在于大小写不敏感的文件系统和符号链接的使用，以及 Git 在处理子模块时的缺陷。


**项目地址:** [ashutosh0408/CVE-2024-32002](https://github.com/ashutosh0408/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #12

**来源**: [CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md](../2024/CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并且开启了submodule功能，文件系统区分大小写，允许创建符号链接，受害者clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞，利用方式主要通过精心构造包含恶意submodule的 Git 仓库。攻击者可以利用此漏洞，通过诱导受害者递归克隆包含恶意配置的仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式:**

1.  **创建恶意仓库：** 攻击者创建包含恶意submodule配置的Git仓库，该仓库中的submodule指向一个包含恶意hook的仓库。
2.  **恶意Hook：**  攻击者在submodule的仓库中，设置post-checkout hook，该hook会在`git clone --recursive`命令执行时被触发，从而执行攻击者预设的恶意代码。POC代码中，恶意代码为打开计算器应用。
3.  **符号链接操纵：**  利用Git对submodule处理的缺陷，通过创建指向`.git`目录的符号链接，使得恶意hook被放置在`.git/hooks`目录下，从而绕过安全检查。
4.  **诱导克隆：**  攻击者诱导受害者克隆包含恶意submodule的仓库，使用`git clone --recursive`命令。
5.  **触发RCE：**  当受害者执行`git clone --recursive`命令时，恶意hook被触发，执行攻击者预设的恶意代码，实现远程代码执行。

**POC有效性评估:**

根据提供的漏洞信息和利用代码，该POC代码是有效的。它成功演示了如何利用Git submodule的漏洞，通过创建恶意仓库和hook，在受害者机器上执行任意代码。多个搜索结果，例如webpage 6的[Exploiting git RCE: CVE-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)，也验证了该漏洞的可利用性。

**投毒风险分析:**

尽管提供的代码主要用于演示漏洞利用，但仍然存在一定的投毒风险。风险主要来自以下几个方面：

1.  **Payload替换：**  POC中使用打开计算器作为示例payload，攻击者可以轻易地替换成其他更具危害性的恶意代码，例如植入后门、窃取敏感信息等。
2.  **依赖风险：**  POC脚本依赖于特定的git命令和文件系统操作。如果攻击者修改了脚本，添加了额外的依赖或操作，可能会导致受害者系统出现未知问题。
3.  **远程仓库风险：**  虽然POC中指定了特定的远程仓库，但攻击者可能会修改脚本，指向其他包含更隐蔽或更具危害性的恶意代码的仓库。

评估结果为10%,原因在于当前代码中仅仅提供PoC思路,不存在额外恶意操作。

**项目地址:** [ashutosh0408/Cve-2024-32002-poc](https://github.com/ashutosh0408/Cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #13

**来源**: [CVE-2024-32002-blackninja23_CVE-2024-32002.md](../2024/CVE-2024-32002-blackninja23_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要在大小写不敏感的文件系统（例如Windows或macOS）上进行克隆，并且core.symlinks=true（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在递归克隆包含恶意子模块的存储库时，由于大小写不敏感的文件系统上的符号链接处理不当，导致可以将文件写入 `.git/` 目录而不是子模块的工作目录中。 这允许写入一个钩子，该钩子将在克隆操作仍在运行时执行，使用户没有机会检查正在执行的代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。PoC 代码明确展示了如何利用该漏洞在 Windows 和 macOS 系统上实现 RCE。

**投毒风险：**
该存储库存在一定的投毒风险。虽然提供的 PoC 代码看似直接，目的是展示漏洞利用，但`create_poc.sh`脚本如果被修改，则有可能植入恶意代码，导致使用者在不知情的情况下执行攻击者的恶意操作。脚本中包含的 URL `https://github.com/blackninja23/hook.git`，如果被替换成恶意仓库，存在被投毒的风险。但代码本身功能比较直白，没有过于复杂的逻辑，因此投毒风险较低，预估为10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个子模块。
2.  该子模块的路径被精心构造，利用大小写变体（例如 `A/modules/x` vs `a/modules/x`）来欺骗大小写不敏感的文件系统。
3.  该子模块包含一个符号链接，指向仓库的 `.git/` 目录。
4.  `.git/` 目录中包含一个恶意 Git 钩子（例如 `post-checkout`）。
5.  当受害者使用 `git clone --recursive` 克隆恶意仓库时，Git 会尝试递归地克隆子模块。
6.  由于大小写不敏感的文件系统，Git 可能会错误地解析子模块的路径，导致符号链接被解析到 `.git/` 目录中。
7.  恶意 Git 钩子会被执行，从而导致远程代码执行。

**项目地址:** [blackninja23/CVE-2024-32002](https://github.com/blackninja23/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #14

**来源**: [CVE-2024-32002-bonnettheo_CVE-2024-32002.md](../2024/CVE-2024-32002-bonnettheo_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要启用submodule和符号链接支持，且攻击者需要诱使用户克隆恶意构造的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 存在于 Git 中，允许攻击者通过恶意构造包含子模块的仓库，利用 Git 在不安全的上下文中写入文件的漏洞来执行任意代码。此漏洞利用了 Git 在处理子模块时的路径遍历缺陷，攻击者可以欺骗 Git 将恶意 hook 写入 `.git/` 目录而不是子模块的工作树中。当克隆操作仍在进行时，这些 hook 将被执行，使用户没有机会检查正在执行的代码。该漏洞主要影响启用了子模块和符号链接支持的系统。修复方法是升级到 Git 的安全版本(>=2.45.1, >=2.44.1, >=2.43.4, >=2.42.2, >=2.41.1, >=2.40.2, >=2.39.4) 或禁用符号链接支持(git config --global core.symlinks false)。

根据搜索引擎结果，该漏洞已得到广泛关注，并有公开的利用代码和分析文章。POC代码有效性高，能够实现远程代码执行。

该仓库的投毒风险较低，主要基于以下几点判断：

*   **代码来源：** POC代码引用了另一个开源项目，并提供了原始作者的博客链接，提高了透明度。
*   **免责声明：** 仓库包含明确的免责声明，强调仅用于教育和信息目的，禁止在未经授权的系统上运行。
*   **文件内容：** 仓库中主要包含漏洞说明和利用代码链接，没有发现额外的可疑文件或代码片段。
*   **作者信誉：** 缺乏对该仓库作者的信誉信息，无法进行有效判断。

由于缺乏直接的代码分析和作者信誉信息，无法完全排除投毒风险，但是考虑到以上的几点，判定投毒的可能性较低。建议在运行POC代码时，务必进行代码审计和安全评估，以避免潜在的风险。

**项目地址:** [bonnettheo/CVE-2024-32002](https://github.com/bonnettheo/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #15

**来源**: [CVE-2024-32002-charlesgargasson_CVE-2024-32002.md](../2024/CVE-2024-32002-charlesgargasson_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 ~ 2.40.2, 2.41.0, 2.42.0 ~ 2.42.2, 2.43.0 ~ 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标Git版本受影响，且启用了submodule和符号链接，在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在处理包含 submodule 的仓库时，允许攻击者通过构造恶意的仓库，将文件写入 `.git/` 目录而不是 submodule 的工作目录中。 这样，攻击者就可以写入一个 hook 脚本，该脚本在克隆操作仍在运行时执行，从而实现远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule，并在该 submodule 中包含一个恶意的 `.gitmodules` 文件和一个 hook 脚本 (例如 `post-checkout`)。
2.  恶意 `.gitmodules` 文件包含指向攻击者控制的另一个仓库的 URL。这个仓库包含恶意的 hook 脚本。
3.  当受害者使用 `git clone --recursive` 命令克隆包含恶意 submodule 的仓库时，Git 会递归地克隆 submodule。
4.  在克隆 submodule 的过程中，由于漏洞，恶意 hook 脚本会被写入到受害者的 `.git/` 目录中，而不是 submodule 的工作目录中。
5.  当 Git 执行 hook 脚本时，攻击者就可以在受害者的系统上执行任意代码。

**有效性：**

根据漏洞描述、搜索结果（特别是vicarius.io的分析文章）和提供的 POC 代码，该漏洞是有效的。POC 代码展示了如何创建恶意仓库，触发漏洞并执行任意命令。

**投毒风险：**

该 POC 代码的目的是演示漏洞利用，但仍然存在一定的投毒风险，约为 10%。这种风险主要来自于以下几个方面：

1.  **反弹shell的IP和端口：** POC 代码中嵌入了反弹 shell 的 IP 地址和端口。攻击者可能会修改这些值，将 shell 反弹到他们控制的服务器上。
2.  **后门代码：** 攻击者可能会在 hook 脚本中添加额外的后门代码，以便在受害者系统上植入持久性的恶意软件。
3.  **依赖库：** 攻击者可能会修改 POC 代码，使其依赖于恶意的第三方库，这些库可能包含恶意代码。

尽管存在这些风险，但该 POC 代码的主要目的是演示漏洞利用，而不是进行恶意攻击。 用户在使用时仍然需要谨慎，确保对代码进行适当的审查和修改，以避免潜在的风险。

**项目地址:** [charlesgargasson/CVE-2024-32002](https://github.com/charlesgargasson/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #16

**来源**: [CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md](../2024/CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统必须使用大小写不敏感的文件系统且启用符号链接（或未禁用）。需要能够访问恶意Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002 漏洞允许攻击者通过构造包含恶意子模块的 Git 仓库，在目标系统上实现远程代码执行。漏洞原理是当Git在大小写不敏感的文件系统上递归克隆包含子模块的仓库时，攻击者可以利用大小写差异将文件写入 `.git/` 目录，从而覆盖或创建恶意 hook。当执行 `git clone --recursive` 命令时，恶意 hook 会被触发，导致任意代码执行。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。该子模块的路径经过特殊构造，利用大小写差异（例如 `A/modules/x` 和 `a/modules/x`）以及符号链接，指向子模块的 `.git/` 目录。
2.  **植入恶意Hook：** 在子模块的 `.git/hooks/` 目录下放置恶意的 Git hook 脚本（例如 `post-checkout`）。
3.  **诱导克隆：** 诱导受害者使用 `git clone --recursive` 命令克隆该恶意仓库。
4.  **触发执行：** 当受害者克隆仓库时，由于文件系统的大小写不敏感特性和符号链接，恶意 hook 会被写入 `.git/` 目录并被执行，导致远程代码执行。

**POC有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码有效。它演示了如何通过精心构造的 Git 仓库和子模块，利用 Git 的递归克隆功能在目标系统上执行任意代码。POC需要用户输入gitea服务器的ip地址、用户名和api token，然后创建两个仓库，并在其中一个仓库中添加恶意hook。另外, 需要手动修改 .gitmodules 文件，指向包含恶意hook的仓库。

**投毒风险评估：**

提供的POC代码主要用于演示漏洞的利用，旨在帮助安全研究人员理解和复现该漏洞。其中涉及的恶意代码（如在 hook 中执行 `calc.exe`）仅用于演示 RCE，并非旨在窃取或破坏用户数据，不构成直接的投毒行为。虽然该POC代码本身不包含投毒代码，但如果被恶意使用者利用，可能会被修改以植入更具破坏性的代码。 因此,投毒的风险概率为0%。

**缓解措施：**

1.  升级 Git 版本到已修复该漏洞的版本（>= 2.39.4, >= 2.40.2, >= 2.41.1, >= 2.42.2, >= 2.43.4, >= 2.44.1, >= 2.45.1）。
2.  禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
3.  避免克隆来自不受信任来源的 Git 仓库。


**项目地址:** [chrisWalker11/running-CVE-2024-32002-locally-for-tesing](https://github.com/chrisWalker11/running-CVE-2024-32002-locally-for-tesing)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #17

**来源**: [CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md](../2024/CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md)

## CVE-2024-32002

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并允许递归克隆包含恶意submodule的仓库。目标文件系统需要大小写不敏感且支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理机制中。攻击者可以构造包含恶意 submodule 的仓库，当受害者递归克隆该仓库时，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。这样，攻击者就可以在克隆过程中执行恶意 hook，从而实现远程代码执行。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞是一个远程代码执行漏洞，利用 submodules 中的缺陷，通过在`.git/`目录下写入恶意 hook 脚本，在 clone 过程中执行该脚本，从而实现 RCE。提供的POC代码尝试模拟此攻击，克隆恶意仓库，设置 git 配置以允许文件协议和符号链接，然后创建包含恶意payload的post-checkout hook，并将其推送到远端仓库，最后添加恶意的submodule。因此，提供的POC代码在满足漏洞利用条件的情况下是有效的。

**投毒风险分析：**
POC代码中存在潜在的投毒风险，作者可能通过恶意修改`shell.sh`，在受害者执行漏洞利用代码时执行意料之外的代码。例如，作者可能添加代码来窃取受害者的凭据、安装后门或进行其他恶意活动。但是从现有代码看，可能性较低。判断依据如下：

*   `rm -rf nothing` 和 `rm -rf toSeeHere` 看上去是无害的操作，但可能用于清理攻击痕迹，或者迷惑分析人员。
*   设置全局git配置，例如`git config --global protocol.file.allow always`，可能允许其他攻击向量。如果受害者在其他环境中使用了被更改的全局git配置，可能会带来安全风险。
*   `git clone http://<server ip>:<port>/<username>/repo1.git` 和 `git clone http://<server ip>:<port>/<username>/repo2.git` 依赖外部的git服务器。该服务器可能包含后门代码，或者在特定的IP/用户环境下，返回不同的内容，实现有选择的攻击。
*   `cat > y/hooks/post-checkout <<EOF
#!bin/sh.exe
#your payload goes here
EOF` 这部分是payload注入点, 攻击者可以伪装成漏洞利用代码，将恶意代码放在此处。

**利用方式分析：**
1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  在 submodule 中，攻击者创建一个 hook 脚本（例如 `post-checkout`），该脚本包含恶意代码。
3.  攻击者将 submodule 添加到主仓库中，并创建一个特殊的 `.git` 文件或符号链接，指向恶意 submodule 的 `.git` 目录。
4.  当受害者递归克隆包含恶意 submodule 的仓库时，Git 会尝试初始化 submodule。
5.  由于存在特殊的 `.git` 文件或符号链接，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。
6.  写入 `.git/` 目录中的 hook 脚本会被执行，从而实现远程代码执行。

**项目地址:** [daemon-reconfig/CVE-2024-32002](https://github.com/daemon-reconfig/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #18

**来源**: [CVE-2024-32002-grecosamuel_CVE-2024-32002.md](../2024/CVE-2024-32002-grecosamuel_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统安装受影响版本的Git，且允许clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个存在于 Git submodules 中的远程代码执行漏洞。当 Git 在大小写不敏感的文件系统上递归克隆存储库时，攻击者可以利用此漏洞。通过精心构造包含恶意 submodule 的 Git 仓库，攻击者可以欺骗 Git 将文件写入到 `.git/` 目录，而不是 submodule 的工作目录中。这使得攻击者可以写入一个 hook 文件，该 hook 文件在 clone 操作期间执行，从而实现远程代码执行。该漏洞的利用依赖于 `core.symlinks` 配置项是否启用。如果 `core.symlinks` 被禁用，攻击将无法成功。提供的 POC 代码通过创建一个包含恶意 post-checkout hook 的 submodule，然后将其包含在一个主仓库中。当受害者克隆主仓库时，post-checkout hook 会被执行，从而导致代码执行。考虑到此漏洞的利用方式，远程仓库本身就可能包含恶意代码，存在一定投毒的风险。

**漏洞利用方式:**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule。
2.  Submodule 包含一个恶意的 `post-checkout` hook，用于执行攻击者的 payload。
3.  攻击者诱使受害者克隆包含恶意 submodule 的仓库。
4.  在克隆过程中，Git 会递归克隆 submodule。
5.  由于漏洞，恶意的 `post-checkout` hook 被写入 `.git/` 目录并执行，导致 RCE。

**POC 代码分析和投毒风险评估:**
提供的POC代码主要功能是自动化漏洞利用流程, 简化了恶意仓库的创建过程。代码本身没有明显的投毒行为。 投毒风险主要来源于clone的远程仓库本身。POC中push到远程仓库步骤也有潜在的投毒风险，虽然可能性较低，但不能完全排除。

**有效性:**
根据搜索引擎结果，有多个来源证实了此漏洞的存在以及POC的有效性。

**项目地址:** [grecosamuel/CVE-2024-32002](https://github.com/grecosamuel/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #19

**来源**: [CVE-2024-32002-sanan2004_CVE-2024-32002.md](../2024/CVE-2024-32002-sanan2004_CVE-2024-32002.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统开启 symlinks 支持 (core.symlinks = true)，且攻击者能够控制一个包含恶意配置的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造的包含恶意子模块的 Git 仓库，在克隆仓库的用户的系统上执行任意代码。漏洞的根源在于 Git 在处理子模块时，可能将文件写入 `.git/` 目录而非子模块的工作目录。这使得攻击者可以放置一个 Git hook (例如 `post-checkout`) 在克隆操作期间执行。PoC 的利用方式是：

1.  **准备恶意仓库 (hulk.git):** 该仓库包含一个 `post-checkout` hook，hook 的内容是恶意payload（示例中是打开计算器）。这个hook会被放置在 `.git/hooks/` 目录下。
2.  **准备包含恶意子模块的仓库 (submod.git):** 该仓库将恶意仓库 (`hulk.git`) 添加为子模块，并创建一个指向 `.git` 目录的符号链接。关键的一步是使用`git update-index`命令来创建一个指向 `.git` 目录的符号链接。
3.  **准备最终的触发仓库 (smash.git):** 用户克隆该仓库时，由于递归克隆子模块，符号链接会被错误地解析，导致 `post-checkout` hook 被复制到 `.git/hooks/` 目录下，并在克隆过程的某个阶段执行，从而实现 RCE。

**有效性：** 提供的 PoC 代码是有效的，如果满足先决条件（易受攻击的 Git 版本和启用的符号链接），则可以成功触发 RCE。

**投毒风险：** PoC 本身的主要功能是演示漏洞，但由于代码的复杂性，存在细微的投毒风险。例如，`poc.sh` 脚本中可以被加入额外命令，在执行漏洞利用的同时，进行其他恶意操作，例如收集用户信息、安装后门程序等。此外，`hulk.git`仓库中可以存在除计算器之外的其他恶意payload。因此,投毒风险评估为10%。

**利用方式：** 攻击者需要控制一个 Git 仓库，并诱导受害者递归克隆该仓库。一旦受害者执行了 `git clone --recursive <恶意仓库>` 命令，恶意代码就会在其系统上执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用符号链接支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不受信任来源的仓库。

**项目地址:** [sanan2004/CVE-2024-32002](https://github.com/sanan2004/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #20

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-demo.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-demo.md)

## CVE-2024-32002-Git递归克隆远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许未经身份验证的攻击者在受害者机器上执行任意代码

**影响版本:** < 2.39.4, >= 2.40.0 < 2.40.2, = 2.41.0, >= 2.42.0 < 2.42.2, >= 2.43.0 < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标系统需要使用受影响版本的Git，且需要在大小写不敏感的文件系统（例如macOS的默认设置，Windows）上克隆包含恶意配置的仓库，同时`core.symlinks`配置未显式设置为`false`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造包含恶意子模块的 Git 仓库，利用 Git 在大小写不敏感的文件系统上的处理缺陷，将恶意 hook 写入 `.git/` 目录，从而在克隆仓库时执行任意代码。攻击者可以诱骗用户克隆恶意仓库，从而在用户不知情的情况下执行恶意代码。

**有效性分析：**

根据漏洞描述，提供的POC代码旨在演示如何利用此漏洞。通过`git clone --recursive`命令克隆该仓库，如果目标系统满足漏洞触发条件（受影响的Git版本，大小写不敏感的文件系统，未禁用符号链接），则可能触发漏洞，导致恶意代码执行。提供的POC利用方法符合漏洞描述，因此POC**可能有效**。

**投毒风险分析：**

提供的代码片段包括：

*   `/README.md`: 包含克隆仓库的说明。
*   `/docs/README.md`: 简单的文档说明。
*   `/src/example.py`: 一个简单的Python脚本，用于处理数据并打印结果。

初步分析表明，提供的代码本身并没有明显的恶意代码或后门。主要的风险在于该仓库可能包含隐藏的恶意 Git 配置（例如存在于.gitmodules或者.git/hooks中）或者子模块，当使用`git clone --recursive`时被自动执行。

由于无法直接看到.git目录下的文件，因此无法完全排除投毒风险。假设`git clone --recursive` 命令在满足条件下，自动触发恶意hook的可能性比较低，但是仍然存在。因此这里给出了5%的投毒可能性。

**利用方式：**

1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  恶意子模块包含一个 hook，该 hook 会在仓库被克隆时执行任意代码。
3.  攻击者诱骗受害者克隆该恶意仓库。
4.  当受害者使用 `git clone --recursive` 命令克隆仓库时，恶意 hook 被执行，从而导致远程代码执行。

要减轻此漏洞的影响，用户应避免克隆来自不受信任来源的仓库，并确保使用的 Git 版本已更新到修复此漏洞的版本。 此外，如果不需要符号链接，可以禁用符号链接支持，通过设置`git config --global core.symlinks false`来缓解风险。

**项目地址:** [srakkk/cve-2024-32002-demo](https://github.com/srakkk/cve-2024-32002-demo)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #21

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-hook.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-hook.md)

# CVE-2024-32002

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md](../2024/CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且允许递归克隆包含恶意submodule的仓库。利用需要case-insensitive文件系统，且默认开启了symlink(core.symlinks=true)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002是Git中一个严重的安全漏洞，它允许攻击者通过构造恶意的Git仓库，在目标系统上执行任意代码。攻击的核心在于利用了Git处理submodule时的不严谨性，特别是在大小写不敏感的文件系统上。

**漏洞利用方式：**

1.  **恶意仓库构造：** 攻击者创建一个包含submodule的Git仓库。该submodule的URL被精心构造，包含恶意payload。利用`ssh://-oProxyCommand=payload/`格式的URL，使得在submodule初始化时，`ProxyCommand`会被执行，从而达到远程命令执行的效果。
2.  **受害者克隆：** 受害者使用Git克隆该恶意仓库，并使用 `--recurse-submodules` 参数或者配置`git config --global submodule.recurse true`。递归克隆submodules.
3.  **触发漏洞：** 在克隆过程中，Git会尝试初始化submodule。由于submodule的URL包含恶意payload，Git会执行`ProxyCommand`指定的命令，从而在受害者系统上执行攻击者预设的恶意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是[webpage 4 begin]到[webpage 6 begin]）和提供的漏洞利用代码，可以确认该漏洞是有效的。多个来源都提供了关于此漏洞的分析、利用方式和缓解措施。POC代码利用Metasploit框架模拟了恶意Git服务器，展示了如何通过构造恶意的submodule URL来执行任意命令。

**投毒风险：**

提供的Metasploit模块本身用于漏洞利用演示，主要功能是搭建一个包含恶意submodule配置的Git仓库。该模块将payload插入到`.gitmodules`文件中，并通过`ProxyCommand`执行。

虽然没有明显的“投毒”代码，但依然存在以下风险：

*   **payload隐蔽性：**攻击者可能在payload中嵌入看似无害但实则具有恶意行为的代码，例如下载执行其他恶意程序、窃取敏感信息等。这种payload可以通过混淆、加密等技术来逃避检测，因此存在一定的投毒风险。

综合评估，投毒风险较低，大约为5%。主要风险在于Payload部分可能包含恶意指令。


**项目地址:** [Basyaact/CVE-2024-32002-PoC_Chinese](https://github.com/Basyaact/CVE-2024-32002-PoC_Chinese)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #2

**来源**: [CVE-2024-32002-FlojBoj_CVE-2024-32002.md](../2024/CVE-2024-32002-FlojBoj_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** v2.45.0, v2.44.0, <=v2.43.3, <=v2.42.1, v2.41.0, <=v2.40.1, <=v2.39.3

**利用条件:** 目标系统需要安装存在漏洞的Git版本，并且文件系统大小写不敏感且支持符号链接(或配置`core.symlinks=true`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块功能中。攻击者可以构造包含恶意子模块的仓库，利用 Git 在处理子模块时可能将文件写入 `.git/` 目录而不是子模块工作目录的漏洞。通过精心构造的子模块，攻击者可以在目标机器上执行任意代码。利用过程如下：

1.  **恶意仓库准备：** 攻击者创建两个仓库 rep1 和 rep2。
2.  **rep1 (恶意子模块)：** 在 rep1 中，创建一个 `executable/hooks/post-checkout` 文件，该文件包含要执行的恶意代码（例如，启动计算器应用）。使用`git update-index --chmod=+x executable/hooks/post-checkout`命令赋予该文件执行权限，并推送到 rep1 仓库。
3.  **rep2 (主仓库)：** 在 rep2 中，将 rep1 作为子模块添加到 `A/modules/exploit` 路径下。
4.  **漏洞触发：**  关键在于创建 `dotgit.txt` 文件，内容为 `.git`，计算其哈希值，然后构造 `index.info` 文件，该文件将 `A/modules/exploit/.git` 设置为符号链接指向计算出的哈希对象，以此欺骗 Git。
5.  **克隆触发：** 当受害者使用 `git clone --recursive $REP2` 命令克隆 rep2 仓库时，Git 会尝试递归克隆子模块 rep1。
6.  **代码执行：** 由于 rep2 中 `A/modules/exploit/.git` 被伪造成符号链接，Git 在处理子模块时会将 rep1 中的 `executable/hooks/post-checkout` 文件错误地写入 `.git/hooks` 目录，从而使其成为一个 Git 钩子。`post-checkout` 钩子会在 `git clone` 操作完成后自动执行，从而触发恶意代码。

**投毒风险分析：**

  此POC本身旨在利用漏洞，但其中存在潜在的投毒风险。例如，`exploit.sh` 中定义的 `exploit` 变量决定了执行的恶意代码。虽然当前 POC 中是启动计算器，但攻击者完全可以替换为更具危害性的命令，例如下载并执行恶意脚本。虽然代码中声明“USE ONLY FOR EDUCATIONAL PURPOSES!”，但仍需谨慎使用。

**有效性分析：**

 根据漏洞描述和搜索结果，该 POC 有效。提供的 POC 代码展示了如何利用此漏洞在目标机器上执行任意代码。

**风险缓解：**

*   升级 Git 到修复后的版本。
*   避免克隆来自不受信任来源的仓库。
*   禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
*   对克隆的仓库进行安全审查。

**项目地址:** [FlojBoj/CVE-2024-32002](https://github.com/FlojBoj/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #3

**来源**: [CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md](../2024/CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md)

## CVE-2024-32002 - Git Submodule Remote Code Execution

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行，完全控制受影响系统

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 需要目标系统使用受影响的 Git 版本，且支持符号链接。利用依赖于递归克隆包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个严重的远程代码执行漏洞，它允许攻击者通过恶意构造包含子模块的 Git 仓库来执行任意代码。漏洞的核心在于 Git 在处理子模块路径时存在缺陷，攻击者可以利用此缺陷将恶意文件写入 `.git/` 目录，从而劫持 Git 的行为。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。关键在于构造一个恶意的 `.gitmodules` 文件。此文件中定义的子模块路径会被操纵，指向 `.git/` 目录内的某个位置。
2.  **符号链接欺骗：** 攻击者会创建一个符号链接，将仓库中的某个目录链接到 `.git/` 目录。例如，创建一个名为 `A` 的目录的符号链接，使其指向 `.git/`。
3.  **路径注入：** 通过组合恶意 `.gitmodules` 文件和符号链接，攻击者可以欺骗 Git 将子模块的内容写入 `.git/modules/` 目录。这允许攻击者注入恶意 hook 脚本。
4.  **触发执行：** 当受害者递归克隆（`git clone --recursive`）恶意仓库时，Git 将初始化子模块，并将恶意 hook 脚本复制到 `.git/hooks/` 目录。然后，当受害者执行诸如 `git checkout` 之类的 Git 操作时，这些恶意 hook 脚本会被触发执行，从而导致远程代码执行。

**POC 分析：**

提供的 POC 代码通过 Dockerfile 构建了一个包含漏洞 Git 版本的环境，并使用 `setup.sh` 脚本自动化了漏洞利用过程。该脚本创建了一个包含恶意 `post-checkout` hook 的子模块，修改 `.gitmodules` 文件，创建必要的符号链接，并将恶意 hook 注入到受害者的 `.git/hooks/` 目录中。当执行 `git checkout HEAD` 时，hook 脚本会被触发，在 `/tmp/teste.txt` 中写入 "joao was here"，从而验证了漏洞的存在。

**投毒风险分析：**

虽然 POC 代码的主要目的是演示漏洞，但仍然存在潜在的投毒风险。`setup.sh` 脚本包含以下可疑行为：

*   向 `/etc/sudoers` 文件添加用户，允许用户无密码执行 sudo 命令。虽然这可能是为了方便演示，但在实际环境中会带来安全风险。

考虑到这些因素，我将投毒风险评估为 10%。

**项目地址:** [JoaoLeonello/cve-2024-32002-poc](https://github.com/JoaoLeonello/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #4

**来源**: [CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md](../2024/CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致完全控制受害者机器

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 受害者需要使用受影响的Git版本克隆恶意构造的包含submodule的仓库，并且需要在大小写不敏感的文件系统上克隆。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理中。恶意攻击者可以构造包含恶意 submodule 的 Git 仓库，当受害者使用 `git clone --recurse-submodules` 命令克隆该仓库时，Git 会被诱导将文件写入 `.git/` 目录而不是 submodule 的工作目录。攻击者可以在 `.git/hooks` 目录下写入恶意 hook 脚本，这些脚本会在克隆操作期间执行，从而实现远程代码执行。攻击成功的关键在于利用了大小写不敏感文件系统的特性，使得恶意文件能够覆盖 `.git/` 目录下的合法文件。

**有效性评估：** 根据漏洞库信息和搜索结果（特别是 webpage 5），该漏洞的PoC是可用的，并且描述了利用方式。

**投毒风险评估：** 提供的 PoC 代码 `post-checkout` 脚本主要执行以下操作：

*   显示一段消息。
*   打开计算器程序 (`calc.exe`)，这是一个常见的 PoC 行为。
*   打开 Edge 浏览器并播放 YouTube 视频，同样是 PoC 行为，表明代码执行。
*   在用户 Home 目录下的每个目录中创建一个名为 `trace.txt` 的文件，写入一段消息。

虽然 PoC 代码本身没有明显的恶意行为，但创建 `trace.txt` 文件的操作可能被滥用。如果攻击者精心构造 `trace.txt` 的内容，例如包含恶意脚本或者利用其他漏洞的 payload，可能会造成进一步的危害。因此，存在一定的投毒风险，但风险相对较低，因为其行为是比较明显的。所以判定投毒概率为20%。

**利用方式：**

1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  恶意 submodule 中包含一个精心构造的 `.git/hooks/post-checkout` 脚本，该脚本包含攻击 payload。
3.  攻击者诱导受害者使用 `git clone --recurse-submodules` 命令克隆该仓库。
4.  当 Git 处理 submodule 时，会将恶意 `post-checkout` 脚本写入受害者机器的 `.git/hooks` 目录下。
5.  Git 在克隆完成后会自动执行 `post-checkout` 脚本，从而执行攻击 payload，实现远程代码执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)，但这可能会影响正常的 Git 使用。
*   避免克隆来自不受信任来源的仓库。


**项目地址:** [Julian-gmz/hook_CVE-2024-32002](https://github.com/Julian-gmz/hook_CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #5

**来源**: [CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md](../2024/CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需要使用受影响的Git版本，并且文件系统区分大小写，支持符号链接，用户需要克隆恶意仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以创建一个恶意仓库，其中包含特殊的子模块配置，使得在克隆仓库时，Git 将文件写入 `.git/` 目录而非子模块的工作目录。这允许攻击者放置一个恶意 hook 脚本到 `.git/hooks` 目录，该脚本会在克隆过程执行时被触发，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意子模块配置的Git仓库。
2.  该恶意配置指向一个包含 hook 脚本的子模块。
3.  受害者使用 `git clone --recursive` 命令克隆该仓库。
4.  Git 在处理子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
5.  克隆过程执行到一定阶段时，恶意 hook 脚本被触发，执行攻击者指定的任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞真实存在，并且有公开的PoC（例如vsociety提供的PoC）。提供的PoC代码`git clone --recursive "git@github.com:masamuneee/CVE-2024-32002-POC.git"` 可以触发漏洞。

**投毒风险：**

提供的 PoC 代码仅仅是一个 README 文件，用于演示漏洞利用的克隆命令。但是， `masamuneee/CVE-2024-32002-POC.git` 仓库本身可能包含恶意 payload（例如 hook 脚本）。虽然目前的PoC只是一个说明文件，不构成直接威胁，但是如果用户真的去克隆`git@github.com:masamuneee/CVE-2024-32002-POC.git`这个仓库,存在被投毒的风险。即使作者本意是提供PoC，也可能被其他人修改后上传带有恶意代码的版本。 因此，投毒风险评估为10%，主要源于克隆远程仓库的潜在风险，以及对作者上传的poc完整性的怀疑，毕竟用户克隆的是远程仓库，本地进行验证。

**参考链接：**

*   [https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv](https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv)
*   [https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)
*   [https://www.wiz.io/vulnerability-database/cve/cve-2024-32002](https://www.wiz.io/vulnerability-database/cve/cve-2024-32002)

**项目地址:** [Masamuneee/CVE-2024-32002-POC](https://github.com/Masamuneee/CVE-2024-32002-POC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #6

**来源**: [CVE-2024-32002-Masamuneee_hook.md](../2024/CVE-2024-32002-Masamuneee_hook.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：2.45.0, 2.44.0, >= 2.43.0 < 2.43.4, >= 2.42.0 < 2.42.2, 2.41.0, >= 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统安装Git，并且clone包含恶意submodule的仓库，利用依赖于对大小写不敏感的文件系统，并启用符号链接。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002是Git中存在的一个远程代码执行漏洞，它允许攻击者通过精心构造包含恶意submodule的Git仓库，诱导受害者clone该仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式：**
1.  攻击者创建一个包含submodule的恶意Git仓库。
2.  该submodule包含一个恶意的`.git/hooks/post-checkout` hook。
3.  利用了Git在处理submodule时，可能将文件写入`.git/`目录而不是submodule的工作目录的缺陷。
4.  当受害者在对大小写不敏感的文件系统上，且启用符号链接的情况下，clone这个仓库并检出（checkout）或者更新 submodule时，恶意hook会被执行，导致远程代码执行。

**有效性：**
提供的POC代码是有效的，因为它展示了如何创建一个包含恶意`post-checkout` hook的submodule，并在clone时触发该hook，从而执行任意命令。其中`/tmp/hacked`用于linux环境下的测试，powershell命令用于windows环境下的测试。

**投毒风险：**
虽然提供的POC代码本身是用于验证漏洞的，但如果攻击者在真实的恶意仓库中，除了POC代码之外还包含其他隐藏的恶意代码，则存在投毒风险。当前提供的POC代码中，`/tmp/e81041e852bc4e53c491bef3aef35e69/README.md` 文件和 `/tmp/e81041e852bc4e53c491bef3aef35e69/fast/hooks/post-checkout` 都可能被写入隐藏的恶意代码。假设作者有意隐藏投毒代码，可能性为20%。

**缓解措施：**
1.  升级Git到已修复的版本（>= 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, 2.39.4）。
2.  避免clone来自不受信任来源的仓库。
3.  禁用Git的符号链接支持（`git config --global core.symlinks false`）。
4.  在clone仓库后，仔细检查submodule的内容，特别是`.git/hooks`目录下的文件。

**项目地址:** [Masamuneee/hook](https://github.com/Masamuneee/hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #7

**来源**: [CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.39.4之前，以及2.40.0到2.40.2，2.41.0，2.42.0到2.42.2，2.43.0到2.43.4，2.44.0和2.45.0版本

**利用条件:** 需要目标系统启用符号链接支持，并且从恶意Git仓库克隆包含恶意submodule的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个远程代码执行 (RCE) 漏洞。该漏洞源于 Git 处理 submodules 的方式存在缺陷，攻击者可以构造恶意的 Git 仓库，其中包含一个精心设计的 submodule，该 submodule 利用了 Git 的漏洞，可以将文件写入 `.git/` 目录而不是 submodule 的工作目录。这允许攻击者在克隆操作期间执行恶意 hook，从而在受害者机器上执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的PoC是有效的。搜索结果中的 [webpage 6] 提到了一个演示如何利用该漏洞的PoC。
提供的PoC代码首先配置 Git 允许 file 协议和启用符号链接。然后，它创建一个包含恶意 post-checkout hook 的仓库 repo1。此 hook 包含一个 Payload，将在克隆 repo1 后执行。接下来，它创建一个包含 submodule 的仓库 repo2，该 submodule 指向 repo1。关键步骤是创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。最后，克隆 repo2 会触发恶意 hook，导致执行 Payload。

**投毒风险：**

该PoC本身就包含恶意代码(`<Payload>`)，用于在受害者机器上执行命令。投毒风险的评估旨在判断作者是否在PoC代码之外，还隐藏了其他的恶意代码或逻辑，用于进一步攻击或控制受害者系统。代码中可能存在潜在的投毒风险，但根据现有代码，没有找到明确的投毒代码。考虑到README中作者的个人站点链接，存在一定的概率通过其他方式植入后门，因此投毒风险预估为10%。

**利用方式：**

1.  **攻击者创建一个恶意 Git 仓库（例如 repo1），其中包含一个恶意 hook。** hook 的作用是在克隆仓库后执行 Payload。
2.  **攻击者创建一个包含 submodule 的 Git 仓库（例如 repo2），该 submodule 指向恶意仓库 repo1。**
3.  **攻击者创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。** 这一步是漏洞利用的关键，它欺骗 Git 将文件写入 `.git/` 目录。
4.  **受害者克隆仓库 repo2。** 在克隆过程中，Git 会尝试更新 submodule，由于存在符号链接，恶意 hook 将被写入 `.git/` 目录并执行，从而在受害者机器上执行 Payload。

该漏洞利用的先决条件是目标系统必须启用符号链接支持。如果 `core.symlinks` 设置为 `false`，则该漏洞无法利用。


**项目地址:** [NishanthAnand21/CVE-2024-32002-PoC](https://github.com/NishanthAnand21/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #8

**来源**: [CVE-2024-32002-SpycioKon_CVE-2024-32002.md](../2024/CVE-2024-32002-SpycioKon_CVE-2024-32002.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要存在受影响版本的Git，并且允许递归克隆包含恶意submodule的仓库，文件系统对大小写不敏感，支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个 Git 中的远程代码执行 (RCE) 漏洞，它允许攻击者通过精心制作的包含恶意 submodule 的 Git 仓库来执行任意代码。该漏洞的利用方式如下：

1.  **创建恶意仓库 (repo1)：** 攻击者创建一个包含恶意 hook 的 Git 仓库 (repo1)。在该 POC 代码中，`exp` 脚本首先克隆一个名为 `repo1` 的仓库，然后在 `y/hooks/post-checkout` 路径下创建一个恶意的 `post-checkout` hook。该 hook 包含经过 base64 编码的 PowerShell 代码，这段代码会尝试建立一个反向 shell 连接到攻击者的机器 (10.10.15.68:9999)。注意，`git config --global core.symlinks true` 启用了符号链接支持，这是利用此漏洞的关键。

2.  **创建包含恶意 submodule 的仓库 (repo2)：** 攻击者创建第二个仓库 (repo2)，并将第一个仓库 (repo1) 作为 submodule 添加进去。  POC代码执行了`git submodule add --name x/y "http://10.10.11.26:3000/admin123/repo1.git" A/modules/x`，将`repo1` 添加为 `repo2` 的子模块。然后，它创建一个名为 `dotgit.txt` 的文件，内容为 `.git`。接着，它计算该文件的哈希值，并利用该哈希值创建一个 `index.info` 文件，该文件用于创建一个指向 `.git` 目录的符号链接。

3.  **利用符号链接欺骗 Git：** 攻击者创建一个指向 `.git` 目录的符号链接。 当受害者递归克隆包含恶意 submodule 的仓库时，Git 会错误地将 hook 写入 `.git/` 目录，而不是 submodule 的工作目录。由于 `.git/` 目录下的 hook 会在克隆操作期间执行，因此攻击者可以在受害者的系统上执行任意代码。

4.  **克隆触发漏洞：** 受害者使用 `git clone --recursive repo2` 命令克隆包含恶意 submodule 的仓库 (repo2)。 当 Git 初始化 submodule 时，它会执行 `.git/` 目录中的 hook，从而触发攻击者预先植入的恶意代码。

**有效性：**根据搜索结果和漏洞描述，提供的 POC 代码是有效的，可以用来复现和验证 CVE-2024-32002 漏洞。搜索结果中多篇文章提到了利用 submodules 和符号链接将文件写入 `.git/` 目录，并执行恶意 hook。

**投毒风险：** POC 中存在一定的投毒风险。虽然主要目的是演示漏洞利用，但攻击者可能在 `post-checkout` hook 中植入额外的恶意代码，例如收集受害者系统信息、安装后门等。由于该POC主要目的是复现漏洞，其核心代码部分是漏洞利用所需的，因此判定投毒风险为10%。

**漏洞利用方式总结：**

*   攻击者创建一个包含恶意 hook 的 Git 仓库。
*   攻击者创建一个包含恶意 submodule（指向第一个仓库）的 Git 仓库。
*   攻击者在第二个仓库中创建一个指向 `.git` 目录的符号链接。
*   受害者递归克隆第二个仓库。
*   Git 错误地将 hook 写入 `.git/` 目录。
*   克隆操作期间，hook 被执行，导致 RCE。

**项目地址:** [SpycioKon/CVE-2024-32002](https://github.com/SpycioKon/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #9

**来源**: [CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md](../2024/CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标服务器需要安装受影响的Git版本，且文件系统区分大小写并支持符号链接，需要克隆包含恶意子模块的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以构造恶意的 Git 仓库，其中包含一个带有恶意配置的子模块。当用户递归克隆这个仓库时，Git 会将恶意文件写入 `.git/` 目录，而不是子模块的工作目录，导致可以执行恶意的 hook 脚本，实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 `post-checkout` hook 脚本，它会在 `git checkout` 操作后执行。脚本的内容是将 "amal_was_here" 写入 `/tmp/pwnd` 文件，并且打开计算器程序。如果目标系统成功执行了这个脚本，就可以证明该漏洞的有效性。

**投毒风险：**
POC 代码本身不包含明显的投毒行为，它只是一个简单的示例，用于验证漏洞的存在。但是，考虑到漏洞利用方式，攻击者可以修改 hook 脚本，使其包含更具破坏性的恶意代码。例如，可以执行系统命令、窃取敏感信息或者植入后门。因此，从远程仓库克隆代码时，始终存在一定的风险。
投毒风险评估为 10%，因为这个示例代码更像是概念验证，而非恶意利用，但实际攻击中，攻击者完全可以将hook脚本编写为恶意的脚本。

**利用方式：**
1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  子模块的 `.gitmodules` 文件中包含指向恶意仓库的 URL。
3.  恶意仓库的 `hooks/post-checkout` 目录包含攻击者想要执行的恶意脚本。
4.  受害者递归克隆包含恶意子模块的 Git 仓库（例如，使用 `git clone --recurse-submodules` 命令）。
5.  Git 在克隆子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
6.  当执行 `git checkout` 操作时，恶意 hook 脚本被执行，导致远程代码执行。

**项目地址:** [TSY244/CVE-2024-32002-git-rce-father-poc](https://github.com/TSY244/CVE-2024-32002-git-rce-father-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #10

**来源**: [CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md](../2024/CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 < version < 2.40.2, 2.41.0, 2.42.0 < version < 2.42.2, 2.43.0 < version < 2.43.4, 2.44.0, 2.45.0, <= 2.45.0

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统区分大小写并支持符号链接，攻击者可控的Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002是一个Git中的远程代码执行漏洞，该漏洞源于Git处理包含子模块的仓库时存在缺陷。攻击者可以构造恶意仓库，利用子模块机制，将恶意文件写入`.git/`目录而不是子模块的工作目录。由于`.git/`目录下的文件可能包含Git钩子(hooks)，这些钩子会在特定的Git操作期间被执行，从而导致任意代码执行。如果目标系统禁用了符号链接（`core.symlinks = false`），则该漏洞无法利用。从搜索结果和漏洞描述来看，多个安全厂商和社区已经公开了漏洞分析和利用方法，证明了该漏洞的有效性。提供的漏洞利用代码是Apache License 2.0的许可协议，并非实际的PoC代码，因此无法直接评估投毒风险。但根据漏洞原理，攻击者需要在恶意仓库中植入恶意的子模块和钩子脚本，才能实现远程代码执行。由于提供的代码是许可证文件，所以投毒风险判定为0%。漏洞利用方式：1. 构造包含恶意子模块的Git仓库。2. 在恶意子模块中包含恶意的Git钩子（例如 pre-commit, post-receive等）。3. 诱导受害者克隆该恶意仓库并递归初始化子模块。4. 当Git执行相关操作时，恶意的钩子脚本被触发，导致远程代码执行。

**项目地址:** [XiaomingX/cve-2024-32002-poc](https://github.com/XiaomingX/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #11

**来源**: [CVE-2024-32002-ashutosh0408_CVE-2024-32002.md](../2024/CVE-2024-32002-ashutosh0408_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需使用受影响的Git版本，且文件系统为大小写不敏感（如Windows或macOS），并允许符号链接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 是 Git 中一个允许远程代码执行的漏洞，它与子模块有关。恶意仓库可以精心构造，利用大小写不敏感文件系统上的符号链接处理缺陷，将文件写入 `.git/` 目录，进而执行恶意 hooks。

**有效性：**

根据漏洞描述和PoC代码，此PoC代码有效。多个搜索结果（如webpage 6和 webpage 7）表明存在针对此漏洞的利用，并且提供了利用成功的案例。PoC代码的 `README.md` 文件也提供了在Windows和Mac上的成功执行截图。 PoC 明确指出只能在 Windows 或 Mac 系统上工作, 这与漏洞描述中依赖大小写不敏感的文件系统相符。

**投毒风险：**

PoC代码主要由以下几个部分组成：

1.  `create_poc.sh`：用于创建利用此漏洞的恶意Git仓库。
2.  `hook/y/hooks/post-checkout` 和 `post-checkout`：这些文件包含了实际的恶意代码，也就是将在目标机器上执行的代码。这段代码会创建一个文件 `/tmp/pwnd`，并尝试运行 `calc.exe` （Windows）或 `open -a Calculator.app` （Mac）。
3.  `README.md`：提供漏洞描述和利用方法。

分析 `create_poc.sh` 脚本，其中包含一些git配置，创建一个恶意hook，并添加到git仓库中。该脚本的主要目的是自动化生成一个可被利用的恶意仓库，其本身并不包含任何隐藏的、与PoC目的无关的代码。

恶意代码部分，也就是`hook/y/hooks/post-checkout` 和 `post-checkout`脚本，其功能是创建文件和打开计算器程序。 虽然这些操作本身是无害的，但是攻击者可以替换成任何其他恶意代码，例如植入后门程序、窃取敏感数据等。

因此，判断此仓库中存在作者隐藏的投毒代码的风险较低。PoC本身包含的恶意代码是为了验证漏洞，并非隐藏的恶意功能。风险主要在于用户如果直接使用此PoC，没有意识到其潜在的危害，则可能导致安全问题。由于是公开的 PoC，其目的是演示漏洞利用，因此作者故意隐藏恶意代码的可能性较低，风险评估为5%。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个包含特殊构造路径的子模块。
2.  子模块路径使用大小写变体，以利用大小写不敏感的文件系统。
3.  子模块包含一个指向其 `.git/` 目录的符号链接，该目录包含一个恶意 hook（例如 `post-checkout`）。
4.  当用户克隆恶意仓库时，`git clone --recursive` 命令会递归初始化和更新子模块。
5.  在大小写不敏感的文件系统上，Git 会跟随符号链接，并将恶意 hook 写入 `.git/` 目录。
6.  当执行 `git checkout` 等操作时，恶意 hook 会被执行，从而导致远程代码执行。

利用成功的关键点在于大小写不敏感的文件系统和符号链接的使用，以及 Git 在处理子模块时的缺陷。


**项目地址:** [ashutosh0408/CVE-2024-32002](https://github.com/ashutosh0408/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #12

**来源**: [CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md](../2024/CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并且开启了submodule功能，文件系统区分大小写，允许创建符号链接，受害者clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞，利用方式主要通过精心构造包含恶意submodule的 Git 仓库。攻击者可以利用此漏洞，通过诱导受害者递归克隆包含恶意配置的仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式:**

1.  **创建恶意仓库：** 攻击者创建包含恶意submodule配置的Git仓库，该仓库中的submodule指向一个包含恶意hook的仓库。
2.  **恶意Hook：**  攻击者在submodule的仓库中，设置post-checkout hook，该hook会在`git clone --recursive`命令执行时被触发，从而执行攻击者预设的恶意代码。POC代码中，恶意代码为打开计算器应用。
3.  **符号链接操纵：**  利用Git对submodule处理的缺陷，通过创建指向`.git`目录的符号链接，使得恶意hook被放置在`.git/hooks`目录下，从而绕过安全检查。
4.  **诱导克隆：**  攻击者诱导受害者克隆包含恶意submodule的仓库，使用`git clone --recursive`命令。
5.  **触发RCE：**  当受害者执行`git clone --recursive`命令时，恶意hook被触发，执行攻击者预设的恶意代码，实现远程代码执行。

**POC有效性评估:**

根据提供的漏洞信息和利用代码，该POC代码是有效的。它成功演示了如何利用Git submodule的漏洞，通过创建恶意仓库和hook，在受害者机器上执行任意代码。多个搜索结果，例如webpage 6的[Exploiting git RCE: CVE-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)，也验证了该漏洞的可利用性。

**投毒风险分析:**

尽管提供的代码主要用于演示漏洞利用，但仍然存在一定的投毒风险。风险主要来自以下几个方面：

1.  **Payload替换：**  POC中使用打开计算器作为示例payload，攻击者可以轻易地替换成其他更具危害性的恶意代码，例如植入后门、窃取敏感信息等。
2.  **依赖风险：**  POC脚本依赖于特定的git命令和文件系统操作。如果攻击者修改了脚本，添加了额外的依赖或操作，可能会导致受害者系统出现未知问题。
3.  **远程仓库风险：**  虽然POC中指定了特定的远程仓库，但攻击者可能会修改脚本，指向其他包含更隐蔽或更具危害性的恶意代码的仓库。

评估结果为10%,原因在于当前代码中仅仅提供PoC思路,不存在额外恶意操作。

**项目地址:** [ashutosh0408/Cve-2024-32002-poc](https://github.com/ashutosh0408/Cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #13

**来源**: [CVE-2024-32002-blackninja23_CVE-2024-32002.md](../2024/CVE-2024-32002-blackninja23_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要在大小写不敏感的文件系统（例如Windows或macOS）上进行克隆，并且core.symlinks=true（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在递归克隆包含恶意子模块的存储库时，由于大小写不敏感的文件系统上的符号链接处理不当，导致可以将文件写入 `.git/` 目录而不是子模块的工作目录中。 这允许写入一个钩子，该钩子将在克隆操作仍在运行时执行，使用户没有机会检查正在执行的代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。PoC 代码明确展示了如何利用该漏洞在 Windows 和 macOS 系统上实现 RCE。

**投毒风险：**
该存储库存在一定的投毒风险。虽然提供的 PoC 代码看似直接，目的是展示漏洞利用，但`create_poc.sh`脚本如果被修改，则有可能植入恶意代码，导致使用者在不知情的情况下执行攻击者的恶意操作。脚本中包含的 URL `https://github.com/blackninja23/hook.git`，如果被替换成恶意仓库，存在被投毒的风险。但代码本身功能比较直白，没有过于复杂的逻辑，因此投毒风险较低，预估为10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个子模块。
2.  该子模块的路径被精心构造，利用大小写变体（例如 `A/modules/x` vs `a/modules/x`）来欺骗大小写不敏感的文件系统。
3.  该子模块包含一个符号链接，指向仓库的 `.git/` 目录。
4.  `.git/` 目录中包含一个恶意 Git 钩子（例如 `post-checkout`）。
5.  当受害者使用 `git clone --recursive` 克隆恶意仓库时，Git 会尝试递归地克隆子模块。
6.  由于大小写不敏感的文件系统，Git 可能会错误地解析子模块的路径，导致符号链接被解析到 `.git/` 目录中。
7.  恶意 Git 钩子会被执行，从而导致远程代码执行。

**项目地址:** [blackninja23/CVE-2024-32002](https://github.com/blackninja23/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #14

**来源**: [CVE-2024-32002-bonnettheo_CVE-2024-32002.md](../2024/CVE-2024-32002-bonnettheo_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要启用submodule和符号链接支持，且攻击者需要诱使用户克隆恶意构造的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 存在于 Git 中，允许攻击者通过恶意构造包含子模块的仓库，利用 Git 在不安全的上下文中写入文件的漏洞来执行任意代码。此漏洞利用了 Git 在处理子模块时的路径遍历缺陷，攻击者可以欺骗 Git 将恶意 hook 写入 `.git/` 目录而不是子模块的工作树中。当克隆操作仍在进行时，这些 hook 将被执行，使用户没有机会检查正在执行的代码。该漏洞主要影响启用了子模块和符号链接支持的系统。修复方法是升级到 Git 的安全版本(>=2.45.1, >=2.44.1, >=2.43.4, >=2.42.2, >=2.41.1, >=2.40.2, >=2.39.4) 或禁用符号链接支持(git config --global core.symlinks false)。

根据搜索引擎结果，该漏洞已得到广泛关注，并有公开的利用代码和分析文章。POC代码有效性高，能够实现远程代码执行。

该仓库的投毒风险较低，主要基于以下几点判断：

*   **代码来源：** POC代码引用了另一个开源项目，并提供了原始作者的博客链接，提高了透明度。
*   **免责声明：** 仓库包含明确的免责声明，强调仅用于教育和信息目的，禁止在未经授权的系统上运行。
*   **文件内容：** 仓库中主要包含漏洞说明和利用代码链接，没有发现额外的可疑文件或代码片段。
*   **作者信誉：** 缺乏对该仓库作者的信誉信息，无法进行有效判断。

由于缺乏直接的代码分析和作者信誉信息，无法完全排除投毒风险，但是考虑到以上的几点，判定投毒的可能性较低。建议在运行POC代码时，务必进行代码审计和安全评估，以避免潜在的风险。

**项目地址:** [bonnettheo/CVE-2024-32002](https://github.com/bonnettheo/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #15

**来源**: [CVE-2024-32002-charlesgargasson_CVE-2024-32002.md](../2024/CVE-2024-32002-charlesgargasson_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 ~ 2.40.2, 2.41.0, 2.42.0 ~ 2.42.2, 2.43.0 ~ 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标Git版本受影响，且启用了submodule和符号链接，在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在处理包含 submodule 的仓库时，允许攻击者通过构造恶意的仓库，将文件写入 `.git/` 目录而不是 submodule 的工作目录中。 这样，攻击者就可以写入一个 hook 脚本，该脚本在克隆操作仍在运行时执行，从而实现远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule，并在该 submodule 中包含一个恶意的 `.gitmodules` 文件和一个 hook 脚本 (例如 `post-checkout`)。
2.  恶意 `.gitmodules` 文件包含指向攻击者控制的另一个仓库的 URL。这个仓库包含恶意的 hook 脚本。
3.  当受害者使用 `git clone --recursive` 命令克隆包含恶意 submodule 的仓库时，Git 会递归地克隆 submodule。
4.  在克隆 submodule 的过程中，由于漏洞，恶意 hook 脚本会被写入到受害者的 `.git/` 目录中，而不是 submodule 的工作目录中。
5.  当 Git 执行 hook 脚本时，攻击者就可以在受害者的系统上执行任意代码。

**有效性：**

根据漏洞描述、搜索结果（特别是vicarius.io的分析文章）和提供的 POC 代码，该漏洞是有效的。POC 代码展示了如何创建恶意仓库，触发漏洞并执行任意命令。

**投毒风险：**

该 POC 代码的目的是演示漏洞利用，但仍然存在一定的投毒风险，约为 10%。这种风险主要来自于以下几个方面：

1.  **反弹shell的IP和端口：** POC 代码中嵌入了反弹 shell 的 IP 地址和端口。攻击者可能会修改这些值，将 shell 反弹到他们控制的服务器上。
2.  **后门代码：** 攻击者可能会在 hook 脚本中添加额外的后门代码，以便在受害者系统上植入持久性的恶意软件。
3.  **依赖库：** 攻击者可能会修改 POC 代码，使其依赖于恶意的第三方库，这些库可能包含恶意代码。

尽管存在这些风险，但该 POC 代码的主要目的是演示漏洞利用，而不是进行恶意攻击。 用户在使用时仍然需要谨慎，确保对代码进行适当的审查和修改，以避免潜在的风险。

**项目地址:** [charlesgargasson/CVE-2024-32002](https://github.com/charlesgargasson/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #16

**来源**: [CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md](../2024/CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统必须使用大小写不敏感的文件系统且启用符号链接（或未禁用）。需要能够访问恶意Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002 漏洞允许攻击者通过构造包含恶意子模块的 Git 仓库，在目标系统上实现远程代码执行。漏洞原理是当Git在大小写不敏感的文件系统上递归克隆包含子模块的仓库时，攻击者可以利用大小写差异将文件写入 `.git/` 目录，从而覆盖或创建恶意 hook。当执行 `git clone --recursive` 命令时，恶意 hook 会被触发，导致任意代码执行。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。该子模块的路径经过特殊构造，利用大小写差异（例如 `A/modules/x` 和 `a/modules/x`）以及符号链接，指向子模块的 `.git/` 目录。
2.  **植入恶意Hook：** 在子模块的 `.git/hooks/` 目录下放置恶意的 Git hook 脚本（例如 `post-checkout`）。
3.  **诱导克隆：** 诱导受害者使用 `git clone --recursive` 命令克隆该恶意仓库。
4.  **触发执行：** 当受害者克隆仓库时，由于文件系统的大小写不敏感特性和符号链接，恶意 hook 会被写入 `.git/` 目录并被执行，导致远程代码执行。

**POC有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码有效。它演示了如何通过精心构造的 Git 仓库和子模块，利用 Git 的递归克隆功能在目标系统上执行任意代码。POC需要用户输入gitea服务器的ip地址、用户名和api token，然后创建两个仓库，并在其中一个仓库中添加恶意hook。另外, 需要手动修改 .gitmodules 文件，指向包含恶意hook的仓库。

**投毒风险评估：**

提供的POC代码主要用于演示漏洞的利用，旨在帮助安全研究人员理解和复现该漏洞。其中涉及的恶意代码（如在 hook 中执行 `calc.exe`）仅用于演示 RCE，并非旨在窃取或破坏用户数据，不构成直接的投毒行为。虽然该POC代码本身不包含投毒代码，但如果被恶意使用者利用，可能会被修改以植入更具破坏性的代码。 因此,投毒的风险概率为0%。

**缓解措施：**

1.  升级 Git 版本到已修复该漏洞的版本（>= 2.39.4, >= 2.40.2, >= 2.41.1, >= 2.42.2, >= 2.43.4, >= 2.44.1, >= 2.45.1）。
2.  禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
3.  避免克隆来自不受信任来源的 Git 仓库。


**项目地址:** [chrisWalker11/running-CVE-2024-32002-locally-for-tesing](https://github.com/chrisWalker11/running-CVE-2024-32002-locally-for-tesing)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #17

**来源**: [CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md](../2024/CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md)

## CVE-2024-32002

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并允许递归克隆包含恶意submodule的仓库。目标文件系统需要大小写不敏感且支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理机制中。攻击者可以构造包含恶意 submodule 的仓库，当受害者递归克隆该仓库时，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。这样，攻击者就可以在克隆过程中执行恶意 hook，从而实现远程代码执行。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞是一个远程代码执行漏洞，利用 submodules 中的缺陷，通过在`.git/`目录下写入恶意 hook 脚本，在 clone 过程中执行该脚本，从而实现 RCE。提供的POC代码尝试模拟此攻击，克隆恶意仓库，设置 git 配置以允许文件协议和符号链接，然后创建包含恶意payload的post-checkout hook，并将其推送到远端仓库，最后添加恶意的submodule。因此，提供的POC代码在满足漏洞利用条件的情况下是有效的。

**投毒风险分析：**
POC代码中存在潜在的投毒风险，作者可能通过恶意修改`shell.sh`，在受害者执行漏洞利用代码时执行意料之外的代码。例如，作者可能添加代码来窃取受害者的凭据、安装后门或进行其他恶意活动。但是从现有代码看，可能性较低。判断依据如下：

*   `rm -rf nothing` 和 `rm -rf toSeeHere` 看上去是无害的操作，但可能用于清理攻击痕迹，或者迷惑分析人员。
*   设置全局git配置，例如`git config --global protocol.file.allow always`，可能允许其他攻击向量。如果受害者在其他环境中使用了被更改的全局git配置，可能会带来安全风险。
*   `git clone http://<server ip>:<port>/<username>/repo1.git` 和 `git clone http://<server ip>:<port>/<username>/repo2.git` 依赖外部的git服务器。该服务器可能包含后门代码，或者在特定的IP/用户环境下，返回不同的内容，实现有选择的攻击。
*   `cat > y/hooks/post-checkout <<EOF
#!bin/sh.exe
#your payload goes here
EOF` 这部分是payload注入点, 攻击者可以伪装成漏洞利用代码，将恶意代码放在此处。

**利用方式分析：**
1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  在 submodule 中，攻击者创建一个 hook 脚本（例如 `post-checkout`），该脚本包含恶意代码。
3.  攻击者将 submodule 添加到主仓库中，并创建一个特殊的 `.git` 文件或符号链接，指向恶意 submodule 的 `.git` 目录。
4.  当受害者递归克隆包含恶意 submodule 的仓库时，Git 会尝试初始化 submodule。
5.  由于存在特殊的 `.git` 文件或符号链接，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。
6.  写入 `.git/` 目录中的 hook 脚本会被执行，从而实现远程代码执行。

**项目地址:** [daemon-reconfig/CVE-2024-32002](https://github.com/daemon-reconfig/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #18

**来源**: [CVE-2024-32002-grecosamuel_CVE-2024-32002.md](../2024/CVE-2024-32002-grecosamuel_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统安装受影响版本的Git，且允许clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个存在于 Git submodules 中的远程代码执行漏洞。当 Git 在大小写不敏感的文件系统上递归克隆存储库时，攻击者可以利用此漏洞。通过精心构造包含恶意 submodule 的 Git 仓库，攻击者可以欺骗 Git 将文件写入到 `.git/` 目录，而不是 submodule 的工作目录中。这使得攻击者可以写入一个 hook 文件，该 hook 文件在 clone 操作期间执行，从而实现远程代码执行。该漏洞的利用依赖于 `core.symlinks` 配置项是否启用。如果 `core.symlinks` 被禁用，攻击将无法成功。提供的 POC 代码通过创建一个包含恶意 post-checkout hook 的 submodule，然后将其包含在一个主仓库中。当受害者克隆主仓库时，post-checkout hook 会被执行，从而导致代码执行。考虑到此漏洞的利用方式，远程仓库本身就可能包含恶意代码，存在一定投毒的风险。

**漏洞利用方式:**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule。
2.  Submodule 包含一个恶意的 `post-checkout` hook，用于执行攻击者的 payload。
3.  攻击者诱使受害者克隆包含恶意 submodule 的仓库。
4.  在克隆过程中，Git 会递归克隆 submodule。
5.  由于漏洞，恶意的 `post-checkout` hook 被写入 `.git/` 目录并执行，导致 RCE。

**POC 代码分析和投毒风险评估:**
提供的POC代码主要功能是自动化漏洞利用流程, 简化了恶意仓库的创建过程。代码本身没有明显的投毒行为。 投毒风险主要来源于clone的远程仓库本身。POC中push到远程仓库步骤也有潜在的投毒风险，虽然可能性较低，但不能完全排除。

**有效性:**
根据搜索引擎结果，有多个来源证实了此漏洞的存在以及POC的有效性。

**项目地址:** [grecosamuel/CVE-2024-32002](https://github.com/grecosamuel/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #19

**来源**: [CVE-2024-32002-sanan2004_CVE-2024-32002.md](../2024/CVE-2024-32002-sanan2004_CVE-2024-32002.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统开启 symlinks 支持 (core.symlinks = true)，且攻击者能够控制一个包含恶意配置的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造的包含恶意子模块的 Git 仓库，在克隆仓库的用户的系统上执行任意代码。漏洞的根源在于 Git 在处理子模块时，可能将文件写入 `.git/` 目录而非子模块的工作目录。这使得攻击者可以放置一个 Git hook (例如 `post-checkout`) 在克隆操作期间执行。PoC 的利用方式是：

1.  **准备恶意仓库 (hulk.git):** 该仓库包含一个 `post-checkout` hook，hook 的内容是恶意payload（示例中是打开计算器）。这个hook会被放置在 `.git/hooks/` 目录下。
2.  **准备包含恶意子模块的仓库 (submod.git):** 该仓库将恶意仓库 (`hulk.git`) 添加为子模块，并创建一个指向 `.git` 目录的符号链接。关键的一步是使用`git update-index`命令来创建一个指向 `.git` 目录的符号链接。
3.  **准备最终的触发仓库 (smash.git):** 用户克隆该仓库时，由于递归克隆子模块，符号链接会被错误地解析，导致 `post-checkout` hook 被复制到 `.git/hooks/` 目录下，并在克隆过程的某个阶段执行，从而实现 RCE。

**有效性：** 提供的 PoC 代码是有效的，如果满足先决条件（易受攻击的 Git 版本和启用的符号链接），则可以成功触发 RCE。

**投毒风险：** PoC 本身的主要功能是演示漏洞，但由于代码的复杂性，存在细微的投毒风险。例如，`poc.sh` 脚本中可以被加入额外命令，在执行漏洞利用的同时，进行其他恶意操作，例如收集用户信息、安装后门程序等。此外，`hulk.git`仓库中可以存在除计算器之外的其他恶意payload。因此,投毒风险评估为10%。

**利用方式：** 攻击者需要控制一个 Git 仓库，并诱导受害者递归克隆该仓库。一旦受害者执行了 `git clone --recursive <恶意仓库>` 命令，恶意代码就会在其系统上执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用符号链接支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不受信任来源的仓库。

**项目地址:** [sanan2004/CVE-2024-32002](https://github.com/sanan2004/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #20

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-demo.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-demo.md)

## CVE-2024-32002-Git递归克隆远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许未经身份验证的攻击者在受害者机器上执行任意代码

**影响版本:** < 2.39.4, >= 2.40.0 < 2.40.2, = 2.41.0, >= 2.42.0 < 2.42.2, >= 2.43.0 < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标系统需要使用受影响版本的Git，且需要在大小写不敏感的文件系统（例如macOS的默认设置，Windows）上克隆包含恶意配置的仓库，同时`core.symlinks`配置未显式设置为`false`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造包含恶意子模块的 Git 仓库，利用 Git 在大小写不敏感的文件系统上的处理缺陷，将恶意 hook 写入 `.git/` 目录，从而在克隆仓库时执行任意代码。攻击者可以诱骗用户克隆恶意仓库，从而在用户不知情的情况下执行恶意代码。

**有效性分析：**

根据漏洞描述，提供的POC代码旨在演示如何利用此漏洞。通过`git clone --recursive`命令克隆该仓库，如果目标系统满足漏洞触发条件（受影响的Git版本，大小写不敏感的文件系统，未禁用符号链接），则可能触发漏洞，导致恶意代码执行。提供的POC利用方法符合漏洞描述，因此POC**可能有效**。

**投毒风险分析：**

提供的代码片段包括：

*   `/README.md`: 包含克隆仓库的说明。
*   `/docs/README.md`: 简单的文档说明。
*   `/src/example.py`: 一个简单的Python脚本，用于处理数据并打印结果。

初步分析表明，提供的代码本身并没有明显的恶意代码或后门。主要的风险在于该仓库可能包含隐藏的恶意 Git 配置（例如存在于.gitmodules或者.git/hooks中）或者子模块，当使用`git clone --recursive`时被自动执行。

由于无法直接看到.git目录下的文件，因此无法完全排除投毒风险。假设`git clone --recursive` 命令在满足条件下，自动触发恶意hook的可能性比较低，但是仍然存在。因此这里给出了5%的投毒可能性。

**利用方式：**

1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  恶意子模块包含一个 hook，该 hook 会在仓库被克隆时执行任意代码。
3.  攻击者诱骗受害者克隆该恶意仓库。
4.  当受害者使用 `git clone --recursive` 命令克隆仓库时，恶意 hook 被执行，从而导致远程代码执行。

要减轻此漏洞的影响，用户应避免克隆来自不受信任来源的仓库，并确保使用的 Git 版本已更新到修复此漏洞的版本。 此外，如果不需要符号链接，可以禁用符号链接支持，通过设置`git config --global core.symlinks false`来缓解风险。

**项目地址:** [srakkk/cve-2024-32002-demo](https://github.com/srakkk/cve-2024-32002-demo)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #21

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-hook.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-hook.md)

# CVE-2024-32002

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md](../2024/CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且允许递归克隆包含恶意submodule的仓库。利用需要case-insensitive文件系统，且默认开启了symlink(core.symlinks=true)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002是Git中一个严重的安全漏洞，它允许攻击者通过构造恶意的Git仓库，在目标系统上执行任意代码。攻击的核心在于利用了Git处理submodule时的不严谨性，特别是在大小写不敏感的文件系统上。

**漏洞利用方式：**

1.  **恶意仓库构造：** 攻击者创建一个包含submodule的Git仓库。该submodule的URL被精心构造，包含恶意payload。利用`ssh://-oProxyCommand=payload/`格式的URL，使得在submodule初始化时，`ProxyCommand`会被执行，从而达到远程命令执行的效果。
2.  **受害者克隆：** 受害者使用Git克隆该恶意仓库，并使用 `--recurse-submodules` 参数或者配置`git config --global submodule.recurse true`。递归克隆submodules.
3.  **触发漏洞：** 在克隆过程中，Git会尝试初始化submodule。由于submodule的URL包含恶意payload，Git会执行`ProxyCommand`指定的命令，从而在受害者系统上执行攻击者预设的恶意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是[webpage 4 begin]到[webpage 6 begin]）和提供的漏洞利用代码，可以确认该漏洞是有效的。多个来源都提供了关于此漏洞的分析、利用方式和缓解措施。POC代码利用Metasploit框架模拟了恶意Git服务器，展示了如何通过构造恶意的submodule URL来执行任意命令。

**投毒风险：**

提供的Metasploit模块本身用于漏洞利用演示，主要功能是搭建一个包含恶意submodule配置的Git仓库。该模块将payload插入到`.gitmodules`文件中，并通过`ProxyCommand`执行。

虽然没有明显的“投毒”代码，但依然存在以下风险：

*   **payload隐蔽性：**攻击者可能在payload中嵌入看似无害但实则具有恶意行为的代码，例如下载执行其他恶意程序、窃取敏感信息等。这种payload可以通过混淆、加密等技术来逃避检测，因此存在一定的投毒风险。

综合评估，投毒风险较低，大约为5%。主要风险在于Payload部分可能包含恶意指令。


**项目地址:** [Basyaact/CVE-2024-32002-PoC_Chinese](https://github.com/Basyaact/CVE-2024-32002-PoC_Chinese)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #2

**来源**: [CVE-2024-32002-FlojBoj_CVE-2024-32002.md](../2024/CVE-2024-32002-FlojBoj_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** v2.45.0, v2.44.0, <=v2.43.3, <=v2.42.1, v2.41.0, <=v2.40.1, <=v2.39.3

**利用条件:** 目标系统需要安装存在漏洞的Git版本，并且文件系统大小写不敏感且支持符号链接(或配置`core.symlinks=true`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块功能中。攻击者可以构造包含恶意子模块的仓库，利用 Git 在处理子模块时可能将文件写入 `.git/` 目录而不是子模块工作目录的漏洞。通过精心构造的子模块，攻击者可以在目标机器上执行任意代码。利用过程如下：

1.  **恶意仓库准备：** 攻击者创建两个仓库 rep1 和 rep2。
2.  **rep1 (恶意子模块)：** 在 rep1 中，创建一个 `executable/hooks/post-checkout` 文件，该文件包含要执行的恶意代码（例如，启动计算器应用）。使用`git update-index --chmod=+x executable/hooks/post-checkout`命令赋予该文件执行权限，并推送到 rep1 仓库。
3.  **rep2 (主仓库)：** 在 rep2 中，将 rep1 作为子模块添加到 `A/modules/exploit` 路径下。
4.  **漏洞触发：**  关键在于创建 `dotgit.txt` 文件，内容为 `.git`，计算其哈希值，然后构造 `index.info` 文件，该文件将 `A/modules/exploit/.git` 设置为符号链接指向计算出的哈希对象，以此欺骗 Git。
5.  **克隆触发：** 当受害者使用 `git clone --recursive $REP2` 命令克隆 rep2 仓库时，Git 会尝试递归克隆子模块 rep1。
6.  **代码执行：** 由于 rep2 中 `A/modules/exploit/.git` 被伪造成符号链接，Git 在处理子模块时会将 rep1 中的 `executable/hooks/post-checkout` 文件错误地写入 `.git/hooks` 目录，从而使其成为一个 Git 钩子。`post-checkout` 钩子会在 `git clone` 操作完成后自动执行，从而触发恶意代码。

**投毒风险分析：**

  此POC本身旨在利用漏洞，但其中存在潜在的投毒风险。例如，`exploit.sh` 中定义的 `exploit` 变量决定了执行的恶意代码。虽然当前 POC 中是启动计算器，但攻击者完全可以替换为更具危害性的命令，例如下载并执行恶意脚本。虽然代码中声明“USE ONLY FOR EDUCATIONAL PURPOSES!”，但仍需谨慎使用。

**有效性分析：**

 根据漏洞描述和搜索结果，该 POC 有效。提供的 POC 代码展示了如何利用此漏洞在目标机器上执行任意代码。

**风险缓解：**

*   升级 Git 到修复后的版本。
*   避免克隆来自不受信任来源的仓库。
*   禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
*   对克隆的仓库进行安全审查。

**项目地址:** [FlojBoj/CVE-2024-32002](https://github.com/FlojBoj/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #3

**来源**: [CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md](../2024/CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md)

## CVE-2024-32002 - Git Submodule Remote Code Execution

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行，完全控制受影响系统

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 需要目标系统使用受影响的 Git 版本，且支持符号链接。利用依赖于递归克隆包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个严重的远程代码执行漏洞，它允许攻击者通过恶意构造包含子模块的 Git 仓库来执行任意代码。漏洞的核心在于 Git 在处理子模块路径时存在缺陷，攻击者可以利用此缺陷将恶意文件写入 `.git/` 目录，从而劫持 Git 的行为。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。关键在于构造一个恶意的 `.gitmodules` 文件。此文件中定义的子模块路径会被操纵，指向 `.git/` 目录内的某个位置。
2.  **符号链接欺骗：** 攻击者会创建一个符号链接，将仓库中的某个目录链接到 `.git/` 目录。例如，创建一个名为 `A` 的目录的符号链接，使其指向 `.git/`。
3.  **路径注入：** 通过组合恶意 `.gitmodules` 文件和符号链接，攻击者可以欺骗 Git 将子模块的内容写入 `.git/modules/` 目录。这允许攻击者注入恶意 hook 脚本。
4.  **触发执行：** 当受害者递归克隆（`git clone --recursive`）恶意仓库时，Git 将初始化子模块，并将恶意 hook 脚本复制到 `.git/hooks/` 目录。然后，当受害者执行诸如 `git checkout` 之类的 Git 操作时，这些恶意 hook 脚本会被触发执行，从而导致远程代码执行。

**POC 分析：**

提供的 POC 代码通过 Dockerfile 构建了一个包含漏洞 Git 版本的环境，并使用 `setup.sh` 脚本自动化了漏洞利用过程。该脚本创建了一个包含恶意 `post-checkout` hook 的子模块，修改 `.gitmodules` 文件，创建必要的符号链接，并将恶意 hook 注入到受害者的 `.git/hooks/` 目录中。当执行 `git checkout HEAD` 时，hook 脚本会被触发，在 `/tmp/teste.txt` 中写入 "joao was here"，从而验证了漏洞的存在。

**投毒风险分析：**

虽然 POC 代码的主要目的是演示漏洞，但仍然存在潜在的投毒风险。`setup.sh` 脚本包含以下可疑行为：

*   向 `/etc/sudoers` 文件添加用户，允许用户无密码执行 sudo 命令。虽然这可能是为了方便演示，但在实际环境中会带来安全风险。

考虑到这些因素，我将投毒风险评估为 10%。

**项目地址:** [JoaoLeonello/cve-2024-32002-poc](https://github.com/JoaoLeonello/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #4

**来源**: [CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md](../2024/CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致完全控制受害者机器

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 受害者需要使用受影响的Git版本克隆恶意构造的包含submodule的仓库，并且需要在大小写不敏感的文件系统上克隆。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理中。恶意攻击者可以构造包含恶意 submodule 的 Git 仓库，当受害者使用 `git clone --recurse-submodules` 命令克隆该仓库时，Git 会被诱导将文件写入 `.git/` 目录而不是 submodule 的工作目录。攻击者可以在 `.git/hooks` 目录下写入恶意 hook 脚本，这些脚本会在克隆操作期间执行，从而实现远程代码执行。攻击成功的关键在于利用了大小写不敏感文件系统的特性，使得恶意文件能够覆盖 `.git/` 目录下的合法文件。

**有效性评估：** 根据漏洞库信息和搜索结果（特别是 webpage 5），该漏洞的PoC是可用的，并且描述了利用方式。

**投毒风险评估：** 提供的 PoC 代码 `post-checkout` 脚本主要执行以下操作：

*   显示一段消息。
*   打开计算器程序 (`calc.exe`)，这是一个常见的 PoC 行为。
*   打开 Edge 浏览器并播放 YouTube 视频，同样是 PoC 行为，表明代码执行。
*   在用户 Home 目录下的每个目录中创建一个名为 `trace.txt` 的文件，写入一段消息。

虽然 PoC 代码本身没有明显的恶意行为，但创建 `trace.txt` 文件的操作可能被滥用。如果攻击者精心构造 `trace.txt` 的内容，例如包含恶意脚本或者利用其他漏洞的 payload，可能会造成进一步的危害。因此，存在一定的投毒风险，但风险相对较低，因为其行为是比较明显的。所以判定投毒概率为20%。

**利用方式：**

1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  恶意 submodule 中包含一个精心构造的 `.git/hooks/post-checkout` 脚本，该脚本包含攻击 payload。
3.  攻击者诱导受害者使用 `git clone --recurse-submodules` 命令克隆该仓库。
4.  当 Git 处理 submodule 时，会将恶意 `post-checkout` 脚本写入受害者机器的 `.git/hooks` 目录下。
5.  Git 在克隆完成后会自动执行 `post-checkout` 脚本，从而执行攻击 payload，实现远程代码执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)，但这可能会影响正常的 Git 使用。
*   避免克隆来自不受信任来源的仓库。


**项目地址:** [Julian-gmz/hook_CVE-2024-32002](https://github.com/Julian-gmz/hook_CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #5

**来源**: [CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md](../2024/CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需要使用受影响的Git版本，并且文件系统区分大小写，支持符号链接，用户需要克隆恶意仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以创建一个恶意仓库，其中包含特殊的子模块配置，使得在克隆仓库时，Git 将文件写入 `.git/` 目录而非子模块的工作目录。这允许攻击者放置一个恶意 hook 脚本到 `.git/hooks` 目录，该脚本会在克隆过程执行时被触发，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意子模块配置的Git仓库。
2.  该恶意配置指向一个包含 hook 脚本的子模块。
3.  受害者使用 `git clone --recursive` 命令克隆该仓库。
4.  Git 在处理子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
5.  克隆过程执行到一定阶段时，恶意 hook 脚本被触发，执行攻击者指定的任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞真实存在，并且有公开的PoC（例如vsociety提供的PoC）。提供的PoC代码`git clone --recursive "git@github.com:masamuneee/CVE-2024-32002-POC.git"` 可以触发漏洞。

**投毒风险：**

提供的 PoC 代码仅仅是一个 README 文件，用于演示漏洞利用的克隆命令。但是， `masamuneee/CVE-2024-32002-POC.git` 仓库本身可能包含恶意 payload（例如 hook 脚本）。虽然目前的PoC只是一个说明文件，不构成直接威胁，但是如果用户真的去克隆`git@github.com:masamuneee/CVE-2024-32002-POC.git`这个仓库,存在被投毒的风险。即使作者本意是提供PoC，也可能被其他人修改后上传带有恶意代码的版本。 因此，投毒风险评估为10%，主要源于克隆远程仓库的潜在风险，以及对作者上传的poc完整性的怀疑，毕竟用户克隆的是远程仓库，本地进行验证。

**参考链接：**

*   [https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv](https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv)
*   [https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)
*   [https://www.wiz.io/vulnerability-database/cve/cve-2024-32002](https://www.wiz.io/vulnerability-database/cve/cve-2024-32002)

**项目地址:** [Masamuneee/CVE-2024-32002-POC](https://github.com/Masamuneee/CVE-2024-32002-POC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #6

**来源**: [CVE-2024-32002-Masamuneee_hook.md](../2024/CVE-2024-32002-Masamuneee_hook.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：2.45.0, 2.44.0, >= 2.43.0 < 2.43.4, >= 2.42.0 < 2.42.2, 2.41.0, >= 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统安装Git，并且clone包含恶意submodule的仓库，利用依赖于对大小写不敏感的文件系统，并启用符号链接。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002是Git中存在的一个远程代码执行漏洞，它允许攻击者通过精心构造包含恶意submodule的Git仓库，诱导受害者clone该仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式：**
1.  攻击者创建一个包含submodule的恶意Git仓库。
2.  该submodule包含一个恶意的`.git/hooks/post-checkout` hook。
3.  利用了Git在处理submodule时，可能将文件写入`.git/`目录而不是submodule的工作目录的缺陷。
4.  当受害者在对大小写不敏感的文件系统上，且启用符号链接的情况下，clone这个仓库并检出（checkout）或者更新 submodule时，恶意hook会被执行，导致远程代码执行。

**有效性：**
提供的POC代码是有效的，因为它展示了如何创建一个包含恶意`post-checkout` hook的submodule，并在clone时触发该hook，从而执行任意命令。其中`/tmp/hacked`用于linux环境下的测试，powershell命令用于windows环境下的测试。

**投毒风险：**
虽然提供的POC代码本身是用于验证漏洞的，但如果攻击者在真实的恶意仓库中，除了POC代码之外还包含其他隐藏的恶意代码，则存在投毒风险。当前提供的POC代码中，`/tmp/e81041e852bc4e53c491bef3aef35e69/README.md` 文件和 `/tmp/e81041e852bc4e53c491bef3aef35e69/fast/hooks/post-checkout` 都可能被写入隐藏的恶意代码。假设作者有意隐藏投毒代码，可能性为20%。

**缓解措施：**
1.  升级Git到已修复的版本（>= 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, 2.39.4）。
2.  避免clone来自不受信任来源的仓库。
3.  禁用Git的符号链接支持（`git config --global core.symlinks false`）。
4.  在clone仓库后，仔细检查submodule的内容，特别是`.git/hooks`目录下的文件。

**项目地址:** [Masamuneee/hook](https://github.com/Masamuneee/hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #7

**来源**: [CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.39.4之前，以及2.40.0到2.40.2，2.41.0，2.42.0到2.42.2，2.43.0到2.43.4，2.44.0和2.45.0版本

**利用条件:** 需要目标系统启用符号链接支持，并且从恶意Git仓库克隆包含恶意submodule的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个远程代码执行 (RCE) 漏洞。该漏洞源于 Git 处理 submodules 的方式存在缺陷，攻击者可以构造恶意的 Git 仓库，其中包含一个精心设计的 submodule，该 submodule 利用了 Git 的漏洞，可以将文件写入 `.git/` 目录而不是 submodule 的工作目录。这允许攻击者在克隆操作期间执行恶意 hook，从而在受害者机器上执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的PoC是有效的。搜索结果中的 [webpage 6] 提到了一个演示如何利用该漏洞的PoC。
提供的PoC代码首先配置 Git 允许 file 协议和启用符号链接。然后，它创建一个包含恶意 post-checkout hook 的仓库 repo1。此 hook 包含一个 Payload，将在克隆 repo1 后执行。接下来，它创建一个包含 submodule 的仓库 repo2，该 submodule 指向 repo1。关键步骤是创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。最后，克隆 repo2 会触发恶意 hook，导致执行 Payload。

**投毒风险：**

该PoC本身就包含恶意代码(`<Payload>`)，用于在受害者机器上执行命令。投毒风险的评估旨在判断作者是否在PoC代码之外，还隐藏了其他的恶意代码或逻辑，用于进一步攻击或控制受害者系统。代码中可能存在潜在的投毒风险，但根据现有代码，没有找到明确的投毒代码。考虑到README中作者的个人站点链接，存在一定的概率通过其他方式植入后门，因此投毒风险预估为10%。

**利用方式：**

1.  **攻击者创建一个恶意 Git 仓库（例如 repo1），其中包含一个恶意 hook。** hook 的作用是在克隆仓库后执行 Payload。
2.  **攻击者创建一个包含 submodule 的 Git 仓库（例如 repo2），该 submodule 指向恶意仓库 repo1。**
3.  **攻击者创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。** 这一步是漏洞利用的关键，它欺骗 Git 将文件写入 `.git/` 目录。
4.  **受害者克隆仓库 repo2。** 在克隆过程中，Git 会尝试更新 submodule，由于存在符号链接，恶意 hook 将被写入 `.git/` 目录并执行，从而在受害者机器上执行 Payload。

该漏洞利用的先决条件是目标系统必须启用符号链接支持。如果 `core.symlinks` 设置为 `false`，则该漏洞无法利用。


**项目地址:** [NishanthAnand21/CVE-2024-32002-PoC](https://github.com/NishanthAnand21/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #8

**来源**: [CVE-2024-32002-SpycioKon_CVE-2024-32002.md](../2024/CVE-2024-32002-SpycioKon_CVE-2024-32002.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要存在受影响版本的Git，并且允许递归克隆包含恶意submodule的仓库，文件系统对大小写不敏感，支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个 Git 中的远程代码执行 (RCE) 漏洞，它允许攻击者通过精心制作的包含恶意 submodule 的 Git 仓库来执行任意代码。该漏洞的利用方式如下：

1.  **创建恶意仓库 (repo1)：** 攻击者创建一个包含恶意 hook 的 Git 仓库 (repo1)。在该 POC 代码中，`exp` 脚本首先克隆一个名为 `repo1` 的仓库，然后在 `y/hooks/post-checkout` 路径下创建一个恶意的 `post-checkout` hook。该 hook 包含经过 base64 编码的 PowerShell 代码，这段代码会尝试建立一个反向 shell 连接到攻击者的机器 (10.10.15.68:9999)。注意，`git config --global core.symlinks true` 启用了符号链接支持，这是利用此漏洞的关键。

2.  **创建包含恶意 submodule 的仓库 (repo2)：** 攻击者创建第二个仓库 (repo2)，并将第一个仓库 (repo1) 作为 submodule 添加进去。  POC代码执行了`git submodule add --name x/y "http://10.10.11.26:3000/admin123/repo1.git" A/modules/x`，将`repo1` 添加为 `repo2` 的子模块。然后，它创建一个名为 `dotgit.txt` 的文件，内容为 `.git`。接着，它计算该文件的哈希值，并利用该哈希值创建一个 `index.info` 文件，该文件用于创建一个指向 `.git` 目录的符号链接。

3.  **利用符号链接欺骗 Git：** 攻击者创建一个指向 `.git` 目录的符号链接。 当受害者递归克隆包含恶意 submodule 的仓库时，Git 会错误地将 hook 写入 `.git/` 目录，而不是 submodule 的工作目录。由于 `.git/` 目录下的 hook 会在克隆操作期间执行，因此攻击者可以在受害者的系统上执行任意代码。

4.  **克隆触发漏洞：** 受害者使用 `git clone --recursive repo2` 命令克隆包含恶意 submodule 的仓库 (repo2)。 当 Git 初始化 submodule 时，它会执行 `.git/` 目录中的 hook，从而触发攻击者预先植入的恶意代码。

**有效性：**根据搜索结果和漏洞描述，提供的 POC 代码是有效的，可以用来复现和验证 CVE-2024-32002 漏洞。搜索结果中多篇文章提到了利用 submodules 和符号链接将文件写入 `.git/` 目录，并执行恶意 hook。

**投毒风险：** POC 中存在一定的投毒风险。虽然主要目的是演示漏洞利用，但攻击者可能在 `post-checkout` hook 中植入额外的恶意代码，例如收集受害者系统信息、安装后门等。由于该POC主要目的是复现漏洞，其核心代码部分是漏洞利用所需的，因此判定投毒风险为10%。

**漏洞利用方式总结：**

*   攻击者创建一个包含恶意 hook 的 Git 仓库。
*   攻击者创建一个包含恶意 submodule（指向第一个仓库）的 Git 仓库。
*   攻击者在第二个仓库中创建一个指向 `.git` 目录的符号链接。
*   受害者递归克隆第二个仓库。
*   Git 错误地将 hook 写入 `.git/` 目录。
*   克隆操作期间，hook 被执行，导致 RCE。

**项目地址:** [SpycioKon/CVE-2024-32002](https://github.com/SpycioKon/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #9

**来源**: [CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md](../2024/CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标服务器需要安装受影响的Git版本，且文件系统区分大小写并支持符号链接，需要克隆包含恶意子模块的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以构造恶意的 Git 仓库，其中包含一个带有恶意配置的子模块。当用户递归克隆这个仓库时，Git 会将恶意文件写入 `.git/` 目录，而不是子模块的工作目录，导致可以执行恶意的 hook 脚本，实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 `post-checkout` hook 脚本，它会在 `git checkout` 操作后执行。脚本的内容是将 "amal_was_here" 写入 `/tmp/pwnd` 文件，并且打开计算器程序。如果目标系统成功执行了这个脚本，就可以证明该漏洞的有效性。

**投毒风险：**
POC 代码本身不包含明显的投毒行为，它只是一个简单的示例，用于验证漏洞的存在。但是，考虑到漏洞利用方式，攻击者可以修改 hook 脚本，使其包含更具破坏性的恶意代码。例如，可以执行系统命令、窃取敏感信息或者植入后门。因此，从远程仓库克隆代码时，始终存在一定的风险。
投毒风险评估为 10%，因为这个示例代码更像是概念验证，而非恶意利用，但实际攻击中，攻击者完全可以将hook脚本编写为恶意的脚本。

**利用方式：**
1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  子模块的 `.gitmodules` 文件中包含指向恶意仓库的 URL。
3.  恶意仓库的 `hooks/post-checkout` 目录包含攻击者想要执行的恶意脚本。
4.  受害者递归克隆包含恶意子模块的 Git 仓库（例如，使用 `git clone --recurse-submodules` 命令）。
5.  Git 在克隆子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
6.  当执行 `git checkout` 操作时，恶意 hook 脚本被执行，导致远程代码执行。

**项目地址:** [TSY244/CVE-2024-32002-git-rce-father-poc](https://github.com/TSY244/CVE-2024-32002-git-rce-father-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #10

**来源**: [CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md](../2024/CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 < version < 2.40.2, 2.41.0, 2.42.0 < version < 2.42.2, 2.43.0 < version < 2.43.4, 2.44.0, 2.45.0, <= 2.45.0

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统区分大小写并支持符号链接，攻击者可控的Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002是一个Git中的远程代码执行漏洞，该漏洞源于Git处理包含子模块的仓库时存在缺陷。攻击者可以构造恶意仓库，利用子模块机制，将恶意文件写入`.git/`目录而不是子模块的工作目录。由于`.git/`目录下的文件可能包含Git钩子(hooks)，这些钩子会在特定的Git操作期间被执行，从而导致任意代码执行。如果目标系统禁用了符号链接（`core.symlinks = false`），则该漏洞无法利用。从搜索结果和漏洞描述来看，多个安全厂商和社区已经公开了漏洞分析和利用方法，证明了该漏洞的有效性。提供的漏洞利用代码是Apache License 2.0的许可协议，并非实际的PoC代码，因此无法直接评估投毒风险。但根据漏洞原理，攻击者需要在恶意仓库中植入恶意的子模块和钩子脚本，才能实现远程代码执行。由于提供的代码是许可证文件，所以投毒风险判定为0%。漏洞利用方式：1. 构造包含恶意子模块的Git仓库。2. 在恶意子模块中包含恶意的Git钩子（例如 pre-commit, post-receive等）。3. 诱导受害者克隆该恶意仓库并递归初始化子模块。4. 当Git执行相关操作时，恶意的钩子脚本被触发，导致远程代码执行。

**项目地址:** [XiaomingX/cve-2024-32002-poc](https://github.com/XiaomingX/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #11

**来源**: [CVE-2024-32002-ashutosh0408_CVE-2024-32002.md](../2024/CVE-2024-32002-ashutosh0408_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需使用受影响的Git版本，且文件系统为大小写不敏感（如Windows或macOS），并允许符号链接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 是 Git 中一个允许远程代码执行的漏洞，它与子模块有关。恶意仓库可以精心构造，利用大小写不敏感文件系统上的符号链接处理缺陷，将文件写入 `.git/` 目录，进而执行恶意 hooks。

**有效性：**

根据漏洞描述和PoC代码，此PoC代码有效。多个搜索结果（如webpage 6和 webpage 7）表明存在针对此漏洞的利用，并且提供了利用成功的案例。PoC代码的 `README.md` 文件也提供了在Windows和Mac上的成功执行截图。 PoC 明确指出只能在 Windows 或 Mac 系统上工作, 这与漏洞描述中依赖大小写不敏感的文件系统相符。

**投毒风险：**

PoC代码主要由以下几个部分组成：

1.  `create_poc.sh`：用于创建利用此漏洞的恶意Git仓库。
2.  `hook/y/hooks/post-checkout` 和 `post-checkout`：这些文件包含了实际的恶意代码，也就是将在目标机器上执行的代码。这段代码会创建一个文件 `/tmp/pwnd`，并尝试运行 `calc.exe` （Windows）或 `open -a Calculator.app` （Mac）。
3.  `README.md`：提供漏洞描述和利用方法。

分析 `create_poc.sh` 脚本，其中包含一些git配置，创建一个恶意hook，并添加到git仓库中。该脚本的主要目的是自动化生成一个可被利用的恶意仓库，其本身并不包含任何隐藏的、与PoC目的无关的代码。

恶意代码部分，也就是`hook/y/hooks/post-checkout` 和 `post-checkout`脚本，其功能是创建文件和打开计算器程序。 虽然这些操作本身是无害的，但是攻击者可以替换成任何其他恶意代码，例如植入后门程序、窃取敏感数据等。

因此，判断此仓库中存在作者隐藏的投毒代码的风险较低。PoC本身包含的恶意代码是为了验证漏洞，并非隐藏的恶意功能。风险主要在于用户如果直接使用此PoC，没有意识到其潜在的危害，则可能导致安全问题。由于是公开的 PoC，其目的是演示漏洞利用，因此作者故意隐藏恶意代码的可能性较低，风险评估为5%。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个包含特殊构造路径的子模块。
2.  子模块路径使用大小写变体，以利用大小写不敏感的文件系统。
3.  子模块包含一个指向其 `.git/` 目录的符号链接，该目录包含一个恶意 hook（例如 `post-checkout`）。
4.  当用户克隆恶意仓库时，`git clone --recursive` 命令会递归初始化和更新子模块。
5.  在大小写不敏感的文件系统上，Git 会跟随符号链接，并将恶意 hook 写入 `.git/` 目录。
6.  当执行 `git checkout` 等操作时，恶意 hook 会被执行，从而导致远程代码执行。

利用成功的关键点在于大小写不敏感的文件系统和符号链接的使用，以及 Git 在处理子模块时的缺陷。


**项目地址:** [ashutosh0408/CVE-2024-32002](https://github.com/ashutosh0408/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #12

**来源**: [CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md](../2024/CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并且开启了submodule功能，文件系统区分大小写，允许创建符号链接，受害者clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞，利用方式主要通过精心构造包含恶意submodule的 Git 仓库。攻击者可以利用此漏洞，通过诱导受害者递归克隆包含恶意配置的仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式:**

1.  **创建恶意仓库：** 攻击者创建包含恶意submodule配置的Git仓库，该仓库中的submodule指向一个包含恶意hook的仓库。
2.  **恶意Hook：**  攻击者在submodule的仓库中，设置post-checkout hook，该hook会在`git clone --recursive`命令执行时被触发，从而执行攻击者预设的恶意代码。POC代码中，恶意代码为打开计算器应用。
3.  **符号链接操纵：**  利用Git对submodule处理的缺陷，通过创建指向`.git`目录的符号链接，使得恶意hook被放置在`.git/hooks`目录下，从而绕过安全检查。
4.  **诱导克隆：**  攻击者诱导受害者克隆包含恶意submodule的仓库，使用`git clone --recursive`命令。
5.  **触发RCE：**  当受害者执行`git clone --recursive`命令时，恶意hook被触发，执行攻击者预设的恶意代码，实现远程代码执行。

**POC有效性评估:**

根据提供的漏洞信息和利用代码，该POC代码是有效的。它成功演示了如何利用Git submodule的漏洞，通过创建恶意仓库和hook，在受害者机器上执行任意代码。多个搜索结果，例如webpage 6的[Exploiting git RCE: CVE-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)，也验证了该漏洞的可利用性。

**投毒风险分析:**

尽管提供的代码主要用于演示漏洞利用，但仍然存在一定的投毒风险。风险主要来自以下几个方面：

1.  **Payload替换：**  POC中使用打开计算器作为示例payload，攻击者可以轻易地替换成其他更具危害性的恶意代码，例如植入后门、窃取敏感信息等。
2.  **依赖风险：**  POC脚本依赖于特定的git命令和文件系统操作。如果攻击者修改了脚本，添加了额外的依赖或操作，可能会导致受害者系统出现未知问题。
3.  **远程仓库风险：**  虽然POC中指定了特定的远程仓库，但攻击者可能会修改脚本，指向其他包含更隐蔽或更具危害性的恶意代码的仓库。

评估结果为10%,原因在于当前代码中仅仅提供PoC思路,不存在额外恶意操作。

**项目地址:** [ashutosh0408/Cve-2024-32002-poc](https://github.com/ashutosh0408/Cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #13

**来源**: [CVE-2024-32002-blackninja23_CVE-2024-32002.md](../2024/CVE-2024-32002-blackninja23_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要在大小写不敏感的文件系统（例如Windows或macOS）上进行克隆，并且core.symlinks=true（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在递归克隆包含恶意子模块的存储库时，由于大小写不敏感的文件系统上的符号链接处理不当，导致可以将文件写入 `.git/` 目录而不是子模块的工作目录中。 这允许写入一个钩子，该钩子将在克隆操作仍在运行时执行，使用户没有机会检查正在执行的代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。PoC 代码明确展示了如何利用该漏洞在 Windows 和 macOS 系统上实现 RCE。

**投毒风险：**
该存储库存在一定的投毒风险。虽然提供的 PoC 代码看似直接，目的是展示漏洞利用，但`create_poc.sh`脚本如果被修改，则有可能植入恶意代码，导致使用者在不知情的情况下执行攻击者的恶意操作。脚本中包含的 URL `https://github.com/blackninja23/hook.git`，如果被替换成恶意仓库，存在被投毒的风险。但代码本身功能比较直白，没有过于复杂的逻辑，因此投毒风险较低，预估为10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个子模块。
2.  该子模块的路径被精心构造，利用大小写变体（例如 `A/modules/x` vs `a/modules/x`）来欺骗大小写不敏感的文件系统。
3.  该子模块包含一个符号链接，指向仓库的 `.git/` 目录。
4.  `.git/` 目录中包含一个恶意 Git 钩子（例如 `post-checkout`）。
5.  当受害者使用 `git clone --recursive` 克隆恶意仓库时，Git 会尝试递归地克隆子模块。
6.  由于大小写不敏感的文件系统，Git 可能会错误地解析子模块的路径，导致符号链接被解析到 `.git/` 目录中。
7.  恶意 Git 钩子会被执行，从而导致远程代码执行。

**项目地址:** [blackninja23/CVE-2024-32002](https://github.com/blackninja23/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #14

**来源**: [CVE-2024-32002-bonnettheo_CVE-2024-32002.md](../2024/CVE-2024-32002-bonnettheo_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要启用submodule和符号链接支持，且攻击者需要诱使用户克隆恶意构造的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 存在于 Git 中，允许攻击者通过恶意构造包含子模块的仓库，利用 Git 在不安全的上下文中写入文件的漏洞来执行任意代码。此漏洞利用了 Git 在处理子模块时的路径遍历缺陷，攻击者可以欺骗 Git 将恶意 hook 写入 `.git/` 目录而不是子模块的工作树中。当克隆操作仍在进行时，这些 hook 将被执行，使用户没有机会检查正在执行的代码。该漏洞主要影响启用了子模块和符号链接支持的系统。修复方法是升级到 Git 的安全版本(>=2.45.1, >=2.44.1, >=2.43.4, >=2.42.2, >=2.41.1, >=2.40.2, >=2.39.4) 或禁用符号链接支持(git config --global core.symlinks false)。

根据搜索引擎结果，该漏洞已得到广泛关注，并有公开的利用代码和分析文章。POC代码有效性高，能够实现远程代码执行。

该仓库的投毒风险较低，主要基于以下几点判断：

*   **代码来源：** POC代码引用了另一个开源项目，并提供了原始作者的博客链接，提高了透明度。
*   **免责声明：** 仓库包含明确的免责声明，强调仅用于教育和信息目的，禁止在未经授权的系统上运行。
*   **文件内容：** 仓库中主要包含漏洞说明和利用代码链接，没有发现额外的可疑文件或代码片段。
*   **作者信誉：** 缺乏对该仓库作者的信誉信息，无法进行有效判断。

由于缺乏直接的代码分析和作者信誉信息，无法完全排除投毒风险，但是考虑到以上的几点，判定投毒的可能性较低。建议在运行POC代码时，务必进行代码审计和安全评估，以避免潜在的风险。

**项目地址:** [bonnettheo/CVE-2024-32002](https://github.com/bonnettheo/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #15

**来源**: [CVE-2024-32002-charlesgargasson_CVE-2024-32002.md](../2024/CVE-2024-32002-charlesgargasson_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 ~ 2.40.2, 2.41.0, 2.42.0 ~ 2.42.2, 2.43.0 ~ 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标Git版本受影响，且启用了submodule和符号链接，在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在处理包含 submodule 的仓库时，允许攻击者通过构造恶意的仓库，将文件写入 `.git/` 目录而不是 submodule 的工作目录中。 这样，攻击者就可以写入一个 hook 脚本，该脚本在克隆操作仍在运行时执行，从而实现远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule，并在该 submodule 中包含一个恶意的 `.gitmodules` 文件和一个 hook 脚本 (例如 `post-checkout`)。
2.  恶意 `.gitmodules` 文件包含指向攻击者控制的另一个仓库的 URL。这个仓库包含恶意的 hook 脚本。
3.  当受害者使用 `git clone --recursive` 命令克隆包含恶意 submodule 的仓库时，Git 会递归地克隆 submodule。
4.  在克隆 submodule 的过程中，由于漏洞，恶意 hook 脚本会被写入到受害者的 `.git/` 目录中，而不是 submodule 的工作目录中。
5.  当 Git 执行 hook 脚本时，攻击者就可以在受害者的系统上执行任意代码。

**有效性：**

根据漏洞描述、搜索结果（特别是vicarius.io的分析文章）和提供的 POC 代码，该漏洞是有效的。POC 代码展示了如何创建恶意仓库，触发漏洞并执行任意命令。

**投毒风险：**

该 POC 代码的目的是演示漏洞利用，但仍然存在一定的投毒风险，约为 10%。这种风险主要来自于以下几个方面：

1.  **反弹shell的IP和端口：** POC 代码中嵌入了反弹 shell 的 IP 地址和端口。攻击者可能会修改这些值，将 shell 反弹到他们控制的服务器上。
2.  **后门代码：** 攻击者可能会在 hook 脚本中添加额外的后门代码，以便在受害者系统上植入持久性的恶意软件。
3.  **依赖库：** 攻击者可能会修改 POC 代码，使其依赖于恶意的第三方库，这些库可能包含恶意代码。

尽管存在这些风险，但该 POC 代码的主要目的是演示漏洞利用，而不是进行恶意攻击。 用户在使用时仍然需要谨慎，确保对代码进行适当的审查和修改，以避免潜在的风险。

**项目地址:** [charlesgargasson/CVE-2024-32002](https://github.com/charlesgargasson/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #16

**来源**: [CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md](../2024/CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统必须使用大小写不敏感的文件系统且启用符号链接（或未禁用）。需要能够访问恶意Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002 漏洞允许攻击者通过构造包含恶意子模块的 Git 仓库，在目标系统上实现远程代码执行。漏洞原理是当Git在大小写不敏感的文件系统上递归克隆包含子模块的仓库时，攻击者可以利用大小写差异将文件写入 `.git/` 目录，从而覆盖或创建恶意 hook。当执行 `git clone --recursive` 命令时，恶意 hook 会被触发，导致任意代码执行。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。该子模块的路径经过特殊构造，利用大小写差异（例如 `A/modules/x` 和 `a/modules/x`）以及符号链接，指向子模块的 `.git/` 目录。
2.  **植入恶意Hook：** 在子模块的 `.git/hooks/` 目录下放置恶意的 Git hook 脚本（例如 `post-checkout`）。
3.  **诱导克隆：** 诱导受害者使用 `git clone --recursive` 命令克隆该恶意仓库。
4.  **触发执行：** 当受害者克隆仓库时，由于文件系统的大小写不敏感特性和符号链接，恶意 hook 会被写入 `.git/` 目录并被执行，导致远程代码执行。

**POC有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码有效。它演示了如何通过精心构造的 Git 仓库和子模块，利用 Git 的递归克隆功能在目标系统上执行任意代码。POC需要用户输入gitea服务器的ip地址、用户名和api token，然后创建两个仓库，并在其中一个仓库中添加恶意hook。另外, 需要手动修改 .gitmodules 文件，指向包含恶意hook的仓库。

**投毒风险评估：**

提供的POC代码主要用于演示漏洞的利用，旨在帮助安全研究人员理解和复现该漏洞。其中涉及的恶意代码（如在 hook 中执行 `calc.exe`）仅用于演示 RCE，并非旨在窃取或破坏用户数据，不构成直接的投毒行为。虽然该POC代码本身不包含投毒代码，但如果被恶意使用者利用，可能会被修改以植入更具破坏性的代码。 因此,投毒的风险概率为0%。

**缓解措施：**

1.  升级 Git 版本到已修复该漏洞的版本（>= 2.39.4, >= 2.40.2, >= 2.41.1, >= 2.42.2, >= 2.43.4, >= 2.44.1, >= 2.45.1）。
2.  禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
3.  避免克隆来自不受信任来源的 Git 仓库。


**项目地址:** [chrisWalker11/running-CVE-2024-32002-locally-for-tesing](https://github.com/chrisWalker11/running-CVE-2024-32002-locally-for-tesing)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #17

**来源**: [CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md](../2024/CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md)

## CVE-2024-32002

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并允许递归克隆包含恶意submodule的仓库。目标文件系统需要大小写不敏感且支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理机制中。攻击者可以构造包含恶意 submodule 的仓库，当受害者递归克隆该仓库时，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。这样，攻击者就可以在克隆过程中执行恶意 hook，从而实现远程代码执行。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞是一个远程代码执行漏洞，利用 submodules 中的缺陷，通过在`.git/`目录下写入恶意 hook 脚本，在 clone 过程中执行该脚本，从而实现 RCE。提供的POC代码尝试模拟此攻击，克隆恶意仓库，设置 git 配置以允许文件协议和符号链接，然后创建包含恶意payload的post-checkout hook，并将其推送到远端仓库，最后添加恶意的submodule。因此，提供的POC代码在满足漏洞利用条件的情况下是有效的。

**投毒风险分析：**
POC代码中存在潜在的投毒风险，作者可能通过恶意修改`shell.sh`，在受害者执行漏洞利用代码时执行意料之外的代码。例如，作者可能添加代码来窃取受害者的凭据、安装后门或进行其他恶意活动。但是从现有代码看，可能性较低。判断依据如下：

*   `rm -rf nothing` 和 `rm -rf toSeeHere` 看上去是无害的操作，但可能用于清理攻击痕迹，或者迷惑分析人员。
*   设置全局git配置，例如`git config --global protocol.file.allow always`，可能允许其他攻击向量。如果受害者在其他环境中使用了被更改的全局git配置，可能会带来安全风险。
*   `git clone http://<server ip>:<port>/<username>/repo1.git` 和 `git clone http://<server ip>:<port>/<username>/repo2.git` 依赖外部的git服务器。该服务器可能包含后门代码，或者在特定的IP/用户环境下，返回不同的内容，实现有选择的攻击。
*   `cat > y/hooks/post-checkout <<EOF
#!bin/sh.exe
#your payload goes here
EOF` 这部分是payload注入点, 攻击者可以伪装成漏洞利用代码，将恶意代码放在此处。

**利用方式分析：**
1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  在 submodule 中，攻击者创建一个 hook 脚本（例如 `post-checkout`），该脚本包含恶意代码。
3.  攻击者将 submodule 添加到主仓库中，并创建一个特殊的 `.git` 文件或符号链接，指向恶意 submodule 的 `.git` 目录。
4.  当受害者递归克隆包含恶意 submodule 的仓库时，Git 会尝试初始化 submodule。
5.  由于存在特殊的 `.git` 文件或符号链接，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。
6.  写入 `.git/` 目录中的 hook 脚本会被执行，从而实现远程代码执行。

**项目地址:** [daemon-reconfig/CVE-2024-32002](https://github.com/daemon-reconfig/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #18

**来源**: [CVE-2024-32002-grecosamuel_CVE-2024-32002.md](../2024/CVE-2024-32002-grecosamuel_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统安装受影响版本的Git，且允许clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个存在于 Git submodules 中的远程代码执行漏洞。当 Git 在大小写不敏感的文件系统上递归克隆存储库时，攻击者可以利用此漏洞。通过精心构造包含恶意 submodule 的 Git 仓库，攻击者可以欺骗 Git 将文件写入到 `.git/` 目录，而不是 submodule 的工作目录中。这使得攻击者可以写入一个 hook 文件，该 hook 文件在 clone 操作期间执行，从而实现远程代码执行。该漏洞的利用依赖于 `core.symlinks` 配置项是否启用。如果 `core.symlinks` 被禁用，攻击将无法成功。提供的 POC 代码通过创建一个包含恶意 post-checkout hook 的 submodule，然后将其包含在一个主仓库中。当受害者克隆主仓库时，post-checkout hook 会被执行，从而导致代码执行。考虑到此漏洞的利用方式，远程仓库本身就可能包含恶意代码，存在一定投毒的风险。

**漏洞利用方式:**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule。
2.  Submodule 包含一个恶意的 `post-checkout` hook，用于执行攻击者的 payload。
3.  攻击者诱使受害者克隆包含恶意 submodule 的仓库。
4.  在克隆过程中，Git 会递归克隆 submodule。
5.  由于漏洞，恶意的 `post-checkout` hook 被写入 `.git/` 目录并执行，导致 RCE。

**POC 代码分析和投毒风险评估:**
提供的POC代码主要功能是自动化漏洞利用流程, 简化了恶意仓库的创建过程。代码本身没有明显的投毒行为。 投毒风险主要来源于clone的远程仓库本身。POC中push到远程仓库步骤也有潜在的投毒风险，虽然可能性较低，但不能完全排除。

**有效性:**
根据搜索引擎结果，有多个来源证实了此漏洞的存在以及POC的有效性。

**项目地址:** [grecosamuel/CVE-2024-32002](https://github.com/grecosamuel/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #19

**来源**: [CVE-2024-32002-sanan2004_CVE-2024-32002.md](../2024/CVE-2024-32002-sanan2004_CVE-2024-32002.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统开启 symlinks 支持 (core.symlinks = true)，且攻击者能够控制一个包含恶意配置的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造的包含恶意子模块的 Git 仓库，在克隆仓库的用户的系统上执行任意代码。漏洞的根源在于 Git 在处理子模块时，可能将文件写入 `.git/` 目录而非子模块的工作目录。这使得攻击者可以放置一个 Git hook (例如 `post-checkout`) 在克隆操作期间执行。PoC 的利用方式是：

1.  **准备恶意仓库 (hulk.git):** 该仓库包含一个 `post-checkout` hook，hook 的内容是恶意payload（示例中是打开计算器）。这个hook会被放置在 `.git/hooks/` 目录下。
2.  **准备包含恶意子模块的仓库 (submod.git):** 该仓库将恶意仓库 (`hulk.git`) 添加为子模块，并创建一个指向 `.git` 目录的符号链接。关键的一步是使用`git update-index`命令来创建一个指向 `.git` 目录的符号链接。
3.  **准备最终的触发仓库 (smash.git):** 用户克隆该仓库时，由于递归克隆子模块，符号链接会被错误地解析，导致 `post-checkout` hook 被复制到 `.git/hooks/` 目录下，并在克隆过程的某个阶段执行，从而实现 RCE。

**有效性：** 提供的 PoC 代码是有效的，如果满足先决条件（易受攻击的 Git 版本和启用的符号链接），则可以成功触发 RCE。

**投毒风险：** PoC 本身的主要功能是演示漏洞，但由于代码的复杂性，存在细微的投毒风险。例如，`poc.sh` 脚本中可以被加入额外命令，在执行漏洞利用的同时，进行其他恶意操作，例如收集用户信息、安装后门程序等。此外，`hulk.git`仓库中可以存在除计算器之外的其他恶意payload。因此,投毒风险评估为10%。

**利用方式：** 攻击者需要控制一个 Git 仓库，并诱导受害者递归克隆该仓库。一旦受害者执行了 `git clone --recursive <恶意仓库>` 命令，恶意代码就会在其系统上执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用符号链接支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不受信任来源的仓库。

**项目地址:** [sanan2004/CVE-2024-32002](https://github.com/sanan2004/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #20

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-demo.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-demo.md)

## CVE-2024-32002-Git递归克隆远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许未经身份验证的攻击者在受害者机器上执行任意代码

**影响版本:** < 2.39.4, >= 2.40.0 < 2.40.2, = 2.41.0, >= 2.42.0 < 2.42.2, >= 2.43.0 < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标系统需要使用受影响版本的Git，且需要在大小写不敏感的文件系统（例如macOS的默认设置，Windows）上克隆包含恶意配置的仓库，同时`core.symlinks`配置未显式设置为`false`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造包含恶意子模块的 Git 仓库，利用 Git 在大小写不敏感的文件系统上的处理缺陷，将恶意 hook 写入 `.git/` 目录，从而在克隆仓库时执行任意代码。攻击者可以诱骗用户克隆恶意仓库，从而在用户不知情的情况下执行恶意代码。

**有效性分析：**

根据漏洞描述，提供的POC代码旨在演示如何利用此漏洞。通过`git clone --recursive`命令克隆该仓库，如果目标系统满足漏洞触发条件（受影响的Git版本，大小写不敏感的文件系统，未禁用符号链接），则可能触发漏洞，导致恶意代码执行。提供的POC利用方法符合漏洞描述，因此POC**可能有效**。

**投毒风险分析：**

提供的代码片段包括：

*   `/README.md`: 包含克隆仓库的说明。
*   `/docs/README.md`: 简单的文档说明。
*   `/src/example.py`: 一个简单的Python脚本，用于处理数据并打印结果。

初步分析表明，提供的代码本身并没有明显的恶意代码或后门。主要的风险在于该仓库可能包含隐藏的恶意 Git 配置（例如存在于.gitmodules或者.git/hooks中）或者子模块，当使用`git clone --recursive`时被自动执行。

由于无法直接看到.git目录下的文件，因此无法完全排除投毒风险。假设`git clone --recursive` 命令在满足条件下，自动触发恶意hook的可能性比较低，但是仍然存在。因此这里给出了5%的投毒可能性。

**利用方式：**

1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  恶意子模块包含一个 hook，该 hook 会在仓库被克隆时执行任意代码。
3.  攻击者诱骗受害者克隆该恶意仓库。
4.  当受害者使用 `git clone --recursive` 命令克隆仓库时，恶意 hook 被执行，从而导致远程代码执行。

要减轻此漏洞的影响，用户应避免克隆来自不受信任来源的仓库，并确保使用的 Git 版本已更新到修复此漏洞的版本。 此外，如果不需要符号链接，可以禁用符号链接支持，通过设置`git config --global core.symlinks false`来缓解风险。

**项目地址:** [srakkk/cve-2024-32002-demo](https://github.com/srakkk/cve-2024-32002-demo)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #21

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-hook.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-hook.md)

# CVE-2024-32002

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md](../2024/CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且允许递归克隆包含恶意submodule的仓库。利用需要case-insensitive文件系统，且默认开启了symlink(core.symlinks=true)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002是Git中一个严重的安全漏洞，它允许攻击者通过构造恶意的Git仓库，在目标系统上执行任意代码。攻击的核心在于利用了Git处理submodule时的不严谨性，特别是在大小写不敏感的文件系统上。

**漏洞利用方式：**

1.  **恶意仓库构造：** 攻击者创建一个包含submodule的Git仓库。该submodule的URL被精心构造，包含恶意payload。利用`ssh://-oProxyCommand=payload/`格式的URL，使得在submodule初始化时，`ProxyCommand`会被执行，从而达到远程命令执行的效果。
2.  **受害者克隆：** 受害者使用Git克隆该恶意仓库，并使用 `--recurse-submodules` 参数或者配置`git config --global submodule.recurse true`。递归克隆submodules.
3.  **触发漏洞：** 在克隆过程中，Git会尝试初始化submodule。由于submodule的URL包含恶意payload，Git会执行`ProxyCommand`指定的命令，从而在受害者系统上执行攻击者预设的恶意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是[webpage 4 begin]到[webpage 6 begin]）和提供的漏洞利用代码，可以确认该漏洞是有效的。多个来源都提供了关于此漏洞的分析、利用方式和缓解措施。POC代码利用Metasploit框架模拟了恶意Git服务器，展示了如何通过构造恶意的submodule URL来执行任意命令。

**投毒风险：**

提供的Metasploit模块本身用于漏洞利用演示，主要功能是搭建一个包含恶意submodule配置的Git仓库。该模块将payload插入到`.gitmodules`文件中，并通过`ProxyCommand`执行。

虽然没有明显的“投毒”代码，但依然存在以下风险：

*   **payload隐蔽性：**攻击者可能在payload中嵌入看似无害但实则具有恶意行为的代码，例如下载执行其他恶意程序、窃取敏感信息等。这种payload可以通过混淆、加密等技术来逃避检测，因此存在一定的投毒风险。

综合评估，投毒风险较低，大约为5%。主要风险在于Payload部分可能包含恶意指令。


**项目地址:** [Basyaact/CVE-2024-32002-PoC_Chinese](https://github.com/Basyaact/CVE-2024-32002-PoC_Chinese)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #2

**来源**: [CVE-2024-32002-FlojBoj_CVE-2024-32002.md](../2024/CVE-2024-32002-FlojBoj_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** v2.45.0, v2.44.0, <=v2.43.3, <=v2.42.1, v2.41.0, <=v2.40.1, <=v2.39.3

**利用条件:** 目标系统需要安装存在漏洞的Git版本，并且文件系统大小写不敏感且支持符号链接(或配置`core.symlinks=true`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块功能中。攻击者可以构造包含恶意子模块的仓库，利用 Git 在处理子模块时可能将文件写入 `.git/` 目录而不是子模块工作目录的漏洞。通过精心构造的子模块，攻击者可以在目标机器上执行任意代码。利用过程如下：

1.  **恶意仓库准备：** 攻击者创建两个仓库 rep1 和 rep2。
2.  **rep1 (恶意子模块)：** 在 rep1 中，创建一个 `executable/hooks/post-checkout` 文件，该文件包含要执行的恶意代码（例如，启动计算器应用）。使用`git update-index --chmod=+x executable/hooks/post-checkout`命令赋予该文件执行权限，并推送到 rep1 仓库。
3.  **rep2 (主仓库)：** 在 rep2 中，将 rep1 作为子模块添加到 `A/modules/exploit` 路径下。
4.  **漏洞触发：**  关键在于创建 `dotgit.txt` 文件，内容为 `.git`，计算其哈希值，然后构造 `index.info` 文件，该文件将 `A/modules/exploit/.git` 设置为符号链接指向计算出的哈希对象，以此欺骗 Git。
5.  **克隆触发：** 当受害者使用 `git clone --recursive $REP2` 命令克隆 rep2 仓库时，Git 会尝试递归克隆子模块 rep1。
6.  **代码执行：** 由于 rep2 中 `A/modules/exploit/.git` 被伪造成符号链接，Git 在处理子模块时会将 rep1 中的 `executable/hooks/post-checkout` 文件错误地写入 `.git/hooks` 目录，从而使其成为一个 Git 钩子。`post-checkout` 钩子会在 `git clone` 操作完成后自动执行，从而触发恶意代码。

**投毒风险分析：**

  此POC本身旨在利用漏洞，但其中存在潜在的投毒风险。例如，`exploit.sh` 中定义的 `exploit` 变量决定了执行的恶意代码。虽然当前 POC 中是启动计算器，但攻击者完全可以替换为更具危害性的命令，例如下载并执行恶意脚本。虽然代码中声明“USE ONLY FOR EDUCATIONAL PURPOSES!”，但仍需谨慎使用。

**有效性分析：**

 根据漏洞描述和搜索结果，该 POC 有效。提供的 POC 代码展示了如何利用此漏洞在目标机器上执行任意代码。

**风险缓解：**

*   升级 Git 到修复后的版本。
*   避免克隆来自不受信任来源的仓库。
*   禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
*   对克隆的仓库进行安全审查。

**项目地址:** [FlojBoj/CVE-2024-32002](https://github.com/FlojBoj/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #3

**来源**: [CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md](../2024/CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md)

## CVE-2024-32002 - Git Submodule Remote Code Execution

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行，完全控制受影响系统

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 需要目标系统使用受影响的 Git 版本，且支持符号链接。利用依赖于递归克隆包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个严重的远程代码执行漏洞，它允许攻击者通过恶意构造包含子模块的 Git 仓库来执行任意代码。漏洞的核心在于 Git 在处理子模块路径时存在缺陷，攻击者可以利用此缺陷将恶意文件写入 `.git/` 目录，从而劫持 Git 的行为。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。关键在于构造一个恶意的 `.gitmodules` 文件。此文件中定义的子模块路径会被操纵，指向 `.git/` 目录内的某个位置。
2.  **符号链接欺骗：** 攻击者会创建一个符号链接，将仓库中的某个目录链接到 `.git/` 目录。例如，创建一个名为 `A` 的目录的符号链接，使其指向 `.git/`。
3.  **路径注入：** 通过组合恶意 `.gitmodules` 文件和符号链接，攻击者可以欺骗 Git 将子模块的内容写入 `.git/modules/` 目录。这允许攻击者注入恶意 hook 脚本。
4.  **触发执行：** 当受害者递归克隆（`git clone --recursive`）恶意仓库时，Git 将初始化子模块，并将恶意 hook 脚本复制到 `.git/hooks/` 目录。然后，当受害者执行诸如 `git checkout` 之类的 Git 操作时，这些恶意 hook 脚本会被触发执行，从而导致远程代码执行。

**POC 分析：**

提供的 POC 代码通过 Dockerfile 构建了一个包含漏洞 Git 版本的环境，并使用 `setup.sh` 脚本自动化了漏洞利用过程。该脚本创建了一个包含恶意 `post-checkout` hook 的子模块，修改 `.gitmodules` 文件，创建必要的符号链接，并将恶意 hook 注入到受害者的 `.git/hooks/` 目录中。当执行 `git checkout HEAD` 时，hook 脚本会被触发，在 `/tmp/teste.txt` 中写入 "joao was here"，从而验证了漏洞的存在。

**投毒风险分析：**

虽然 POC 代码的主要目的是演示漏洞，但仍然存在潜在的投毒风险。`setup.sh` 脚本包含以下可疑行为：

*   向 `/etc/sudoers` 文件添加用户，允许用户无密码执行 sudo 命令。虽然这可能是为了方便演示，但在实际环境中会带来安全风险。

考虑到这些因素，我将投毒风险评估为 10%。

**项目地址:** [JoaoLeonello/cve-2024-32002-poc](https://github.com/JoaoLeonello/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #4

**来源**: [CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md](../2024/CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致完全控制受害者机器

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 受害者需要使用受影响的Git版本克隆恶意构造的包含submodule的仓库，并且需要在大小写不敏感的文件系统上克隆。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理中。恶意攻击者可以构造包含恶意 submodule 的 Git 仓库，当受害者使用 `git clone --recurse-submodules` 命令克隆该仓库时，Git 会被诱导将文件写入 `.git/` 目录而不是 submodule 的工作目录。攻击者可以在 `.git/hooks` 目录下写入恶意 hook 脚本，这些脚本会在克隆操作期间执行，从而实现远程代码执行。攻击成功的关键在于利用了大小写不敏感文件系统的特性，使得恶意文件能够覆盖 `.git/` 目录下的合法文件。

**有效性评估：** 根据漏洞库信息和搜索结果（特别是 webpage 5），该漏洞的PoC是可用的，并且描述了利用方式。

**投毒风险评估：** 提供的 PoC 代码 `post-checkout` 脚本主要执行以下操作：

*   显示一段消息。
*   打开计算器程序 (`calc.exe`)，这是一个常见的 PoC 行为。
*   打开 Edge 浏览器并播放 YouTube 视频，同样是 PoC 行为，表明代码执行。
*   在用户 Home 目录下的每个目录中创建一个名为 `trace.txt` 的文件，写入一段消息。

虽然 PoC 代码本身没有明显的恶意行为，但创建 `trace.txt` 文件的操作可能被滥用。如果攻击者精心构造 `trace.txt` 的内容，例如包含恶意脚本或者利用其他漏洞的 payload，可能会造成进一步的危害。因此，存在一定的投毒风险，但风险相对较低，因为其行为是比较明显的。所以判定投毒概率为20%。

**利用方式：**

1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  恶意 submodule 中包含一个精心构造的 `.git/hooks/post-checkout` 脚本，该脚本包含攻击 payload。
3.  攻击者诱导受害者使用 `git clone --recurse-submodules` 命令克隆该仓库。
4.  当 Git 处理 submodule 时，会将恶意 `post-checkout` 脚本写入受害者机器的 `.git/hooks` 目录下。
5.  Git 在克隆完成后会自动执行 `post-checkout` 脚本，从而执行攻击 payload，实现远程代码执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)，但这可能会影响正常的 Git 使用。
*   避免克隆来自不受信任来源的仓库。


**项目地址:** [Julian-gmz/hook_CVE-2024-32002](https://github.com/Julian-gmz/hook_CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #5

**来源**: [CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md](../2024/CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需要使用受影响的Git版本，并且文件系统区分大小写，支持符号链接，用户需要克隆恶意仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以创建一个恶意仓库，其中包含特殊的子模块配置，使得在克隆仓库时，Git 将文件写入 `.git/` 目录而非子模块的工作目录。这允许攻击者放置一个恶意 hook 脚本到 `.git/hooks` 目录，该脚本会在克隆过程执行时被触发，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意子模块配置的Git仓库。
2.  该恶意配置指向一个包含 hook 脚本的子模块。
3.  受害者使用 `git clone --recursive` 命令克隆该仓库。
4.  Git 在处理子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
5.  克隆过程执行到一定阶段时，恶意 hook 脚本被触发，执行攻击者指定的任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞真实存在，并且有公开的PoC（例如vsociety提供的PoC）。提供的PoC代码`git clone --recursive "git@github.com:masamuneee/CVE-2024-32002-POC.git"` 可以触发漏洞。

**投毒风险：**

提供的 PoC 代码仅仅是一个 README 文件，用于演示漏洞利用的克隆命令。但是， `masamuneee/CVE-2024-32002-POC.git` 仓库本身可能包含恶意 payload（例如 hook 脚本）。虽然目前的PoC只是一个说明文件，不构成直接威胁，但是如果用户真的去克隆`git@github.com:masamuneee/CVE-2024-32002-POC.git`这个仓库,存在被投毒的风险。即使作者本意是提供PoC，也可能被其他人修改后上传带有恶意代码的版本。 因此，投毒风险评估为10%，主要源于克隆远程仓库的潜在风险，以及对作者上传的poc完整性的怀疑，毕竟用户克隆的是远程仓库，本地进行验证。

**参考链接：**

*   [https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv](https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv)
*   [https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)
*   [https://www.wiz.io/vulnerability-database/cve/cve-2024-32002](https://www.wiz.io/vulnerability-database/cve/cve-2024-32002)

**项目地址:** [Masamuneee/CVE-2024-32002-POC](https://github.com/Masamuneee/CVE-2024-32002-POC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #6

**来源**: [CVE-2024-32002-Masamuneee_hook.md](../2024/CVE-2024-32002-Masamuneee_hook.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：2.45.0, 2.44.0, >= 2.43.0 < 2.43.4, >= 2.42.0 < 2.42.2, 2.41.0, >= 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统安装Git，并且clone包含恶意submodule的仓库，利用依赖于对大小写不敏感的文件系统，并启用符号链接。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002是Git中存在的一个远程代码执行漏洞，它允许攻击者通过精心构造包含恶意submodule的Git仓库，诱导受害者clone该仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式：**
1.  攻击者创建一个包含submodule的恶意Git仓库。
2.  该submodule包含一个恶意的`.git/hooks/post-checkout` hook。
3.  利用了Git在处理submodule时，可能将文件写入`.git/`目录而不是submodule的工作目录的缺陷。
4.  当受害者在对大小写不敏感的文件系统上，且启用符号链接的情况下，clone这个仓库并检出（checkout）或者更新 submodule时，恶意hook会被执行，导致远程代码执行。

**有效性：**
提供的POC代码是有效的，因为它展示了如何创建一个包含恶意`post-checkout` hook的submodule，并在clone时触发该hook，从而执行任意命令。其中`/tmp/hacked`用于linux环境下的测试，powershell命令用于windows环境下的测试。

**投毒风险：**
虽然提供的POC代码本身是用于验证漏洞的，但如果攻击者在真实的恶意仓库中，除了POC代码之外还包含其他隐藏的恶意代码，则存在投毒风险。当前提供的POC代码中，`/tmp/e81041e852bc4e53c491bef3aef35e69/README.md` 文件和 `/tmp/e81041e852bc4e53c491bef3aef35e69/fast/hooks/post-checkout` 都可能被写入隐藏的恶意代码。假设作者有意隐藏投毒代码，可能性为20%。

**缓解措施：**
1.  升级Git到已修复的版本（>= 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, 2.39.4）。
2.  避免clone来自不受信任来源的仓库。
3.  禁用Git的符号链接支持（`git config --global core.symlinks false`）。
4.  在clone仓库后，仔细检查submodule的内容，特别是`.git/hooks`目录下的文件。

**项目地址:** [Masamuneee/hook](https://github.com/Masamuneee/hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #7

**来源**: [CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.39.4之前，以及2.40.0到2.40.2，2.41.0，2.42.0到2.42.2，2.43.0到2.43.4，2.44.0和2.45.0版本

**利用条件:** 需要目标系统启用符号链接支持，并且从恶意Git仓库克隆包含恶意submodule的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个远程代码执行 (RCE) 漏洞。该漏洞源于 Git 处理 submodules 的方式存在缺陷，攻击者可以构造恶意的 Git 仓库，其中包含一个精心设计的 submodule，该 submodule 利用了 Git 的漏洞，可以将文件写入 `.git/` 目录而不是 submodule 的工作目录。这允许攻击者在克隆操作期间执行恶意 hook，从而在受害者机器上执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的PoC是有效的。搜索结果中的 [webpage 6] 提到了一个演示如何利用该漏洞的PoC。
提供的PoC代码首先配置 Git 允许 file 协议和启用符号链接。然后，它创建一个包含恶意 post-checkout hook 的仓库 repo1。此 hook 包含一个 Payload，将在克隆 repo1 后执行。接下来，它创建一个包含 submodule 的仓库 repo2，该 submodule 指向 repo1。关键步骤是创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。最后，克隆 repo2 会触发恶意 hook，导致执行 Payload。

**投毒风险：**

该PoC本身就包含恶意代码(`<Payload>`)，用于在受害者机器上执行命令。投毒风险的评估旨在判断作者是否在PoC代码之外，还隐藏了其他的恶意代码或逻辑，用于进一步攻击或控制受害者系统。代码中可能存在潜在的投毒风险，但根据现有代码，没有找到明确的投毒代码。考虑到README中作者的个人站点链接，存在一定的概率通过其他方式植入后门，因此投毒风险预估为10%。

**利用方式：**

1.  **攻击者创建一个恶意 Git 仓库（例如 repo1），其中包含一个恶意 hook。** hook 的作用是在克隆仓库后执行 Payload。
2.  **攻击者创建一个包含 submodule 的 Git 仓库（例如 repo2），该 submodule 指向恶意仓库 repo1。**
3.  **攻击者创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。** 这一步是漏洞利用的关键，它欺骗 Git 将文件写入 `.git/` 目录。
4.  **受害者克隆仓库 repo2。** 在克隆过程中，Git 会尝试更新 submodule，由于存在符号链接，恶意 hook 将被写入 `.git/` 目录并执行，从而在受害者机器上执行 Payload。

该漏洞利用的先决条件是目标系统必须启用符号链接支持。如果 `core.symlinks` 设置为 `false`，则该漏洞无法利用。


**项目地址:** [NishanthAnand21/CVE-2024-32002-PoC](https://github.com/NishanthAnand21/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #8

**来源**: [CVE-2024-32002-SpycioKon_CVE-2024-32002.md](../2024/CVE-2024-32002-SpycioKon_CVE-2024-32002.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要存在受影响版本的Git，并且允许递归克隆包含恶意submodule的仓库，文件系统对大小写不敏感，支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个 Git 中的远程代码执行 (RCE) 漏洞，它允许攻击者通过精心制作的包含恶意 submodule 的 Git 仓库来执行任意代码。该漏洞的利用方式如下：

1.  **创建恶意仓库 (repo1)：** 攻击者创建一个包含恶意 hook 的 Git 仓库 (repo1)。在该 POC 代码中，`exp` 脚本首先克隆一个名为 `repo1` 的仓库，然后在 `y/hooks/post-checkout` 路径下创建一个恶意的 `post-checkout` hook。该 hook 包含经过 base64 编码的 PowerShell 代码，这段代码会尝试建立一个反向 shell 连接到攻击者的机器 (10.10.15.68:9999)。注意，`git config --global core.symlinks true` 启用了符号链接支持，这是利用此漏洞的关键。

2.  **创建包含恶意 submodule 的仓库 (repo2)：** 攻击者创建第二个仓库 (repo2)，并将第一个仓库 (repo1) 作为 submodule 添加进去。  POC代码执行了`git submodule add --name x/y "http://10.10.11.26:3000/admin123/repo1.git" A/modules/x`，将`repo1` 添加为 `repo2` 的子模块。然后，它创建一个名为 `dotgit.txt` 的文件，内容为 `.git`。接着，它计算该文件的哈希值，并利用该哈希值创建一个 `index.info` 文件，该文件用于创建一个指向 `.git` 目录的符号链接。

3.  **利用符号链接欺骗 Git：** 攻击者创建一个指向 `.git` 目录的符号链接。 当受害者递归克隆包含恶意 submodule 的仓库时，Git 会错误地将 hook 写入 `.git/` 目录，而不是 submodule 的工作目录。由于 `.git/` 目录下的 hook 会在克隆操作期间执行，因此攻击者可以在受害者的系统上执行任意代码。

4.  **克隆触发漏洞：** 受害者使用 `git clone --recursive repo2` 命令克隆包含恶意 submodule 的仓库 (repo2)。 当 Git 初始化 submodule 时，它会执行 `.git/` 目录中的 hook，从而触发攻击者预先植入的恶意代码。

**有效性：**根据搜索结果和漏洞描述，提供的 POC 代码是有效的，可以用来复现和验证 CVE-2024-32002 漏洞。搜索结果中多篇文章提到了利用 submodules 和符号链接将文件写入 `.git/` 目录，并执行恶意 hook。

**投毒风险：** POC 中存在一定的投毒风险。虽然主要目的是演示漏洞利用，但攻击者可能在 `post-checkout` hook 中植入额外的恶意代码，例如收集受害者系统信息、安装后门等。由于该POC主要目的是复现漏洞，其核心代码部分是漏洞利用所需的，因此判定投毒风险为10%。

**漏洞利用方式总结：**

*   攻击者创建一个包含恶意 hook 的 Git 仓库。
*   攻击者创建一个包含恶意 submodule（指向第一个仓库）的 Git 仓库。
*   攻击者在第二个仓库中创建一个指向 `.git` 目录的符号链接。
*   受害者递归克隆第二个仓库。
*   Git 错误地将 hook 写入 `.git/` 目录。
*   克隆操作期间，hook 被执行，导致 RCE。

**项目地址:** [SpycioKon/CVE-2024-32002](https://github.com/SpycioKon/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #9

**来源**: [CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md](../2024/CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标服务器需要安装受影响的Git版本，且文件系统区分大小写并支持符号链接，需要克隆包含恶意子模块的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以构造恶意的 Git 仓库，其中包含一个带有恶意配置的子模块。当用户递归克隆这个仓库时，Git 会将恶意文件写入 `.git/` 目录，而不是子模块的工作目录，导致可以执行恶意的 hook 脚本，实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 `post-checkout` hook 脚本，它会在 `git checkout` 操作后执行。脚本的内容是将 "amal_was_here" 写入 `/tmp/pwnd` 文件，并且打开计算器程序。如果目标系统成功执行了这个脚本，就可以证明该漏洞的有效性。

**投毒风险：**
POC 代码本身不包含明显的投毒行为，它只是一个简单的示例，用于验证漏洞的存在。但是，考虑到漏洞利用方式，攻击者可以修改 hook 脚本，使其包含更具破坏性的恶意代码。例如，可以执行系统命令、窃取敏感信息或者植入后门。因此，从远程仓库克隆代码时，始终存在一定的风险。
投毒风险评估为 10%，因为这个示例代码更像是概念验证，而非恶意利用，但实际攻击中，攻击者完全可以将hook脚本编写为恶意的脚本。

**利用方式：**
1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  子模块的 `.gitmodules` 文件中包含指向恶意仓库的 URL。
3.  恶意仓库的 `hooks/post-checkout` 目录包含攻击者想要执行的恶意脚本。
4.  受害者递归克隆包含恶意子模块的 Git 仓库（例如，使用 `git clone --recurse-submodules` 命令）。
5.  Git 在克隆子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
6.  当执行 `git checkout` 操作时，恶意 hook 脚本被执行，导致远程代码执行。

**项目地址:** [TSY244/CVE-2024-32002-git-rce-father-poc](https://github.com/TSY244/CVE-2024-32002-git-rce-father-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #10

**来源**: [CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md](../2024/CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 < version < 2.40.2, 2.41.0, 2.42.0 < version < 2.42.2, 2.43.0 < version < 2.43.4, 2.44.0, 2.45.0, <= 2.45.0

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统区分大小写并支持符号链接，攻击者可控的Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002是一个Git中的远程代码执行漏洞，该漏洞源于Git处理包含子模块的仓库时存在缺陷。攻击者可以构造恶意仓库，利用子模块机制，将恶意文件写入`.git/`目录而不是子模块的工作目录。由于`.git/`目录下的文件可能包含Git钩子(hooks)，这些钩子会在特定的Git操作期间被执行，从而导致任意代码执行。如果目标系统禁用了符号链接（`core.symlinks = false`），则该漏洞无法利用。从搜索结果和漏洞描述来看，多个安全厂商和社区已经公开了漏洞分析和利用方法，证明了该漏洞的有效性。提供的漏洞利用代码是Apache License 2.0的许可协议，并非实际的PoC代码，因此无法直接评估投毒风险。但根据漏洞原理，攻击者需要在恶意仓库中植入恶意的子模块和钩子脚本，才能实现远程代码执行。由于提供的代码是许可证文件，所以投毒风险判定为0%。漏洞利用方式：1. 构造包含恶意子模块的Git仓库。2. 在恶意子模块中包含恶意的Git钩子（例如 pre-commit, post-receive等）。3. 诱导受害者克隆该恶意仓库并递归初始化子模块。4. 当Git执行相关操作时，恶意的钩子脚本被触发，导致远程代码执行。

**项目地址:** [XiaomingX/cve-2024-32002-poc](https://github.com/XiaomingX/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #11

**来源**: [CVE-2024-32002-ashutosh0408_CVE-2024-32002.md](../2024/CVE-2024-32002-ashutosh0408_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需使用受影响的Git版本，且文件系统为大小写不敏感（如Windows或macOS），并允许符号链接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 是 Git 中一个允许远程代码执行的漏洞，它与子模块有关。恶意仓库可以精心构造，利用大小写不敏感文件系统上的符号链接处理缺陷，将文件写入 `.git/` 目录，进而执行恶意 hooks。

**有效性：**

根据漏洞描述和PoC代码，此PoC代码有效。多个搜索结果（如webpage 6和 webpage 7）表明存在针对此漏洞的利用，并且提供了利用成功的案例。PoC代码的 `README.md` 文件也提供了在Windows和Mac上的成功执行截图。 PoC 明确指出只能在 Windows 或 Mac 系统上工作, 这与漏洞描述中依赖大小写不敏感的文件系统相符。

**投毒风险：**

PoC代码主要由以下几个部分组成：

1.  `create_poc.sh`：用于创建利用此漏洞的恶意Git仓库。
2.  `hook/y/hooks/post-checkout` 和 `post-checkout`：这些文件包含了实际的恶意代码，也就是将在目标机器上执行的代码。这段代码会创建一个文件 `/tmp/pwnd`，并尝试运行 `calc.exe` （Windows）或 `open -a Calculator.app` （Mac）。
3.  `README.md`：提供漏洞描述和利用方法。

分析 `create_poc.sh` 脚本，其中包含一些git配置，创建一个恶意hook，并添加到git仓库中。该脚本的主要目的是自动化生成一个可被利用的恶意仓库，其本身并不包含任何隐藏的、与PoC目的无关的代码。

恶意代码部分，也就是`hook/y/hooks/post-checkout` 和 `post-checkout`脚本，其功能是创建文件和打开计算器程序。 虽然这些操作本身是无害的，但是攻击者可以替换成任何其他恶意代码，例如植入后门程序、窃取敏感数据等。

因此，判断此仓库中存在作者隐藏的投毒代码的风险较低。PoC本身包含的恶意代码是为了验证漏洞，并非隐藏的恶意功能。风险主要在于用户如果直接使用此PoC，没有意识到其潜在的危害，则可能导致安全问题。由于是公开的 PoC，其目的是演示漏洞利用，因此作者故意隐藏恶意代码的可能性较低，风险评估为5%。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个包含特殊构造路径的子模块。
2.  子模块路径使用大小写变体，以利用大小写不敏感的文件系统。
3.  子模块包含一个指向其 `.git/` 目录的符号链接，该目录包含一个恶意 hook（例如 `post-checkout`）。
4.  当用户克隆恶意仓库时，`git clone --recursive` 命令会递归初始化和更新子模块。
5.  在大小写不敏感的文件系统上，Git 会跟随符号链接，并将恶意 hook 写入 `.git/` 目录。
6.  当执行 `git checkout` 等操作时，恶意 hook 会被执行，从而导致远程代码执行。

利用成功的关键点在于大小写不敏感的文件系统和符号链接的使用，以及 Git 在处理子模块时的缺陷。


**项目地址:** [ashutosh0408/CVE-2024-32002](https://github.com/ashutosh0408/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #12

**来源**: [CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md](../2024/CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并且开启了submodule功能，文件系统区分大小写，允许创建符号链接，受害者clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞，利用方式主要通过精心构造包含恶意submodule的 Git 仓库。攻击者可以利用此漏洞，通过诱导受害者递归克隆包含恶意配置的仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式:**

1.  **创建恶意仓库：** 攻击者创建包含恶意submodule配置的Git仓库，该仓库中的submodule指向一个包含恶意hook的仓库。
2.  **恶意Hook：**  攻击者在submodule的仓库中，设置post-checkout hook，该hook会在`git clone --recursive`命令执行时被触发，从而执行攻击者预设的恶意代码。POC代码中，恶意代码为打开计算器应用。
3.  **符号链接操纵：**  利用Git对submodule处理的缺陷，通过创建指向`.git`目录的符号链接，使得恶意hook被放置在`.git/hooks`目录下，从而绕过安全检查。
4.  **诱导克隆：**  攻击者诱导受害者克隆包含恶意submodule的仓库，使用`git clone --recursive`命令。
5.  **触发RCE：**  当受害者执行`git clone --recursive`命令时，恶意hook被触发，执行攻击者预设的恶意代码，实现远程代码执行。

**POC有效性评估:**

根据提供的漏洞信息和利用代码，该POC代码是有效的。它成功演示了如何利用Git submodule的漏洞，通过创建恶意仓库和hook，在受害者机器上执行任意代码。多个搜索结果，例如webpage 6的[Exploiting git RCE: CVE-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)，也验证了该漏洞的可利用性。

**投毒风险分析:**

尽管提供的代码主要用于演示漏洞利用，但仍然存在一定的投毒风险。风险主要来自以下几个方面：

1.  **Payload替换：**  POC中使用打开计算器作为示例payload，攻击者可以轻易地替换成其他更具危害性的恶意代码，例如植入后门、窃取敏感信息等。
2.  **依赖风险：**  POC脚本依赖于特定的git命令和文件系统操作。如果攻击者修改了脚本，添加了额外的依赖或操作，可能会导致受害者系统出现未知问题。
3.  **远程仓库风险：**  虽然POC中指定了特定的远程仓库，但攻击者可能会修改脚本，指向其他包含更隐蔽或更具危害性的恶意代码的仓库。

评估结果为10%,原因在于当前代码中仅仅提供PoC思路,不存在额外恶意操作。

**项目地址:** [ashutosh0408/Cve-2024-32002-poc](https://github.com/ashutosh0408/Cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #13

**来源**: [CVE-2024-32002-blackninja23_CVE-2024-32002.md](../2024/CVE-2024-32002-blackninja23_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要在大小写不敏感的文件系统（例如Windows或macOS）上进行克隆，并且core.symlinks=true（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在递归克隆包含恶意子模块的存储库时，由于大小写不敏感的文件系统上的符号链接处理不当，导致可以将文件写入 `.git/` 目录而不是子模块的工作目录中。 这允许写入一个钩子，该钩子将在克隆操作仍在运行时执行，使用户没有机会检查正在执行的代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。PoC 代码明确展示了如何利用该漏洞在 Windows 和 macOS 系统上实现 RCE。

**投毒风险：**
该存储库存在一定的投毒风险。虽然提供的 PoC 代码看似直接，目的是展示漏洞利用，但`create_poc.sh`脚本如果被修改，则有可能植入恶意代码，导致使用者在不知情的情况下执行攻击者的恶意操作。脚本中包含的 URL `https://github.com/blackninja23/hook.git`，如果被替换成恶意仓库，存在被投毒的风险。但代码本身功能比较直白，没有过于复杂的逻辑，因此投毒风险较低，预估为10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个子模块。
2.  该子模块的路径被精心构造，利用大小写变体（例如 `A/modules/x` vs `a/modules/x`）来欺骗大小写不敏感的文件系统。
3.  该子模块包含一个符号链接，指向仓库的 `.git/` 目录。
4.  `.git/` 目录中包含一个恶意 Git 钩子（例如 `post-checkout`）。
5.  当受害者使用 `git clone --recursive` 克隆恶意仓库时，Git 会尝试递归地克隆子模块。
6.  由于大小写不敏感的文件系统，Git 可能会错误地解析子模块的路径，导致符号链接被解析到 `.git/` 目录中。
7.  恶意 Git 钩子会被执行，从而导致远程代码执行。

**项目地址:** [blackninja23/CVE-2024-32002](https://github.com/blackninja23/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #14

**来源**: [CVE-2024-32002-bonnettheo_CVE-2024-32002.md](../2024/CVE-2024-32002-bonnettheo_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要启用submodule和符号链接支持，且攻击者需要诱使用户克隆恶意构造的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 存在于 Git 中，允许攻击者通过恶意构造包含子模块的仓库，利用 Git 在不安全的上下文中写入文件的漏洞来执行任意代码。此漏洞利用了 Git 在处理子模块时的路径遍历缺陷，攻击者可以欺骗 Git 将恶意 hook 写入 `.git/` 目录而不是子模块的工作树中。当克隆操作仍在进行时，这些 hook 将被执行，使用户没有机会检查正在执行的代码。该漏洞主要影响启用了子模块和符号链接支持的系统。修复方法是升级到 Git 的安全版本(>=2.45.1, >=2.44.1, >=2.43.4, >=2.42.2, >=2.41.1, >=2.40.2, >=2.39.4) 或禁用符号链接支持(git config --global core.symlinks false)。

根据搜索引擎结果，该漏洞已得到广泛关注，并有公开的利用代码和分析文章。POC代码有效性高，能够实现远程代码执行。

该仓库的投毒风险较低，主要基于以下几点判断：

*   **代码来源：** POC代码引用了另一个开源项目，并提供了原始作者的博客链接，提高了透明度。
*   **免责声明：** 仓库包含明确的免责声明，强调仅用于教育和信息目的，禁止在未经授权的系统上运行。
*   **文件内容：** 仓库中主要包含漏洞说明和利用代码链接，没有发现额外的可疑文件或代码片段。
*   **作者信誉：** 缺乏对该仓库作者的信誉信息，无法进行有效判断。

由于缺乏直接的代码分析和作者信誉信息，无法完全排除投毒风险，但是考虑到以上的几点，判定投毒的可能性较低。建议在运行POC代码时，务必进行代码审计和安全评估，以避免潜在的风险。

**项目地址:** [bonnettheo/CVE-2024-32002](https://github.com/bonnettheo/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #15

**来源**: [CVE-2024-32002-charlesgargasson_CVE-2024-32002.md](../2024/CVE-2024-32002-charlesgargasson_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 ~ 2.40.2, 2.41.0, 2.42.0 ~ 2.42.2, 2.43.0 ~ 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标Git版本受影响，且启用了submodule和符号链接，在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在处理包含 submodule 的仓库时，允许攻击者通过构造恶意的仓库，将文件写入 `.git/` 目录而不是 submodule 的工作目录中。 这样，攻击者就可以写入一个 hook 脚本，该脚本在克隆操作仍在运行时执行，从而实现远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule，并在该 submodule 中包含一个恶意的 `.gitmodules` 文件和一个 hook 脚本 (例如 `post-checkout`)。
2.  恶意 `.gitmodules` 文件包含指向攻击者控制的另一个仓库的 URL。这个仓库包含恶意的 hook 脚本。
3.  当受害者使用 `git clone --recursive` 命令克隆包含恶意 submodule 的仓库时，Git 会递归地克隆 submodule。
4.  在克隆 submodule 的过程中，由于漏洞，恶意 hook 脚本会被写入到受害者的 `.git/` 目录中，而不是 submodule 的工作目录中。
5.  当 Git 执行 hook 脚本时，攻击者就可以在受害者的系统上执行任意代码。

**有效性：**

根据漏洞描述、搜索结果（特别是vicarius.io的分析文章）和提供的 POC 代码，该漏洞是有效的。POC 代码展示了如何创建恶意仓库，触发漏洞并执行任意命令。

**投毒风险：**

该 POC 代码的目的是演示漏洞利用，但仍然存在一定的投毒风险，约为 10%。这种风险主要来自于以下几个方面：

1.  **反弹shell的IP和端口：** POC 代码中嵌入了反弹 shell 的 IP 地址和端口。攻击者可能会修改这些值，将 shell 反弹到他们控制的服务器上。
2.  **后门代码：** 攻击者可能会在 hook 脚本中添加额外的后门代码，以便在受害者系统上植入持久性的恶意软件。
3.  **依赖库：** 攻击者可能会修改 POC 代码，使其依赖于恶意的第三方库，这些库可能包含恶意代码。

尽管存在这些风险，但该 POC 代码的主要目的是演示漏洞利用，而不是进行恶意攻击。 用户在使用时仍然需要谨慎，确保对代码进行适当的审查和修改，以避免潜在的风险。

**项目地址:** [charlesgargasson/CVE-2024-32002](https://github.com/charlesgargasson/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #16

**来源**: [CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md](../2024/CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统必须使用大小写不敏感的文件系统且启用符号链接（或未禁用）。需要能够访问恶意Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002 漏洞允许攻击者通过构造包含恶意子模块的 Git 仓库，在目标系统上实现远程代码执行。漏洞原理是当Git在大小写不敏感的文件系统上递归克隆包含子模块的仓库时，攻击者可以利用大小写差异将文件写入 `.git/` 目录，从而覆盖或创建恶意 hook。当执行 `git clone --recursive` 命令时，恶意 hook 会被触发，导致任意代码执行。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。该子模块的路径经过特殊构造，利用大小写差异（例如 `A/modules/x` 和 `a/modules/x`）以及符号链接，指向子模块的 `.git/` 目录。
2.  **植入恶意Hook：** 在子模块的 `.git/hooks/` 目录下放置恶意的 Git hook 脚本（例如 `post-checkout`）。
3.  **诱导克隆：** 诱导受害者使用 `git clone --recursive` 命令克隆该恶意仓库。
4.  **触发执行：** 当受害者克隆仓库时，由于文件系统的大小写不敏感特性和符号链接，恶意 hook 会被写入 `.git/` 目录并被执行，导致远程代码执行。

**POC有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码有效。它演示了如何通过精心构造的 Git 仓库和子模块，利用 Git 的递归克隆功能在目标系统上执行任意代码。POC需要用户输入gitea服务器的ip地址、用户名和api token，然后创建两个仓库，并在其中一个仓库中添加恶意hook。另外, 需要手动修改 .gitmodules 文件，指向包含恶意hook的仓库。

**投毒风险评估：**

提供的POC代码主要用于演示漏洞的利用，旨在帮助安全研究人员理解和复现该漏洞。其中涉及的恶意代码（如在 hook 中执行 `calc.exe`）仅用于演示 RCE，并非旨在窃取或破坏用户数据，不构成直接的投毒行为。虽然该POC代码本身不包含投毒代码，但如果被恶意使用者利用，可能会被修改以植入更具破坏性的代码。 因此,投毒的风险概率为0%。

**缓解措施：**

1.  升级 Git 版本到已修复该漏洞的版本（>= 2.39.4, >= 2.40.2, >= 2.41.1, >= 2.42.2, >= 2.43.4, >= 2.44.1, >= 2.45.1）。
2.  禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
3.  避免克隆来自不受信任来源的 Git 仓库。


**项目地址:** [chrisWalker11/running-CVE-2024-32002-locally-for-tesing](https://github.com/chrisWalker11/running-CVE-2024-32002-locally-for-tesing)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #17

**来源**: [CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md](../2024/CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md)

## CVE-2024-32002

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并允许递归克隆包含恶意submodule的仓库。目标文件系统需要大小写不敏感且支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理机制中。攻击者可以构造包含恶意 submodule 的仓库，当受害者递归克隆该仓库时，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。这样，攻击者就可以在克隆过程中执行恶意 hook，从而实现远程代码执行。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞是一个远程代码执行漏洞，利用 submodules 中的缺陷，通过在`.git/`目录下写入恶意 hook 脚本，在 clone 过程中执行该脚本，从而实现 RCE。提供的POC代码尝试模拟此攻击，克隆恶意仓库，设置 git 配置以允许文件协议和符号链接，然后创建包含恶意payload的post-checkout hook，并将其推送到远端仓库，最后添加恶意的submodule。因此，提供的POC代码在满足漏洞利用条件的情况下是有效的。

**投毒风险分析：**
POC代码中存在潜在的投毒风险，作者可能通过恶意修改`shell.sh`，在受害者执行漏洞利用代码时执行意料之外的代码。例如，作者可能添加代码来窃取受害者的凭据、安装后门或进行其他恶意活动。但是从现有代码看，可能性较低。判断依据如下：

*   `rm -rf nothing` 和 `rm -rf toSeeHere` 看上去是无害的操作，但可能用于清理攻击痕迹，或者迷惑分析人员。
*   设置全局git配置，例如`git config --global protocol.file.allow always`，可能允许其他攻击向量。如果受害者在其他环境中使用了被更改的全局git配置，可能会带来安全风险。
*   `git clone http://<server ip>:<port>/<username>/repo1.git` 和 `git clone http://<server ip>:<port>/<username>/repo2.git` 依赖外部的git服务器。该服务器可能包含后门代码，或者在特定的IP/用户环境下，返回不同的内容，实现有选择的攻击。
*   `cat > y/hooks/post-checkout <<EOF
#!bin/sh.exe
#your payload goes here
EOF` 这部分是payload注入点, 攻击者可以伪装成漏洞利用代码，将恶意代码放在此处。

**利用方式分析：**
1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  在 submodule 中，攻击者创建一个 hook 脚本（例如 `post-checkout`），该脚本包含恶意代码。
3.  攻击者将 submodule 添加到主仓库中，并创建一个特殊的 `.git` 文件或符号链接，指向恶意 submodule 的 `.git` 目录。
4.  当受害者递归克隆包含恶意 submodule 的仓库时，Git 会尝试初始化 submodule。
5.  由于存在特殊的 `.git` 文件或符号链接，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。
6.  写入 `.git/` 目录中的 hook 脚本会被执行，从而实现远程代码执行。

**项目地址:** [daemon-reconfig/CVE-2024-32002](https://github.com/daemon-reconfig/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #18

**来源**: [CVE-2024-32002-grecosamuel_CVE-2024-32002.md](../2024/CVE-2024-32002-grecosamuel_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统安装受影响版本的Git，且允许clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个存在于 Git submodules 中的远程代码执行漏洞。当 Git 在大小写不敏感的文件系统上递归克隆存储库时，攻击者可以利用此漏洞。通过精心构造包含恶意 submodule 的 Git 仓库，攻击者可以欺骗 Git 将文件写入到 `.git/` 目录，而不是 submodule 的工作目录中。这使得攻击者可以写入一个 hook 文件，该 hook 文件在 clone 操作期间执行，从而实现远程代码执行。该漏洞的利用依赖于 `core.symlinks` 配置项是否启用。如果 `core.symlinks` 被禁用，攻击将无法成功。提供的 POC 代码通过创建一个包含恶意 post-checkout hook 的 submodule，然后将其包含在一个主仓库中。当受害者克隆主仓库时，post-checkout hook 会被执行，从而导致代码执行。考虑到此漏洞的利用方式，远程仓库本身就可能包含恶意代码，存在一定投毒的风险。

**漏洞利用方式:**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule。
2.  Submodule 包含一个恶意的 `post-checkout` hook，用于执行攻击者的 payload。
3.  攻击者诱使受害者克隆包含恶意 submodule 的仓库。
4.  在克隆过程中，Git 会递归克隆 submodule。
5.  由于漏洞，恶意的 `post-checkout` hook 被写入 `.git/` 目录并执行，导致 RCE。

**POC 代码分析和投毒风险评估:**
提供的POC代码主要功能是自动化漏洞利用流程, 简化了恶意仓库的创建过程。代码本身没有明显的投毒行为。 投毒风险主要来源于clone的远程仓库本身。POC中push到远程仓库步骤也有潜在的投毒风险，虽然可能性较低，但不能完全排除。

**有效性:**
根据搜索引擎结果，有多个来源证实了此漏洞的存在以及POC的有效性。

**项目地址:** [grecosamuel/CVE-2024-32002](https://github.com/grecosamuel/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #19

**来源**: [CVE-2024-32002-sanan2004_CVE-2024-32002.md](../2024/CVE-2024-32002-sanan2004_CVE-2024-32002.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统开启 symlinks 支持 (core.symlinks = true)，且攻击者能够控制一个包含恶意配置的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造的包含恶意子模块的 Git 仓库，在克隆仓库的用户的系统上执行任意代码。漏洞的根源在于 Git 在处理子模块时，可能将文件写入 `.git/` 目录而非子模块的工作目录。这使得攻击者可以放置一个 Git hook (例如 `post-checkout`) 在克隆操作期间执行。PoC 的利用方式是：

1.  **准备恶意仓库 (hulk.git):** 该仓库包含一个 `post-checkout` hook，hook 的内容是恶意payload（示例中是打开计算器）。这个hook会被放置在 `.git/hooks/` 目录下。
2.  **准备包含恶意子模块的仓库 (submod.git):** 该仓库将恶意仓库 (`hulk.git`) 添加为子模块，并创建一个指向 `.git` 目录的符号链接。关键的一步是使用`git update-index`命令来创建一个指向 `.git` 目录的符号链接。
3.  **准备最终的触发仓库 (smash.git):** 用户克隆该仓库时，由于递归克隆子模块，符号链接会被错误地解析，导致 `post-checkout` hook 被复制到 `.git/hooks/` 目录下，并在克隆过程的某个阶段执行，从而实现 RCE。

**有效性：** 提供的 PoC 代码是有效的，如果满足先决条件（易受攻击的 Git 版本和启用的符号链接），则可以成功触发 RCE。

**投毒风险：** PoC 本身的主要功能是演示漏洞，但由于代码的复杂性，存在细微的投毒风险。例如，`poc.sh` 脚本中可以被加入额外命令，在执行漏洞利用的同时，进行其他恶意操作，例如收集用户信息、安装后门程序等。此外，`hulk.git`仓库中可以存在除计算器之外的其他恶意payload。因此,投毒风险评估为10%。

**利用方式：** 攻击者需要控制一个 Git 仓库，并诱导受害者递归克隆该仓库。一旦受害者执行了 `git clone --recursive <恶意仓库>` 命令，恶意代码就会在其系统上执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用符号链接支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不受信任来源的仓库。

**项目地址:** [sanan2004/CVE-2024-32002](https://github.com/sanan2004/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #20

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-demo.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-demo.md)

## CVE-2024-32002-Git递归克隆远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许未经身份验证的攻击者在受害者机器上执行任意代码

**影响版本:** < 2.39.4, >= 2.40.0 < 2.40.2, = 2.41.0, >= 2.42.0 < 2.42.2, >= 2.43.0 < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标系统需要使用受影响版本的Git，且需要在大小写不敏感的文件系统（例如macOS的默认设置，Windows）上克隆包含恶意配置的仓库，同时`core.symlinks`配置未显式设置为`false`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造包含恶意子模块的 Git 仓库，利用 Git 在大小写不敏感的文件系统上的处理缺陷，将恶意 hook 写入 `.git/` 目录，从而在克隆仓库时执行任意代码。攻击者可以诱骗用户克隆恶意仓库，从而在用户不知情的情况下执行恶意代码。

**有效性分析：**

根据漏洞描述，提供的POC代码旨在演示如何利用此漏洞。通过`git clone --recursive`命令克隆该仓库，如果目标系统满足漏洞触发条件（受影响的Git版本，大小写不敏感的文件系统，未禁用符号链接），则可能触发漏洞，导致恶意代码执行。提供的POC利用方法符合漏洞描述，因此POC**可能有效**。

**投毒风险分析：**

提供的代码片段包括：

*   `/README.md`: 包含克隆仓库的说明。
*   `/docs/README.md`: 简单的文档说明。
*   `/src/example.py`: 一个简单的Python脚本，用于处理数据并打印结果。

初步分析表明，提供的代码本身并没有明显的恶意代码或后门。主要的风险在于该仓库可能包含隐藏的恶意 Git 配置（例如存在于.gitmodules或者.git/hooks中）或者子模块，当使用`git clone --recursive`时被自动执行。

由于无法直接看到.git目录下的文件，因此无法完全排除投毒风险。假设`git clone --recursive` 命令在满足条件下，自动触发恶意hook的可能性比较低，但是仍然存在。因此这里给出了5%的投毒可能性。

**利用方式：**

1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  恶意子模块包含一个 hook，该 hook 会在仓库被克隆时执行任意代码。
3.  攻击者诱骗受害者克隆该恶意仓库。
4.  当受害者使用 `git clone --recursive` 命令克隆仓库时，恶意 hook 被执行，从而导致远程代码执行。

要减轻此漏洞的影响，用户应避免克隆来自不受信任来源的仓库，并确保使用的 Git 版本已更新到修复此漏洞的版本。 此外，如果不需要符号链接，可以禁用符号链接支持，通过设置`git config --global core.symlinks false`来缓解风险。

**项目地址:** [srakkk/cve-2024-32002-demo](https://github.com/srakkk/cve-2024-32002-demo)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #21

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-hook.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-hook.md)

# CVE-2024-32002

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md](../2024/CVE-2024-32002-Basyaact_CVE-2024-32002-PoC_Chinese.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且允许递归克隆包含恶意submodule的仓库。利用需要case-insensitive文件系统，且默认开启了symlink(core.symlinks=true)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002是Git中一个严重的安全漏洞，它允许攻击者通过构造恶意的Git仓库，在目标系统上执行任意代码。攻击的核心在于利用了Git处理submodule时的不严谨性，特别是在大小写不敏感的文件系统上。

**漏洞利用方式：**

1.  **恶意仓库构造：** 攻击者创建一个包含submodule的Git仓库。该submodule的URL被精心构造，包含恶意payload。利用`ssh://-oProxyCommand=payload/`格式的URL，使得在submodule初始化时，`ProxyCommand`会被执行，从而达到远程命令执行的效果。
2.  **受害者克隆：** 受害者使用Git克隆该恶意仓库，并使用 `--recurse-submodules` 参数或者配置`git config --global submodule.recurse true`。递归克隆submodules.
3.  **触发漏洞：** 在克隆过程中，Git会尝试初始化submodule。由于submodule的URL包含恶意payload，Git会执行`ProxyCommand`指定的命令，从而在受害者系统上执行攻击者预设的恶意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是[webpage 4 begin]到[webpage 6 begin]）和提供的漏洞利用代码，可以确认该漏洞是有效的。多个来源都提供了关于此漏洞的分析、利用方式和缓解措施。POC代码利用Metasploit框架模拟了恶意Git服务器，展示了如何通过构造恶意的submodule URL来执行任意命令。

**投毒风险：**

提供的Metasploit模块本身用于漏洞利用演示，主要功能是搭建一个包含恶意submodule配置的Git仓库。该模块将payload插入到`.gitmodules`文件中，并通过`ProxyCommand`执行。

虽然没有明显的“投毒”代码，但依然存在以下风险：

*   **payload隐蔽性：**攻击者可能在payload中嵌入看似无害但实则具有恶意行为的代码，例如下载执行其他恶意程序、窃取敏感信息等。这种payload可以通过混淆、加密等技术来逃避检测，因此存在一定的投毒风险。

综合评估，投毒风险较低，大约为5%。主要风险在于Payload部分可能包含恶意指令。


**项目地址:** [Basyaact/CVE-2024-32002-PoC_Chinese](https://github.com/Basyaact/CVE-2024-32002-PoC_Chinese)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #2

**来源**: [CVE-2024-32002-FlojBoj_CVE-2024-32002.md](../2024/CVE-2024-32002-FlojBoj_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** v2.45.0, v2.44.0, <=v2.43.3, <=v2.42.1, v2.41.0, <=v2.40.1, <=v2.39.3

**利用条件:** 目标系统需要安装存在漏洞的Git版本，并且文件系统大小写不敏感且支持符号链接(或配置`core.symlinks=true`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块功能中。攻击者可以构造包含恶意子模块的仓库，利用 Git 在处理子模块时可能将文件写入 `.git/` 目录而不是子模块工作目录的漏洞。通过精心构造的子模块，攻击者可以在目标机器上执行任意代码。利用过程如下：

1.  **恶意仓库准备：** 攻击者创建两个仓库 rep1 和 rep2。
2.  **rep1 (恶意子模块)：** 在 rep1 中，创建一个 `executable/hooks/post-checkout` 文件，该文件包含要执行的恶意代码（例如，启动计算器应用）。使用`git update-index --chmod=+x executable/hooks/post-checkout`命令赋予该文件执行权限，并推送到 rep1 仓库。
3.  **rep2 (主仓库)：** 在 rep2 中，将 rep1 作为子模块添加到 `A/modules/exploit` 路径下。
4.  **漏洞触发：**  关键在于创建 `dotgit.txt` 文件，内容为 `.git`，计算其哈希值，然后构造 `index.info` 文件，该文件将 `A/modules/exploit/.git` 设置为符号链接指向计算出的哈希对象，以此欺骗 Git。
5.  **克隆触发：** 当受害者使用 `git clone --recursive $REP2` 命令克隆 rep2 仓库时，Git 会尝试递归克隆子模块 rep1。
6.  **代码执行：** 由于 rep2 中 `A/modules/exploit/.git` 被伪造成符号链接，Git 在处理子模块时会将 rep1 中的 `executable/hooks/post-checkout` 文件错误地写入 `.git/hooks` 目录，从而使其成为一个 Git 钩子。`post-checkout` 钩子会在 `git clone` 操作完成后自动执行，从而触发恶意代码。

**投毒风险分析：**

  此POC本身旨在利用漏洞，但其中存在潜在的投毒风险。例如，`exploit.sh` 中定义的 `exploit` 变量决定了执行的恶意代码。虽然当前 POC 中是启动计算器，但攻击者完全可以替换为更具危害性的命令，例如下载并执行恶意脚本。虽然代码中声明“USE ONLY FOR EDUCATIONAL PURPOSES!”，但仍需谨慎使用。

**有效性分析：**

 根据漏洞描述和搜索结果，该 POC 有效。提供的 POC 代码展示了如何利用此漏洞在目标机器上执行任意代码。

**风险缓解：**

*   升级 Git 到修复后的版本。
*   避免克隆来自不受信任来源的仓库。
*   禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
*   对克隆的仓库进行安全审查。

**项目地址:** [FlojBoj/CVE-2024-32002](https://github.com/FlojBoj/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #3

**来源**: [CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md](../2024/CVE-2024-32002-JoaoLeonello_cve-2024-32002-poc.md)

## CVE-2024-32002 - Git Submodule Remote Code Execution

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行，完全控制受影响系统

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 需要目标系统使用受影响的 Git 版本，且支持符号链接。利用依赖于递归克隆包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个严重的远程代码执行漏洞，它允许攻击者通过恶意构造包含子模块的 Git 仓库来执行任意代码。漏洞的核心在于 Git 在处理子模块路径时存在缺陷，攻击者可以利用此缺陷将恶意文件写入 `.git/` 目录，从而劫持 Git 的行为。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。关键在于构造一个恶意的 `.gitmodules` 文件。此文件中定义的子模块路径会被操纵，指向 `.git/` 目录内的某个位置。
2.  **符号链接欺骗：** 攻击者会创建一个符号链接，将仓库中的某个目录链接到 `.git/` 目录。例如，创建一个名为 `A` 的目录的符号链接，使其指向 `.git/`。
3.  **路径注入：** 通过组合恶意 `.gitmodules` 文件和符号链接，攻击者可以欺骗 Git 将子模块的内容写入 `.git/modules/` 目录。这允许攻击者注入恶意 hook 脚本。
4.  **触发执行：** 当受害者递归克隆（`git clone --recursive`）恶意仓库时，Git 将初始化子模块，并将恶意 hook 脚本复制到 `.git/hooks/` 目录。然后，当受害者执行诸如 `git checkout` 之类的 Git 操作时，这些恶意 hook 脚本会被触发执行，从而导致远程代码执行。

**POC 分析：**

提供的 POC 代码通过 Dockerfile 构建了一个包含漏洞 Git 版本的环境，并使用 `setup.sh` 脚本自动化了漏洞利用过程。该脚本创建了一个包含恶意 `post-checkout` hook 的子模块，修改 `.gitmodules` 文件，创建必要的符号链接，并将恶意 hook 注入到受害者的 `.git/hooks/` 目录中。当执行 `git checkout HEAD` 时，hook 脚本会被触发，在 `/tmp/teste.txt` 中写入 "joao was here"，从而验证了漏洞的存在。

**投毒风险分析：**

虽然 POC 代码的主要目的是演示漏洞，但仍然存在潜在的投毒风险。`setup.sh` 脚本包含以下可疑行为：

*   向 `/etc/sudoers` 文件添加用户，允许用户无密码执行 sudo 命令。虽然这可能是为了方便演示，但在实际环境中会带来安全风险。

考虑到这些因素，我将投毒风险评估为 10%。

**项目地址:** [JoaoLeonello/cve-2024-32002-poc](https://github.com/JoaoLeonello/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #4

**来源**: [CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md](../2024/CVE-2024-32002-Julian-gmz_hook_CVE-2024-32002.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致完全控制受害者机器

**影响版本:** 受影响版本包括 2.39.4 之前的所有版本，以及 2.40.0 到 2.40.2，2.41.0，2.42.0 到 2.42.2，2.43.0 到 2.43.4，2.44.0 和 2.45.0。

**利用条件:** 受害者需要使用受影响的Git版本克隆恶意构造的包含submodule的仓库，并且需要在大小写不敏感的文件系统上克隆。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理中。恶意攻击者可以构造包含恶意 submodule 的 Git 仓库，当受害者使用 `git clone --recurse-submodules` 命令克隆该仓库时，Git 会被诱导将文件写入 `.git/` 目录而不是 submodule 的工作目录。攻击者可以在 `.git/hooks` 目录下写入恶意 hook 脚本，这些脚本会在克隆操作期间执行，从而实现远程代码执行。攻击成功的关键在于利用了大小写不敏感文件系统的特性，使得恶意文件能够覆盖 `.git/` 目录下的合法文件。

**有效性评估：** 根据漏洞库信息和搜索结果（特别是 webpage 5），该漏洞的PoC是可用的，并且描述了利用方式。

**投毒风险评估：** 提供的 PoC 代码 `post-checkout` 脚本主要执行以下操作：

*   显示一段消息。
*   打开计算器程序 (`calc.exe`)，这是一个常见的 PoC 行为。
*   打开 Edge 浏览器并播放 YouTube 视频，同样是 PoC 行为，表明代码执行。
*   在用户 Home 目录下的每个目录中创建一个名为 `trace.txt` 的文件，写入一段消息。

虽然 PoC 代码本身没有明显的恶意行为，但创建 `trace.txt` 文件的操作可能被滥用。如果攻击者精心构造 `trace.txt` 的内容，例如包含恶意脚本或者利用其他漏洞的 payload，可能会造成进一步的危害。因此，存在一定的投毒风险，但风险相对较低，因为其行为是比较明显的。所以判定投毒概率为20%。

**利用方式：**

1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  恶意 submodule 中包含一个精心构造的 `.git/hooks/post-checkout` 脚本，该脚本包含攻击 payload。
3.  攻击者诱导受害者使用 `git clone --recurse-submodules` 命令克隆该仓库。
4.  当 Git 处理 submodule 时，会将恶意 `post-checkout` 脚本写入受害者机器的 `.git/hooks` 目录下。
5.  Git 在克隆完成后会自动执行 `post-checkout` 脚本，从而执行攻击 payload，实现远程代码执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)，但这可能会影响正常的 Git 使用。
*   避免克隆来自不受信任来源的仓库。


**项目地址:** [Julian-gmz/hook_CVE-2024-32002](https://github.com/Julian-gmz/hook_CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #5

**来源**: [CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md](../2024/CVE-2024-32002-Masamuneee_CVE-2024-32002-POC.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需要使用受影响的Git版本，并且文件系统区分大小写，支持符号链接，用户需要克隆恶意仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以创建一个恶意仓库，其中包含特殊的子模块配置，使得在克隆仓库时，Git 将文件写入 `.git/` 目录而非子模块的工作目录。这允许攻击者放置一个恶意 hook 脚本到 `.git/hooks` 目录，该脚本会在克隆过程执行时被触发，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意子模块配置的Git仓库。
2.  该恶意配置指向一个包含 hook 脚本的子模块。
3.  受害者使用 `git clone --recursive` 命令克隆该仓库。
4.  Git 在处理子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
5.  克隆过程执行到一定阶段时，恶意 hook 脚本被触发，执行攻击者指定的任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞真实存在，并且有公开的PoC（例如vsociety提供的PoC）。提供的PoC代码`git clone --recursive "git@github.com:masamuneee/CVE-2024-32002-POC.git"` 可以触发漏洞。

**投毒风险：**

提供的 PoC 代码仅仅是一个 README 文件，用于演示漏洞利用的克隆命令。但是， `masamuneee/CVE-2024-32002-POC.git` 仓库本身可能包含恶意 payload（例如 hook 脚本）。虽然目前的PoC只是一个说明文件，不构成直接威胁，但是如果用户真的去克隆`git@github.com:masamuneee/CVE-2024-32002-POC.git`这个仓库,存在被投毒的风险。即使作者本意是提供PoC，也可能被其他人修改后上传带有恶意代码的版本。 因此，投毒风险评估为10%，主要源于克隆远程仓库的潜在风险，以及对作者上传的poc完整性的怀疑，毕竟用户克隆的是远程仓库，本地进行验证。

**参考链接：**

*   [https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv](https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv)
*   [https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)
*   [https://www.wiz.io/vulnerability-database/cve/cve-2024-32002](https://www.wiz.io/vulnerability-database/cve/cve-2024-32002)

**项目地址:** [Masamuneee/CVE-2024-32002-POC](https://github.com/Masamuneee/CVE-2024-32002-POC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #6

**来源**: [CVE-2024-32002-Masamuneee_hook.md](../2024/CVE-2024-32002-Masamuneee_hook.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：2.45.0, 2.44.0, >= 2.43.0 < 2.43.4, >= 2.42.0 < 2.42.2, 2.41.0, >= 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统安装Git，并且clone包含恶意submodule的仓库，利用依赖于对大小写不敏感的文件系统，并启用符号链接。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-32002是Git中存在的一个远程代码执行漏洞，它允许攻击者通过精心构造包含恶意submodule的Git仓库，诱导受害者clone该仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式：**
1.  攻击者创建一个包含submodule的恶意Git仓库。
2.  该submodule包含一个恶意的`.git/hooks/post-checkout` hook。
3.  利用了Git在处理submodule时，可能将文件写入`.git/`目录而不是submodule的工作目录的缺陷。
4.  当受害者在对大小写不敏感的文件系统上，且启用符号链接的情况下，clone这个仓库并检出（checkout）或者更新 submodule时，恶意hook会被执行，导致远程代码执行。

**有效性：**
提供的POC代码是有效的，因为它展示了如何创建一个包含恶意`post-checkout` hook的submodule，并在clone时触发该hook，从而执行任意命令。其中`/tmp/hacked`用于linux环境下的测试，powershell命令用于windows环境下的测试。

**投毒风险：**
虽然提供的POC代码本身是用于验证漏洞的，但如果攻击者在真实的恶意仓库中，除了POC代码之外还包含其他隐藏的恶意代码，则存在投毒风险。当前提供的POC代码中，`/tmp/e81041e852bc4e53c491bef3aef35e69/README.md` 文件和 `/tmp/e81041e852bc4e53c491bef3aef35e69/fast/hooks/post-checkout` 都可能被写入隐藏的恶意代码。假设作者有意隐藏投毒代码，可能性为20%。

**缓解措施：**
1.  升级Git到已修复的版本（>= 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, 2.39.4）。
2.  避免clone来自不受信任来源的仓库。
3.  禁用Git的符号链接支持（`git config --global core.symlinks false`）。
4.  在clone仓库后，仔细检查submodule的内容，特别是`.git/hooks`目录下的文件。

**项目地址:** [Masamuneee/hook](https://github.com/Masamuneee/hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #7

**来源**: [CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-NishanthAnand21_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 2.39.4之前，以及2.40.0到2.40.2，2.41.0，2.42.0到2.42.2，2.43.0到2.43.4，2.44.0和2.45.0版本

**利用条件:** 需要目标系统启用符号链接支持，并且从恶意Git仓库克隆包含恶意submodule的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中一个远程代码执行 (RCE) 漏洞。该漏洞源于 Git 处理 submodules 的方式存在缺陷，攻击者可以构造恶意的 Git 仓库，其中包含一个精心设计的 submodule，该 submodule 利用了 Git 的漏洞，可以将文件写入 `.git/` 目录而不是 submodule 的工作目录。这允许攻击者在克隆操作期间执行恶意 hook，从而在受害者机器上执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，该漏洞的PoC是有效的。搜索结果中的 [webpage 6] 提到了一个演示如何利用该漏洞的PoC。
提供的PoC代码首先配置 Git 允许 file 协议和启用符号链接。然后，它创建一个包含恶意 post-checkout hook 的仓库 repo1。此 hook 包含一个 Payload，将在克隆 repo1 后执行。接下来，它创建一个包含 submodule 的仓库 repo2，该 submodule 指向 repo1。关键步骤是创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。最后，克隆 repo2 会触发恶意 hook，导致执行 Payload。

**投毒风险：**

该PoC本身就包含恶意代码(`<Payload>`)，用于在受害者机器上执行命令。投毒风险的评估旨在判断作者是否在PoC代码之外，还隐藏了其他的恶意代码或逻辑，用于进一步攻击或控制受害者系统。代码中可能存在潜在的投毒风险，但根据现有代码，没有找到明确的投毒代码。考虑到README中作者的个人站点链接，存在一定的概率通过其他方式植入后门，因此投毒风险预估为10%。

**利用方式：**

1.  **攻击者创建一个恶意 Git 仓库（例如 repo1），其中包含一个恶意 hook。** hook 的作用是在克隆仓库后执行 Payload。
2.  **攻击者创建一个包含 submodule 的 Git 仓库（例如 repo2），该 submodule 指向恶意仓库 repo1。**
3.  **攻击者创建一个指向 `.git` 目录的符号链接，并将其添加到 repo2。** 这一步是漏洞利用的关键，它欺骗 Git 将文件写入 `.git/` 目录。
4.  **受害者克隆仓库 repo2。** 在克隆过程中，Git 会尝试更新 submodule，由于存在符号链接，恶意 hook 将被写入 `.git/` 目录并执行，从而在受害者机器上执行 Payload。

该漏洞利用的先决条件是目标系统必须启用符号链接支持。如果 `core.symlinks` 设置为 `false`，则该漏洞无法利用。


**项目地址:** [NishanthAnand21/CVE-2024-32002-PoC](https://github.com/NishanthAnand21/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #8

**来源**: [CVE-2024-32002-SpycioKon_CVE-2024-32002.md](../2024/CVE-2024-32002-SpycioKon_CVE-2024-32002.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要存在受影响版本的Git，并且允许递归克隆包含恶意submodule的仓库，文件系统对大小写不敏感，支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个 Git 中的远程代码执行 (RCE) 漏洞，它允许攻击者通过精心制作的包含恶意 submodule 的 Git 仓库来执行任意代码。该漏洞的利用方式如下：

1.  **创建恶意仓库 (repo1)：** 攻击者创建一个包含恶意 hook 的 Git 仓库 (repo1)。在该 POC 代码中，`exp` 脚本首先克隆一个名为 `repo1` 的仓库，然后在 `y/hooks/post-checkout` 路径下创建一个恶意的 `post-checkout` hook。该 hook 包含经过 base64 编码的 PowerShell 代码，这段代码会尝试建立一个反向 shell 连接到攻击者的机器 (10.10.15.68:9999)。注意，`git config --global core.symlinks true` 启用了符号链接支持，这是利用此漏洞的关键。

2.  **创建包含恶意 submodule 的仓库 (repo2)：** 攻击者创建第二个仓库 (repo2)，并将第一个仓库 (repo1) 作为 submodule 添加进去。  POC代码执行了`git submodule add --name x/y "http://10.10.11.26:3000/admin123/repo1.git" A/modules/x`，将`repo1` 添加为 `repo2` 的子模块。然后，它创建一个名为 `dotgit.txt` 的文件，内容为 `.git`。接着，它计算该文件的哈希值，并利用该哈希值创建一个 `index.info` 文件，该文件用于创建一个指向 `.git` 目录的符号链接。

3.  **利用符号链接欺骗 Git：** 攻击者创建一个指向 `.git` 目录的符号链接。 当受害者递归克隆包含恶意 submodule 的仓库时，Git 会错误地将 hook 写入 `.git/` 目录，而不是 submodule 的工作目录。由于 `.git/` 目录下的 hook 会在克隆操作期间执行，因此攻击者可以在受害者的系统上执行任意代码。

4.  **克隆触发漏洞：** 受害者使用 `git clone --recursive repo2` 命令克隆包含恶意 submodule 的仓库 (repo2)。 当 Git 初始化 submodule 时，它会执行 `.git/` 目录中的 hook，从而触发攻击者预先植入的恶意代码。

**有效性：**根据搜索结果和漏洞描述，提供的 POC 代码是有效的，可以用来复现和验证 CVE-2024-32002 漏洞。搜索结果中多篇文章提到了利用 submodules 和符号链接将文件写入 `.git/` 目录，并执行恶意 hook。

**投毒风险：** POC 中存在一定的投毒风险。虽然主要目的是演示漏洞利用，但攻击者可能在 `post-checkout` hook 中植入额外的恶意代码，例如收集受害者系统信息、安装后门等。由于该POC主要目的是复现漏洞，其核心代码部分是漏洞利用所需的，因此判定投毒风险为10%。

**漏洞利用方式总结：**

*   攻击者创建一个包含恶意 hook 的 Git 仓库。
*   攻击者创建一个包含恶意 submodule（指向第一个仓库）的 Git 仓库。
*   攻击者在第二个仓库中创建一个指向 `.git` 目录的符号链接。
*   受害者递归克隆第二个仓库。
*   Git 错误地将 hook 写入 `.git/` 目录。
*   克隆操作期间，hook 被执行，导致 RCE。

**项目地址:** [SpycioKon/CVE-2024-32002](https://github.com/SpycioKon/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #9

**来源**: [CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md](../2024/CVE-2024-32002-TSY244_CVE-2024-32002-git-rce-father-poc.md)

## CVE-2024-32002-Git-远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标服务器需要安装受影响的Git版本，且文件系统区分大小写并支持符号链接，需要克隆包含恶意子模块的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以构造恶意的 Git 仓库，其中包含一个带有恶意配置的子模块。当用户递归克隆这个仓库时，Git 会将恶意文件写入 `.git/` 目录，而不是子模块的工作目录，导致可以执行恶意的 hook 脚本，实现远程代码执行。

**有效性：**
提供的 POC 代码是一个 `post-checkout` hook 脚本，它会在 `git checkout` 操作后执行。脚本的内容是将 "amal_was_here" 写入 `/tmp/pwnd` 文件，并且打开计算器程序。如果目标系统成功执行了这个脚本，就可以证明该漏洞的有效性。

**投毒风险：**
POC 代码本身不包含明显的投毒行为，它只是一个简单的示例，用于验证漏洞的存在。但是，考虑到漏洞利用方式，攻击者可以修改 hook 脚本，使其包含更具破坏性的恶意代码。例如，可以执行系统命令、窃取敏感信息或者植入后门。因此，从远程仓库克隆代码时，始终存在一定的风险。
投毒风险评估为 10%，因为这个示例代码更像是概念验证，而非恶意利用，但实际攻击中，攻击者完全可以将hook脚本编写为恶意的脚本。

**利用方式：**
1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  子模块的 `.gitmodules` 文件中包含指向恶意仓库的 URL。
3.  恶意仓库的 `hooks/post-checkout` 目录包含攻击者想要执行的恶意脚本。
4.  受害者递归克隆包含恶意子模块的 Git 仓库（例如，使用 `git clone --recurse-submodules` 命令）。
5.  Git 在克隆子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
6.  当执行 `git checkout` 操作时，恶意 hook 脚本被执行，导致远程代码执行。

**项目地址:** [TSY244/CVE-2024-32002-git-rce-father-poc](https://github.com/TSY244/CVE-2024-32002-git-rce-father-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #10

**来源**: [CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md](../2024/CVE-2024-32002-XiaomingX_cve-2024-32002-poc.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 < version < 2.40.2, 2.41.0, 2.42.0 < version < 2.42.2, 2.43.0 < version < 2.43.4, 2.44.0, 2.45.0, <= 2.45.0

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统区分大小写并支持符号链接，攻击者可控的Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002是一个Git中的远程代码执行漏洞，该漏洞源于Git处理包含子模块的仓库时存在缺陷。攻击者可以构造恶意仓库，利用子模块机制，将恶意文件写入`.git/`目录而不是子模块的工作目录。由于`.git/`目录下的文件可能包含Git钩子(hooks)，这些钩子会在特定的Git操作期间被执行，从而导致任意代码执行。如果目标系统禁用了符号链接（`core.symlinks = false`），则该漏洞无法利用。从搜索结果和漏洞描述来看，多个安全厂商和社区已经公开了漏洞分析和利用方法，证明了该漏洞的有效性。提供的漏洞利用代码是Apache License 2.0的许可协议，并非实际的PoC代码，因此无法直接评估投毒风险。但根据漏洞原理，攻击者需要在恶意仓库中植入恶意的子模块和钩子脚本，才能实现远程代码执行。由于提供的代码是许可证文件，所以投毒风险判定为0%。漏洞利用方式：1. 构造包含恶意子模块的Git仓库。2. 在恶意子模块中包含恶意的Git钩子（例如 pre-commit, post-receive等）。3. 诱导受害者克隆该恶意仓库并递归初始化子模块。4. 当Git执行相关操作时，恶意的钩子脚本被触发，导致远程代码执行。

**项目地址:** [XiaomingX/cve-2024-32002-poc](https://github.com/XiaomingX/cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #11

**来源**: [CVE-2024-32002-ashutosh0408_CVE-2024-32002.md](../2024/CVE-2024-32002-ashutosh0408_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需使用受影响的Git版本，且文件系统为大小写不敏感（如Windows或macOS），并允许符号链接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 是 Git 中一个允许远程代码执行的漏洞，它与子模块有关。恶意仓库可以精心构造，利用大小写不敏感文件系统上的符号链接处理缺陷，将文件写入 `.git/` 目录，进而执行恶意 hooks。

**有效性：**

根据漏洞描述和PoC代码，此PoC代码有效。多个搜索结果（如webpage 6和 webpage 7）表明存在针对此漏洞的利用，并且提供了利用成功的案例。PoC代码的 `README.md` 文件也提供了在Windows和Mac上的成功执行截图。 PoC 明确指出只能在 Windows 或 Mac 系统上工作, 这与漏洞描述中依赖大小写不敏感的文件系统相符。

**投毒风险：**

PoC代码主要由以下几个部分组成：

1.  `create_poc.sh`：用于创建利用此漏洞的恶意Git仓库。
2.  `hook/y/hooks/post-checkout` 和 `post-checkout`：这些文件包含了实际的恶意代码，也就是将在目标机器上执行的代码。这段代码会创建一个文件 `/tmp/pwnd`，并尝试运行 `calc.exe` （Windows）或 `open -a Calculator.app` （Mac）。
3.  `README.md`：提供漏洞描述和利用方法。

分析 `create_poc.sh` 脚本，其中包含一些git配置，创建一个恶意hook，并添加到git仓库中。该脚本的主要目的是自动化生成一个可被利用的恶意仓库，其本身并不包含任何隐藏的、与PoC目的无关的代码。

恶意代码部分，也就是`hook/y/hooks/post-checkout` 和 `post-checkout`脚本，其功能是创建文件和打开计算器程序。 虽然这些操作本身是无害的，但是攻击者可以替换成任何其他恶意代码，例如植入后门程序、窃取敏感数据等。

因此，判断此仓库中存在作者隐藏的投毒代码的风险较低。PoC本身包含的恶意代码是为了验证漏洞，并非隐藏的恶意功能。风险主要在于用户如果直接使用此PoC，没有意识到其潜在的危害，则可能导致安全问题。由于是公开的 PoC，其目的是演示漏洞利用，因此作者故意隐藏恶意代码的可能性较低，风险评估为5%。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个包含特殊构造路径的子模块。
2.  子模块路径使用大小写变体，以利用大小写不敏感的文件系统。
3.  子模块包含一个指向其 `.git/` 目录的符号链接，该目录包含一个恶意 hook（例如 `post-checkout`）。
4.  当用户克隆恶意仓库时，`git clone --recursive` 命令会递归初始化和更新子模块。
5.  在大小写不敏感的文件系统上，Git 会跟随符号链接，并将恶意 hook 写入 `.git/` 目录。
6.  当执行 `git checkout` 等操作时，恶意 hook 会被执行，从而导致远程代码执行。

利用成功的关键点在于大小写不敏感的文件系统和符号链接的使用，以及 Git 在处理子模块时的缺陷。


**项目地址:** [ashutosh0408/CVE-2024-32002](https://github.com/ashutosh0408/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #12

**来源**: [CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md](../2024/CVE-2024-32002-ashutosh0408_Cve-2024-32002-poc.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并且开启了submodule功能，文件系统区分大小写，允许创建符号链接，受害者clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞，利用方式主要通过精心构造包含恶意submodule的 Git 仓库。攻击者可以利用此漏洞，通过诱导受害者递归克隆包含恶意配置的仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式:**

1.  **创建恶意仓库：** 攻击者创建包含恶意submodule配置的Git仓库，该仓库中的submodule指向一个包含恶意hook的仓库。
2.  **恶意Hook：**  攻击者在submodule的仓库中，设置post-checkout hook，该hook会在`git clone --recursive`命令执行时被触发，从而执行攻击者预设的恶意代码。POC代码中，恶意代码为打开计算器应用。
3.  **符号链接操纵：**  利用Git对submodule处理的缺陷，通过创建指向`.git`目录的符号链接，使得恶意hook被放置在`.git/hooks`目录下，从而绕过安全检查。
4.  **诱导克隆：**  攻击者诱导受害者克隆包含恶意submodule的仓库，使用`git clone --recursive`命令。
5.  **触发RCE：**  当受害者执行`git clone --recursive`命令时，恶意hook被触发，执行攻击者预设的恶意代码，实现远程代码执行。

**POC有效性评估:**

根据提供的漏洞信息和利用代码，该POC代码是有效的。它成功演示了如何利用Git submodule的漏洞，通过创建恶意仓库和hook，在受害者机器上执行任意代码。多个搜索结果，例如webpage 6的[Exploiting git RCE: CVE-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)，也验证了该漏洞的可利用性。

**投毒风险分析:**

尽管提供的代码主要用于演示漏洞利用，但仍然存在一定的投毒风险。风险主要来自以下几个方面：

1.  **Payload替换：**  POC中使用打开计算器作为示例payload，攻击者可以轻易地替换成其他更具危害性的恶意代码，例如植入后门、窃取敏感信息等。
2.  **依赖风险：**  POC脚本依赖于特定的git命令和文件系统操作。如果攻击者修改了脚本，添加了额外的依赖或操作，可能会导致受害者系统出现未知问题。
3.  **远程仓库风险：**  虽然POC中指定了特定的远程仓库，但攻击者可能会修改脚本，指向其他包含更隐蔽或更具危害性的恶意代码的仓库。

评估结果为10%,原因在于当前代码中仅仅提供PoC思路,不存在额外恶意操作。

**项目地址:** [ashutosh0408/Cve-2024-32002-poc](https://github.com/ashutosh0408/Cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #13

**来源**: [CVE-2024-32002-blackninja23_CVE-2024-32002.md](../2024/CVE-2024-32002-blackninja23_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要在大小写不敏感的文件系统（例如Windows或macOS）上进行克隆，并且core.symlinks=true（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在递归克隆包含恶意子模块的存储库时，由于大小写不敏感的文件系统上的符号链接处理不当，导致可以将文件写入 `.git/` 目录而不是子模块的工作目录中。 这允许写入一个钩子，该钩子将在克隆操作仍在运行时执行，使用户没有机会检查正在执行的代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用的有效性较高。PoC 代码明确展示了如何利用该漏洞在 Windows 和 macOS 系统上实现 RCE。

**投毒风险：**
该存储库存在一定的投毒风险。虽然提供的 PoC 代码看似直接，目的是展示漏洞利用，但`create_poc.sh`脚本如果被修改，则有可能植入恶意代码，导致使用者在不知情的情况下执行攻击者的恶意操作。脚本中包含的 URL `https://github.com/blackninja23/hook.git`，如果被替换成恶意仓库，存在被投毒的风险。但代码本身功能比较直白，没有过于复杂的逻辑，因此投毒风险较低，预估为10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个子模块。
2.  该子模块的路径被精心构造，利用大小写变体（例如 `A/modules/x` vs `a/modules/x`）来欺骗大小写不敏感的文件系统。
3.  该子模块包含一个符号链接，指向仓库的 `.git/` 目录。
4.  `.git/` 目录中包含一个恶意 Git 钩子（例如 `post-checkout`）。
5.  当受害者使用 `git clone --recursive` 克隆恶意仓库时，Git 会尝试递归地克隆子模块。
6.  由于大小写不敏感的文件系统，Git 可能会错误地解析子模块的路径，导致符号链接被解析到 `.git/` 目录中。
7.  恶意 Git 钩子会被执行，从而导致远程代码执行。

**项目地址:** [blackninja23/CVE-2024-32002](https://github.com/blackninja23/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #14

**来源**: [CVE-2024-32002-bonnettheo_CVE-2024-32002.md](../2024/CVE-2024-32002-bonnettheo_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 目标系统需要启用submodule和符号链接支持，且攻击者需要诱使用户克隆恶意构造的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 存在于 Git 中，允许攻击者通过恶意构造包含子模块的仓库，利用 Git 在不安全的上下文中写入文件的漏洞来执行任意代码。此漏洞利用了 Git 在处理子模块时的路径遍历缺陷，攻击者可以欺骗 Git 将恶意 hook 写入 `.git/` 目录而不是子模块的工作树中。当克隆操作仍在进行时，这些 hook 将被执行，使用户没有机会检查正在执行的代码。该漏洞主要影响启用了子模块和符号链接支持的系统。修复方法是升级到 Git 的安全版本(>=2.45.1, >=2.44.1, >=2.43.4, >=2.42.2, >=2.41.1, >=2.40.2, >=2.39.4) 或禁用符号链接支持(git config --global core.symlinks false)。

根据搜索引擎结果，该漏洞已得到广泛关注，并有公开的利用代码和分析文章。POC代码有效性高，能够实现远程代码执行。

该仓库的投毒风险较低，主要基于以下几点判断：

*   **代码来源：** POC代码引用了另一个开源项目，并提供了原始作者的博客链接，提高了透明度。
*   **免责声明：** 仓库包含明确的免责声明，强调仅用于教育和信息目的，禁止在未经授权的系统上运行。
*   **文件内容：** 仓库中主要包含漏洞说明和利用代码链接，没有发现额外的可疑文件或代码片段。
*   **作者信誉：** 缺乏对该仓库作者的信誉信息，无法进行有效判断。

由于缺乏直接的代码分析和作者信誉信息，无法完全排除投毒风险，但是考虑到以上的几点，判定投毒的可能性较低。建议在运行POC代码时，务必进行代码审计和安全评估，以避免潜在的风险。

**项目地址:** [bonnettheo/CVE-2024-32002](https://github.com/bonnettheo/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #15

**来源**: [CVE-2024-32002-charlesgargasson_CVE-2024-32002.md](../2024/CVE-2024-32002-charlesgargasson_CVE-2024-32002.md)

## CVE-2024-32002-Git-RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.39.4之前, 2.40.0 ~ 2.40.2, 2.41.0, 2.42.0 ~ 2.42.2, 2.43.0 ~ 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标Git版本受影响，且启用了submodule和符号链接，在大小写不敏感的文件系统上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞。该漏洞源于 Git 在处理包含 submodule 的仓库时，允许攻击者通过构造恶意的仓库，将文件写入 `.git/` 目录而不是 submodule 的工作目录中。 这样，攻击者就可以写入一个 hook 脚本，该脚本在克隆操作仍在运行时执行，从而实现远程代码执行。

**利用方式：**

1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule，并在该 submodule 中包含一个恶意的 `.gitmodules` 文件和一个 hook 脚本 (例如 `post-checkout`)。
2.  恶意 `.gitmodules` 文件包含指向攻击者控制的另一个仓库的 URL。这个仓库包含恶意的 hook 脚本。
3.  当受害者使用 `git clone --recursive` 命令克隆包含恶意 submodule 的仓库时，Git 会递归地克隆 submodule。
4.  在克隆 submodule 的过程中，由于漏洞，恶意 hook 脚本会被写入到受害者的 `.git/` 目录中，而不是 submodule 的工作目录中。
5.  当 Git 执行 hook 脚本时，攻击者就可以在受害者的系统上执行任意代码。

**有效性：**

根据漏洞描述、搜索结果（特别是vicarius.io的分析文章）和提供的 POC 代码，该漏洞是有效的。POC 代码展示了如何创建恶意仓库，触发漏洞并执行任意命令。

**投毒风险：**

该 POC 代码的目的是演示漏洞利用，但仍然存在一定的投毒风险，约为 10%。这种风险主要来自于以下几个方面：

1.  **反弹shell的IP和端口：** POC 代码中嵌入了反弹 shell 的 IP 地址和端口。攻击者可能会修改这些值，将 shell 反弹到他们控制的服务器上。
2.  **后门代码：** 攻击者可能会在 hook 脚本中添加额外的后门代码，以便在受害者系统上植入持久性的恶意软件。
3.  **依赖库：** 攻击者可能会修改 POC 代码，使其依赖于恶意的第三方库，这些库可能包含恶意代码。

尽管存在这些风险，但该 POC 代码的主要目的是演示漏洞利用，而不是进行恶意攻击。 用户在使用时仍然需要谨慎，确保对代码进行适当的审查和修改，以避免潜在的风险。

**项目地址:** [charlesgargasson/CVE-2024-32002](https://github.com/charlesgargasson/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #16

**来源**: [CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md](../2024/CVE-2024-32002-chrisWalker11_running-CVE-2024-32002-locally-for-tesing.md)

## CVE-2024-32002 - Git 递归克隆远程代码执行漏洞

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统必须使用大小写不敏感的文件系统且启用符号链接（或未禁用）。需要能够访问恶意Git仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002 漏洞允许攻击者通过构造包含恶意子模块的 Git 仓库，在目标系统上实现远程代码执行。漏洞原理是当Git在大小写不敏感的文件系统上递归克隆包含子模块的仓库时，攻击者可以利用大小写差异将文件写入 `.git/` 目录，从而覆盖或创建恶意 hook。当执行 `git clone --recursive` 命令时，恶意 hook 会被触发，导致任意代码执行。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含子模块的 Git 仓库。该子模块的路径经过特殊构造，利用大小写差异（例如 `A/modules/x` 和 `a/modules/x`）以及符号链接，指向子模块的 `.git/` 目录。
2.  **植入恶意Hook：** 在子模块的 `.git/hooks/` 目录下放置恶意的 Git hook 脚本（例如 `post-checkout`）。
3.  **诱导克隆：** 诱导受害者使用 `git clone --recursive` 命令克隆该恶意仓库。
4.  **触发执行：** 当受害者克隆仓库时，由于文件系统的大小写不敏感特性和符号链接，恶意 hook 会被写入 `.git/` 目录并被执行，导致远程代码执行。

**POC有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码有效。它演示了如何通过精心构造的 Git 仓库和子模块，利用 Git 的递归克隆功能在目标系统上执行任意代码。POC需要用户输入gitea服务器的ip地址、用户名和api token，然后创建两个仓库，并在其中一个仓库中添加恶意hook。另外, 需要手动修改 .gitmodules 文件，指向包含恶意hook的仓库。

**投毒风险评估：**

提供的POC代码主要用于演示漏洞的利用，旨在帮助安全研究人员理解和复现该漏洞。其中涉及的恶意代码（如在 hook 中执行 `calc.exe`）仅用于演示 RCE，并非旨在窃取或破坏用户数据，不构成直接的投毒行为。虽然该POC代码本身不包含投毒代码，但如果被恶意使用者利用，可能会被修改以植入更具破坏性的代码。 因此,投毒的风险概率为0%。

**缓解措施：**

1.  升级 Git 版本到已修复该漏洞的版本（>= 2.39.4, >= 2.40.2, >= 2.41.1, >= 2.42.2, >= 2.43.4, >= 2.44.1, >= 2.45.1）。
2.  禁用 Git 的符号链接支持（`git config --global core.symlinks false`）。
3.  避免克隆来自不受信任来源的 Git 仓库。


**项目地址:** [chrisWalker11/running-CVE-2024-32002-locally-for-tesing](https://github.com/chrisWalker11/running-CVE-2024-32002-locally-for-tesing)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #17

**来源**: [CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md](../2024/CVE-2024-32002-daemon-reconfig_CVE-2024-32002.md)

## CVE-2024-32002

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并允许递归克隆包含恶意submodule的仓库。目标文件系统需要大小写不敏感且支持符号链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的 submodule 处理机制中。攻击者可以构造包含恶意 submodule 的仓库，当受害者递归克隆该仓库时，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。这样，攻击者就可以在克隆过程中执行恶意 hook，从而实现远程代码执行。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞是一个远程代码执行漏洞，利用 submodules 中的缺陷，通过在`.git/`目录下写入恶意 hook 脚本，在 clone 过程中执行该脚本，从而实现 RCE。提供的POC代码尝试模拟此攻击，克隆恶意仓库，设置 git 配置以允许文件协议和符号链接，然后创建包含恶意payload的post-checkout hook，并将其推送到远端仓库，最后添加恶意的submodule。因此，提供的POC代码在满足漏洞利用条件的情况下是有效的。

**投毒风险分析：**
POC代码中存在潜在的投毒风险，作者可能通过恶意修改`shell.sh`，在受害者执行漏洞利用代码时执行意料之外的代码。例如，作者可能添加代码来窃取受害者的凭据、安装后门或进行其他恶意活动。但是从现有代码看，可能性较低。判断依据如下：

*   `rm -rf nothing` 和 `rm -rf toSeeHere` 看上去是无害的操作，但可能用于清理攻击痕迹，或者迷惑分析人员。
*   设置全局git配置，例如`git config --global protocol.file.allow always`，可能允许其他攻击向量。如果受害者在其他环境中使用了被更改的全局git配置，可能会带来安全风险。
*   `git clone http://<server ip>:<port>/<username>/repo1.git` 和 `git clone http://<server ip>:<port>/<username>/repo2.git` 依赖外部的git服务器。该服务器可能包含后门代码，或者在特定的IP/用户环境下，返回不同的内容，实现有选择的攻击。
*   `cat > y/hooks/post-checkout <<EOF
#!bin/sh.exe
#your payload goes here
EOF` 这部分是payload注入点, 攻击者可以伪装成漏洞利用代码，将恶意代码放在此处。

**利用方式分析：**
1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  在 submodule 中，攻击者创建一个 hook 脚本（例如 `post-checkout`），该脚本包含恶意代码。
3.  攻击者将 submodule 添加到主仓库中，并创建一个特殊的 `.git` 文件或符号链接，指向恶意 submodule 的 `.git` 目录。
4.  当受害者递归克隆包含恶意 submodule 的仓库时，Git 会尝试初始化 submodule。
5.  由于存在特殊的 `.git` 文件或符号链接，Git 会被欺骗将文件写入 `.git/` 目录而不是 submodule 的工作目录。
6.  写入 `.git/` 目录中的 hook 脚本会被执行，从而实现远程代码执行。

**项目地址:** [daemon-reconfig/CVE-2024-32002](https://github.com/daemon-reconfig/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #18

**来源**: [CVE-2024-32002-grecosamuel_CVE-2024-32002.md](../2024/CVE-2024-32002-grecosamuel_CVE-2024-32002.md)

## CVE-2024-32002 - Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统安装受影响版本的Git，且允许clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是一个存在于 Git submodules 中的远程代码执行漏洞。当 Git 在大小写不敏感的文件系统上递归克隆存储库时，攻击者可以利用此漏洞。通过精心构造包含恶意 submodule 的 Git 仓库，攻击者可以欺骗 Git 将文件写入到 `.git/` 目录，而不是 submodule 的工作目录中。这使得攻击者可以写入一个 hook 文件，该 hook 文件在 clone 操作期间执行，从而实现远程代码执行。该漏洞的利用依赖于 `core.symlinks` 配置项是否启用。如果 `core.symlinks` 被禁用，攻击将无法成功。提供的 POC 代码通过创建一个包含恶意 post-checkout hook 的 submodule，然后将其包含在一个主仓库中。当受害者克隆主仓库时，post-checkout hook 会被执行，从而导致代码执行。考虑到此漏洞的利用方式，远程仓库本身就可能包含恶意代码，存在一定投毒的风险。

**漏洞利用方式:**
1.  攻击者创建一个恶意 Git 仓库，其中包含一个 submodule。
2.  Submodule 包含一个恶意的 `post-checkout` hook，用于执行攻击者的 payload。
3.  攻击者诱使受害者克隆包含恶意 submodule 的仓库。
4.  在克隆过程中，Git 会递归克隆 submodule。
5.  由于漏洞，恶意的 `post-checkout` hook 被写入 `.git/` 目录并执行，导致 RCE。

**POC 代码分析和投毒风险评估:**
提供的POC代码主要功能是自动化漏洞利用流程, 简化了恶意仓库的创建过程。代码本身没有明显的投毒行为。 投毒风险主要来源于clone的远程仓库本身。POC中push到远程仓库步骤也有潜在的投毒风险，虽然可能性较低，但不能完全排除。

**有效性:**
根据搜索引擎结果，有多个来源证实了此漏洞的存在以及POC的有效性。

**项目地址:** [grecosamuel/CVE-2024-32002](https://github.com/grecosamuel/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #19

**来源**: [CVE-2024-32002-sanan2004_CVE-2024-32002.md](../2024/CVE-2024-32002-sanan2004_CVE-2024-32002.md)

## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.39.4, >= 2.40.0, < 2.40.2, = 2.41.0, >= 2.42.0, < 2.42.2, >= 2.43.0, < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 需要目标系统开启 symlinks 支持 (core.symlinks = true)，且攻击者能够控制一个包含恶意配置的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造的包含恶意子模块的 Git 仓库，在克隆仓库的用户的系统上执行任意代码。漏洞的根源在于 Git 在处理子模块时，可能将文件写入 `.git/` 目录而非子模块的工作目录。这使得攻击者可以放置一个 Git hook (例如 `post-checkout`) 在克隆操作期间执行。PoC 的利用方式是：

1.  **准备恶意仓库 (hulk.git):** 该仓库包含一个 `post-checkout` hook，hook 的内容是恶意payload（示例中是打开计算器）。这个hook会被放置在 `.git/hooks/` 目录下。
2.  **准备包含恶意子模块的仓库 (submod.git):** 该仓库将恶意仓库 (`hulk.git`) 添加为子模块，并创建一个指向 `.git` 目录的符号链接。关键的一步是使用`git update-index`命令来创建一个指向 `.git` 目录的符号链接。
3.  **准备最终的触发仓库 (smash.git):** 用户克隆该仓库时，由于递归克隆子模块，符号链接会被错误地解析，导致 `post-checkout` hook 被复制到 `.git/hooks/` 目录下，并在克隆过程的某个阶段执行，从而实现 RCE。

**有效性：** 提供的 PoC 代码是有效的，如果满足先决条件（易受攻击的 Git 版本和启用的符号链接），则可以成功触发 RCE。

**投毒风险：** PoC 本身的主要功能是演示漏洞，但由于代码的复杂性，存在细微的投毒风险。例如，`poc.sh` 脚本中可以被加入额外命令，在执行漏洞利用的同时，进行其他恶意操作，例如收集用户信息、安装后门程序等。此外，`hulk.git`仓库中可以存在除计算器之外的其他恶意payload。因此,投毒风险评估为10%。

**利用方式：** 攻击者需要控制一个 Git 仓库，并诱导受害者递归克隆该仓库。一旦受害者执行了 `git clone --recursive <恶意仓库>` 命令，恶意代码就会在其系统上执行。

**缓解措施：**

*   升级 Git 到已修复的版本。
*   禁用符号链接支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不受信任来源的仓库。

**项目地址:** [sanan2004/CVE-2024-32002](https://github.com/sanan2004/CVE-2024-32002)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #20

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-demo.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-demo.md)

## CVE-2024-32002-Git递归克隆远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，允许未经身份验证的攻击者在受害者机器上执行任意代码

**影响版本:** < 2.39.4, >= 2.40.0 < 2.40.2, = 2.41.0, >= 2.42.0 < 2.42.2, >= 2.43.0 < 2.43.4, = 2.44.0, = 2.45.0

**利用条件:** 目标系统需要使用受影响版本的Git，且需要在大小写不敏感的文件系统（例如macOS的默认设置，Windows）上克隆包含恶意配置的仓库，同时`core.symlinks`配置未显式设置为`false`。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-32002 漏洞允许攻击者通过精心构造包含恶意子模块的 Git 仓库，利用 Git 在大小写不敏感的文件系统上的处理缺陷，将恶意 hook 写入 `.git/` 目录，从而在克隆仓库时执行任意代码。攻击者可以诱骗用户克隆恶意仓库，从而在用户不知情的情况下执行恶意代码。

**有效性分析：**

根据漏洞描述，提供的POC代码旨在演示如何利用此漏洞。通过`git clone --recursive`命令克隆该仓库，如果目标系统满足漏洞触发条件（受影响的Git版本，大小写不敏感的文件系统，未禁用符号链接），则可能触发漏洞，导致恶意代码执行。提供的POC利用方法符合漏洞描述，因此POC**可能有效**。

**投毒风险分析：**

提供的代码片段包括：

*   `/README.md`: 包含克隆仓库的说明。
*   `/docs/README.md`: 简单的文档说明。
*   `/src/example.py`: 一个简单的Python脚本，用于处理数据并打印结果。

初步分析表明，提供的代码本身并没有明显的恶意代码或后门。主要的风险在于该仓库可能包含隐藏的恶意 Git 配置（例如存在于.gitmodules或者.git/hooks中）或者子模块，当使用`git clone --recursive`时被自动执行。

由于无法直接看到.git目录下的文件，因此无法完全排除投毒风险。假设`git clone --recursive` 命令在满足条件下，自动触发恶意hook的可能性比较低，但是仍然存在。因此这里给出了5%的投毒可能性。

**利用方式：**

1.  攻击者创建一个包含恶意子模块的 Git 仓库。
2.  恶意子模块包含一个 hook，该 hook 会在仓库被克隆时执行任意代码。
3.  攻击者诱骗受害者克隆该恶意仓库。
4.  当受害者使用 `git clone --recursive` 命令克隆仓库时，恶意 hook 被执行，从而导致远程代码执行。

要减轻此漏洞的影响，用户应避免克隆来自不受信任来源的仓库，并确保使用的 Git 版本已更新到修复此漏洞的版本。 此外，如果不需要符号链接，可以禁用符号链接支持，通过设置`git config --global core.symlinks false`来缓解风险。

**项目地址:** [srakkk/cve-2024-32002-demo](https://github.com/srakkk/cve-2024-32002-demo)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #21

**来源**: [CVE-2024-32002-srakkk_cve-2024-32002-hook.md](../2024/CVE-2024-32002-srakkk_cve-2024-32002-hook.md)

## CVE-2024-32002 - Git Recursive Clone Remote Code Execution

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统启用 `core.symlinks` (默认启用) 且使用受影响的 Git 版本进行递归克隆包含恶意 submodule 的仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32002 漏洞允许攻击者通过构造包含恶意 submodule 的 Git 仓库，在受害者克隆该仓库时执行任意代码。漏洞原理在于 Git 在递归克隆子模块时，可能被诱导将文件写入 `.git/` 目录而非子模块的工作目录，从而覆盖或创建 hook 文件（如 `post-checkout`），在克隆操作完成前执行恶意代码。提供的 POC 代码包含一个 `post-checkout` hook 脚本，该脚本会在克隆后被执行，用于验证漏洞并创建一个包含执行结果的 proof 文件。POC 代码未发现明显的投毒行为，其作用仅为验证漏洞存在并执行简单的系统命令。漏洞利用依赖于受害者克隆包含恶意子模块的仓库，并在支持符号链接的文件系统上使用受影响的 Git 版本。如果禁用符号链接支持 (`git config --global core.symlinks false`)，则此漏洞将无法利用。

**漏洞利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  **构造恶意 submodule：** 在 submodule 中放置恶意的 `.git/hooks/post-checkout` 文件，其中包含要执行的恶意代码。
3.  **诱导受害者克隆：** 攻击者诱导受害者使用 `git clone --recurse-submodules <恶意仓库>` 命令克隆该仓库。
4.  **触发漏洞：** 当 Git 克隆子模块时，恶意 hook 文件会被写入 `.git/` 目录，并在 `git checkout` 操作后自动执行，从而实现远程代码执行。

**项目地址:** [srakkk/cve-2024-32002-hook](https://github.com/srakkk/cve-2024-32002-hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #22

**来源**: [CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md](../2024/CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md)

## CVE-2024-32002 Git RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：2.39.4之前, 2.40.0 < 2.40.2, 2.41.0, 2.42.0 < 2.42.2, 2.43.0 < 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标系统需要使用受影响的Git版本，且攻击者能够诱导用户克隆包含恶意submodule的仓库。文件系统需要大小写不敏感，且支持符号链接或开启`core.symlinks`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是Git中的一个远程代码执行漏洞，该漏洞允许攻击者通过精心构造包含恶意submodule的Git仓库，在受害者克隆该仓库时执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意submodule的Git仓库。
2.  该恶意submodule包含一个`.gitmodules`文件，其中定义了submodule的路径和一个指向攻击者控制的仓库的URL。
3.  攻击者在submodule的仓库中创建一个恶意的`.git/hooks/post-checkout`脚本，该脚本包含要执行的恶意代码（例如`calc.exe`）。
4.  受害者克隆该恶意仓库，Git会递归地克隆submodule。
5.  由于Git在处理submodule时存在漏洞，攻击者可以利用大小写不敏感的文件系统和符号链接，将恶意hook脚本写入到`.git/`目录中，而不是submodule的工作目录。
6.  在克隆submodule完成后，`.git/hooks/post-checkout`脚本会自动执行，导致远程代码执行。

**有效性：**
提供的POC代码看起来有效。`README.md` 只是仓库的说明文档，`hooks/post-checkout` 脚本包含 `calc.exe`，这意味着在受害者克隆包含此 submodule 的仓库后，`calc.exe` 会被执行，验证了RCE漏洞的存在。根据搜索引擎结果，该漏洞确实可以被利用进行远程代码执行（例如，[webpage 4 begin] 和 [webpage 6 begin]）。

**投毒风险：**
POC 代码中的`calc.exe` 显然是用于验证漏洞的，并非恶意代码。但是，如果攻击者用更隐蔽和恶意的代码替换 `calc.exe`，那么这就构成了投毒。由于提供的代码非常简单，只包含一个 hook 脚本，隐藏恶意代码的空间相对较小，主要风险在于hook脚本本身可能包含更复杂的恶意行为。假设攻击者有10%的可能性在其他地方（例如隐藏的脚本或配置文件中）添加恶意代码。

**漏洞缓解措施：**
*   升级 Git 到最新版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不可信来源的仓库。

**项目地址:** [sysonlai/CVE-2024-32002-hook](https://github.com/sysonlai/CVE-2024-32002-hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #23

**来源**: [CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致完全控制受害者系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统大小写不敏感并支持符号链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是一个存在于Git submodules中的远程代码执行漏洞。攻击者可以通过构造包含恶意submodule的Git仓库，诱导受害者克隆该仓库，从而在受害者系统上执行恶意代码。

**有效性：**
提供的PoC代码有效。它通过创建一个包含恶意hook的submodule，并利用Git在处理submodule时可能出现的路径混淆漏洞，将该hook写入到.git/目录中。当受害者执行git clone --recursive命令时，该hook会被触发，从而执行攻击者预设的恶意代码。

**投毒风险：**
虽然PoC的目的是演示漏洞利用，但仍然存在一定程度的投毒风险。这个比例大约在10%。具体分析如下：
*   **setup.sh脚本：** 脚本本身包含了一些配置设置（例如`git config --global protocol.file.allow always`和`git config --global core.symlinks true`），这些设置可能降低用户的安全性，但这是为了让POC复现更加容易，并不是作者有意投毒的行为。
*   脚本的主要目的是设置恶意hook，并通过git push将其推送到远程仓库。这使得其他克隆该仓库的用户也会受到影响。但提供的hook只是一个简单的演示，其目的是弹出消息框和写入文件，因此，即使hook被执行，也不会对系统造成严重损害。
*   虽然目前的hook不会造成太大危害，但是攻击者可以修改hook的内容，使其执行更具破坏性的操作。因此，存在一定的投毒风险。
*   该漏洞的利用需要用户克隆包含恶意submodule的仓库，并执行`git clone --recursive`命令。如果用户不克隆包含恶意submodule的仓库，或者不执行`git clone --recursive`命令，就不会受到攻击。

**利用方式：**
1.  **创建恶意Git仓库：** 攻击者创建一个包含submodule的Git仓库。该submodule指向一个包含恶意hook的仓库。
2.  **构造恶意submodule：** 攻击者在submodule的仓库中创建一个恶意的post-checkout hook，该hook包含攻击者想要执行的恶意代码。
3.  **利用路径混淆漏洞：** 攻击者利用Git在处理submodule时可能出现的路径混淆漏洞，将恶意hook写入到.git/目录中。
4.  **诱导受害者克隆：** 攻击者诱导受害者克隆包含恶意submodule的Git仓库，并执行`git clone --recursive`命令。
5.  **执行恶意代码：** 当受害者执行`git clone --recursive`命令时，恶意hook会被触发，从而在受害者系统上执行攻击者预设的恶意代码。

由于该漏洞允许在克隆过程中执行任意代码，因此其危害性极高。建议用户及时更新Git版本，并避免克隆来自不受信任来源的仓库。

**项目地址:** [th4s1s/CVE-2024-32002-PoC](https://github.com/th4s1s/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---



---

## POC #22

**来源**: [CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md](../2024/CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md)

## CVE-2024-32002 Git RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：2.39.4之前, 2.40.0 < 2.40.2, 2.41.0, 2.42.0 < 2.42.2, 2.43.0 < 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标系统需要使用受影响的Git版本，且攻击者能够诱导用户克隆包含恶意submodule的仓库。文件系统需要大小写不敏感，且支持符号链接或开启`core.symlinks`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是Git中的一个远程代码执行漏洞，该漏洞允许攻击者通过精心构造包含恶意submodule的Git仓库，在受害者克隆该仓库时执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意submodule的Git仓库。
2.  该恶意submodule包含一个`.gitmodules`文件，其中定义了submodule的路径和一个指向攻击者控制的仓库的URL。
3.  攻击者在submodule的仓库中创建一个恶意的`.git/hooks/post-checkout`脚本，该脚本包含要执行的恶意代码（例如`calc.exe`）。
4.  受害者克隆该恶意仓库，Git会递归地克隆submodule。
5.  由于Git在处理submodule时存在漏洞，攻击者可以利用大小写不敏感的文件系统和符号链接，将恶意hook脚本写入到`.git/`目录中，而不是submodule的工作目录。
6.  在克隆submodule完成后，`.git/hooks/post-checkout`脚本会自动执行，导致远程代码执行。

**有效性：**
提供的POC代码看起来有效。`README.md` 只是仓库的说明文档，`hooks/post-checkout` 脚本包含 `calc.exe`，这意味着在受害者克隆包含此 submodule 的仓库后，`calc.exe` 会被执行，验证了RCE漏洞的存在。根据搜索引擎结果，该漏洞确实可以被利用进行远程代码执行（例如，[webpage 4 begin] 和 [webpage 6 begin]）。

**投毒风险：**
POC 代码中的`calc.exe` 显然是用于验证漏洞的，并非恶意代码。但是，如果攻击者用更隐蔽和恶意的代码替换 `calc.exe`，那么这就构成了投毒。由于提供的代码非常简单，只包含一个 hook 脚本，隐藏恶意代码的空间相对较小，主要风险在于hook脚本本身可能包含更复杂的恶意行为。假设攻击者有10%的可能性在其他地方（例如隐藏的脚本或配置文件中）添加恶意代码。

**漏洞缓解措施：**
*   升级 Git 到最新版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不可信来源的仓库。

**项目地址:** [sysonlai/CVE-2024-32002-hook](https://github.com/sysonlai/CVE-2024-32002-hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #23

**来源**: [CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致完全控制受害者系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统大小写不敏感并支持符号链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是一个存在于Git submodules中的远程代码执行漏洞。攻击者可以通过构造包含恶意submodule的Git仓库，诱导受害者克隆该仓库，从而在受害者系统上执行恶意代码。

**有效性：**
提供的PoC代码有效。它通过创建一个包含恶意hook的submodule，并利用Git在处理submodule时可能出现的路径混淆漏洞，将该hook写入到.git/目录中。当受害者执行git clone --recursive命令时，该hook会被触发，从而执行攻击者预设的恶意代码。

**投毒风险：**
虽然PoC的目的是演示漏洞利用，但仍然存在一定程度的投毒风险。这个比例大约在10%。具体分析如下：
*   **setup.sh脚本：** 脚本本身包含了一些配置设置（例如`git config --global protocol.file.allow always`和`git config --global core.symlinks true`），这些设置可能降低用户的安全性，但这是为了让POC复现更加容易，并不是作者有意投毒的行为。
*   脚本的主要目的是设置恶意hook，并通过git push将其推送到远程仓库。这使得其他克隆该仓库的用户也会受到影响。但提供的hook只是一个简单的演示，其目的是弹出消息框和写入文件，因此，即使hook被执行，也不会对系统造成严重损害。
*   虽然目前的hook不会造成太大危害，但是攻击者可以修改hook的内容，使其执行更具破坏性的操作。因此，存在一定的投毒风险。
*   该漏洞的利用需要用户克隆包含恶意submodule的仓库，并执行`git clone --recursive`命令。如果用户不克隆包含恶意submodule的仓库，或者不执行`git clone --recursive`命令，就不会受到攻击。

**利用方式：**
1.  **创建恶意Git仓库：** 攻击者创建一个包含submodule的Git仓库。该submodule指向一个包含恶意hook的仓库。
2.  **构造恶意submodule：** 攻击者在submodule的仓库中创建一个恶意的post-checkout hook，该hook包含攻击者想要执行的恶意代码。
3.  **利用路径混淆漏洞：** 攻击者利用Git在处理submodule时可能出现的路径混淆漏洞，将恶意hook写入到.git/目录中。
4.  **诱导受害者克隆：** 攻击者诱导受害者克隆包含恶意submodule的Git仓库，并执行`git clone --recursive`命令。
5.  **执行恶意代码：** 当受害者执行`git clone --recursive`命令时，恶意hook会被触发，从而在受害者系统上执行攻击者预设的恶意代码。

由于该漏洞允许在克隆过程中执行任意代码，因此其危害性极高。建议用户及时更新Git版本，并避免克隆来自不受信任来源的仓库。

**项目地址:** [th4s1s/CVE-2024-32002-PoC](https://github.com/th4s1s/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---



---

## POC #22

**来源**: [CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md](../2024/CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md)

## CVE-2024-32002 Git RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：2.39.4之前, 2.40.0 < 2.40.2, 2.41.0, 2.42.0 < 2.42.2, 2.43.0 < 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标系统需要使用受影响的Git版本，且攻击者能够诱导用户克隆包含恶意submodule的仓库。文件系统需要大小写不敏感，且支持符号链接或开启`core.symlinks`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是Git中的一个远程代码执行漏洞，该漏洞允许攻击者通过精心构造包含恶意submodule的Git仓库，在受害者克隆该仓库时执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意submodule的Git仓库。
2.  该恶意submodule包含一个`.gitmodules`文件，其中定义了submodule的路径和一个指向攻击者控制的仓库的URL。
3.  攻击者在submodule的仓库中创建一个恶意的`.git/hooks/post-checkout`脚本，该脚本包含要执行的恶意代码（例如`calc.exe`）。
4.  受害者克隆该恶意仓库，Git会递归地克隆submodule。
5.  由于Git在处理submodule时存在漏洞，攻击者可以利用大小写不敏感的文件系统和符号链接，将恶意hook脚本写入到`.git/`目录中，而不是submodule的工作目录。
6.  在克隆submodule完成后，`.git/hooks/post-checkout`脚本会自动执行，导致远程代码执行。

**有效性：**
提供的POC代码看起来有效。`README.md` 只是仓库的说明文档，`hooks/post-checkout` 脚本包含 `calc.exe`，这意味着在受害者克隆包含此 submodule 的仓库后，`calc.exe` 会被执行，验证了RCE漏洞的存在。根据搜索引擎结果，该漏洞确实可以被利用进行远程代码执行（例如，[webpage 4 begin] 和 [webpage 6 begin]）。

**投毒风险：**
POC 代码中的`calc.exe` 显然是用于验证漏洞的，并非恶意代码。但是，如果攻击者用更隐蔽和恶意的代码替换 `calc.exe`，那么这就构成了投毒。由于提供的代码非常简单，只包含一个 hook 脚本，隐藏恶意代码的空间相对较小，主要风险在于hook脚本本身可能包含更复杂的恶意行为。假设攻击者有10%的可能性在其他地方（例如隐藏的脚本或配置文件中）添加恶意代码。

**漏洞缓解措施：**
*   升级 Git 到最新版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不可信来源的仓库。

**项目地址:** [sysonlai/CVE-2024-32002-hook](https://github.com/sysonlai/CVE-2024-32002-hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #23

**来源**: [CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致完全控制受害者系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统大小写不敏感并支持符号链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是一个存在于Git submodules中的远程代码执行漏洞。攻击者可以通过构造包含恶意submodule的Git仓库，诱导受害者克隆该仓库，从而在受害者系统上执行恶意代码。

**有效性：**
提供的PoC代码有效。它通过创建一个包含恶意hook的submodule，并利用Git在处理submodule时可能出现的路径混淆漏洞，将该hook写入到.git/目录中。当受害者执行git clone --recursive命令时，该hook会被触发，从而执行攻击者预设的恶意代码。

**投毒风险：**
虽然PoC的目的是演示漏洞利用，但仍然存在一定程度的投毒风险。这个比例大约在10%。具体分析如下：
*   **setup.sh脚本：** 脚本本身包含了一些配置设置（例如`git config --global protocol.file.allow always`和`git config --global core.symlinks true`），这些设置可能降低用户的安全性，但这是为了让POC复现更加容易，并不是作者有意投毒的行为。
*   脚本的主要目的是设置恶意hook，并通过git push将其推送到远程仓库。这使得其他克隆该仓库的用户也会受到影响。但提供的hook只是一个简单的演示，其目的是弹出消息框和写入文件，因此，即使hook被执行，也不会对系统造成严重损害。
*   虽然目前的hook不会造成太大危害，但是攻击者可以修改hook的内容，使其执行更具破坏性的操作。因此，存在一定的投毒风险。
*   该漏洞的利用需要用户克隆包含恶意submodule的仓库，并执行`git clone --recursive`命令。如果用户不克隆包含恶意submodule的仓库，或者不执行`git clone --recursive`命令，就不会受到攻击。

**利用方式：**
1.  **创建恶意Git仓库：** 攻击者创建一个包含submodule的Git仓库。该submodule指向一个包含恶意hook的仓库。
2.  **构造恶意submodule：** 攻击者在submodule的仓库中创建一个恶意的post-checkout hook，该hook包含攻击者想要执行的恶意代码。
3.  **利用路径混淆漏洞：** 攻击者利用Git在处理submodule时可能出现的路径混淆漏洞，将恶意hook写入到.git/目录中。
4.  **诱导受害者克隆：** 攻击者诱导受害者克隆包含恶意submodule的Git仓库，并执行`git clone --recursive`命令。
5.  **执行恶意代码：** 当受害者执行`git clone --recursive`命令时，恶意hook会被触发，从而在受害者系统上执行攻击者预设的恶意代码。

由于该漏洞允许在克隆过程中执行任意代码，因此其危害性极高。建议用户及时更新Git版本，并避免克隆来自不受信任来源的仓库。

**项目地址:** [th4s1s/CVE-2024-32002-PoC](https://github.com/th4s1s/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---



---

## POC #22

**来源**: [CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md](../2024/CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md)

## CVE-2024-32002 Git RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：2.39.4之前, 2.40.0 < 2.40.2, 2.41.0, 2.42.0 < 2.42.2, 2.43.0 < 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标系统需要使用受影响的Git版本，且攻击者能够诱导用户克隆包含恶意submodule的仓库。文件系统需要大小写不敏感，且支持符号链接或开启`core.symlinks`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是Git中的一个远程代码执行漏洞，该漏洞允许攻击者通过精心构造包含恶意submodule的Git仓库，在受害者克隆该仓库时执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意submodule的Git仓库。
2.  该恶意submodule包含一个`.gitmodules`文件，其中定义了submodule的路径和一个指向攻击者控制的仓库的URL。
3.  攻击者在submodule的仓库中创建一个恶意的`.git/hooks/post-checkout`脚本，该脚本包含要执行的恶意代码（例如`calc.exe`）。
4.  受害者克隆该恶意仓库，Git会递归地克隆submodule。
5.  由于Git在处理submodule时存在漏洞，攻击者可以利用大小写不敏感的文件系统和符号链接，将恶意hook脚本写入到`.git/`目录中，而不是submodule的工作目录。
6.  在克隆submodule完成后，`.git/hooks/post-checkout`脚本会自动执行，导致远程代码执行。

**有效性：**
提供的POC代码看起来有效。`README.md` 只是仓库的说明文档，`hooks/post-checkout` 脚本包含 `calc.exe`，这意味着在受害者克隆包含此 submodule 的仓库后，`calc.exe` 会被执行，验证了RCE漏洞的存在。根据搜索引擎结果，该漏洞确实可以被利用进行远程代码执行（例如，[webpage 4 begin] 和 [webpage 6 begin]）。

**投毒风险：**
POC 代码中的`calc.exe` 显然是用于验证漏洞的，并非恶意代码。但是，如果攻击者用更隐蔽和恶意的代码替换 `calc.exe`，那么这就构成了投毒。由于提供的代码非常简单，只包含一个 hook 脚本，隐藏恶意代码的空间相对较小，主要风险在于hook脚本本身可能包含更复杂的恶意行为。假设攻击者有10%的可能性在其他地方（例如隐藏的脚本或配置文件中）添加恶意代码。

**漏洞缓解措施：**
*   升级 Git 到最新版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不可信来源的仓库。

**项目地址:** [sysonlai/CVE-2024-32002-hook](https://github.com/sysonlai/CVE-2024-32002-hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #23

**来源**: [CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致完全控制受害者系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统大小写不敏感并支持符号链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是一个存在于Git submodules中的远程代码执行漏洞。攻击者可以通过构造包含恶意submodule的Git仓库，诱导受害者克隆该仓库，从而在受害者系统上执行恶意代码。

**有效性：**
提供的PoC代码有效。它通过创建一个包含恶意hook的submodule，并利用Git在处理submodule时可能出现的路径混淆漏洞，将该hook写入到.git/目录中。当受害者执行git clone --recursive命令时，该hook会被触发，从而执行攻击者预设的恶意代码。

**投毒风险：**
虽然PoC的目的是演示漏洞利用，但仍然存在一定程度的投毒风险。这个比例大约在10%。具体分析如下：
*   **setup.sh脚本：** 脚本本身包含了一些配置设置（例如`git config --global protocol.file.allow always`和`git config --global core.symlinks true`），这些设置可能降低用户的安全性，但这是为了让POC复现更加容易，并不是作者有意投毒的行为。
*   脚本的主要目的是设置恶意hook，并通过git push将其推送到远程仓库。这使得其他克隆该仓库的用户也会受到影响。但提供的hook只是一个简单的演示，其目的是弹出消息框和写入文件，因此，即使hook被执行，也不会对系统造成严重损害。
*   虽然目前的hook不会造成太大危害，但是攻击者可以修改hook的内容，使其执行更具破坏性的操作。因此，存在一定的投毒风险。
*   该漏洞的利用需要用户克隆包含恶意submodule的仓库，并执行`git clone --recursive`命令。如果用户不克隆包含恶意submodule的仓库，或者不执行`git clone --recursive`命令，就不会受到攻击。

**利用方式：**
1.  **创建恶意Git仓库：** 攻击者创建一个包含submodule的Git仓库。该submodule指向一个包含恶意hook的仓库。
2.  **构造恶意submodule：** 攻击者在submodule的仓库中创建一个恶意的post-checkout hook，该hook包含攻击者想要执行的恶意代码。
3.  **利用路径混淆漏洞：** 攻击者利用Git在处理submodule时可能出现的路径混淆漏洞，将恶意hook写入到.git/目录中。
4.  **诱导受害者克隆：** 攻击者诱导受害者克隆包含恶意submodule的Git仓库，并执行`git clone --recursive`命令。
5.  **执行恶意代码：** 当受害者执行`git clone --recursive`命令时，恶意hook会被触发，从而在受害者系统上执行攻击者预设的恶意代码。

由于该漏洞允许在克隆过程中执行任意代码，因此其危害性极高。建议用户及时更新Git版本，并避免克隆来自不受信任来源的仓库。

**项目地址:** [th4s1s/CVE-2024-32002-PoC](https://github.com/th4s1s/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---



---

## POC #22

**来源**: [CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md](../2024/CVE-2024-32002-sysonlai_CVE-2024-32002-hook.md)

## CVE-2024-32002 Git RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：2.39.4之前, 2.40.0 < 2.40.2, 2.41.0, 2.42.0 < 2.42.2, 2.43.0 < 2.43.4, 2.44.0, 2.45.0

**利用条件:** 目标系统需要使用受影响的Git版本，且攻击者能够诱导用户克隆包含恶意submodule的仓库。文件系统需要大小写不敏感，且支持符号链接或开启`core.symlinks`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是Git中的一个远程代码执行漏洞，该漏洞允许攻击者通过精心构造包含恶意submodule的Git仓库，在受害者克隆该仓库时执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意submodule的Git仓库。
2.  该恶意submodule包含一个`.gitmodules`文件，其中定义了submodule的路径和一个指向攻击者控制的仓库的URL。
3.  攻击者在submodule的仓库中创建一个恶意的`.git/hooks/post-checkout`脚本，该脚本包含要执行的恶意代码（例如`calc.exe`）。
4.  受害者克隆该恶意仓库，Git会递归地克隆submodule。
5.  由于Git在处理submodule时存在漏洞，攻击者可以利用大小写不敏感的文件系统和符号链接，将恶意hook脚本写入到`.git/`目录中，而不是submodule的工作目录。
6.  在克隆submodule完成后，`.git/hooks/post-checkout`脚本会自动执行，导致远程代码执行。

**有效性：**
提供的POC代码看起来有效。`README.md` 只是仓库的说明文档，`hooks/post-checkout` 脚本包含 `calc.exe`，这意味着在受害者克隆包含此 submodule 的仓库后，`calc.exe` 会被执行，验证了RCE漏洞的存在。根据搜索引擎结果，该漏洞确实可以被利用进行远程代码执行（例如，[webpage 4 begin] 和 [webpage 6 begin]）。

**投毒风险：**
POC 代码中的`calc.exe` 显然是用于验证漏洞的，并非恶意代码。但是，如果攻击者用更隐蔽和恶意的代码替换 `calc.exe`，那么这就构成了投毒。由于提供的代码非常简单，只包含一个 hook 脚本，隐藏恶意代码的空间相对较小，主要风险在于hook脚本本身可能包含更复杂的恶意行为。假设攻击者有10%的可能性在其他地方（例如隐藏的脚本或配置文件中）添加恶意代码。

**漏洞缓解措施：**
*   升级 Git 到最新版本。
*   禁用 symbolic link 支持 (`git config --global core.symlinks false`)。
*   避免克隆来自不可信来源的仓库。

**项目地址:** [sysonlai/CVE-2024-32002-hook](https://github.com/sysonlai/CVE-2024-32002-hook)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

## POC #23

**来源**: [CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md](../2024/CVE-2024-32002-th4s1s_CVE-2024-32002-PoC.md)

## CVE-2024-32002-Git远程代码执行

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Git

**危害等级:** 严重，可能导致完全控制受害者系统

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，且文件系统大小写不敏感并支持符号链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002是一个存在于Git submodules中的远程代码执行漏洞。攻击者可以通过构造包含恶意submodule的Git仓库，诱导受害者克隆该仓库，从而在受害者系统上执行恶意代码。

**有效性：**
提供的PoC代码有效。它通过创建一个包含恶意hook的submodule，并利用Git在处理submodule时可能出现的路径混淆漏洞，将该hook写入到.git/目录中。当受害者执行git clone --recursive命令时，该hook会被触发，从而执行攻击者预设的恶意代码。

**投毒风险：**
虽然PoC的目的是演示漏洞利用，但仍然存在一定程度的投毒风险。这个比例大约在10%。具体分析如下：
*   **setup.sh脚本：** 脚本本身包含了一些配置设置（例如`git config --global protocol.file.allow always`和`git config --global core.symlinks true`），这些设置可能降低用户的安全性，但这是为了让POC复现更加容易，并不是作者有意投毒的行为。
*   脚本的主要目的是设置恶意hook，并通过git push将其推送到远程仓库。这使得其他克隆该仓库的用户也会受到影响。但提供的hook只是一个简单的演示，其目的是弹出消息框和写入文件，因此，即使hook被执行，也不会对系统造成严重损害。
*   虽然目前的hook不会造成太大危害，但是攻击者可以修改hook的内容，使其执行更具破坏性的操作。因此，存在一定的投毒风险。
*   该漏洞的利用需要用户克隆包含恶意submodule的仓库，并执行`git clone --recursive`命令。如果用户不克隆包含恶意submodule的仓库，或者不执行`git clone --recursive`命令，就不会受到攻击。

**利用方式：**
1.  **创建恶意Git仓库：** 攻击者创建一个包含submodule的Git仓库。该submodule指向一个包含恶意hook的仓库。
2.  **构造恶意submodule：** 攻击者在submodule的仓库中创建一个恶意的post-checkout hook，该hook包含攻击者想要执行的恶意代码。
3.  **利用路径混淆漏洞：** 攻击者利用Git在处理submodule时可能出现的路径混淆漏洞，将恶意hook写入到.git/目录中。
4.  **诱导受害者克隆：** 攻击者诱导受害者克隆包含恶意submodule的Git仓库，并执行`git clone --recursive`命令。
5.  **执行恶意代码：** 当受害者执行`git clone --recursive`命令时，恶意hook会被触发，从而在受害者系统上执行攻击者预设的恶意代码。

由于该漏洞允许在克隆过程中执行任意代码，因此其危害性极高。建议用户及时更新Git版本，并避免克隆来自不受信任来源的仓库。

**项目地址:** [th4s1s/CVE-2024-32002-PoC](https://github.com/th4s1s/CVE-2024-32002-PoC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)

---

