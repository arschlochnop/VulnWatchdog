# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

# CVE-2024-31497

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-HugoBond_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 to 0.80 (不含0.81), FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6

**利用条件:** 需要收集至少60个由易受攻击的PuTTY版本生成的ECDSA签名，或控制受害者连接的SSH服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞源于 PuTTY 0.68 到 0.80 版本中 ECDSA 签名过程中 nonce 生成的偏差。具体来说，nonce的生成方式导致其高位部分始终为零，这使得攻击者可以通过收集一定数量的签名（大约60个）来恢复用户的 NIST P-521 私钥。

**利用方式：**

1.  **签名收集：** 攻击者需要收集由易受攻击的 PuTTY 版本签名的消息。这些签名可能来自公开的 Git 仓库（如果使用 SSH 密钥进行 commit 签名），或者通过控制受害者连接的恶意 SSH 服务器获得。
2.  **私钥恢复：** 收集到足够的签名后，攻击者使用漏洞利用代码（如提供的 Python 脚本）来恢复私钥。该脚本利用数论和格理论中的技术（特别是 Hidden Number Problem）来解决由偏差 nonce 引起的方程。

**有效性：**

提供的 POC 代码似乎是有效的，因为它实现了利用该漏洞所需的数学和密码学算法。`README.md` 文件描述了漏洞的原理和利用所需的步骤，而 `main.py` 脚本实现了私钥恢复逻辑。测试脚本 `test.py` 也验证了私钥恢复的正确性。

**投毒风险：**

虽然无法完全排除投毒风险，但该存储库中的代码看起来相对清晰。`requirements.txt` 中列出的依赖项是标准密码学和数学库，没有发现可疑的组件。
查看代码，尤其是 `attack/ecdsa_hnp.py`，可以看到存在网络操作，例如：

```python
import socket
```
但是，并没有直接使用网络套接字发送任何数据. 

尽管如此，仍然存在一定程度的风险（估计为10%），因为攻击代码非常复杂，并且恶意代码可能隐藏在细微之处。需要对所有依赖项和代码进行彻底审计才能完全消除风险。

**总结：**

此漏洞是一个严重的安全问题，因为它允许攻击者恢复用户的私钥，从而可能导致身份盗用和供应链攻击。应尽快更新到受影响软件的修复版本。

**项目地址:** [HugoBond/CVE-2024-31497-POC](https://github.com/HugoBond/CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #2

**来源**: [CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md](../2024/CVE-2024-31497-LukaWynants_Onderzoek_CVE-2024-31497-POC.md)

## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #3

**来源**: [CVE-2024-31497-edutko_cve-2024-31497.md](../2024/CVE-2024-31497-edutko_cve-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** 私钥泄露

**影响应用:** PuTTY, FileZilla, WinSCP, TortoiseGit, TortoiseSVN

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** PuTTY 0.68 through 0.80 (FileZilla < 3.67.0, WinSCP < 6.3.3, TortoiseGit < 2.15.0.1, TortoiseSVN <= 1.14.6)

**利用条件:** 需要约60个PuTTY签名的消息，可以通过监听SSH连接或从公共Git仓库获取

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 存在于 PuTTY 0.68 到 0.80 版本（不包括 0.81）中。漏洞原因是 ECDSA 签名过程中使用的 nonce 生成存在偏差，允许攻击者在获得大约 60 个签名后恢复 NIST P-521 私钥。这对于使用 SSH 密钥进行 Git 提交签名或通过代理转发机制使用 Pageant 的情况尤为重要。攻击者可以从公开的 Git 服务或通过恶意 SSH 服务器获取足够的信息来破解私钥，从而进行供应链攻击。 

**POC 分析：**

提供的 POC 代码包含一个 Dockerfile、Makefile、authorized_keys、ecdsa-p521.ppk、go.mod、go.sum 和 id_rsa 文件。

*   `Dockerfile`：用于构建一个包含私钥 (`id_rsa`) 和 SSH 服务器二进制文件 (`server-linux`) 的 Docker 镜像。
*   `Makefile`：用于编译 SSH 服务器二进制文件，并构建用于 amd64 和 arm64 架构的 Docker 镜像。
*   `authorized_keys`：包含一个公钥，用于 SSH 服务器的身份验证。
*   `ecdsa-p521.ppk`：包含 PuTTY 格式的私钥。
*   `go.mod` 和 `go.sum`：定义 Go 模块的依赖项。
*   `id_rsa`：包含 OpenSSH 格式的私钥。

提供的server端模拟了一个ssh server的功能,验证私钥是否能够成功认证。 

**利用方式：**

1.  **数据收集：** 攻击者首先需要收集受影响的 PuTTY 版本生成的签名消息。这些消息可以从公共 Git 仓库、SSH 服务器日志或通过中间人攻击获取。
2.  **密钥恢复：** 使用 `BreakingECDSAwithLLL` 工具（参考链接：[https://github.com/daedalus/BreakingECDSAwithLLL](https://github.com/daedalus/BreakingECDSAwithLLL)）分析收集到的签名，恢复 NIST P-521 私钥。
3.  **身份伪造：** 使用恢复的私钥冒充受害者，访问受害者可以访问的任何系统，包括 Git 仓库、SSH 服务器等。
4.  **供应链攻击：** 如果受害者使用私钥对软件进行签名，攻击者可以使用恢复的私钥对恶意软件进行签名，从而进行供应链攻击。

**投毒风险分析：**

该仓库可能存在低概率的投毒风险。 虽然提供的 `id_rsa`和`id_rsa.pub`可能用于验证poc的效果，但是也可能被恶意使用者滥用，例如替换dockerfile中的id_rsa,在不知情的情况下构建包含恶意后门的镜像，因此判定投毒风险为 10%。 多数代码都比较直观，用于搭建一个包含易受攻击密钥的 SSH 服务器，并没有明显的恶意代码。

**项目地址:** [edutko/cve-2024-31497](https://github.com/edutko/cve-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---

## POC #4

**来源**: [CVE-2024-31497-sh1k4ku_CVE-2024-31497.md](../2024/CVE-2024-31497-sh1k4ku_CVE-2024-31497.md)

## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA私钥泄露

**影响应用:** PuTTY

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** 0.68 <= version < 0.81

**利用条件:** 需要获取受影响 PuTTY 版本生成的至少 60 个 NIST P-521 ECDSA 签名。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞存在于 PuTTY 0.68 到 0.80 版本，以及其他相关软件（FileZilla, WinSCP, TortoiseGit, TortoiseSVN）。 该漏洞是由于有偏的 ECDSA nonce 生成导致，攻击者可以通过大约 60 个签名恢复用户的 NIST P-521 私钥。  

**漏洞利用方式:**

1.  **收集签名:** 攻击者需要收集受影响的 PuTTY 版本生成的 ECDSA 签名。这些签名可能从公开的 Git 仓库（如果使用 SSH 进行提交签名）或恶意 SSH 服务器获取。
2.  **私钥恢复:** 使用收集到的签名，攻击者可以利用数学方法（例如，格基规约算法）恢复用户的私钥。  已知的POC代码（如github.com/daedalus/BreakingECDSAwithLLL） 可以用于利用此漏洞。  
3.  **利用私钥:** 恢复私钥后，攻击者可以进行身份伪造，访问受害者账户，甚至发起供应链攻击（如果受害者使用该密钥进行代码签名）。

**POC有效性:**

提供的 POC 代码 `/tmp/a0edd92b931da468750e54b908748263/README.md` 只是一个描述文件，本身不包含任何可执行的漏洞利用代码。 因此，提供的 POC 代码本身无效。 但是，CVE 信息中提到了 github.com/daedalus/BreakingECDSAwithLLL，这提供了一个可行的漏洞利用途径。

**投毒风险:**

鉴于提供的POC只是一个描述文件，且仓库名称和描述暗示其目的是展示漏洞利用，投毒风险较低。 然而，任何从网络上下载的代码都存在潜在风险，因此，使用任何漏洞利用代码之前都应该进行仔细审查。 考虑到 README 文件是描述文件，其中包含恶意代码的可能性较低，因此判断投毒风险为 10%。 此百分比是基于假设，如果包含其他的文件则投毒风险会增加。

**缓解措施:**

*   升级到 PuTTY 0.81 或更高版本。
*   对于其他受影响的软件，升级到相应的修复版本（例如，FileZilla 3.67.0，WinSCP 6.3.3，TortoiseGit 2.15.0.1）。
*   重新生成新的 SSH 密钥对。
*   避免在不受信任的 SSH 服务器上使用 SSH agent forwarding。

**项目地址:** [sh1k4ku/CVE-2024-31497](https://github.com/sh1k4ku/CVE-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)

---



---



---



---



---



---



---

