## CVE-2024-3094 - XZ Utils (liblzma) 供应链攻击/远程代码执行(RCE)

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/远程代码执行(RCE)

**影响应用:** XZ Utils (liblzma)

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的xz库被liblzma链接，通常通过sshd服务暴露，且攻击者拥有特定的RSA私钥。

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 高

**投毒风险:** 15%

## 详情

【POC有效性分析】该提供的POC代码是一个用于重现CVE-2024-3094漏洞环境的Docker化方案。它通过使用特定的Debian实验版本镜像（debian:experimental-20240311），该镜像预装了受污染的xz-utils（版本5.6.0）。Dockerfile配置了基本的SSHD服务，并修改了root密码以便于实验者进入环境观察。README文档详细描述了通过ldd命令检查sshd是否链接到liblzma的步骤，尽管在该特定实验环境中sshd并未直接显示链接（这在某些发行版的动态加载机制下是正常的），但它展示了如何验证系统中存在受损的liblzma5版本。POC中提到的检测脚本poc_detect_backdoor.sh旨在扫描liblzma中的恶意特征字节序列或修改过的符号表。整体而言，该POC是一套优秀的教学与防御研究环境，能有效帮助安全人员理解供应链攻击的植入方式。利用步骤如下：1. 使用提供的Dockerfile构建基础容器镜像；2. 运行容器并映射2222端口；3. 进入容器使用dpkg工具确认liblzma5版本为5.6.0或5.6.1；4. 运行检测脚本分析.so文件中的恶意代码段。虽然此POC不包含远程触发后门的RSA攻击Payload（由于攻击者私钥未公开），但它完整复现了受感染的服务端状态，对于防御性扫描和特征检测研究具有极高价值。【投毒风险分析】针对该POC代码包的深度扫描显示，其投毒风险处于低水平（约15%）。主要风险点在于Dockerfile引用了外部不受控的旧版Debian实验镜像快照，如果该快照被恶意篡改，可能引入额外的风险。然而，POC本身的代码结构（Dockerfile, docker-compose.yaml）是非常透明的，主要操作是安装标准包和修改SSH配置。README中提到的检测脚本逻辑清晰，主要是基于已知签名的静态扫描，未发现混淆代码、外部Shell反弹或未经授权的凭证窃取行为。需要注意的是，任何涉及CVE-2024-3094的实验环境本身就是‘带毒’的（即包含恶意的liblzma），研究人员应严格在隔离的沙箱或虚拟机内部运行此类POC，避免宿主机挂载目录或共用网络，以防潜在的触发风险。该项目更多体现为安全研究工具，而非恶意传播媒介。

**项目地址:** N/A (Provided via local files)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
