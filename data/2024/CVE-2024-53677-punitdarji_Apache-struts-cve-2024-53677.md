## CVE-2024-53677 - Apache Struts RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** RCE

**影响应用:** Apache Struts

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 2.0.0 至 2.5.33, 6.0.0 至 6.3.0.2

**利用条件:** 需要目标应用开启文件上传功能，且未升级至安全修复版本

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞（S2-067）源于Apache Struts文件上传逻辑中的参数覆盖缺陷。攻击者可以通过操作上传参数（如top.UploadFileName）绕过原有的文件命名限制，实现路径遍历。提供的Python POC脚本（exploit.py）利用了`requests_toolbelt`构建多部分编码请求，核心在于通过`top.UploadFileName`参数重写目标路径。视频PoC展示了将恶意的`shell.jsp`上传到Web根目录下，随后通过浏览器访问该文件并成功执行系统命令（如`ls`、`whoami`），证实了该漏洞可直接导致远程代码执行（RCE）。该脚本逻辑清晰，使用了标准的`requests`和`argparse`库，能够针对特定上传端点自动完成路径遍历与文件写入，具有极高的实战有效性和复现成功率。利用步骤：1. 识别目标的Apache Struts上传端点（例如/upload.action）。2. 准备Webshell文件（如jsp shell）。3. 运行exploit.py，指定目标URL、端点路径、待上传文件以及带有路径遍历字符的目标存储位置。4. 访问上传后的Webshell URL以获取服务器控制权。投毒风险分析：该POC项目的风险评级为低。代码主要依赖公开的第三方库（requests, requests_toolbelt），逻辑透明且未经过任何混淆。在`exploit.py`中，文件上传后的验证逻辑`verify_uploaded_file`虽然会自动尝试访问上传的文件，但这是常规的漏洞验证行为，而非恶意隐蔽回传。README中引用的Github项目及Youtube演示视频均来自安全研究人员的公开分享，意在防御性研究。尽管脚本包含远程命令执行功能，但其目的是为了证明漏洞存在，不具备窃取本地敏感信息或自我传播的恶意代码。用户在使用时应注意，任何自动化利用脚本在非授权环境下的运行均存在法律风险，且脚本可能被二次打包修改，建议在隔离的沙箱环境中审计代码后再行使用，以规避潜在的供应链投毒风险。

**项目地址:** [https://github.com/TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
