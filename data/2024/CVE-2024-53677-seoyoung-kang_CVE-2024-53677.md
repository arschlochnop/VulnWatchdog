## CVE-2024-53677 - Apache Struts 2 RCE/任意文件上传/路径穿越

**漏洞编号:** CVE-2024-53677

**漏洞类型:** RCE/任意文件上传/路径穿越

**影响应用:** Apache Struts 2

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Struts 2.0.0 - 2.5.33, Struts 6.0.0 - 6.3.0.2

**利用条件:** 受影响版本中开启了文件上传功能，且未应用S2-067补丁；攻击者需能访问文件上传接口。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞（S2-067）源于Apache Struts 2的文件上传逻辑缺陷。在处理文件上传请求时，攻击者可以通过操纵HTTP参数（例如利用Struts2的参数映射机制修改uploadFileName属性）来注入路径穿越字符。提供的PoC代码展示了这种利用方式：它通过构造一个多部分表单请求，其中包含一个恶意JSP Webshell，并利用'top.UploadFileName'参数将目标路径篡改为上级目录（如'../test.jsp'）。这种方法能绕过原本的文件保存逻辑，将文件写入Web目录，从而实现远程代码执行。从代码结构看，该PoC直接调用requests库发送特定的POST请求，其逻辑清晰，参数定义明确，在未修复的环境下具有极高的利用成功率。利用步骤：1. 识别目标应用中基于Struts 2的文件上传Action（如/upload.action）。2. 准备包含恶意Payload的JSP Webshell内容。3. 构造HTTP POST请求，利用Multipart形式上传文件，关键点在于添加一个名为'top.UploadFileName'或类似映射属性的参数，并将其值设置为指向Web根目录的相对路径（如../../test.jsp）。4. 发送请求并确认服务器返回200状态。5. 通过浏览器或脚本访问上传后的JSP文件，执行系统命令。投毒风险分析：经过对提供的Python脚本（PoC.py及Tool.py片段）进行深度审计，未发现明显的恶意混淆、未授权的外部通信或敏感信息窃取逻辑。PoC.py主要依赖标准的requests和argparse库，其代码行为完全透明，旨在演示文件上传和后续的命令执行验证。虽然脚本中包含执行'id'命令的逻辑，但这属于漏洞验证的标准行为，不应视为投毒。Tool.py中虽然提到了selenium和webdriver，但初步判断是用于环境自动化测试或复杂UI交互的辅助工具，并未发现其有向C2服务器发送数据或执行恶意负载的迹象。总体投毒风险评级为低（15%），主要风险点在于脚本可能在未经授权的情况下执行破坏性操作，但在实验室环境下使用是安全的。建议在使用任何第三方脚本前，务必在隔离的沙箱环境中运行并监控其网络流量。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
