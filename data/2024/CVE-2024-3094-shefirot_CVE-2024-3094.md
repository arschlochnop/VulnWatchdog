## CVE-2024-3094 - XZ Utils / liblzma 供应链攻击/远程代码执行(RCE)

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/远程代码执行(RCE)

**影响应用:** XZ Utils / liblzma

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需安装受污染的xz-utils版本，且通常涉及通过sshd服务触发特定的liblzma调用。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 高

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC项目（shefirot/CVE-2024-3094）并非漏洞本身的构造工具，而是一个针对Kubernetes环境的漏洞复现实验室。它通过部署预先植入后门的容器镜像，模拟了真实的攻击场景。POC核心依赖于'xzbot'工具，该工具通过构造特定的ED448签名数据包来触发liblzma后门中的指令执行流。从代码逻辑看，该POC成功演示了如何绕过标准认证并在受影响的Pod中执行任意命令（如修改/etc/passwd或触发SysRq关机）。这种利用方式证明了CVE-2024-3094在容器化环境中的严重危害：一旦基础镜像被污染，攻击者可以轻易实现集群层面的拒绝服务攻击。利用步骤如下：1. 安装xzbot利用工具；2. 在K8s集群中部署包含受污染liblzma的DaemonSet或Deployment；3. 通过kubectl进行端口转发，将本地2225端口映射到Pod的SSH端口；4. 使用xzbot发送带payload的签名指令到映射地址；5. 验证指令在容器内执行成功（如文件写入或宿主机重启）。【投毒风险分析】该POC项目的投毒风险处于较低水平（约15%）。分析理由如下：首先，项目结构透明，README详尽描述了其教育用途和实验性质，没有隐藏的混淆脚本。其次，项目虽然拉取了外部镜像和第三方Go工具（xzbot），但这些是公开且经过社区审查的漏洞研究工具，并非典型的恶意二进制投毒。需要警惕的是，项目中的YAML文件引用的容器镜像由个人维护者生成，虽然在实验环境下是必要的，但在生产环境或未隔离的测试环境中直接运行此类含有已知后门的镜像具有极高风险。此外，脚本shutdown_nodes.sh具备自动遍历并关停集群节点的能力，虽为功能演示，但在未经授权的情况下执行会导致严重的业务中断。研究员在使用时应确保在完全隔离的Sandbox环境中操作，防止利用逻辑外溢。代码中并未发现典型的自我复制、凭据窃取或反弹Shell到未知C2服务器的行为，其主要逻辑聚焦于漏洞本身的复现验证。综上所述，该POC是合法的安全研究辅助材料，风险主要来自于其模拟的后门环境本身而非代码中的隐藏恶意逻辑。

**项目地址:** [https://github.com/shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
