# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md](../2024/CVE-2024-30088-NextGenPentesters_CVE-2024-30088-.md)

# CVE-2024-30088

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-30088-Admin9961_CVE-2024-30088.md](../2024/CVE-2024-30088-Admin9961_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel 提权漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本和build号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2024-30088) 是一个Windows内核提权漏洞，存在于多个版本的Windows 10, Windows 11 和 Windows Server中。根据漏洞库信息，漏洞类型是CWE-367：Time-of-check Time-of-use (TOCTOU) 竞争条件。CISA的已知被利用漏洞目录中也包含了该漏洞，并标记为活跃利用。CVSS评分为7.0，属于高危漏洞。

漏洞利用代码分析：

提供的Python代码尝试利用该漏洞进行提权，代码主要包括以下几个部分：

1.  **定义Windows API相关的常量和数据结构**：例如 `TOKEN_ALL_ACCESS`, `PROCESS_ALL_ACCESS`, `SYSTEM_HANDLE` 等，以及 `NtQuerySystemInformation`，`OpenProcessToken` 等Windows API的定义和参数类型。
2.  **`GetKernelPointerByHandle` 函数**：该函数通过 `NtQuerySystemInformation` API获取内核句柄信息，遍历进程句柄，查找匹配的句柄，并返回相应的内核对象指针。这是利用竞争条件进行提权的关键步骤。
3.  **`GetPidByName` 函数**：用于通过进程名称获取进程PID。
4.  **代码不完整**: 代码在 `GetPidByName` 函数中途被截断, 缺少 `kernel32.CloseHandle(snapshot)` 结束。

**有效性评估**:

根据CISA KEV 和漏洞库信息，以及提供的利用代码，该漏洞的POC已经被公开，并且存在在野利用。提供的python代码框架完整， 但是代码不完整，无法直接运行。

**投毒风险评估**:

提供的Python脚本代码主要是调用Windows API来查询句柄信息和创建进程等操作，没有发现明显的恶意代码或后门。因此，认为该代码不存在投毒风险。

**利用方式分析**:

该漏洞的利用方式通常涉及以下步骤：

1.  **定位目标进程**: 通过进程名找到目标进程的PID。
2.  **获取目标进程的句柄**: 使用函数如 `OpenProcess` 获取目标进程的句柄。
3.  **利用TOCTOU竞争条件**: 在检查和使用句柄的这段时间内，内核对象的状态发生了改变，导致权限提升。
4.  **创建高权限进程**: 利用提升后的权限创建具有管理员权限的进程，从而实现提权。 

此漏洞通常需要较低的权限（本地访问权限）即可利用。

**项目地址:** [Admin9961/CVE-2024-30088](https://github.com/Admin9961/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #2

**来源**: [CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md](../2024/CVE-2024-30088-Justintroup85_exploits-forsale-collateral-damage.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #3

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #4

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---



---

## POC #4

**来源**: [CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md](../2024/CVE-2024-30088-Zombie-Kaiser_CVE-2024-30088-Windows-poc.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2016, 2019, 2022，具体版本范围参考漏洞库信息。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-30088 是一个 Windows Kernel 中的权限提升漏洞，属于 TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞。攻击者可以利用此漏洞，通过在检查和使用资源之间修改资源状态来获得更高的权限，最终可能获得 SYSTEM 权限。

**有效性：**

从搜索结果来看，该漏洞已被积极利用，并且存在公开的利用案例，因此提供的漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码片段是Apache License 2.0协议，并非漏洞利用代码本身，因此无法直接分析其是否包含恶意投毒代码。因此判断投毒风险为0%。真正的利用代码可能包含恶意行为，需要进行更详细的分析才能确定。

**利用方式：**

1.  攻击者首先需要获得对目标系统的本地访问权限。
2.  攻击者利用 TOCTOU 漏洞，在 Windows Kernel 检查资源状态和使用资源之间的时间窗口内，修改资源的状态。
3.  由于竞争条件，内核在错误的状态下使用资源，导致权限提升。
4.  攻击者利用提升的权限执行恶意代码，控制系统。

根据CISA的KEV目录，此漏洞已被积极利用，因此实际威胁较高。

**项目地址:** [Zombie-Kaiser/CVE-2024-30088-Windows-poc](https://github.com/Zombie-Kaiser/CVE-2024-30088-Windows-poc)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #5

**来源**: [CVE-2024-30088-exploits-forsale_collateral-damage.md](../2024/CVE-2024-30088-exploits-forsale_collateral-damage.md)

## CVE-2024-30088 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-30088

**漏洞类型:** TOCTOU 竞争条件

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致权限提升至 SYSTEM

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, Windows Server 2022等，详见CVE描述中的版本范围。

**利用条件:** 需要本地访问权限和运行Game Script UWP应用，或者使用键盘模拟器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088 是一个 Windows Kernel 的权限提升漏洞，类型为 Time-of-check Time-of-use (TOCTOU) 竞争条件。攻击者可以利用此漏洞将权限提升至 SYSTEM。

**有效性评估：**

根据搜索引擎结果，此漏洞已被APT34等组织利用，且CISA KEV目录中也包含了此漏洞，表明该漏洞在野外已被积极利用。提供的PoC代码专门针对Xbox SystemOS，但是也表明漏洞本身是真实存在且可以被利用的。

**投毒风险分析：**

查看提供的 PoC 代码，主要文件包括 LICENSE, README.md, 和一些二进制文件，例如 `stage2.bin`和`run.exe`, 以及游戏脚本。`gamescript_autosave_network.txt`等

*   LICENSE：MIT 许可证，没有投毒风险。
*   README.md：描述了漏洞利用方法和注意事项，没有投毒风险。
*   `gamescript_autosave_network.txt`：包含用于在 Game Script 应用中执行的代码，需要修改 IP 地址。如果IP地址被篡改，可能导致反弹shell连接到错误的地址，存在一定风险。
*   `stage2.bin`和 `run.exe`：二进制文件，需要进一步分析才能确定是否包含恶意代码，但在未分析之前，认为存在一定风险。

总体来看，仓库中直接包含恶意代码的可能性较低，但存在一些潜在的风险点，例如被篡改的 IP 地址和未经分析的二进制文件。
综合评估，投毒风险为10%。

**利用方式：**

1.  利用 Game Script UWP 应用作为初始入口点。
2.  通过 Game Script 应用加载和执行恶意代码。
3.  利用 TOCTOU 竞争条件漏洞提升权限至 Kernel。
4.  在 SYSTEM 权限下执行 payload，例如反弹 shell。
5.  具体步骤包括：修改`gamescript_autosave_network.txt` 中的IP地址，将`stage2.bin` 和`run.exe` 部署到目标设备，然后运行 Game Script 应用执行攻击。

该PoC主要是用于Xbox环境,因此存在一定的局限性,但是利用方式可以借鉴.

**项目地址:** [exploits-forsale/collateral-damage](https://github.com/exploits-forsale/collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

## POC #6

**来源**: [CVE-2024-30088-tykawaii98_CVE-2024-30088.md](../2024/CVE-2024-30088-tykawaii98_CVE-2024-30088.md)

## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可导致系统权限提升

**影响版本:** 受影响的Windows版本和版本号范围在漏洞库信息中已列出

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-30088是一个Windows内核权限提升漏洞，是由于AuthzBasepCopyoutInternalSecurityAttributes函数在将当前令牌对象的_AUTHZBASEP_SECURITY_ATTRIBUTES_INFORMATION复制到用户模式时存在TOCTOU（Time-of-check Time-of-use）竞态条件漏洞。攻击者可以通过竞态条件修改安全属性名称的缓冲区指针，从而实现任意地址写入。

**有效性评估：**

*   根据搜索结果和POC描述，此漏洞已被APT34等组织利用，CISA KEV目录也已收录，表明该漏洞存在真实利用案例。
*   POC代码描述了漏洞原理，并提供了触发漏洞的方法（调用NtQueryInformationToken）。
*   补丁分析也表明了微软修复了该TOCTOU漏洞。
*   因此，提供的POC代码很可能有效。

**投毒风险评估：**

*   提供的文件包括一个README.md和一个Visual Studio解决方案文件(.sln)。
*   README.md文件包含漏洞描述、触发方式、补丁说明以及POC视频链接，看起来比较规范。
*   .sln文件是Visual Studio的项目文件，通常本身不包含可执行代码。投毒代码可能隐藏在POC的源代码中，例如，作者可能在利用过程中故意引入错误，使得POC在某些情况下破坏系统，或者植入后门。
*   由于缺乏实际的POC代码，只能假设存在一定的风险。需要仔细检查POC的源代码才能确定是否存在投毒代码。考虑到攻击者通常会将漏洞利用代码作为初始访问点，直接投毒的可能性较低，但不能完全排除。
*   **风险评估：** 10%。该评估基于没有检查源代码的情况下的粗略评估，需要进一步分析代码以确认是否存在恶意代码。

**利用方式：**

1.  **漏洞触发：** 通过调用NtQueryInformationToken函数，并指定TokenAccesInformation类来触发漏洞。
2.  **竞态条件：** 创建一个竞争线程，该线程的目标是在RtlCopyUnicodeString函数调用之前修改安全属性名称的缓冲区指针。
3.  **任意地址写入：** 利用竞态条件，攻击者可以将任意值写入任意地址，通常用于提升权限，例如修改进程令牌等。
4.  **权限提升：** 利用任意地址写入能力，攻击者可以提升当前进程的权限到SYSTEM级别。

**项目地址:** [tykawaii98/CVE-2024-30088](https://github.com/tykawaii98/CVE-2024-30088)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)

---

