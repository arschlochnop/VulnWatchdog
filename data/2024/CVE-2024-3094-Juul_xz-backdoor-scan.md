## CVE-2024-3094 - xz-utils (liblzma) 供应链攻击/后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma)

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需安装受影响版本的xz-utils/liblzma库，且通常涉及通过sshd进行远程触发。

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (检测工具)

**攻击复杂度:** 高

**投毒风险:** 5%

## 详情

【POC有效性分析】该提供的POC代码并非攻击载体，而是一个名为‘xz-backdoor-scan’的防御性检测工具。该工具由‘stderr’编写，旨在通过扫描二进制文件中的特定特征码（Signature）来识别是否存在CVE-2024-3094后门。代码结构清晰，包含Makefile构建脚本、主程序main.c以及专门的扫描逻辑scan-file.c。其核心原理是利用mmap将目标文件映射到内存，然后搜索已知的后门指令序列。经过分析，该工具具有较高的检测有效性，能够快速遍历文件系统并识别被污染的liblzma库。它并非利用漏洞，而是帮助安全管理员进行应急响应和漏洞核查的实用脚本。利用步骤如下：1. 使用make编译生成可执行文件；2. 运行./xz-backdoor-scan后跟待测库文件路径；3. 查看输出结果，若显示‘CONTAINS THE SIGNATURE’则表示该文件极大概率包含恶意后门代码。【投毒风险分析】本POC代码的投毒风险极低。首先，代码逻辑完全透明，主要使用标准C库函数（如fcntl.h, mman.h, stdio.h）进行文件读取和内存比对，未发现任何混淆代码或隐蔽的网络通信逻辑。其次，README文档明确标注了作者身份（stderr）及其社交媒体联系方式，增加了可信度。代码中包含的警告信息‘Do not trust this program to be correct’是典型的开发者免责声明，而非恶意诱导。虽然该工具使用了AGPLv3开源协议且需要编译执行，但其Makefile和源文件中不存在恶意预处理指令或第三方不明链接。扫描器本身不具备修改系统文件的功能，仅进行只读扫描。对于安全研究员而言，在受控环境下编译此代码是安全的，不会引入二次感染。唯一需要注意的是，这类检测工具可能被恶意攻击者篡改后发布在非官方渠道，因此建议仅从原始可信的GitHub仓库下载。总体而言，该代码是合法的安全辅助工具，其恶意投毒概率基本为零。

**项目地址:** [https://github.com/juul/xz-backdoor-scan](https://www.google.com/search?q=https://github.com/juul/xz-backdoor-scan) (参考项目)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
