# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md](../2024/CVE-2024-45496-0xSigSegv0x00_cve-2024-45496.md)

# CVE-2024-45496

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #2

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---



---

## POC #2

**æ¥æº**: [CVE-2024-45496-fatcatresearch_cve-2024-45496.md](../2024/CVE-2024-45496-fatcatresearch_cve-2024-45496.md)

## CVE-2024-45496-Openshift-controller-manager-Node Compromise

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** Openshift-controller-manager

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹è¢«å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= version <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å‘è€…æƒé™

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-45496 æ˜¯ OpenShift Container Platform ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™æå‡æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨å¼€å‘è€…æƒé™ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­åˆ©ç”¨ git-clone å®¹å™¨çš„ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæœ€ç»ˆå¯¼è‡´ worker èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ‹¥æœ‰ OpenShift çš„å¼€å‘è€…æƒé™ã€‚
2.  æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ã€‚
3.  è¯¥ .gitconfig æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  å½“ OpenShift æ„å»ºæœåŠ¡å…‹éš†è¯¥ä»“åº“æ—¶ï¼Œgit-clone å®¹å™¨ä¼šæ‰§è¡Œ .gitconfig æ–‡ä»¶ä¸­æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
5.  ç”±äº git-clone å®¹å™¨å…·æœ‰ç‰¹æƒå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¿™äº›å‘½ä»¤åœ¨ worker èŠ‚ç‚¹ä¸Šä»¥æå‡çš„æƒé™æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹è¢«æ”»é™·ã€‚

**POC ä»£ç åˆ†æï¼š**

æä¾›çš„ Dockerfile ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¶æ„ä»£ç ï¼Œè€Œæ˜¯è®¾ç½® git çš„å…¨å±€ include.path åˆ°ä¸€ä¸ªå›ºå®šçš„ä½ç½® `/etc/gitconfig/.gitconfig`ã€‚è¿™ä¸ªè®¾ç½®æœ¬èº«ä¸æ˜¯æ”»å‡»ï¼Œè€Œæ˜¯ä¸ºæ”»å‡»åˆ›é€ æ¡ä»¶ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æˆ–ä¿®æ”¹ `/etc/gitconfig/.gitconfig` çš„å†…å®¹ï¼Œæ‰èƒ½æ‰§è¡Œæ¶æ„ä»£ç ã€‚

Dockerfile ä¸­åç»­çš„ git init å’Œ git status åªæ˜¯ä¸ºäº†è§¦å‘ git çš„é…ç½®è¯»å–ã€‚

æœ€åï¼ŒDockerfile ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `/tmp/configmap_seen` æ–‡ä»¶ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†éªŒè¯é…ç½®æ˜¯å¦è¢«æ­£ç¡®è¯»å–ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯´æ˜é…ç½®è¯»å–å¤±è´¥ï¼Œæ”»å‡»å¯èƒ½æ— æ³•æˆåŠŸã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æä¾›çš„ POC ä»£ç æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œçš„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨ç›´æ¥çš„æŠ•æ¯’é£é™©ã€‚å®ƒä»…ä»…æ˜¯è®¾ç½®äº†ä¸€ä¸ª git é…ç½®ï¼Œå¹¶å°†å‘½ä»¤æ‰§è¡Œä¾èµ–äºå¤–éƒ¨çš„`/etc/gitconfig/.gitconfig` æ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚


**é¡¹ç›®åœ°å€:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

## POC #3

**æ¥æº**: [CVE-2024-45496-pwnc4t_cve-2024-45496.md](../2024/CVE-2024-45496-pwnc4t_cve-2024-45496.md)

## CVE-2024-45496-OpenShiftèŠ‚ç‚¹æƒé™æå‡

**æ¼æ´ç¼–å·:** CVE-2024-45496

**æ¼æ´ç±»å‹:** æƒé™æå‡

**å½±å“åº”ç”¨:** OpenShift Container Platform

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.12.0 <= ç‰ˆæœ¬ <= 4.18.0

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å…·æœ‰å¼€å‘äººå‘˜æƒé™çš„OpenShiftè´¦æˆ·

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-45496 å­˜åœ¨äº OpenShift Container Platform çš„æ„å»ºè¿‡ç¨‹ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ .gitconfig æ–‡ä»¶ï¼Œåœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæå‡åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šçš„æƒé™ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Dockerfile é…åˆæ¼æ´æè¿°æœ‰æ•ˆï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨`git clone`æ“ä½œä¸­çš„`.gitconfig`æ–‡ä»¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚Dockerfile å¯ä»¥ç”¨äºæ„å»ºåŒ…å«æ¶æ„ `.gitconfig` æ–‡ä»¶çš„é•œåƒï¼Œå½“è¯¥é•œåƒåœ¨ OpenShift ä¸­ç”¨äºæ„å»ºä»»åŠ¡æ—¶ï¼Œå°†è§¦å‘æ¼æ´ï¼Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»…ä» Dockerfile æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡ŒæŠ•æ¯’ï¼š
1.  **æ„å»ºè¿‡ç¨‹ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ Dockerfile ä¸­æ·»åŠ é¢å¤–çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
2.  **åˆ©ç”¨åŸºç¡€é•œåƒæ¼æ´ï¼š** å¦‚æœ Dockerfile åŸºäºå­˜åœ¨å·²çŸ¥æ¼æ´çš„åŸºç¡€é•œåƒï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥æ„å»ºé•œåƒçš„æºä»£ç å’Œä¾èµ–é¡¹ï¼Œæ‰èƒ½æ›´å‡†ç¡®è¯„ä¼°æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **åˆ›å»ºåŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªåŒ…å« `.gitconfig` æ–‡ä»¶çš„ Git ä»“åº“ï¼Œè¯¥æ–‡ä»¶åŒ…å«åœ¨ git clone è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤çš„é…ç½®ã€‚
2.  **åˆ›å»º OpenShift æ„å»ºé…ç½®ï¼š** æ”»å‡»è€…åˆ›å»ºä¸€ä¸ª OpenShift æ„å»ºé…ç½®ï¼Œè¯¥é…ç½®æŒ‡å®šä½¿ç”¨åŒ…å«æ¶æ„ .gitconfig æ–‡ä»¶çš„ Git ä»“åº“ä½œä¸ºæ„å»ºæºã€‚
3.  **è§¦å‘æ„å»ºï¼š** æ”»å‡»è€…è§¦å‘ OpenShift æ„å»ºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgit clone å‘½ä»¤ä¼šè¯»å–æ¶æ„ .gitconfig æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹æƒé™æå‡ã€‚
4.  **æƒé™æå‡ï¼š** æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ„å»ºèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [pwnc4t/cve-2024-45496](https://github.com/pwnc4t/cve-2024-45496)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)

---

