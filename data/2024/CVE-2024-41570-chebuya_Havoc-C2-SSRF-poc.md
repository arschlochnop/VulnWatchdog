# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md](../2024/CVE-2024-41570-chebuya_Havoc-C2-SSRF-poc.md)

# CVE-2024-41570

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md](../2024/CVE-2024-41570-HimmeL-Byte_CVE-2024-41570-SSRF-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，允许未授权的攻击者从团队服务器发送任意网络流量，可能导致内网信息泄露、远程代码执行等。

**影响版本:** 0.7

**利用条件:** Havoc C2 团队服务器监听端口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 0.7 版本中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。攻击者可以利用此漏洞，通过精心构造的请求，使 Havoc C2 团队服务器向任意目标发起请求。\n\n**利用方式：**\n
1.  **Agent 注册 (绕过身份验证)**：攻击者通过发送恶意的 agent 注册请求，模拟一个 demon 代理。该注册流程可以绕过原有的身份验证机制。\n2.  **Socket 操作 (SSRF 触发)**：注册成功后，攻击者可以利用该“代理”发起 socket 操作，例如打开 socket，写入数据，从 socket 读取数据。攻击者通过控制目标地址和端口，使团队服务器向指定目标（如内网服务）发起连接。\n3.  **数据交互**:  可以通过 socket 写入任意数据，实现对内网服务的攻击，读取 socket 可以获得请求的结果，实现内网信息收集等功能。\n
**POC 分析：**\n
提供的 POC 代码 (`exploit.py`) 主要包含以下功能：\n
*   **加密/解密：** 使用 AES 加密算法与团队服务器进行通信。\n*   **Agent 注册：** 伪造 agent 注册信息，绕过身份验证。\n*   **Socket 操作：**  实现打开 socket (`open_socket`)、写入 socket (`write_socket`)、读取 socket (`read_socket`) 等操作。\n*   **利用流程：**脚本首先注册一个恶意的 agent，然后使用 `open_socket` 函数在 teamserver 上打开一个socket，并使用`write_socket`函数向该socket写入数据，从而触发 SSRF 漏洞\n\n**投毒风险分析：**\n
查看 `README.md` 文件, 脚本给出的payload执行方式为`python3 exploit.py --target https://10.10.11.49/ -i 127.0.0.1 -p 40056`, 其中 `-i` 指定了目标机器的ip地址，`-p` 指定了目标机器的端口号，可以向该ip发送任意请求\n
`exploit.py` 脚本中存在以下潜在的投毒风险：\n
*   **硬编码/可控参数：** 脚本中包含多个硬编码的参数，如 agent_id，command等，这些参数如果被恶意修改，可能会导致利用失败或其他未知问题。不过脚本提供`-i`和`-p`参数，可以修改攻击的目标ip和端口，实现恶意的攻击。\n*   **依赖库：**  脚本依赖 `requests` 和 `pycryptodome` 库。如果这些库被恶意篡改，可能会导致安全问题。\n*  **后门代码:**  未发现明显的后门代码，但考虑到代码逻辑的复杂性，以及可能存在的隐藏漏洞，仍然存在一定的投毒风险。`print(agent_header + header_data)`暴露请求，有助于分析流量，但是也可能在调试时泄露信息。  `urllib3.disable_warnings()` 会忽略SSL证书验证，若目标存在中间人攻击，可能存在风险。\n
综合考虑，此POC代码存在一定的投毒风险，但主要集中在参数可控，以及依赖库的安全性上。实际使用时，需要仔细审查代码，并确保依赖库的来源可信。

**项目地址:** [HimmeL-Byte/CVE-2024-41570-SSRF-RCE](https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #2

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #3

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---



---

## POC #3

**来源**: [CVE-2024-41570-kit4py_CVE-2024-41570.md](../2024/CVE-2024-41570-kit4py_CVE-2024-41570.md)

## CVE-2024-41570 - Havoc C2 未授权SSRF漏洞

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致信息泄露、内网渗透、远程代码执行

**影响版本:** 2 0.7 及 c2_0.74

**利用条件:** 目标Havoc C2服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc C2 (版本 2 0.7 和 c2_0.74) 中存在的一个未经身份验证的服务器端请求伪造（SSRF）漏洞。该漏洞位于demon callback处理中，允许未经授权的攻击者从团队服务器发送任意网络流量。根据提供的漏洞利用代码(exploit.py和README.md)，该漏洞可以通过以下步骤利用：

1.  **漏洞利用方式：**
    *   **注册Agent:** 伪造一个demon agent注册并进行checkin。
    *   **建立WebSocket连接:** 利用WebSocket与Havoc C2服务器建立连接，发送握手和认证payload。
    *   **RCE:** 利用建立的WebSocket连接，执行远程命令，实现反向Shell。

2.  **有效性：**
    *   根据提供的漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。
    *   漏洞利用代码描述清晰，提供了必要参数和使用示例。
    *   GitHub上的POC代码仓库(thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE 和 kit4py/CVE-2024-41570)进一步验证了漏洞的可利用性。
    *   因此，提供的POC代码被认为是有效的。

3.  **投毒风险：**
    *   该POC的README.md 明确指出，使用该脚本必须经过授权，并且不得违反法律和道德规范。但是依旧存在代码投毒的风险。
    *   分析 `exploit.py` 文件，主要功能是实现 SSRF 漏洞的利用和反向 shell 的建立。尽管代码中没有明显的恶意代码，但依然存在潜在的风险。
    *   代码中的 `HEADERS = {"User-Agent": ""}` 存在潜在的风险，虽然User-Agent目前为空，但作者可以后续更新版本添加恶意User-Agent头，配合其他漏洞进行攻击
    *   总的来说，投毒风险较低（大约 10%），因为该PoC主要依赖于 SSRF 漏洞本身，而没有明显植入恶意后门代码。但仍需谨慎使用，并仔细审查代码，尤其注意从不受信任的来源获取的代码。

为了避免投毒，建议：
    *   从可信赖的来源获取漏洞利用代码。
    *   在使用前，仔细审查代码，尤其注意可疑的函数调用和网络请求。
    *   在隔离环境中测试漏洞利用代码。


**项目地址:** [kit4py/CVE-2024-41570](https://github.com/kit4py/CVE-2024-41570)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #4

**来源**: [CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md](../2024/CVE-2024-41570-sebr-dev_Havoc-C2-SSRF-to-RCE.md)

## CVE-2024-41570-Havoc C2-SSRF+RCE

**漏洞编号:** CVE-2024-41570

**漏洞类型:** SSRF+RCE

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致服务器信息泄露，远程代码执行，以及发起对内网的攻击

**影响版本:** 0.7

**利用条件:** 需要能够访问Havoc C2的监听端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-41570是Havoc C2 0.7版本中存在的一个未经身份验证的服务器端请求伪造(SSRF)漏洞。根据漏洞描述和搜索结果，攻击者可以通过伪造Demon代理注册和checkins，在Teamserver上打开TCP socket，并从中读取/写入数据。这使得攻击者可以从Teamserver发起任意网络流量，例如扫描内网、访问Teamserver内部资源。结合代码来看, 在注册代理时, 大部分参数可控, 从而达到控制后续socket的目的。

**漏洞利用方式：**

1.  **SSRF利用：** 攻击者发送特制的请求到Havoc C2 Teamserver的监听端口，利用未授权的Demon回调处理功能，指定Teamserver向任意目标发起请求。
2.  **RCE利用 (Authenticated):** github上thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE给出了RCE的方案，该方案需要结合SSRF才能触发RCE漏洞, 需要认证。

**有效性评估：**

提供的POC代码根据commit记录和描述，实现了SSRF漏洞的利用，可以模拟Demon代理注册并打开Socket进行通信，从而验证了漏洞的存在和可利用性。

**投毒风险评估：**

POC代码本身看起来是用于验证和利用漏洞的，主要功能是构造恶意请求。但是由于代码中包含大量的网络请求以及加密解密操作，存在以下几点潜在的投毒风险：

*   **恶意依赖：** 虽然代码中只使用了常用的requests和pycryptodome库，但仍然存在被替换为恶意版本的风险，例如通过PyPI投毒。
*   **后门代码：** 作者可以在代码中插入隐蔽的后门，例如在发送请求前执行一段恶意代码，或者在处理响应时植入webshell。 本代码中并未发现明显的后门代码。
*   **资源消耗：** 攻击者可能恶意修改代码，使其在运行过程中消耗大量资源，导致拒绝服务攻击。

总体来说，代码的投毒风险较低，但仍需要保持警惕，建议在使用前仔细审查代码，并从可信的来源获取依赖。


**项目地址:** [sebr-dev/Havoc-C2-SSRF-to-RCE](https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

## POC #5

**来源**: [CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md](../2024/CVE-2024-41570-thisisveryfunny_CVE-2024-41570-Havoc-C2-RCE.md)

## CVE-2024-41570-Havoc-C2-SSRF

**漏洞编号:** CVE-2024-41570

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Havoc C2

**危害等级:** 高危，可能导致敏感信息泄露、内网探测、远程代码执行

**影响版本:** 0.7

**利用条件:** 无需认证，可直接从公网触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-41570 是 Havoc 2 0.7 版本中 Demon 回调处理中存在的一个未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞从 Teamserver 发送任意网络流量。根据搜索结果，已经有公开的PoC代码可用，可以通过伪造 Demon 代理注册和check-in来利用该漏洞，在 Teamserver 上打开 TCP socket，并从其中读取/写入数据，从而泄露 Teamserver 的源 IP 等敏感信息，甚至可以进一步利用 SSRF 漏洞传递经过身份验证的命令注入 payload 实现RCE。

**漏洞利用方式:**

1.  攻击者发送恶意请求到 Havoc C2 Teamserver 的 Demon 回调处理接口。
2.  该请求伪造 Demon 代理注册和check-in，诱使 Teamserver 与攻击者控制的服务器建立连接。
3.  攻击者通过该连接读取 Teamserver 内部网络的信息，或向内部服务发送请求。
4.  攻击者可以利用此 SSRF 漏洞，结合 Havoc 本身存在的其他漏洞（如默认配置导致的弱口令问题和命令注入漏洞），实现更高级别的攻击，例如远程代码执行。

**投毒风险分析:**

代码中存在变量IP,USER,PASSWORD,Payload.sh这些变量容易引导使用者修改，并可能指向恶意地址。存在一定的投毒风险。因为需要使用者自己去搭建一个http server提供payload下载,这个过程也容易被投毒。总体投毒风险较低。

**有效性评估:**

根据CVE描述和github上的poc代码分析，可以利用该漏洞进行SSRF攻击。PoC代码提供了注册代理、打开Socket、写入Socket等函数，模拟了完整的攻击流程。因此，提供的 PoC 代码是有效的。


**项目地址:** [thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE](https://github.com/thisisveryfunny/CVE-2024-41570-Havoc-C2-RCE)

**漏洞详情:** [CVE-2024-41570](https://nvd.nist.gov/vuln/detail/CVE-2024-41570)

---

