# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-0xDTC_js2py-Sandbox-Escape-CVE-2024-28397-RCE.md)

# CVE-2024-28397

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-28397-0timeday_exploit-js2py.md](../2024/CVE-2024-28397-0timeday_exploit-js2py.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #2

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #3

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---



---

## POC #3

**来源**: [CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md](../2024/CVE-2024-28397-0xPadme_CVE-2024-28397-Reverse-Shell.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #4

**来源**: [CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-CYBER-WARRIOR-SEC_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要安装了js2py库，并且在python环境中执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入/沙箱逃逸漏洞。该漏洞源于js2py在处理全局变量时存在缺陷，允许攻击者在JS代码中获取对Python对象的引用，从而绕过js2py.disable_pyimport()的限制，逃逸JS沙箱并在主机上执行任意代码。攻击者可以通过构造恶意的JS代码，利用此漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要找到使用js2py库解析JavaScript代码的应用程序。
2.  攻击者构造包含恶意代码的JavaScript文件，例如，利用全局变量漏洞获取Python对象引用，并执行系统命令。
3.  应用程序使用js2py库解析该恶意JavaScript代码。
4.  恶意代码利用漏洞绕过沙箱限制，在主机上执行任意命令，例如`head -n 1 /etc/passwd`来验证漏洞，或者执行其他恶意操作。

**有效性：**

根据提供的漏洞信息和POC代码描述，该POC代码是有效的。`affected_version_test.txt`文件记录了在不同Python版本上，利用该漏洞执行`head -n 1 /etc/passwd`命令成功的案例。POC代码可以成功绕过沙箱限制，在主机上执行任意命令。

**投毒风险：**

评估该仓库的投毒风险为10%。理由如下：

1.  `README.md`和`README_zh.md`文件提供了漏洞的详细描述，重现步骤和修复方法，较为清晰完整。
2.  `affected_version_test.txt`文件包含了在不同python版本下的测试结果，证明了该漏洞的存在。
3.  作者在`README.md`文件中提到，在发现漏洞后已向官方仓库提交PR，但PR长期未被处理，才选择公开POC和修复方案，说明作者的目的是为了推动漏洞修复，而非恶意传播。

然而，仍然存在一定的投毒风险：

1.  攻击者可能修改`poc.py`文件，将其中执行的命令替换为更具破坏性的恶意代码。
2.  攻击者可能在`fix.py`文件中添加后门代码，诱导用户使用包含后门的修复方案。

**项目地址:** [CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/CYBER-WARRIOR-SEC/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #5

**来源**: [CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md](../2024/CVE-2024-28397-ExtremeUday_Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #6

**来源**: [CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Marven11_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #7

**来源**: [CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md](../2024/CVE-2024-28397-Naved124_CVE-2024-28397-js2py-Sandbox-Escape.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要可以调用js2py.disable_pyimport()接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-28397是js2py库中存在的一个代码注入漏洞，影响版本<=0.74。漏洞位于js2py.disable_pyimport()组件中，允许攻击者通过构造特制的API调用执行任意代码，实现沙箱逃逸。根据搜索结果，该漏洞影响广泛，可能导致数百万Python用户面临远程代码执行风险。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞的PoC是可用的，并且在GitHub上存在公开的利用代码。

**投毒风险：**
提供的漏洞利用代码只有LICENSE和Acknowledgements.md文件，并未看到直接的恶意代码。 Acknowledgements.md提到了对原始中文研究的英文翻译和分析，并声明了PoC代码的消毒处理和仅供研究演示。 仓库所有者声明了免责声明，这减少了直接投毒的可能性。但是，由于翻译可能存在偏差，且演示代码可能被修改后用于恶意目的，因此存在一定的投毒风险，估计为20%。

**利用方式：**
利用方式是攻击者通过精心构造的API调用，利用js2py的`disable_pyimport()`函数中的漏洞，获得对python对象的引用， 进而执行任意Python代码，从而绕过js2py的沙箱限制。 具体利用细节需要分析原始PoC代码，但总体思路是利用js2py本身的功能缺陷来实现代码注入。

**项目地址:** [Naved124/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Naved124/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #8

**来源**: [CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-harutomo-jp_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-代码注入

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标服务器运行js2py且允许POST请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py v0.74 之前的版本中。该漏洞允许攻击者通过构造恶意的 API 调用，执行任意代码。具体而言，漏洞存在于 `js2py.disable_pyimport()` 组件中，攻击者可以通过此函数获取对 Python 对象的引用，并利用该引用来执行任意 Python 代码，从而绕过沙箱。提供的 POC 代码通过构造包含恶意 JavaScript 代码的 JSON payload，并将其 POST 到目标服务器的指定 endpoint 触发漏洞，从而实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码利用 JavaScript 构造 Python 代码执行链，绕过 js2py 的沙箱限制，成功执行系统命令。从 github 仓库的标题也可确认 POC 的存在，搜索引擎结果中也有大量关于该漏洞的信息。

**投毒风险：**
分析提供的 POC 代码和 README 文件，没有发现明显的投毒代码。代码逻辑清晰，目的是利用漏洞实现远程代码执行，而非植入恶意后门或执行其他恶意行为。作者只是提供了一个漏洞利用脚本，该仓库中不存在作者隐藏的投毒代码, 投毒风险为 0%。

**利用方式：**
1.  **目标确定：** 确定存在漏洞的 js2py 应用服务器的 IP 地址和 endpoint 路径。
2.  **Payload 构造：** 构造包含恶意 JavaScript 代码的 JSON payload。这段 JavaScript 代码会利用 `js2py.disable_pyimport()` 函数或其它方式获取对 Python 对象的引用，然后利用该引用执行任意 Python 代码。
3.  **发送请求：** 使用 POST 请求将 payload 发送到目标服务器的 endpoint。请求头需要设置 `Content-Type: application/json`。
4.  **执行命令：** 目标服务器上的 js2py 代码会解析 payload 中的 JavaScript 代码并执行，从而执行攻击者预先设定的恶意 Python 代码，实现远程代码执行。
5.  **反弹 Shell (可选)：**  如果需要反弹 shell，可以在 payload 中设置反弹 shell 的命令，并将攻击机的 IP 地址和端口号填入 payload。或者通过 `--cmd` 参数指定要执行的命令。

**项目地址:** [harutomo-jp/CVE-2024-28397-RCE](https://github.com/harutomo-jp/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #9

**来源**: [CVE-2024-28397-naclapor_CVE-2024-28397.md](../2024/CVE-2024-28397-naclapor_CVE-2024-28397.md)

## CVE-2024-28397-js2py沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 沙箱逃逸/远程代码执行

**影响应用:** js2py

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 0.74

**利用条件:** 需要目标应用使用js2py库并且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py <= 0.74版本中的一个沙箱逃逸漏洞。攻击者可以通过精心构造的JavaScript代码，利用js2py的缺陷，绕过沙箱环境的限制，执行任意Python代码甚至系统命令。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。POC代码清晰地展示了如何通过JavaScript访问Python对象层级结构，找到`subprocess.Popen`类，并利用它执行任意命令。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的POC。

**投毒风险分析：**

在提供的POC代码中，主要的投毒风险来自于`exploit.py`脚本中的目标URL和反向shell的IP地址和端口。如果攻击者将恶意payload注入到目标环境中，并诱导用户使用该payload，则存在潜在的风险。

此外，虽然`LICENSE`文件和`README.md`文件本身不包含恶意代码，但攻击者可能会修改这些文件，添加误导性信息或隐藏的payload。

对当前提供的仓库进行分析，认为存在10%的投毒风险。该风险主要体现在，如果攻击者修改了`exploit.py`脚本，植入恶意代码，或者通过其他方式，使用户在不知情的情况下执行恶意操作，则存在潜在的风险。

**漏洞利用方式：**

1.  **利用JavaScript反射机制：** POC代码利用了JavaScript的反射机制，通过`Object.getOwnPropertyNames({}).__class__.__base__.__getattribute__`访问Python的`object`基类。
2.  **遍历Python对象层级结构：** 通过`__subclasses__()`方法，递归地遍历Python对象层级结构，寻找`subprocess.Popen`类。
3.  **执行任意命令：** 找到`subprocess.Popen`类后，创建一个新的进程来执行恶意的反向shell命令。
4.  **建立反向Shell连接：** 通过执行反向shell命令，攻击者可以在目标系统上建立一个反向shell连接，从而完全控制目标系统。

**项目地址:** [naclapor/CVE-2024-28397](https://github.com/naclapor/CVE-2024-28397)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #10

**来源**: [CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md](../2024/CVE-2024-28397-nelissandro_CVE-2024-28397-Js2Py-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #11

**来源**: [CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md](../2024/CVE-2024-28397-vitaciminIPI_CVE-2024-28397-RCE.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行js2py并且存在可访问的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py 0.74版本及以前存在的一个沙箱逃逸漏洞。攻击者可以通过精心构造的API调用，利用`js2py.disable_pyimport()`组件中的问题，在Python环境中执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码来看，此POC是有效的，可以实现远程代码执行。

**投毒风险：**
查看`exploit.py`代码，主要功能是从用户处获取host、port、cmd、session，然后构造HTTP请求，将包含恶意JavaScript代码的payload发送到目标服务器的`/run_code`接口。Payload使用JavaScript代码来查找Python的subprocess.Popen类，然后使用它来执行用户提供的命令。投毒风险分析：
*   **输入参数：** 代码中存在输入参数(host, port, cmd, session),cmd参数用于远程代码执行，如果攻击者提供的cmd参数本身包含恶意代码，那么可以认为存在投毒，但此处的投毒行为应有使用者承担。
*   **网络请求：** 代码会向指定host和port发起网络请求，如果被替换为恶意的host，存在信息泄露或中间人攻击的风险。
*   **Payload本身：** Payload的功能是查找subprocess.Popen并执行命令，这本身就是恶意操作。将Payload集成到自动化利用框架中存在风险。
因此，存在一定的投毒风险，评估为10%。风险主要来自于使用者利用该脚本进行攻击或将包含该漏洞利用的js2py项目集成到更大的项目中。

**利用方式：**
1.  攻击者需要知道目标服务器的host和port。
2.  攻击者需要知道目标服务器的`session`。
3.  攻击者提供要执行的命令（`cmd`）。
4.  漏洞利用脚本构造包含恶意JavaScript代码的payload，该payload的核心是利用JavaScript查找Python的`subprocess.Popen`类。
5.  脚本通过HTTP POST请求将payload发送到目标服务器的`/run_code`接口。
6.  目标服务器执行payload中的JavaScript代码，进而执行攻击者提供的命令。
7.  执行结果通过HTTP响应返回给攻击者。

此漏洞的根本原因是js2py在处理JavaScript代码时，未能正确地隔离Python环境，导致攻击者可以绕过沙箱限制，从而执行任意Python代码。 通过`js2py.disable_pyimport()`组件进行利用。

**项目地址:** [vitaciminIPI/CVE-2024-28397-RCE](https://github.com/vitaciminIPI/CVE-2024-28397-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

## POC #12

**来源**: [CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md](../2024/CVE-2024-28397-waleed-hassan569_CVE-2024-28397-command-execution-poc.md)

## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要应用程序使用存在漏洞版本的js2py且解析用户可控的JavaScript/JSON。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于js2py 0.74及更早版本中，源于 js2py.disable_pyimport() 组件中不完整的沙箱机制。攻击者可以利用该漏洞，通过构造恶意的JavaScript代码，访问Python的内部对象模型，最终获取到危险类如 subprocess.Popen，从而执行任意命令。

**漏洞利用方式：**

1.  **目标应用场景：** 应用程序使用 js2py 来解析或执行用户提供的 JavaScript 或 JSON 数据。
2.  **漏洞触发：** 攻击者提供恶意的 JavaScript 代码。
3.  **沙箱逃逸：**  POC 代码通过 `__class__`, `__base__`, 和 `__subclasses__()` 等方法，遍历 Python 的对象图，定位到 `subprocess.Popen` 类。
4.  **命令执行：**  使用 `subprocess.Popen` 执行任意操作系统命令。
5.  **结果返回：**  将命令执行的结果以字符串形式返回，确保 JSON 安全。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码展示了如何绕过沙箱，执行任意命令。

**投毒风险：**

分析提供的PoC代码 `payload.js` 和 `README.md` 文件，未发现明显的投毒代码。PoC 代码的功能明确，目的是利用漏洞执行命令。 `README.md` 文件仅包含漏洞描述、利用方式和参考链接。

**总结：**

CVE-2024-28397 是 js2py 中的一个高危漏洞，允许攻击者通过精心构造的 JavaScript 代码绕过沙箱，执行任意命令。应用程序如果使用存在漏洞的 js2py 版本，并且处理用户可控的 JavaScript 或 JSON 数据，则容易受到攻击。

**项目地址:** [waleed-hassan569/CVE-2024-28397-command-execution-poc](https://github.com/waleed-hassan569/CVE-2024-28397-command-execution-poc)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)

---

