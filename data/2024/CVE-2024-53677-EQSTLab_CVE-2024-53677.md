# CVE-2024-53677

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-53677-0xPThree_struts_cve-2024-53677.md](../2024/CVE-2024-53677-0xPThree_struts_cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了存在漏洞的FileuploadInterceptor文件上传机制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到受限制的目录，最终可能导致远程代码执行。

**有效性：**
提供的PoC代码有效。从README.md可以看出，该PoC提供了一个Docker环境，用于搭建存在漏洞的Apache Struts环境。check.py脚本通过上传包含恶意路径的文件，检测目标是否存在CVE-2024-53677漏洞。如果成功覆盖了目标目录下的文件，则表明目标存在漏洞。

**投毒风险：**
分析仓库中的代码，主要关注Dockerfile和check.py脚本。Dockerfile用于构建存在漏洞的Struts环境，没有发现明显的投毒代码。check.py脚本的主要功能是检测漏洞是否存在，但也存在一定的风险。

*   **check.py潜在风险：**
    *   **依赖风险：** 虽然check.py脚本依赖较少，但是如果篡改check.py，例如修改上传的文件内容，可能会导致恶意代码上传到目标服务器。或者通过篡改`test_filename`来实现进一步的攻击。

综合分析，投毒风险较低，大约10%。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如，将文件名设置为`../../../../tmp/shell.jsp`，尝试将文件上传到服务器的`/tmp`目录下。
2.  服务器在处理文件上传请求时，由于存在路径遍历漏洞，会将恶意文件写入到指定的目录。
3.  如果上传的文件是可执行文件（例如，JSP脚本），攻击者可以通过访问该文件，执行恶意代码，从而获得服务器的控制权。

漏洞的利用依赖于Struts的FileuploadInterceptor拦截器。如果应用程序没有使用这个拦截器，则不会受到此漏洞的影响。

**搜索引擎结果补充：**
*   多个搜索结果表明该漏洞允许未经验证的攻击者执行路径遍历并可能进行RCE。
*   一些文章强调了升级到6.4.0或更高版本，以及迁移到新的文件上传机制的重要性。
*   CISA ADP将此漏洞标记为具有可利用的PoC，且技术影响为“total”。


**项目地址:** [0xPThree/struts_cve-2024-53677](https://github.com/0xPThree/struts_cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #2

**来源**: [CVE-2024-53677-0xdeviner_CVE-2024-53677.md](../2024/CVE-2024-53677-0xdeviner_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了存在漏洞的FileuploadInterceptor，并允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数实现路径穿越，从而将恶意文件上传到受限目录，最终可能导致远程代码执行。 

**有效性分析：**

提供的Dockerfile和相关文件构成了一个可用于复现该漏洞的Docker环境。Dockerfile配置了Maven来构建Struts应用，然后部署到Tomcat服务器。`tomcat-users.xml`添加了管理员账户，`context.xml`定义了Tomcat上下文。`README.md` 文件提供了搭建环境的步骤，表明这是一个可用的PoC环境。

**投毒风险分析：**

代码主要目的是搭建漏洞环境，以便进行漏洞复现。但是`/tmp/e2ab3a0d694a1c73866387b5d303b4a6/struts-app/mvnw` 文件中存在可疑点，如果`if [ -f /etc/mavenrc ]`判断成立，可能会执行`/etc/mavenrc`文件，存在被恶意覆盖`/etc/mavenrc`文件,执行恶意代码的风险。
因此，投毒风险评估为较低，大约为10%。主要基于以下判断：
  *  代码的主要目的是复现漏洞，而不是恶意攻击。
  *  虽然存在潜在的风险点（如`mvnw`脚本），但没有明确的恶意代码或行为。
  *  环境搭建过程相对透明，用户可以审查代码。

**利用方式：**

1.  攻击者通过构造恶意的文件上传请求，利用路径穿越漏洞，将包含恶意代码的文件（如JSP webshell）上传到服务器上的任意目录。
2.  利用`FileuploadInterceptor`处理文件上传请求时，没有充分验证文件路径，导致攻击者可以控制上传文件的目标路径。
3.  一旦恶意文件上传成功，攻击者就可以通过访问该文件，执行其中的恶意代码，从而控制服务器。
4.  根据搜索结果，该漏洞已经被积极利用，因此需要立即修复。

**项目地址:** [0xdeviner/CVE-2024-53677](https://github.com/0xdeviner/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #3

**来源**: [CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md](../2024/CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传漏洞,路径遍历,远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 目标系统使用Apache Struts，且启用了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历，在某些情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性:**
提供的POC代码看起来是有效的，因为它实现了利用路径遍历上传文件，并尝试执行命令。搜索引擎结果也表明该漏洞可以实现RCE。

**投毒风险:**
虽然POC代码本身似乎是合法的漏洞利用程序，但仍然存在一些小的投毒风险。
*   **依赖风险:** `go.mod` 文件声明了 `go 1.25.0` 的依赖，虽然是常见的版本，但开发者需要自行安装Go环境。如果恶意作者指定了一个不存在或者包含恶意代码的go版本，则存在投毒风险。
*   **第三方库风险:** 代码中没有明确使用第三方库，降低了引入恶意依赖的风险，但仍需谨慎。
*   **执行任意命令风险:**  POC允许指定执行任意命令 `-command`，如果用户不小心执行了恶意命令，可能导致系统受损。
考虑到这些因素，POC代码的投毒风险较低，大约为10%。

**利用方式:**
1.  攻击者首先需要确定目标系统运行着受影响版本的 Apache Struts，并且使用了基于 `FileuploadInterceptor` 的文件上传机制。
2.  攻击者构造一个恶意的文件上传请求，其中包含经过精心设计的 `top.UploadFileName` 参数，该参数包含路径遍历字符 (例如 `../`)，用于指定文件上传的目标位置。
3.  攻击者上传一个包含恶意代码的文件 (例如 JSP shell)。
4.  攻击者通过访问上传的恶意文件来执行其中的代码，从而获得对目标系统的远程控制。
提供的 POC 代码通过以下步骤自动化了这些过程：
    *   **测试路径:**  POC首先尝试通过路径遍历上传一个测试文件，以确定正确的上传路径。
    *   **上传 Payload:**  POC 然后使用确定的路径上传恶意 Payload (默认 `shell.jsp`)。
    *   **执行命令:**  POC 尝试访问上传的 Payload，从而在服务器上执行命令 (默认 `whoami`)。

总的来说，该漏洞的利用需要一定的技术水平，但通过POC代码可以大大降低利用难度。 为了减轻 CVE-2024-53677 的风险，建议用户升级到 Apache Struts 6.4.0 或更高版本，并迁移到新的文件上传机制。

**项目地址:** [Cythonic1/CVE-2024-53677-POC](https://github.com/Cythonic1/CVE-2024-53677-POC)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #4

**来源**: [CVE-2024-53677-EQSTLab_CVE-2024-53677.md](../2024/CVE-2024-53677-EQSTLab_CVE-2024-53677.md)

# CVE-2024-53677

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-53677-0xPThree_struts_cve-2024-53677.md](../2024/CVE-2024-53677-0xPThree_struts_cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了存在漏洞的FileuploadInterceptor文件上传机制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到受限制的目录，最终可能导致远程代码执行。

**有效性：**
提供的PoC代码有效。从README.md可以看出，该PoC提供了一个Docker环境，用于搭建存在漏洞的Apache Struts环境。check.py脚本通过上传包含恶意路径的文件，检测目标是否存在CVE-2024-53677漏洞。如果成功覆盖了目标目录下的文件，则表明目标存在漏洞。

**投毒风险：**
分析仓库中的代码，主要关注Dockerfile和check.py脚本。Dockerfile用于构建存在漏洞的Struts环境，没有发现明显的投毒代码。check.py脚本的主要功能是检测漏洞是否存在，但也存在一定的风险。

*   **check.py潜在风险：**
    *   **依赖风险：** 虽然check.py脚本依赖较少，但是如果篡改check.py，例如修改上传的文件内容，可能会导致恶意代码上传到目标服务器。或者通过篡改`test_filename`来实现进一步的攻击。

综合分析，投毒风险较低，大约10%。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如，将文件名设置为`../../../../tmp/shell.jsp`，尝试将文件上传到服务器的`/tmp`目录下。
2.  服务器在处理文件上传请求时，由于存在路径遍历漏洞，会将恶意文件写入到指定的目录。
3.  如果上传的文件是可执行文件（例如，JSP脚本），攻击者可以通过访问该文件，执行恶意代码，从而获得服务器的控制权。

漏洞的利用依赖于Struts的FileuploadInterceptor拦截器。如果应用程序没有使用这个拦截器，则不会受到此漏洞的影响。

**搜索引擎结果补充：**
*   多个搜索结果表明该漏洞允许未经验证的攻击者执行路径遍历并可能进行RCE。
*   一些文章强调了升级到6.4.0或更高版本，以及迁移到新的文件上传机制的重要性。
*   CISA ADP将此漏洞标记为具有可利用的PoC，且技术影响为“total”。


**项目地址:** [0xPThree/struts_cve-2024-53677](https://github.com/0xPThree/struts_cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #2

**来源**: [CVE-2024-53677-0xdeviner_CVE-2024-53677.md](../2024/CVE-2024-53677-0xdeviner_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了存在漏洞的FileuploadInterceptor，并允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数实现路径穿越，从而将恶意文件上传到受限目录，最终可能导致远程代码执行。 

**有效性分析：**

提供的Dockerfile和相关文件构成了一个可用于复现该漏洞的Docker环境。Dockerfile配置了Maven来构建Struts应用，然后部署到Tomcat服务器。`tomcat-users.xml`添加了管理员账户，`context.xml`定义了Tomcat上下文。`README.md` 文件提供了搭建环境的步骤，表明这是一个可用的PoC环境。

**投毒风险分析：**

代码主要目的是搭建漏洞环境，以便进行漏洞复现。但是`/tmp/e2ab3a0d694a1c73866387b5d303b4a6/struts-app/mvnw` 文件中存在可疑点，如果`if [ -f /etc/mavenrc ]`判断成立，可能会执行`/etc/mavenrc`文件，存在被恶意覆盖`/etc/mavenrc`文件,执行恶意代码的风险。
因此，投毒风险评估为较低，大约为10%。主要基于以下判断：
  *  代码的主要目的是复现漏洞，而不是恶意攻击。
  *  虽然存在潜在的风险点（如`mvnw`脚本），但没有明确的恶意代码或行为。
  *  环境搭建过程相对透明，用户可以审查代码。

**利用方式：**

1.  攻击者通过构造恶意的文件上传请求，利用路径穿越漏洞，将包含恶意代码的文件（如JSP webshell）上传到服务器上的任意目录。
2.  利用`FileuploadInterceptor`处理文件上传请求时，没有充分验证文件路径，导致攻击者可以控制上传文件的目标路径。
3.  一旦恶意文件上传成功，攻击者就可以通过访问该文件，执行其中的恶意代码，从而控制服务器。
4.  根据搜索结果，该漏洞已经被积极利用，因此需要立即修复。

**项目地址:** [0xdeviner/CVE-2024-53677](https://github.com/0xdeviner/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #3

**来源**: [CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md](../2024/CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传漏洞,路径遍历,远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 目标系统使用Apache Struts，且启用了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历，在某些情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性:**
提供的POC代码看起来是有效的，因为它实现了利用路径遍历上传文件，并尝试执行命令。搜索引擎结果也表明该漏洞可以实现RCE。

**投毒风险:**
虽然POC代码本身似乎是合法的漏洞利用程序，但仍然存在一些小的投毒风险。
*   **依赖风险:** `go.mod` 文件声明了 `go 1.25.0` 的依赖，虽然是常见的版本，但开发者需要自行安装Go环境。如果恶意作者指定了一个不存在或者包含恶意代码的go版本，则存在投毒风险。
*   **第三方库风险:** 代码中没有明确使用第三方库，降低了引入恶意依赖的风险，但仍需谨慎。
*   **执行任意命令风险:**  POC允许指定执行任意命令 `-command`，如果用户不小心执行了恶意命令，可能导致系统受损。
考虑到这些因素，POC代码的投毒风险较低，大约为10%。

**利用方式:**
1.  攻击者首先需要确定目标系统运行着受影响版本的 Apache Struts，并且使用了基于 `FileuploadInterceptor` 的文件上传机制。
2.  攻击者构造一个恶意的文件上传请求，其中包含经过精心设计的 `top.UploadFileName` 参数，该参数包含路径遍历字符 (例如 `../`)，用于指定文件上传的目标位置。
3.  攻击者上传一个包含恶意代码的文件 (例如 JSP shell)。
4.  攻击者通过访问上传的恶意文件来执行其中的代码，从而获得对目标系统的远程控制。
提供的 POC 代码通过以下步骤自动化了这些过程：
    *   **测试路径:**  POC首先尝试通过路径遍历上传一个测试文件，以确定正确的上传路径。
    *   **上传 Payload:**  POC 然后使用确定的路径上传恶意 Payload (默认 `shell.jsp`)。
    *   **执行命令:**  POC 尝试访问上传的 Payload，从而在服务器上执行命令 (默认 `whoami`)。

总的来说，该漏洞的利用需要一定的技术水平，但通过POC代码可以大大降低利用难度。 为了减轻 CVE-2024-53677 的风险，建议用户升级到 Apache Struts 6.4.0 或更高版本，并迁移到新的文件上传机制。

**项目地址:** [Cythonic1/CVE-2024-53677-POC](https://github.com/Cythonic1/CVE-2024-53677-POC)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #4

**来源**: [CVE-2024-53677-EQSTLab_CVE-2024-53677.md](../2024/CVE-2024-53677-EQSTLab_CVE-2024-53677.md)

# CVE-2024-53677

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-53677-0xPThree_struts_cve-2024-53677.md](../2024/CVE-2024-53677-0xPThree_struts_cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了存在漏洞的FileuploadInterceptor文件上传机制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到受限制的目录，最终可能导致远程代码执行。

**有效性：**
提供的PoC代码有效。从README.md可以看出，该PoC提供了一个Docker环境，用于搭建存在漏洞的Apache Struts环境。check.py脚本通过上传包含恶意路径的文件，检测目标是否存在CVE-2024-53677漏洞。如果成功覆盖了目标目录下的文件，则表明目标存在漏洞。

**投毒风险：**
分析仓库中的代码，主要关注Dockerfile和check.py脚本。Dockerfile用于构建存在漏洞的Struts环境，没有发现明显的投毒代码。check.py脚本的主要功能是检测漏洞是否存在，但也存在一定的风险。

*   **check.py潜在风险：**
    *   **依赖风险：** 虽然check.py脚本依赖较少，但是如果篡改check.py，例如修改上传的文件内容，可能会导致恶意代码上传到目标服务器。或者通过篡改`test_filename`来实现进一步的攻击。

综合分析，投毒风险较低，大约10%。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如，将文件名设置为`../../../../tmp/shell.jsp`，尝试将文件上传到服务器的`/tmp`目录下。
2.  服务器在处理文件上传请求时，由于存在路径遍历漏洞，会将恶意文件写入到指定的目录。
3.  如果上传的文件是可执行文件（例如，JSP脚本），攻击者可以通过访问该文件，执行恶意代码，从而获得服务器的控制权。

漏洞的利用依赖于Struts的FileuploadInterceptor拦截器。如果应用程序没有使用这个拦截器，则不会受到此漏洞的影响。

**搜索引擎结果补充：**
*   多个搜索结果表明该漏洞允许未经验证的攻击者执行路径遍历并可能进行RCE。
*   一些文章强调了升级到6.4.0或更高版本，以及迁移到新的文件上传机制的重要性。
*   CISA ADP将此漏洞标记为具有可利用的PoC，且技术影响为“total”。


**项目地址:** [0xPThree/struts_cve-2024-53677](https://github.com/0xPThree/struts_cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #2

**来源**: [CVE-2024-53677-0xdeviner_CVE-2024-53677.md](../2024/CVE-2024-53677-0xdeviner_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了存在漏洞的FileuploadInterceptor，并允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数实现路径穿越，从而将恶意文件上传到受限目录，最终可能导致远程代码执行。 

**有效性分析：**

提供的Dockerfile和相关文件构成了一个可用于复现该漏洞的Docker环境。Dockerfile配置了Maven来构建Struts应用，然后部署到Tomcat服务器。`tomcat-users.xml`添加了管理员账户，`context.xml`定义了Tomcat上下文。`README.md` 文件提供了搭建环境的步骤，表明这是一个可用的PoC环境。

**投毒风险分析：**

代码主要目的是搭建漏洞环境，以便进行漏洞复现。但是`/tmp/e2ab3a0d694a1c73866387b5d303b4a6/struts-app/mvnw` 文件中存在可疑点，如果`if [ -f /etc/mavenrc ]`判断成立，可能会执行`/etc/mavenrc`文件，存在被恶意覆盖`/etc/mavenrc`文件,执行恶意代码的风险。
因此，投毒风险评估为较低，大约为10%。主要基于以下判断：
  *  代码的主要目的是复现漏洞，而不是恶意攻击。
  *  虽然存在潜在的风险点（如`mvnw`脚本），但没有明确的恶意代码或行为。
  *  环境搭建过程相对透明，用户可以审查代码。

**利用方式：**

1.  攻击者通过构造恶意的文件上传请求，利用路径穿越漏洞，将包含恶意代码的文件（如JSP webshell）上传到服务器上的任意目录。
2.  利用`FileuploadInterceptor`处理文件上传请求时，没有充分验证文件路径，导致攻击者可以控制上传文件的目标路径。
3.  一旦恶意文件上传成功，攻击者就可以通过访问该文件，执行其中的恶意代码，从而控制服务器。
4.  根据搜索结果，该漏洞已经被积极利用，因此需要立即修复。

**项目地址:** [0xdeviner/CVE-2024-53677](https://github.com/0xdeviner/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #3

**来源**: [CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md](../2024/CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传漏洞,路径遍历,远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 目标系统使用Apache Struts，且启用了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历，在某些情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性:**
提供的POC代码看起来是有效的，因为它实现了利用路径遍历上传文件，并尝试执行命令。搜索引擎结果也表明该漏洞可以实现RCE。

**投毒风险:**
虽然POC代码本身似乎是合法的漏洞利用程序，但仍然存在一些小的投毒风险。
*   **依赖风险:** `go.mod` 文件声明了 `go 1.25.0` 的依赖，虽然是常见的版本，但开发者需要自行安装Go环境。如果恶意作者指定了一个不存在或者包含恶意代码的go版本，则存在投毒风险。
*   **第三方库风险:** 代码中没有明确使用第三方库，降低了引入恶意依赖的风险，但仍需谨慎。
*   **执行任意命令风险:**  POC允许指定执行任意命令 `-command`，如果用户不小心执行了恶意命令，可能导致系统受损。
考虑到这些因素，POC代码的投毒风险较低，大约为10%。

**利用方式:**
1.  攻击者首先需要确定目标系统运行着受影响版本的 Apache Struts，并且使用了基于 `FileuploadInterceptor` 的文件上传机制。
2.  攻击者构造一个恶意的文件上传请求，其中包含经过精心设计的 `top.UploadFileName` 参数，该参数包含路径遍历字符 (例如 `../`)，用于指定文件上传的目标位置。
3.  攻击者上传一个包含恶意代码的文件 (例如 JSP shell)。
4.  攻击者通过访问上传的恶意文件来执行其中的代码，从而获得对目标系统的远程控制。
提供的 POC 代码通过以下步骤自动化了这些过程：
    *   **测试路径:**  POC首先尝试通过路径遍历上传一个测试文件，以确定正确的上传路径。
    *   **上传 Payload:**  POC 然后使用确定的路径上传恶意 Payload (默认 `shell.jsp`)。
    *   **执行命令:**  POC 尝试访问上传的 Payload，从而在服务器上执行命令 (默认 `whoami`)。

总的来说，该漏洞的利用需要一定的技术水平，但通过POC代码可以大大降低利用难度。 为了减轻 CVE-2024-53677 的风险，建议用户升级到 Apache Struts 6.4.0 或更高版本，并迁移到新的文件上传机制。

**项目地址:** [Cythonic1/CVE-2024-53677-POC](https://github.com/Cythonic1/CVE-2024-53677-POC)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #4

**来源**: [CVE-2024-53677-EQSTLab_CVE-2024-53677.md](../2024/CVE-2024-53677-EQSTLab_CVE-2024-53677.md)

# CVE-2024-53677

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-53677-0xPThree_struts_cve-2024-53677.md](../2024/CVE-2024-53677-0xPThree_struts_cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了存在漏洞的FileuploadInterceptor文件上传机制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到受限制的目录，最终可能导致远程代码执行。

**有效性：**
提供的PoC代码有效。从README.md可以看出，该PoC提供了一个Docker环境，用于搭建存在漏洞的Apache Struts环境。check.py脚本通过上传包含恶意路径的文件，检测目标是否存在CVE-2024-53677漏洞。如果成功覆盖了目标目录下的文件，则表明目标存在漏洞。

**投毒风险：**
分析仓库中的代码，主要关注Dockerfile和check.py脚本。Dockerfile用于构建存在漏洞的Struts环境，没有发现明显的投毒代码。check.py脚本的主要功能是检测漏洞是否存在，但也存在一定的风险。

*   **check.py潜在风险：**
    *   **依赖风险：** 虽然check.py脚本依赖较少，但是如果篡改check.py，例如修改上传的文件内容，可能会导致恶意代码上传到目标服务器。或者通过篡改`test_filename`来实现进一步的攻击。

综合分析，投毒风险较低，大约10%。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如，将文件名设置为`../../../../tmp/shell.jsp`，尝试将文件上传到服务器的`/tmp`目录下。
2.  服务器在处理文件上传请求时，由于存在路径遍历漏洞，会将恶意文件写入到指定的目录。
3.  如果上传的文件是可执行文件（例如，JSP脚本），攻击者可以通过访问该文件，执行恶意代码，从而获得服务器的控制权。

漏洞的利用依赖于Struts的FileuploadInterceptor拦截器。如果应用程序没有使用这个拦截器，则不会受到此漏洞的影响。

**搜索引擎结果补充：**
*   多个搜索结果表明该漏洞允许未经验证的攻击者执行路径遍历并可能进行RCE。
*   一些文章强调了升级到6.4.0或更高版本，以及迁移到新的文件上传机制的重要性。
*   CISA ADP将此漏洞标记为具有可利用的PoC，且技术影响为“total”。


**项目地址:** [0xPThree/struts_cve-2024-53677](https://github.com/0xPThree/struts_cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #2

**来源**: [CVE-2024-53677-0xdeviner_CVE-2024-53677.md](../2024/CVE-2024-53677-0xdeviner_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了存在漏洞的FileuploadInterceptor，并允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数实现路径穿越，从而将恶意文件上传到受限目录，最终可能导致远程代码执行。 

**有效性分析：**

提供的Dockerfile和相关文件构成了一个可用于复现该漏洞的Docker环境。Dockerfile配置了Maven来构建Struts应用，然后部署到Tomcat服务器。`tomcat-users.xml`添加了管理员账户，`context.xml`定义了Tomcat上下文。`README.md` 文件提供了搭建环境的步骤，表明这是一个可用的PoC环境。

**投毒风险分析：**

代码主要目的是搭建漏洞环境，以便进行漏洞复现。但是`/tmp/e2ab3a0d694a1c73866387b5d303b4a6/struts-app/mvnw` 文件中存在可疑点，如果`if [ -f /etc/mavenrc ]`判断成立，可能会执行`/etc/mavenrc`文件，存在被恶意覆盖`/etc/mavenrc`文件,执行恶意代码的风险。
因此，投毒风险评估为较低，大约为10%。主要基于以下判断：
  *  代码的主要目的是复现漏洞，而不是恶意攻击。
  *  虽然存在潜在的风险点（如`mvnw`脚本），但没有明确的恶意代码或行为。
  *  环境搭建过程相对透明，用户可以审查代码。

**利用方式：**

1.  攻击者通过构造恶意的文件上传请求，利用路径穿越漏洞，将包含恶意代码的文件（如JSP webshell）上传到服务器上的任意目录。
2.  利用`FileuploadInterceptor`处理文件上传请求时，没有充分验证文件路径，导致攻击者可以控制上传文件的目标路径。
3.  一旦恶意文件上传成功，攻击者就可以通过访问该文件，执行其中的恶意代码，从而控制服务器。
4.  根据搜索结果，该漏洞已经被积极利用，因此需要立即修复。

**项目地址:** [0xdeviner/CVE-2024-53677](https://github.com/0xdeviner/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #3

**来源**: [CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md](../2024/CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传漏洞,路径遍历,远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 目标系统使用Apache Struts，且启用了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历，在某些情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性:**
提供的POC代码看起来是有效的，因为它实现了利用路径遍历上传文件，并尝试执行命令。搜索引擎结果也表明该漏洞可以实现RCE。

**投毒风险:**
虽然POC代码本身似乎是合法的漏洞利用程序，但仍然存在一些小的投毒风险。
*   **依赖风险:** `go.mod` 文件声明了 `go 1.25.0` 的依赖，虽然是常见的版本，但开发者需要自行安装Go环境。如果恶意作者指定了一个不存在或者包含恶意代码的go版本，则存在投毒风险。
*   **第三方库风险:** 代码中没有明确使用第三方库，降低了引入恶意依赖的风险，但仍需谨慎。
*   **执行任意命令风险:**  POC允许指定执行任意命令 `-command`，如果用户不小心执行了恶意命令，可能导致系统受损。
考虑到这些因素，POC代码的投毒风险较低，大约为10%。

**利用方式:**
1.  攻击者首先需要确定目标系统运行着受影响版本的 Apache Struts，并且使用了基于 `FileuploadInterceptor` 的文件上传机制。
2.  攻击者构造一个恶意的文件上传请求，其中包含经过精心设计的 `top.UploadFileName` 参数，该参数包含路径遍历字符 (例如 `../`)，用于指定文件上传的目标位置。
3.  攻击者上传一个包含恶意代码的文件 (例如 JSP shell)。
4.  攻击者通过访问上传的恶意文件来执行其中的代码，从而获得对目标系统的远程控制。
提供的 POC 代码通过以下步骤自动化了这些过程：
    *   **测试路径:**  POC首先尝试通过路径遍历上传一个测试文件，以确定正确的上传路径。
    *   **上传 Payload:**  POC 然后使用确定的路径上传恶意 Payload (默认 `shell.jsp`)。
    *   **执行命令:**  POC 尝试访问上传的 Payload，从而在服务器上执行命令 (默认 `whoami`)。

总的来说，该漏洞的利用需要一定的技术水平，但通过POC代码可以大大降低利用难度。 为了减轻 CVE-2024-53677 的风险，建议用户升级到 Apache Struts 6.4.0 或更高版本，并迁移到新的文件上传机制。

**项目地址:** [Cythonic1/CVE-2024-53677-POC](https://github.com/Cythonic1/CVE-2024-53677-POC)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #4

**来源**: [CVE-2024-53677-EQSTLab_CVE-2024-53677.md](../2024/CVE-2024-53677-EQSTLab_CVE-2024-53677.md)

# CVE-2024-53677

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-53677-0xPThree_struts_cve-2024-53677.md](../2024/CVE-2024-53677-0xPThree_struts_cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了存在漏洞的FileuploadInterceptor文件上传机制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到受限制的目录，最终可能导致远程代码执行。

**有效性：**
提供的PoC代码有效。从README.md可以看出，该PoC提供了一个Docker环境，用于搭建存在漏洞的Apache Struts环境。check.py脚本通过上传包含恶意路径的文件，检测目标是否存在CVE-2024-53677漏洞。如果成功覆盖了目标目录下的文件，则表明目标存在漏洞。

**投毒风险：**
分析仓库中的代码，主要关注Dockerfile和check.py脚本。Dockerfile用于构建存在漏洞的Struts环境，没有发现明显的投毒代码。check.py脚本的主要功能是检测漏洞是否存在，但也存在一定的风险。

*   **check.py潜在风险：**
    *   **依赖风险：** 虽然check.py脚本依赖较少，但是如果篡改check.py，例如修改上传的文件内容，可能会导致恶意代码上传到目标服务器。或者通过篡改`test_filename`来实现进一步的攻击。

综合分析，投毒风险较低，大约10%。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如，将文件名设置为`../../../../tmp/shell.jsp`，尝试将文件上传到服务器的`/tmp`目录下。
2.  服务器在处理文件上传请求时，由于存在路径遍历漏洞，会将恶意文件写入到指定的目录。
3.  如果上传的文件是可执行文件（例如，JSP脚本），攻击者可以通过访问该文件，执行恶意代码，从而获得服务器的控制权。

漏洞的利用依赖于Struts的FileuploadInterceptor拦截器。如果应用程序没有使用这个拦截器，则不会受到此漏洞的影响。

**搜索引擎结果补充：**
*   多个搜索结果表明该漏洞允许未经验证的攻击者执行路径遍历并可能进行RCE。
*   一些文章强调了升级到6.4.0或更高版本，以及迁移到新的文件上传机制的重要性。
*   CISA ADP将此漏洞标记为具有可利用的PoC，且技术影响为“total”。


**项目地址:** [0xPThree/struts_cve-2024-53677](https://github.com/0xPThree/struts_cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #2

**来源**: [CVE-2024-53677-0xdeviner_CVE-2024-53677.md](../2024/CVE-2024-53677-0xdeviner_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了存在漏洞的FileuploadInterceptor，并允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数实现路径穿越，从而将恶意文件上传到受限目录，最终可能导致远程代码执行。 

**有效性分析：**

提供的Dockerfile和相关文件构成了一个可用于复现该漏洞的Docker环境。Dockerfile配置了Maven来构建Struts应用，然后部署到Tomcat服务器。`tomcat-users.xml`添加了管理员账户，`context.xml`定义了Tomcat上下文。`README.md` 文件提供了搭建环境的步骤，表明这是一个可用的PoC环境。

**投毒风险分析：**

代码主要目的是搭建漏洞环境，以便进行漏洞复现。但是`/tmp/e2ab3a0d694a1c73866387b5d303b4a6/struts-app/mvnw` 文件中存在可疑点，如果`if [ -f /etc/mavenrc ]`判断成立，可能会执行`/etc/mavenrc`文件，存在被恶意覆盖`/etc/mavenrc`文件,执行恶意代码的风险。
因此，投毒风险评估为较低，大约为10%。主要基于以下判断：
  *  代码的主要目的是复现漏洞，而不是恶意攻击。
  *  虽然存在潜在的风险点（如`mvnw`脚本），但没有明确的恶意代码或行为。
  *  环境搭建过程相对透明，用户可以审查代码。

**利用方式：**

1.  攻击者通过构造恶意的文件上传请求，利用路径穿越漏洞，将包含恶意代码的文件（如JSP webshell）上传到服务器上的任意目录。
2.  利用`FileuploadInterceptor`处理文件上传请求时，没有充分验证文件路径，导致攻击者可以控制上传文件的目标路径。
3.  一旦恶意文件上传成功，攻击者就可以通过访问该文件，执行其中的恶意代码，从而控制服务器。
4.  根据搜索结果，该漏洞已经被积极利用，因此需要立即修复。

**项目地址:** [0xdeviner/CVE-2024-53677](https://github.com/0xdeviner/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #3

**来源**: [CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md](../2024/CVE-2024-53677-Cythonic1_CVE-2024-53677-POC.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传漏洞,路径遍历,远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 目标系统使用Apache Struts，且启用了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来利用路径遍历，在某些情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性:**
提供的POC代码看起来是有效的，因为它实现了利用路径遍历上传文件，并尝试执行命令。搜索引擎结果也表明该漏洞可以实现RCE。

**投毒风险:**
虽然POC代码本身似乎是合法的漏洞利用程序，但仍然存在一些小的投毒风险。
*   **依赖风险:** `go.mod` 文件声明了 `go 1.25.0` 的依赖，虽然是常见的版本，但开发者需要自行安装Go环境。如果恶意作者指定了一个不存在或者包含恶意代码的go版本，则存在投毒风险。
*   **第三方库风险:** 代码中没有明确使用第三方库，降低了引入恶意依赖的风险，但仍需谨慎。
*   **执行任意命令风险:**  POC允许指定执行任意命令 `-command`，如果用户不小心执行了恶意命令，可能导致系统受损。
考虑到这些因素，POC代码的投毒风险较低，大约为10%。

**利用方式:**
1.  攻击者首先需要确定目标系统运行着受影响版本的 Apache Struts，并且使用了基于 `FileuploadInterceptor` 的文件上传机制。
2.  攻击者构造一个恶意的文件上传请求，其中包含经过精心设计的 `top.UploadFileName` 参数，该参数包含路径遍历字符 (例如 `../`)，用于指定文件上传的目标位置。
3.  攻击者上传一个包含恶意代码的文件 (例如 JSP shell)。
4.  攻击者通过访问上传的恶意文件来执行其中的代码，从而获得对目标系统的远程控制。
提供的 POC 代码通过以下步骤自动化了这些过程：
    *   **测试路径:**  POC首先尝试通过路径遍历上传一个测试文件，以确定正确的上传路径。
    *   **上传 Payload:**  POC 然后使用确定的路径上传恶意 Payload (默认 `shell.jsp`)。
    *   **执行命令:**  POC 尝试访问上传的 Payload，从而在服务器上执行命令 (默认 `whoami`)。

总的来说，该漏洞的利用需要一定的技术水平，但通过POC代码可以大大降低利用难度。 为了减轻 CVE-2024-53677 的风险，建议用户升级到 Apache Struts 6.4.0 或更高版本，并迁移到新的文件上传机制。

**项目地址:** [Cythonic1/CVE-2024-53677-POC](https://github.com/Cythonic1/CVE-2024-53677-POC)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #4

**来源**: [CVE-2024-53677-SeanRickerd_CVE-2024-53677.md](../2024/CVE-2024-53677-SeanRickerd_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要Struts应用使用存在漏洞的FileuploadInterceptor旧文件上传机制

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以利用此漏洞，通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到服务器的任意目录。如果上传的文件是可执行脚本（如JSP），攻击者就可以通过访问该脚本来执行任意代码，最终实现远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 利用Struts的文件上传功能，通过修改上传参数，构造包含`../`的路径，绕过文件上传的限制，将文件上传到任意目录。
2.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP脚本。
3.  **远程代码执行：** 通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码有效。搜索结果中多个链接(如dynatrace, qualys, arcticwolf, sonicwall, nsfocusglobal, censys等)都提到了CVE-2024-53677漏洞，并且描述了通过文件上传路径遍历实现RCE。提供的Dockerfile和S2-067.py脚本，以及README.md文件，都提供了完整的漏洞复现环境和利用方法，证明了该漏洞的可利用性。

**投毒风险：**

虽然该POC提供了一个可用的漏洞利用方法，但存在轻微的投毒风险。原因是:

*   Dockerfile：Dockerfile构建过程相对清晰，构建了一个存在漏洞的Struts应用，并部署了tomcat，本身不包含恶意代码。然而，它从其他位置拷贝了`tomcat-users.xml`和`context.xml`配置文件，这些文件可能会包含恶意配置，例如预置的管理员账号密码或者允许任意IP访问manager接口，从而引入安全风险，但这些风险主要取决于这两个文件的具体内容。
*   S2-067.py：Python脚本用于利用该漏洞，其主要功能是上传文件。脚本本身的功能是路径遍历文件上传，本身不属于后门，但如果destination参数设置不当(如覆盖重要文件)，可能导致服务不可用。
*   README.md: README.md中提到了在Openshift上运行需要添加`oc adm policy add-scc-to-group anyuid system:authenticated`, 这在生产环境中是非常危险的，可能导致权限泄露.

综合评估，该仓库的投毒风险较低（约5%）。大部分代码用于漏洞复现，而非恶意行为。真正的风险在于`tomcat-users.xml`和`context.xml`可能存在的恶意配置，以及在Openshift部署时使用`anyuid`可能带来的权限泄露。因此需要仔细检查这些文件，并谨慎地进行部署。


**项目地址:** [SeanRickerd/CVE-2024-53677](https://github.com/SeanRickerd/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #5

**来源**: [CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历/RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统开启文件上传功能，并且使用存在漏洞的FileuploadInterceptor。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数来实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据漏洞库信息，该漏洞影响2.0.0到6.4.0之前的版本。升级到6.4.0或更高版本，并迁移到新的文件上传机制是主要的修复建议。

搜索引擎结果表明，该漏洞已被广泛讨论，并被认为对使用Apache Struts的企业构成重大威胁。多个来源强调了远程代码执行的潜在风险，并将其与过去的Struts漏洞（例如，Equifax breach）联系起来。利用的难易程度为中等，CVSS评分为9.5。

POC代码提供了一个检测脚本，该脚本尝试通过修改上传文件名来触发路径遍历。它通过设置`top.uploadFileName`参数来实现，并检查服务器响应中是否存在被覆盖的文件名。如果检测到文件名覆盖，则表明目标可能存在漏洞。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如使用`../../`来尝试写入Web目录之外的文件。
2.  服务器在处理文件上传时，未正确验证或清理上传的文件名或路径。
3.  攻击者成功将恶意文件（例如JSP webshell）上传到服务器的Web可访问目录。
4.  攻击者通过Web浏览器访问上传的恶意文件，从而执行任意代码。

**投毒风险评估：**

代码库中包含一个检测漏洞的脚本和一个简单的上传文件示例。没有发现任何明显的恶意代码，例如反向shell、下载并执行任意程序的代码等。文件上传漏洞本身可能被用于投毒，但提供的脚本本身不包含额外的、作者隐藏的恶意功能。因此，投毒风险评估为0%。

**项目地址:** [TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #6

**来源**: [CVE-2024-53677-WhoisBulud_CVE-2024-53677.md](../2024/CVE-2024-53677-WhoisBulud_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，存在于2.0.0到6.4.0之前的版本中。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到受限制的目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且存在多个公开的利用方法。提供的POC代码尝试通过修改`uploadFileName`参数来将JSP webshell上传到webapps/ROOT/目录下，从而实现远程代码执行。

**投毒风险：**
检查提供的POC代码，没有发现明显的投毒行为。该脚本只是一个简单的webshell上传工具，没有执行任何恶意操作，例如安装后门、窃取信息等。因此，投毒风险评估为0%。

**利用方式：**
1.  **路径穿越:** 攻击者利用Struts框架在处理文件上传时的缺陷，通过修改上传文件的文件名参数（`uploadFileName`），构造包含路径穿越字符（如`../`）的文件名。
2.  **上传恶意文件:** 通过路径穿越，攻击者可以将恶意文件（如JSP webshell）上传到Web服务器的任意目录下，突破Web服务器的访问限制。
3.  **远程代码执行:** 上传的恶意文件被Web服务器执行，攻击者可以通过访问该文件来执行任意系统命令，从而完全控制服务器。

**项目地址:** [WhoisBulud/CVE-2024-53677](https://github.com/WhoisBulud/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #7

**来源**: [CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统使用基于FileuploadInterceptor的旧文件上传逻辑，且可通过网络访问上传接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 的文件上传漏洞，允许攻击者通过操纵文件上传参数实现路径遍历，从而上传恶意文件到任意目录，最终可能导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中包含了多个安全厂商和研究人员对该漏洞的分析和利用案例，表明该漏洞已被广泛关注和验证。提供的 POC 代码通过修改上传文件名参数，尝试将文件上传到目标系统的任意目录，这是一种典型的路径遍历攻击方式。

**投毒风险分析：**

审查提供的 POC 代码，该脚本主要用于检测目标系统是否存在 CVE-2024-53677 漏洞，其核心功能是通过构造恶意的 multipart 请求，尝试上传一个包含特定内容的文件到目标系统的任意目录。脚本本身不包含任何用于执行恶意操作（如安装后门、窃取数据等）的代码，其目的仅在于验证漏洞的存在性。因此，该 POC 代码存在投毒代码的风险较低。

**利用方式分析：**

利用 CVE-2024-53677 漏洞的一般步骤如下：

1.  **确定目标系统：** 确定目标系统使用的 Apache Struts 版本在受影响范围内。
2.  **寻找上传接口：** 寻找目标系统提供的文件上传接口，这些接口通常基于 FileuploadInterceptor 实现。
3.  **构造恶意请求：** 构造包含恶意文件名的 multipart 请求，利用路径遍历将恶意文件上传到目标系统的任意目录，例如 Web 容器的部署目录。
4.  **执行恶意代码：** 通过访问上传的恶意文件，触发恶意代码的执行，实现远程代码执行。

该漏洞的利用需要目标系统存在基于 `FileuploadInterceptor` 的文件上传功能，且该功能存在缺陷，允许攻击者通过操纵文件名参数实现路径遍历。如果目标系统使用了新的文件上传机制，则不会受到该漏洞的影响。

**项目地址:** [XiaomingX/CVE-2024-53677-S2-067](https://github.com/XiaomingX/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #8

**来源**: [CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md](../2024/CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md)

## CVE-2024-53677-Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了基于 FileUploadInterceptor 的文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径穿越，将恶意文件上传到任意目录，从而可能导致远程代码执行。

**有效性评估：**

根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果均表明这是一个高危漏洞，且存在被利用的风险。POC代码提供了一个Docker环境，用于复现该漏洞。README.md 文件中描述了如何构建和运行该环境，以及漏洞利用的关键修改，例如使用 FileUploadInterceptor 和禁用文件类型验证，进一步降低了复现漏洞的难度。

**投毒风险评估：**

*   **Dockerfile：** Dockerfile用于构建包含漏洞的Struts2应用，本身不包含恶意代码。使用Tomcat作为容器，并复制编译好的WAR包部署。
*   **README.md：** 提供了漏洞复现环境的搭建说明，没有发现恶意代码。
*   **context.xml：** Tomcat的上下文配置文件，设置了一些安全属性，如`antiResourceLocking`和`privileged`，以及CookieProcessor，虽然可能存在配置错误导致其他问题，但本身不是投毒代码。
*   **tomcat-users.xml：** 用于配置Tomcat的用户和角色，包含一个默认的管理员账户admin/trackflaw，这本身是**非常危险**的，因为它使用了一个硬编码的密码。虽然这个默认账户方便漏洞验证，但在真实环境中应该**立即删除或修改密码**。将默认密码作为投毒行为的风险评估较低，因为这通常被认为是配置不当，而非恶意植入。
*   **struts-app/mvnw：** Maven Wrapper，用于在没有安装Maven的环境下构建项目，没有发现恶意代码。

总体评估，代码本身未发现明显的恶意后门。高危操作是设置了默认Tomcat管理员账户，**但这个缺陷更偏向于配置问题，而非有意植入的后门**。考虑到默认账号和密码可能被利用，存在一定的安全风险，将投毒风险评估为10%。

**利用方式分析：**

1.  **环境搭建：** 使用提供的Dockerfile构建包含漏洞的Struts2应用。
2.  **路径穿越：** 通过修改文件上传的参数（例如文件名），构造包含“../”的路径，使文件上传到web目录之外的位置，例如Tomcat的`webapps`目录之外。
3.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP Webshell。
4.  **远程代码执行：** 通过访问上传的恶意文件，触发恶意代码的执行，从而获得服务器的控制权。

关键在于构造恶意的文件名，利用路径穿越绕过Struts的文件上传检查，将恶意文件上传到可执行的位置。

**项目地址:** [c4oocO/CVE-2024-53677-Docker](https://github.com/c4oocO/CVE-2024-53677-Docker)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #9

**来源**: [CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md](../2024/CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑，并且允许用户控制上传文件名参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到服务器的任意目录，从而可能执行远程代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞真实存在且危害严重。POC 代码通过修改`top.uploadFileName`参数尝试将文件上传到目标目录，证明了路径穿越的可能性。POC代码的检测部分通过发送包含恶意文件名的上传请求来检查目标服务器是否易受攻击。如果服务器返回包含恶意文件名的响应，则表明存在漏洞，s2-067-poc.py可以用于上传恶意jsp脚本从而实现rce。

**投毒风险分析：**

检视提供的三个文件：

*   `Check-CVE-2024-53677.py`: 这是一个漏洞检测脚本，旨在非破坏性地检测目标服务器是否存在 CVE-2024-53677 漏洞。它通过上传一个带有修改后文件名的文件来判断是否存在漏洞，基本没有发现异常行为。
*   `README.md`: 这是一个描述 CVE-2024-53677 漏洞的说明文件，包含漏洞描述、影响、修复建议等信息，没有发现投毒代码。
*   `s2-067-poc.py`: 这是一个漏洞利用脚本，用于利用 CVE-2024-53677 漏洞上传恶意 JSP 文件，从而实现远程代码执行。尽管其功能是利用漏洞，但本身也属于漏洞利用代码范畴，考虑到会上传jsp脚本，存在一定后门风险。

总体而言，投毒风险较低，但存在jsp后门文件上传风险需要注意。

**利用方式：**

1.  **路径穿越：** 攻击者通过修改文件上传请求中的文件名参数（例如`top.uploadFileName`），使其包含路径穿越符（如`../`），从而突破服务器的文件上传目录限制。
2.  **恶意文件上传：** 攻击者利用路径穿越，将恶意文件（如 JSP webshell）上传到服务器的可执行目录（如 Web 应用程序的根目录）。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**防范措施：**

*   升级 Apache Struts 到 6.4.0 或更高版本。
*   使用 Struts 提供的新的文件上传机制，避免使用基于 `FileuploadInterceptor` 的旧文件上传逻辑。
*   对用户上传的文件名进行严格的验证和过滤，防止路径穿越攻击。
*   限制文件上传目录的执行权限。

**项目地址:** [cloudwafs/s2-067-CVE-2024-53677](https://github.com/cloudwafs/s2-067-CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #10

**来源**: [CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md](../2024/CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 6.3.x (不包含6.4.0)

**利用条件:** 目标系统使用了存在漏洞的Struts版本，并且开启了基于`FileuploadInterceptor`的文件上传功能。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，利用路径遍历漏洞将恶意文件上传到服务器的任意位置，如果上传的文件是可执行脚本（例如JSP），则可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被认为是高危漏洞，存在远程代码执行的风险。多个安全博客和漏洞库（如NVD, RedHat, Arctic Wolf, Dynatrace, SonicWall, Censys, NSFocus, Qualys）都对此漏洞进行了分析和报告。提供的POC代码通过构造包含路径遍历的multipart/form-data请求，尝试将JSP文件上传到服务器的特定目录。代码中包含了生成随机文件名、创建混淆JSP Payload、上传文件、验证上传文件等功能。因此，提供的POC代码是有效的，可以用来验证和利用该漏洞。

**投毒风险分析：**

该POC代码的投毒风险较低，约为1%。主要原因如下：

*   代码功能相对清晰：该代码主要用于文件上传和验证，逻辑较为简单，没有明显的恶意代码或隐藏功能。
*   混淆载荷：使用了Base64编码混淆了JSP payload，但目的是为了避免直接检测，而不是隐藏恶意行为。decode后的JSP payload功能也是在目标服务器执行命令，方便验证RCE.
*   参数可控：上传路径、文件名、Payload等关键参数都通过命令行参数进行控制，用户可以自定义这些参数，从而降低了被植入恶意代码的风险。
*   缺乏持久化手段：该代码主要用于漏洞验证，不会在目标系统上安装后门或执行其他持久化操作。
*   文件读取操作的透明性：从文件读取URL列表的操作也相对透明，用户可以检查文件内容，确认URL的合法性。

**利用方式：**

1.  **确定目标:** 首先需要确定目标系统是否使用了存在漏洞的Apache Struts版本，且使用了`FileuploadInterceptor`。
2.  **构造恶意请求:** 使用POC代码，构造包含路径遍历的文件上传请求。通过修改上传文件的路径参数，尝试将JSP文件上传到服务器的Web目录或其他可执行目录（例如：`../../../../../webapps/ROOT`或`/tmp`）。
3.  **上传JSP Payload:** 上传包含恶意代码的JSP文件。POC代码中使用了混淆的JSP Payload，该Payload的功能是执行指定的命令。
4.  **访问上传的文件:** 通过Web浏览器或HTTP客户端访问上传的JSP文件。如果文件上传成功且可执行，服务器将执行JSP Payload中的代码。
5.  **执行任意命令:** 通过在URL中添加`cmd`参数，可以执行任意系统命令（例如：`http://example.com/uploaded/malicious.jsp?cmd=whoami`）。
6.  **远程代码执行:** 如果攻击成功，攻击者可以在目标服务器上执行任意代码，从而完全控制该服务器。


**项目地址:** [dustblessnotdust/CVE-2024-53677-S2-067-thread](https://github.com/dustblessnotdust/CVE-2024-53677-S2-067-thread)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #11

**来源**: [CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md](../2024/CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md)

## CVE-2024-53677-Apache Struts文件上传RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 启用了基于 FileUploadInterceptor 的旧文件上传逻辑，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来实现路径遍历，从而上传恶意文件并执行远程代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。多个来源表明该漏洞已在实际环境中被利用，并且存在公开可用的利用代码。

**投毒风险：**

分析提供的漏洞利用代码（/tmp/6fab2f844aba42ca86705ccc230e42e1/README.md）：

*   该代码描述了一个利用 CVE-2024-53677 的方法，涉及修改文件上传请求，通过 OGNL 表达式注入参数，绕过文件类型限制，并将恶意 JSP payload 附加到上传的文件中。
*   payload部分给出的是引用外部shell.jsp的代码，需要进一步分析shell.jsp本身，因为仅仅看readme.md本身无法确定payload是否安全
*   exploit.py同样是引用外部脚本，需要关注其代码是否包含恶意操作
*   python3 http.server -m 3004 命令用于提供web服务，有被用于恶意文件分发的可能性

综合考虑，该仓库存在一定投毒风险，但考虑到提供的步骤是为了利用漏洞进行渗透测试，恶意行为通常与渗透测试的目标有关。由于需要引用的shell.jsp和python脚本来源未知，不能排除恶意脚本的存在，考虑到脚本存在从外部拉取，存在潜在的风险。所以给出10%的投毒风险评估。

**利用方式：**

1.  **识别攻击向量：** 找到存在文件上传功能的页面。
2.  **版本确认：** 确定目标 Apache Struts 的版本是否在受影响范围内（2.0.0 到 6.4.0 之前）。可以通过查找 `pom.xml` 文件等方式确认。
3.  **修改文件上传请求：** 使用 BurpSuite 等工具截获文件上传请求，添加利用 OGNL 的参数，例如：
    ```
    ...(上传的文件内容).&{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','freak')}.&{(#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().getValue('rand')).getRuntime().exec('touch /tmp/success')}
    ```
4.  **附加 Payload：** 将 JSP payload 附加到上传的文件数据中，例如使用 webshell 。
5.  **发送请求：** 发送修改后的请求。
6.  **访问 Payload：** 访问上传的 JSP 文件，触发 payload 执行。
7.  **获取 Shell：** 如果 payload 是 webshell，则可以通过 webshell 执行任意命令，例如建立反向 shell。

**项目地址:** [hopsypopsy8/CVE-2024-53677-Exploitation](https://github.com/hopsypopsy8/CVE-2024-53677-Exploitation)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #12

**来源**: [CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md](../2024/CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传漏洞

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用 FileuploadInterceptor 的 Struts 应用，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞。攻击者可以操纵文件上传参数，利用路径遍历漏洞将文件上传到受限目录，从而可能导致远程代码执行。

**有效性：**
漏洞库信息和搜索结果均表明该漏洞是真实存在的，且风险较高，多个安全厂商发布了相关预警和分析报告。提供的 POC 代码利用了参数覆盖和路径遍历来上传文件，并验证文件是否可访问，如果目标是WebShell，还可以执行命令。此利用方式较为常见且有效。

**投毒风险：**
查看提供的`exploit.py`脚本，该脚本主要功能是利用multipart/form-data上传文件，并通过`destination_path`参数来控制上传文件的路径，存在以下几个需要关注的点：

1.  **`simulate_i18n_errors()`函数**：虽然该函数只是模拟国际化错误，但如果被恶意修改，可能会引入其他潜在的攻击向量。
2.  **`execute_remote_command()`函数**：这个函数允许执行远程命令，是漏洞利用的关键部分。如果被篡改，可能导致意外的系统行为。
3.  **依赖库**：`requests`和`requests_toolbelt`是常用的库，但如果被替换为恶意版本，可能导致信息泄露或者代码执行。

此外，`README.md`中引用的YouTube视频链接和GitHub仓库链接也存在一定的风险，例如链接可能指向恶意网站或包含恶意代码的仓库。

考虑到以上因素，该仓库存在一定的投毒风险，但主要是因为利用过程中涉及远程代码执行，如果验证的webshell存在后门也可能导致被控，而并非作者主动投毒。综合评估投毒风险在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名，利用“../”等相对路径，将文件上传到Web服务器的任意目录，绕过上传限制。
2.  **参数覆盖：**  利用Struts框架的特性，覆盖文件上传相关的参数，例如`top.UploadFileName`，从而指定上传文件的目标路径。
3.  **上传恶意文件：**  上传包含恶意代码的文件，例如JSP WebShell，然后通过访问该文件来执行任意命令。
4.  **远程代码执行：** 结合路径遍历和恶意文件上传，攻击者可以在Web服务器上执行任意代码，控制服务器。

总的来说，攻击者通过构造恶意请求，欺骗服务器，最终实现远程代码执行。漏洞利用需要目标应用使用了易受攻击的`FileuploadInterceptor`。

**项目地址:** [punitdarji/Apache-struts-cve-2024-53677](https://github.com/punitdarji/Apache-struts-cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #13

**来源**: [CVE-2024-53677-r007sec_CVE-2024-53677.md](../2024/CVE-2024-53677-r007sec_CVE-2024-53677.md)

## CVE-2024-53677: Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 到 6.4.0 之前

**利用条件:** Apache Struts应用使用了基于FileuploadInterceptor的旧文件上传机制，且攻击者可以访问上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Apache Struts的旧文件上传逻辑中。攻击者可以通过操纵文件上传参数，进行路径遍历，从而将恶意文件上传到任意位置，例如Web容器的webapp目录，进而执行恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞利用是有效的。多个来源均指出 CVE-2024-53677 是一个严重的文件上传漏洞，攻击者可以利用它进行路径遍历和远程代码执行。提供的PoC代码包含一个可以上传WAR包的exploit，以及手动利用的multipart/form-data请求示例，证实了该漏洞的可利用性。

**投毒风险：**
PoC代码存在一定程度的投毒风险。虽然PoC的主要功能是利用漏洞，但其中可能隐藏一些不易察觉的恶意代码，例如：
1.  **WAR包内容：** exploit.py 脚本创建的WAR文件(webshell.war)本身可能包含后门代码。在没有仔细检查的情况下部署这个WAR包可能导致服务器被植入恶意程序。
2.  **上传逻辑修改：** 攻击者可能修改上传逻辑，例如在上传过程中记录服务器信息，或者尝试执行其他未授权操作。
3.  **依赖风险：** requirements.txt 中列出的依赖包可能包含恶意代码或安全漏洞。使用受污染的依赖包可能导致安全风险。
4.  **GIF89a头注入:**  虽然是为了绕过上传检查，但可能存在利用GIF解析漏洞的风险。虽然可能性较低，但是仍然需要考虑。
总体而言，考虑到WAR包本身是用来执行命令的，因此很难完全排除投毒的可能。如果用户盲目执行，并且没有对生成的WAR包进行检查，则存在风险。因此，投毒风险评估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名参数，使其包含`../`这样的路径遍历字符，从而能够将文件上传到服务器上的任意目录。
2.  **上传恶意文件：** 攻击者通常上传包含恶意代码的文件，例如JSP webshell或者WAR包，这些文件一旦被Web服务器解析，就可以执行任意命令。
3.  **远程代码执行：** 通过上传的恶意文件，攻击者可以在服务器上执行任意命令，从而完全控制服务器。

**总结：**
CVE-2024-53677是一个高危漏洞，利用简单，危害巨大。用户应该尽快升级到安全版本，或者采取其他缓解措施，例如禁用旧的文件上传功能。

**项目地址:** [r007sec/CVE-2024-53677](https://github.com/r007sec/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #14

**来源**: [CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md](../2024/CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用基于 FileuploadInterceptor 的旧文件上传逻辑，且可访问 upload.action 接口。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2024-53677 漏洞存在于 Apache Struts 的文件上传逻辑中。攻击者可以通过操纵文件上传参数实现路径遍历，从而上传恶意文件，例如 JSP webshell，最终导致远程代码执行。

**漏洞利用方式：**

1.  **确定目标应用是否使用存在漏洞的 Struts 版本** (2.0.0 到 6.3.x)。
2.  **确定目标应用是否使用基于 FileuploadInterceptor 的文件上传机制**。
3.  **发送包含恶意构造的`top.UploadFileName`参数的 POST 请求到 `upload.action` 接口**。`top.UploadFileName`参数用于指定上传文件的目标路径，攻击者可以通过该参数进行路径遍历，将文件上传到任意目录。
4.  **上传包含恶意代码的文件（如 JSP webshell）**。PoC 中使用了JSP webshell，允许执行服务器端命令。
5.  **通过访问上传的webshell执行任意命令。** PoC 上传 webshell 后，通过构造特定的 URL 参数 `action=cmd&cmd=<command>` 来执行命令。

**有效性评估：**

提供的PoC 代码有效，可以利用该漏洞实现文件上传和远程代码执行。PoC 包含两个 Python 脚本：

*   `PoC.py`:  该脚本通过 POST 请求上传包含 webshell 代码的 JSP 文件，并设置 `top.UploadFileName` 参数为目标路径，实现路径遍历和 webshell 上传。上传成功后，通过 GET 请求访问 webshell，执行指定的命令。
*   `cve_2024_53677_Tool.py`:  该脚本提供了一个交互式菜单，用于检测 Struts 版本、检查漏洞是否存在、上传测试文件和 webshell，并在 Selenium 中打开 webshell。功能更全面，方便漏洞利用。

**投毒风险评估：**

PoC代码中存在极小的投毒风险。PoC 主要功能是漏洞利用，将后门代码封装在webshell里，不算投毒。投毒代码可能藏在以下几点：

1.  **Webshell 代码本身**： 虽然 webshell 的主要目的是执行命令，但开发者可以加入其他恶意代码，例如收集服务器信息、植入持久性后门等。但PoC提供的webshell比较简单，主要的功能是命令执行。
2.  **工具脚本**（`cve_2024_53677_Tool.py`）： 该脚本拥有更多功能，可能在版本检测、文件上传等过程中隐藏恶意代码，例如修改上传文件的内容、记录用户输入等。
3.  **依赖库**：PoC 使用了 `requests` 和（可选）`selenium` 库。虽然这些库本身是安全的，但如果作者使用了恶意修改过的版本，可能会引入安全风险。

**综合评估，投毒风险较低（2%）。主要风险在于 webshell 本身可能存在恶意代码，以及对未知来源脚本的不信任。建议仔细审查代码，并使用可信的依赖库。**

**项目地址:** [seoyoung-kang/CVE-2024-53677](https://github.com/seoyoung-kang/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #15

**来源**: [CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md](../2024/CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越 RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用了存在漏洞的FileuploadInterceptor且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是 Apache Struts 2 中一个严重的文件上传漏洞。攻击者可以通过构造恶意的文件上传请求，利用路径穿越漏洞将恶意 JSP 文件上传到服务器的任意目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果中多个链接都提到了该漏洞，并描述了其利用方式和风险。提供的 Python 脚本能够自动化利用该漏洞。

**投毒风险：**
分析提供的 exploit.py 和 shell.jsp 两个文件，没有发现明显的投毒代码。
*   `exploit.py`：此脚本的主要功能是上传 shell.jsp 并执行命令。它包含设置目标 URL、上传文件和执行命令的函数，不存在可疑或恶意的代码。
*   `shell.jsp`：此 JSP 文件实现了一个简单的 WebShell，允许通过 GET 请求执行系统命令。虽然 WebShell 本身具有潜在的风险，但其功能是明确的，不包含隐藏的恶意代码。
因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Apache Struts 2 应用，该应用使用了易受攻击的 FileuploadInterceptor 并且启用了文件上传功能。
2.  攻击者构造一个包含恶意路径的文件上传请求。例如，将文件名设置为 `../../../../tmp/shell.jsp`，尝试将文件上传到 `/tmp` 目录下。
3.  Struts 2 应用在处理文件上传请求时，由于存在路径穿越漏洞，会将恶意 JSP 文件上传到攻击者指定的目录。
4.  攻击者可以通过访问上传的 JSP 文件来执行任意系统命令。例如，访问 `http://example.com/tmp/shell.jsp?cmd=whoami` 可以在服务器上执行 `whoami` 命令，并将结果返回给攻击者。

**总结：**
CVE-2024-53677 是一个高危漏洞，利用难度相对较低，攻击者可以利用该漏洞完全控制服务器。建议受影响的用户尽快升级到最新版本，或采取缓解措施，如禁用易受攻击的 FileuploadInterceptor，并使用新的文件上传机制。

**项目地址:** [shishirghimir/CVE-2024-53677-Exploit](https://github.com/shishirghimir/CVE-2024-53677-Exploit)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #16

**来源**: [CVE-2024-53677-yangyanglo_CVE-2024-53677.md](../2024/CVE-2024-53677-yangyanglo_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < Version < 6.4.0

**利用条件:** 需要开启了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 框架中的文件上传漏洞，允许攻击者通过操纵文件上传参数，实现路径遍历，最终可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞确实存在，且具有较高的风险。提供的POC代码尝试利用此漏洞，其基本原理是通过修改上传的文件名参数，使其包含路径遍历字符（如`../`），从而将文件上传到Web服务器上非预期的目录中。POC代码通过`-u`指定上传地址，`-filename`指定包含路径遍历的文件名，`-file`指定需要上传的文件，`-type`指定上传类型(单文件或多文件)。如果服务器对上传的文件类型没有严格限制，攻击者可以上传包含恶意代码的JSP文件或其他脚本文件，从而执行任意命令。

**投毒风险：**
仔细审查了提供的POC代码（s2-067.py），没有发现任何明显的投毒代码。该脚本的主要功能是构造包含路径遍历的文件上传请求，并发送给目标服务器。脚本本身没有执行任何恶意操作，例如下载、执行其他程序或修改系统配置。因此，判断此仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  **确定目标：**  首先需要确定目标Apache Struts应用存在漏洞，并且使用了旧的文件上传机制（基于`FileuploadInterceptor`）。
2.  **构造恶意请求：**  使用POC代码或类似工具，构造包含路径遍历的文件上传请求。关键在于修改`filename`参数，使其包含`../`序列，指向Web服务器上可写目录。
3.  **上传恶意文件：**  将包含恶意代码的JSP文件（或其他类型的Web脚本文件）作为上传内容。
4.  **触发恶意代码：**  上传成功后，通过Web浏览器或其他工具访问上传的恶意文件，触发其中的代码执行。

**漏洞缓解措施:**

1. 升级到Apache Struts 6.4.0或更高版本。
2. 迁移到新的文件上传机制。
3. 如果无法迁移，限制上传文件的后缀名，使用自定义随机文件名称。

**项目地址:** [yangyanglo/CVE-2024-53677](https://github.com/yangyanglo/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---



---

## POC #5

**来源**: [CVE-2024-53677-SeanRickerd_CVE-2024-53677.md](../2024/CVE-2024-53677-SeanRickerd_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要Struts应用使用存在漏洞的FileuploadInterceptor旧文件上传机制

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以利用此漏洞，通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到服务器的任意目录。如果上传的文件是可执行脚本（如JSP），攻击者就可以通过访问该脚本来执行任意代码，最终实现远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 利用Struts的文件上传功能，通过修改上传参数，构造包含`../`的路径，绕过文件上传的限制，将文件上传到任意目录。
2.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP脚本。
3.  **远程代码执行：** 通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码有效。搜索结果中多个链接(如dynatrace, qualys, arcticwolf, sonicwall, nsfocusglobal, censys等)都提到了CVE-2024-53677漏洞，并且描述了通过文件上传路径遍历实现RCE。提供的Dockerfile和S2-067.py脚本，以及README.md文件，都提供了完整的漏洞复现环境和利用方法，证明了该漏洞的可利用性。

**投毒风险：**

虽然该POC提供了一个可用的漏洞利用方法，但存在轻微的投毒风险。原因是:

*   Dockerfile：Dockerfile构建过程相对清晰，构建了一个存在漏洞的Struts应用，并部署了tomcat，本身不包含恶意代码。然而，它从其他位置拷贝了`tomcat-users.xml`和`context.xml`配置文件，这些文件可能会包含恶意配置，例如预置的管理员账号密码或者允许任意IP访问manager接口，从而引入安全风险，但这些风险主要取决于这两个文件的具体内容。
*   S2-067.py：Python脚本用于利用该漏洞，其主要功能是上传文件。脚本本身的功能是路径遍历文件上传，本身不属于后门，但如果destination参数设置不当(如覆盖重要文件)，可能导致服务不可用。
*   README.md: README.md中提到了在Openshift上运行需要添加`oc adm policy add-scc-to-group anyuid system:authenticated`, 这在生产环境中是非常危险的，可能导致权限泄露.

综合评估，该仓库的投毒风险较低（约5%）。大部分代码用于漏洞复现，而非恶意行为。真正的风险在于`tomcat-users.xml`和`context.xml`可能存在的恶意配置，以及在Openshift部署时使用`anyuid`可能带来的权限泄露。因此需要仔细检查这些文件，并谨慎地进行部署。


**项目地址:** [SeanRickerd/CVE-2024-53677](https://github.com/SeanRickerd/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #6

**来源**: [CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历/RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统开启文件上传功能，并且使用存在漏洞的FileuploadInterceptor。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数来实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据漏洞库信息，该漏洞影响2.0.0到6.4.0之前的版本。升级到6.4.0或更高版本，并迁移到新的文件上传机制是主要的修复建议。

搜索引擎结果表明，该漏洞已被广泛讨论，并被认为对使用Apache Struts的企业构成重大威胁。多个来源强调了远程代码执行的潜在风险，并将其与过去的Struts漏洞（例如，Equifax breach）联系起来。利用的难易程度为中等，CVSS评分为9.5。

POC代码提供了一个检测脚本，该脚本尝试通过修改上传文件名来触发路径遍历。它通过设置`top.uploadFileName`参数来实现，并检查服务器响应中是否存在被覆盖的文件名。如果检测到文件名覆盖，则表明目标可能存在漏洞。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如使用`../../`来尝试写入Web目录之外的文件。
2.  服务器在处理文件上传时，未正确验证或清理上传的文件名或路径。
3.  攻击者成功将恶意文件（例如JSP webshell）上传到服务器的Web可访问目录。
4.  攻击者通过Web浏览器访问上传的恶意文件，从而执行任意代码。

**投毒风险评估：**

代码库中包含一个检测漏洞的脚本和一个简单的上传文件示例。没有发现任何明显的恶意代码，例如反向shell、下载并执行任意程序的代码等。文件上传漏洞本身可能被用于投毒，但提供的脚本本身不包含额外的、作者隐藏的恶意功能。因此，投毒风险评估为0%。

**项目地址:** [TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #7

**来源**: [CVE-2024-53677-WhoisBulud_CVE-2024-53677.md](../2024/CVE-2024-53677-WhoisBulud_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，存在于2.0.0到6.4.0之前的版本中。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到受限制的目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且存在多个公开的利用方法。提供的POC代码尝试通过修改`uploadFileName`参数来将JSP webshell上传到webapps/ROOT/目录下，从而实现远程代码执行。

**投毒风险：**
检查提供的POC代码，没有发现明显的投毒行为。该脚本只是一个简单的webshell上传工具，没有执行任何恶意操作，例如安装后门、窃取信息等。因此，投毒风险评估为0%。

**利用方式：**
1.  **路径穿越:** 攻击者利用Struts框架在处理文件上传时的缺陷，通过修改上传文件的文件名参数（`uploadFileName`），构造包含路径穿越字符（如`../`）的文件名。
2.  **上传恶意文件:** 通过路径穿越，攻击者可以将恶意文件（如JSP webshell）上传到Web服务器的任意目录下，突破Web服务器的访问限制。
3.  **远程代码执行:** 上传的恶意文件被Web服务器执行，攻击者可以通过访问该文件来执行任意系统命令，从而完全控制服务器。

**项目地址:** [WhoisBulud/CVE-2024-53677](https://github.com/WhoisBulud/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #8

**来源**: [CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统使用基于FileuploadInterceptor的旧文件上传逻辑，且可通过网络访问上传接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 的文件上传漏洞，允许攻击者通过操纵文件上传参数实现路径遍历，从而上传恶意文件到任意目录，最终可能导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中包含了多个安全厂商和研究人员对该漏洞的分析和利用案例，表明该漏洞已被广泛关注和验证。提供的 POC 代码通过修改上传文件名参数，尝试将文件上传到目标系统的任意目录，这是一种典型的路径遍历攻击方式。

**投毒风险分析：**

审查提供的 POC 代码，该脚本主要用于检测目标系统是否存在 CVE-2024-53677 漏洞，其核心功能是通过构造恶意的 multipart 请求，尝试上传一个包含特定内容的文件到目标系统的任意目录。脚本本身不包含任何用于执行恶意操作（如安装后门、窃取数据等）的代码，其目的仅在于验证漏洞的存在性。因此，该 POC 代码存在投毒代码的风险较低。

**利用方式分析：**

利用 CVE-2024-53677 漏洞的一般步骤如下：

1.  **确定目标系统：** 确定目标系统使用的 Apache Struts 版本在受影响范围内。
2.  **寻找上传接口：** 寻找目标系统提供的文件上传接口，这些接口通常基于 FileuploadInterceptor 实现。
3.  **构造恶意请求：** 构造包含恶意文件名的 multipart 请求，利用路径遍历将恶意文件上传到目标系统的任意目录，例如 Web 容器的部署目录。
4.  **执行恶意代码：** 通过访问上传的恶意文件，触发恶意代码的执行，实现远程代码执行。

该漏洞的利用需要目标系统存在基于 `FileuploadInterceptor` 的文件上传功能，且该功能存在缺陷，允许攻击者通过操纵文件名参数实现路径遍历。如果目标系统使用了新的文件上传机制，则不会受到该漏洞的影响。

**项目地址:** [XiaomingX/CVE-2024-53677-S2-067](https://github.com/XiaomingX/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #9

**来源**: [CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md](../2024/CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md)

## CVE-2024-53677-Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了基于 FileUploadInterceptor 的文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径穿越，将恶意文件上传到任意目录，从而可能导致远程代码执行。

**有效性评估：**

根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果均表明这是一个高危漏洞，且存在被利用的风险。POC代码提供了一个Docker环境，用于复现该漏洞。README.md 文件中描述了如何构建和运行该环境，以及漏洞利用的关键修改，例如使用 FileUploadInterceptor 和禁用文件类型验证，进一步降低了复现漏洞的难度。

**投毒风险评估：**

*   **Dockerfile：** Dockerfile用于构建包含漏洞的Struts2应用，本身不包含恶意代码。使用Tomcat作为容器，并复制编译好的WAR包部署。
*   **README.md：** 提供了漏洞复现环境的搭建说明，没有发现恶意代码。
*   **context.xml：** Tomcat的上下文配置文件，设置了一些安全属性，如`antiResourceLocking`和`privileged`，以及CookieProcessor，虽然可能存在配置错误导致其他问题，但本身不是投毒代码。
*   **tomcat-users.xml：** 用于配置Tomcat的用户和角色，包含一个默认的管理员账户admin/trackflaw，这本身是**非常危险**的，因为它使用了一个硬编码的密码。虽然这个默认账户方便漏洞验证，但在真实环境中应该**立即删除或修改密码**。将默认密码作为投毒行为的风险评估较低，因为这通常被认为是配置不当，而非恶意植入。
*   **struts-app/mvnw：** Maven Wrapper，用于在没有安装Maven的环境下构建项目，没有发现恶意代码。

总体评估，代码本身未发现明显的恶意后门。高危操作是设置了默认Tomcat管理员账户，**但这个缺陷更偏向于配置问题，而非有意植入的后门**。考虑到默认账号和密码可能被利用，存在一定的安全风险，将投毒风险评估为10%。

**利用方式分析：**

1.  **环境搭建：** 使用提供的Dockerfile构建包含漏洞的Struts2应用。
2.  **路径穿越：** 通过修改文件上传的参数（例如文件名），构造包含“../”的路径，使文件上传到web目录之外的位置，例如Tomcat的`webapps`目录之外。
3.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP Webshell。
4.  **远程代码执行：** 通过访问上传的恶意文件，触发恶意代码的执行，从而获得服务器的控制权。

关键在于构造恶意的文件名，利用路径穿越绕过Struts的文件上传检查，将恶意文件上传到可执行的位置。

**项目地址:** [c4oocO/CVE-2024-53677-Docker](https://github.com/c4oocO/CVE-2024-53677-Docker)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #10

**来源**: [CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md](../2024/CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑，并且允许用户控制上传文件名参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到服务器的任意目录，从而可能执行远程代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞真实存在且危害严重。POC 代码通过修改`top.uploadFileName`参数尝试将文件上传到目标目录，证明了路径穿越的可能性。POC代码的检测部分通过发送包含恶意文件名的上传请求来检查目标服务器是否易受攻击。如果服务器返回包含恶意文件名的响应，则表明存在漏洞，s2-067-poc.py可以用于上传恶意jsp脚本从而实现rce。

**投毒风险分析：**

检视提供的三个文件：

*   `Check-CVE-2024-53677.py`: 这是一个漏洞检测脚本，旨在非破坏性地检测目标服务器是否存在 CVE-2024-53677 漏洞。它通过上传一个带有修改后文件名的文件来判断是否存在漏洞，基本没有发现异常行为。
*   `README.md`: 这是一个描述 CVE-2024-53677 漏洞的说明文件，包含漏洞描述、影响、修复建议等信息，没有发现投毒代码。
*   `s2-067-poc.py`: 这是一个漏洞利用脚本，用于利用 CVE-2024-53677 漏洞上传恶意 JSP 文件，从而实现远程代码执行。尽管其功能是利用漏洞，但本身也属于漏洞利用代码范畴，考虑到会上传jsp脚本，存在一定后门风险。

总体而言，投毒风险较低，但存在jsp后门文件上传风险需要注意。

**利用方式：**

1.  **路径穿越：** 攻击者通过修改文件上传请求中的文件名参数（例如`top.uploadFileName`），使其包含路径穿越符（如`../`），从而突破服务器的文件上传目录限制。
2.  **恶意文件上传：** 攻击者利用路径穿越，将恶意文件（如 JSP webshell）上传到服务器的可执行目录（如 Web 应用程序的根目录）。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**防范措施：**

*   升级 Apache Struts 到 6.4.0 或更高版本。
*   使用 Struts 提供的新的文件上传机制，避免使用基于 `FileuploadInterceptor` 的旧文件上传逻辑。
*   对用户上传的文件名进行严格的验证和过滤，防止路径穿越攻击。
*   限制文件上传目录的执行权限。

**项目地址:** [cloudwafs/s2-067-CVE-2024-53677](https://github.com/cloudwafs/s2-067-CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #11

**来源**: [CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md](../2024/CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 6.3.x (不包含6.4.0)

**利用条件:** 目标系统使用了存在漏洞的Struts版本，并且开启了基于`FileuploadInterceptor`的文件上传功能。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，利用路径遍历漏洞将恶意文件上传到服务器的任意位置，如果上传的文件是可执行脚本（例如JSP），则可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被认为是高危漏洞，存在远程代码执行的风险。多个安全博客和漏洞库（如NVD, RedHat, Arctic Wolf, Dynatrace, SonicWall, Censys, NSFocus, Qualys）都对此漏洞进行了分析和报告。提供的POC代码通过构造包含路径遍历的multipart/form-data请求，尝试将JSP文件上传到服务器的特定目录。代码中包含了生成随机文件名、创建混淆JSP Payload、上传文件、验证上传文件等功能。因此，提供的POC代码是有效的，可以用来验证和利用该漏洞。

**投毒风险分析：**

该POC代码的投毒风险较低，约为1%。主要原因如下：

*   代码功能相对清晰：该代码主要用于文件上传和验证，逻辑较为简单，没有明显的恶意代码或隐藏功能。
*   混淆载荷：使用了Base64编码混淆了JSP payload，但目的是为了避免直接检测，而不是隐藏恶意行为。decode后的JSP payload功能也是在目标服务器执行命令，方便验证RCE.
*   参数可控：上传路径、文件名、Payload等关键参数都通过命令行参数进行控制，用户可以自定义这些参数，从而降低了被植入恶意代码的风险。
*   缺乏持久化手段：该代码主要用于漏洞验证，不会在目标系统上安装后门或执行其他持久化操作。
*   文件读取操作的透明性：从文件读取URL列表的操作也相对透明，用户可以检查文件内容，确认URL的合法性。

**利用方式：**

1.  **确定目标:** 首先需要确定目标系统是否使用了存在漏洞的Apache Struts版本，且使用了`FileuploadInterceptor`。
2.  **构造恶意请求:** 使用POC代码，构造包含路径遍历的文件上传请求。通过修改上传文件的路径参数，尝试将JSP文件上传到服务器的Web目录或其他可执行目录（例如：`../../../../../webapps/ROOT`或`/tmp`）。
3.  **上传JSP Payload:** 上传包含恶意代码的JSP文件。POC代码中使用了混淆的JSP Payload，该Payload的功能是执行指定的命令。
4.  **访问上传的文件:** 通过Web浏览器或HTTP客户端访问上传的JSP文件。如果文件上传成功且可执行，服务器将执行JSP Payload中的代码。
5.  **执行任意命令:** 通过在URL中添加`cmd`参数，可以执行任意系统命令（例如：`http://example.com/uploaded/malicious.jsp?cmd=whoami`）。
6.  **远程代码执行:** 如果攻击成功，攻击者可以在目标服务器上执行任意代码，从而完全控制该服务器。


**项目地址:** [dustblessnotdust/CVE-2024-53677-S2-067-thread](https://github.com/dustblessnotdust/CVE-2024-53677-S2-067-thread)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #12

**来源**: [CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md](../2024/CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md)

## CVE-2024-53677-Apache Struts文件上传RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 启用了基于 FileUploadInterceptor 的旧文件上传逻辑，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来实现路径遍历，从而上传恶意文件并执行远程代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。多个来源表明该漏洞已在实际环境中被利用，并且存在公开可用的利用代码。

**投毒风险：**

分析提供的漏洞利用代码（/tmp/6fab2f844aba42ca86705ccc230e42e1/README.md）：

*   该代码描述了一个利用 CVE-2024-53677 的方法，涉及修改文件上传请求，通过 OGNL 表达式注入参数，绕过文件类型限制，并将恶意 JSP payload 附加到上传的文件中。
*   payload部分给出的是引用外部shell.jsp的代码，需要进一步分析shell.jsp本身，因为仅仅看readme.md本身无法确定payload是否安全
*   exploit.py同样是引用外部脚本，需要关注其代码是否包含恶意操作
*   python3 http.server -m 3004 命令用于提供web服务，有被用于恶意文件分发的可能性

综合考虑，该仓库存在一定投毒风险，但考虑到提供的步骤是为了利用漏洞进行渗透测试，恶意行为通常与渗透测试的目标有关。由于需要引用的shell.jsp和python脚本来源未知，不能排除恶意脚本的存在，考虑到脚本存在从外部拉取，存在潜在的风险。所以给出10%的投毒风险评估。

**利用方式：**

1.  **识别攻击向量：** 找到存在文件上传功能的页面。
2.  **版本确认：** 确定目标 Apache Struts 的版本是否在受影响范围内（2.0.0 到 6.4.0 之前）。可以通过查找 `pom.xml` 文件等方式确认。
3.  **修改文件上传请求：** 使用 BurpSuite 等工具截获文件上传请求，添加利用 OGNL 的参数，例如：
    ```
    ...(上传的文件内容).&{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','freak')}.&{(#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().getValue('rand')).getRuntime().exec('touch /tmp/success')}
    ```
4.  **附加 Payload：** 将 JSP payload 附加到上传的文件数据中，例如使用 webshell 。
5.  **发送请求：** 发送修改后的请求。
6.  **访问 Payload：** 访问上传的 JSP 文件，触发 payload 执行。
7.  **获取 Shell：** 如果 payload 是 webshell，则可以通过 webshell 执行任意命令，例如建立反向 shell。

**项目地址:** [hopsypopsy8/CVE-2024-53677-Exploitation](https://github.com/hopsypopsy8/CVE-2024-53677-Exploitation)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #13

**来源**: [CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md](../2024/CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传漏洞

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用 FileuploadInterceptor 的 Struts 应用，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞。攻击者可以操纵文件上传参数，利用路径遍历漏洞将文件上传到受限目录，从而可能导致远程代码执行。

**有效性：**
漏洞库信息和搜索结果均表明该漏洞是真实存在的，且风险较高，多个安全厂商发布了相关预警和分析报告。提供的 POC 代码利用了参数覆盖和路径遍历来上传文件，并验证文件是否可访问，如果目标是WebShell，还可以执行命令。此利用方式较为常见且有效。

**投毒风险：**
查看提供的`exploit.py`脚本，该脚本主要功能是利用multipart/form-data上传文件，并通过`destination_path`参数来控制上传文件的路径，存在以下几个需要关注的点：

1.  **`simulate_i18n_errors()`函数**：虽然该函数只是模拟国际化错误，但如果被恶意修改，可能会引入其他潜在的攻击向量。
2.  **`execute_remote_command()`函数**：这个函数允许执行远程命令，是漏洞利用的关键部分。如果被篡改，可能导致意外的系统行为。
3.  **依赖库**：`requests`和`requests_toolbelt`是常用的库，但如果被替换为恶意版本，可能导致信息泄露或者代码执行。

此外，`README.md`中引用的YouTube视频链接和GitHub仓库链接也存在一定的风险，例如链接可能指向恶意网站或包含恶意代码的仓库。

考虑到以上因素，该仓库存在一定的投毒风险，但主要是因为利用过程中涉及远程代码执行，如果验证的webshell存在后门也可能导致被控，而并非作者主动投毒。综合评估投毒风险在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名，利用“../”等相对路径，将文件上传到Web服务器的任意目录，绕过上传限制。
2.  **参数覆盖：**  利用Struts框架的特性，覆盖文件上传相关的参数，例如`top.UploadFileName`，从而指定上传文件的目标路径。
3.  **上传恶意文件：**  上传包含恶意代码的文件，例如JSP WebShell，然后通过访问该文件来执行任意命令。
4.  **远程代码执行：** 结合路径遍历和恶意文件上传，攻击者可以在Web服务器上执行任意代码，控制服务器。

总的来说，攻击者通过构造恶意请求，欺骗服务器，最终实现远程代码执行。漏洞利用需要目标应用使用了易受攻击的`FileuploadInterceptor`。

**项目地址:** [punitdarji/Apache-struts-cve-2024-53677](https://github.com/punitdarji/Apache-struts-cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #14

**来源**: [CVE-2024-53677-r007sec_CVE-2024-53677.md](../2024/CVE-2024-53677-r007sec_CVE-2024-53677.md)

## CVE-2024-53677: Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 到 6.4.0 之前

**利用条件:** Apache Struts应用使用了基于FileuploadInterceptor的旧文件上传机制，且攻击者可以访问上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Apache Struts的旧文件上传逻辑中。攻击者可以通过操纵文件上传参数，进行路径遍历，从而将恶意文件上传到任意位置，例如Web容器的webapp目录，进而执行恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞利用是有效的。多个来源均指出 CVE-2024-53677 是一个严重的文件上传漏洞，攻击者可以利用它进行路径遍历和远程代码执行。提供的PoC代码包含一个可以上传WAR包的exploit，以及手动利用的multipart/form-data请求示例，证实了该漏洞的可利用性。

**投毒风险：**
PoC代码存在一定程度的投毒风险。虽然PoC的主要功能是利用漏洞，但其中可能隐藏一些不易察觉的恶意代码，例如：
1.  **WAR包内容：** exploit.py 脚本创建的WAR文件(webshell.war)本身可能包含后门代码。在没有仔细检查的情况下部署这个WAR包可能导致服务器被植入恶意程序。
2.  **上传逻辑修改：** 攻击者可能修改上传逻辑，例如在上传过程中记录服务器信息，或者尝试执行其他未授权操作。
3.  **依赖风险：** requirements.txt 中列出的依赖包可能包含恶意代码或安全漏洞。使用受污染的依赖包可能导致安全风险。
4.  **GIF89a头注入:**  虽然是为了绕过上传检查，但可能存在利用GIF解析漏洞的风险。虽然可能性较低，但是仍然需要考虑。
总体而言，考虑到WAR包本身是用来执行命令的，因此很难完全排除投毒的可能。如果用户盲目执行，并且没有对生成的WAR包进行检查，则存在风险。因此，投毒风险评估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名参数，使其包含`../`这样的路径遍历字符，从而能够将文件上传到服务器上的任意目录。
2.  **上传恶意文件：** 攻击者通常上传包含恶意代码的文件，例如JSP webshell或者WAR包，这些文件一旦被Web服务器解析，就可以执行任意命令。
3.  **远程代码执行：** 通过上传的恶意文件，攻击者可以在服务器上执行任意命令，从而完全控制服务器。

**总结：**
CVE-2024-53677是一个高危漏洞，利用简单，危害巨大。用户应该尽快升级到安全版本，或者采取其他缓解措施，例如禁用旧的文件上传功能。

**项目地址:** [r007sec/CVE-2024-53677](https://github.com/r007sec/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #15

**来源**: [CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md](../2024/CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用基于 FileuploadInterceptor 的旧文件上传逻辑，且可访问 upload.action 接口。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2024-53677 漏洞存在于 Apache Struts 的文件上传逻辑中。攻击者可以通过操纵文件上传参数实现路径遍历，从而上传恶意文件，例如 JSP webshell，最终导致远程代码执行。

**漏洞利用方式：**

1.  **确定目标应用是否使用存在漏洞的 Struts 版本** (2.0.0 到 6.3.x)。
2.  **确定目标应用是否使用基于 FileuploadInterceptor 的文件上传机制**。
3.  **发送包含恶意构造的`top.UploadFileName`参数的 POST 请求到 `upload.action` 接口**。`top.UploadFileName`参数用于指定上传文件的目标路径，攻击者可以通过该参数进行路径遍历，将文件上传到任意目录。
4.  **上传包含恶意代码的文件（如 JSP webshell）**。PoC 中使用了JSP webshell，允许执行服务器端命令。
5.  **通过访问上传的webshell执行任意命令。** PoC 上传 webshell 后，通过构造特定的 URL 参数 `action=cmd&cmd=<command>` 来执行命令。

**有效性评估：**

提供的PoC 代码有效，可以利用该漏洞实现文件上传和远程代码执行。PoC 包含两个 Python 脚本：

*   `PoC.py`:  该脚本通过 POST 请求上传包含 webshell 代码的 JSP 文件，并设置 `top.UploadFileName` 参数为目标路径，实现路径遍历和 webshell 上传。上传成功后，通过 GET 请求访问 webshell，执行指定的命令。
*   `cve_2024_53677_Tool.py`:  该脚本提供了一个交互式菜单，用于检测 Struts 版本、检查漏洞是否存在、上传测试文件和 webshell，并在 Selenium 中打开 webshell。功能更全面，方便漏洞利用。

**投毒风险评估：**

PoC代码中存在极小的投毒风险。PoC 主要功能是漏洞利用，将后门代码封装在webshell里，不算投毒。投毒代码可能藏在以下几点：

1.  **Webshell 代码本身**： 虽然 webshell 的主要目的是执行命令，但开发者可以加入其他恶意代码，例如收集服务器信息、植入持久性后门等。但PoC提供的webshell比较简单，主要的功能是命令执行。
2.  **工具脚本**（`cve_2024_53677_Tool.py`）： 该脚本拥有更多功能，可能在版本检测、文件上传等过程中隐藏恶意代码，例如修改上传文件的内容、记录用户输入等。
3.  **依赖库**：PoC 使用了 `requests` 和（可选）`selenium` 库。虽然这些库本身是安全的，但如果作者使用了恶意修改过的版本，可能会引入安全风险。

**综合评估，投毒风险较低（2%）。主要风险在于 webshell 本身可能存在恶意代码，以及对未知来源脚本的不信任。建议仔细审查代码，并使用可信的依赖库。**

**项目地址:** [seoyoung-kang/CVE-2024-53677](https://github.com/seoyoung-kang/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #16

**来源**: [CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md](../2024/CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越 RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用了存在漏洞的FileuploadInterceptor且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是 Apache Struts 2 中一个严重的文件上传漏洞。攻击者可以通过构造恶意的文件上传请求，利用路径穿越漏洞将恶意 JSP 文件上传到服务器的任意目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果中多个链接都提到了该漏洞，并描述了其利用方式和风险。提供的 Python 脚本能够自动化利用该漏洞。

**投毒风险：**
分析提供的 exploit.py 和 shell.jsp 两个文件，没有发现明显的投毒代码。
*   `exploit.py`：此脚本的主要功能是上传 shell.jsp 并执行命令。它包含设置目标 URL、上传文件和执行命令的函数，不存在可疑或恶意的代码。
*   `shell.jsp`：此 JSP 文件实现了一个简单的 WebShell，允许通过 GET 请求执行系统命令。虽然 WebShell 本身具有潜在的风险，但其功能是明确的，不包含隐藏的恶意代码。
因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Apache Struts 2 应用，该应用使用了易受攻击的 FileuploadInterceptor 并且启用了文件上传功能。
2.  攻击者构造一个包含恶意路径的文件上传请求。例如，将文件名设置为 `../../../../tmp/shell.jsp`，尝试将文件上传到 `/tmp` 目录下。
3.  Struts 2 应用在处理文件上传请求时，由于存在路径穿越漏洞，会将恶意 JSP 文件上传到攻击者指定的目录。
4.  攻击者可以通过访问上传的 JSP 文件来执行任意系统命令。例如，访问 `http://example.com/tmp/shell.jsp?cmd=whoami` 可以在服务器上执行 `whoami` 命令，并将结果返回给攻击者。

**总结：**
CVE-2024-53677 是一个高危漏洞，利用难度相对较低，攻击者可以利用该漏洞完全控制服务器。建议受影响的用户尽快升级到最新版本，或采取缓解措施，如禁用易受攻击的 FileuploadInterceptor，并使用新的文件上传机制。

**项目地址:** [shishirghimir/CVE-2024-53677-Exploit](https://github.com/shishirghimir/CVE-2024-53677-Exploit)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #17

**来源**: [CVE-2024-53677-yangyanglo_CVE-2024-53677.md](../2024/CVE-2024-53677-yangyanglo_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < Version < 6.4.0

**利用条件:** 需要开启了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 框架中的文件上传漏洞，允许攻击者通过操纵文件上传参数，实现路径遍历，最终可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞确实存在，且具有较高的风险。提供的POC代码尝试利用此漏洞，其基本原理是通过修改上传的文件名参数，使其包含路径遍历字符（如`../`），从而将文件上传到Web服务器上非预期的目录中。POC代码通过`-u`指定上传地址，`-filename`指定包含路径遍历的文件名，`-file`指定需要上传的文件，`-type`指定上传类型(单文件或多文件)。如果服务器对上传的文件类型没有严格限制，攻击者可以上传包含恶意代码的JSP文件或其他脚本文件，从而执行任意命令。

**投毒风险：**
仔细审查了提供的POC代码（s2-067.py），没有发现任何明显的投毒代码。该脚本的主要功能是构造包含路径遍历的文件上传请求，并发送给目标服务器。脚本本身没有执行任何恶意操作，例如下载、执行其他程序或修改系统配置。因此，判断此仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  **确定目标：**  首先需要确定目标Apache Struts应用存在漏洞，并且使用了旧的文件上传机制（基于`FileuploadInterceptor`）。
2.  **构造恶意请求：**  使用POC代码或类似工具，构造包含路径遍历的文件上传请求。关键在于修改`filename`参数，使其包含`../`序列，指向Web服务器上可写目录。
3.  **上传恶意文件：**  将包含恶意代码的JSP文件（或其他类型的Web脚本文件）作为上传内容。
4.  **触发恶意代码：**  上传成功后，通过Web浏览器或其他工具访问上传的恶意文件，触发其中的代码执行。

**漏洞缓解措施:**

1. 升级到Apache Struts 6.4.0或更高版本。
2. 迁移到新的文件上传机制。
3. 如果无法迁移，限制上传文件的后缀名，使用自定义随机文件名称。

**项目地址:** [yangyanglo/CVE-2024-53677](https://github.com/yangyanglo/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---



---

## POC #5

**来源**: [CVE-2024-53677-SeanRickerd_CVE-2024-53677.md](../2024/CVE-2024-53677-SeanRickerd_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要Struts应用使用存在漏洞的FileuploadInterceptor旧文件上传机制

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以利用此漏洞，通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到服务器的任意目录。如果上传的文件是可执行脚本（如JSP），攻击者就可以通过访问该脚本来执行任意代码，最终实现远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 利用Struts的文件上传功能，通过修改上传参数，构造包含`../`的路径，绕过文件上传的限制，将文件上传到任意目录。
2.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP脚本。
3.  **远程代码执行：** 通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码有效。搜索结果中多个链接(如dynatrace, qualys, arcticwolf, sonicwall, nsfocusglobal, censys等)都提到了CVE-2024-53677漏洞，并且描述了通过文件上传路径遍历实现RCE。提供的Dockerfile和S2-067.py脚本，以及README.md文件，都提供了完整的漏洞复现环境和利用方法，证明了该漏洞的可利用性。

**投毒风险：**

虽然该POC提供了一个可用的漏洞利用方法，但存在轻微的投毒风险。原因是:

*   Dockerfile：Dockerfile构建过程相对清晰，构建了一个存在漏洞的Struts应用，并部署了tomcat，本身不包含恶意代码。然而，它从其他位置拷贝了`tomcat-users.xml`和`context.xml`配置文件，这些文件可能会包含恶意配置，例如预置的管理员账号密码或者允许任意IP访问manager接口，从而引入安全风险，但这些风险主要取决于这两个文件的具体内容。
*   S2-067.py：Python脚本用于利用该漏洞，其主要功能是上传文件。脚本本身的功能是路径遍历文件上传，本身不属于后门，但如果destination参数设置不当(如覆盖重要文件)，可能导致服务不可用。
*   README.md: README.md中提到了在Openshift上运行需要添加`oc adm policy add-scc-to-group anyuid system:authenticated`, 这在生产环境中是非常危险的，可能导致权限泄露.

综合评估，该仓库的投毒风险较低（约5%）。大部分代码用于漏洞复现，而非恶意行为。真正的风险在于`tomcat-users.xml`和`context.xml`可能存在的恶意配置，以及在Openshift部署时使用`anyuid`可能带来的权限泄露。因此需要仔细检查这些文件，并谨慎地进行部署。


**项目地址:** [SeanRickerd/CVE-2024-53677](https://github.com/SeanRickerd/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #6

**来源**: [CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历/RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统开启文件上传功能，并且使用存在漏洞的FileuploadInterceptor。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数来实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据漏洞库信息，该漏洞影响2.0.0到6.4.0之前的版本。升级到6.4.0或更高版本，并迁移到新的文件上传机制是主要的修复建议。

搜索引擎结果表明，该漏洞已被广泛讨论，并被认为对使用Apache Struts的企业构成重大威胁。多个来源强调了远程代码执行的潜在风险，并将其与过去的Struts漏洞（例如，Equifax breach）联系起来。利用的难易程度为中等，CVSS评分为9.5。

POC代码提供了一个检测脚本，该脚本尝试通过修改上传文件名来触发路径遍历。它通过设置`top.uploadFileName`参数来实现，并检查服务器响应中是否存在被覆盖的文件名。如果检测到文件名覆盖，则表明目标可能存在漏洞。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如使用`../../`来尝试写入Web目录之外的文件。
2.  服务器在处理文件上传时，未正确验证或清理上传的文件名或路径。
3.  攻击者成功将恶意文件（例如JSP webshell）上传到服务器的Web可访问目录。
4.  攻击者通过Web浏览器访问上传的恶意文件，从而执行任意代码。

**投毒风险评估：**

代码库中包含一个检测漏洞的脚本和一个简单的上传文件示例。没有发现任何明显的恶意代码，例如反向shell、下载并执行任意程序的代码等。文件上传漏洞本身可能被用于投毒，但提供的脚本本身不包含额外的、作者隐藏的恶意功能。因此，投毒风险评估为0%。

**项目地址:** [TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #7

**来源**: [CVE-2024-53677-WhoisBulud_CVE-2024-53677.md](../2024/CVE-2024-53677-WhoisBulud_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，存在于2.0.0到6.4.0之前的版本中。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到受限制的目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且存在多个公开的利用方法。提供的POC代码尝试通过修改`uploadFileName`参数来将JSP webshell上传到webapps/ROOT/目录下，从而实现远程代码执行。

**投毒风险：**
检查提供的POC代码，没有发现明显的投毒行为。该脚本只是一个简单的webshell上传工具，没有执行任何恶意操作，例如安装后门、窃取信息等。因此，投毒风险评估为0%。

**利用方式：**
1.  **路径穿越:** 攻击者利用Struts框架在处理文件上传时的缺陷，通过修改上传文件的文件名参数（`uploadFileName`），构造包含路径穿越字符（如`../`）的文件名。
2.  **上传恶意文件:** 通过路径穿越，攻击者可以将恶意文件（如JSP webshell）上传到Web服务器的任意目录下，突破Web服务器的访问限制。
3.  **远程代码执行:** 上传的恶意文件被Web服务器执行，攻击者可以通过访问该文件来执行任意系统命令，从而完全控制服务器。

**项目地址:** [WhoisBulud/CVE-2024-53677](https://github.com/WhoisBulud/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #8

**来源**: [CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统使用基于FileuploadInterceptor的旧文件上传逻辑，且可通过网络访问上传接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 的文件上传漏洞，允许攻击者通过操纵文件上传参数实现路径遍历，从而上传恶意文件到任意目录，最终可能导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中包含了多个安全厂商和研究人员对该漏洞的分析和利用案例，表明该漏洞已被广泛关注和验证。提供的 POC 代码通过修改上传文件名参数，尝试将文件上传到目标系统的任意目录，这是一种典型的路径遍历攻击方式。

**投毒风险分析：**

审查提供的 POC 代码，该脚本主要用于检测目标系统是否存在 CVE-2024-53677 漏洞，其核心功能是通过构造恶意的 multipart 请求，尝试上传一个包含特定内容的文件到目标系统的任意目录。脚本本身不包含任何用于执行恶意操作（如安装后门、窃取数据等）的代码，其目的仅在于验证漏洞的存在性。因此，该 POC 代码存在投毒代码的风险较低。

**利用方式分析：**

利用 CVE-2024-53677 漏洞的一般步骤如下：

1.  **确定目标系统：** 确定目标系统使用的 Apache Struts 版本在受影响范围内。
2.  **寻找上传接口：** 寻找目标系统提供的文件上传接口，这些接口通常基于 FileuploadInterceptor 实现。
3.  **构造恶意请求：** 构造包含恶意文件名的 multipart 请求，利用路径遍历将恶意文件上传到目标系统的任意目录，例如 Web 容器的部署目录。
4.  **执行恶意代码：** 通过访问上传的恶意文件，触发恶意代码的执行，实现远程代码执行。

该漏洞的利用需要目标系统存在基于 `FileuploadInterceptor` 的文件上传功能，且该功能存在缺陷，允许攻击者通过操纵文件名参数实现路径遍历。如果目标系统使用了新的文件上传机制，则不会受到该漏洞的影响。

**项目地址:** [XiaomingX/CVE-2024-53677-S2-067](https://github.com/XiaomingX/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #9

**来源**: [CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md](../2024/CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md)

## CVE-2024-53677-Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了基于 FileUploadInterceptor 的文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径穿越，将恶意文件上传到任意目录，从而可能导致远程代码执行。

**有效性评估：**

根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果均表明这是一个高危漏洞，且存在被利用的风险。POC代码提供了一个Docker环境，用于复现该漏洞。README.md 文件中描述了如何构建和运行该环境，以及漏洞利用的关键修改，例如使用 FileUploadInterceptor 和禁用文件类型验证，进一步降低了复现漏洞的难度。

**投毒风险评估：**

*   **Dockerfile：** Dockerfile用于构建包含漏洞的Struts2应用，本身不包含恶意代码。使用Tomcat作为容器，并复制编译好的WAR包部署。
*   **README.md：** 提供了漏洞复现环境的搭建说明，没有发现恶意代码。
*   **context.xml：** Tomcat的上下文配置文件，设置了一些安全属性，如`antiResourceLocking`和`privileged`，以及CookieProcessor，虽然可能存在配置错误导致其他问题，但本身不是投毒代码。
*   **tomcat-users.xml：** 用于配置Tomcat的用户和角色，包含一个默认的管理员账户admin/trackflaw，这本身是**非常危险**的，因为它使用了一个硬编码的密码。虽然这个默认账户方便漏洞验证，但在真实环境中应该**立即删除或修改密码**。将默认密码作为投毒行为的风险评估较低，因为这通常被认为是配置不当，而非恶意植入。
*   **struts-app/mvnw：** Maven Wrapper，用于在没有安装Maven的环境下构建项目，没有发现恶意代码。

总体评估，代码本身未发现明显的恶意后门。高危操作是设置了默认Tomcat管理员账户，**但这个缺陷更偏向于配置问题，而非有意植入的后门**。考虑到默认账号和密码可能被利用，存在一定的安全风险，将投毒风险评估为10%。

**利用方式分析：**

1.  **环境搭建：** 使用提供的Dockerfile构建包含漏洞的Struts2应用。
2.  **路径穿越：** 通过修改文件上传的参数（例如文件名），构造包含“../”的路径，使文件上传到web目录之外的位置，例如Tomcat的`webapps`目录之外。
3.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP Webshell。
4.  **远程代码执行：** 通过访问上传的恶意文件，触发恶意代码的执行，从而获得服务器的控制权。

关键在于构造恶意的文件名，利用路径穿越绕过Struts的文件上传检查，将恶意文件上传到可执行的位置。

**项目地址:** [c4oocO/CVE-2024-53677-Docker](https://github.com/c4oocO/CVE-2024-53677-Docker)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #10

**来源**: [CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md](../2024/CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑，并且允许用户控制上传文件名参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到服务器的任意目录，从而可能执行远程代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞真实存在且危害严重。POC 代码通过修改`top.uploadFileName`参数尝试将文件上传到目标目录，证明了路径穿越的可能性。POC代码的检测部分通过发送包含恶意文件名的上传请求来检查目标服务器是否易受攻击。如果服务器返回包含恶意文件名的响应，则表明存在漏洞，s2-067-poc.py可以用于上传恶意jsp脚本从而实现rce。

**投毒风险分析：**

检视提供的三个文件：

*   `Check-CVE-2024-53677.py`: 这是一个漏洞检测脚本，旨在非破坏性地检测目标服务器是否存在 CVE-2024-53677 漏洞。它通过上传一个带有修改后文件名的文件来判断是否存在漏洞，基本没有发现异常行为。
*   `README.md`: 这是一个描述 CVE-2024-53677 漏洞的说明文件，包含漏洞描述、影响、修复建议等信息，没有发现投毒代码。
*   `s2-067-poc.py`: 这是一个漏洞利用脚本，用于利用 CVE-2024-53677 漏洞上传恶意 JSP 文件，从而实现远程代码执行。尽管其功能是利用漏洞，但本身也属于漏洞利用代码范畴，考虑到会上传jsp脚本，存在一定后门风险。

总体而言，投毒风险较低，但存在jsp后门文件上传风险需要注意。

**利用方式：**

1.  **路径穿越：** 攻击者通过修改文件上传请求中的文件名参数（例如`top.uploadFileName`），使其包含路径穿越符（如`../`），从而突破服务器的文件上传目录限制。
2.  **恶意文件上传：** 攻击者利用路径穿越，将恶意文件（如 JSP webshell）上传到服务器的可执行目录（如 Web 应用程序的根目录）。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**防范措施：**

*   升级 Apache Struts 到 6.4.0 或更高版本。
*   使用 Struts 提供的新的文件上传机制，避免使用基于 `FileuploadInterceptor` 的旧文件上传逻辑。
*   对用户上传的文件名进行严格的验证和过滤，防止路径穿越攻击。
*   限制文件上传目录的执行权限。

**项目地址:** [cloudwafs/s2-067-CVE-2024-53677](https://github.com/cloudwafs/s2-067-CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #11

**来源**: [CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md](../2024/CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 6.3.x (不包含6.4.0)

**利用条件:** 目标系统使用了存在漏洞的Struts版本，并且开启了基于`FileuploadInterceptor`的文件上传功能。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，利用路径遍历漏洞将恶意文件上传到服务器的任意位置，如果上传的文件是可执行脚本（例如JSP），则可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被认为是高危漏洞，存在远程代码执行的风险。多个安全博客和漏洞库（如NVD, RedHat, Arctic Wolf, Dynatrace, SonicWall, Censys, NSFocus, Qualys）都对此漏洞进行了分析和报告。提供的POC代码通过构造包含路径遍历的multipart/form-data请求，尝试将JSP文件上传到服务器的特定目录。代码中包含了生成随机文件名、创建混淆JSP Payload、上传文件、验证上传文件等功能。因此，提供的POC代码是有效的，可以用来验证和利用该漏洞。

**投毒风险分析：**

该POC代码的投毒风险较低，约为1%。主要原因如下：

*   代码功能相对清晰：该代码主要用于文件上传和验证，逻辑较为简单，没有明显的恶意代码或隐藏功能。
*   混淆载荷：使用了Base64编码混淆了JSP payload，但目的是为了避免直接检测，而不是隐藏恶意行为。decode后的JSP payload功能也是在目标服务器执行命令，方便验证RCE.
*   参数可控：上传路径、文件名、Payload等关键参数都通过命令行参数进行控制，用户可以自定义这些参数，从而降低了被植入恶意代码的风险。
*   缺乏持久化手段：该代码主要用于漏洞验证，不会在目标系统上安装后门或执行其他持久化操作。
*   文件读取操作的透明性：从文件读取URL列表的操作也相对透明，用户可以检查文件内容，确认URL的合法性。

**利用方式：**

1.  **确定目标:** 首先需要确定目标系统是否使用了存在漏洞的Apache Struts版本，且使用了`FileuploadInterceptor`。
2.  **构造恶意请求:** 使用POC代码，构造包含路径遍历的文件上传请求。通过修改上传文件的路径参数，尝试将JSP文件上传到服务器的Web目录或其他可执行目录（例如：`../../../../../webapps/ROOT`或`/tmp`）。
3.  **上传JSP Payload:** 上传包含恶意代码的JSP文件。POC代码中使用了混淆的JSP Payload，该Payload的功能是执行指定的命令。
4.  **访问上传的文件:** 通过Web浏览器或HTTP客户端访问上传的JSP文件。如果文件上传成功且可执行，服务器将执行JSP Payload中的代码。
5.  **执行任意命令:** 通过在URL中添加`cmd`参数，可以执行任意系统命令（例如：`http://example.com/uploaded/malicious.jsp?cmd=whoami`）。
6.  **远程代码执行:** 如果攻击成功，攻击者可以在目标服务器上执行任意代码，从而完全控制该服务器。


**项目地址:** [dustblessnotdust/CVE-2024-53677-S2-067-thread](https://github.com/dustblessnotdust/CVE-2024-53677-S2-067-thread)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #12

**来源**: [CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md](../2024/CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md)

## CVE-2024-53677-Apache Struts文件上传RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 启用了基于 FileUploadInterceptor 的旧文件上传逻辑，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来实现路径遍历，从而上传恶意文件并执行远程代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。多个来源表明该漏洞已在实际环境中被利用，并且存在公开可用的利用代码。

**投毒风险：**

分析提供的漏洞利用代码（/tmp/6fab2f844aba42ca86705ccc230e42e1/README.md）：

*   该代码描述了一个利用 CVE-2024-53677 的方法，涉及修改文件上传请求，通过 OGNL 表达式注入参数，绕过文件类型限制，并将恶意 JSP payload 附加到上传的文件中。
*   payload部分给出的是引用外部shell.jsp的代码，需要进一步分析shell.jsp本身，因为仅仅看readme.md本身无法确定payload是否安全
*   exploit.py同样是引用外部脚本，需要关注其代码是否包含恶意操作
*   python3 http.server -m 3004 命令用于提供web服务，有被用于恶意文件分发的可能性

综合考虑，该仓库存在一定投毒风险，但考虑到提供的步骤是为了利用漏洞进行渗透测试，恶意行为通常与渗透测试的目标有关。由于需要引用的shell.jsp和python脚本来源未知，不能排除恶意脚本的存在，考虑到脚本存在从外部拉取，存在潜在的风险。所以给出10%的投毒风险评估。

**利用方式：**

1.  **识别攻击向量：** 找到存在文件上传功能的页面。
2.  **版本确认：** 确定目标 Apache Struts 的版本是否在受影响范围内（2.0.0 到 6.4.0 之前）。可以通过查找 `pom.xml` 文件等方式确认。
3.  **修改文件上传请求：** 使用 BurpSuite 等工具截获文件上传请求，添加利用 OGNL 的参数，例如：
    ```
    ...(上传的文件内容).&{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','freak')}.&{(#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().getValue('rand')).getRuntime().exec('touch /tmp/success')}
    ```
4.  **附加 Payload：** 将 JSP payload 附加到上传的文件数据中，例如使用 webshell 。
5.  **发送请求：** 发送修改后的请求。
6.  **访问 Payload：** 访问上传的 JSP 文件，触发 payload 执行。
7.  **获取 Shell：** 如果 payload 是 webshell，则可以通过 webshell 执行任意命令，例如建立反向 shell。

**项目地址:** [hopsypopsy8/CVE-2024-53677-Exploitation](https://github.com/hopsypopsy8/CVE-2024-53677-Exploitation)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #13

**来源**: [CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md](../2024/CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传漏洞

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用 FileuploadInterceptor 的 Struts 应用，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞。攻击者可以操纵文件上传参数，利用路径遍历漏洞将文件上传到受限目录，从而可能导致远程代码执行。

**有效性：**
漏洞库信息和搜索结果均表明该漏洞是真实存在的，且风险较高，多个安全厂商发布了相关预警和分析报告。提供的 POC 代码利用了参数覆盖和路径遍历来上传文件，并验证文件是否可访问，如果目标是WebShell，还可以执行命令。此利用方式较为常见且有效。

**投毒风险：**
查看提供的`exploit.py`脚本，该脚本主要功能是利用multipart/form-data上传文件，并通过`destination_path`参数来控制上传文件的路径，存在以下几个需要关注的点：

1.  **`simulate_i18n_errors()`函数**：虽然该函数只是模拟国际化错误，但如果被恶意修改，可能会引入其他潜在的攻击向量。
2.  **`execute_remote_command()`函数**：这个函数允许执行远程命令，是漏洞利用的关键部分。如果被篡改，可能导致意外的系统行为。
3.  **依赖库**：`requests`和`requests_toolbelt`是常用的库，但如果被替换为恶意版本，可能导致信息泄露或者代码执行。

此外，`README.md`中引用的YouTube视频链接和GitHub仓库链接也存在一定的风险，例如链接可能指向恶意网站或包含恶意代码的仓库。

考虑到以上因素，该仓库存在一定的投毒风险，但主要是因为利用过程中涉及远程代码执行，如果验证的webshell存在后门也可能导致被控，而并非作者主动投毒。综合评估投毒风险在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名，利用“../”等相对路径，将文件上传到Web服务器的任意目录，绕过上传限制。
2.  **参数覆盖：**  利用Struts框架的特性，覆盖文件上传相关的参数，例如`top.UploadFileName`，从而指定上传文件的目标路径。
3.  **上传恶意文件：**  上传包含恶意代码的文件，例如JSP WebShell，然后通过访问该文件来执行任意命令。
4.  **远程代码执行：** 结合路径遍历和恶意文件上传，攻击者可以在Web服务器上执行任意代码，控制服务器。

总的来说，攻击者通过构造恶意请求，欺骗服务器，最终实现远程代码执行。漏洞利用需要目标应用使用了易受攻击的`FileuploadInterceptor`。

**项目地址:** [punitdarji/Apache-struts-cve-2024-53677](https://github.com/punitdarji/Apache-struts-cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #14

**来源**: [CVE-2024-53677-r007sec_CVE-2024-53677.md](../2024/CVE-2024-53677-r007sec_CVE-2024-53677.md)

## CVE-2024-53677: Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 到 6.4.0 之前

**利用条件:** Apache Struts应用使用了基于FileuploadInterceptor的旧文件上传机制，且攻击者可以访问上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Apache Struts的旧文件上传逻辑中。攻击者可以通过操纵文件上传参数，进行路径遍历，从而将恶意文件上传到任意位置，例如Web容器的webapp目录，进而执行恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞利用是有效的。多个来源均指出 CVE-2024-53677 是一个严重的文件上传漏洞，攻击者可以利用它进行路径遍历和远程代码执行。提供的PoC代码包含一个可以上传WAR包的exploit，以及手动利用的multipart/form-data请求示例，证实了该漏洞的可利用性。

**投毒风险：**
PoC代码存在一定程度的投毒风险。虽然PoC的主要功能是利用漏洞，但其中可能隐藏一些不易察觉的恶意代码，例如：
1.  **WAR包内容：** exploit.py 脚本创建的WAR文件(webshell.war)本身可能包含后门代码。在没有仔细检查的情况下部署这个WAR包可能导致服务器被植入恶意程序。
2.  **上传逻辑修改：** 攻击者可能修改上传逻辑，例如在上传过程中记录服务器信息，或者尝试执行其他未授权操作。
3.  **依赖风险：** requirements.txt 中列出的依赖包可能包含恶意代码或安全漏洞。使用受污染的依赖包可能导致安全风险。
4.  **GIF89a头注入:**  虽然是为了绕过上传检查，但可能存在利用GIF解析漏洞的风险。虽然可能性较低，但是仍然需要考虑。
总体而言，考虑到WAR包本身是用来执行命令的，因此很难完全排除投毒的可能。如果用户盲目执行，并且没有对生成的WAR包进行检查，则存在风险。因此，投毒风险评估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名参数，使其包含`../`这样的路径遍历字符，从而能够将文件上传到服务器上的任意目录。
2.  **上传恶意文件：** 攻击者通常上传包含恶意代码的文件，例如JSP webshell或者WAR包，这些文件一旦被Web服务器解析，就可以执行任意命令。
3.  **远程代码执行：** 通过上传的恶意文件，攻击者可以在服务器上执行任意命令，从而完全控制服务器。

**总结：**
CVE-2024-53677是一个高危漏洞，利用简单，危害巨大。用户应该尽快升级到安全版本，或者采取其他缓解措施，例如禁用旧的文件上传功能。

**项目地址:** [r007sec/CVE-2024-53677](https://github.com/r007sec/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #15

**来源**: [CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md](../2024/CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用基于 FileuploadInterceptor 的旧文件上传逻辑，且可访问 upload.action 接口。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2024-53677 漏洞存在于 Apache Struts 的文件上传逻辑中。攻击者可以通过操纵文件上传参数实现路径遍历，从而上传恶意文件，例如 JSP webshell，最终导致远程代码执行。

**漏洞利用方式：**

1.  **确定目标应用是否使用存在漏洞的 Struts 版本** (2.0.0 到 6.3.x)。
2.  **确定目标应用是否使用基于 FileuploadInterceptor 的文件上传机制**。
3.  **发送包含恶意构造的`top.UploadFileName`参数的 POST 请求到 `upload.action` 接口**。`top.UploadFileName`参数用于指定上传文件的目标路径，攻击者可以通过该参数进行路径遍历，将文件上传到任意目录。
4.  **上传包含恶意代码的文件（如 JSP webshell）**。PoC 中使用了JSP webshell，允许执行服务器端命令。
5.  **通过访问上传的webshell执行任意命令。** PoC 上传 webshell 后，通过构造特定的 URL 参数 `action=cmd&cmd=<command>` 来执行命令。

**有效性评估：**

提供的PoC 代码有效，可以利用该漏洞实现文件上传和远程代码执行。PoC 包含两个 Python 脚本：

*   `PoC.py`:  该脚本通过 POST 请求上传包含 webshell 代码的 JSP 文件，并设置 `top.UploadFileName` 参数为目标路径，实现路径遍历和 webshell 上传。上传成功后，通过 GET 请求访问 webshell，执行指定的命令。
*   `cve_2024_53677_Tool.py`:  该脚本提供了一个交互式菜单，用于检测 Struts 版本、检查漏洞是否存在、上传测试文件和 webshell，并在 Selenium 中打开 webshell。功能更全面，方便漏洞利用。

**投毒风险评估：**

PoC代码中存在极小的投毒风险。PoC 主要功能是漏洞利用，将后门代码封装在webshell里，不算投毒。投毒代码可能藏在以下几点：

1.  **Webshell 代码本身**： 虽然 webshell 的主要目的是执行命令，但开发者可以加入其他恶意代码，例如收集服务器信息、植入持久性后门等。但PoC提供的webshell比较简单，主要的功能是命令执行。
2.  **工具脚本**（`cve_2024_53677_Tool.py`）： 该脚本拥有更多功能，可能在版本检测、文件上传等过程中隐藏恶意代码，例如修改上传文件的内容、记录用户输入等。
3.  **依赖库**：PoC 使用了 `requests` 和（可选）`selenium` 库。虽然这些库本身是安全的，但如果作者使用了恶意修改过的版本，可能会引入安全风险。

**综合评估，投毒风险较低（2%）。主要风险在于 webshell 本身可能存在恶意代码，以及对未知来源脚本的不信任。建议仔细审查代码，并使用可信的依赖库。**

**项目地址:** [seoyoung-kang/CVE-2024-53677](https://github.com/seoyoung-kang/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #16

**来源**: [CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md](../2024/CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越 RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用了存在漏洞的FileuploadInterceptor且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是 Apache Struts 2 中一个严重的文件上传漏洞。攻击者可以通过构造恶意的文件上传请求，利用路径穿越漏洞将恶意 JSP 文件上传到服务器的任意目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果中多个链接都提到了该漏洞，并描述了其利用方式和风险。提供的 Python 脚本能够自动化利用该漏洞。

**投毒风险：**
分析提供的 exploit.py 和 shell.jsp 两个文件，没有发现明显的投毒代码。
*   `exploit.py`：此脚本的主要功能是上传 shell.jsp 并执行命令。它包含设置目标 URL、上传文件和执行命令的函数，不存在可疑或恶意的代码。
*   `shell.jsp`：此 JSP 文件实现了一个简单的 WebShell，允许通过 GET 请求执行系统命令。虽然 WebShell 本身具有潜在的风险，但其功能是明确的，不包含隐藏的恶意代码。
因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Apache Struts 2 应用，该应用使用了易受攻击的 FileuploadInterceptor 并且启用了文件上传功能。
2.  攻击者构造一个包含恶意路径的文件上传请求。例如，将文件名设置为 `../../../../tmp/shell.jsp`，尝试将文件上传到 `/tmp` 目录下。
3.  Struts 2 应用在处理文件上传请求时，由于存在路径穿越漏洞，会将恶意 JSP 文件上传到攻击者指定的目录。
4.  攻击者可以通过访问上传的 JSP 文件来执行任意系统命令。例如，访问 `http://example.com/tmp/shell.jsp?cmd=whoami` 可以在服务器上执行 `whoami` 命令，并将结果返回给攻击者。

**总结：**
CVE-2024-53677 是一个高危漏洞，利用难度相对较低，攻击者可以利用该漏洞完全控制服务器。建议受影响的用户尽快升级到最新版本，或采取缓解措施，如禁用易受攻击的 FileuploadInterceptor，并使用新的文件上传机制。

**项目地址:** [shishirghimir/CVE-2024-53677-Exploit](https://github.com/shishirghimir/CVE-2024-53677-Exploit)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #17

**来源**: [CVE-2024-53677-yangyanglo_CVE-2024-53677.md](../2024/CVE-2024-53677-yangyanglo_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < Version < 6.4.0

**利用条件:** 需要开启了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 框架中的文件上传漏洞，允许攻击者通过操纵文件上传参数，实现路径遍历，最终可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞确实存在，且具有较高的风险。提供的POC代码尝试利用此漏洞，其基本原理是通过修改上传的文件名参数，使其包含路径遍历字符（如`../`），从而将文件上传到Web服务器上非预期的目录中。POC代码通过`-u`指定上传地址，`-filename`指定包含路径遍历的文件名，`-file`指定需要上传的文件，`-type`指定上传类型(单文件或多文件)。如果服务器对上传的文件类型没有严格限制，攻击者可以上传包含恶意代码的JSP文件或其他脚本文件，从而执行任意命令。

**投毒风险：**
仔细审查了提供的POC代码（s2-067.py），没有发现任何明显的投毒代码。该脚本的主要功能是构造包含路径遍历的文件上传请求，并发送给目标服务器。脚本本身没有执行任何恶意操作，例如下载、执行其他程序或修改系统配置。因此，判断此仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  **确定目标：**  首先需要确定目标Apache Struts应用存在漏洞，并且使用了旧的文件上传机制（基于`FileuploadInterceptor`）。
2.  **构造恶意请求：**  使用POC代码或类似工具，构造包含路径遍历的文件上传请求。关键在于修改`filename`参数，使其包含`../`序列，指向Web服务器上可写目录。
3.  **上传恶意文件：**  将包含恶意代码的JSP文件（或其他类型的Web脚本文件）作为上传内容。
4.  **触发恶意代码：**  上传成功后，通过Web浏览器或其他工具访问上传的恶意文件，触发其中的代码执行。

**漏洞缓解措施:**

1. 升级到Apache Struts 6.4.0或更高版本。
2. 迁移到新的文件上传机制。
3. 如果无法迁移，限制上传文件的后缀名，使用自定义随机文件名称。

**项目地址:** [yangyanglo/CVE-2024-53677](https://github.com/yangyanglo/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---



---

## POC #5

**来源**: [CVE-2024-53677-SeanRickerd_CVE-2024-53677.md](../2024/CVE-2024-53677-SeanRickerd_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要Struts应用使用存在漏洞的FileuploadInterceptor旧文件上传机制

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以利用此漏洞，通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到服务器的任意目录。如果上传的文件是可执行脚本（如JSP），攻击者就可以通过访问该脚本来执行任意代码，最终实现远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 利用Struts的文件上传功能，通过修改上传参数，构造包含`../`的路径，绕过文件上传的限制，将文件上传到任意目录。
2.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP脚本。
3.  **远程代码执行：** 通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码有效。搜索结果中多个链接(如dynatrace, qualys, arcticwolf, sonicwall, nsfocusglobal, censys等)都提到了CVE-2024-53677漏洞，并且描述了通过文件上传路径遍历实现RCE。提供的Dockerfile和S2-067.py脚本，以及README.md文件，都提供了完整的漏洞复现环境和利用方法，证明了该漏洞的可利用性。

**投毒风险：**

虽然该POC提供了一个可用的漏洞利用方法，但存在轻微的投毒风险。原因是:

*   Dockerfile：Dockerfile构建过程相对清晰，构建了一个存在漏洞的Struts应用，并部署了tomcat，本身不包含恶意代码。然而，它从其他位置拷贝了`tomcat-users.xml`和`context.xml`配置文件，这些文件可能会包含恶意配置，例如预置的管理员账号密码或者允许任意IP访问manager接口，从而引入安全风险，但这些风险主要取决于这两个文件的具体内容。
*   S2-067.py：Python脚本用于利用该漏洞，其主要功能是上传文件。脚本本身的功能是路径遍历文件上传，本身不属于后门，但如果destination参数设置不当(如覆盖重要文件)，可能导致服务不可用。
*   README.md: README.md中提到了在Openshift上运行需要添加`oc adm policy add-scc-to-group anyuid system:authenticated`, 这在生产环境中是非常危险的，可能导致权限泄露.

综合评估，该仓库的投毒风险较低（约5%）。大部分代码用于漏洞复现，而非恶意行为。真正的风险在于`tomcat-users.xml`和`context.xml`可能存在的恶意配置，以及在Openshift部署时使用`anyuid`可能带来的权限泄露。因此需要仔细检查这些文件，并谨慎地进行部署。


**项目地址:** [SeanRickerd/CVE-2024-53677](https://github.com/SeanRickerd/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #6

**来源**: [CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历/RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统开启文件上传功能，并且使用存在漏洞的FileuploadInterceptor。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数来实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据漏洞库信息，该漏洞影响2.0.0到6.4.0之前的版本。升级到6.4.0或更高版本，并迁移到新的文件上传机制是主要的修复建议。

搜索引擎结果表明，该漏洞已被广泛讨论，并被认为对使用Apache Struts的企业构成重大威胁。多个来源强调了远程代码执行的潜在风险，并将其与过去的Struts漏洞（例如，Equifax breach）联系起来。利用的难易程度为中等，CVSS评分为9.5。

POC代码提供了一个检测脚本，该脚本尝试通过修改上传文件名来触发路径遍历。它通过设置`top.uploadFileName`参数来实现，并检查服务器响应中是否存在被覆盖的文件名。如果检测到文件名覆盖，则表明目标可能存在漏洞。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如使用`../../`来尝试写入Web目录之外的文件。
2.  服务器在处理文件上传时，未正确验证或清理上传的文件名或路径。
3.  攻击者成功将恶意文件（例如JSP webshell）上传到服务器的Web可访问目录。
4.  攻击者通过Web浏览器访问上传的恶意文件，从而执行任意代码。

**投毒风险评估：**

代码库中包含一个检测漏洞的脚本和一个简单的上传文件示例。没有发现任何明显的恶意代码，例如反向shell、下载并执行任意程序的代码等。文件上传漏洞本身可能被用于投毒，但提供的脚本本身不包含额外的、作者隐藏的恶意功能。因此，投毒风险评估为0%。

**项目地址:** [TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #7

**来源**: [CVE-2024-53677-WhoisBulud_CVE-2024-53677.md](../2024/CVE-2024-53677-WhoisBulud_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，存在于2.0.0到6.4.0之前的版本中。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到受限制的目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且存在多个公开的利用方法。提供的POC代码尝试通过修改`uploadFileName`参数来将JSP webshell上传到webapps/ROOT/目录下，从而实现远程代码执行。

**投毒风险：**
检查提供的POC代码，没有发现明显的投毒行为。该脚本只是一个简单的webshell上传工具，没有执行任何恶意操作，例如安装后门、窃取信息等。因此，投毒风险评估为0%。

**利用方式：**
1.  **路径穿越:** 攻击者利用Struts框架在处理文件上传时的缺陷，通过修改上传文件的文件名参数（`uploadFileName`），构造包含路径穿越字符（如`../`）的文件名。
2.  **上传恶意文件:** 通过路径穿越，攻击者可以将恶意文件（如JSP webshell）上传到Web服务器的任意目录下，突破Web服务器的访问限制。
3.  **远程代码执行:** 上传的恶意文件被Web服务器执行，攻击者可以通过访问该文件来执行任意系统命令，从而完全控制服务器。

**项目地址:** [WhoisBulud/CVE-2024-53677](https://github.com/WhoisBulud/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #8

**来源**: [CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统使用基于FileuploadInterceptor的旧文件上传逻辑，且可通过网络访问上传接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 的文件上传漏洞，允许攻击者通过操纵文件上传参数实现路径遍历，从而上传恶意文件到任意目录，最终可能导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中包含了多个安全厂商和研究人员对该漏洞的分析和利用案例，表明该漏洞已被广泛关注和验证。提供的 POC 代码通过修改上传文件名参数，尝试将文件上传到目标系统的任意目录，这是一种典型的路径遍历攻击方式。

**投毒风险分析：**

审查提供的 POC 代码，该脚本主要用于检测目标系统是否存在 CVE-2024-53677 漏洞，其核心功能是通过构造恶意的 multipart 请求，尝试上传一个包含特定内容的文件到目标系统的任意目录。脚本本身不包含任何用于执行恶意操作（如安装后门、窃取数据等）的代码，其目的仅在于验证漏洞的存在性。因此，该 POC 代码存在投毒代码的风险较低。

**利用方式分析：**

利用 CVE-2024-53677 漏洞的一般步骤如下：

1.  **确定目标系统：** 确定目标系统使用的 Apache Struts 版本在受影响范围内。
2.  **寻找上传接口：** 寻找目标系统提供的文件上传接口，这些接口通常基于 FileuploadInterceptor 实现。
3.  **构造恶意请求：** 构造包含恶意文件名的 multipart 请求，利用路径遍历将恶意文件上传到目标系统的任意目录，例如 Web 容器的部署目录。
4.  **执行恶意代码：** 通过访问上传的恶意文件，触发恶意代码的执行，实现远程代码执行。

该漏洞的利用需要目标系统存在基于 `FileuploadInterceptor` 的文件上传功能，且该功能存在缺陷，允许攻击者通过操纵文件名参数实现路径遍历。如果目标系统使用了新的文件上传机制，则不会受到该漏洞的影响。

**项目地址:** [XiaomingX/CVE-2024-53677-S2-067](https://github.com/XiaomingX/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #9

**来源**: [CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md](../2024/CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md)

## CVE-2024-53677-Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了基于 FileUploadInterceptor 的文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径穿越，将恶意文件上传到任意目录，从而可能导致远程代码执行。

**有效性评估：**

根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果均表明这是一个高危漏洞，且存在被利用的风险。POC代码提供了一个Docker环境，用于复现该漏洞。README.md 文件中描述了如何构建和运行该环境，以及漏洞利用的关键修改，例如使用 FileUploadInterceptor 和禁用文件类型验证，进一步降低了复现漏洞的难度。

**投毒风险评估：**

*   **Dockerfile：** Dockerfile用于构建包含漏洞的Struts2应用，本身不包含恶意代码。使用Tomcat作为容器，并复制编译好的WAR包部署。
*   **README.md：** 提供了漏洞复现环境的搭建说明，没有发现恶意代码。
*   **context.xml：** Tomcat的上下文配置文件，设置了一些安全属性，如`antiResourceLocking`和`privileged`，以及CookieProcessor，虽然可能存在配置错误导致其他问题，但本身不是投毒代码。
*   **tomcat-users.xml：** 用于配置Tomcat的用户和角色，包含一个默认的管理员账户admin/trackflaw，这本身是**非常危险**的，因为它使用了一个硬编码的密码。虽然这个默认账户方便漏洞验证，但在真实环境中应该**立即删除或修改密码**。将默认密码作为投毒行为的风险评估较低，因为这通常被认为是配置不当，而非恶意植入。
*   **struts-app/mvnw：** Maven Wrapper，用于在没有安装Maven的环境下构建项目，没有发现恶意代码。

总体评估，代码本身未发现明显的恶意后门。高危操作是设置了默认Tomcat管理员账户，**但这个缺陷更偏向于配置问题，而非有意植入的后门**。考虑到默认账号和密码可能被利用，存在一定的安全风险，将投毒风险评估为10%。

**利用方式分析：**

1.  **环境搭建：** 使用提供的Dockerfile构建包含漏洞的Struts2应用。
2.  **路径穿越：** 通过修改文件上传的参数（例如文件名），构造包含“../”的路径，使文件上传到web目录之外的位置，例如Tomcat的`webapps`目录之外。
3.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP Webshell。
4.  **远程代码执行：** 通过访问上传的恶意文件，触发恶意代码的执行，从而获得服务器的控制权。

关键在于构造恶意的文件名，利用路径穿越绕过Struts的文件上传检查，将恶意文件上传到可执行的位置。

**项目地址:** [c4oocO/CVE-2024-53677-Docker](https://github.com/c4oocO/CVE-2024-53677-Docker)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #10

**来源**: [CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md](../2024/CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑，并且允许用户控制上传文件名参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到服务器的任意目录，从而可能执行远程代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞真实存在且危害严重。POC 代码通过修改`top.uploadFileName`参数尝试将文件上传到目标目录，证明了路径穿越的可能性。POC代码的检测部分通过发送包含恶意文件名的上传请求来检查目标服务器是否易受攻击。如果服务器返回包含恶意文件名的响应，则表明存在漏洞，s2-067-poc.py可以用于上传恶意jsp脚本从而实现rce。

**投毒风险分析：**

检视提供的三个文件：

*   `Check-CVE-2024-53677.py`: 这是一个漏洞检测脚本，旨在非破坏性地检测目标服务器是否存在 CVE-2024-53677 漏洞。它通过上传一个带有修改后文件名的文件来判断是否存在漏洞，基本没有发现异常行为。
*   `README.md`: 这是一个描述 CVE-2024-53677 漏洞的说明文件，包含漏洞描述、影响、修复建议等信息，没有发现投毒代码。
*   `s2-067-poc.py`: 这是一个漏洞利用脚本，用于利用 CVE-2024-53677 漏洞上传恶意 JSP 文件，从而实现远程代码执行。尽管其功能是利用漏洞，但本身也属于漏洞利用代码范畴，考虑到会上传jsp脚本，存在一定后门风险。

总体而言，投毒风险较低，但存在jsp后门文件上传风险需要注意。

**利用方式：**

1.  **路径穿越：** 攻击者通过修改文件上传请求中的文件名参数（例如`top.uploadFileName`），使其包含路径穿越符（如`../`），从而突破服务器的文件上传目录限制。
2.  **恶意文件上传：** 攻击者利用路径穿越，将恶意文件（如 JSP webshell）上传到服务器的可执行目录（如 Web 应用程序的根目录）。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**防范措施：**

*   升级 Apache Struts 到 6.4.0 或更高版本。
*   使用 Struts 提供的新的文件上传机制，避免使用基于 `FileuploadInterceptor` 的旧文件上传逻辑。
*   对用户上传的文件名进行严格的验证和过滤，防止路径穿越攻击。
*   限制文件上传目录的执行权限。

**项目地址:** [cloudwafs/s2-067-CVE-2024-53677](https://github.com/cloudwafs/s2-067-CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #11

**来源**: [CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md](../2024/CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 6.3.x (不包含6.4.0)

**利用条件:** 目标系统使用了存在漏洞的Struts版本，并且开启了基于`FileuploadInterceptor`的文件上传功能。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，利用路径遍历漏洞将恶意文件上传到服务器的任意位置，如果上传的文件是可执行脚本（例如JSP），则可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被认为是高危漏洞，存在远程代码执行的风险。多个安全博客和漏洞库（如NVD, RedHat, Arctic Wolf, Dynatrace, SonicWall, Censys, NSFocus, Qualys）都对此漏洞进行了分析和报告。提供的POC代码通过构造包含路径遍历的multipart/form-data请求，尝试将JSP文件上传到服务器的特定目录。代码中包含了生成随机文件名、创建混淆JSP Payload、上传文件、验证上传文件等功能。因此，提供的POC代码是有效的，可以用来验证和利用该漏洞。

**投毒风险分析：**

该POC代码的投毒风险较低，约为1%。主要原因如下：

*   代码功能相对清晰：该代码主要用于文件上传和验证，逻辑较为简单，没有明显的恶意代码或隐藏功能。
*   混淆载荷：使用了Base64编码混淆了JSP payload，但目的是为了避免直接检测，而不是隐藏恶意行为。decode后的JSP payload功能也是在目标服务器执行命令，方便验证RCE.
*   参数可控：上传路径、文件名、Payload等关键参数都通过命令行参数进行控制，用户可以自定义这些参数，从而降低了被植入恶意代码的风险。
*   缺乏持久化手段：该代码主要用于漏洞验证，不会在目标系统上安装后门或执行其他持久化操作。
*   文件读取操作的透明性：从文件读取URL列表的操作也相对透明，用户可以检查文件内容，确认URL的合法性。

**利用方式：**

1.  **确定目标:** 首先需要确定目标系统是否使用了存在漏洞的Apache Struts版本，且使用了`FileuploadInterceptor`。
2.  **构造恶意请求:** 使用POC代码，构造包含路径遍历的文件上传请求。通过修改上传文件的路径参数，尝试将JSP文件上传到服务器的Web目录或其他可执行目录（例如：`../../../../../webapps/ROOT`或`/tmp`）。
3.  **上传JSP Payload:** 上传包含恶意代码的JSP文件。POC代码中使用了混淆的JSP Payload，该Payload的功能是执行指定的命令。
4.  **访问上传的文件:** 通过Web浏览器或HTTP客户端访问上传的JSP文件。如果文件上传成功且可执行，服务器将执行JSP Payload中的代码。
5.  **执行任意命令:** 通过在URL中添加`cmd`参数，可以执行任意系统命令（例如：`http://example.com/uploaded/malicious.jsp?cmd=whoami`）。
6.  **远程代码执行:** 如果攻击成功，攻击者可以在目标服务器上执行任意代码，从而完全控制该服务器。


**项目地址:** [dustblessnotdust/CVE-2024-53677-S2-067-thread](https://github.com/dustblessnotdust/CVE-2024-53677-S2-067-thread)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #12

**来源**: [CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md](../2024/CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md)

## CVE-2024-53677-Apache Struts文件上传RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 启用了基于 FileUploadInterceptor 的旧文件上传逻辑，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来实现路径遍历，从而上传恶意文件并执行远程代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。多个来源表明该漏洞已在实际环境中被利用，并且存在公开可用的利用代码。

**投毒风险：**

分析提供的漏洞利用代码（/tmp/6fab2f844aba42ca86705ccc230e42e1/README.md）：

*   该代码描述了一个利用 CVE-2024-53677 的方法，涉及修改文件上传请求，通过 OGNL 表达式注入参数，绕过文件类型限制，并将恶意 JSP payload 附加到上传的文件中。
*   payload部分给出的是引用外部shell.jsp的代码，需要进一步分析shell.jsp本身，因为仅仅看readme.md本身无法确定payload是否安全
*   exploit.py同样是引用外部脚本，需要关注其代码是否包含恶意操作
*   python3 http.server -m 3004 命令用于提供web服务，有被用于恶意文件分发的可能性

综合考虑，该仓库存在一定投毒风险，但考虑到提供的步骤是为了利用漏洞进行渗透测试，恶意行为通常与渗透测试的目标有关。由于需要引用的shell.jsp和python脚本来源未知，不能排除恶意脚本的存在，考虑到脚本存在从外部拉取，存在潜在的风险。所以给出10%的投毒风险评估。

**利用方式：**

1.  **识别攻击向量：** 找到存在文件上传功能的页面。
2.  **版本确认：** 确定目标 Apache Struts 的版本是否在受影响范围内（2.0.0 到 6.4.0 之前）。可以通过查找 `pom.xml` 文件等方式确认。
3.  **修改文件上传请求：** 使用 BurpSuite 等工具截获文件上传请求，添加利用 OGNL 的参数，例如：
    ```
    ...(上传的文件内容).&{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','freak')}.&{(#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().getValue('rand')).getRuntime().exec('touch /tmp/success')}
    ```
4.  **附加 Payload：** 将 JSP payload 附加到上传的文件数据中，例如使用 webshell 。
5.  **发送请求：** 发送修改后的请求。
6.  **访问 Payload：** 访问上传的 JSP 文件，触发 payload 执行。
7.  **获取 Shell：** 如果 payload 是 webshell，则可以通过 webshell 执行任意命令，例如建立反向 shell。

**项目地址:** [hopsypopsy8/CVE-2024-53677-Exploitation](https://github.com/hopsypopsy8/CVE-2024-53677-Exploitation)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #13

**来源**: [CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md](../2024/CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传漏洞

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用 FileuploadInterceptor 的 Struts 应用，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞。攻击者可以操纵文件上传参数，利用路径遍历漏洞将文件上传到受限目录，从而可能导致远程代码执行。

**有效性：**
漏洞库信息和搜索结果均表明该漏洞是真实存在的，且风险较高，多个安全厂商发布了相关预警和分析报告。提供的 POC 代码利用了参数覆盖和路径遍历来上传文件，并验证文件是否可访问，如果目标是WebShell，还可以执行命令。此利用方式较为常见且有效。

**投毒风险：**
查看提供的`exploit.py`脚本，该脚本主要功能是利用multipart/form-data上传文件，并通过`destination_path`参数来控制上传文件的路径，存在以下几个需要关注的点：

1.  **`simulate_i18n_errors()`函数**：虽然该函数只是模拟国际化错误，但如果被恶意修改，可能会引入其他潜在的攻击向量。
2.  **`execute_remote_command()`函数**：这个函数允许执行远程命令，是漏洞利用的关键部分。如果被篡改，可能导致意外的系统行为。
3.  **依赖库**：`requests`和`requests_toolbelt`是常用的库，但如果被替换为恶意版本，可能导致信息泄露或者代码执行。

此外，`README.md`中引用的YouTube视频链接和GitHub仓库链接也存在一定的风险，例如链接可能指向恶意网站或包含恶意代码的仓库。

考虑到以上因素，该仓库存在一定的投毒风险，但主要是因为利用过程中涉及远程代码执行，如果验证的webshell存在后门也可能导致被控，而并非作者主动投毒。综合评估投毒风险在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名，利用“../”等相对路径，将文件上传到Web服务器的任意目录，绕过上传限制。
2.  **参数覆盖：**  利用Struts框架的特性，覆盖文件上传相关的参数，例如`top.UploadFileName`，从而指定上传文件的目标路径。
3.  **上传恶意文件：**  上传包含恶意代码的文件，例如JSP WebShell，然后通过访问该文件来执行任意命令。
4.  **远程代码执行：** 结合路径遍历和恶意文件上传，攻击者可以在Web服务器上执行任意代码，控制服务器。

总的来说，攻击者通过构造恶意请求，欺骗服务器，最终实现远程代码执行。漏洞利用需要目标应用使用了易受攻击的`FileuploadInterceptor`。

**项目地址:** [punitdarji/Apache-struts-cve-2024-53677](https://github.com/punitdarji/Apache-struts-cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #14

**来源**: [CVE-2024-53677-r007sec_CVE-2024-53677.md](../2024/CVE-2024-53677-r007sec_CVE-2024-53677.md)

## CVE-2024-53677: Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 到 6.4.0 之前

**利用条件:** Apache Struts应用使用了基于FileuploadInterceptor的旧文件上传机制，且攻击者可以访问上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Apache Struts的旧文件上传逻辑中。攻击者可以通过操纵文件上传参数，进行路径遍历，从而将恶意文件上传到任意位置，例如Web容器的webapp目录，进而执行恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞利用是有效的。多个来源均指出 CVE-2024-53677 是一个严重的文件上传漏洞，攻击者可以利用它进行路径遍历和远程代码执行。提供的PoC代码包含一个可以上传WAR包的exploit，以及手动利用的multipart/form-data请求示例，证实了该漏洞的可利用性。

**投毒风险：**
PoC代码存在一定程度的投毒风险。虽然PoC的主要功能是利用漏洞，但其中可能隐藏一些不易察觉的恶意代码，例如：
1.  **WAR包内容：** exploit.py 脚本创建的WAR文件(webshell.war)本身可能包含后门代码。在没有仔细检查的情况下部署这个WAR包可能导致服务器被植入恶意程序。
2.  **上传逻辑修改：** 攻击者可能修改上传逻辑，例如在上传过程中记录服务器信息，或者尝试执行其他未授权操作。
3.  **依赖风险：** requirements.txt 中列出的依赖包可能包含恶意代码或安全漏洞。使用受污染的依赖包可能导致安全风险。
4.  **GIF89a头注入:**  虽然是为了绕过上传检查，但可能存在利用GIF解析漏洞的风险。虽然可能性较低，但是仍然需要考虑。
总体而言，考虑到WAR包本身是用来执行命令的，因此很难完全排除投毒的可能。如果用户盲目执行，并且没有对生成的WAR包进行检查，则存在风险。因此，投毒风险评估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名参数，使其包含`../`这样的路径遍历字符，从而能够将文件上传到服务器上的任意目录。
2.  **上传恶意文件：** 攻击者通常上传包含恶意代码的文件，例如JSP webshell或者WAR包，这些文件一旦被Web服务器解析，就可以执行任意命令。
3.  **远程代码执行：** 通过上传的恶意文件，攻击者可以在服务器上执行任意命令，从而完全控制服务器。

**总结：**
CVE-2024-53677是一个高危漏洞，利用简单，危害巨大。用户应该尽快升级到安全版本，或者采取其他缓解措施，例如禁用旧的文件上传功能。

**项目地址:** [r007sec/CVE-2024-53677](https://github.com/r007sec/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #15

**来源**: [CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md](../2024/CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用基于 FileuploadInterceptor 的旧文件上传逻辑，且可访问 upload.action 接口。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2024-53677 漏洞存在于 Apache Struts 的文件上传逻辑中。攻击者可以通过操纵文件上传参数实现路径遍历，从而上传恶意文件，例如 JSP webshell，最终导致远程代码执行。

**漏洞利用方式：**

1.  **确定目标应用是否使用存在漏洞的 Struts 版本** (2.0.0 到 6.3.x)。
2.  **确定目标应用是否使用基于 FileuploadInterceptor 的文件上传机制**。
3.  **发送包含恶意构造的`top.UploadFileName`参数的 POST 请求到 `upload.action` 接口**。`top.UploadFileName`参数用于指定上传文件的目标路径，攻击者可以通过该参数进行路径遍历，将文件上传到任意目录。
4.  **上传包含恶意代码的文件（如 JSP webshell）**。PoC 中使用了JSP webshell，允许执行服务器端命令。
5.  **通过访问上传的webshell执行任意命令。** PoC 上传 webshell 后，通过构造特定的 URL 参数 `action=cmd&cmd=<command>` 来执行命令。

**有效性评估：**

提供的PoC 代码有效，可以利用该漏洞实现文件上传和远程代码执行。PoC 包含两个 Python 脚本：

*   `PoC.py`:  该脚本通过 POST 请求上传包含 webshell 代码的 JSP 文件，并设置 `top.UploadFileName` 参数为目标路径，实现路径遍历和 webshell 上传。上传成功后，通过 GET 请求访问 webshell，执行指定的命令。
*   `cve_2024_53677_Tool.py`:  该脚本提供了一个交互式菜单，用于检测 Struts 版本、检查漏洞是否存在、上传测试文件和 webshell，并在 Selenium 中打开 webshell。功能更全面，方便漏洞利用。

**投毒风险评估：**

PoC代码中存在极小的投毒风险。PoC 主要功能是漏洞利用，将后门代码封装在webshell里，不算投毒。投毒代码可能藏在以下几点：

1.  **Webshell 代码本身**： 虽然 webshell 的主要目的是执行命令，但开发者可以加入其他恶意代码，例如收集服务器信息、植入持久性后门等。但PoC提供的webshell比较简单，主要的功能是命令执行。
2.  **工具脚本**（`cve_2024_53677_Tool.py`）： 该脚本拥有更多功能，可能在版本检测、文件上传等过程中隐藏恶意代码，例如修改上传文件的内容、记录用户输入等。
3.  **依赖库**：PoC 使用了 `requests` 和（可选）`selenium` 库。虽然这些库本身是安全的，但如果作者使用了恶意修改过的版本，可能会引入安全风险。

**综合评估，投毒风险较低（2%）。主要风险在于 webshell 本身可能存在恶意代码，以及对未知来源脚本的不信任。建议仔细审查代码，并使用可信的依赖库。**

**项目地址:** [seoyoung-kang/CVE-2024-53677](https://github.com/seoyoung-kang/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #16

**来源**: [CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md](../2024/CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越 RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用了存在漏洞的FileuploadInterceptor且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是 Apache Struts 2 中一个严重的文件上传漏洞。攻击者可以通过构造恶意的文件上传请求，利用路径穿越漏洞将恶意 JSP 文件上传到服务器的任意目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果中多个链接都提到了该漏洞，并描述了其利用方式和风险。提供的 Python 脚本能够自动化利用该漏洞。

**投毒风险：**
分析提供的 exploit.py 和 shell.jsp 两个文件，没有发现明显的投毒代码。
*   `exploit.py`：此脚本的主要功能是上传 shell.jsp 并执行命令。它包含设置目标 URL、上传文件和执行命令的函数，不存在可疑或恶意的代码。
*   `shell.jsp`：此 JSP 文件实现了一个简单的 WebShell，允许通过 GET 请求执行系统命令。虽然 WebShell 本身具有潜在的风险，但其功能是明确的，不包含隐藏的恶意代码。
因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Apache Struts 2 应用，该应用使用了易受攻击的 FileuploadInterceptor 并且启用了文件上传功能。
2.  攻击者构造一个包含恶意路径的文件上传请求。例如，将文件名设置为 `../../../../tmp/shell.jsp`，尝试将文件上传到 `/tmp` 目录下。
3.  Struts 2 应用在处理文件上传请求时，由于存在路径穿越漏洞，会将恶意 JSP 文件上传到攻击者指定的目录。
4.  攻击者可以通过访问上传的 JSP 文件来执行任意系统命令。例如，访问 `http://example.com/tmp/shell.jsp?cmd=whoami` 可以在服务器上执行 `whoami` 命令，并将结果返回给攻击者。

**总结：**
CVE-2024-53677 是一个高危漏洞，利用难度相对较低，攻击者可以利用该漏洞完全控制服务器。建议受影响的用户尽快升级到最新版本，或采取缓解措施，如禁用易受攻击的 FileuploadInterceptor，并使用新的文件上传机制。

**项目地址:** [shishirghimir/CVE-2024-53677-Exploit](https://github.com/shishirghimir/CVE-2024-53677-Exploit)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #17

**来源**: [CVE-2024-53677-yangyanglo_CVE-2024-53677.md](../2024/CVE-2024-53677-yangyanglo_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < Version < 6.4.0

**利用条件:** 需要开启了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 框架中的文件上传漏洞，允许攻击者通过操纵文件上传参数，实现路径遍历，最终可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞确实存在，且具有较高的风险。提供的POC代码尝试利用此漏洞，其基本原理是通过修改上传的文件名参数，使其包含路径遍历字符（如`../`），从而将文件上传到Web服务器上非预期的目录中。POC代码通过`-u`指定上传地址，`-filename`指定包含路径遍历的文件名，`-file`指定需要上传的文件，`-type`指定上传类型(单文件或多文件)。如果服务器对上传的文件类型没有严格限制，攻击者可以上传包含恶意代码的JSP文件或其他脚本文件，从而执行任意命令。

**投毒风险：**
仔细审查了提供的POC代码（s2-067.py），没有发现任何明显的投毒代码。该脚本的主要功能是构造包含路径遍历的文件上传请求，并发送给目标服务器。脚本本身没有执行任何恶意操作，例如下载、执行其他程序或修改系统配置。因此，判断此仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  **确定目标：**  首先需要确定目标Apache Struts应用存在漏洞，并且使用了旧的文件上传机制（基于`FileuploadInterceptor`）。
2.  **构造恶意请求：**  使用POC代码或类似工具，构造包含路径遍历的文件上传请求。关键在于修改`filename`参数，使其包含`../`序列，指向Web服务器上可写目录。
3.  **上传恶意文件：**  将包含恶意代码的JSP文件（或其他类型的Web脚本文件）作为上传内容。
4.  **触发恶意代码：**  上传成功后，通过Web浏览器或其他工具访问上传的恶意文件，触发其中的代码执行。

**漏洞缓解措施:**

1. 升级到Apache Struts 6.4.0或更高版本。
2. 迁移到新的文件上传机制。
3. 如果无法迁移，限制上传文件的后缀名，使用自定义随机文件名称。

**项目地址:** [yangyanglo/CVE-2024-53677](https://github.com/yangyanglo/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---



---

## POC #5

**来源**: [CVE-2024-53677-SeanRickerd_CVE-2024-53677.md](../2024/CVE-2024-53677-SeanRickerd_CVE-2024-53677.md)

## CVE-2024-53677 - Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要Struts应用使用存在漏洞的FileuploadInterceptor旧文件上传机制

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以利用此漏洞，通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到服务器的任意目录。如果上传的文件是可执行脚本（如JSP），攻击者就可以通过访问该脚本来执行任意代码，最终实现远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 利用Struts的文件上传功能，通过修改上传参数，构造包含`../`的路径，绕过文件上传的限制，将文件上传到任意目录。
2.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP脚本。
3.  **远程代码执行：** 通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码有效。搜索结果中多个链接(如dynatrace, qualys, arcticwolf, sonicwall, nsfocusglobal, censys等)都提到了CVE-2024-53677漏洞，并且描述了通过文件上传路径遍历实现RCE。提供的Dockerfile和S2-067.py脚本，以及README.md文件，都提供了完整的漏洞复现环境和利用方法，证明了该漏洞的可利用性。

**投毒风险：**

虽然该POC提供了一个可用的漏洞利用方法，但存在轻微的投毒风险。原因是:

*   Dockerfile：Dockerfile构建过程相对清晰，构建了一个存在漏洞的Struts应用，并部署了tomcat，本身不包含恶意代码。然而，它从其他位置拷贝了`tomcat-users.xml`和`context.xml`配置文件，这些文件可能会包含恶意配置，例如预置的管理员账号密码或者允许任意IP访问manager接口，从而引入安全风险，但这些风险主要取决于这两个文件的具体内容。
*   S2-067.py：Python脚本用于利用该漏洞，其主要功能是上传文件。脚本本身的功能是路径遍历文件上传，本身不属于后门，但如果destination参数设置不当(如覆盖重要文件)，可能导致服务不可用。
*   README.md: README.md中提到了在Openshift上运行需要添加`oc adm policy add-scc-to-group anyuid system:authenticated`, 这在生产环境中是非常危险的，可能导致权限泄露.

综合评估，该仓库的投毒风险较低（约5%）。大部分代码用于漏洞复现，而非恶意行为。真正的风险在于`tomcat-users.xml`和`context.xml`可能存在的恶意配置，以及在Openshift部署时使用`anyuid`可能带来的权限泄露。因此需要仔细检查这些文件，并谨慎地进行部署。


**项目地址:** [SeanRickerd/CVE-2024-53677](https://github.com/SeanRickerd/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #6

**来源**: [CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-TAM-K592_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历/RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统开启文件上传功能，并且使用存在漏洞的FileuploadInterceptor。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数来实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据漏洞库信息，该漏洞影响2.0.0到6.4.0之前的版本。升级到6.4.0或更高版本，并迁移到新的文件上传机制是主要的修复建议。

搜索引擎结果表明，该漏洞已被广泛讨论，并被认为对使用Apache Struts的企业构成重大威胁。多个来源强调了远程代码执行的潜在风险，并将其与过去的Struts漏洞（例如，Equifax breach）联系起来。利用的难易程度为中等，CVSS评分为9.5。

POC代码提供了一个检测脚本，该脚本尝试通过修改上传文件名来触发路径遍历。它通过设置`top.uploadFileName`参数来实现，并检查服务器响应中是否存在被覆盖的文件名。如果检测到文件名覆盖，则表明目标可能存在漏洞。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如使用`../../`来尝试写入Web目录之外的文件。
2.  服务器在处理文件上传时，未正确验证或清理上传的文件名或路径。
3.  攻击者成功将恶意文件（例如JSP webshell）上传到服务器的Web可访问目录。
4.  攻击者通过Web浏览器访问上传的恶意文件，从而执行任意代码。

**投毒风险评估：**

代码库中包含一个检测漏洞的脚本和一个简单的上传文件示例。没有发现任何明显的恶意代码，例如反向shell、下载并执行任意程序的代码等。文件上传漏洞本身可能被用于投毒，但提供的脚本本身不包含额外的、作者隐藏的恶意功能。因此，投毒风险评估为0%。

**项目地址:** [TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #7

**来源**: [CVE-2024-53677-WhoisBulud_CVE-2024-53677.md](../2024/CVE-2024-53677-WhoisBulud_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，存在于2.0.0到6.4.0之前的版本中。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到受限制的目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且存在多个公开的利用方法。提供的POC代码尝试通过修改`uploadFileName`参数来将JSP webshell上传到webapps/ROOT/目录下，从而实现远程代码执行。

**投毒风险：**
检查提供的POC代码，没有发现明显的投毒行为。该脚本只是一个简单的webshell上传工具，没有执行任何恶意操作，例如安装后门、窃取信息等。因此，投毒风险评估为0%。

**利用方式：**
1.  **路径穿越:** 攻击者利用Struts框架在处理文件上传时的缺陷，通过修改上传文件的文件名参数（`uploadFileName`），构造包含路径穿越字符（如`../`）的文件名。
2.  **上传恶意文件:** 通过路径穿越，攻击者可以将恶意文件（如JSP webshell）上传到Web服务器的任意目录下，突破Web服务器的访问限制。
3.  **远程代码执行:** 上传的恶意文件被Web服务器执行，攻击者可以通过访问该文件来执行任意系统命令，从而完全控制服务器。

**项目地址:** [WhoisBulud/CVE-2024-53677](https://github.com/WhoisBulud/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #8

**来源**: [CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md](../2024/CVE-2024-53677-XiaomingX_CVE-2024-53677-S2-067.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统使用基于FileuploadInterceptor的旧文件上传逻辑，且可通过网络访问上传接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 的文件上传漏洞，允许攻击者通过操纵文件上传参数实现路径遍历，从而上传恶意文件到任意目录，最终可能导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中包含了多个安全厂商和研究人员对该漏洞的分析和利用案例，表明该漏洞已被广泛关注和验证。提供的 POC 代码通过修改上传文件名参数，尝试将文件上传到目标系统的任意目录，这是一种典型的路径遍历攻击方式。

**投毒风险分析：**

审查提供的 POC 代码，该脚本主要用于检测目标系统是否存在 CVE-2024-53677 漏洞，其核心功能是通过构造恶意的 multipart 请求，尝试上传一个包含特定内容的文件到目标系统的任意目录。脚本本身不包含任何用于执行恶意操作（如安装后门、窃取数据等）的代码，其目的仅在于验证漏洞的存在性。因此，该 POC 代码存在投毒代码的风险较低。

**利用方式分析：**

利用 CVE-2024-53677 漏洞的一般步骤如下：

1.  **确定目标系统：** 确定目标系统使用的 Apache Struts 版本在受影响范围内。
2.  **寻找上传接口：** 寻找目标系统提供的文件上传接口，这些接口通常基于 FileuploadInterceptor 实现。
3.  **构造恶意请求：** 构造包含恶意文件名的 multipart 请求，利用路径遍历将恶意文件上传到目标系统的任意目录，例如 Web 容器的部署目录。
4.  **执行恶意代码：** 通过访问上传的恶意文件，触发恶意代码的执行，实现远程代码执行。

该漏洞的利用需要目标系统存在基于 `FileuploadInterceptor` 的文件上传功能，且该功能存在缺陷，允许攻击者通过操纵文件名参数实现路径遍历。如果目标系统使用了新的文件上传机制，则不会受到该漏洞的影响。

**项目地址:** [XiaomingX/CVE-2024-53677-S2-067](https://github.com/XiaomingX/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #9

**来源**: [CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md](../2024/CVE-2024-53677-c4oocO_CVE-2024-53677-Docker.md)

## CVE-2024-53677-Apache Struts文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了基于 FileUploadInterceptor 的文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts 2中的一个文件上传漏洞。攻击者可以操纵文件上传参数，实现路径穿越，将恶意文件上传到任意目录，从而可能导致远程代码执行。

**有效性评估：**

根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果均表明这是一个高危漏洞，且存在被利用的风险。POC代码提供了一个Docker环境，用于复现该漏洞。README.md 文件中描述了如何构建和运行该环境，以及漏洞利用的关键修改，例如使用 FileUploadInterceptor 和禁用文件类型验证，进一步降低了复现漏洞的难度。

**投毒风险评估：**

*   **Dockerfile：** Dockerfile用于构建包含漏洞的Struts2应用，本身不包含恶意代码。使用Tomcat作为容器，并复制编译好的WAR包部署。
*   **README.md：** 提供了漏洞复现环境的搭建说明，没有发现恶意代码。
*   **context.xml：** Tomcat的上下文配置文件，设置了一些安全属性，如`antiResourceLocking`和`privileged`，以及CookieProcessor，虽然可能存在配置错误导致其他问题，但本身不是投毒代码。
*   **tomcat-users.xml：** 用于配置Tomcat的用户和角色，包含一个默认的管理员账户admin/trackflaw，这本身是**非常危险**的，因为它使用了一个硬编码的密码。虽然这个默认账户方便漏洞验证，但在真实环境中应该**立即删除或修改密码**。将默认密码作为投毒行为的风险评估较低，因为这通常被认为是配置不当，而非恶意植入。
*   **struts-app/mvnw：** Maven Wrapper，用于在没有安装Maven的环境下构建项目，没有发现恶意代码。

总体评估，代码本身未发现明显的恶意后门。高危操作是设置了默认Tomcat管理员账户，**但这个缺陷更偏向于配置问题，而非有意植入的后门**。考虑到默认账号和密码可能被利用，存在一定的安全风险，将投毒风险评估为10%。

**利用方式分析：**

1.  **环境搭建：** 使用提供的Dockerfile构建包含漏洞的Struts2应用。
2.  **路径穿越：** 通过修改文件上传的参数（例如文件名），构造包含“../”的路径，使文件上传到web目录之外的位置，例如Tomcat的`webapps`目录之外。
3.  **上传恶意文件：** 上传包含恶意代码的文件，例如JSP Webshell。
4.  **远程代码执行：** 通过访问上传的恶意文件，触发恶意代码的执行，从而获得服务器的控制权。

关键在于构造恶意的文件名，利用路径穿越绕过Struts的文件上传检查，将恶意文件上传到可执行的位置。

**项目地址:** [c4oocO/CVE-2024-53677-Docker](https://github.com/c4oocO/CVE-2024-53677-Docker)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #10

**来源**: [CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md](../2024/CVE-2024-53677-cloudwafs_s2-067-CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑，并且允许用户控制上传文件名参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到服务器的任意目录，从而可能执行远程代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞真实存在且危害严重。POC 代码通过修改`top.uploadFileName`参数尝试将文件上传到目标目录，证明了路径穿越的可能性。POC代码的检测部分通过发送包含恶意文件名的上传请求来检查目标服务器是否易受攻击。如果服务器返回包含恶意文件名的响应，则表明存在漏洞，s2-067-poc.py可以用于上传恶意jsp脚本从而实现rce。

**投毒风险分析：**

检视提供的三个文件：

*   `Check-CVE-2024-53677.py`: 这是一个漏洞检测脚本，旨在非破坏性地检测目标服务器是否存在 CVE-2024-53677 漏洞。它通过上传一个带有修改后文件名的文件来判断是否存在漏洞，基本没有发现异常行为。
*   `README.md`: 这是一个描述 CVE-2024-53677 漏洞的说明文件，包含漏洞描述、影响、修复建议等信息，没有发现投毒代码。
*   `s2-067-poc.py`: 这是一个漏洞利用脚本，用于利用 CVE-2024-53677 漏洞上传恶意 JSP 文件，从而实现远程代码执行。尽管其功能是利用漏洞，但本身也属于漏洞利用代码范畴，考虑到会上传jsp脚本，存在一定后门风险。

总体而言，投毒风险较低，但存在jsp后门文件上传风险需要注意。

**利用方式：**

1.  **路径穿越：** 攻击者通过修改文件上传请求中的文件名参数（例如`top.uploadFileName`），使其包含路径穿越符（如`../`），从而突破服务器的文件上传目录限制。
2.  **恶意文件上传：** 攻击者利用路径穿越，将恶意文件（如 JSP webshell）上传到服务器的可执行目录（如 Web 应用程序的根目录）。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，执行其中的恶意代码，从而控制服务器。

**防范措施：**

*   升级 Apache Struts 到 6.4.0 或更高版本。
*   使用 Struts 提供的新的文件上传机制，避免使用基于 `FileuploadInterceptor` 的旧文件上传逻辑。
*   对用户上传的文件名进行严格的验证和过滤，防止路径穿越攻击。
*   限制文件上传目录的执行权限。

**项目地址:** [cloudwafs/s2-067-CVE-2024-53677](https://github.com/cloudwafs/s2-067-CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #11

**来源**: [CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md](../2024/CVE-2024-53677-dustblessnotdust_CVE-2024-53677-S2-067-thread.md)

## CVE-2024-53677-Apache Struts文件上传路径遍历RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 6.3.x (不包含6.4.0)

**利用条件:** 目标系统使用了存在漏洞的Struts版本，并且开启了基于`FileuploadInterceptor`的文件上传功能。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数，利用路径遍历漏洞将恶意文件上传到服务器的任意位置，如果上传的文件是可执行脚本（例如JSP），则可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被认为是高危漏洞，存在远程代码执行的风险。多个安全博客和漏洞库（如NVD, RedHat, Arctic Wolf, Dynatrace, SonicWall, Censys, NSFocus, Qualys）都对此漏洞进行了分析和报告。提供的POC代码通过构造包含路径遍历的multipart/form-data请求，尝试将JSP文件上传到服务器的特定目录。代码中包含了生成随机文件名、创建混淆JSP Payload、上传文件、验证上传文件等功能。因此，提供的POC代码是有效的，可以用来验证和利用该漏洞。

**投毒风险分析：**

该POC代码的投毒风险较低，约为1%。主要原因如下：

*   代码功能相对清晰：该代码主要用于文件上传和验证，逻辑较为简单，没有明显的恶意代码或隐藏功能。
*   混淆载荷：使用了Base64编码混淆了JSP payload，但目的是为了避免直接检测，而不是隐藏恶意行为。decode后的JSP payload功能也是在目标服务器执行命令，方便验证RCE.
*   参数可控：上传路径、文件名、Payload等关键参数都通过命令行参数进行控制，用户可以自定义这些参数，从而降低了被植入恶意代码的风险。
*   缺乏持久化手段：该代码主要用于漏洞验证，不会在目标系统上安装后门或执行其他持久化操作。
*   文件读取操作的透明性：从文件读取URL列表的操作也相对透明，用户可以检查文件内容，确认URL的合法性。

**利用方式：**

1.  **确定目标:** 首先需要确定目标系统是否使用了存在漏洞的Apache Struts版本，且使用了`FileuploadInterceptor`。
2.  **构造恶意请求:** 使用POC代码，构造包含路径遍历的文件上传请求。通过修改上传文件的路径参数，尝试将JSP文件上传到服务器的Web目录或其他可执行目录（例如：`../../../../../webapps/ROOT`或`/tmp`）。
3.  **上传JSP Payload:** 上传包含恶意代码的JSP文件。POC代码中使用了混淆的JSP Payload，该Payload的功能是执行指定的命令。
4.  **访问上传的文件:** 通过Web浏览器或HTTP客户端访问上传的JSP文件。如果文件上传成功且可执行，服务器将执行JSP Payload中的代码。
5.  **执行任意命令:** 通过在URL中添加`cmd`参数，可以执行任意系统命令（例如：`http://example.com/uploaded/malicious.jsp?cmd=whoami`）。
6.  **远程代码执行:** 如果攻击成功，攻击者可以在目标服务器上执行任意代码，从而完全控制该服务器。


**项目地址:** [dustblessnotdust/CVE-2024-53677-S2-067-thread](https://github.com/dustblessnotdust/CVE-2024-53677-S2-067-thread)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #12

**来源**: [CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md](../2024/CVE-2024-53677-hopsypopsy8_CVE-2024-53677-Exploitation.md)

## CVE-2024-53677-Apache Struts文件上传RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 启用了基于 FileUploadInterceptor 的旧文件上传逻辑，且存在文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞，攻击者可以通过操纵文件上传参数来实现路径遍历，从而上传恶意文件并执行远程代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。多个来源表明该漏洞已在实际环境中被利用，并且存在公开可用的利用代码。

**投毒风险：**

分析提供的漏洞利用代码（/tmp/6fab2f844aba42ca86705ccc230e42e1/README.md）：

*   该代码描述了一个利用 CVE-2024-53677 的方法，涉及修改文件上传请求，通过 OGNL 表达式注入参数，绕过文件类型限制，并将恶意 JSP payload 附加到上传的文件中。
*   payload部分给出的是引用外部shell.jsp的代码，需要进一步分析shell.jsp本身，因为仅仅看readme.md本身无法确定payload是否安全
*   exploit.py同样是引用外部脚本，需要关注其代码是否包含恶意操作
*   python3 http.server -m 3004 命令用于提供web服务，有被用于恶意文件分发的可能性

综合考虑，该仓库存在一定投毒风险，但考虑到提供的步骤是为了利用漏洞进行渗透测试，恶意行为通常与渗透测试的目标有关。由于需要引用的shell.jsp和python脚本来源未知，不能排除恶意脚本的存在，考虑到脚本存在从外部拉取，存在潜在的风险。所以给出10%的投毒风险评估。

**利用方式：**

1.  **识别攻击向量：** 找到存在文件上传功能的页面。
2.  **版本确认：** 确定目标 Apache Struts 的版本是否在受影响范围内（2.0.0 到 6.4.0 之前）。可以通过查找 `pom.xml` 文件等方式确认。
3.  **修改文件上传请求：** 使用 BurpSuite 等工具截获文件上传请求，添加利用 OGNL 的参数，例如：
    ```
    ...(上传的文件内容).&{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','freak')}.&{(#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().getValue('rand')).getRuntime().exec('touch /tmp/success')}
    ```
4.  **附加 Payload：** 将 JSP payload 附加到上传的文件数据中，例如使用 webshell 。
5.  **发送请求：** 发送修改后的请求。
6.  **访问 Payload：** 访问上传的 JSP 文件，触发 payload 执行。
7.  **获取 Shell：** 如果 payload 是 webshell，则可以通过 webshell 执行任意命令，例如建立反向 shell。

**项目地址:** [hopsypopsy8/CVE-2024-53677-Exploitation](https://github.com/hopsypopsy8/CVE-2024-53677-Exploitation)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #13

**来源**: [CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md](../2024/CVE-2024-53677-punitdarji_Apache-struts-cve-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传漏洞

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < version < 6.4.0

**利用条件:** 使用 FileuploadInterceptor 的 Struts 应用，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 中的一个文件上传漏洞。攻击者可以操纵文件上传参数，利用路径遍历漏洞将文件上传到受限目录，从而可能导致远程代码执行。

**有效性：**
漏洞库信息和搜索结果均表明该漏洞是真实存在的，且风险较高，多个安全厂商发布了相关预警和分析报告。提供的 POC 代码利用了参数覆盖和路径遍历来上传文件，并验证文件是否可访问，如果目标是WebShell，还可以执行命令。此利用方式较为常见且有效。

**投毒风险：**
查看提供的`exploit.py`脚本，该脚本主要功能是利用multipart/form-data上传文件，并通过`destination_path`参数来控制上传文件的路径，存在以下几个需要关注的点：

1.  **`simulate_i18n_errors()`函数**：虽然该函数只是模拟国际化错误，但如果被恶意修改，可能会引入其他潜在的攻击向量。
2.  **`execute_remote_command()`函数**：这个函数允许执行远程命令，是漏洞利用的关键部分。如果被篡改，可能导致意外的系统行为。
3.  **依赖库**：`requests`和`requests_toolbelt`是常用的库，但如果被替换为恶意版本，可能导致信息泄露或者代码执行。

此外，`README.md`中引用的YouTube视频链接和GitHub仓库链接也存在一定的风险，例如链接可能指向恶意网站或包含恶意代码的仓库。

考虑到以上因素，该仓库存在一定的投毒风险，但主要是因为利用过程中涉及远程代码执行，如果验证的webshell存在后门也可能导致被控，而并非作者主动投毒。综合评估投毒风险在10%左右。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名，利用“../”等相对路径，将文件上传到Web服务器的任意目录，绕过上传限制。
2.  **参数覆盖：**  利用Struts框架的特性，覆盖文件上传相关的参数，例如`top.UploadFileName`，从而指定上传文件的目标路径。
3.  **上传恶意文件：**  上传包含恶意代码的文件，例如JSP WebShell，然后通过访问该文件来执行任意命令。
4.  **远程代码执行：** 结合路径遍历和恶意文件上传，攻击者可以在Web服务器上执行任意代码，控制服务器。

总的来说，攻击者通过构造恶意请求，欺骗服务器，最终实现远程代码执行。漏洞利用需要目标应用使用了易受攻击的`FileuploadInterceptor`。

**项目地址:** [punitdarji/Apache-struts-cve-2024-53677](https://github.com/punitdarji/Apache-struts-cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #14

**来源**: [CVE-2024-53677-r007sec_CVE-2024-53677.md](../2024/CVE-2024-53677-r007sec_CVE-2024-53677.md)

## CVE-2024-53677: Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.0.0 到 6.4.0 之前

**利用条件:** Apache Struts应用使用了基于FileuploadInterceptor的旧文件上传机制，且攻击者可以访问上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Apache Struts的旧文件上传逻辑中。攻击者可以通过操纵文件上传参数，进行路径遍历，从而将恶意文件上传到任意位置，例如Web容器的webapp目录，进而执行恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞利用是有效的。多个来源均指出 CVE-2024-53677 是一个严重的文件上传漏洞，攻击者可以利用它进行路径遍历和远程代码执行。提供的PoC代码包含一个可以上传WAR包的exploit，以及手动利用的multipart/form-data请求示例，证实了该漏洞的可利用性。

**投毒风险：**
PoC代码存在一定程度的投毒风险。虽然PoC的主要功能是利用漏洞，但其中可能隐藏一些不易察觉的恶意代码，例如：
1.  **WAR包内容：** exploit.py 脚本创建的WAR文件(webshell.war)本身可能包含后门代码。在没有仔细检查的情况下部署这个WAR包可能导致服务器被植入恶意程序。
2.  **上传逻辑修改：** 攻击者可能修改上传逻辑，例如在上传过程中记录服务器信息，或者尝试执行其他未授权操作。
3.  **依赖风险：** requirements.txt 中列出的依赖包可能包含恶意代码或安全漏洞。使用受污染的依赖包可能导致安全风险。
4.  **GIF89a头注入:**  虽然是为了绕过上传检查，但可能存在利用GIF解析漏洞的风险。虽然可能性较低，但是仍然需要考虑。
总体而言，考虑到WAR包本身是用来执行命令的，因此很难完全排除投毒的可能。如果用户盲目执行，并且没有对生成的WAR包进行检查，则存在风险。因此，投毒风险评估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改上传的文件名参数，使其包含`../`这样的路径遍历字符，从而能够将文件上传到服务器上的任意目录。
2.  **上传恶意文件：** 攻击者通常上传包含恶意代码的文件，例如JSP webshell或者WAR包，这些文件一旦被Web服务器解析，就可以执行任意命令。
3.  **远程代码执行：** 通过上传的恶意文件，攻击者可以在服务器上执行任意命令，从而完全控制服务器。

**总结：**
CVE-2024-53677是一个高危漏洞，利用简单，危害巨大。用户应该尽快升级到安全版本，或者采取其他缓解措施，例如禁用旧的文件上传功能。

**项目地址:** [r007sec/CVE-2024-53677](https://github.com/r007sec/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #15

**来源**: [CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md](../2024/CVE-2024-53677-seoyoung-kang_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/RCE

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用基于 FileuploadInterceptor 的旧文件上传逻辑，且可访问 upload.action 接口。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2024-53677 漏洞存在于 Apache Struts 的文件上传逻辑中。攻击者可以通过操纵文件上传参数实现路径遍历，从而上传恶意文件，例如 JSP webshell，最终导致远程代码执行。

**漏洞利用方式：**

1.  **确定目标应用是否使用存在漏洞的 Struts 版本** (2.0.0 到 6.3.x)。
2.  **确定目标应用是否使用基于 FileuploadInterceptor 的文件上传机制**。
3.  **发送包含恶意构造的`top.UploadFileName`参数的 POST 请求到 `upload.action` 接口**。`top.UploadFileName`参数用于指定上传文件的目标路径，攻击者可以通过该参数进行路径遍历，将文件上传到任意目录。
4.  **上传包含恶意代码的文件（如 JSP webshell）**。PoC 中使用了JSP webshell，允许执行服务器端命令。
5.  **通过访问上传的webshell执行任意命令。** PoC 上传 webshell 后，通过构造特定的 URL 参数 `action=cmd&cmd=<command>` 来执行命令。

**有效性评估：**

提供的PoC 代码有效，可以利用该漏洞实现文件上传和远程代码执行。PoC 包含两个 Python 脚本：

*   `PoC.py`:  该脚本通过 POST 请求上传包含 webshell 代码的 JSP 文件，并设置 `top.UploadFileName` 参数为目标路径，实现路径遍历和 webshell 上传。上传成功后，通过 GET 请求访问 webshell，执行指定的命令。
*   `cve_2024_53677_Tool.py`:  该脚本提供了一个交互式菜单，用于检测 Struts 版本、检查漏洞是否存在、上传测试文件和 webshell，并在 Selenium 中打开 webshell。功能更全面，方便漏洞利用。

**投毒风险评估：**

PoC代码中存在极小的投毒风险。PoC 主要功能是漏洞利用，将后门代码封装在webshell里，不算投毒。投毒代码可能藏在以下几点：

1.  **Webshell 代码本身**： 虽然 webshell 的主要目的是执行命令，但开发者可以加入其他恶意代码，例如收集服务器信息、植入持久性后门等。但PoC提供的webshell比较简单，主要的功能是命令执行。
2.  **工具脚本**（`cve_2024_53677_Tool.py`）： 该脚本拥有更多功能，可能在版本检测、文件上传等过程中隐藏恶意代码，例如修改上传文件的内容、记录用户输入等。
3.  **依赖库**：PoC 使用了 `requests` 和（可选）`selenium` 库。虽然这些库本身是安全的，但如果作者使用了恶意修改过的版本，可能会引入安全风险。

**综合评估，投毒风险较低（2%）。主要风险在于 webshell 本身可能存在恶意代码，以及对未知来源脚本的不信任。建议仔细审查代码，并使用可信的依赖库。**

**项目地址:** [seoyoung-kang/CVE-2024-53677](https://github.com/seoyoung-kang/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #16

**来源**: [CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md](../2024/CVE-2024-53677-shishirghimir_CVE-2024-53677-Exploit.md)

## CVE-2024-53677-Apache Struts 文件上传路径穿越 RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用了存在漏洞的FileuploadInterceptor且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是 Apache Struts 2 中一个严重的文件上传漏洞。攻击者可以通过构造恶意的文件上传请求，利用路径穿越漏洞将恶意 JSP 文件上传到服务器的任意目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果中多个链接都提到了该漏洞，并描述了其利用方式和风险。提供的 Python 脚本能够自动化利用该漏洞。

**投毒风险：**
分析提供的 exploit.py 和 shell.jsp 两个文件，没有发现明显的投毒代码。
*   `exploit.py`：此脚本的主要功能是上传 shell.jsp 并执行命令。它包含设置目标 URL、上传文件和执行命令的函数，不存在可疑或恶意的代码。
*   `shell.jsp`：此 JSP 文件实现了一个简单的 WebShell，允许通过 GET 请求执行系统命令。虽然 WebShell 本身具有潜在的风险，但其功能是明确的，不包含隐藏的恶意代码。
因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Apache Struts 2 应用，该应用使用了易受攻击的 FileuploadInterceptor 并且启用了文件上传功能。
2.  攻击者构造一个包含恶意路径的文件上传请求。例如，将文件名设置为 `../../../../tmp/shell.jsp`，尝试将文件上传到 `/tmp` 目录下。
3.  Struts 2 应用在处理文件上传请求时，由于存在路径穿越漏洞，会将恶意 JSP 文件上传到攻击者指定的目录。
4.  攻击者可以通过访问上传的 JSP 文件来执行任意系统命令。例如，访问 `http://example.com/tmp/shell.jsp?cmd=whoami` 可以在服务器上执行 `whoami` 命令，并将结果返回给攻击者。

**总结：**
CVE-2024-53677 是一个高危漏洞，利用难度相对较低，攻击者可以利用该漏洞完全控制服务器。建议受影响的用户尽快升级到最新版本，或采取缓解措施，如禁用易受攻击的 FileuploadInterceptor，并使用新的文件上传机制。

**项目地址:** [shishirghimir/CVE-2024-53677-Exploit](https://github.com/shishirghimir/CVE-2024-53677-Exploit)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

## POC #17

**来源**: [CVE-2024-53677-yangyanglo_CVE-2024-53677.md](../2024/CVE-2024-53677-yangyanglo_CVE-2024-53677.md)

## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 < Version < 6.4.0

**利用条件:** 需要开启了基于FileuploadInterceptor的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 框架中的文件上传漏洞，允许攻击者通过操纵文件上传参数，实现路径遍历，最终可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞确实存在，且具有较高的风险。提供的POC代码尝试利用此漏洞，其基本原理是通过修改上传的文件名参数，使其包含路径遍历字符（如`../`），从而将文件上传到Web服务器上非预期的目录中。POC代码通过`-u`指定上传地址，`-filename`指定包含路径遍历的文件名，`-file`指定需要上传的文件，`-type`指定上传类型(单文件或多文件)。如果服务器对上传的文件类型没有严格限制，攻击者可以上传包含恶意代码的JSP文件或其他脚本文件，从而执行任意命令。

**投毒风险：**
仔细审查了提供的POC代码（s2-067.py），没有发现任何明显的投毒代码。该脚本的主要功能是构造包含路径遍历的文件上传请求，并发送给目标服务器。脚本本身没有执行任何恶意操作，例如下载、执行其他程序或修改系统配置。因此，判断此仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  **确定目标：**  首先需要确定目标Apache Struts应用存在漏洞，并且使用了旧的文件上传机制（基于`FileuploadInterceptor`）。
2.  **构造恶意请求：**  使用POC代码或类似工具，构造包含路径遍历的文件上传请求。关键在于修改`filename`参数，使其包含`../`序列，指向Web服务器上可写目录。
3.  **上传恶意文件：**  将包含恶意代码的JSP文件（或其他类型的Web脚本文件）作为上传内容。
4.  **触发恶意代码：**  上传成功后，通过Web浏览器或其他工具访问上传的恶意文件，触发其中的代码执行。

**漏洞缓解措施:**

1. 升级到Apache Struts 6.4.0或更高版本。
2. 迁移到新的文件上传机制。
3. 如果无法迁移，限制上传文件的后缀名，使用自定义随机文件名称。

**项目地址:** [yangyanglo/CVE-2024-53677](https://github.com/yangyanglo/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)

---

