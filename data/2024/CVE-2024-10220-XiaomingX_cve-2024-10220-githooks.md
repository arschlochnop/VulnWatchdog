# CVE-2024-10220

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md](../2024/CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md)

# CVE-2024-10220

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md](../2024/CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md)

# CVE-2024-10220

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md](../2024/CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md)

# CVE-2024-10220

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md](../2024/CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md)

# CVE-2024-10220

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md](../2024/CVE-2024-10220-XiaomingX_cve-2024-10220-githooks.md)

## CVE-2024-10220-Kubernetes-Kubelet-gitRepo任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，可能导致节点接管

**影响版本:** <=1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 漏洞允许攻击者通过构造恶意的gitRepo volume在 Kubernetes kubelet 组件上执行任意命令。从搜索结果来看，此漏洞影响多个 Kubernetes 版本。利用方式是，攻击者创建一个包含恶意配置的 gitRepo volume 的 Pod。Kubelet 在拉取 Git 仓库时，如果仓库中存在恶意的 Git hooks 目录，则可能导致 kubelet 在宿主机上执行任意命令，从而绕过容器隔离并获得主机权限。

提供的漏洞利用代码片段只包含了`HEAD`和`LICENSE`文件，它们本身不包含任何恶意代码，因此直接利用提供的代码片段本身无法触发漏洞。但这些文件是git仓库的有效组成部分，攻击者可能利用这些基础文件，配合恶意的git hooks达到攻击目的。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是有效的，利用恶意构造的gitRepo Volume可以执行任意命令。

**投毒风险：** 提供的代码片段本身不构成投毒，因为仅仅是Git仓库中的`HEAD`引用和 `LICENSE` 许可协议，不包含任何可执行代码。但如果攻击者将这些文件与恶意的git hooks（例如 post-checkout, post-merge 等）结合，则可能在受害者拉取仓库后执行恶意代码，从而达到投毒的目的。 投毒风险评估为 10%，主要考量在于需要结合恶意 git hooks 才能实现。 这部分风险是由于在利用过程中，需要引入额外的恶意代码到 Git 仓库中，从而使得其他克隆该仓库的用户也受到影响的可能性。虽然提供的代码本身无害，但是作为一个攻击链的一部分，它提高了整体的投毒风险。

**利用方式：**

1.  攻击者需要具有创建 Pod 和关联 gitRepo volume 的权限。
2.  攻击者创建一个包含恶意 Git hooks 的 Git 仓库，例如 `post-checkout`、`post-merge` 等。
3.  攻击者创建一个 Pod，并使用 `gitRepo` volume 指向包含恶意 Git hooks 的仓库。
4.  当 Kubelet 拉取 Git 仓库时，恶意的 Git hooks 会被触发，从而在宿主机上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-10220-githooks](https://github.com/XiaomingX/cve-2024-10220-githooks)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #2

**来源**: [CVE-2024-10220-any2sec_cve-2024-10220.md](../2024/CVE-2024-10220-any2sec_cve-2024-10220.md)

## CVE-2024-10220-Kubernetes-Kubelet任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 允许攻击者通过特制的 gitRepo 卷执行任意命令。漏洞存在于 Kubelet 组件中，利用方式是创建一个包含恶意配置的 Git 仓库，并在 Pod 中声明使用该仓库作为 gitRepo 卷。当 Kubelet 拉取该仓库时，会执行恶意配置中定义的命令。该漏洞的利用方式依赖于 Git 的钩子（hooks）机制，攻击者可以在仓库的 hooks 目录下放置恶意脚本，这些脚本会在 Git 操作（例如 checkout）期间被执行，从而绕过容器隔离，在宿主机上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞是有效的。漏洞利用代码展示了一个包含 `post-checkout` 钩子的 Git 仓库，该钩子脚本会将 `/etc/passwd` 的内容复制到 `/poc` 文件中。当 Kubelet 拉取这个仓库并执行 checkout 操作时，这个钩子脚本会被执行，从而在宿主机上执行了读取 `/etc/passwd` 的命令。结合搜索结果，多个来源表明该漏洞已经存在可用的利用方法。

**投毒风险：**
分析 POC 代码，`post-checkout` 脚本的作用是将 `/etc/passwd` 的内容写入 `/poc` 文件。此行为本身是漏洞验证的一部分，旨在证明可以在容器外部执行代码。代码本身不包含任何恶意或隐藏的后门，可以判定投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 Git 仓库，仓库的 `hooks/post-checkout` 目录下包含恶意脚本。
2.  攻击者创建一个 Pod，并在 Pod 的 volume 中声明使用 gitRepo 卷，指向上述恶意 Git 仓库。
3.  Kubelet 会拉取恶意 Git 仓库。
4.  在拉取仓库的过程中，Git 会执行 `post-checkout` 钩子脚本。
5.  `post-checkout` 脚本在宿主机上执行任意命令，从而实现任意命令执行。

通过这种方式，攻击者可以绕过容器隔离，在宿主机上执行任意命令，从而完全控制节点。

**项目地址:** [any2sec/cve-2024-10220](https://github.com/any2sec/cve-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #3

**来源**: [CVE-2024-10220-candranapits_poc-CVE-2024-10220.md](../2024/CVE-2024-10220-candranapits_poc-CVE-2024-10220.md)

## CVE-2024-10220

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** kubelet

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 需要能够创建包含恶意gitRepo卷的Pod

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo 卷执行任意命令。

**漏洞利用方式：**
攻击者可以创建一个包含 gitRepo 卷的 Pod，并在该卷的初始化过程中执行恶意代码。利用的关键在于 gitRepo 卷会执行 `.git/hooks/post-checkout` 脚本。

**POC 分析：**
POC 代码包含两个文件：
1.  `README.md`:  提供 POC 的基本信息。
2.  `hooks/post-checkout`:  这是一个 shell 脚本，会在 `git checkout` 操作后执行。该脚本将 `id` 命令的输出写入 `/tmp/poc` 文件。

**有效性：**
该 POC 代码是有效的，只要 kubelet 的版本在受影响的范围内，并且攻击者能够创建包含恶意 gitRepo 卷的 Pod，就能成功执行任意命令。

**投毒风险：**
提供的 POC 代码非常简单，仅仅执行 `id` 命令并将输出写入文件，没有发现任何隐藏的恶意代码。因此，投毒风险为 0%。

**总结：**
攻击者创建一个包含gitRepo卷的pod，并指定一个包含恶意`.git/hooks/post-checkout`脚本的Git仓库，当kubelet拉取代码时，会执行此脚本，从而造成任意命令执行。

**项目地址:** [candranapits/poc-CVE-2024-10220](https://github.com/candranapits/poc-CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #4

**来源**: [CVE-2024-10220-filipzag_CVE-2024-10220.md](../2024/CVE-2024-10220-filipzag_CVE-2024-10220.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，允许攻击者在主机节点上执行任意命令，可能导致集群完全受控。

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod以及使用gitRepo volume的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo volume 执行任意命令。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞允许攻击者在受影响的 Kubernetes 集群中的节点上执行任意命令。提供的 POC 代码展示了一个利用此漏洞的简单示例，该示例创建一个包含恶意 hook 的 git 仓库。当 kubelet 拉取该仓库时，恶意 hook 会被执行，从而在节点上创建 `/tmp/cve-2024-10220` 文件，内容为 "You have been pwned!"。由于 POC 代码能够成功触发命令执行，因此可以认为该 POC 是有效的。

**投毒风险：**

分析提供的 POC 代码，`/tmp/ed40431b94c4f7558e5bd729b365fbc6/hooks/post-checkout` 脚本仅仅是简单的写入文件。没有发现任何隐藏的，具有破坏性或恶意行为的代码。因此，POC 代码本身不包含投毒行为，投毒风险为 0%。当然，实际攻击中，攻击者可能会在 `post-checkout` 脚本中添加更具危害性的代码。

**利用方式：**

1.  攻击者创建一个包含恶意 Git hooks 的 Git 仓库，例如 `post-checkout`。
2.  攻击者创建一个 Kubernetes Pod，该 Pod 使用 `gitRepo` volume 指向包含恶意 Git hooks 的 Git 仓库。
3.  当 kubelet 在节点上拉取（`git clone`）该仓库时，Git hooks 会被自动执行，从而在节点上执行攻击者预定义的任意命令。
4.  由于 kubelet 通常以 root 权限运行，因此攻击者可以在节点上以 root 权限执行命令，从而完全控制节点。

**缓解措施：**

*   升级 kubelet 到不受影响的版本（>= 1.28.12, >= 1.29.7, >= 1.30.3, 1.31.0）
*   限制用户创建具有 gitRepo volume 的 Pod 的权限。

**项目地址:** [filipzag/CVE-2024-10220](https://github.com/filipzag/CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #5

**来源**: [CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md](../2024/CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md)

## CVE-2024-10220-Kubelet-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点接管

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 漏洞允许攻击者通过恶意构造的 gitRepo volume 在 Kubernetes kubelet 组件上执行任意命令。攻击者需要具有创建 pod 和关联 gitRepo volume 的权限。漏洞利用方式如下：

1.  **漏洞原理：** kubelet 在使用 gitRepo volume 时，会执行 git clone 操作。攻击者可以通过在 git 仓库的 hooks 目录中放置恶意脚本，例如 `post-checkout` 脚本，来实现命令执行。
2.  **POC 代码分析：** 提供的 POC 代码包含以下文件：
    *   `HEAD`, `README.md`, `config`, `logs/HEAD`, `logs/refs/heads/master`, `refs/heads/master`: 标准 Git 仓库文件。
    *   `hooks/post-checkout`:  这是一个 shell 脚本，会在 git checkout 后执行。该脚本的内容是将 "Hello from container" 写入 `/tmp/CVE-2024-10220-OUTPUT` 文件。这表明当 kubelet 克隆包含此 hook 的仓库时，将在 kubelet 运行的节点上执行该命令。
    *   `manifest/gitrepo.yaml`:  这是一个 Kubernetes Pod 定义文件，其中定义了一个使用 gitRepo volume 的 Pod。`repository` 指向包含恶意 hook 的 Git 仓库，`revision` 指定了要检出的分支，`directory` 指定clone到容器的目录，此目录需要包含`.git`目录. 
3.  **利用流程：**
    *   攻击者创建一个包含恶意 `post-checkout` hook 的 Git 仓库。
    *   攻击者创建一个 Pod，并在 Pod 的 volume 中使用 gitRepo，指向攻击者创建的 Git 仓库。
    *   当 kubelet 创建 Pod 时，会克隆 Git 仓库。由于仓库中包含 `post-checkout` hook，kubelet 会执行该 hook 中的命令，从而在节点上执行任意代码。
4.  **有效性：** 根据漏洞描述和 POC 代码分析，可以判断该 POC 代码是有效的。它展示了如何通过 gitRepo volume 和恶意 hook 在 Kubernetes 节点上执行任意命令。
5. **投毒风险：** 仓库本身的文件内容没有明显的恶意行为。然而，`hooks/post-checkout` 的目的就是为了执行命令，虽然示例是写入文件，但可以修改为任何恶意操作。由于脚本本身就具有执行命令的能力，将其定义为投毒具有一定的主观性。但从利用的角度看，目前写入文件的行为是为了验证漏洞的存在，而不是为了投毒。作者后期可以修改为投毒脚本，存在潜在风险，暂且将其标记为10%的投毒风险.风险在于使用者不仔细检查脚本内容，直接应用到生产环境，存在潜在风险。

**项目地址:** [mochizuki875/CVE-2024-10220-githooks](https://github.com/mochizuki875/CVE-2024-10220-githooks)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #6

**来源**: [CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md](../2024/CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md)

## CVE-2024-10220-Kubernetes-gitRepo-Volume-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，允许低权限用户在主机节点上执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要能够创建Pod并指定gitRepo卷。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞允许攻击者通过特制的 gitRepo 卷在 Kubernetes kubelet 组件上执行任意命令。漏洞利用涉及创建一个包含恶意 .hooks 目录的 Git 仓库，当 kubelet 尝试拉取该仓库时，.hooks 目录中的恶意脚本会在主机节点上以 root 权限执行。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞描述明确指出通过 gitRepo 卷可以执行任意命令。搜索引擎结果中的多个链接证实了该漏洞的存在和高危性。提供的 Python POC 代码模拟了利用该漏洞的过程，通过向 kubelet 发送包含恶意 gitRepo 卷配置的 Pod 清单来实现。

**投毒风险：**
提供的代码主要包含 MIT 许可证、README.md 文件和一个 Python 脚本。该 Python 脚本旨在触发 CVE-2024-10220 漏洞，通过向 kubelet 发送精心构造的 Pod 清单，从而执行 Git 仓库中的恶意钩子脚本。检查了提供的 LICENSE、README.md 和 Python 脚本，未发现任何可疑的后门或恶意代码。代码的功能明确，旨在利用 CVE-2024-10220 漏洞。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者需要具有在受影响的 Kubernetes 集群中创建 Pod 的权限。
2.  攻击者创建一个包含恶意 Git 仓库，该仓库的 `.git/hooks` 目录包含要执行的恶意脚本。
3.  攻击者创建一个 Pod 清单，其中指定使用 `gitRepo` 卷，并指向恶意 Git 仓库。
4.  攻击者将 Pod 清单提交到 Kubernetes 集群。
5.  Kubelet 尝试拉取 Git 仓库时，会执行 `.git/hooks` 目录中的恶意脚本，从而在主机节点上执行任意命令。

**项目地址:** [mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability](https://github.com/mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #7

**来源**: [CVE-2024-10220-orgC_CVE-2024-10220-demo.md](../2024/CVE-2024-10220-orgC_CVE-2024-10220-demo.md)

## CVE-2024-10220-Kubelet-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo Volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 允许攻击者通过特制的gitRepo Volume在 Kubernetes kubelet 组件上执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞源于 kubelet 在处理 gitRepo Volume 时，没有充分限制路径，允许攻击者利用 Git 钩子执行恶意命令。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意 Git 仓库的 Pod。
    *   该仓库的 `.git/hooks` 目录下包含恶意脚本（例如 `post-checkout`, `pre-commit`等）。
    *   当 kubelet 克隆或更新该仓库时，Git 钩子会被触发，从而执行恶意脚本。
    *   由于 kubelet 通常以 root 权限运行，恶意脚本也会以 root 权限执行，从而控制节点。
3.  **POC分析：** 提供的POC代码 `/tmp/062232065a7902f899883e0db5641023/index.html` 内容为 "Malicious code"。这本身不是一个完整的 POC， 仅仅是一个指示Payload位置的文件。要成功利用此漏洞，需要一个包含恶意git hooks的Git仓库，然后通过Pod定义中的gitRepo volume引用该仓库。此文件可能存在投毒风险是因为：攻击者可以在 git 仓库中添加额外的后门或恶意功能，这些功能可能不会立即被发现，但会在后续被触发。 此文件index.html 可能只是一个诱饵。 因此投毒风险为10%。搜索引擎结果表明，该漏洞利用主要通过git hooks实现远程命令执行, 权限为Root.

**总结：** 漏洞利用的有效性取决于是否能创建一个包含恶意 Git 仓库的 Pod，以及是否能成功触发 Git 钩子。该漏洞风险极高，因为攻击者可以利用它完全控制受影响的 Kubernetes 节点。

**项目地址:** [orgC/CVE-2024-10220-demo](https://github.com/orgC/CVE-2024-10220-demo)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #8

**来源**: [CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md](../2024/CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，可导致节点被控制

**影响版本:** <=1.28.11, 1.29.0-1.29.6, 1.30.0-1.30.2

**利用条件:** 攻击者需要能够创建包含恶意gitRepo卷的Pod。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许通过精心设计的gitRepo卷在Kubernetes kubelet组件上执行任意命令。POC代码展示了一个恶意的git仓库，其`hooks/post-checkout`脚本包含`id > /tmp/poc`，这意味着每次检出代码时，都会将执行命令的用户ID写入`/tmp/poc`文件。当kubelet尝试从这个恶意git仓库拉取代码时，`post-checkout`钩子会被执行，从而实现任意命令执行。根据漏洞库信息，攻击者只需要拥有创建Pod的权限，且Pod的spec包含恶意的gitRepo 卷即可触发漏洞。由于提供的POC仅仅验证了命令执行，并没有发现其它恶意代码，因此投毒风险较低。

**项目地址:** [saleha-muzammil/cve-2024-10220-git-on-git](https://github.com/saleha-muzammil/cve-2024-10220-git-on-git)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---



---

## POC #2

**来源**: [CVE-2024-10220-any2sec_cve-2024-10220.md](../2024/CVE-2024-10220-any2sec_cve-2024-10220.md)

## CVE-2024-10220-Kubernetes-Kubelet任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 允许攻击者通过特制的 gitRepo 卷执行任意命令。漏洞存在于 Kubelet 组件中，利用方式是创建一个包含恶意配置的 Git 仓库，并在 Pod 中声明使用该仓库作为 gitRepo 卷。当 Kubelet 拉取该仓库时，会执行恶意配置中定义的命令。该漏洞的利用方式依赖于 Git 的钩子（hooks）机制，攻击者可以在仓库的 hooks 目录下放置恶意脚本，这些脚本会在 Git 操作（例如 checkout）期间被执行，从而绕过容器隔离，在宿主机上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞是有效的。漏洞利用代码展示了一个包含 `post-checkout` 钩子的 Git 仓库，该钩子脚本会将 `/etc/passwd` 的内容复制到 `/poc` 文件中。当 Kubelet 拉取这个仓库并执行 checkout 操作时，这个钩子脚本会被执行，从而在宿主机上执行了读取 `/etc/passwd` 的命令。结合搜索结果，多个来源表明该漏洞已经存在可用的利用方法。

**投毒风险：**
分析 POC 代码，`post-checkout` 脚本的作用是将 `/etc/passwd` 的内容写入 `/poc` 文件。此行为本身是漏洞验证的一部分，旨在证明可以在容器外部执行代码。代码本身不包含任何恶意或隐藏的后门，可以判定投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 Git 仓库，仓库的 `hooks/post-checkout` 目录下包含恶意脚本。
2.  攻击者创建一个 Pod，并在 Pod 的 volume 中声明使用 gitRepo 卷，指向上述恶意 Git 仓库。
3.  Kubelet 会拉取恶意 Git 仓库。
4.  在拉取仓库的过程中，Git 会执行 `post-checkout` 钩子脚本。
5.  `post-checkout` 脚本在宿主机上执行任意命令，从而实现任意命令执行。

通过这种方式，攻击者可以绕过容器隔离，在宿主机上执行任意命令，从而完全控制节点。

**项目地址:** [any2sec/cve-2024-10220](https://github.com/any2sec/cve-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #3

**来源**: [CVE-2024-10220-candranapits_poc-CVE-2024-10220.md](../2024/CVE-2024-10220-candranapits_poc-CVE-2024-10220.md)

## CVE-2024-10220

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** kubelet

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 需要能够创建包含恶意gitRepo卷的Pod

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo 卷执行任意命令。

**漏洞利用方式：**
攻击者可以创建一个包含 gitRepo 卷的 Pod，并在该卷的初始化过程中执行恶意代码。利用的关键在于 gitRepo 卷会执行 `.git/hooks/post-checkout` 脚本。

**POC 分析：**
POC 代码包含两个文件：
1.  `README.md`:  提供 POC 的基本信息。
2.  `hooks/post-checkout`:  这是一个 shell 脚本，会在 `git checkout` 操作后执行。该脚本将 `id` 命令的输出写入 `/tmp/poc` 文件。

**有效性：**
该 POC 代码是有效的，只要 kubelet 的版本在受影响的范围内，并且攻击者能够创建包含恶意 gitRepo 卷的 Pod，就能成功执行任意命令。

**投毒风险：**
提供的 POC 代码非常简单，仅仅执行 `id` 命令并将输出写入文件，没有发现任何隐藏的恶意代码。因此，投毒风险为 0%。

**总结：**
攻击者创建一个包含gitRepo卷的pod，并指定一个包含恶意`.git/hooks/post-checkout`脚本的Git仓库，当kubelet拉取代码时，会执行此脚本，从而造成任意命令执行。

**项目地址:** [candranapits/poc-CVE-2024-10220](https://github.com/candranapits/poc-CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #4

**来源**: [CVE-2024-10220-filipzag_CVE-2024-10220.md](../2024/CVE-2024-10220-filipzag_CVE-2024-10220.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，允许攻击者在主机节点上执行任意命令，可能导致集群完全受控。

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod以及使用gitRepo volume的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo volume 执行任意命令。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞允许攻击者在受影响的 Kubernetes 集群中的节点上执行任意命令。提供的 POC 代码展示了一个利用此漏洞的简单示例，该示例创建一个包含恶意 hook 的 git 仓库。当 kubelet 拉取该仓库时，恶意 hook 会被执行，从而在节点上创建 `/tmp/cve-2024-10220` 文件，内容为 "You have been pwned!"。由于 POC 代码能够成功触发命令执行，因此可以认为该 POC 是有效的。

**投毒风险：**

分析提供的 POC 代码，`/tmp/ed40431b94c4f7558e5bd729b365fbc6/hooks/post-checkout` 脚本仅仅是简单的写入文件。没有发现任何隐藏的，具有破坏性或恶意行为的代码。因此，POC 代码本身不包含投毒行为，投毒风险为 0%。当然，实际攻击中，攻击者可能会在 `post-checkout` 脚本中添加更具危害性的代码。

**利用方式：**

1.  攻击者创建一个包含恶意 Git hooks 的 Git 仓库，例如 `post-checkout`。
2.  攻击者创建一个 Kubernetes Pod，该 Pod 使用 `gitRepo` volume 指向包含恶意 Git hooks 的 Git 仓库。
3.  当 kubelet 在节点上拉取（`git clone`）该仓库时，Git hooks 会被自动执行，从而在节点上执行攻击者预定义的任意命令。
4.  由于 kubelet 通常以 root 权限运行，因此攻击者可以在节点上以 root 权限执行命令，从而完全控制节点。

**缓解措施：**

*   升级 kubelet 到不受影响的版本（>= 1.28.12, >= 1.29.7, >= 1.30.3, 1.31.0）
*   限制用户创建具有 gitRepo volume 的 Pod 的权限。

**项目地址:** [filipzag/CVE-2024-10220](https://github.com/filipzag/CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #5

**来源**: [CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md](../2024/CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md)

## CVE-2024-10220-Kubelet-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点接管

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 漏洞允许攻击者通过恶意构造的 gitRepo volume 在 Kubernetes kubelet 组件上执行任意命令。攻击者需要具有创建 pod 和关联 gitRepo volume 的权限。漏洞利用方式如下：

1.  **漏洞原理：** kubelet 在使用 gitRepo volume 时，会执行 git clone 操作。攻击者可以通过在 git 仓库的 hooks 目录中放置恶意脚本，例如 `post-checkout` 脚本，来实现命令执行。
2.  **POC 代码分析：** 提供的 POC 代码包含以下文件：
    *   `HEAD`, `README.md`, `config`, `logs/HEAD`, `logs/refs/heads/master`, `refs/heads/master`: 标准 Git 仓库文件。
    *   `hooks/post-checkout`:  这是一个 shell 脚本，会在 git checkout 后执行。该脚本的内容是将 "Hello from container" 写入 `/tmp/CVE-2024-10220-OUTPUT` 文件。这表明当 kubelet 克隆包含此 hook 的仓库时，将在 kubelet 运行的节点上执行该命令。
    *   `manifest/gitrepo.yaml`:  这是一个 Kubernetes Pod 定义文件，其中定义了一个使用 gitRepo volume 的 Pod。`repository` 指向包含恶意 hook 的 Git 仓库，`revision` 指定了要检出的分支，`directory` 指定clone到容器的目录，此目录需要包含`.git`目录. 
3.  **利用流程：**
    *   攻击者创建一个包含恶意 `post-checkout` hook 的 Git 仓库。
    *   攻击者创建一个 Pod，并在 Pod 的 volume 中使用 gitRepo，指向攻击者创建的 Git 仓库。
    *   当 kubelet 创建 Pod 时，会克隆 Git 仓库。由于仓库中包含 `post-checkout` hook，kubelet 会执行该 hook 中的命令，从而在节点上执行任意代码。
4.  **有效性：** 根据漏洞描述和 POC 代码分析，可以判断该 POC 代码是有效的。它展示了如何通过 gitRepo volume 和恶意 hook 在 Kubernetes 节点上执行任意命令。
5. **投毒风险：** 仓库本身的文件内容没有明显的恶意行为。然而，`hooks/post-checkout` 的目的就是为了执行命令，虽然示例是写入文件，但可以修改为任何恶意操作。由于脚本本身就具有执行命令的能力，将其定义为投毒具有一定的主观性。但从利用的角度看，目前写入文件的行为是为了验证漏洞的存在，而不是为了投毒。作者后期可以修改为投毒脚本，存在潜在风险，暂且将其标记为10%的投毒风险.风险在于使用者不仔细检查脚本内容，直接应用到生产环境，存在潜在风险。

**项目地址:** [mochizuki875/CVE-2024-10220-githooks](https://github.com/mochizuki875/CVE-2024-10220-githooks)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #6

**来源**: [CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md](../2024/CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md)

## CVE-2024-10220-Kubernetes-gitRepo-Volume-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，允许低权限用户在主机节点上执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要能够创建Pod并指定gitRepo卷。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞允许攻击者通过特制的 gitRepo 卷在 Kubernetes kubelet 组件上执行任意命令。漏洞利用涉及创建一个包含恶意 .hooks 目录的 Git 仓库，当 kubelet 尝试拉取该仓库时，.hooks 目录中的恶意脚本会在主机节点上以 root 权限执行。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞描述明确指出通过 gitRepo 卷可以执行任意命令。搜索引擎结果中的多个链接证实了该漏洞的存在和高危性。提供的 Python POC 代码模拟了利用该漏洞的过程，通过向 kubelet 发送包含恶意 gitRepo 卷配置的 Pod 清单来实现。

**投毒风险：**
提供的代码主要包含 MIT 许可证、README.md 文件和一个 Python 脚本。该 Python 脚本旨在触发 CVE-2024-10220 漏洞，通过向 kubelet 发送精心构造的 Pod 清单，从而执行 Git 仓库中的恶意钩子脚本。检查了提供的 LICENSE、README.md 和 Python 脚本，未发现任何可疑的后门或恶意代码。代码的功能明确，旨在利用 CVE-2024-10220 漏洞。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者需要具有在受影响的 Kubernetes 集群中创建 Pod 的权限。
2.  攻击者创建一个包含恶意 Git 仓库，该仓库的 `.git/hooks` 目录包含要执行的恶意脚本。
3.  攻击者创建一个 Pod 清单，其中指定使用 `gitRepo` 卷，并指向恶意 Git 仓库。
4.  攻击者将 Pod 清单提交到 Kubernetes 集群。
5.  Kubelet 尝试拉取 Git 仓库时，会执行 `.git/hooks` 目录中的恶意脚本，从而在主机节点上执行任意命令。

**项目地址:** [mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability](https://github.com/mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #7

**来源**: [CVE-2024-10220-orgC_CVE-2024-10220-demo.md](../2024/CVE-2024-10220-orgC_CVE-2024-10220-demo.md)

## CVE-2024-10220-Kubelet-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo Volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 允许攻击者通过特制的gitRepo Volume在 Kubernetes kubelet 组件上执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞源于 kubelet 在处理 gitRepo Volume 时，没有充分限制路径，允许攻击者利用 Git 钩子执行恶意命令。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意 Git 仓库的 Pod。
    *   该仓库的 `.git/hooks` 目录下包含恶意脚本（例如 `post-checkout`, `pre-commit`等）。
    *   当 kubelet 克隆或更新该仓库时，Git 钩子会被触发，从而执行恶意脚本。
    *   由于 kubelet 通常以 root 权限运行，恶意脚本也会以 root 权限执行，从而控制节点。
3.  **POC分析：** 提供的POC代码 `/tmp/062232065a7902f899883e0db5641023/index.html` 内容为 "Malicious code"。这本身不是一个完整的 POC， 仅仅是一个指示Payload位置的文件。要成功利用此漏洞，需要一个包含恶意git hooks的Git仓库，然后通过Pod定义中的gitRepo volume引用该仓库。此文件可能存在投毒风险是因为：攻击者可以在 git 仓库中添加额外的后门或恶意功能，这些功能可能不会立即被发现，但会在后续被触发。 此文件index.html 可能只是一个诱饵。 因此投毒风险为10%。搜索引擎结果表明，该漏洞利用主要通过git hooks实现远程命令执行, 权限为Root.

**总结：** 漏洞利用的有效性取决于是否能创建一个包含恶意 Git 仓库的 Pod，以及是否能成功触发 Git 钩子。该漏洞风险极高，因为攻击者可以利用它完全控制受影响的 Kubernetes 节点。

**项目地址:** [orgC/CVE-2024-10220-demo](https://github.com/orgC/CVE-2024-10220-demo)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #8

**来源**: [CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md](../2024/CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，可导致节点被控制

**影响版本:** <=1.28.11, 1.29.0-1.29.6, 1.30.0-1.30.2

**利用条件:** 攻击者需要能够创建包含恶意gitRepo卷的Pod。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许通过精心设计的gitRepo卷在Kubernetes kubelet组件上执行任意命令。POC代码展示了一个恶意的git仓库，其`hooks/post-checkout`脚本包含`id > /tmp/poc`，这意味着每次检出代码时，都会将执行命令的用户ID写入`/tmp/poc`文件。当kubelet尝试从这个恶意git仓库拉取代码时，`post-checkout`钩子会被执行，从而实现任意命令执行。根据漏洞库信息，攻击者只需要拥有创建Pod的权限，且Pod的spec包含恶意的gitRepo 卷即可触发漏洞。由于提供的POC仅仅验证了命令执行，并没有发现其它恶意代码，因此投毒风险较低。

**项目地址:** [saleha-muzammil/cve-2024-10220-git-on-git](https://github.com/saleha-muzammil/cve-2024-10220-git-on-git)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---



---

## POC #2

**来源**: [CVE-2024-10220-any2sec_cve-2024-10220.md](../2024/CVE-2024-10220-any2sec_cve-2024-10220.md)

## CVE-2024-10220-Kubernetes-Kubelet任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 允许攻击者通过特制的 gitRepo 卷执行任意命令。漏洞存在于 Kubelet 组件中，利用方式是创建一个包含恶意配置的 Git 仓库，并在 Pod 中声明使用该仓库作为 gitRepo 卷。当 Kubelet 拉取该仓库时，会执行恶意配置中定义的命令。该漏洞的利用方式依赖于 Git 的钩子（hooks）机制，攻击者可以在仓库的 hooks 目录下放置恶意脚本，这些脚本会在 Git 操作（例如 checkout）期间被执行，从而绕过容器隔离，在宿主机上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞是有效的。漏洞利用代码展示了一个包含 `post-checkout` 钩子的 Git 仓库，该钩子脚本会将 `/etc/passwd` 的内容复制到 `/poc` 文件中。当 Kubelet 拉取这个仓库并执行 checkout 操作时，这个钩子脚本会被执行，从而在宿主机上执行了读取 `/etc/passwd` 的命令。结合搜索结果，多个来源表明该漏洞已经存在可用的利用方法。

**投毒风险：**
分析 POC 代码，`post-checkout` 脚本的作用是将 `/etc/passwd` 的内容写入 `/poc` 文件。此行为本身是漏洞验证的一部分，旨在证明可以在容器外部执行代码。代码本身不包含任何恶意或隐藏的后门，可以判定投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 Git 仓库，仓库的 `hooks/post-checkout` 目录下包含恶意脚本。
2.  攻击者创建一个 Pod，并在 Pod 的 volume 中声明使用 gitRepo 卷，指向上述恶意 Git 仓库。
3.  Kubelet 会拉取恶意 Git 仓库。
4.  在拉取仓库的过程中，Git 会执行 `post-checkout` 钩子脚本。
5.  `post-checkout` 脚本在宿主机上执行任意命令，从而实现任意命令执行。

通过这种方式，攻击者可以绕过容器隔离，在宿主机上执行任意命令，从而完全控制节点。

**项目地址:** [any2sec/cve-2024-10220](https://github.com/any2sec/cve-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #3

**来源**: [CVE-2024-10220-candranapits_poc-CVE-2024-10220.md](../2024/CVE-2024-10220-candranapits_poc-CVE-2024-10220.md)

## CVE-2024-10220

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** kubelet

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 需要能够创建包含恶意gitRepo卷的Pod

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo 卷执行任意命令。

**漏洞利用方式：**
攻击者可以创建一个包含 gitRepo 卷的 Pod，并在该卷的初始化过程中执行恶意代码。利用的关键在于 gitRepo 卷会执行 `.git/hooks/post-checkout` 脚本。

**POC 分析：**
POC 代码包含两个文件：
1.  `README.md`:  提供 POC 的基本信息。
2.  `hooks/post-checkout`:  这是一个 shell 脚本，会在 `git checkout` 操作后执行。该脚本将 `id` 命令的输出写入 `/tmp/poc` 文件。

**有效性：**
该 POC 代码是有效的，只要 kubelet 的版本在受影响的范围内，并且攻击者能够创建包含恶意 gitRepo 卷的 Pod，就能成功执行任意命令。

**投毒风险：**
提供的 POC 代码非常简单，仅仅执行 `id` 命令并将输出写入文件，没有发现任何隐藏的恶意代码。因此，投毒风险为 0%。

**总结：**
攻击者创建一个包含gitRepo卷的pod，并指定一个包含恶意`.git/hooks/post-checkout`脚本的Git仓库，当kubelet拉取代码时，会执行此脚本，从而造成任意命令执行。

**项目地址:** [candranapits/poc-CVE-2024-10220](https://github.com/candranapits/poc-CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #4

**来源**: [CVE-2024-10220-filipzag_CVE-2024-10220.md](../2024/CVE-2024-10220-filipzag_CVE-2024-10220.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，允许攻击者在主机节点上执行任意命令，可能导致集群完全受控。

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod以及使用gitRepo volume的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo volume 执行任意命令。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞允许攻击者在受影响的 Kubernetes 集群中的节点上执行任意命令。提供的 POC 代码展示了一个利用此漏洞的简单示例，该示例创建一个包含恶意 hook 的 git 仓库。当 kubelet 拉取该仓库时，恶意 hook 会被执行，从而在节点上创建 `/tmp/cve-2024-10220` 文件，内容为 "You have been pwned!"。由于 POC 代码能够成功触发命令执行，因此可以认为该 POC 是有效的。

**投毒风险：**

分析提供的 POC 代码，`/tmp/ed40431b94c4f7558e5bd729b365fbc6/hooks/post-checkout` 脚本仅仅是简单的写入文件。没有发现任何隐藏的，具有破坏性或恶意行为的代码。因此，POC 代码本身不包含投毒行为，投毒风险为 0%。当然，实际攻击中，攻击者可能会在 `post-checkout` 脚本中添加更具危害性的代码。

**利用方式：**

1.  攻击者创建一个包含恶意 Git hooks 的 Git 仓库，例如 `post-checkout`。
2.  攻击者创建一个 Kubernetes Pod，该 Pod 使用 `gitRepo` volume 指向包含恶意 Git hooks 的 Git 仓库。
3.  当 kubelet 在节点上拉取（`git clone`）该仓库时，Git hooks 会被自动执行，从而在节点上执行攻击者预定义的任意命令。
4.  由于 kubelet 通常以 root 权限运行，因此攻击者可以在节点上以 root 权限执行命令，从而完全控制节点。

**缓解措施：**

*   升级 kubelet 到不受影响的版本（>= 1.28.12, >= 1.29.7, >= 1.30.3, 1.31.0）
*   限制用户创建具有 gitRepo volume 的 Pod 的权限。

**项目地址:** [filipzag/CVE-2024-10220](https://github.com/filipzag/CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #5

**来源**: [CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md](../2024/CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md)

## CVE-2024-10220-Kubelet-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点接管

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 漏洞允许攻击者通过恶意构造的 gitRepo volume 在 Kubernetes kubelet 组件上执行任意命令。攻击者需要具有创建 pod 和关联 gitRepo volume 的权限。漏洞利用方式如下：

1.  **漏洞原理：** kubelet 在使用 gitRepo volume 时，会执行 git clone 操作。攻击者可以通过在 git 仓库的 hooks 目录中放置恶意脚本，例如 `post-checkout` 脚本，来实现命令执行。
2.  **POC 代码分析：** 提供的 POC 代码包含以下文件：
    *   `HEAD`, `README.md`, `config`, `logs/HEAD`, `logs/refs/heads/master`, `refs/heads/master`: 标准 Git 仓库文件。
    *   `hooks/post-checkout`:  这是一个 shell 脚本，会在 git checkout 后执行。该脚本的内容是将 "Hello from container" 写入 `/tmp/CVE-2024-10220-OUTPUT` 文件。这表明当 kubelet 克隆包含此 hook 的仓库时，将在 kubelet 运行的节点上执行该命令。
    *   `manifest/gitrepo.yaml`:  这是一个 Kubernetes Pod 定义文件，其中定义了一个使用 gitRepo volume 的 Pod。`repository` 指向包含恶意 hook 的 Git 仓库，`revision` 指定了要检出的分支，`directory` 指定clone到容器的目录，此目录需要包含`.git`目录. 
3.  **利用流程：**
    *   攻击者创建一个包含恶意 `post-checkout` hook 的 Git 仓库。
    *   攻击者创建一个 Pod，并在 Pod 的 volume 中使用 gitRepo，指向攻击者创建的 Git 仓库。
    *   当 kubelet 创建 Pod 时，会克隆 Git 仓库。由于仓库中包含 `post-checkout` hook，kubelet 会执行该 hook 中的命令，从而在节点上执行任意代码。
4.  **有效性：** 根据漏洞描述和 POC 代码分析，可以判断该 POC 代码是有效的。它展示了如何通过 gitRepo volume 和恶意 hook 在 Kubernetes 节点上执行任意命令。
5. **投毒风险：** 仓库本身的文件内容没有明显的恶意行为。然而，`hooks/post-checkout` 的目的就是为了执行命令，虽然示例是写入文件，但可以修改为任何恶意操作。由于脚本本身就具有执行命令的能力，将其定义为投毒具有一定的主观性。但从利用的角度看，目前写入文件的行为是为了验证漏洞的存在，而不是为了投毒。作者后期可以修改为投毒脚本，存在潜在风险，暂且将其标记为10%的投毒风险.风险在于使用者不仔细检查脚本内容，直接应用到生产环境，存在潜在风险。

**项目地址:** [mochizuki875/CVE-2024-10220-githooks](https://github.com/mochizuki875/CVE-2024-10220-githooks)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #6

**来源**: [CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md](../2024/CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md)

## CVE-2024-10220-Kubernetes-gitRepo-Volume-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，允许低权限用户在主机节点上执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要能够创建Pod并指定gitRepo卷。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞允许攻击者通过特制的 gitRepo 卷在 Kubernetes kubelet 组件上执行任意命令。漏洞利用涉及创建一个包含恶意 .hooks 目录的 Git 仓库，当 kubelet 尝试拉取该仓库时，.hooks 目录中的恶意脚本会在主机节点上以 root 权限执行。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞描述明确指出通过 gitRepo 卷可以执行任意命令。搜索引擎结果中的多个链接证实了该漏洞的存在和高危性。提供的 Python POC 代码模拟了利用该漏洞的过程，通过向 kubelet 发送包含恶意 gitRepo 卷配置的 Pod 清单来实现。

**投毒风险：**
提供的代码主要包含 MIT 许可证、README.md 文件和一个 Python 脚本。该 Python 脚本旨在触发 CVE-2024-10220 漏洞，通过向 kubelet 发送精心构造的 Pod 清单，从而执行 Git 仓库中的恶意钩子脚本。检查了提供的 LICENSE、README.md 和 Python 脚本，未发现任何可疑的后门或恶意代码。代码的功能明确，旨在利用 CVE-2024-10220 漏洞。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者需要具有在受影响的 Kubernetes 集群中创建 Pod 的权限。
2.  攻击者创建一个包含恶意 Git 仓库，该仓库的 `.git/hooks` 目录包含要执行的恶意脚本。
3.  攻击者创建一个 Pod 清单，其中指定使用 `gitRepo` 卷，并指向恶意 Git 仓库。
4.  攻击者将 Pod 清单提交到 Kubernetes 集群。
5.  Kubelet 尝试拉取 Git 仓库时，会执行 `.git/hooks` 目录中的恶意脚本，从而在主机节点上执行任意命令。

**项目地址:** [mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability](https://github.com/mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #7

**来源**: [CVE-2024-10220-orgC_CVE-2024-10220-demo.md](../2024/CVE-2024-10220-orgC_CVE-2024-10220-demo.md)

## CVE-2024-10220-Kubelet-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo Volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 允许攻击者通过特制的gitRepo Volume在 Kubernetes kubelet 组件上执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞源于 kubelet 在处理 gitRepo Volume 时，没有充分限制路径，允许攻击者利用 Git 钩子执行恶意命令。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意 Git 仓库的 Pod。
    *   该仓库的 `.git/hooks` 目录下包含恶意脚本（例如 `post-checkout`, `pre-commit`等）。
    *   当 kubelet 克隆或更新该仓库时，Git 钩子会被触发，从而执行恶意脚本。
    *   由于 kubelet 通常以 root 权限运行，恶意脚本也会以 root 权限执行，从而控制节点。
3.  **POC分析：** 提供的POC代码 `/tmp/062232065a7902f899883e0db5641023/index.html` 内容为 "Malicious code"。这本身不是一个完整的 POC， 仅仅是一个指示Payload位置的文件。要成功利用此漏洞，需要一个包含恶意git hooks的Git仓库，然后通过Pod定义中的gitRepo volume引用该仓库。此文件可能存在投毒风险是因为：攻击者可以在 git 仓库中添加额外的后门或恶意功能，这些功能可能不会立即被发现，但会在后续被触发。 此文件index.html 可能只是一个诱饵。 因此投毒风险为10%。搜索引擎结果表明，该漏洞利用主要通过git hooks实现远程命令执行, 权限为Root.

**总结：** 漏洞利用的有效性取决于是否能创建一个包含恶意 Git 仓库的 Pod，以及是否能成功触发 Git 钩子。该漏洞风险极高，因为攻击者可以利用它完全控制受影响的 Kubernetes 节点。

**项目地址:** [orgC/CVE-2024-10220-demo](https://github.com/orgC/CVE-2024-10220-demo)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #8

**来源**: [CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md](../2024/CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，可导致节点被控制

**影响版本:** <=1.28.11, 1.29.0-1.29.6, 1.30.0-1.30.2

**利用条件:** 攻击者需要能够创建包含恶意gitRepo卷的Pod。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许通过精心设计的gitRepo卷在Kubernetes kubelet组件上执行任意命令。POC代码展示了一个恶意的git仓库，其`hooks/post-checkout`脚本包含`id > /tmp/poc`，这意味着每次检出代码时，都会将执行命令的用户ID写入`/tmp/poc`文件。当kubelet尝试从这个恶意git仓库拉取代码时，`post-checkout`钩子会被执行，从而实现任意命令执行。根据漏洞库信息，攻击者只需要拥有创建Pod的权限，且Pod的spec包含恶意的gitRepo 卷即可触发漏洞。由于提供的POC仅仅验证了命令执行，并没有发现其它恶意代码，因此投毒风险较低。

**项目地址:** [saleha-muzammil/cve-2024-10220-git-on-git](https://github.com/saleha-muzammil/cve-2024-10220-git-on-git)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---



---

## POC #2

**来源**: [CVE-2024-10220-any2sec_cve-2024-10220.md](../2024/CVE-2024-10220-any2sec_cve-2024-10220.md)

## CVE-2024-10220-Kubernetes-Kubelet任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 允许攻击者通过特制的 gitRepo 卷执行任意命令。漏洞存在于 Kubelet 组件中，利用方式是创建一个包含恶意配置的 Git 仓库，并在 Pod 中声明使用该仓库作为 gitRepo 卷。当 Kubelet 拉取该仓库时，会执行恶意配置中定义的命令。该漏洞的利用方式依赖于 Git 的钩子（hooks）机制，攻击者可以在仓库的 hooks 目录下放置恶意脚本，这些脚本会在 Git 操作（例如 checkout）期间被执行，从而绕过容器隔离，在宿主机上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞是有效的。漏洞利用代码展示了一个包含 `post-checkout` 钩子的 Git 仓库，该钩子脚本会将 `/etc/passwd` 的内容复制到 `/poc` 文件中。当 Kubelet 拉取这个仓库并执行 checkout 操作时，这个钩子脚本会被执行，从而在宿主机上执行了读取 `/etc/passwd` 的命令。结合搜索结果，多个来源表明该漏洞已经存在可用的利用方法。

**投毒风险：**
分析 POC 代码，`post-checkout` 脚本的作用是将 `/etc/passwd` 的内容写入 `/poc` 文件。此行为本身是漏洞验证的一部分，旨在证明可以在容器外部执行代码。代码本身不包含任何恶意或隐藏的后门，可以判定投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 Git 仓库，仓库的 `hooks/post-checkout` 目录下包含恶意脚本。
2.  攻击者创建一个 Pod，并在 Pod 的 volume 中声明使用 gitRepo 卷，指向上述恶意 Git 仓库。
3.  Kubelet 会拉取恶意 Git 仓库。
4.  在拉取仓库的过程中，Git 会执行 `post-checkout` 钩子脚本。
5.  `post-checkout` 脚本在宿主机上执行任意命令，从而实现任意命令执行。

通过这种方式，攻击者可以绕过容器隔离，在宿主机上执行任意命令，从而完全控制节点。

**项目地址:** [any2sec/cve-2024-10220](https://github.com/any2sec/cve-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #3

**来源**: [CVE-2024-10220-candranapits_poc-CVE-2024-10220.md](../2024/CVE-2024-10220-candranapits_poc-CVE-2024-10220.md)

## CVE-2024-10220

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** kubelet

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 需要能够创建包含恶意gitRepo卷的Pod

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo 卷执行任意命令。

**漏洞利用方式：**
攻击者可以创建一个包含 gitRepo 卷的 Pod，并在该卷的初始化过程中执行恶意代码。利用的关键在于 gitRepo 卷会执行 `.git/hooks/post-checkout` 脚本。

**POC 分析：**
POC 代码包含两个文件：
1.  `README.md`:  提供 POC 的基本信息。
2.  `hooks/post-checkout`:  这是一个 shell 脚本，会在 `git checkout` 操作后执行。该脚本将 `id` 命令的输出写入 `/tmp/poc` 文件。

**有效性：**
该 POC 代码是有效的，只要 kubelet 的版本在受影响的范围内，并且攻击者能够创建包含恶意 gitRepo 卷的 Pod，就能成功执行任意命令。

**投毒风险：**
提供的 POC 代码非常简单，仅仅执行 `id` 命令并将输出写入文件，没有发现任何隐藏的恶意代码。因此，投毒风险为 0%。

**总结：**
攻击者创建一个包含gitRepo卷的pod，并指定一个包含恶意`.git/hooks/post-checkout`脚本的Git仓库，当kubelet拉取代码时，会执行此脚本，从而造成任意命令执行。

**项目地址:** [candranapits/poc-CVE-2024-10220](https://github.com/candranapits/poc-CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #4

**来源**: [CVE-2024-10220-filipzag_CVE-2024-10220.md](../2024/CVE-2024-10220-filipzag_CVE-2024-10220.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，允许攻击者在主机节点上执行任意命令，可能导致集群完全受控。

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod以及使用gitRepo volume的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo volume 执行任意命令。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞允许攻击者在受影响的 Kubernetes 集群中的节点上执行任意命令。提供的 POC 代码展示了一个利用此漏洞的简单示例，该示例创建一个包含恶意 hook 的 git 仓库。当 kubelet 拉取该仓库时，恶意 hook 会被执行，从而在节点上创建 `/tmp/cve-2024-10220` 文件，内容为 "You have been pwned!"。由于 POC 代码能够成功触发命令执行，因此可以认为该 POC 是有效的。

**投毒风险：**

分析提供的 POC 代码，`/tmp/ed40431b94c4f7558e5bd729b365fbc6/hooks/post-checkout` 脚本仅仅是简单的写入文件。没有发现任何隐藏的，具有破坏性或恶意行为的代码。因此，POC 代码本身不包含投毒行为，投毒风险为 0%。当然，实际攻击中，攻击者可能会在 `post-checkout` 脚本中添加更具危害性的代码。

**利用方式：**

1.  攻击者创建一个包含恶意 Git hooks 的 Git 仓库，例如 `post-checkout`。
2.  攻击者创建一个 Kubernetes Pod，该 Pod 使用 `gitRepo` volume 指向包含恶意 Git hooks 的 Git 仓库。
3.  当 kubelet 在节点上拉取（`git clone`）该仓库时，Git hooks 会被自动执行，从而在节点上执行攻击者预定义的任意命令。
4.  由于 kubelet 通常以 root 权限运行，因此攻击者可以在节点上以 root 权限执行命令，从而完全控制节点。

**缓解措施：**

*   升级 kubelet 到不受影响的版本（>= 1.28.12, >= 1.29.7, >= 1.30.3, 1.31.0）
*   限制用户创建具有 gitRepo volume 的 Pod 的权限。

**项目地址:** [filipzag/CVE-2024-10220](https://github.com/filipzag/CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #5

**来源**: [CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md](../2024/CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md)

## CVE-2024-10220-Kubelet-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点接管

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 漏洞允许攻击者通过恶意构造的 gitRepo volume 在 Kubernetes kubelet 组件上执行任意命令。攻击者需要具有创建 pod 和关联 gitRepo volume 的权限。漏洞利用方式如下：

1.  **漏洞原理：** kubelet 在使用 gitRepo volume 时，会执行 git clone 操作。攻击者可以通过在 git 仓库的 hooks 目录中放置恶意脚本，例如 `post-checkout` 脚本，来实现命令执行。
2.  **POC 代码分析：** 提供的 POC 代码包含以下文件：
    *   `HEAD`, `README.md`, `config`, `logs/HEAD`, `logs/refs/heads/master`, `refs/heads/master`: 标准 Git 仓库文件。
    *   `hooks/post-checkout`:  这是一个 shell 脚本，会在 git checkout 后执行。该脚本的内容是将 "Hello from container" 写入 `/tmp/CVE-2024-10220-OUTPUT` 文件。这表明当 kubelet 克隆包含此 hook 的仓库时，将在 kubelet 运行的节点上执行该命令。
    *   `manifest/gitrepo.yaml`:  这是一个 Kubernetes Pod 定义文件，其中定义了一个使用 gitRepo volume 的 Pod。`repository` 指向包含恶意 hook 的 Git 仓库，`revision` 指定了要检出的分支，`directory` 指定clone到容器的目录，此目录需要包含`.git`目录. 
3.  **利用流程：**
    *   攻击者创建一个包含恶意 `post-checkout` hook 的 Git 仓库。
    *   攻击者创建一个 Pod，并在 Pod 的 volume 中使用 gitRepo，指向攻击者创建的 Git 仓库。
    *   当 kubelet 创建 Pod 时，会克隆 Git 仓库。由于仓库中包含 `post-checkout` hook，kubelet 会执行该 hook 中的命令，从而在节点上执行任意代码。
4.  **有效性：** 根据漏洞描述和 POC 代码分析，可以判断该 POC 代码是有效的。它展示了如何通过 gitRepo volume 和恶意 hook 在 Kubernetes 节点上执行任意命令。
5. **投毒风险：** 仓库本身的文件内容没有明显的恶意行为。然而，`hooks/post-checkout` 的目的就是为了执行命令，虽然示例是写入文件，但可以修改为任何恶意操作。由于脚本本身就具有执行命令的能力，将其定义为投毒具有一定的主观性。但从利用的角度看，目前写入文件的行为是为了验证漏洞的存在，而不是为了投毒。作者后期可以修改为投毒脚本，存在潜在风险，暂且将其标记为10%的投毒风险.风险在于使用者不仔细检查脚本内容，直接应用到生产环境，存在潜在风险。

**项目地址:** [mochizuki875/CVE-2024-10220-githooks](https://github.com/mochizuki875/CVE-2024-10220-githooks)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #6

**来源**: [CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md](../2024/CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md)

## CVE-2024-10220-Kubernetes-gitRepo-Volume-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，允许低权限用户在主机节点上执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要能够创建Pod并指定gitRepo卷。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞允许攻击者通过特制的 gitRepo 卷在 Kubernetes kubelet 组件上执行任意命令。漏洞利用涉及创建一个包含恶意 .hooks 目录的 Git 仓库，当 kubelet 尝试拉取该仓库时，.hooks 目录中的恶意脚本会在主机节点上以 root 权限执行。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞描述明确指出通过 gitRepo 卷可以执行任意命令。搜索引擎结果中的多个链接证实了该漏洞的存在和高危性。提供的 Python POC 代码模拟了利用该漏洞的过程，通过向 kubelet 发送包含恶意 gitRepo 卷配置的 Pod 清单来实现。

**投毒风险：**
提供的代码主要包含 MIT 许可证、README.md 文件和一个 Python 脚本。该 Python 脚本旨在触发 CVE-2024-10220 漏洞，通过向 kubelet 发送精心构造的 Pod 清单，从而执行 Git 仓库中的恶意钩子脚本。检查了提供的 LICENSE、README.md 和 Python 脚本，未发现任何可疑的后门或恶意代码。代码的功能明确，旨在利用 CVE-2024-10220 漏洞。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者需要具有在受影响的 Kubernetes 集群中创建 Pod 的权限。
2.  攻击者创建一个包含恶意 Git 仓库，该仓库的 `.git/hooks` 目录包含要执行的恶意脚本。
3.  攻击者创建一个 Pod 清单，其中指定使用 `gitRepo` 卷，并指向恶意 Git 仓库。
4.  攻击者将 Pod 清单提交到 Kubernetes 集群。
5.  Kubelet 尝试拉取 Git 仓库时，会执行 `.git/hooks` 目录中的恶意脚本，从而在主机节点上执行任意命令。

**项目地址:** [mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability](https://github.com/mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #7

**来源**: [CVE-2024-10220-orgC_CVE-2024-10220-demo.md](../2024/CVE-2024-10220-orgC_CVE-2024-10220-demo.md)

## CVE-2024-10220-Kubelet-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo Volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 允许攻击者通过特制的gitRepo Volume在 Kubernetes kubelet 组件上执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞源于 kubelet 在处理 gitRepo Volume 时，没有充分限制路径，允许攻击者利用 Git 钩子执行恶意命令。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意 Git 仓库的 Pod。
    *   该仓库的 `.git/hooks` 目录下包含恶意脚本（例如 `post-checkout`, `pre-commit`等）。
    *   当 kubelet 克隆或更新该仓库时，Git 钩子会被触发，从而执行恶意脚本。
    *   由于 kubelet 通常以 root 权限运行，恶意脚本也会以 root 权限执行，从而控制节点。
3.  **POC分析：** 提供的POC代码 `/tmp/062232065a7902f899883e0db5641023/index.html` 内容为 "Malicious code"。这本身不是一个完整的 POC， 仅仅是一个指示Payload位置的文件。要成功利用此漏洞，需要一个包含恶意git hooks的Git仓库，然后通过Pod定义中的gitRepo volume引用该仓库。此文件可能存在投毒风险是因为：攻击者可以在 git 仓库中添加额外的后门或恶意功能，这些功能可能不会立即被发现，但会在后续被触发。 此文件index.html 可能只是一个诱饵。 因此投毒风险为10%。搜索引擎结果表明，该漏洞利用主要通过git hooks实现远程命令执行, 权限为Root.

**总结：** 漏洞利用的有效性取决于是否能创建一个包含恶意 Git 仓库的 Pod，以及是否能成功触发 Git 钩子。该漏洞风险极高，因为攻击者可以利用它完全控制受影响的 Kubernetes 节点。

**项目地址:** [orgC/CVE-2024-10220-demo](https://github.com/orgC/CVE-2024-10220-demo)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #8

**来源**: [CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md](../2024/CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，可导致节点被控制

**影响版本:** <=1.28.11, 1.29.0-1.29.6, 1.30.0-1.30.2

**利用条件:** 攻击者需要能够创建包含恶意gitRepo卷的Pod。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许通过精心设计的gitRepo卷在Kubernetes kubelet组件上执行任意命令。POC代码展示了一个恶意的git仓库，其`hooks/post-checkout`脚本包含`id > /tmp/poc`，这意味着每次检出代码时，都会将执行命令的用户ID写入`/tmp/poc`文件。当kubelet尝试从这个恶意git仓库拉取代码时，`post-checkout`钩子会被执行，从而实现任意命令执行。根据漏洞库信息，攻击者只需要拥有创建Pod的权限，且Pod的spec包含恶意的gitRepo 卷即可触发漏洞。由于提供的POC仅仅验证了命令执行，并没有发现其它恶意代码，因此投毒风险较低。

**项目地址:** [saleha-muzammil/cve-2024-10220-git-on-git](https://github.com/saleha-muzammil/cve-2024-10220-git-on-git)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---



---

## POC #2

**来源**: [CVE-2024-10220-any2sec_cve-2024-10220.md](../2024/CVE-2024-10220-any2sec_cve-2024-10220.md)

## CVE-2024-10220-Kubernetes-Kubelet任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 允许攻击者通过特制的 gitRepo 卷执行任意命令。漏洞存在于 Kubelet 组件中，利用方式是创建一个包含恶意配置的 Git 仓库，并在 Pod 中声明使用该仓库作为 gitRepo 卷。当 Kubelet 拉取该仓库时，会执行恶意配置中定义的命令。该漏洞的利用方式依赖于 Git 的钩子（hooks）机制，攻击者可以在仓库的 hooks 目录下放置恶意脚本，这些脚本会在 Git 操作（例如 checkout）期间被执行，从而绕过容器隔离，在宿主机上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞是有效的。漏洞利用代码展示了一个包含 `post-checkout` 钩子的 Git 仓库，该钩子脚本会将 `/etc/passwd` 的内容复制到 `/poc` 文件中。当 Kubelet 拉取这个仓库并执行 checkout 操作时，这个钩子脚本会被执行，从而在宿主机上执行了读取 `/etc/passwd` 的命令。结合搜索结果，多个来源表明该漏洞已经存在可用的利用方法。

**投毒风险：**
分析 POC 代码，`post-checkout` 脚本的作用是将 `/etc/passwd` 的内容写入 `/poc` 文件。此行为本身是漏洞验证的一部分，旨在证明可以在容器外部执行代码。代码本身不包含任何恶意或隐藏的后门，可以判定投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 Git 仓库，仓库的 `hooks/post-checkout` 目录下包含恶意脚本。
2.  攻击者创建一个 Pod，并在 Pod 的 volume 中声明使用 gitRepo 卷，指向上述恶意 Git 仓库。
3.  Kubelet 会拉取恶意 Git 仓库。
4.  在拉取仓库的过程中，Git 会执行 `post-checkout` 钩子脚本。
5.  `post-checkout` 脚本在宿主机上执行任意命令，从而实现任意命令执行。

通过这种方式，攻击者可以绕过容器隔离，在宿主机上执行任意命令，从而完全控制节点。

**项目地址:** [any2sec/cve-2024-10220](https://github.com/any2sec/cve-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #3

**来源**: [CVE-2024-10220-candranapits_poc-CVE-2024-10220.md](../2024/CVE-2024-10220-candranapits_poc-CVE-2024-10220.md)

## CVE-2024-10220

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** kubelet

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 需要能够创建包含恶意gitRepo卷的Pod

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo 卷执行任意命令。

**漏洞利用方式：**
攻击者可以创建一个包含 gitRepo 卷的 Pod，并在该卷的初始化过程中执行恶意代码。利用的关键在于 gitRepo 卷会执行 `.git/hooks/post-checkout` 脚本。

**POC 分析：**
POC 代码包含两个文件：
1.  `README.md`:  提供 POC 的基本信息。
2.  `hooks/post-checkout`:  这是一个 shell 脚本，会在 `git checkout` 操作后执行。该脚本将 `id` 命令的输出写入 `/tmp/poc` 文件。

**有效性：**
该 POC 代码是有效的，只要 kubelet 的版本在受影响的范围内，并且攻击者能够创建包含恶意 gitRepo 卷的 Pod，就能成功执行任意命令。

**投毒风险：**
提供的 POC 代码非常简单，仅仅执行 `id` 命令并将输出写入文件，没有发现任何隐藏的恶意代码。因此，投毒风险为 0%。

**总结：**
攻击者创建一个包含gitRepo卷的pod，并指定一个包含恶意`.git/hooks/post-checkout`脚本的Git仓库，当kubelet拉取代码时，会执行此脚本，从而造成任意命令执行。

**项目地址:** [candranapits/poc-CVE-2024-10220](https://github.com/candranapits/poc-CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #4

**来源**: [CVE-2024-10220-filipzag_CVE-2024-10220.md](../2024/CVE-2024-10220-filipzag_CVE-2024-10220.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，允许攻击者在主机节点上执行任意命令，可能导致集群完全受控。

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod以及使用gitRepo volume的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo volume 执行任意命令。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞允许攻击者在受影响的 Kubernetes 集群中的节点上执行任意命令。提供的 POC 代码展示了一个利用此漏洞的简单示例，该示例创建一个包含恶意 hook 的 git 仓库。当 kubelet 拉取该仓库时，恶意 hook 会被执行，从而在节点上创建 `/tmp/cve-2024-10220` 文件，内容为 "You have been pwned!"。由于 POC 代码能够成功触发命令执行，因此可以认为该 POC 是有效的。

**投毒风险：**

分析提供的 POC 代码，`/tmp/ed40431b94c4f7558e5bd729b365fbc6/hooks/post-checkout` 脚本仅仅是简单的写入文件。没有发现任何隐藏的，具有破坏性或恶意行为的代码。因此，POC 代码本身不包含投毒行为，投毒风险为 0%。当然，实际攻击中，攻击者可能会在 `post-checkout` 脚本中添加更具危害性的代码。

**利用方式：**

1.  攻击者创建一个包含恶意 Git hooks 的 Git 仓库，例如 `post-checkout`。
2.  攻击者创建一个 Kubernetes Pod，该 Pod 使用 `gitRepo` volume 指向包含恶意 Git hooks 的 Git 仓库。
3.  当 kubelet 在节点上拉取（`git clone`）该仓库时，Git hooks 会被自动执行，从而在节点上执行攻击者预定义的任意命令。
4.  由于 kubelet 通常以 root 权限运行，因此攻击者可以在节点上以 root 权限执行命令，从而完全控制节点。

**缓解措施：**

*   升级 kubelet 到不受影响的版本（>= 1.28.12, >= 1.29.7, >= 1.30.3, 1.31.0）
*   限制用户创建具有 gitRepo volume 的 Pod 的权限。

**项目地址:** [filipzag/CVE-2024-10220](https://github.com/filipzag/CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #5

**来源**: [CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md](../2024/CVE-2024-10220-mochizuki875_CVE-2024-10220-githooks.md)

## CVE-2024-10220-Kubelet-命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点接管

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 漏洞允许攻击者通过恶意构造的 gitRepo volume 在 Kubernetes kubelet 组件上执行任意命令。攻击者需要具有创建 pod 和关联 gitRepo volume 的权限。漏洞利用方式如下：

1.  **漏洞原理：** kubelet 在使用 gitRepo volume 时，会执行 git clone 操作。攻击者可以通过在 git 仓库的 hooks 目录中放置恶意脚本，例如 `post-checkout` 脚本，来实现命令执行。
2.  **POC 代码分析：** 提供的 POC 代码包含以下文件：
    *   `HEAD`, `README.md`, `config`, `logs/HEAD`, `logs/refs/heads/master`, `refs/heads/master`: 标准 Git 仓库文件。
    *   `hooks/post-checkout`:  这是一个 shell 脚本，会在 git checkout 后执行。该脚本的内容是将 "Hello from container" 写入 `/tmp/CVE-2024-10220-OUTPUT` 文件。这表明当 kubelet 克隆包含此 hook 的仓库时，将在 kubelet 运行的节点上执行该命令。
    *   `manifest/gitrepo.yaml`:  这是一个 Kubernetes Pod 定义文件，其中定义了一个使用 gitRepo volume 的 Pod。`repository` 指向包含恶意 hook 的 Git 仓库，`revision` 指定了要检出的分支，`directory` 指定clone到容器的目录，此目录需要包含`.git`目录. 
3.  **利用流程：**
    *   攻击者创建一个包含恶意 `post-checkout` hook 的 Git 仓库。
    *   攻击者创建一个 Pod，并在 Pod 的 volume 中使用 gitRepo，指向攻击者创建的 Git 仓库。
    *   当 kubelet 创建 Pod 时，会克隆 Git 仓库。由于仓库中包含 `post-checkout` hook，kubelet 会执行该 hook 中的命令，从而在节点上执行任意代码。
4.  **有效性：** 根据漏洞描述和 POC 代码分析，可以判断该 POC 代码是有效的。它展示了如何通过 gitRepo volume 和恶意 hook 在 Kubernetes 节点上执行任意命令。
5. **投毒风险：** 仓库本身的文件内容没有明显的恶意行为。然而，`hooks/post-checkout` 的目的就是为了执行命令，虽然示例是写入文件，但可以修改为任何恶意操作。由于脚本本身就具有执行命令的能力，将其定义为投毒具有一定的主观性。但从利用的角度看，目前写入文件的行为是为了验证漏洞的存在，而不是为了投毒。作者后期可以修改为投毒脚本，存在潜在风险，暂且将其标记为10%的投毒风险.风险在于使用者不仔细检查脚本内容，直接应用到生产环境，存在潜在风险。

**项目地址:** [mochizuki875/CVE-2024-10220-githooks](https://github.com/mochizuki875/CVE-2024-10220-githooks)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #6

**来源**: [CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md](../2024/CVE-2024-10220-mrk336_CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability.md)

## CVE-2024-10220-Kubernetes-gitRepo-Volume-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，允许低权限用户在主机节点上执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要能够创建Pod并指定gitRepo卷。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞允许攻击者通过特制的 gitRepo 卷在 Kubernetes kubelet 组件上执行任意命令。漏洞利用涉及创建一个包含恶意 .hooks 目录的 Git 仓库，当 kubelet 尝试拉取该仓库时，.hooks 目录中的恶意脚本会在主机节点上以 root 权限执行。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞描述明确指出通过 gitRepo 卷可以执行任意命令。搜索引擎结果中的多个链接证实了该漏洞的存在和高危性。提供的 Python POC 代码模拟了利用该漏洞的过程，通过向 kubelet 发送包含恶意 gitRepo 卷配置的 Pod 清单来实现。

**投毒风险：**
提供的代码主要包含 MIT 许可证、README.md 文件和一个 Python 脚本。该 Python 脚本旨在触发 CVE-2024-10220 漏洞，通过向 kubelet 发送精心构造的 Pod 清单，从而执行 Git 仓库中的恶意钩子脚本。检查了提供的 LICENSE、README.md 和 Python 脚本，未发现任何可疑的后门或恶意代码。代码的功能明确，旨在利用 CVE-2024-10220 漏洞。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者需要具有在受影响的 Kubernetes 集群中创建 Pod 的权限。
2.  攻击者创建一个包含恶意 Git 仓库，该仓库的 `.git/hooks` 目录包含要执行的恶意脚本。
3.  攻击者创建一个 Pod 清单，其中指定使用 `gitRepo` 卷，并指向恶意 Git 仓库。
4.  攻击者将 Pod 清单提交到 Kubernetes 集群。
5.  Kubelet 尝试拉取 Git 仓库时，会执行 `.git/hooks` 目录中的恶意脚本，从而在主机节点上执行任意命令。

**项目地址:** [mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability](https://github.com/mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #7

**来源**: [CVE-2024-10220-orgC_CVE-2024-10220-demo.md](../2024/CVE-2024-10220-orgC_CVE-2024-10220-demo.md)

## CVE-2024-10220-Kubelet-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubelet

**危害等级:** 高危，可能导致节点被完全控制

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要具有创建Pod和关联gitRepo Volume的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10220 允许攻击者通过特制的gitRepo Volume在 Kubernetes kubelet 组件上执行任意命令。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞源于 kubelet 在处理 gitRepo Volume 时，没有充分限制路径，允许攻击者利用 Git 钩子执行恶意命令。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意 Git 仓库的 Pod。
    *   该仓库的 `.git/hooks` 目录下包含恶意脚本（例如 `post-checkout`, `pre-commit`等）。
    *   当 kubelet 克隆或更新该仓库时，Git 钩子会被触发，从而执行恶意脚本。
    *   由于 kubelet 通常以 root 权限运行，恶意脚本也会以 root 权限执行，从而控制节点。
3.  **POC分析：** 提供的POC代码 `/tmp/062232065a7902f899883e0db5641023/index.html` 内容为 "Malicious code"。这本身不是一个完整的 POC， 仅仅是一个指示Payload位置的文件。要成功利用此漏洞，需要一个包含恶意git hooks的Git仓库，然后通过Pod定义中的gitRepo volume引用该仓库。此文件可能存在投毒风险是因为：攻击者可以在 git 仓库中添加额外的后门或恶意功能，这些功能可能不会立即被发现，但会在后续被触发。 此文件index.html 可能只是一个诱饵。 因此投毒风险为10%。搜索引擎结果表明，该漏洞利用主要通过git hooks实现远程命令执行, 权限为Root.

**总结：** 漏洞利用的有效性取决于是否能创建一个包含恶意 Git 仓库的 Pod，以及是否能成功触发 Git 钩子。该漏洞风险极高，因为攻击者可以利用它完全控制受影响的 Kubernetes 节点。

**项目地址:** [orgC/CVE-2024-10220-demo](https://github.com/orgC/CVE-2024-10220-demo)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

## POC #8

**来源**: [CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md](../2024/CVE-2024-10220-saleha-muzammil_cve-2024-10220-git-on-git.md)

## CVE-2024-10220-Kubernetes-kubelet-gitRepo命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 命令执行

**影响应用:** Kubernetes kubelet

**危害等级:** 高危，可导致节点被控制

**影响版本:** <=1.28.11, 1.29.0-1.29.6, 1.30.0-1.30.2

**利用条件:** 攻击者需要能够创建包含恶意gitRepo卷的Pod。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许通过精心设计的gitRepo卷在Kubernetes kubelet组件上执行任意命令。POC代码展示了一个恶意的git仓库，其`hooks/post-checkout`脚本包含`id > /tmp/poc`，这意味着每次检出代码时，都会将执行命令的用户ID写入`/tmp/poc`文件。当kubelet尝试从这个恶意git仓库拉取代码时，`post-checkout`钩子会被执行，从而实现任意命令执行。根据漏洞库信息，攻击者只需要拥有创建Pod的权限，且Pod的spec包含恶意的gitRepo 卷即可触发漏洞。由于提供的POC仅仅验证了命令执行，并没有发现其它恶意代码，因此投毒风险较低。

**项目地址:** [saleha-muzammil/cve-2024-10220-git-on-git](https://github.com/saleha-muzammil/cve-2024-10220-git-on-git)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)

---

