## CVE-2024-3094 - XZ Utils (liblzma) 供应链攻击/后门 (Supply Chain Attack/Backdoor)

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门 (Supply Chain Attack/Backdoor)

**影响应用:** XZ Utils (liblzma)

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需安装受污染的xz-utils版本，且通常需要sshd服务链接到liblzma库，攻击者需持有特定的Ed448私钥进行远程触发。

**POC 可用性:** 9/10

**POC 类型:** 概念验证/检测脚本

**攻击复杂度:** 高

**投毒风险:** 5%

## 详情

POC有效性分析：本研究所分析的POC代码并非用于漏洞利用，而是由JFrog提供的安全检测工具。该脚本（cve-2024-3094-detector.sh）逻辑严密且高度有效。它通过两个核心维度进行验证：首先是静态检查xz和liblzma库的版本及特征字符串，识别是否存在被植入的恶意字节码（通常涉及特定的混淆脚本在编译阶段注入）；其次是动态检查系统环境，特别是sshd二进制文件是否链接到liblzma，这是后门激活的关键预设条件。该工具能准确告知运维人员系统是否处于风险中，具有极高的实战参考价值。利用步骤分析：该漏洞本身的利用极其复杂，属于国家级APT水平的供应链投毒。攻击者通过在XZ源码仓库中潜伏数年获得维护者权限，随后在5.6.0和5.6.1版本的发布包中，通过一系列复杂的M4宏定义和混淆的测试数据文件，在编译过程中将恶意代码注入liblzma。当sshd调用liblzma进行解压操作时，恶意代码会拦截RSA解密函数，验证攻击者发送的特定签名数据包。若匹配成功，则执行攻击者提供的指令，实现无需密码的远程代码执行。整个过程不产生系统日志，极难被传统的IDS/IPS发现。投毒风险分析：该POC代码库本身展现出极高的安全性。通过对其Bash脚本源码的审查，可以确认其行为仅限于系统信息的只读查询。脚本使用strings工具检索二进制文件中的特定模式，不涉及任何外部网络请求、权限提升或文件改写操作。代码注释清晰，逻辑透明，完全符合安全社区的防御性研究标准。唯一需要注意的是，脚本依赖binutils工具包，建议在受控环境安装相关依赖。该仓库没有包含任何混淆或加密的二进制载荷，不存在针对研究员系统的二次投毒风险。对于此类重大供应链漏洞，使用知名安全厂商（如JFrog）披露的检测脚本是建立组织防御的第一步，风险处于极低水平（5%以下）。

**项目地址:** [https://github.com/jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
