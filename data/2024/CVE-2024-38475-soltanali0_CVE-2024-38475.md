# CVE-2024-38475

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-38475-abrewer251_CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC.md](../2024/CVE-2024-38475-abrewer251_CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC.md)

## CVE-2024-38475_SonicBoom_Apache_URL_Traversal

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** URL è·¯å¾„éå†

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºä»£ç æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** mod_rewrite æ¨¡å—å¯ç”¨ä¸”å­˜åœ¨ä¸å®‰å…¨çš„ RewriteRules é…ç½®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-38475 æ˜¯ Apache HTTP Server ä¸­ mod_rewrite æ¨¡å—çš„ä¸€ä¸ª URL è·¯å¾„éå†æ¼æ´ã€‚ä¸æ­£ç¡®çš„è¾“å‡ºè½¬ä¹‰å…è®¸æ”»å‡»è€…å°† URL æ˜ å°„åˆ°æœåŠ¡å™¨å…è®¸æä¾›çš„æ–‡ä»¶ç³»ç»Ÿä½ç½®ï¼Œä½†è¿™äº›ä½ç½®å¹¶éæœ‰æ„æˆ–ç›´æ¥é€šè¿‡ä»»ä½• URL è®¿é—®ã€‚æ¶‰åŠæœåŠ¡å™¨ä¸Šä¸‹æ–‡ä¸­å°†åå‘å¼•ç”¨æˆ–å˜é‡ç”¨ä½œæ›¿æ¢çš„ç¬¬ä¸€ä¸ªæ®µçš„æ›¿æ¢å—åˆ°å½±å“ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œä¾‹å¦‚åœ¨SonicWall SMA è®¾å¤‡çš„æ¼æ´åˆ©ç”¨é“¾ä¸­ã€‚æä¾›çš„ PoC ä»£ç  (CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC) é€šè¿‡è‡ªåŠ¨åŒ– TLS åå•†ã€ç›®å½•æ‰«æã€éå†éªŒè¯å’Œæœ‰æ•ˆè½½è·æ¨¡ç³Šæµ‹è¯•æ¥æ£€æµ‹æœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€‚å®ƒé¦–å…ˆç¡®å®šæœåŠ¡å™¨æ”¯æŒçš„æœ€é«˜ TLS/SSL åè®®ï¼Œç„¶åéªŒè¯ç›®å½•éå†è¡Œä¸ºï¼Œæ‰«æå— 403 ä¿æŠ¤çš„ç›®å½•ï¼Œç¡®è®¤æ¯ä¸ªç›®å½•çš„éå†æ¼æ´ï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰æœ‰æ•ˆè½½è·æ¨¡ç³ŠåŒ–æ–‡ä»¶è·¯å¾„ä»¥æ£€æµ‹å®é™…æ³„æ¼ã€‚autoCurl.py è¾…åŠ©è„šæœ¬æ£€æµ‹ç›®æ ‡æ˜¯å¦å…è®¸PUTæ–¹æ³•ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦å­˜åœ¨äºä»»ä½•æ¥è‡ªå¤–éƒ¨æºçš„ä»£ç ä¸­ï¼Œä¾‹å¦‚æ¶æ„ç›®å½•/æ–‡ä»¶æ–‡å­—è¡¨å¯èƒ½ä¼šè¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯æ€»ä½“æ¯”ä¾‹å¾ˆå°ã€‚è€ƒè™‘åˆ°æ ·æœ¬æ–‡ä»¶LICENSEå£°æ˜äº†MITå¼€æºåè®®ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§æä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ `%2e%2e/` æˆ– `%2e%2e%5C`ï¼‰çš„æ¶æ„ URLï¼Œåˆ©ç”¨ mod_rewrite æ¨¡å—ä¸­ä¸æ­£ç¡®çš„è½¬ä¹‰ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚
2.  **è·¯å¾„éå†:** æ¶æ„ URL ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œå°† URL æ˜ å°„åˆ°æœåŠ¡å™¨æ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ç³»ç»Ÿä½ç½®ã€‚
3.  **ä¿¡æ¯æ³„éœ²/ä»£ç æ‰§è¡Œ:** å¦‚æœæˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚æºä»£ç ã€é…ç½®æ–‡ä»¶ï¼‰æˆ–æ‰§è¡ŒæœåŠ¡å™¨ä¸Šçš„æ¶æ„ä»£ç ã€‚

**ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„ URLï¼Œç»•è¿‡æœåŠ¡å™¨çš„å®‰å…¨æ£€æŸ¥ï¼Œè¯»å–æˆ–æ‰§è¡Œå—ä¿æŠ¤çš„èµ„æºã€‚**

**é¡¹ç›®åœ°å€:** [abrewer251/CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC](https://github.com/abrewer251/CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---

## POC #2

**æ¥æº**: [CVE-2024-38475-p0in7s_CVE-2024-38475.md](../2024/CVE-2024-38475-p0in7s_CVE-2024-38475.md)

## CVE-2024-38475-Apache HTTP Server-mod_rewriteä¸å½“è½¬ä¹‰

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** ä»£ç æ‰§è¡Œ/æºç æ³„éœ²

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œå’Œæºç æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å¯mod_rewriteæ¨¡å—ä¸”å­˜åœ¨ä¸å®‰å…¨çš„RewriteRuleé…ç½®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-38475æ˜¯Apache HTTP Server 2.4.59åŠæ›´æ—©ç‰ˆæœ¬ä¸­mod_rewriteæ¨¡å—å­˜åœ¨çš„ä¸€ä¸ªä¸å½“è½¬ä¹‰æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´å°†URLæ˜ å°„åˆ°æ–‡ä»¶ç³»ç»Ÿä½ç½®ï¼Œè¿™äº›ä½ç½®å¯ä»¥ç”±æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œä½†å¹¶éæœ‰æ„æˆ–ç›´æ¥é€šè¿‡ä»»ä½•URLè®¿é—®ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºä»£ç æ³„éœ²ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´æ¥æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆæ‰«æå¸¸è§çš„ç›®å½•ï¼Œç„¶åç»“åˆwebrootå’Œæ–‡ä»¶å­—å…¸ï¼Œæ„é€ åŒ…å«payloadçš„URLï¼Œå‘é€è¯·æ±‚å¹¶æ£€æŸ¥HTTPå“åº”ä»£ç ã€‚å¦‚æœè¿”å›200ï¼Œåˆ™è¡¨ç¤ºæ‰¾åˆ°äº†æ–‡ä»¶ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯å…³äºSonicWallåˆ©ç”¨æ­¤æ¼æ´çš„ä¿¡æ¯ï¼‰å’ŒPOCä»£ç æ¥çœ‹ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®é™…åˆ©ç”¨çš„æˆåŠŸç‡å–å†³äºç›®æ ‡æœåŠ¡å™¨çš„mod_rewriteé…ç½®ã€æ–‡ä»¶ç³»ç»Ÿç»“æ„å’Œwebrooté…ç½®ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„POCä»£ç ã€READMEå’Œå­—å…¸æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ã€‚å­—å…¸æ–‡ä»¶åŒ…å«å¸¸è§çš„ç›®å½•å’Œæ–‡ä»¶åï¼Œç”¨äºæ¢æµ‹æ½œåœ¨çš„æ•æ„Ÿæ–‡ä»¶ã€‚ä½œè€…å£°æ˜æ‰€æœ‰åŠŸåŠ³å½’äºæ¼æ´å‘ç°è€…Orange Tsaiï¼Œè¿›ä¸€æ­¥é™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¼€å¯äº†mod_rewriteæ¨¡å—ã€‚**
2.  **è¯†åˆ«å­˜åœ¨æ¼æ´çš„RewriteRuleé…ç½®ã€‚** æ¼æ´å­˜åœ¨äºæœåŠ¡å™¨ä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨åå‘å¼•ç”¨æˆ–å˜é‡ä½œä¸ºæ›¿æ¢çš„ç¬¬ä¸€ä¸ªæ®µã€‚
3.  **ä¿®æ”¹POCè„šæœ¬ä¸­çš„`webroot`ã€`url_ip_domain`å’Œ`schema`å˜é‡ï¼Œä½¿å…¶ä¸ç›®æ ‡æœåŠ¡å™¨åŒ¹é…ã€‚**
4.  **è¿è¡ŒPOCè„šæœ¬ï¼Œå®ƒå°†å°è¯•é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLæ¥è®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚** æ”»å‡»è€…å¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´`directory_wordlist`ã€`file_wordlist`ç­‰å‚æ•°ä»¥æé«˜æ•ˆç‡
5.  **å¦‚æœæˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤æ–‡ä»¶çš„å†…å®¹æˆ–æ‰§è¡Œæ¶æ„ä»£ç ï¼ˆå¦‚æœæœåŠ¡å™¨é…ç½®å…è®¸ï¼‰ã€‚** ä¾‹å¦‚ï¼Œå¦‚æœ`index.php`æ–‡ä»¶è¢«æˆåŠŸè®¿é—®ï¼Œå…¶æºä»£ç å°†è¢«æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [p0in7s/CVE-2024-38475](https://github.com/p0in7s/CVE-2024-38475)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---

## POC #3

**æ¥æº**: [CVE-2024-38475-soltanali0_CVE-2024-38475.md](../2024/CVE-2024-38475-soltanali0_CVE-2024-38475.md)

# CVE-2024-38475

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-38475-abrewer251_CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC.md](../2024/CVE-2024-38475-abrewer251_CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC.md)

## CVE-2024-38475_SonicBoom_Apache_URL_Traversal

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** URL è·¯å¾„éå†

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºä»£ç æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** mod_rewrite æ¨¡å—å¯ç”¨ä¸”å­˜åœ¨ä¸å®‰å…¨çš„ RewriteRules é…ç½®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-38475 æ˜¯ Apache HTTP Server ä¸­ mod_rewrite æ¨¡å—çš„ä¸€ä¸ª URL è·¯å¾„éå†æ¼æ´ã€‚ä¸æ­£ç¡®çš„è¾“å‡ºè½¬ä¹‰å…è®¸æ”»å‡»è€…å°† URL æ˜ å°„åˆ°æœåŠ¡å™¨å…è®¸æä¾›çš„æ–‡ä»¶ç³»ç»Ÿä½ç½®ï¼Œä½†è¿™äº›ä½ç½®å¹¶éæœ‰æ„æˆ–ç›´æ¥é€šè¿‡ä»»ä½• URL è®¿é—®ã€‚æ¶‰åŠæœåŠ¡å™¨ä¸Šä¸‹æ–‡ä¸­å°†åå‘å¼•ç”¨æˆ–å˜é‡ç”¨ä½œæ›¿æ¢çš„ç¬¬ä¸€ä¸ªæ®µçš„æ›¿æ¢å—åˆ°å½±å“ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œä¾‹å¦‚åœ¨SonicWall SMA è®¾å¤‡çš„æ¼æ´åˆ©ç”¨é“¾ä¸­ã€‚æä¾›çš„ PoC ä»£ç  (CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC) é€šè¿‡è‡ªåŠ¨åŒ– TLS åå•†ã€ç›®å½•æ‰«æã€éå†éªŒè¯å’Œæœ‰æ•ˆè½½è·æ¨¡ç³Šæµ‹è¯•æ¥æ£€æµ‹æœªç»æˆæƒçš„æ–‡ä»¶è®¿é—®ã€‚å®ƒé¦–å…ˆç¡®å®šæœåŠ¡å™¨æ”¯æŒçš„æœ€é«˜ TLS/SSL åè®®ï¼Œç„¶åéªŒè¯ç›®å½•éå†è¡Œä¸ºï¼Œæ‰«æå— 403 ä¿æŠ¤çš„ç›®å½•ï¼Œç¡®è®¤æ¯ä¸ªç›®å½•çš„éå†æ¼æ´ï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰æœ‰æ•ˆè½½è·æ¨¡ç³ŠåŒ–æ–‡ä»¶è·¯å¾„ä»¥æ£€æµ‹å®é™…æ³„æ¼ã€‚autoCurl.py è¾…åŠ©è„šæœ¬æ£€æµ‹ç›®æ ‡æ˜¯å¦å…è®¸PUTæ–¹æ³•ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦å­˜åœ¨äºä»»ä½•æ¥è‡ªå¤–éƒ¨æºçš„ä»£ç ä¸­ï¼Œä¾‹å¦‚æ¶æ„ç›®å½•/æ–‡ä»¶æ–‡å­—è¡¨å¯èƒ½ä¼šè¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯æ€»ä½“æ¯”ä¾‹å¾ˆå°ã€‚è€ƒè™‘åˆ°æ ·æœ¬æ–‡ä»¶LICENSEå£°æ˜äº†MITå¼€æºåè®®ï¼Œå­˜åœ¨æŠ•æ¯’çš„å¯èƒ½æ€§æä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ¼æ´è§¦å‘:** æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ `%2e%2e/` æˆ– `%2e%2e%5C`ï¼‰çš„æ¶æ„ URLï¼Œåˆ©ç”¨ mod_rewrite æ¨¡å—ä¸­ä¸æ­£ç¡®çš„è½¬ä¹‰ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚
2.  **è·¯å¾„éå†:** æ¶æ„ URL ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œå°† URL æ˜ å°„åˆ°æœåŠ¡å™¨æ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ç³»ç»Ÿä½ç½®ã€‚
3.  **ä¿¡æ¯æ³„éœ²/ä»£ç æ‰§è¡Œ:** å¦‚æœæˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–æ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚æºä»£ç ã€é…ç½®æ–‡ä»¶ï¼‰æˆ–æ‰§è¡ŒæœåŠ¡å™¨ä¸Šçš„æ¶æ„ä»£ç ã€‚

**ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„ URLï¼Œç»•è¿‡æœåŠ¡å™¨çš„å®‰å…¨æ£€æŸ¥ï¼Œè¯»å–æˆ–æ‰§è¡Œå—ä¿æŠ¤çš„èµ„æºã€‚**

**é¡¹ç›®åœ°å€:** [abrewer251/CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC](https://github.com/abrewer251/CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---

## POC #2

**æ¥æº**: [CVE-2024-38475-p0in7s_CVE-2024-38475.md](../2024/CVE-2024-38475-p0in7s_CVE-2024-38475.md)

## CVE-2024-38475-Apache HTTP Server-mod_rewriteä¸å½“è½¬ä¹‰

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** ä»£ç æ‰§è¡Œ/æºç æ³„éœ²

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œå’Œæºç æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å¼€å¯mod_rewriteæ¨¡å—ä¸”å­˜åœ¨ä¸å®‰å…¨çš„RewriteRuleé…ç½®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-38475æ˜¯Apache HTTP Server 2.4.59åŠæ›´æ—©ç‰ˆæœ¬ä¸­mod_rewriteæ¨¡å—å­˜åœ¨çš„ä¸€ä¸ªä¸å½“è½¬ä¹‰æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´å°†URLæ˜ å°„åˆ°æ–‡ä»¶ç³»ç»Ÿä½ç½®ï¼Œè¿™äº›ä½ç½®å¯ä»¥ç”±æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œä½†å¹¶éæœ‰æ„æˆ–ç›´æ¥é€šè¿‡ä»»ä½•URLè®¿é—®ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºä»£ç æ³„éœ²ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´æ¥æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ã€‚è„šæœ¬é¦–å…ˆæ‰«æå¸¸è§çš„ç›®å½•ï¼Œç„¶åç»“åˆwebrootå’Œæ–‡ä»¶å­—å…¸ï¼Œæ„é€ åŒ…å«payloadçš„URLï¼Œå‘é€è¯·æ±‚å¹¶æ£€æŸ¥HTTPå“åº”ä»£ç ã€‚å¦‚æœè¿”å›200ï¼Œåˆ™è¡¨ç¤ºæ‰¾åˆ°äº†æ–‡ä»¶ã€‚

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœï¼ˆç‰¹åˆ«æ˜¯å…³äºSonicWallåˆ©ç”¨æ­¤æ¼æ´çš„ä¿¡æ¯ï¼‰å’ŒPOCä»£ç æ¥çœ‹ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®é™…åˆ©ç”¨çš„æˆåŠŸç‡å–å†³äºç›®æ ‡æœåŠ¡å™¨çš„mod_rewriteé…ç½®ã€æ–‡ä»¶ç³»ç»Ÿç»“æ„å’Œwebrooté…ç½®ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„POCä»£ç ã€READMEå’Œå­—å…¸æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”ã€‚å­—å…¸æ–‡ä»¶åŒ…å«å¸¸è§çš„ç›®å½•å’Œæ–‡ä»¶åï¼Œç”¨äºæ¢æµ‹æ½œåœ¨çš„æ•æ„Ÿæ–‡ä»¶ã€‚ä½œè€…å£°æ˜æ‰€æœ‰åŠŸåŠ³å½’äºæ¼æ´å‘ç°è€…Orange Tsaiï¼Œè¿›ä¸€æ­¥é™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚

å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å¼€å¯äº†mod_rewriteæ¨¡å—ã€‚**
2.  **è¯†åˆ«å­˜åœ¨æ¼æ´çš„RewriteRuleé…ç½®ã€‚** æ¼æ´å­˜åœ¨äºæœåŠ¡å™¨ä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨åå‘å¼•ç”¨æˆ–å˜é‡ä½œä¸ºæ›¿æ¢çš„ç¬¬ä¸€ä¸ªæ®µã€‚
3.  **ä¿®æ”¹POCè„šæœ¬ä¸­çš„`webroot`ã€`url_ip_domain`å’Œ`schema`å˜é‡ï¼Œä½¿å…¶ä¸ç›®æ ‡æœåŠ¡å™¨åŒ¹é…ã€‚**
4.  **è¿è¡ŒPOCè„šæœ¬ï¼Œå®ƒå°†å°è¯•é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLæ¥è®¿é—®å—ä¿æŠ¤çš„æ–‡ä»¶ã€‚** æ”»å‡»è€…å¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´`directory_wordlist`ã€`file_wordlist`ç­‰å‚æ•°ä»¥æé«˜æ•ˆç‡
5.  **å¦‚æœæˆåŠŸï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤æ–‡ä»¶çš„å†…å®¹æˆ–æ‰§è¡Œæ¶æ„ä»£ç ï¼ˆå¦‚æœæœåŠ¡å™¨é…ç½®å…è®¸ï¼‰ã€‚** ä¾‹å¦‚ï¼Œå¦‚æœ`index.php`æ–‡ä»¶è¢«æˆåŠŸè®¿é—®ï¼Œå…¶æºä»£ç å°†è¢«æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [p0in7s/CVE-2024-38475](https://github.com/p0in7s/CVE-2024-38475)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---

## POC #3

**æ¥æº**: [CVE-2024-38475-soltanali0_CVE-2024-38475.md](../2024/CVE-2024-38475-soltanali0_CVE-2024-38475.md)

## CVE-2024-38475-Apache-mod_rewriteæ–‡ä»¶è¯»å–/ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** æ–‡ä»¶è¯»å–/ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æºä»£ç æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** æœåŠ¡å™¨å¯ç”¨äº† mod_rewrite æ¨¡å—å¹¶ä¸”å­˜åœ¨ä¸å®‰å…¨çš„ RewriteRule é…ç½®ï¼Œç‰¹åˆ«æ˜¯å½“é‡å†™è§„åˆ™çš„ç›®æ ‡è·¯å¾„åŒ…å«æ¥è‡ªåå‘å¼•ç”¨æˆ–å˜é‡çš„ç‰‡æ®µæ—¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-38475 æ˜¯ Apache HTTP Server 2.4.59 åŠä¹‹å‰ç‰ˆæœ¬ mod_rewrite æ¨¡å—ä¸­å­˜åœ¨çš„ä¸€ä¸ªä¸å½“è¾“å‡ºè½¬ä¹‰æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ URLï¼Œå°†å…¶æ˜ å°„åˆ°æœåŠ¡å™¨å…è®¸æä¾›ä½†å¹¶éæœ‰æ„é€šè¿‡ URL ç›´æ¥è®¿é—®çš„æ–‡ä»¶ç³»ç»Ÿä½ç½®ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºä»£ç æ³„éœ²ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œæœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯SonicWallçš„æ¡ˆä¾‹ï¼‰ä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤POCä»£ç æœ‰æ•ˆã€‚
POCä»£ç  `script.py` é€šè¿‡å¯¹ç›®æ ‡URLè¿›è¡Œ fuzzingï¼Œå°è¯•åˆ©ç”¨ `mod_rewrite` çš„ç¼ºé™·æ¥è®¿é—®å—ä¿æŠ¤çš„ç›®å½•æˆ–æ–‡ä»¶ã€‚
å®ƒé€šè¿‡å¯¹ç›®å½•å’Œæ–‡ä»¶ä½¿ç”¨å­—å…¸çˆ†ç ´ï¼Œå¹¶é™„åŠ  `%3F` æˆ– `%3Faaaaaaaaaaaaaaaaaaaaaa.php` è¿™æ ·çš„ payloadï¼Œå°è¯•ç»•è¿‡æœåŠ¡å™¨çš„å®‰å…¨æ£€æŸ¥ï¼Œä»¥è¾¾åˆ°æ³„æ¼æºä»£ç çš„ç›®çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„ POC ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨ `mod_rewrite` çš„æ¼æ´è¿›è¡Œç›®å½•æšä¸¾å’Œæºä»£ç æ³„éœ²å°è¯•ã€‚ä»£ç æœ¬èº«å¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–ä¸Šä¼ æ¶æ„æ–‡ä»¶ã€‚
ä½†æ˜¯ï¼Œä»£ç ä¸­ä½¿ç”¨äº†å¤–éƒ¨æ–‡ä»¶ï¼ˆ`webroots.txt`ï¼Œ`raft-medium-directories.txt`ï¼Œ`raft-medium-files.txt`ï¼‰ä½œä¸ºè¾“å…¥ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«ç¯¡æ”¹ï¼Œä¾‹å¦‚æ·»åŠ äº†ç²¾å¿ƒæ„é€ çš„è·¯å¾„æˆ–æ–‡ä»¶åï¼Œå¯èƒ½ä¼šå¯¼è‡´ä»£ç åˆ©ç”¨æ¼æ´å°è¯•è®¿é—®æˆ–æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…è§¦å‘å…¶ä»–æœªé¢„æœŸçš„è¡Œä¸ºã€‚
è€ƒè™‘åˆ°ä»£ç ä¾èµ–å¤–éƒ¨å­—å…¸æ–‡ä»¶ä»¥åŠå¯èƒ½è¢«ç”¨äºéæ³•ç›®çš„ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ä¸å®‰å…¨ RewriteRule é…ç½®ï¼š** è¯¥æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Apache HTTP Server çš„ `mod_rewrite` æ¨¡å—ä¸­å­˜åœ¨ä¸å®‰å…¨çš„é‡å†™è§„åˆ™ã€‚å½“é‡å†™è§„åˆ™çš„ç›®æ ‡è·¯å¾„åŒ…å«æ¥è‡ªåå‘å¼•ç”¨æˆ–å˜é‡çš„ç‰‡æ®µæ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚å¦‚æœè¿™äº›ç‰‡æ®µæ²¡æœ‰ç»è¿‡é€‚å½“çš„è½¬ä¹‰ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ§åˆ¶è¿™äº›ç‰‡æ®µæ¥æ„é€ æ¶æ„çš„è·¯å¾„ï¼Œä»è€Œè®¿é—®æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
2.  **Payload æ„é€ ï¼š** æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨ `mod_rewrite` æ¨¡å—çš„ç¼ºé™·ï¼Œå°† URL æ˜ å°„åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æ•æ„Ÿä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ `?` æˆ–å…¶ä»–ç‰¹æ®Šå­—ç¬¦æ¥ç»•è¿‡è·¯å¾„æ£€æŸ¥ã€‚
3.  **æºä»£ç æ³„éœ²ï¼š** é€šè¿‡æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æºä»£ç æ–‡ä»¶ï¼Œä»è€Œäº†è§£åº”ç”¨ç¨‹åºçš„å†…éƒ¨ç»“æ„å’Œé€»è¾‘ã€‚è¿™å¯èƒ½ä¼šä¸ºè¿›ä¸€æ­¥çš„æ”»å‡»æä¾›ä¿¡æ¯ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿå°†æ¶æ„ä»£ç ï¼ˆä¾‹å¦‚ PHP è„šæœ¬ï¼‰ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œè¯¥ä»£ç ï¼Œå°±å¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§ Apache HTTP Server åˆ° 2.4.60 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  ä»”ç»†æ£€æŸ¥ `mod_rewrite` çš„é…ç½®ï¼Œç¡®ä¿æ‰€æœ‰é‡å†™è§„åˆ™éƒ½æ˜¯å®‰å…¨çš„ï¼Œç‰¹åˆ«æ˜¯å½“é‡å†™è§„åˆ™çš„ç›®æ ‡è·¯å¾„åŒ…å«æ¥è‡ªåå‘å¼•ç”¨æˆ–å˜é‡çš„ç‰‡æ®µæ—¶ã€‚ä½¿ç”¨ "UnsafePrefixStat"Â rewrite flag,å¦‚æœç¡®ä¿¡é‡å†™è§„åˆ™ç›®æ ‡è·¯å¾„é€‚å½“é™åˆ¶.
3.  é™åˆ¶ Apache HTTP Server çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™ï¼Œåªå…è®¸å…¶è®¿é—®å¿…è¦çš„æ–‡ä»¶å’Œç›®å½•ã€‚
4.  ä½¿ç”¨ Web åº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰æ¥è¿‡æ»¤æ¶æ„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [soltanali0/CVE-2024-38475](https://github.com/soltanali0/CVE-2024-38475)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---

## POC #4

**æ¥æº**: [CVE-2024-38475-syaifulandy_CVE-2024-38475.md](../2024/CVE-2024-38475-syaifulandy_CVE-2024-38475.md)

## CVE-2024-38475 - Apache HTTP Server mod_rewrite ä¸å½“è½¬ä¹‰æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** è·¯å¾„éå†/ä»£ç æ‰§è¡Œ/æºç æ³„éœ²

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºç æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** æœåŠ¡å™¨é…ç½®äº†å­˜åœ¨ç¼ºé™·çš„mod_rewriteè§„åˆ™ï¼Œä¸”å…è®¸è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä½ç½®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-38475 å­˜åœ¨äº Apache HTTP Server çš„ mod_rewrite æ¨¡å—ä¸­ï¼Œç”±äºä¸å½“çš„è¾“å‡ºè½¬ä¹‰ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨æœåŠ¡å™¨ä¸Šé…ç½®çš„ mod_rewrite è§„åˆ™ï¼Œå°† URL æ˜ å°„åˆ°æ–‡ä»¶ç³»ç»Ÿä¸Šæœ¬ä¸åº”è¯¥ç›´æ¥è®¿é—®çš„ä½ç½®ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºç æ³„éœ²ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ©ç”¨åœºæ™¯ï¼š** è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äºæœåŠ¡å™¨ä¸Šé…ç½®çš„ç‰¹å®šçš„ã€å­˜åœ¨ç¼ºé™·çš„ `mod_rewrite` è§„åˆ™ã€‚è¿™äº›è§„åˆ™é€šå¸¸ä¼šä½¿ç”¨åå‘å¼•ç”¨æˆ–å˜é‡ä½œä¸ºæ›¿æ¢çš„ç¬¬ä¸€ä¸ªæ®µï¼Œå¹¶ä¸”æ²¡æœ‰å……åˆ†é™åˆ¶æ›¿æ¢ç›®æ ‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„ URLï¼Œè¯¥ URL å¯ä»¥è¢«å­˜åœ¨ç¼ºé™·çš„ `mod_rewrite` è§„åˆ™å¤„ç†ã€‚
    *   `mod_rewrite` è§„åˆ™åœ¨å¤„ç†è¯¥ URL æ—¶ï¼Œç”±äºä¸å½“çš„è¾“å‡ºè½¬ä¹‰ï¼Œä¼šå°† URL æ˜ å°„åˆ°æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šæœ¬ä¸åº”è¯¥ç›´æ¥è®¿é—®çš„ä½ç½®ï¼Œæ¯”å¦‚ Web æ ¹ç›®å½•ä¹‹å¤–çš„ç›®å½•æˆ–æ•æ„Ÿé…ç½®æ–‡ä»¶ã€‚
    *   æœåŠ¡å™¨è¿”å›è¯¥ä½ç½®çš„æ–‡ä»¶å†…å®¹ï¼ˆæºç æ³„éœ²ï¼‰æˆ–æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼ˆä»£ç æ‰§è¡Œï¼‰ã€‚

**æä¾›çš„PoCä»£ç åˆ†æï¼š**

æä¾›çš„ `scanner.sh` è„šæœ¬å¹¶éç›´æ¥åˆ©ç”¨ CVE-2024-38475 æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºæ‰«æç›®æ ‡ç½‘ç«™ï¼Œå°è¯•å¯»æ‰¾å¯ä»¥ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

1.  **ç›®å½•æ‰«æ (403 Bypass)ï¼š**  ä½¿ç”¨ `ffuf` å·¥å…·ï¼Œæ‰«æç›®æ ‡ç½‘ç«™çš„å¸¸è§ç›®å½•ï¼Œå¯»æ‰¾è¿”å› HTTP 403 (Forbidden) é”™è¯¯çš„ç›®å½•ã€‚`ffuf`æ˜¯ä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œç”¨äºå‘ç°Webåº”ç”¨ç¨‹åºä¸­çš„å„ç§æ¼æ´ã€‚
2.  **æ–‡ä»¶æ‰«æ (Bypass Payloads)ï¼š** å¯¹äºæ‰¾åˆ°çš„ 403 ç›®å½•ï¼Œè„šæœ¬å°è¯•ä½¿ç”¨ä¸€äº› Payload (`%3F`, `%3Fooooo.php`) æ¥ç»•è¿‡é™åˆ¶ï¼Œæ‰«æè¿™äº›ç›®å½•ä¸‹çš„å¸¸è§æ–‡ä»¶ã€‚å¦‚æœæŸä¸ªæ–‡ä»¶å¯ä»¥è¢«è®¿é—®ï¼ˆè¿”å› HTTP 200ï¼‰ï¼Œåˆ™å°†å…¶ URL è®°å½•åˆ° `final_report.txt` æ–‡ä»¶ä¸­ã€‚
3.  **æŠ¥å‘Šç”Ÿæˆï¼š** è„šæœ¬ä¼šå°†æ‰€æœ‰å‘ç°çš„å¯è®¿é—®çš„ URL è®°å½•åˆ° `final_report.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç æœ¬èº«å¹¶ä¸èƒ½ç›´æ¥åˆ©ç”¨ CVE-2024-38475 æ¼æ´ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªé€šç”¨çš„ç½‘ç«™æ‰«æå·¥å…·ï¼Œç”¨äºæŸ¥æ‰¾ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨å¯ä»¥é€šè¿‡ä¿®æ”¹URLï¼ˆä¾‹å¦‚ä½¿ç”¨`%3F`æˆ–é™„åŠ ç‰¹å®šåç¼€ï¼‰ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ï¼Œè¿™ä¸ªè„šæœ¬å°±å¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€‚å› æ­¤ï¼Œ**ä¸èƒ½ç›´æ¥éªŒè¯ CVE-2024-38475 çš„åˆ©ç”¨æƒ…å†µ**ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

*   **ç›®æ ‡æ–‡ä»¶ï¼š** `scanner.sh` å’Œ `targets.txt`
*   **æ½œåœ¨é£é™©ç‚¹ï¼š** è„šæœ¬ä½¿ç”¨å¤–éƒ¨è¯è¡¨æ–‡ä»¶ (`/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt` å’Œ `/usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt`) å’Œç®€å•çš„payloadï¼Œä»¥åŠ`jq`å’Œ`ffuf`å‘½ä»¤ã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§ä¸»è¦é›†ä¸­åœ¨ targets.txt å’Œæ¶æ„å‘½ä»¤æ‰§è¡Œã€‚  ä½†æ˜¯å½“å‰è„šæœ¬å¹¶æ²¡æœ‰å‘ç°å­˜åœ¨å¼‚å¸¸ã€‚
*   **é£é™©åˆ†æï¼š**  targets.txt å¯èƒ½åŒ…å«æ¶æ„çš„URLï¼Œå¯¼è‡´æ‰«æè¡Œä¸ºæœ¬èº«è§¦çŠ¯æ³•å¾‹æ³•è§„ã€‚ è„šæœ¬ä¾èµ–çš„å¤–éƒ¨å‘½ä»¤å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œå¦‚æœè¢«äººç¯¡æ”¹å¯èƒ½å¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ å¦å¤–ä¸¤ä¸ªè¯è¡¨æ–‡ä»¶å¦‚æœè¢«ç¯¡æ”¹,è™½ç„¶å­˜åœ¨é£é™©,ä½†æ˜¯å½±å“è¾ƒå°ã€‚
*   **é£é™©æ¯”ä¾‹ï¼š** æ•´ä½“é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚è¿™ä¸ªæ¯”ä¾‹ä¸»è¦æ¥æºäºå¯¹å¤–éƒ¨è¯è¡¨æ–‡ä»¶çš„ä¾èµ–ï¼Œä»¥åŠå¯èƒ½è¢«æ»¥ç”¨çš„æ‰«æè¡Œä¸ºã€‚è„šæœ¬æœ¬èº«çš„ä»£ç çœ‹èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**æ€»ç»“ï¼š**

CVE-2024-38475 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œä½†åˆ©ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ï¼Œéœ€è¦æœåŠ¡å™¨é…ç½®å­˜åœ¨ç¼ºé™·çš„ `mod_rewrite` è§„åˆ™ã€‚æä¾›çš„ PoC ä»£ç å¹¶ä¸èƒ½ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´ï¼Œè€Œæ˜¯ä¸€ä¸ªé€šç”¨çš„ç½‘ç«™æ‰«æå·¥å…·ï¼Œç”¨äºæŸ¥æ‰¾å¯ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ã€‚è¯¥è„šæœ¬å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨æœªç»ä¸¥æ ¼å®¡æ ¸çš„å¤–éƒ¨è¯è¡¨æ–‡ä»¶å’Œæ»¥ç”¨æ‰«æè¡Œä¸ºçš„å¯èƒ½æ€§ä¸Šã€‚

**é¡¹ç›®åœ°å€:** [syaifulandy/CVE-2024-38475](https://github.com/syaifulandy/CVE-2024-38475)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---



---

## POC #4

**æ¥æº**: [CVE-2024-38475-syaifulandy_CVE-2024-38475.md](../2024/CVE-2024-38475-syaifulandy_CVE-2024-38475.md)

## CVE-2024-38475 - Apache HTTP Server mod_rewrite ä¸å½“è½¬ä¹‰æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-38475

**æ¼æ´ç±»å‹:** è·¯å¾„éå†/ä»£ç æ‰§è¡Œ/æºç æ³„éœ²

**å½±å“åº”ç”¨:** Apache HTTP Server

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºç æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 2.4.59

**åˆ©ç”¨æ¡ä»¶:** æœåŠ¡å™¨é…ç½®äº†å­˜åœ¨ç¼ºé™·çš„mod_rewriteè§„åˆ™ï¼Œä¸”å…è®¸è®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä½ç½®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-38475 å­˜åœ¨äº Apache HTTP Server çš„ mod_rewrite æ¨¡å—ä¸­ï¼Œç”±äºä¸å½“çš„è¾“å‡ºè½¬ä¹‰ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ URLï¼Œåˆ©ç”¨æœåŠ¡å™¨ä¸Šé…ç½®çš„ mod_rewrite è§„åˆ™ï¼Œå°† URL æ˜ å°„åˆ°æ–‡ä»¶ç³»ç»Ÿä¸Šæœ¬ä¸åº”è¯¥ç›´æ¥è®¿é—®çš„ä½ç½®ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œæˆ–æºç æ³„éœ²ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **åˆ©ç”¨åœºæ™¯ï¼š** è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äºæœåŠ¡å™¨ä¸Šé…ç½®çš„ç‰¹å®šçš„ã€å­˜åœ¨ç¼ºé™·çš„ `mod_rewrite` è§„åˆ™ã€‚è¿™äº›è§„åˆ™é€šå¸¸ä¼šä½¿ç”¨åå‘å¼•ç”¨æˆ–å˜é‡ä½œä¸ºæ›¿æ¢çš„ç¬¬ä¸€ä¸ªæ®µï¼Œå¹¶ä¸”æ²¡æœ‰å……åˆ†é™åˆ¶æ›¿æ¢ç›®æ ‡ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„ URLï¼Œè¯¥ URL å¯ä»¥è¢«å­˜åœ¨ç¼ºé™·çš„ `mod_rewrite` è§„åˆ™å¤„ç†ã€‚
    *   `mod_rewrite` è§„åˆ™åœ¨å¤„ç†è¯¥ URL æ—¶ï¼Œç”±äºä¸å½“çš„è¾“å‡ºè½¬ä¹‰ï¼Œä¼šå°† URL æ˜ å°„åˆ°æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šæœ¬ä¸åº”è¯¥ç›´æ¥è®¿é—®çš„ä½ç½®ï¼Œæ¯”å¦‚ Web æ ¹ç›®å½•ä¹‹å¤–çš„ç›®å½•æˆ–æ•æ„Ÿé…ç½®æ–‡ä»¶ã€‚
    *   æœåŠ¡å™¨è¿”å›è¯¥ä½ç½®çš„æ–‡ä»¶å†…å®¹ï¼ˆæºç æ³„éœ²ï¼‰æˆ–æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼ˆä»£ç æ‰§è¡Œï¼‰ã€‚

**æä¾›çš„PoCä»£ç åˆ†æï¼š**

æä¾›çš„ `scanner.sh` è„šæœ¬å¹¶éç›´æ¥åˆ©ç”¨ CVE-2024-38475 æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºæ‰«æç›®æ ‡ç½‘ç«™ï¼Œå°è¯•å¯»æ‰¾å¯ä»¥ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

1.  **ç›®å½•æ‰«æ (403 Bypass)ï¼š**  ä½¿ç”¨ `ffuf` å·¥å…·ï¼Œæ‰«æç›®æ ‡ç½‘ç«™çš„å¸¸è§ç›®å½•ï¼Œå¯»æ‰¾è¿”å› HTTP 403 (Forbidden) é”™è¯¯çš„ç›®å½•ã€‚`ffuf`æ˜¯ä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œç”¨äºå‘ç°Webåº”ç”¨ç¨‹åºä¸­çš„å„ç§æ¼æ´ã€‚
2.  **æ–‡ä»¶æ‰«æ (Bypass Payloads)ï¼š** å¯¹äºæ‰¾åˆ°çš„ 403 ç›®å½•ï¼Œè„šæœ¬å°è¯•ä½¿ç”¨ä¸€äº› Payload (`%3F`, `%3Fooooo.php`) æ¥ç»•è¿‡é™åˆ¶ï¼Œæ‰«æè¿™äº›ç›®å½•ä¸‹çš„å¸¸è§æ–‡ä»¶ã€‚å¦‚æœæŸä¸ªæ–‡ä»¶å¯ä»¥è¢«è®¿é—®ï¼ˆè¿”å› HTTP 200ï¼‰ï¼Œåˆ™å°†å…¶ URL è®°å½•åˆ° `final_report.txt` æ–‡ä»¶ä¸­ã€‚
3.  **æŠ¥å‘Šç”Ÿæˆï¼š** è„šæœ¬ä¼šå°†æ‰€æœ‰å‘ç°çš„å¯è®¿é—®çš„ URL è®°å½•åˆ° `final_report.txt` æ–‡ä»¶ä¸­ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç æœ¬èº«å¹¶ä¸èƒ½ç›´æ¥åˆ©ç”¨ CVE-2024-38475 æ¼æ´ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªé€šç”¨çš„ç½‘ç«™æ‰«æå·¥å…·ï¼Œç”¨äºæŸ¥æ‰¾ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™å­˜åœ¨å¯ä»¥é€šè¿‡ä¿®æ”¹URLï¼ˆä¾‹å¦‚ä½¿ç”¨`%3F`æˆ–é™„åŠ ç‰¹å®šåç¼€ï¼‰ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ï¼Œè¿™ä¸ªè„šæœ¬å°±å¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€‚å› æ­¤ï¼Œ**ä¸èƒ½ç›´æ¥éªŒè¯ CVE-2024-38475 çš„åˆ©ç”¨æƒ…å†µ**ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

*   **ç›®æ ‡æ–‡ä»¶ï¼š** `scanner.sh` å’Œ `targets.txt`
*   **æ½œåœ¨é£é™©ç‚¹ï¼š** è„šæœ¬ä½¿ç”¨å¤–éƒ¨è¯è¡¨æ–‡ä»¶ (`/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt` å’Œ `/usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt`) å’Œç®€å•çš„payloadï¼Œä»¥åŠ`jq`å’Œ`ffuf`å‘½ä»¤ã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§ä¸»è¦é›†ä¸­åœ¨ targets.txt å’Œæ¶æ„å‘½ä»¤æ‰§è¡Œã€‚  ä½†æ˜¯å½“å‰è„šæœ¬å¹¶æ²¡æœ‰å‘ç°å­˜åœ¨å¼‚å¸¸ã€‚
*   **é£é™©åˆ†æï¼š**  targets.txt å¯èƒ½åŒ…å«æ¶æ„çš„URLï¼Œå¯¼è‡´æ‰«æè¡Œä¸ºæœ¬èº«è§¦çŠ¯æ³•å¾‹æ³•è§„ã€‚ è„šæœ¬ä¾èµ–çš„å¤–éƒ¨å‘½ä»¤å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œå¦‚æœè¢«äººç¯¡æ”¹å¯èƒ½å¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ å¦å¤–ä¸¤ä¸ªè¯è¡¨æ–‡ä»¶å¦‚æœè¢«ç¯¡æ”¹,è™½ç„¶å­˜åœ¨é£é™©,ä½†æ˜¯å½±å“è¾ƒå°ã€‚
*   **é£é™©æ¯”ä¾‹ï¼š** æ•´ä½“é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚è¿™ä¸ªæ¯”ä¾‹ä¸»è¦æ¥æºäºå¯¹å¤–éƒ¨è¯è¡¨æ–‡ä»¶çš„ä¾èµ–ï¼Œä»¥åŠå¯èƒ½è¢«æ»¥ç”¨çš„æ‰«æè¡Œä¸ºã€‚è„šæœ¬æœ¬èº«çš„ä»£ç çœ‹èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**æ€»ç»“ï¼š**

CVE-2024-38475 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œä½†åˆ©ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ï¼Œéœ€è¦æœåŠ¡å™¨é…ç½®å­˜åœ¨ç¼ºé™·çš„ `mod_rewrite` è§„åˆ™ã€‚æä¾›çš„ PoC ä»£ç å¹¶ä¸èƒ½ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´ï¼Œè€Œæ˜¯ä¸€ä¸ªé€šç”¨çš„ç½‘ç«™æ‰«æå·¥å…·ï¼Œç”¨äºæŸ¥æ‰¾å¯ç»•è¿‡è®¿é—®é™åˆ¶çš„æ–‡ä»¶ã€‚è¯¥è„šæœ¬å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦é›†ä¸­åœ¨ä½¿ç”¨æœªç»ä¸¥æ ¼å®¡æ ¸çš„å¤–éƒ¨è¯è¡¨æ–‡ä»¶å’Œæ»¥ç”¨æ‰«æè¡Œä¸ºçš„å¯èƒ½æ€§ä¸Šã€‚

**é¡¹ç›®åœ°å€:** [syaifulandy/CVE-2024-38475](https://github.com/syaifulandy/CVE-2024-38475)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)

---

