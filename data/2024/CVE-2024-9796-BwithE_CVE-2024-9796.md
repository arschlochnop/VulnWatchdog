# CVE-2024-9796

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-9796-BwithE_CVE-2024-9796.md](../2024/CVE-2024-9796-BwithE_CVE-2024-9796.md)

## CVE-2024-9796-WP-Advanced-Search-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-9796

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** WP-Advanced-Search

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 3.3.9.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†WP-Advanced-Searchæ’ä»¶ï¼Œä¸”ç‰ˆæœ¬ä½äº3.3.9.2ï¼Œæ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®åŒ…å«æ¼æ´çš„URLã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºWP-Advanced-Searchæ’ä»¶çš„autocompletion-PHP5.5.phpæ–‡ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥ï¼Œæ³¨å…¥åˆ°`t`å‚æ•°ä¸­ï¼Œä»è€Œè·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚WordPressç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚ç”±äº`t`å‚æ•°æœªç»è¿‡å……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´äº†SQLæ³¨å…¥æ¼æ´ã€‚PoCä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ¶æ„`t`å‚æ•°çš„GETè¯·æ±‚åˆ°æ˜“å—æ”»å‡»çš„URLï¼Œå¹¶ä»å“åº”ä¸­æå–ç”¨æˆ·åå’Œå“ˆå¸Œå€¼ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚å®ƒæ„é€ äº†ä¸€ä¸ªåŒ…å«SQLæ³¨å…¥çš„HTTP GETè¯·æ±‚ï¼Œèƒ½å¤Ÿä»æ˜“å—æ”»å‡»çš„WP-Advanced-Searchæ’ä»¶ä¸­æå–ç”¨æˆ·å‡­æ®ã€‚

**æŠ•æ¯’é£é™©ï¼š** åœ¨æä¾›çš„PoCä»£ç å’ŒREADMEæ–‡ä»¶ä¸­ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜¯åˆ©ç”¨SQLæ³¨å…¥æ¼æ´æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰æ‰§è¡Œæ¶æ„æ“ä½œçš„éƒ¨åˆ†ã€‚å…è´£å£°æ˜ä¹Ÿå¼ºè°ƒäº†è„šæœ¬ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä¸åº”è¢«ç”¨äºéæ³•æ´»åŠ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡WordPressç«™ç‚¹æ˜¯å¦å®‰è£…äº†WP-Advanced-Searchæ’ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä½äº3.3.9.2ã€‚
2.  ä½¿ç”¨PoCè„šæœ¬ï¼Œæ›¿æ¢`-i`å‚æ•°ä¸ºç›®æ ‡IPåœ°å€ã€‚
3.  è„šæœ¬å°†å‘é€åŒ…å«æ¶æ„SQLæ³¨å…¥çš„GETè¯·æ±‚åˆ°ä»¥ä¸‹URLï¼š
    `http://<ç›®æ ‡IP>/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php?q=admin&t=wp_users UNION SELECT user_pass FROM wp_users--&f=user_login&type=&e=`
4.  å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨æ¼æ´ï¼Œè„šæœ¬å°†ä»å“åº”ä¸­æå–ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œå¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚

**é¡¹ç›®åœ°å€:** [BwithE/CVE-2024-9796](https://github.com/BwithE/CVE-2024-9796)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)

---

## POC #2

**æ¥æº**: [CVE-2024-9796-RandomRobbieBF_CVE-2024-9796.md](../2024/CVE-2024-9796-RandomRobbieBF_CVE-2024-9796.md)

## CVE-2024-9796-WP-Advanced-Search-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-9796

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** WP-Advanced-Search

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œæœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** < 3.3.9.2

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å®‰è£…å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„WP-Advanced-Searchæ’ä»¶çš„WordPressç«™ç‚¹ï¼Œä¸”å…è®¸æœªç»èº«ä»½éªŒè¯çš„HTTPè¯·æ±‚è®¿é—®åŒ…å«æ¼æ´çš„`autocompletion-PHP5.5.php`æ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºWP-Advanced-Searchæ’ä»¶çš„ `autocompletion-PHP5.5.php` æ–‡ä»¶ä¸­ï¼Œç”±äºå¯¹`t`å‚æ•°æœªè¿›è¡Œå……åˆ†çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥æ‰§è¡ŒSQLæ³¨å…¥æ”»å‡»ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥å‘ `autocompletion-PHP5.5.php` å‘é€åŒ…å«æ¶æ„SQLä»£ç çš„GETè¯·æ±‚ï¼Œåˆ©ç”¨ `t` å‚æ•°æ‰§è¡ŒSQLæ³¨å…¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„POCï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ `ghauri` å·¥å…·ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„Payloadè¿›è¡Œæ—¶é—´ç›²æ³¨æ”»å‡»ï¼ŒéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸»è¦åŒ…å«æ¼æ´æè¿°ä¿¡æ¯ã€ä¸‹è½½é“¾æ¥å’ŒPOCç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰å‘ç°ç›´æ¥å¯ç–‘çš„æŠ•æ¯’ä»£ç ã€‚è™½ç„¶å­˜åœ¨é€šè¿‡ç¯¡æ”¹ä¸‹è½½é“¾æ¥æ¤å…¥åé—¨æ’ä»¶çš„å¯èƒ½æ€§ï¼Œä½†ç›´æ¥åœ¨ä»“åº“ä¸­æ·»åŠ æ¶æ„ä»£ç çš„æ¦‚ç‡è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå»ºè®®ä¸‹è½½æ’ä»¶æ—¶æ ¡éªŒhashã€‚

è™½ç„¶æä¾›çš„POCåœ¨URLä¸Šï¼Œä½¿ç”¨äº†`wpscan-vulnerability-test-bench.ddev.site`è¿™ä¸ªåŸŸåã€‚ä½†æ˜¯å¹¶æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜ï¼Œä½œè€…é€šè¿‡éªŒè¯æ¼æ´ï¼Œåœ¨ä»£ç ä¸­æ¤å…¥åé—¨ï¼Œè¿›è¡Œæ¼æ´æŠ•æ¯’ã€‚æ‰€ä»¥æ­¤å¤„ä¸åšæŠ•æ¯’å¤„ç†ã€‚

**æ€»ç»“ï¼š**
æ­¤æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…æ‰§è¡ŒSQLæ³¨å…¥ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®åº“ä¿¡æ¯æ³„éœ²æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚å»ºè®®åŠæ—¶æ›´æ–°æ’ä»¶åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [RandomRobbieBF/CVE-2024-9796](https://github.com/RandomRobbieBF/CVE-2024-9796)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)

---

## POC #3

**æ¥æº**: [CVE-2024-9796-issamjr_CVE-2024-9796.md](../2024/CVE-2024-9796-issamjr_CVE-2024-9796.md)

## CVE-2024-9796-WP-Advanced-Search-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-9796

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** WP-Advanced-Search

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 3.3.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡WordPressç«™ç‚¹å®‰è£…äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„WP-Advanced-Searchæ’ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9796æ˜¯WordPress WP-Advanced-Searchæ’ä»¶3.3.9ç‰ˆæœ¬åŠä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨çš„SQLæ³¨å…¥æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡`t`å‚æ•°ï¼Œå‘`/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php`å‘é€æ¶æ„è¯·æ±‚ï¼Œæ³¨å…¥æ¶æ„çš„SQLè¯­å¥ã€‚ç”±äºæ’ä»¶æ²¡æœ‰å……åˆ†è¿‡æ»¤å’Œè½¬ä¹‰ç”¨æˆ·æä¾›çš„å‚æ•°ï¼Œä¸”æœªå¯¹SQLæŸ¥è¯¢è¿›è¡Œé€‚å½“çš„é¢„å¤„ç†ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„SQLæŸ¥è¯¢ï¼Œå¯èƒ½æå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æä¾›çš„POCä»£ç ä½¿ç”¨`ghauri`å·¥å…·éªŒè¯æ¼æ´ï¼Œå¹¶æä¾›äº†åŸºäºæ—¶é—´çš„ç›²æ³¨Payloadï¼Œè¯¥Payloadé€šè¿‡æ§åˆ¶`f`å‚æ•°ï¼Œåˆ©ç”¨`SLEEP()`å‡½æ•°æ¥åˆ¤æ–­SQLæ³¨å…¥æ˜¯å¦æˆåŠŸã€‚è™½ç„¶POCçœ‹èµ·æ¥ç›´æ¥æœ‰æ•ˆï¼Œä½†YAMLæ–‡ä»¶ä¸­çš„`tags`å­—æ®µä¸­çš„è¯„è®ºæ€§è¯­å¥â€œgithub.com/fa-rrel ==> WHAT DO YOU THINK ABOUT ME ?â€æš—ç¤ºäº†ä½œè€…å¯èƒ½å­˜åœ¨æŸç§æ„å›¾ï¼Œè™½ç„¶ä¸ä¸€å®šæ˜¯æ¶æ„ä»£ç ï¼Œä½†å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è¿™ç§é£é™©åˆ¤å®šä¸ºæŠ•æ¯’ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©æ¯”ä¾‹ä¼°è®¡ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [issamjr/CVE-2024-9796](https://github.com/issamjr/CVE-2024-9796)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)

---

## POC #4

**æ¥æº**: [CVE-2024-9796-viniciuslazzari_CVE-2024-9796.md](../2024/CVE-2024-9796-viniciuslazzari_CVE-2024-9796.md)

## CVE-2024-9796-WP-Advanced-Search-SQLæ³¨å…¥

**æ¼æ´ç¼–å·:** CVE-2024-9796

**æ¼æ´ç±»å‹:** SQLæ³¨å…¥

**å½±å“åº”ç”¨:** WP-Advanced-Search

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 3.3.9.2

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ WordPress ç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WP-Advanced-Search æ’ä»¶ï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿå‘é€ HTTP è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-9796 æ˜¯ WP-Advanced-Search WordPress æ’ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ SQL æ³¨å…¥æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œ3.3.9.2 ä¹‹å‰çš„ç‰ˆæœ¬æ²¡æœ‰å……åˆ†åœ°å¯¹ `t` å‚æ•°è¿›è¡Œè¿‡æ»¤å’Œè½¬ä¹‰ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åœ¨ SQL æŸ¥è¯¢ä¸­æ³¨å…¥æ¶æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œå­˜åœ¨å…¬å¼€çš„æ¼æ´åˆ©ç”¨è¯æ˜(POC)ã€‚ä½†æ˜¯æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«ä¸€ä¸ªç®€å•çš„ README æ–‡ä»¶ï¼ŒWordPress æ¡†æ¶ä»£ç å’ŒGPLåè®®,å¹¶æ²¡æœ‰æä¾›åˆ©ç”¨æ¼æ´çš„ä»£ç ,ä¸èƒ½ç›´æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚Githubä¸Šå­˜åœ¨POCï¼Œå› æ­¤å¯ä¿¡åº¦é«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«äº†ä¸€ä¸ª `README.md`ï¼Œ `index.php` å’Œ `license.txt`ï¼Œè¿™éƒ¨åˆ†ä»£ç æ˜¯WordPressçš„æ¡†æ¶ä»£ç å’ŒGPLåè®®æ–‡æœ¬ï¼Œä¸åƒæ˜¯ç”¨äºæ¼æ´åˆ©ç”¨æˆ–æ”»å‡»çš„ä»£ç ã€‚`index.php`æ˜¯ WordPress çš„å‰ç«¯å…¥å£æ–‡ä»¶ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸åŒ…å«æ¶æ„ä»£ç ã€‚å› æ­¤ï¼Œä»ç›´æ¥çš„ä»£ç åˆ†ææ¥çœ‹ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ï¼Œä½†ä»å­˜åœ¨é£é™©ï¼Œä¾‹å¦‚åœ¨ WordPress æ¡†æ¶ä»£ç ä¸­éšè—åé—¨ï¼Œæˆ–é€šè¿‡ README.md æ–‡ä»¶è¯±å¯¼ç”¨æˆ·æ‰§è¡Œæ¶æ„æ“ä½œã€‚ç»™10%æ˜¯è€ƒè™‘åˆ°ä»£ç æ¯”è¾ƒå°‘ï¼Œæ— æ³•éªŒè¯æŠ•æ¯’çš„å®Œå…¨æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç¡®å®šç›®æ ‡ WordPress ç«™ç‚¹å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ WP-Advanced-Search æ’ä»¶ (ä½äº3.3.9.2)ã€‚
2.  æ„é€ åŒ…å«æ¶æ„ SQL ä»£ç çš„ HTTP è¯·æ±‚ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ `t` å‚æ•°ã€‚
3.  å°†æ„é€ çš„ HTTP è¯·æ±‚å‘é€åˆ°ç›®æ ‡ç«™ç‚¹çš„ WordPress å®ä¾‹ã€‚
4.  å¦‚æœæ¼æ´æˆåŠŸåˆ©ç”¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæ‰§è¡Œä»»æ„ SQL æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥æå–æ•°æ®åº“ä¸­çš„æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œæ¯”å¦‚æ’å…¥æˆ–æ›´æ–°æ•°æ®ã€‚

**æ€»ç»“ï¼š**

CVE-2024-9796 æ˜¯ WP-Advanced-Search æ’ä»¶ä¸­çš„ä¸€ä¸ªé«˜å± SQL æ³¨å…¥æ¼æ´ã€‚è™½ç„¶æä¾›çš„POCä»£ç ä¸å®Œæ•´ï¼Œä½†å…¬å¼€çš„ä¿¡æ¯è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚å¼€å‘è€…åº”è¯¥å°½å¿«å‡çº§æ’ä»¶åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥ä¿®å¤è¯¥æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [viniciuslazzari/CVE-2024-9796](https://github.com/viniciuslazzari/CVE-2024-9796)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)

---

