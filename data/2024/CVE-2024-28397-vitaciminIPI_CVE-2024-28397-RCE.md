## CVE-2024-28397 - JS2PY RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** RCE

**影响应用:** JS2PY

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** N/A

**利用条件:** 需要知道目标主机的host、port和有效的session

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 35%

## 详情

CVE-2024-28397是一个存在于JS2PY中的远程代码执行漏洞。提供的POC代码是一个Python脚本，通过向目标服务器发送POST请求来利用此漏洞。该脚本首先提示用户输入目标主机的host、port、cmd以及session。然后，它构造一个包含JavaScript代码的JSON payload，该JavaScript代码旨在利用`__getattribute__`方法来执行任意命令。具体来说，该payload尝试找到`subprocess.Popen`类，并使用它来执行用户提供的命令。该命令的输出通过`console.log`输出，并返回给攻击者。

POC有效性分析：POC代码是有效的，它成功地利用了JS2PY中的RCE漏洞。通过修改host、port、cmd和session变量，攻击者可以在目标服务器上执行任意命令。然而，该POC需要一个有效的session cookie，这可能需要攻击者首先进行身份验证或找到绕过身份验证的方法。该脚本使用了requests库来发送HTTP请求，并且处理了可能的连接错误。总体来说，该POC代码结构清晰，易于理解和修改。

利用步骤：
1. 获取目标JS2PY服务的host和port。
2. 获取一个有效的session cookie。这可能需要进行身份验证或找到绕过身份验证的方法。
3. 运行`exploit.py`脚本。
4. 按照提示输入host、port、要执行的命令以及session cookie。
5. 脚本将发送一个包含恶意JavaScript代码的POST请求到目标服务器。
6. 目标服务器将执行JavaScript代码，从而执行攻击者指定的命令。
7. 命令的输出将显示在攻击者的终端上。

投毒风险分析：该POC代码的投毒风险中等。虽然代码本身相对简单，没有明显的恶意行为，但它使用了`subprocess.Popen`来执行任意命令，这本身就具有潜在的危险性。攻击者可能会修改payload中的JavaScript代码，以执行更具破坏性的操作，例如删除文件、安装恶意软件或窃取敏感数据。此外，脚本依赖于用户提供的命令，这使得攻击者可以轻松地将恶意代码注入到命令中。该脚本包含input函数，这给投毒者留下了可乘之机，他们可以通过修改input函数来注入恶意代码。由于JavaScript代码使用了`__getattribute__`等方法，这增加了代码的复杂性，使得检测恶意行为变得更加困难。综上所述，该POC代码的投毒风险较高，需要谨慎使用。

**项目地址:** https://github.com/xxx/CVE-2024-28397-RCE

**漏洞详情:** N/A
