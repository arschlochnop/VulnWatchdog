# CVE-2024-0204

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0204-adminlove520_CVE-2024-0204.md](../2024/CVE-2024-0204-adminlove520_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡GoAnywhere MFTå®ä¾‹çš„ç‰ˆæœ¬ä½äº7.4.1ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ç®¡ç†ç•Œé¢ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2024-0204 å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·é€šè¿‡ç®¡ç†é—¨æˆ·åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚æä¾›çš„Pythonè„šæœ¬ `CVE-2024-0204.py` åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚è„šæœ¬é¦–å…ˆè·å– `javax.faces.ViewState`ï¼Œç„¶åå°†ç”¨æˆ·åå’Œå¯†ç ä»¥åŠViewStateä¸€å¹¶POSTå‘é€åˆ°ç›®æ ‡URLã€‚è„šæœ¬åŒ…å«å¯†ç å¼ºåº¦éªŒè¯,è¦æ±‚å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä½ã€‚`README.md` æ–‡ä»¶æä¾›äº†è„šæœ¬çš„ä½¿ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šã€‚åœ¨æä¾›çš„ä»£ç ä¸­ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰è¡Œä¸ºéƒ½ä¸åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ä¸€è‡´ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥HTTPçŠ¶æ€ç å’Œé¡µé¢ä¸­çš„é”™è¯¯æ¶ˆæ¯æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸåˆ›å»ºç”¨æˆ·ã€‚è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ç›´æ¥ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**é¡¹ç›®åœ°å€:** [adminlove520/CVE-2024-0204](https://github.com/adminlove520/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #2

**æ¥æº**: [CVE-2024-0204-cbeek-r7_CVE-2024-0204.md](../2024/CVE-2024-0204-cbeek-r7_CVE-2024-0204.md)

## CVE-2024-0204 - GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (6.0.1 <= version < 7.4.1)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ï¼Œç›®æ ‡ç³»ç»Ÿæœªåº”ç”¨è¡¥ä¸æˆ–ç¼“è§£æªæ–½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡è®¿é—® `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥ä½¿æ”»å‡»è€…å®Œå…¨æ§åˆ¶å—å½±å“çš„ GoAnywhere MFT ç³»ç»Ÿã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-0204-scan.py` æ—¨åœ¨é€šè¿‡å‘ç›®æ ‡ IP åœ°å€å‘é€ GET è¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„æ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™ç›®æ ‡è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚å¦‚æœçŠ¶æ€ç ä¸º 401ï¼Œè¡¨ç¤ºå·²ç»ä¿®å¤ã€‚ ç”±äºè¯¥POCä»£ç çš„åŠŸèƒ½æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ›å»ºåé—¨ï¼Œå¹¶ä¸”æœªå‘ç°ä»»ä½•æ¶æ„è¡Œä¸ºï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [cbeek-r7/CVE-2024-0204](https://github.com/cbeek-r7/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #3

**æ¥æº**: [CVE-2024-0204-horizon3ai_CVE-2024-0204.md](../2024/CVE-2024-0204-horizon3ai_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (å½±å“ 6.0.1 åŠä»¥ä¸Šç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT è½¯ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªä¸¥é‡èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ 

**æœ‰æ•ˆæ€§:**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªæ¡ç›® (Rapid7, Kroll, Arctic Wolf, Tenable, Wiz ç­‰) éƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œä»¥åŠåˆ©ç”¨è¯¥æ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·çš„å¯èƒ½æ€§ã€‚Horizon3.ai åœ¨ GitHub ä¸Šæä¾›çš„ POC ä»£ç è¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€ç‚¹ã€‚è¯¥POCä»£ç é€šè¿‡ç›´æ¥å‘`/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml`å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚ç»•è¿‡è®¤è¯ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚

**æŠ•æ¯’é£é™©:**

åˆ†ææä¾›çš„ Python POC ä»£ç  (`CVE-2024-0204.py`) å’Œ `README.md` æ–‡ä»¶, å‡ ä¹æ²¡æœ‰å‘ç°æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚è¯¥ä»£ç ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½æ˜ç¡®ï¼Œä¸»è¦ç”¨äºå‘é€ HTTP è¯·æ±‚å¹¶è§£æ HTML å“åº”ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

*   å‚æ•°è§£æï¼šä½¿ç”¨ `argparse` å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬ç›®æ ‡ URLã€ç”¨æˆ·åå’Œå¯†ç ã€‚
*   å¯†ç éªŒè¯ï¼š`validate_password` å‡½æ•°æ£€æŸ¥å¯†ç é•¿åº¦æ˜¯å¦æ»¡è¶³æœ€å°è¦æ±‚ï¼ˆè‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼‰ï¼Œè¿™æ˜¯ GoAnywhere MFT çš„å¯†ç å¤æ‚æ€§è¦æ±‚ã€‚
*   Session ç®¡ç†ï¼šä½¿ç”¨ `requests.session()` åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œä»¥ä¾¿åœ¨è¯·æ±‚ä¹‹é—´ä¿æŒçŠ¶æ€ã€‚
*   ViewState å¤„ç†ï¼šä»åˆå§‹é¡µé¢è·å– `javax.faces.ViewState` å‚æ•°ï¼Œå¹¶åœ¨åç»­çš„ POST è¯·æ±‚ä¸­åŒ…å«å®ƒï¼Œè¿™å¯¹äº JSF åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚
*   é”™è¯¯å¤„ç†ï¼šæ£€æŸ¥ HTTP çŠ¶æ€ç å’Œå“åº”å†…å®¹ï¼Œä»¥æ£€æµ‹æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸã€‚

ä»£ç ä¸­å”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯ `requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`ï¼Œå®ƒç¦ç”¨äº† SSL è¯ä¹¦éªŒè¯è­¦å‘Šã€‚è™½ç„¶åœ¨æµ‹è¯•ç¯å¢ƒä¸‹è¿™å¾ˆå¸¸è§ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨ SSL éªŒè¯å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚ä½†æ˜¯ï¼Œè¿™æœ¬èº«å¹¶ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§æ½œåœ¨çš„å®‰å…¨éšæ‚£ï¼Œåœ¨çœŸå®ç¯å¢ƒä¸­åº”è¯¥é¿å…ã€‚

`README.md` æ–‡ä»¶æä¾›äº†å…³äºæ¼æ´å’Œè„šæœ¬ç”¨æ³•çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶é“¾æ¥åˆ° Horizon3.ai çš„åšå®¢æ–‡ç« ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ä»£ç çš„å¯ä¿¡åº¦ã€‚å…è´£å£°æ˜ä¹Ÿè¡¨æ˜è¯¥å·¥å…·ä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œé˜²å¾¡ç›®çš„ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æˆ–éšè—ä»£ç çš„å¯èƒ½æ€§æä½ã€‚ä½†æ˜¯, ä»ç„¶éœ€è¦å°å¿ƒéªŒè¯ç›®æ ‡URL, é¿å…è¢«ä¸­é—´äººæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡ GoAnywhere MFT å®ä¾‹çš„ç‰ˆæœ¬ä½äº 7.4.1ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 8 ä¸ªå­—ç¬¦ã€‚
3.  è„šæœ¬é¦–å…ˆå‘ `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` å‘é€ GET è¯·æ±‚ã€‚
4.  è„šæœ¬è§£æå“åº”ï¼Œæå– `javax.faces.ViewState` å‚æ•°ã€‚
5.  è„šæœ¬ä½¿ç”¨æå–çš„å‚æ•°å’Œæä¾›çš„ç”¨æˆ·åã€å¯†ç ï¼Œå‘åŒä¸€ URL å‘é€ POST è¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚
6.  å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½•å¹¶å®Œå…¨æ§åˆ¶ GoAnywhere MFT ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [horizon3ai/CVE-2024-0204](https://github.com/horizon3ai/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #4

**æ¥æº**: [CVE-2024-0204-ibrahimsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahimsql_CVE-2024-0204.md)

## CVE-2024-0204-GoAnywhere MFT-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒGoAnywhere MFT 6.0.1åˆ°7.4.0ç‰ˆæœ¬ï¼Œä¸”åˆå§‹è®¾ç½®å‘å¯¼æœªè¢«åˆ é™¤æˆ–ç¦ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0204æ˜¯ä¸€ä¸ªå­˜åœ¨äºFortra GoAnywhere MFT 7.4.1ä¹‹å‰ç‰ˆæœ¬ä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®`InitialAccountSetup.xhtml`é¡µé¢åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚POCä»£ç åˆ©ç”¨è·¯å¾„éå†æ¼æ´è®¿é—®æ­¤é¡µé¢ï¼Œå¹¶æäº¤åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·ä¿¡æ¯çš„POSTè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²å¾—åˆ°ç¡®è®¤ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCä»£ç ã€‚è¯¥POCä»£ç é€šè¿‡æ¨¡æ‹Ÿåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚å‚è€ƒGitHubä¸Šçš„POCï¼Œè¯¥æ¼æ´å¯ä»¥è¢«æˆåŠŸåˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ HTTPè¯·æ±‚æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»£ç ä¸­å­˜åœ¨å˜é‡`PRIMARY_EXPLOIT_PATH`å’Œ`SECONDARY_EXPLOIT_PATH`ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„éå†æ–¹å¼ï¼Œä»¥å¢åŠ æ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¦‚ç‡ã€‚è™½ç„¶ä»£ç å­˜åœ¨æ£€æŸ¥ç›®æ ‡æ˜¯å¦å¯è¾¾çš„æ­¥éª¤ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚è¿™ä¸ªè¯„ä¼°ä¸»è¦æ˜¯åŸºäºä»£ç çš„åŠŸèƒ½å’Œç›®çš„ï¼Œä»¥åŠç¼ºä¹ä»»ä½•æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†ä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œéœ€è¦è¿›è¡Œä»£ç å®¡è®¡å’Œå®‰å…¨æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦è¿è¡Œæ˜“å—æ”»å‡»çš„GoAnywhere MFTç‰ˆæœ¬ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œè¯¥ä»£ç ä¼šå°è¯•é€šè¿‡ä¸åŒçš„è·¯å¾„éå†æŠ€æœ¯è®¿é—®åˆå§‹å¸æˆ·è®¾ç½®é¡µé¢ï¼ˆ`InitialAccountSetup.xhtml`ï¼‰ã€‚
3.  å¦‚æœæˆåŠŸè®¿é—®è¯¥é¡µé¢ï¼ŒPOCä»£ç ä¼šæ„é€ ä¸€ä¸ªåŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ç³»ç»Ÿã€‚
4.  å¦‚æœè¯·æ±‚æˆåŠŸï¼Œåˆ™ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶è¯¥ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ibrahimsql/CVE-2024-0204](https://github.com/ibrahimsql/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #5

**æ¥æº**: [CVE-2024-0204-ibrahmsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahmsql_CVE-2024-0204.md)

# CVE-2024-0204

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0204-adminlove520_CVE-2024-0204.md](../2024/CVE-2024-0204-adminlove520_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡GoAnywhere MFTå®ä¾‹çš„ç‰ˆæœ¬ä½äº7.4.1ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ç®¡ç†ç•Œé¢ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2024-0204 å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·é€šè¿‡ç®¡ç†é—¨æˆ·åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚æä¾›çš„Pythonè„šæœ¬ `CVE-2024-0204.py` åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚è„šæœ¬é¦–å…ˆè·å– `javax.faces.ViewState`ï¼Œç„¶åå°†ç”¨æˆ·åå’Œå¯†ç ä»¥åŠViewStateä¸€å¹¶POSTå‘é€åˆ°ç›®æ ‡URLã€‚è„šæœ¬åŒ…å«å¯†ç å¼ºåº¦éªŒè¯,è¦æ±‚å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä½ã€‚`README.md` æ–‡ä»¶æä¾›äº†è„šæœ¬çš„ä½¿ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šã€‚åœ¨æä¾›çš„ä»£ç ä¸­ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰è¡Œä¸ºéƒ½ä¸åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ä¸€è‡´ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥HTTPçŠ¶æ€ç å’Œé¡µé¢ä¸­çš„é”™è¯¯æ¶ˆæ¯æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸåˆ›å»ºç”¨æˆ·ã€‚è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ç›´æ¥ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**é¡¹ç›®åœ°å€:** [adminlove520/CVE-2024-0204](https://github.com/adminlove520/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #2

**æ¥æº**: [CVE-2024-0204-cbeek-r7_CVE-2024-0204.md](../2024/CVE-2024-0204-cbeek-r7_CVE-2024-0204.md)

## CVE-2024-0204 - GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (6.0.1 <= version < 7.4.1)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ï¼Œç›®æ ‡ç³»ç»Ÿæœªåº”ç”¨è¡¥ä¸æˆ–ç¼“è§£æªæ–½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡è®¿é—® `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥ä½¿æ”»å‡»è€…å®Œå…¨æ§åˆ¶å—å½±å“çš„ GoAnywhere MFT ç³»ç»Ÿã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-0204-scan.py` æ—¨åœ¨é€šè¿‡å‘ç›®æ ‡ IP åœ°å€å‘é€ GET è¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„æ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™ç›®æ ‡è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚å¦‚æœçŠ¶æ€ç ä¸º 401ï¼Œè¡¨ç¤ºå·²ç»ä¿®å¤ã€‚ ç”±äºè¯¥POCä»£ç çš„åŠŸèƒ½æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ›å»ºåé—¨ï¼Œå¹¶ä¸”æœªå‘ç°ä»»ä½•æ¶æ„è¡Œä¸ºï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [cbeek-r7/CVE-2024-0204](https://github.com/cbeek-r7/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #3

**æ¥æº**: [CVE-2024-0204-horizon3ai_CVE-2024-0204.md](../2024/CVE-2024-0204-horizon3ai_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (å½±å“ 6.0.1 åŠä»¥ä¸Šç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT è½¯ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªä¸¥é‡èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ 

**æœ‰æ•ˆæ€§:**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªæ¡ç›® (Rapid7, Kroll, Arctic Wolf, Tenable, Wiz ç­‰) éƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œä»¥åŠåˆ©ç”¨è¯¥æ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·çš„å¯èƒ½æ€§ã€‚Horizon3.ai åœ¨ GitHub ä¸Šæä¾›çš„ POC ä»£ç è¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€ç‚¹ã€‚è¯¥POCä»£ç é€šè¿‡ç›´æ¥å‘`/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml`å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚ç»•è¿‡è®¤è¯ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚

**æŠ•æ¯’é£é™©:**

åˆ†ææä¾›çš„ Python POC ä»£ç  (`CVE-2024-0204.py`) å’Œ `README.md` æ–‡ä»¶, å‡ ä¹æ²¡æœ‰å‘ç°æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚è¯¥ä»£ç ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½æ˜ç¡®ï¼Œä¸»è¦ç”¨äºå‘é€ HTTP è¯·æ±‚å¹¶è§£æ HTML å“åº”ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

*   å‚æ•°è§£æï¼šä½¿ç”¨ `argparse` å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬ç›®æ ‡ URLã€ç”¨æˆ·åå’Œå¯†ç ã€‚
*   å¯†ç éªŒè¯ï¼š`validate_password` å‡½æ•°æ£€æŸ¥å¯†ç é•¿åº¦æ˜¯å¦æ»¡è¶³æœ€å°è¦æ±‚ï¼ˆè‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼‰ï¼Œè¿™æ˜¯ GoAnywhere MFT çš„å¯†ç å¤æ‚æ€§è¦æ±‚ã€‚
*   Session ç®¡ç†ï¼šä½¿ç”¨ `requests.session()` åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œä»¥ä¾¿åœ¨è¯·æ±‚ä¹‹é—´ä¿æŒçŠ¶æ€ã€‚
*   ViewState å¤„ç†ï¼šä»åˆå§‹é¡µé¢è·å– `javax.faces.ViewState` å‚æ•°ï¼Œå¹¶åœ¨åç»­çš„ POST è¯·æ±‚ä¸­åŒ…å«å®ƒï¼Œè¿™å¯¹äº JSF åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚
*   é”™è¯¯å¤„ç†ï¼šæ£€æŸ¥ HTTP çŠ¶æ€ç å’Œå“åº”å†…å®¹ï¼Œä»¥æ£€æµ‹æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸã€‚

ä»£ç ä¸­å”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯ `requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`ï¼Œå®ƒç¦ç”¨äº† SSL è¯ä¹¦éªŒè¯è­¦å‘Šã€‚è™½ç„¶åœ¨æµ‹è¯•ç¯å¢ƒä¸‹è¿™å¾ˆå¸¸è§ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨ SSL éªŒè¯å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚ä½†æ˜¯ï¼Œè¿™æœ¬èº«å¹¶ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§æ½œåœ¨çš„å®‰å…¨éšæ‚£ï¼Œåœ¨çœŸå®ç¯å¢ƒä¸­åº”è¯¥é¿å…ã€‚

`README.md` æ–‡ä»¶æä¾›äº†å…³äºæ¼æ´å’Œè„šæœ¬ç”¨æ³•çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶é“¾æ¥åˆ° Horizon3.ai çš„åšå®¢æ–‡ç« ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ä»£ç çš„å¯ä¿¡åº¦ã€‚å…è´£å£°æ˜ä¹Ÿè¡¨æ˜è¯¥å·¥å…·ä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œé˜²å¾¡ç›®çš„ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æˆ–éšè—ä»£ç çš„å¯èƒ½æ€§æä½ã€‚ä½†æ˜¯, ä»ç„¶éœ€è¦å°å¿ƒéªŒè¯ç›®æ ‡URL, é¿å…è¢«ä¸­é—´äººæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡ GoAnywhere MFT å®ä¾‹çš„ç‰ˆæœ¬ä½äº 7.4.1ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 8 ä¸ªå­—ç¬¦ã€‚
3.  è„šæœ¬é¦–å…ˆå‘ `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` å‘é€ GET è¯·æ±‚ã€‚
4.  è„šæœ¬è§£æå“åº”ï¼Œæå– `javax.faces.ViewState` å‚æ•°ã€‚
5.  è„šæœ¬ä½¿ç”¨æå–çš„å‚æ•°å’Œæä¾›çš„ç”¨æˆ·åã€å¯†ç ï¼Œå‘åŒä¸€ URL å‘é€ POST è¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚
6.  å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½•å¹¶å®Œå…¨æ§åˆ¶ GoAnywhere MFT ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [horizon3ai/CVE-2024-0204](https://github.com/horizon3ai/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #4

**æ¥æº**: [CVE-2024-0204-ibrahimsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahimsql_CVE-2024-0204.md)

## CVE-2024-0204-GoAnywhere MFT-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒGoAnywhere MFT 6.0.1åˆ°7.4.0ç‰ˆæœ¬ï¼Œä¸”åˆå§‹è®¾ç½®å‘å¯¼æœªè¢«åˆ é™¤æˆ–ç¦ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0204æ˜¯ä¸€ä¸ªå­˜åœ¨äºFortra GoAnywhere MFT 7.4.1ä¹‹å‰ç‰ˆæœ¬ä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®`InitialAccountSetup.xhtml`é¡µé¢åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚POCä»£ç åˆ©ç”¨è·¯å¾„éå†æ¼æ´è®¿é—®æ­¤é¡µé¢ï¼Œå¹¶æäº¤åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·ä¿¡æ¯çš„POSTè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²å¾—åˆ°ç¡®è®¤ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCä»£ç ã€‚è¯¥POCä»£ç é€šè¿‡æ¨¡æ‹Ÿåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚å‚è€ƒGitHubä¸Šçš„POCï¼Œè¯¥æ¼æ´å¯ä»¥è¢«æˆåŠŸåˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ HTTPè¯·æ±‚æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»£ç ä¸­å­˜åœ¨å˜é‡`PRIMARY_EXPLOIT_PATH`å’Œ`SECONDARY_EXPLOIT_PATH`ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„éå†æ–¹å¼ï¼Œä»¥å¢åŠ æ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¦‚ç‡ã€‚è™½ç„¶ä»£ç å­˜åœ¨æ£€æŸ¥ç›®æ ‡æ˜¯å¦å¯è¾¾çš„æ­¥éª¤ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚è¿™ä¸ªè¯„ä¼°ä¸»è¦æ˜¯åŸºäºä»£ç çš„åŠŸèƒ½å’Œç›®çš„ï¼Œä»¥åŠç¼ºä¹ä»»ä½•æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†ä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œéœ€è¦è¿›è¡Œä»£ç å®¡è®¡å’Œå®‰å…¨æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦è¿è¡Œæ˜“å—æ”»å‡»çš„GoAnywhere MFTç‰ˆæœ¬ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œè¯¥ä»£ç ä¼šå°è¯•é€šè¿‡ä¸åŒçš„è·¯å¾„éå†æŠ€æœ¯è®¿é—®åˆå§‹å¸æˆ·è®¾ç½®é¡µé¢ï¼ˆ`InitialAccountSetup.xhtml`ï¼‰ã€‚
3.  å¦‚æœæˆåŠŸè®¿é—®è¯¥é¡µé¢ï¼ŒPOCä»£ç ä¼šæ„é€ ä¸€ä¸ªåŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ç³»ç»Ÿã€‚
4.  å¦‚æœè¯·æ±‚æˆåŠŸï¼Œåˆ™ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶è¯¥ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ibrahimsql/CVE-2024-0204](https://github.com/ibrahimsql/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #5

**æ¥æº**: [CVE-2024-0204-ibrahmsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahmsql_CVE-2024-0204.md)

# CVE-2024-0204

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0204-adminlove520_CVE-2024-0204.md](../2024/CVE-2024-0204-adminlove520_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡GoAnywhere MFTå®ä¾‹çš„ç‰ˆæœ¬ä½äº7.4.1ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ç®¡ç†ç•Œé¢ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2024-0204 å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·é€šè¿‡ç®¡ç†é—¨æˆ·åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚æä¾›çš„Pythonè„šæœ¬ `CVE-2024-0204.py` åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚è„šæœ¬é¦–å…ˆè·å– `javax.faces.ViewState`ï¼Œç„¶åå°†ç”¨æˆ·åå’Œå¯†ç ä»¥åŠViewStateä¸€å¹¶POSTå‘é€åˆ°ç›®æ ‡URLã€‚è„šæœ¬åŒ…å«å¯†ç å¼ºåº¦éªŒè¯,è¦æ±‚å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä½ã€‚`README.md` æ–‡ä»¶æä¾›äº†è„šæœ¬çš„ä½¿ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šã€‚åœ¨æä¾›çš„ä»£ç ä¸­ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰è¡Œä¸ºéƒ½ä¸åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ä¸€è‡´ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥HTTPçŠ¶æ€ç å’Œé¡µé¢ä¸­çš„é”™è¯¯æ¶ˆæ¯æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸåˆ›å»ºç”¨æˆ·ã€‚è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ç›´æ¥ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**é¡¹ç›®åœ°å€:** [adminlove520/CVE-2024-0204](https://github.com/adminlove520/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #2

**æ¥æº**: [CVE-2024-0204-cbeek-r7_CVE-2024-0204.md](../2024/CVE-2024-0204-cbeek-r7_CVE-2024-0204.md)

## CVE-2024-0204 - GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (6.0.1 <= version < 7.4.1)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ï¼Œç›®æ ‡ç³»ç»Ÿæœªåº”ç”¨è¡¥ä¸æˆ–ç¼“è§£æªæ–½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡è®¿é—® `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥ä½¿æ”»å‡»è€…å®Œå…¨æ§åˆ¶å—å½±å“çš„ GoAnywhere MFT ç³»ç»Ÿã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-0204-scan.py` æ—¨åœ¨é€šè¿‡å‘ç›®æ ‡ IP åœ°å€å‘é€ GET è¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„æ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™ç›®æ ‡è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚å¦‚æœçŠ¶æ€ç ä¸º 401ï¼Œè¡¨ç¤ºå·²ç»ä¿®å¤ã€‚ ç”±äºè¯¥POCä»£ç çš„åŠŸèƒ½æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ›å»ºåé—¨ï¼Œå¹¶ä¸”æœªå‘ç°ä»»ä½•æ¶æ„è¡Œä¸ºï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [cbeek-r7/CVE-2024-0204](https://github.com/cbeek-r7/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #3

**æ¥æº**: [CVE-2024-0204-horizon3ai_CVE-2024-0204.md](../2024/CVE-2024-0204-horizon3ai_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (å½±å“ 6.0.1 åŠä»¥ä¸Šç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT è½¯ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªä¸¥é‡èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ 

**æœ‰æ•ˆæ€§:**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªæ¡ç›® (Rapid7, Kroll, Arctic Wolf, Tenable, Wiz ç­‰) éƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œä»¥åŠåˆ©ç”¨è¯¥æ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·çš„å¯èƒ½æ€§ã€‚Horizon3.ai åœ¨ GitHub ä¸Šæä¾›çš„ POC ä»£ç è¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€ç‚¹ã€‚è¯¥POCä»£ç é€šè¿‡ç›´æ¥å‘`/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml`å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚ç»•è¿‡è®¤è¯ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚

**æŠ•æ¯’é£é™©:**

åˆ†ææä¾›çš„ Python POC ä»£ç  (`CVE-2024-0204.py`) å’Œ `README.md` æ–‡ä»¶, å‡ ä¹æ²¡æœ‰å‘ç°æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚è¯¥ä»£ç ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½æ˜ç¡®ï¼Œä¸»è¦ç”¨äºå‘é€ HTTP è¯·æ±‚å¹¶è§£æ HTML å“åº”ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

*   å‚æ•°è§£æï¼šä½¿ç”¨ `argparse` å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬ç›®æ ‡ URLã€ç”¨æˆ·åå’Œå¯†ç ã€‚
*   å¯†ç éªŒè¯ï¼š`validate_password` å‡½æ•°æ£€æŸ¥å¯†ç é•¿åº¦æ˜¯å¦æ»¡è¶³æœ€å°è¦æ±‚ï¼ˆè‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼‰ï¼Œè¿™æ˜¯ GoAnywhere MFT çš„å¯†ç å¤æ‚æ€§è¦æ±‚ã€‚
*   Session ç®¡ç†ï¼šä½¿ç”¨ `requests.session()` åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œä»¥ä¾¿åœ¨è¯·æ±‚ä¹‹é—´ä¿æŒçŠ¶æ€ã€‚
*   ViewState å¤„ç†ï¼šä»åˆå§‹é¡µé¢è·å– `javax.faces.ViewState` å‚æ•°ï¼Œå¹¶åœ¨åç»­çš„ POST è¯·æ±‚ä¸­åŒ…å«å®ƒï¼Œè¿™å¯¹äº JSF åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚
*   é”™è¯¯å¤„ç†ï¼šæ£€æŸ¥ HTTP çŠ¶æ€ç å’Œå“åº”å†…å®¹ï¼Œä»¥æ£€æµ‹æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸã€‚

ä»£ç ä¸­å”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯ `requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`ï¼Œå®ƒç¦ç”¨äº† SSL è¯ä¹¦éªŒè¯è­¦å‘Šã€‚è™½ç„¶åœ¨æµ‹è¯•ç¯å¢ƒä¸‹è¿™å¾ˆå¸¸è§ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨ SSL éªŒè¯å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚ä½†æ˜¯ï¼Œè¿™æœ¬èº«å¹¶ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§æ½œåœ¨çš„å®‰å…¨éšæ‚£ï¼Œåœ¨çœŸå®ç¯å¢ƒä¸­åº”è¯¥é¿å…ã€‚

`README.md` æ–‡ä»¶æä¾›äº†å…³äºæ¼æ´å’Œè„šæœ¬ç”¨æ³•çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶é“¾æ¥åˆ° Horizon3.ai çš„åšå®¢æ–‡ç« ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ä»£ç çš„å¯ä¿¡åº¦ã€‚å…è´£å£°æ˜ä¹Ÿè¡¨æ˜è¯¥å·¥å…·ä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œé˜²å¾¡ç›®çš„ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æˆ–éšè—ä»£ç çš„å¯èƒ½æ€§æä½ã€‚ä½†æ˜¯, ä»ç„¶éœ€è¦å°å¿ƒéªŒè¯ç›®æ ‡URL, é¿å…è¢«ä¸­é—´äººæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡ GoAnywhere MFT å®ä¾‹çš„ç‰ˆæœ¬ä½äº 7.4.1ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 8 ä¸ªå­—ç¬¦ã€‚
3.  è„šæœ¬é¦–å…ˆå‘ `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` å‘é€ GET è¯·æ±‚ã€‚
4.  è„šæœ¬è§£æå“åº”ï¼Œæå– `javax.faces.ViewState` å‚æ•°ã€‚
5.  è„šæœ¬ä½¿ç”¨æå–çš„å‚æ•°å’Œæä¾›çš„ç”¨æˆ·åã€å¯†ç ï¼Œå‘åŒä¸€ URL å‘é€ POST è¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚
6.  å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½•å¹¶å®Œå…¨æ§åˆ¶ GoAnywhere MFT ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [horizon3ai/CVE-2024-0204](https://github.com/horizon3ai/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #4

**æ¥æº**: [CVE-2024-0204-ibrahimsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahimsql_CVE-2024-0204.md)

## CVE-2024-0204-GoAnywhere MFT-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒGoAnywhere MFT 6.0.1åˆ°7.4.0ç‰ˆæœ¬ï¼Œä¸”åˆå§‹è®¾ç½®å‘å¯¼æœªè¢«åˆ é™¤æˆ–ç¦ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0204æ˜¯ä¸€ä¸ªå­˜åœ¨äºFortra GoAnywhere MFT 7.4.1ä¹‹å‰ç‰ˆæœ¬ä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®`InitialAccountSetup.xhtml`é¡µé¢åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚POCä»£ç åˆ©ç”¨è·¯å¾„éå†æ¼æ´è®¿é—®æ­¤é¡µé¢ï¼Œå¹¶æäº¤åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·ä¿¡æ¯çš„POSTè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²å¾—åˆ°ç¡®è®¤ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCä»£ç ã€‚è¯¥POCä»£ç é€šè¿‡æ¨¡æ‹Ÿåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚å‚è€ƒGitHubä¸Šçš„POCï¼Œè¯¥æ¼æ´å¯ä»¥è¢«æˆåŠŸåˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ HTTPè¯·æ±‚æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»£ç ä¸­å­˜åœ¨å˜é‡`PRIMARY_EXPLOIT_PATH`å’Œ`SECONDARY_EXPLOIT_PATH`ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„éå†æ–¹å¼ï¼Œä»¥å¢åŠ æ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¦‚ç‡ã€‚è™½ç„¶ä»£ç å­˜åœ¨æ£€æŸ¥ç›®æ ‡æ˜¯å¦å¯è¾¾çš„æ­¥éª¤ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚è¿™ä¸ªè¯„ä¼°ä¸»è¦æ˜¯åŸºäºä»£ç çš„åŠŸèƒ½å’Œç›®çš„ï¼Œä»¥åŠç¼ºä¹ä»»ä½•æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†ä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œéœ€è¦è¿›è¡Œä»£ç å®¡è®¡å’Œå®‰å…¨æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦è¿è¡Œæ˜“å—æ”»å‡»çš„GoAnywhere MFTç‰ˆæœ¬ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œè¯¥ä»£ç ä¼šå°è¯•é€šè¿‡ä¸åŒçš„è·¯å¾„éå†æŠ€æœ¯è®¿é—®åˆå§‹å¸æˆ·è®¾ç½®é¡µé¢ï¼ˆ`InitialAccountSetup.xhtml`ï¼‰ã€‚
3.  å¦‚æœæˆåŠŸè®¿é—®è¯¥é¡µé¢ï¼ŒPOCä»£ç ä¼šæ„é€ ä¸€ä¸ªåŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ç³»ç»Ÿã€‚
4.  å¦‚æœè¯·æ±‚æˆåŠŸï¼Œåˆ™ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶è¯¥ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ibrahimsql/CVE-2024-0204](https://github.com/ibrahimsql/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #5

**æ¥æº**: [CVE-2024-0204-ibrahmsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahmsql_CVE-2024-0204.md)

# CVE-2024-0204

> ğŸ“¦ è¯¥CVEæœ‰ **6** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0204-adminlove520_CVE-2024-0204.md](../2024/CVE-2024-0204-adminlove520_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡GoAnywhere MFTå®ä¾‹çš„ç‰ˆæœ¬ä½äº7.4.1ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ç®¡ç†ç•Œé¢ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2024-0204 å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·é€šè¿‡ç®¡ç†é—¨æˆ·åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚æä¾›çš„Pythonè„šæœ¬ `CVE-2024-0204.py` åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚è„šæœ¬é¦–å…ˆè·å– `javax.faces.ViewState`ï¼Œç„¶åå°†ç”¨æˆ·åå’Œå¯†ç ä»¥åŠViewStateä¸€å¹¶POSTå‘é€åˆ°ç›®æ ‡URLã€‚è„šæœ¬åŒ…å«å¯†ç å¼ºåº¦éªŒè¯,è¦æ±‚å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä½ã€‚`README.md` æ–‡ä»¶æä¾›äº†è„šæœ¬çš„ä½¿ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šã€‚åœ¨æä¾›çš„ä»£ç ä¸­ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰è¡Œä¸ºéƒ½ä¸åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ä¸€è‡´ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥HTTPçŠ¶æ€ç å’Œé¡µé¢ä¸­çš„é”™è¯¯æ¶ˆæ¯æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸåˆ›å»ºç”¨æˆ·ã€‚è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ç›´æ¥ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**é¡¹ç›®åœ°å€:** [adminlove520/CVE-2024-0204](https://github.com/adminlove520/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #2

**æ¥æº**: [CVE-2024-0204-cbeek-r7_CVE-2024-0204.md](../2024/CVE-2024-0204-cbeek-r7_CVE-2024-0204.md)

## CVE-2024-0204 - GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (6.0.1 <= version < 7.4.1)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ï¼Œç›®æ ‡ç³»ç»Ÿæœªåº”ç”¨è¡¥ä¸æˆ–ç¼“è§£æªæ–½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡è®¿é—® `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥ä½¿æ”»å‡»è€…å®Œå…¨æ§åˆ¶å—å½±å“çš„ GoAnywhere MFT ç³»ç»Ÿã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-0204-scan.py` æ—¨åœ¨é€šè¿‡å‘ç›®æ ‡ IP åœ°å€å‘é€ GET è¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„æ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™ç›®æ ‡è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚å¦‚æœçŠ¶æ€ç ä¸º 401ï¼Œè¡¨ç¤ºå·²ç»ä¿®å¤ã€‚ ç”±äºè¯¥POCä»£ç çš„åŠŸèƒ½æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ›å»ºåé—¨ï¼Œå¹¶ä¸”æœªå‘ç°ä»»ä½•æ¶æ„è¡Œä¸ºï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [cbeek-r7/CVE-2024-0204](https://github.com/cbeek-r7/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #3

**æ¥æº**: [CVE-2024-0204-horizon3ai_CVE-2024-0204.md](../2024/CVE-2024-0204-horizon3ai_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (å½±å“ 6.0.1 åŠä»¥ä¸Šç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT è½¯ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªä¸¥é‡èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ 

**æœ‰æ•ˆæ€§:**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªæ¡ç›® (Rapid7, Kroll, Arctic Wolf, Tenable, Wiz ç­‰) éƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œä»¥åŠåˆ©ç”¨è¯¥æ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·çš„å¯èƒ½æ€§ã€‚Horizon3.ai åœ¨ GitHub ä¸Šæä¾›çš„ POC ä»£ç è¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€ç‚¹ã€‚è¯¥POCä»£ç é€šè¿‡ç›´æ¥å‘`/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml`å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚ç»•è¿‡è®¤è¯ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚

**æŠ•æ¯’é£é™©:**

åˆ†ææä¾›çš„ Python POC ä»£ç  (`CVE-2024-0204.py`) å’Œ `README.md` æ–‡ä»¶, å‡ ä¹æ²¡æœ‰å‘ç°æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚è¯¥ä»£ç ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½æ˜ç¡®ï¼Œä¸»è¦ç”¨äºå‘é€ HTTP è¯·æ±‚å¹¶è§£æ HTML å“åº”ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

*   å‚æ•°è§£æï¼šä½¿ç”¨ `argparse` å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬ç›®æ ‡ URLã€ç”¨æˆ·åå’Œå¯†ç ã€‚
*   å¯†ç éªŒè¯ï¼š`validate_password` å‡½æ•°æ£€æŸ¥å¯†ç é•¿åº¦æ˜¯å¦æ»¡è¶³æœ€å°è¦æ±‚ï¼ˆè‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼‰ï¼Œè¿™æ˜¯ GoAnywhere MFT çš„å¯†ç å¤æ‚æ€§è¦æ±‚ã€‚
*   Session ç®¡ç†ï¼šä½¿ç”¨ `requests.session()` åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œä»¥ä¾¿åœ¨è¯·æ±‚ä¹‹é—´ä¿æŒçŠ¶æ€ã€‚
*   ViewState å¤„ç†ï¼šä»åˆå§‹é¡µé¢è·å– `javax.faces.ViewState` å‚æ•°ï¼Œå¹¶åœ¨åç»­çš„ POST è¯·æ±‚ä¸­åŒ…å«å®ƒï¼Œè¿™å¯¹äº JSF åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚
*   é”™è¯¯å¤„ç†ï¼šæ£€æŸ¥ HTTP çŠ¶æ€ç å’Œå“åº”å†…å®¹ï¼Œä»¥æ£€æµ‹æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸã€‚

ä»£ç ä¸­å”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯ `requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`ï¼Œå®ƒç¦ç”¨äº† SSL è¯ä¹¦éªŒè¯è­¦å‘Šã€‚è™½ç„¶åœ¨æµ‹è¯•ç¯å¢ƒä¸‹è¿™å¾ˆå¸¸è§ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨ SSL éªŒè¯å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚ä½†æ˜¯ï¼Œè¿™æœ¬èº«å¹¶ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§æ½œåœ¨çš„å®‰å…¨éšæ‚£ï¼Œåœ¨çœŸå®ç¯å¢ƒä¸­åº”è¯¥é¿å…ã€‚

`README.md` æ–‡ä»¶æä¾›äº†å…³äºæ¼æ´å’Œè„šæœ¬ç”¨æ³•çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶é“¾æ¥åˆ° Horizon3.ai çš„åšå®¢æ–‡ç« ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ä»£ç çš„å¯ä¿¡åº¦ã€‚å…è´£å£°æ˜ä¹Ÿè¡¨æ˜è¯¥å·¥å…·ä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œé˜²å¾¡ç›®çš„ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æˆ–éšè—ä»£ç çš„å¯èƒ½æ€§æä½ã€‚ä½†æ˜¯, ä»ç„¶éœ€è¦å°å¿ƒéªŒè¯ç›®æ ‡URL, é¿å…è¢«ä¸­é—´äººæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡ GoAnywhere MFT å®ä¾‹çš„ç‰ˆæœ¬ä½äº 7.4.1ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 8 ä¸ªå­—ç¬¦ã€‚
3.  è„šæœ¬é¦–å…ˆå‘ `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` å‘é€ GET è¯·æ±‚ã€‚
4.  è„šæœ¬è§£æå“åº”ï¼Œæå– `javax.faces.ViewState` å‚æ•°ã€‚
5.  è„šæœ¬ä½¿ç”¨æå–çš„å‚æ•°å’Œæä¾›çš„ç”¨æˆ·åã€å¯†ç ï¼Œå‘åŒä¸€ URL å‘é€ POST è¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚
6.  å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½•å¹¶å®Œå…¨æ§åˆ¶ GoAnywhere MFT ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [horizon3ai/CVE-2024-0204](https://github.com/horizon3ai/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #4

**æ¥æº**: [CVE-2024-0204-ibrahimsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahimsql_CVE-2024-0204.md)

## CVE-2024-0204-GoAnywhere MFT-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒGoAnywhere MFT 6.0.1åˆ°7.4.0ç‰ˆæœ¬ï¼Œä¸”åˆå§‹è®¾ç½®å‘å¯¼æœªè¢«åˆ é™¤æˆ–ç¦ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0204æ˜¯ä¸€ä¸ªå­˜åœ¨äºFortra GoAnywhere MFT 7.4.1ä¹‹å‰ç‰ˆæœ¬ä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®`InitialAccountSetup.xhtml`é¡µé¢åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚POCä»£ç åˆ©ç”¨è·¯å¾„éå†æ¼æ´è®¿é—®æ­¤é¡µé¢ï¼Œå¹¶æäº¤åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·ä¿¡æ¯çš„POSTè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²å¾—åˆ°ç¡®è®¤ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCä»£ç ã€‚è¯¥POCä»£ç é€šè¿‡æ¨¡æ‹Ÿåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚å‚è€ƒGitHubä¸Šçš„POCï¼Œè¯¥æ¼æ´å¯ä»¥è¢«æˆåŠŸåˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ HTTPè¯·æ±‚æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»£ç ä¸­å­˜åœ¨å˜é‡`PRIMARY_EXPLOIT_PATH`å’Œ`SECONDARY_EXPLOIT_PATH`ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„éå†æ–¹å¼ï¼Œä»¥å¢åŠ æ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¦‚ç‡ã€‚è™½ç„¶ä»£ç å­˜åœ¨æ£€æŸ¥ç›®æ ‡æ˜¯å¦å¯è¾¾çš„æ­¥éª¤ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚è¿™ä¸ªè¯„ä¼°ä¸»è¦æ˜¯åŸºäºä»£ç çš„åŠŸèƒ½å’Œç›®çš„ï¼Œä»¥åŠç¼ºä¹ä»»ä½•æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†ä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œéœ€è¦è¿›è¡Œä»£ç å®¡è®¡å’Œå®‰å…¨æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦è¿è¡Œæ˜“å—æ”»å‡»çš„GoAnywhere MFTç‰ˆæœ¬ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œè¯¥ä»£ç ä¼šå°è¯•é€šè¿‡ä¸åŒçš„è·¯å¾„éå†æŠ€æœ¯è®¿é—®åˆå§‹å¸æˆ·è®¾ç½®é¡µé¢ï¼ˆ`InitialAccountSetup.xhtml`ï¼‰ã€‚
3.  å¦‚æœæˆåŠŸè®¿é—®è¯¥é¡µé¢ï¼ŒPOCä»£ç ä¼šæ„é€ ä¸€ä¸ªåŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ç³»ç»Ÿã€‚
4.  å¦‚æœè¯·æ±‚æˆåŠŸï¼Œåˆ™ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶è¯¥ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ibrahimsql/CVE-2024-0204](https://github.com/ibrahimsql/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #5

**æ¥æº**: [CVE-2024-0204-ibrahmsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahmsql_CVE-2024-0204.md)

# CVE-2024-0204

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-0204-adminlove520_CVE-2024-0204.md](../2024/CVE-2024-0204-adminlove520_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡GoAnywhere MFTå®ä¾‹çš„ç‰ˆæœ¬ä½äº7.4.1ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ç®¡ç†ç•Œé¢ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼ŒCVE-2024-0204 å…è®¸æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·é€šè¿‡ç®¡ç†é—¨æˆ·åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚æä¾›çš„Pythonè„šæœ¬ `CVE-2024-0204.py` åˆ©ç”¨æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„ï¼Œç»•è¿‡èº«ä»½éªŒè¯å¹¶åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚è„šæœ¬é¦–å…ˆè·å– `javax.faces.ViewState`ï¼Œç„¶åå°†ç”¨æˆ·åå’Œå¯†ç ä»¥åŠViewStateä¸€å¹¶POSTå‘é€åˆ°ç›®æ ‡URLã€‚è„šæœ¬åŒ…å«å¯†ç å¼ºåº¦éªŒè¯,è¦æ±‚å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä½ã€‚`README.md` æ–‡ä»¶æä¾›äº†è„šæœ¬çš„ä½¿ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šã€‚åœ¨æä¾›çš„ä»£ç ä¸­ï¼Œæœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰è¡Œä¸ºéƒ½ä¸åˆ©ç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ä¸€è‡´ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥HTTPçŠ¶æ€ç å’Œé¡µé¢ä¸­çš„é”™è¯¯æ¶ˆæ¯æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸåˆ›å»ºç”¨æˆ·ã€‚è¯¥æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ç›´æ¥ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**é¡¹ç›®åœ°å€:** [adminlove520/CVE-2024-0204](https://github.com/adminlove520/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #2

**æ¥æº**: [CVE-2024-0204-cbeek-r7_CVE-2024-0204.md](../2024/CVE-2024-0204-cbeek-r7_CVE-2024-0204.md)

## CVE-2024-0204 - GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (6.0.1 <= version < 7.4.1)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ï¼Œç›®æ ‡ç³»ç»Ÿæœªåº”ç”¨è¡¥ä¸æˆ–ç¼“è§£æªæ–½

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡è®¿é—® `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥ä½¿æ”»å‡»è€…å®Œå…¨æ§åˆ¶å—å½±å“çš„ GoAnywhere MFT ç³»ç»Ÿã€‚æ¼æ´åˆ©ç”¨ä»£ç  `CVE-2024-0204-scan.py` æ—¨åœ¨é€šè¿‡å‘ç›®æ ‡ IP åœ°å€å‘é€ GET è¯·æ±‚åˆ° `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` è·¯å¾„æ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™ç›®æ ‡è¢«è®¤ä¸ºæ˜¯æ˜“å—æ”»å‡»çš„ã€‚å¦‚æœçŠ¶æ€ç ä¸º 401ï¼Œè¡¨ç¤ºå·²ç»ä¿®å¤ã€‚ ç”±äºè¯¥POCä»£ç çš„åŠŸèƒ½æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ›å»ºåé—¨ï¼Œå¹¶ä¸”æœªå‘ç°ä»»ä½•æ¶æ„è¡Œä¸ºï¼Œå› æ­¤åˆ¤å®šæŠ•æ¯’é£é™©ä¸º0%ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [cbeek-r7/CVE-2024-0204](https://github.com/cbeek-r7/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #3

**æ¥æº**: [CVE-2024-0204-horizon3ai_CVE-2024-0204.md](../2024/CVE-2024-0204-horizon3ai_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1 (å½±å“ 6.0.1 åŠä»¥ä¸Šç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—® GoAnywhere MFT çš„ç®¡ç†æ§åˆ¶å°ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT è½¯ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªä¸¥é‡èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ 

**æœ‰æ•ˆæ€§:**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªæ¡ç›® (Rapid7, Kroll, Arctic Wolf, Tenable, Wiz ç­‰) éƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œä»¥åŠåˆ©ç”¨è¯¥æ¼æ´åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·çš„å¯èƒ½æ€§ã€‚Horizon3.ai åœ¨ GitHub ä¸Šæä¾›çš„ POC ä»£ç è¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€ç‚¹ã€‚è¯¥POCä»£ç é€šè¿‡ç›´æ¥å‘`/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml`å‘é€ç²¾å¿ƒæ„é€ çš„POSTè¯·æ±‚ç»•è¿‡è®¤è¯ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚

**æŠ•æ¯’é£é™©:**

åˆ†ææä¾›çš„ Python POC ä»£ç  (`CVE-2024-0204.py`) å’Œ `README.md` æ–‡ä»¶, å‡ ä¹æ²¡æœ‰å‘ç°æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚è¯¥ä»£ç ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½æ˜ç¡®ï¼Œä¸»è¦ç”¨äºå‘é€ HTTP è¯·æ±‚å¹¶è§£æ HTML å“åº”ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

*   å‚æ•°è§£æï¼šä½¿ç”¨ `argparse` å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬ç›®æ ‡ URLã€ç”¨æˆ·åå’Œå¯†ç ã€‚
*   å¯†ç éªŒè¯ï¼š`validate_password` å‡½æ•°æ£€æŸ¥å¯†ç é•¿åº¦æ˜¯å¦æ»¡è¶³æœ€å°è¦æ±‚ï¼ˆè‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼‰ï¼Œè¿™æ˜¯ GoAnywhere MFT çš„å¯†ç å¤æ‚æ€§è¦æ±‚ã€‚
*   Session ç®¡ç†ï¼šä½¿ç”¨ `requests.session()` åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œä»¥ä¾¿åœ¨è¯·æ±‚ä¹‹é—´ä¿æŒçŠ¶æ€ã€‚
*   ViewState å¤„ç†ï¼šä»åˆå§‹é¡µé¢è·å– `javax.faces.ViewState` å‚æ•°ï¼Œå¹¶åœ¨åç»­çš„ POST è¯·æ±‚ä¸­åŒ…å«å®ƒï¼Œè¿™å¯¹äº JSF åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚
*   é”™è¯¯å¤„ç†ï¼šæ£€æŸ¥ HTTP çŠ¶æ€ç å’Œå“åº”å†…å®¹ï¼Œä»¥æ£€æµ‹æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸã€‚

ä»£ç ä¸­å”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯ `requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`ï¼Œå®ƒç¦ç”¨äº† SSL è¯ä¹¦éªŒè¯è­¦å‘Šã€‚è™½ç„¶åœ¨æµ‹è¯•ç¯å¢ƒä¸‹è¿™å¾ˆå¸¸è§ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨ SSL éªŒè¯å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚ä½†æ˜¯ï¼Œè¿™æœ¬èº«å¹¶ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§æ½œåœ¨çš„å®‰å…¨éšæ‚£ï¼Œåœ¨çœŸå®ç¯å¢ƒä¸­åº”è¯¥é¿å…ã€‚

`README.md` æ–‡ä»¶æä¾›äº†å…³äºæ¼æ´å’Œè„šæœ¬ç”¨æ³•çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶é“¾æ¥åˆ° Horizon3.ai çš„åšå®¢æ–‡ç« ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ä»£ç çš„å¯ä¿¡åº¦ã€‚å…è´£å£°æ˜ä¹Ÿè¡¨æ˜è¯¥å·¥å…·ä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œé˜²å¾¡ç›®çš„ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æˆ–éšè—ä»£ç çš„å¯èƒ½æ€§æä½ã€‚ä½†æ˜¯, ä»ç„¶éœ€è¦å°å¿ƒéªŒè¯ç›®æ ‡URL, é¿å…è¢«ä¸­é—´äººæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡ GoAnywhere MFT å®ä¾‹çš„ç‰ˆæœ¬ä½äº 7.4.1ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCè„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 8 ä¸ªå­—ç¬¦ã€‚
3.  è„šæœ¬é¦–å…ˆå‘ `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` å‘é€ GET è¯·æ±‚ã€‚
4.  è„šæœ¬è§£æå“åº”ï¼Œæå– `javax.faces.ViewState` å‚æ•°ã€‚
5.  è„šæœ¬ä½¿ç”¨æå–çš„å‚æ•°å’Œæä¾›çš„ç”¨æˆ·åã€å¯†ç ï¼Œå‘åŒä¸€ URL å‘é€ POST è¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚
6.  å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ”»å‡»è€…ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½•å¹¶å®Œå…¨æ§åˆ¶ GoAnywhere MFT ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [horizon3ai/CVE-2024-0204](https://github.com/horizon3ai/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #4

**æ¥æº**: [CVE-2024-0204-ibrahimsql_CVE-2024-0204.md](../2024/CVE-2024-0204-ibrahimsql_CVE-2024-0204.md)

## CVE-2024-0204-GoAnywhere MFT-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒGoAnywhere MFT 6.0.1åˆ°7.4.0ç‰ˆæœ¬ï¼Œä¸”åˆå§‹è®¾ç½®å‘å¯¼æœªè¢«åˆ é™¤æˆ–ç¦ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-0204æ˜¯ä¸€ä¸ªå­˜åœ¨äºFortra GoAnywhere MFT 7.4.1ä¹‹å‰ç‰ˆæœ¬ä¸­çš„èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®`InitialAccountSetup.xhtml`é¡µé¢åˆ›å»ºç®¡ç†å‘˜å¸æˆ·ã€‚POCä»£ç åˆ©ç”¨è·¯å¾„éå†æ¼æ´è®¿é—®æ­¤é¡µé¢ï¼Œå¹¶æäº¤åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·ä¿¡æ¯çš„POSTè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²å¾—åˆ°ç¡®è®¤ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€å¯ç”¨çš„POCä»£ç ã€‚è¯¥POCä»£ç é€šè¿‡æ¨¡æ‹Ÿåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·çš„HTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚å‚è€ƒGitHubä¸Šçš„POCï¼Œè¯¥æ¼æ´å¯ä»¥è¢«æˆåŠŸåˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§é«˜ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦é€šè¿‡æ„é€ HTTPè¯·æ±‚æ¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ã€‚ä»£ç ä¸­å­˜åœ¨å˜é‡`PRIMARY_EXPLOIT_PATH`å’Œ`SECONDARY_EXPLOIT_PATH`ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„éå†æ–¹å¼ï¼Œä»¥å¢åŠ æ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¦‚ç‡ã€‚è™½ç„¶ä»£ç å­˜åœ¨æ£€æŸ¥ç›®æ ‡æ˜¯å¦å¯è¾¾çš„æ­¥éª¤ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚è¿™ä¸ªè¯„ä¼°ä¸»è¦æ˜¯åŸºäºä»£ç çš„åŠŸèƒ½å’Œç›®çš„ï¼Œä»¥åŠç¼ºä¹ä»»ä½•æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†ä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œéœ€è¦è¿›è¡Œä»£ç å®¡è®¡å’Œå®‰å…¨æµ‹è¯•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦è¿è¡Œæ˜“å—æ”»å‡»çš„GoAnywhere MFTç‰ˆæœ¬ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼Œè¯¥ä»£ç ä¼šå°è¯•é€šè¿‡ä¸åŒçš„è·¯å¾„éå†æŠ€æœ¯è®¿é—®åˆå§‹å¸æˆ·è®¾ç½®é¡µé¢ï¼ˆ`InitialAccountSetup.xhtml`ï¼‰ã€‚
3.  å¦‚æœæˆåŠŸè®¿é—®è¯¥é¡µé¢ï¼ŒPOCä»£ç ä¼šæ„é€ ä¸€ä¸ªåŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç çš„POSTè¯·æ±‚ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ç³»ç»Ÿã€‚
4.  å¦‚æœè¯·æ±‚æˆåŠŸï¼Œåˆ™ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜å¸æˆ·ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶è¯¥ç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [ibrahimsql/CVE-2024-0204](https://github.com/ibrahimsql/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

## POC #5

**æ¥æº**: [CVE-2024-0204-m-cetin_CVE-2024-0204.md](../2024/CVE-2024-0204-m-cetin_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®GoAnywhere MFTçš„ç®¡ç†é—¨æˆ·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚æ­¤æ¼æ´å½±å“ GoAnywhere MFT 7.4.1 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´ï¼š

1.  æ„é€ è¯·æ±‚æ¥è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ã€‚
2.  æå–é¡µé¢ä¸­çš„ `javax.faces.ViewState` å€¼ï¼Œè¿™æ˜¯ JSF æ¡†æ¶ç”¨äºç»´æŠ¤æœåŠ¡å™¨ç«¯çŠ¶æ€çš„éšè—å­—æ®µã€‚
3.  æ„é€  POST è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠä¸Šä¸€æ­¥æå–çš„ `ViewState` å€¼ã€‚
4.  å‘é€æ­¤ POST è¯·æ±‚åˆ° `InitialAccountSetup.xhtml` é¡µé¢ã€‚
5.  å¦‚æœæˆåŠŸï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç æœ¬èº«çœ‹èµ·æ¥ç›¸å¯¹ç®€å•å’Œç›´æ¥ã€‚`generate_random_string`å‡½æ•°ç”¨äºç”Ÿæˆéšæœºçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé™ä½äº†åˆ©ç”¨çš„ç¡®å®šæ€§ï¼Œä½†æ˜¯æé«˜äº†éšè”½æ€§ã€‚`ensure_https`å‡½æ•°å¼ºåˆ¶ä½¿ç”¨HTTPSåè®®ï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨æœ€ä½³å®è·µï¼Œä½†å¯èƒ½è¢«è§£é‡Šä¸ºä¸€ç§å¼ºåˆ¶æµé‡åŠ å¯†ä»è€Œéšè—æ¶æ„è¡Œä¸ºçš„æ–¹å¼ã€‚å¯¹`InsecureRequestWarning`çš„ç¦ç”¨å¯èƒ½è¢«åˆ©ç”¨,ä½†å±äºpocä»£ç éªŒè¯ç¯èŠ‚å¿…è¦æ“ä½œ,ä¸æ˜¯æŠ•æ¯’è¡Œä¸º.

*   **ä½æ¦‚ç‡æŠ•æ¯’ï¼š** ä»£ç ä¸­å”¯ä¸€å¯ç–‘çš„åœ°æ–¹æ˜¯å¼ºåˆ¶HTTPSå’Œç¦ç”¨`InsecureRequestWarning`ï¼Œå°½ç®¡è¿™ä¸æ˜¯ç›´æ¥çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†å¯èƒ½ä½¿æŸäº›æ¶æ„åˆ©ç”¨åœºæ™¯æ›´éš¾è¢«æ£€æµ‹ã€‚æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š** æ‰¾åˆ°è¿è¡Œç€æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„ GoAnywhere MFT çš„æœåŠ¡å™¨ã€‚
2.  **é¡µé¢è®¿é—®ï¼š** è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ï¼Œé€šå¸¸æ— éœ€èº«ä»½éªŒè¯ã€‚
3.  **ViewState è·å–ï¼š** ä»é¡µé¢HTMLæºç æå– `javax.faces.ViewState` å‚æ•°ã€‚
4.  **ç”¨æˆ·åˆ›å»ºï¼š** ä½¿ç”¨ POST è¯·æ±‚ï¼Œå°†åŒ…å« ViewState å’Œæ–°ç®¡ç†å‘˜å¸æˆ·è¯¦ç»†ä¿¡æ¯çš„ payload å‘é€åˆ° `InitialAccountSetup.xhtml`ã€‚
5.  **æƒé™è·å–ï¼š** ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½• GoAnywhere MFT ç®¡ç†æ§åˆ¶å°å¹¶è·å–å®Œå…¨æ§åˆ¶æƒã€‚

**é¡¹ç›®åœ°å€:** [m-cetin/CVE-2024-0204](https://github.com/m-cetin/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---



---

## POC #6

**æ¥æº**: [CVE-2024-0204-m-cetin_CVE-2024-0204.md](../2024/CVE-2024-0204-m-cetin_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®GoAnywhere MFTçš„ç®¡ç†é—¨æˆ·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚æ­¤æ¼æ´å½±å“ GoAnywhere MFT 7.4.1 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´ï¼š

1.  æ„é€ è¯·æ±‚æ¥è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ã€‚
2.  æå–é¡µé¢ä¸­çš„ `javax.faces.ViewState` å€¼ï¼Œè¿™æ˜¯ JSF æ¡†æ¶ç”¨äºç»´æŠ¤æœåŠ¡å™¨ç«¯çŠ¶æ€çš„éšè—å­—æ®µã€‚
3.  æ„é€  POST è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠä¸Šä¸€æ­¥æå–çš„ `ViewState` å€¼ã€‚
4.  å‘é€æ­¤ POST è¯·æ±‚åˆ° `InitialAccountSetup.xhtml` é¡µé¢ã€‚
5.  å¦‚æœæˆåŠŸï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç æœ¬èº«çœ‹èµ·æ¥ç›¸å¯¹ç®€å•å’Œç›´æ¥ã€‚`generate_random_string`å‡½æ•°ç”¨äºç”Ÿæˆéšæœºçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé™ä½äº†åˆ©ç”¨çš„ç¡®å®šæ€§ï¼Œä½†æ˜¯æé«˜äº†éšè”½æ€§ã€‚`ensure_https`å‡½æ•°å¼ºåˆ¶ä½¿ç”¨HTTPSåè®®ï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨æœ€ä½³å®è·µï¼Œä½†å¯èƒ½è¢«è§£é‡Šä¸ºä¸€ç§å¼ºåˆ¶æµé‡åŠ å¯†ä»è€Œéšè—æ¶æ„è¡Œä¸ºçš„æ–¹å¼ã€‚å¯¹`InsecureRequestWarning`çš„ç¦ç”¨å¯èƒ½è¢«åˆ©ç”¨,ä½†å±äºpocä»£ç éªŒè¯ç¯èŠ‚å¿…è¦æ“ä½œ,ä¸æ˜¯æŠ•æ¯’è¡Œä¸º.

*   **ä½æ¦‚ç‡æŠ•æ¯’ï¼š** ä»£ç ä¸­å”¯ä¸€å¯ç–‘çš„åœ°æ–¹æ˜¯å¼ºåˆ¶HTTPSå’Œç¦ç”¨`InsecureRequestWarning`ï¼Œå°½ç®¡è¿™ä¸æ˜¯ç›´æ¥çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†å¯èƒ½ä½¿æŸäº›æ¶æ„åˆ©ç”¨åœºæ™¯æ›´éš¾è¢«æ£€æµ‹ã€‚æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š** æ‰¾åˆ°è¿è¡Œç€æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„ GoAnywhere MFT çš„æœåŠ¡å™¨ã€‚
2.  **é¡µé¢è®¿é—®ï¼š** è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ï¼Œé€šå¸¸æ— éœ€èº«ä»½éªŒè¯ã€‚
3.  **ViewState è·å–ï¼š** ä»é¡µé¢HTMLæºç æå– `javax.faces.ViewState` å‚æ•°ã€‚
4.  **ç”¨æˆ·åˆ›å»ºï¼š** ä½¿ç”¨ POST è¯·æ±‚ï¼Œå°†åŒ…å« ViewState å’Œæ–°ç®¡ç†å‘˜å¸æˆ·è¯¦ç»†ä¿¡æ¯çš„ payload å‘é€åˆ° `InitialAccountSetup.xhtml`ã€‚
5.  **æƒé™è·å–ï¼š** ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½• GoAnywhere MFT ç®¡ç†æ§åˆ¶å°å¹¶è·å–å®Œå…¨æ§åˆ¶æƒã€‚

**é¡¹ç›®åœ°å€:** [m-cetin/CVE-2024-0204](https://github.com/m-cetin/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---



---

## POC #6

**æ¥æº**: [CVE-2024-0204-m-cetin_CVE-2024-0204.md](../2024/CVE-2024-0204-m-cetin_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®GoAnywhere MFTçš„ç®¡ç†é—¨æˆ·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚æ­¤æ¼æ´å½±å“ GoAnywhere MFT 7.4.1 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´ï¼š

1.  æ„é€ è¯·æ±‚æ¥è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ã€‚
2.  æå–é¡µé¢ä¸­çš„ `javax.faces.ViewState` å€¼ï¼Œè¿™æ˜¯ JSF æ¡†æ¶ç”¨äºç»´æŠ¤æœåŠ¡å™¨ç«¯çŠ¶æ€çš„éšè—å­—æ®µã€‚
3.  æ„é€  POST è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠä¸Šä¸€æ­¥æå–çš„ `ViewState` å€¼ã€‚
4.  å‘é€æ­¤ POST è¯·æ±‚åˆ° `InitialAccountSetup.xhtml` é¡µé¢ã€‚
5.  å¦‚æœæˆåŠŸï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç æœ¬èº«çœ‹èµ·æ¥ç›¸å¯¹ç®€å•å’Œç›´æ¥ã€‚`generate_random_string`å‡½æ•°ç”¨äºç”Ÿæˆéšæœºçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé™ä½äº†åˆ©ç”¨çš„ç¡®å®šæ€§ï¼Œä½†æ˜¯æé«˜äº†éšè”½æ€§ã€‚`ensure_https`å‡½æ•°å¼ºåˆ¶ä½¿ç”¨HTTPSåè®®ï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨æœ€ä½³å®è·µï¼Œä½†å¯èƒ½è¢«è§£é‡Šä¸ºä¸€ç§å¼ºåˆ¶æµé‡åŠ å¯†ä»è€Œéšè—æ¶æ„è¡Œä¸ºçš„æ–¹å¼ã€‚å¯¹`InsecureRequestWarning`çš„ç¦ç”¨å¯èƒ½è¢«åˆ©ç”¨,ä½†å±äºpocä»£ç éªŒè¯ç¯èŠ‚å¿…è¦æ“ä½œ,ä¸æ˜¯æŠ•æ¯’è¡Œä¸º.

*   **ä½æ¦‚ç‡æŠ•æ¯’ï¼š** ä»£ç ä¸­å”¯ä¸€å¯ç–‘çš„åœ°æ–¹æ˜¯å¼ºåˆ¶HTTPSå’Œç¦ç”¨`InsecureRequestWarning`ï¼Œå°½ç®¡è¿™ä¸æ˜¯ç›´æ¥çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†å¯èƒ½ä½¿æŸäº›æ¶æ„åˆ©ç”¨åœºæ™¯æ›´éš¾è¢«æ£€æµ‹ã€‚æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š** æ‰¾åˆ°è¿è¡Œç€æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„ GoAnywhere MFT çš„æœåŠ¡å™¨ã€‚
2.  **é¡µé¢è®¿é—®ï¼š** è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ï¼Œé€šå¸¸æ— éœ€èº«ä»½éªŒè¯ã€‚
3.  **ViewState è·å–ï¼š** ä»é¡µé¢HTMLæºç æå– `javax.faces.ViewState` å‚æ•°ã€‚
4.  **ç”¨æˆ·åˆ›å»ºï¼š** ä½¿ç”¨ POST è¯·æ±‚ï¼Œå°†åŒ…å« ViewState å’Œæ–°ç®¡ç†å‘˜å¸æˆ·è¯¦ç»†ä¿¡æ¯çš„ payload å‘é€åˆ° `InitialAccountSetup.xhtml`ã€‚
5.  **æƒé™è·å–ï¼š** ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½• GoAnywhere MFT ç®¡ç†æ§åˆ¶å°å¹¶è·å–å®Œå…¨æ§åˆ¶æƒã€‚

**é¡¹ç›®åœ°å€:** [m-cetin/CVE-2024-0204](https://github.com/m-cetin/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---



---

## POC #6

**æ¥æº**: [CVE-2024-0204-m-cetin_CVE-2024-0204.md](../2024/CVE-2024-0204-m-cetin_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®GoAnywhere MFTçš„ç®¡ç†é—¨æˆ·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚æ­¤æ¼æ´å½±å“ GoAnywhere MFT 7.4.1 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´ï¼š

1.  æ„é€ è¯·æ±‚æ¥è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ã€‚
2.  æå–é¡µé¢ä¸­çš„ `javax.faces.ViewState` å€¼ï¼Œè¿™æ˜¯ JSF æ¡†æ¶ç”¨äºç»´æŠ¤æœåŠ¡å™¨ç«¯çŠ¶æ€çš„éšè—å­—æ®µã€‚
3.  æ„é€  POST è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠä¸Šä¸€æ­¥æå–çš„ `ViewState` å€¼ã€‚
4.  å‘é€æ­¤ POST è¯·æ±‚åˆ° `InitialAccountSetup.xhtml` é¡µé¢ã€‚
5.  å¦‚æœæˆåŠŸï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç æœ¬èº«çœ‹èµ·æ¥ç›¸å¯¹ç®€å•å’Œç›´æ¥ã€‚`generate_random_string`å‡½æ•°ç”¨äºç”Ÿæˆéšæœºçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé™ä½äº†åˆ©ç”¨çš„ç¡®å®šæ€§ï¼Œä½†æ˜¯æé«˜äº†éšè”½æ€§ã€‚`ensure_https`å‡½æ•°å¼ºåˆ¶ä½¿ç”¨HTTPSåè®®ï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨æœ€ä½³å®è·µï¼Œä½†å¯èƒ½è¢«è§£é‡Šä¸ºä¸€ç§å¼ºåˆ¶æµé‡åŠ å¯†ä»è€Œéšè—æ¶æ„è¡Œä¸ºçš„æ–¹å¼ã€‚å¯¹`InsecureRequestWarning`çš„ç¦ç”¨å¯èƒ½è¢«åˆ©ç”¨,ä½†å±äºpocä»£ç éªŒè¯ç¯èŠ‚å¿…è¦æ“ä½œ,ä¸æ˜¯æŠ•æ¯’è¡Œä¸º.

*   **ä½æ¦‚ç‡æŠ•æ¯’ï¼š** ä»£ç ä¸­å”¯ä¸€å¯ç–‘çš„åœ°æ–¹æ˜¯å¼ºåˆ¶HTTPSå’Œç¦ç”¨`InsecureRequestWarning`ï¼Œå°½ç®¡è¿™ä¸æ˜¯ç›´æ¥çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†å¯èƒ½ä½¿æŸäº›æ¶æ„åˆ©ç”¨åœºæ™¯æ›´éš¾è¢«æ£€æµ‹ã€‚æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š** æ‰¾åˆ°è¿è¡Œç€æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„ GoAnywhere MFT çš„æœåŠ¡å™¨ã€‚
2.  **é¡µé¢è®¿é—®ï¼š** è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ï¼Œé€šå¸¸æ— éœ€èº«ä»½éªŒè¯ã€‚
3.  **ViewState è·å–ï¼š** ä»é¡µé¢HTMLæºç æå– `javax.faces.ViewState` å‚æ•°ã€‚
4.  **ç”¨æˆ·åˆ›å»ºï¼š** ä½¿ç”¨ POST è¯·æ±‚ï¼Œå°†åŒ…å« ViewState å’Œæ–°ç®¡ç†å‘˜å¸æˆ·è¯¦ç»†ä¿¡æ¯çš„ payload å‘é€åˆ° `InitialAccountSetup.xhtml`ã€‚
5.  **æƒé™è·å–ï¼š** ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½• GoAnywhere MFT ç®¡ç†æ§åˆ¶å°å¹¶è·å–å®Œå…¨æ§åˆ¶æƒã€‚

**é¡¹ç›®åœ°å€:** [m-cetin/CVE-2024-0204](https://github.com/m-cetin/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---



---

## POC #6

**æ¥æº**: [CVE-2024-0204-m-cetin_CVE-2024-0204.md](../2024/CVE-2024-0204-m-cetin_CVE-2024-0204.md)

## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**æ¼æ´ç¼–å·:** CVE-2024-0204

**æ¼æ´ç±»å‹:** Authentication Bypass

**å½±å“åº”ç”¨:** GoAnywhere MFT

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** < 7.4.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®GoAnywhere MFTçš„ç®¡ç†é—¨æˆ·ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-0204 æ˜¯ Fortra GoAnywhere MFT ä¸­å­˜åœ¨çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚æ­¤æ¼æ´å½±å“ GoAnywhere MFT 7.4.1 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¯¥æ¼æ´ï¼š

1.  æ„é€ è¯·æ±‚æ¥è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ã€‚
2.  æå–é¡µé¢ä¸­çš„ `javax.faces.ViewState` å€¼ï¼Œè¿™æ˜¯ JSF æ¡†æ¶ç”¨äºç»´æŠ¤æœåŠ¡å™¨ç«¯çŠ¶æ€çš„éšè—å­—æ®µã€‚
3.  æ„é€  POST è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ–°ç®¡ç†å‘˜ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠä¸Šä¸€æ­¥æå–çš„ `ViewState` å€¼ã€‚
4.  å‘é€æ­¤ POST è¯·æ±‚åˆ° `InitialAccountSetup.xhtml` é¡µé¢ã€‚
5.  å¦‚æœæˆåŠŸï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç æœ¬èº«çœ‹èµ·æ¥ç›¸å¯¹ç®€å•å’Œç›´æ¥ã€‚`generate_random_string`å‡½æ•°ç”¨äºç”Ÿæˆéšæœºçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé™ä½äº†åˆ©ç”¨çš„ç¡®å®šæ€§ï¼Œä½†æ˜¯æé«˜äº†éšè”½æ€§ã€‚`ensure_https`å‡½æ•°å¼ºåˆ¶ä½¿ç”¨HTTPSåè®®ï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨æœ€ä½³å®è·µï¼Œä½†å¯èƒ½è¢«è§£é‡Šä¸ºä¸€ç§å¼ºåˆ¶æµé‡åŠ å¯†ä»è€Œéšè—æ¶æ„è¡Œä¸ºçš„æ–¹å¼ã€‚å¯¹`InsecureRequestWarning`çš„ç¦ç”¨å¯èƒ½è¢«åˆ©ç”¨,ä½†å±äºpocä»£ç éªŒè¯ç¯èŠ‚å¿…è¦æ“ä½œ,ä¸æ˜¯æŠ•æ¯’è¡Œä¸º.

*   **ä½æ¦‚ç‡æŠ•æ¯’ï¼š** ä»£ç ä¸­å”¯ä¸€å¯ç–‘çš„åœ°æ–¹æ˜¯å¼ºåˆ¶HTTPSå’Œç¦ç”¨`InsecureRequestWarning`ï¼Œå°½ç®¡è¿™ä¸æ˜¯ç›´æ¥çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†å¯èƒ½ä½¿æŸäº›æ¶æ„åˆ©ç”¨åœºæ™¯æ›´éš¾è¢«æ£€æµ‹ã€‚æ€»çš„æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç›®æ ‡è¯†åˆ«ï¼š** æ‰¾åˆ°è¿è¡Œç€æ˜“å—æ”»å‡»ç‰ˆæœ¬çš„ GoAnywhere MFT çš„æœåŠ¡å™¨ã€‚
2.  **é¡µé¢è®¿é—®ï¼š** è®¿é—® `InitialAccountSetup.xhtml` é¡µé¢ï¼Œé€šå¸¸æ— éœ€èº«ä»½éªŒè¯ã€‚
3.  **ViewState è·å–ï¼š** ä»é¡µé¢HTMLæºç æå– `javax.faces.ViewState` å‚æ•°ã€‚
4.  **ç”¨æˆ·åˆ›å»ºï¼š** ä½¿ç”¨ POST è¯·æ±‚ï¼Œå°†åŒ…å« ViewState å’Œæ–°ç®¡ç†å‘˜å¸æˆ·è¯¦ç»†ä¿¡æ¯çš„ payload å‘é€åˆ° `InitialAccountSetup.xhtml`ã€‚
5.  **æƒé™è·å–ï¼š** ä½¿ç”¨æ–°åˆ›å»ºçš„ç®¡ç†å‘˜å¸æˆ·ç™»å½• GoAnywhere MFT ç®¡ç†æ§åˆ¶å°å¹¶è·å–å®Œå…¨æ§åˆ¶æƒã€‚

**é¡¹ç›®åœ°å€:** [m-cetin/CVE-2024-0204](https://github.com/m-cetin/CVE-2024-0204)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)

---

