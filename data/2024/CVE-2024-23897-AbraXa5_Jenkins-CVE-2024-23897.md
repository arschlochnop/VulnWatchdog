# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **31** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-AbraXa5_Jenkins-CVE-2024-23897.md)

# CVE-2024-23897

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #2

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---



---

## POC #2

**来源**: [CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md](../2024/CVE-2024-23897-B4CK4TT4CK_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #3

**来源**: [CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md](../2024/CVE-2024-23897-D1se0_CVE-2024-23897-Vulnerabilidad-Jenkins.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #4

**来源**: [CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md](../2024/CVE-2024-23897-Fineken_Jenkins-CVE-2024-23897-Lab.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #5

**来源**: [CVE-2024-23897-JAthulya_CVE-2024-23897.md](../2024/CVE-2024-23897-JAthulya_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #6

**来源**: [CVE-2024-23897-Maalfer_CVE-2024-23897.md](../2024/CVE-2024-23897-Maalfer_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #7

**来源**: [CVE-2024-23897-Marouane133_jenkins-lfi.md](../2024/CVE-2024-23897-Marouane133_jenkins-lfi.md)

## CVE-2024-23897-Jenkins-Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（结合其他漏洞）

**影响版本:** 受影响版本：Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本（具体版本请参考漏洞库信息）

**利用条件:** 需要能访问Jenkins CLI接口，可能通过HTTP、WebSocket或SSH

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，攻击者可以通过构造包含 `@` 字符和文件路径的CLI命令参数，读取 Jenkins 控制器文件系统上的任意文件。根据漏洞库信息，受影响的版本包括Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。POC代码 `poc.py` 通过多线程并发发送 upload 和 download 请求利用该漏洞。upload 请求用来设置 session，download 请求用来读取文件内容。文件路径通过 `-f` 参数指定。搜索引擎结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 接口利用，且已被公开利用。POC代码没有发现明显的投毒代码。

**项目地址:** [Marouane133/jenkins-lfi](https://github.com/Marouane133/jenkins-lfi)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #8

**来源**: [CVE-2024-23897-Nebian_CVE-2024-23897.md](../2024/CVE-2024-23897-Nebian_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #9

**来源**: [CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md](../2024/CVE-2024-23897-Praison001_CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #10

**来源**: [CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md](../2024/CVE-2024-23897-Surko888_Surko-Exploit-Jenkins-CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #11

**来源**: [CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md](../2024/CVE-2024-23897-ThatNotEasy_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #12

**来源**: [CVE-2024-23897-Vozec_CVE-2024-23897.md](../2024/CVE-2024-23897-Vozec_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #13

**来源**: [CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md](../2024/CVE-2024-23897-aadi0258_Exploit-CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #14

**来源**: [CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md](../2024/CVE-2024-23897-amalpvatayam67_day03-jenkins-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #15

**来源**: [CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md](../2024/CVE-2024-23897-brandonhjh_Jenkins-CVE-2024-23897-Exploit-Demo.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #16

**来源**: [CVE-2024-23897-cc3305_CVE-2024-23897.md](../2024/CVE-2024-23897-cc3305_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #17

**来源**: [CVE-2024-23897-godylockz_CVE-2024-23897.md](../2024/CVE-2024-23897-godylockz_CVE-2024-23897.md)

## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #18

**来源**: [CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md](../2024/CVE-2024-23897-harekrishnarai_CVE-2024-23897-test-windows.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #19

**来源**: [CVE-2024-23897-hybinn_CVE-2024-23897.md](../2024/CVE-2024-23897-hybinn_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #20

**来源**: [CVE-2024-23897-ifconfig-me_CVE-2024-23897.md](../2024/CVE-2024-23897-ifconfig-me_CVE-2024-23897.md)

## CVE-2024-23897 Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例需要开启CLI接口且版本受漏洞影响。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 漏洞是 Jenkins CLI 命令解析器中的一个缺陷，该缺陷允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins 没有禁用其 CLI 命令解析器的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。

**有效性：**
根据漏洞信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC代码可用。PoC代码利用了 Jenkins CLI 的参数解析特性，通过构造包含 `@/path/to/file` 的payload，可以读取服务器上的文件。

**投毒风险：**
PoC代码本身主要功能是读取文件，但存在轻微的潜在风险。

*   **Payload生成函数：**  `gen_payload` 函数构造payload时，如果攻击者控制了`path`变量，可以尝试读取任意文件。
*   **外部URL列表：** PoC从外部文件读取目标URL列表。如果该文件被篡改，可能导致PoC攻击错误的目标，或被用于扫描不应扫描的系统。
*   **subprocess.run：** PoC代码使用 `subprocess.run` 命令执行外部的 `jenkins-cli.jar`， 这存在一定的风险。如果 `jenkins-cli.jar` 文件被替换为恶意文件，可能导致远程代码执行。但是，该PoC使用 `stderr=subprocess.DEVNULL` 来丢弃错误信息，这会使排查问题变得更加困难。PoC验证的后门代码判定为正常代码。
*   **忽略SSL警告:** PoC代码忽略SSL证书警告，如果中间人存在，存在被中间人攻击的风险。

综合来看，直接的投毒代码可能性较低（约10%），但使用者需要注意外部URL列表和 `jenkins-cli.jar` 的来源安全性，以及忽略SSL警告带来的潜在风险。

**利用方式：**
1.  攻击者构造恶意的CLI命令，其中包含 `@/path/to/file` 形式的参数。
2.  攻击者通过HTTP/WebSocket/SSH等方式将命令发送到Jenkins CLI接口。
3.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为指定文件的内容。
4.  攻击者即可获取文件内容，实现任意文件读取。

**项目地址:** [ifconfig-me/CVE-2024-23897](https://github.com/ifconfig-me/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #21

**来源**: [CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md](../2024/CVE-2024-23897-jenkinsci-cert_SECURITY-3314-3315.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #22

**来源**: [CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md](../2024/CVE-2024-23897-kaanatmacaa_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #23

**来源**: [CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md](../2024/CVE-2024-23897-mil4ne_CVE-2024-23897-Jenkins-4.441.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #24

**来源**: [CVE-2024-23897-murataydemir_CVE-2024-23897.md](../2024/CVE-2024-23897-murataydemir_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #25

**来源**: [CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md](../2024/CVE-2024-23897-pulentoski_CVE-2024-23897-Arbitrary-file-read.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #26

**来源**: [CVE-2024-23897-slytechroot_CVE-2024-23897.md](../2024/CVE-2024-23897-slytechroot_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #27

**来源**: [CVE-2024-23897-tvasari_CVE-2024-23897.md](../2024/CVE-2024-23897-tvasari_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致远程代码执行

**影响版本:** 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 需要能够访问 Jenkins CLI 接口（HTTP, WebSocket 或 SSH）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 是一个存在于 Jenkins CLI 命令解析器中的任意文件读取漏洞。Jenkins 使用 args4j 库解析命令行参数，该库默认启用了将 `@file` 替换为文件内容的功能。未授权的攻击者可以通过 Jenkins CLI 接口发送包含 `@/path/to/arbitrary/file` 格式参数的命令，从而读取 Jenkins 控制器文件系统上的任意文件。根据搜索结果，该漏洞可通过 HTTP、WebSocket 和 SSH 协议利用，其中前两种方式的利用可能性更高。漏洞利用代码 (CVE-2024-23897.py) 演示了如何利用此漏洞读取文件。该脚本接受 jenkins-cli.jar 的路径、目标 Jenkins URI 和要读取的文件路径作为参数，并使用 `proxychains` 执行 Jenkins CLI 命令。该脚本还尝试执行 `who-am-i`、`enable-job`、`keep-build` 等 Jenkins CLI 命令，并将文件路径作为参数传递，以触发文件读取漏洞。代码中使用了proxychains，这说明代码编写者很可能再内网环境中，通过代理服务器进行测试验证。 

**有效性：**
提供的POC代码利用了 Jenkins CLI 的参数解析漏洞，经验证有效。

**投毒风险：**
代码主要功能是读取文件，存在一定风险，但是没有发现恶意代码或后门。投毒风险较低，约为 1%。虽然使用了 proxychains，但这更多是为了方便在特定网络环境下进行测试，不属于投毒行为。

**利用方式：**
1.  攻击者需要能够访问目标 Jenkins 实例的 CLI 接口（HTTP, WebSocket 或 SSH）。
2.  攻击者构造包含 `@/path/to/arbitrary/file` 格式参数的 Jenkins CLI 命令。
3.  攻击者将构造的命令发送到 Jenkins CLI 接口。
4.  Jenkins CLI 解析命令时，会将 `@/path/to/arbitrary/file` 替换为指定文件的内容。
5.  Jenkins 将文件内容作为命令参数处理，通常会将其输出到响应中，攻击者从而获得文件内容。

**项目地址:** [tvasari/CVE-2024-23897](https://github.com/tvasari/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #28

**来源**: [CVE-2024-23897-verylazytech_CVE-2024-23897.md](../2024/CVE-2024-23897-verylazytech_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #29

**来源**: [CVE-2024-23897-wjlin0_CVE-2024-23897.md](../2024/CVE-2024-23897-wjlin0_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #30

**来源**: [CVE-2024-23897-xaitax_CVE-2024-23897.md](../2024/CVE-2024-23897-xaitax_CVE-2024-23897.md)

## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，允许未授权的攻击者读取 Jenkins 控制器上的任意文件

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的内容替换为文件的实际内容。未经过身份验证的攻击者可以通过构造包含恶意文件路径的请求，利用该漏洞读取 Jenkins 控制器文件系统上的任何文件。根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（PoC），对漏洞利用的有效性、投毒风险和利用方式进行分析如下：

**1. 有效性：**

   *   **漏洞库信息：** 漏洞库信息明确指出 CVE-2024-23897 允许未经身份验证的攻击者读取任意文件。
   *   **搜索引擎结果：** 搜索结果中的多个链接（例如，NVD、Trend Micro、Zscaler、Uptycs、Splunk）都确认了该漏洞的存在以及其严重性，并表明该漏洞允许任意文件读取。一些文章甚至提到可以利用该漏洞实现远程代码执行(RCE)，虽然直接利用文件读取RCE可能需要更复杂的条件，但文件读取本身是一个严重的安全问题。
   *   **漏洞利用代码：** 提供的 Python PoC 代码 `CVE-2024-23897.py` 尝试利用此漏洞。它通过构造特定的 HTTP 请求，包含以 `@` 开头的文件路径来触发漏洞。PoC 包含发送 `download` 和 `upload` 请求到 `/cli?remoting=false` 接口，并设置 `Session` 和 `Side` 头。其中 `download` 请求用于读取文件内容，`upload` 请求可能用于辅助漏洞利用或传递命令。代码通过构建特定的数据包来发送包含文件路径的指令。结合漏洞描述，利用 `@` 字符触发文件读取是漏洞的核心。因此，提供的 PoC 代码基本有效。

**2. 投毒风险：**

   *   在提供的 PoC 代码中，潜在的投毒风险较低，约为 10%。主要考虑以下几点：

        *   代码的目的是读取文件内容，主要通过构造 HTTP 请求来实现。代码中没有直接执行命令或写入文件的操作。
        *   代码包含处理 HTTP 请求和响应的逻辑，这部分代码可能存在潜在的漏洞，但不太可能直接导致恶意代码执行。
        *   `calculate_header_in_bytes` 函数根据不同的命令设置不同的 header。如果攻击者能够控制命令，则可能影响 Jenkins 的行为。但是根据目前的代码来看，没有发现明显的后门。
        *   `calculate_tail_in_bytes` 函数中语言选项如果可控也存在一定的安全隐患。但是代码本身没有明显的投毒。

**3. 利用方式：**

   1.  **确定目标 Jenkins 实例：** 攻击者需要找到存在 CVE-2024-23897 漏洞的 Jenkins 实例。
   2.  **构建恶意请求：** 攻击者构建一个包含恶意文件路径的 HTTP POST 请求，发送到 Jenkins 的 `/cli?remoting=false` 端点。文件路径需要以 `@` 字符开头，例如 `@/etc/passwd`。
   3.  **设置请求头：**  需要设置正确的请求头，包括 `Session` 和 `Side`，以及 `Content-type`（对于 `upload` 请求）。
   4.  **发送请求并获取响应：** 攻击者发送构建好的请求，并解析 Jenkins 的响应。如果漏洞利用成功，响应将包含目标文件的内容。
   5.  **读取敏感信息：** 攻击者可以利用该漏洞读取 Jenkins 控制器上的任何文件，包括配置文件、密钥、凭据等敏感信息，从而进一步攻击 Jenkins 系统。

**总结：**

CVE-2024-23897 是 Jenkins 中一个严重的安全漏洞，它允许未经身份验证的攻击者读取 Jenkins 控制器上的任意文件。提供的 PoC 代码可以有效地利用该漏洞。代码本身存在一定的投毒风险，但是并不明显。攻击者可以利用该漏洞读取敏感信息，进一步威胁 Jenkins 系统的安全。

**项目地址:** [xaitax/CVE-2024-23897](https://github.com/xaitax/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

## POC #31

**来源**: [CVE-2024-23897-yoryio_CVE-2024-23897.md](../2024/CVE-2024-23897-yoryio_CVE-2024-23897.md)

## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而导致RCE

**影响版本:** <= 2.441, <= LTS 2.426.3

**利用条件:** 需要能够访问Jenkins CLI接口 (HTTP, WebSocket, SSH)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 存在于 Jenkins 中，由于其 CLI 命令解析器未禁用一个特性，该特性会将参数中以 '@' 字符开头的路径替换为文件内容。未授权的攻击者可以通过该漏洞读取 Jenkins 控制器文件系统上的任意文件。PoC 代码通过 Shodan 搜索暴露的 Jenkins 服务器，并检测服务器版本是否在受影响的范围内。利用方式包括通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI，并构造包含 "@/path/to/file" 的命令参数。由于该PoC需要配置Shodan API Key，并且本身只进行版本检测，没有直接读取文件的操作，以及网络上存在大量公开可用的PoC，因此投毒风险较低，推测风险在于作者可能通过收集扫描结果用于非法用途，例如售卖扫描结果等，因此判断投毒风险为5%。需要注意的是，真正的漏洞利用需要构造特定的CLI命令，读取目标文件。

**项目地址:** [yoryio/CVE-2024-23897](https://github.com/yoryio/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)

---

