# CVE-2024-25641

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-25641-5ma1l_CVE-2024-25641.md](../2024/CVE-2024-25641-5ma1l_CVE-2024-25641.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 1.2.27

**利用条件:** 需要具有 "Import Templates" 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 是 Cacti 1.2.27 之前版本中的一个远程代码执行漏洞。该漏洞存在于 `import_package()` 函数中，该函数位于 `/lib/import.php` 脚本。具有 "Import Templates" 权限的已认证用户可以通过 "Package Import" 功能利用此漏洞，通过上传恶意的软件包，在服务器上执行任意 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：** 由于Cacti在处理导入包时未对文件名和文件内容进行充分验证，攻击者可以通过构造包含恶意PHP代码的包文件，覆盖或写入服务器上的任意文件。
2.  **利用条件：** 需要目标Cacti版本低于1.2.27, 并且攻击者拥有"Import Templates"权限。
3.  **利用步骤：**
    *   使用有效凭据登录 Cacti。
    *   构造一个包含恶意 PHP 代码的文件。
    *   创建一个包含该文件的 XML 配置文件，并使用 RSA 密钥签名。
    *   将 XML 配置文件压缩为 gzip 格式。
    *   通过 Cacti 的 "Package Import" 功能上传该 gzip 文件。
    *   Cacti 将会解压并写入恶意文件到服务器上，可能覆盖现有文件。
    *   访问恶意文件，执行其中的 PHP 代码。

4.  **POC 代码分析：**
    *   提供的 exploit.py 脚本自动化了上述利用过程。
    *   它首先登录到 Cacti。
    *   然后，它生成包含 PHP payload 的 gzip 文件。
    *   接着，它通过两次 POST 请求上传该 gzip 文件，第一次用于预览，第二次用于确认导入。
    *   最后，它尝试运行上传的 PHP payload。
5.  **有效性评估：**
    *   根据漏洞描述和 POC 代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞存在可利用的 POC。
6. **投毒风险评估：**
* 代码主要功能是利用漏洞实现RCE，主要操作都是围绕漏洞展开，没有发现明显的恶意行为
* 脚本会从用户指定的`php/monkey.php`加载payload，如果用户自己下载的`php/monkey.php`被篡改可能会导致后门
* 脚本本身存在一定风险，例如默认payload，用户如果直接使用默认payload可能会被其他人利用，造成损失
* 总的来说，此仓库的投毒风险较低，大概在1%，主要是由于默认payload和用户可能使用被篡改的payload导致。
* 仓库的readme.md文件是对漏洞利用的解释，没有发现可疑代码。

综上所述，该漏洞利用的有效性较高，但存在轻微的投毒风险。

**项目地址:** [5ma1l/CVE-2024-25641](https://github.com/5ma1l/CVE-2024-25641)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #2

**来源**: [CVE-2024-25641-D3Ext_CVE-2024-25641.md](../2024/CVE-2024-25641-D3Ext_CVE-2024-25641.md)

# CVE-2024-25641

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-25641-5ma1l_CVE-2024-25641.md](../2024/CVE-2024-25641-5ma1l_CVE-2024-25641.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 1.2.27

**利用条件:** 需要具有 "Import Templates" 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 是 Cacti 1.2.27 之前版本中的一个远程代码执行漏洞。该漏洞存在于 `import_package()` 函数中，该函数位于 `/lib/import.php` 脚本。具有 "Import Templates" 权限的已认证用户可以通过 "Package Import" 功能利用此漏洞，通过上传恶意的软件包，在服务器上执行任意 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：** 由于Cacti在处理导入包时未对文件名和文件内容进行充分验证，攻击者可以通过构造包含恶意PHP代码的包文件，覆盖或写入服务器上的任意文件。
2.  **利用条件：** 需要目标Cacti版本低于1.2.27, 并且攻击者拥有"Import Templates"权限。
3.  **利用步骤：**
    *   使用有效凭据登录 Cacti。
    *   构造一个包含恶意 PHP 代码的文件。
    *   创建一个包含该文件的 XML 配置文件，并使用 RSA 密钥签名。
    *   将 XML 配置文件压缩为 gzip 格式。
    *   通过 Cacti 的 "Package Import" 功能上传该 gzip 文件。
    *   Cacti 将会解压并写入恶意文件到服务器上，可能覆盖现有文件。
    *   访问恶意文件，执行其中的 PHP 代码。

4.  **POC 代码分析：**
    *   提供的 exploit.py 脚本自动化了上述利用过程。
    *   它首先登录到 Cacti。
    *   然后，它生成包含 PHP payload 的 gzip 文件。
    *   接着，它通过两次 POST 请求上传该 gzip 文件，第一次用于预览，第二次用于确认导入。
    *   最后，它尝试运行上传的 PHP payload。
5.  **有效性评估：**
    *   根据漏洞描述和 POC 代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞存在可利用的 POC。
6. **投毒风险评估：**
* 代码主要功能是利用漏洞实现RCE，主要操作都是围绕漏洞展开，没有发现明显的恶意行为
* 脚本会从用户指定的`php/monkey.php`加载payload，如果用户自己下载的`php/monkey.php`被篡改可能会导致后门
* 脚本本身存在一定风险，例如默认payload，用户如果直接使用默认payload可能会被其他人利用，造成损失
* 总的来说，此仓库的投毒风险较低，大概在1%，主要是由于默认payload和用户可能使用被篡改的payload导致。
* 仓库的readme.md文件是对漏洞利用的解释，没有发现可疑代码。

综上所述，该漏洞利用的有效性较高，但存在轻微的投毒风险。

**项目地址:** [5ma1l/CVE-2024-25641](https://github.com/5ma1l/CVE-2024-25641)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #2

**来源**: [CVE-2024-25641-Safarchand_CVE-2024-25641.md](../2024/CVE-2024-25641-Safarchand_CVE-2024-25641.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Cacti

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** < 1.2.27

**利用条件:** 需要Cacti的管理权限（Import Templates）和网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25641是Cacti中存在的一个远程代码执行漏洞。该漏洞位于`/lib/import.php`脚本中的`import_package()`函数中。具有“Import Templates”权限的已认证用户可以通过“Package Import”功能，利用此漏洞在web服务器上执行任意PHP代码。漏洞的根本原因是`import_package()`函数未对XML数据中提供的文件名和文件内容进行充分验证，允许攻击者写入任意文件，包括位于Cacti基础路径之外的文件。利用方式如下：

1.  **身份验证：** 使用具有“Import Templates”权限的账户登录Cacti。
2.  **构造恶意软件包：** 创建一个包含恶意PHP代码的文件，并将其压缩成.xml.gz格式的软件包（例如test.xml.gz）。恶意文件中包含webshell，或者可以执行系统命令的PHP代码。
3.  **上传恶意软件包：** 通过Cacti的“Package Import”功能上传构造的恶意软件包。
4.  **触发漏洞：** Cacti在处理软件包时，由于未对文件名和文件内容进行充分验证，会将恶意PHP文件写入服务器，通常写入到web可访问的目录。上传的webshell文件被执行导致RCE。
5.  **反弹shell：** POC中的exploit.py脚本可以自动完成上述步骤，并尝试通过上传webshell的方式获取反弹shell。攻击者需要指定目标Cacti的URL、用户名、密码、本地IP和监听端口。

**关于投毒风险的评估：**
尽管POC代码的主要目的是利用该漏洞，但仍需注意潜在的投毒风险。分析代码后，发现该脚本主要功能是自动化漏洞利用流程，没有明显的恶意代码。然而，用户在使用该脚本时，应仔细检查test.xml.gz的内容，确保其是安全的。此外，使用未经授权的IP地址和端口进行反弹shell可能构成安全风险。 总体估计投毒风险为10%。

**项目地址:** [Safarchand/CVE-2024-25641](https://github.com/Safarchand/CVE-2024-25641)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #3

**来源**: [CVE-2024-25641-StopThatTalace_CVE-2024-25641-CACTI-RCE-1.2.26.md](../2024/CVE-2024-25641-StopThatTalace_CVE-2024-25641-CACTI-RCE-1.2.26.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.2.27

**利用条件:** 需要具有 "Import Templates" 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 是 Cacti 1.2.27 之前版本中存在的一个远程代码执行漏洞。该漏洞位于 `/lib/import.php` 脚本的 `import_package()` 函数中。具有 "Import Templates" 权限的已认证用户可以通过“Package Import”功能利用此漏洞，在 web 服务器上执行任意 PHP 代码。 

**漏洞利用方式：**

1.  攻击者需要具有 Cacti 实例的有效帐户，并且该帐户必须具有 "Import Templates" 权限。
2.  攻击者构造一个包含恶意 PHP 代码的特制 XML 数据包。该 XML 数据包包含一个指向恶意 php 文件的文件路径，绕过了输入验证。
3.  攻击者使用 Cacti 的“Package Import”功能上传构造的 XML 数据包。
4.  `import_package()` 函数不正确地处理 XML 数据包中的文件内容和文件名，允许攻击者将任意 PHP 代码写入 Cacti 服务器的文件系统。
5.  攻击者可以通过访问上传的 PHP 文件来触发恶意代码的执行，从而在服务器上实现远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的利用已被证实，并且存在公开可用的 PoC 代码 (https://github.com/Safarchand/CVE-2024-25641)。提供的 PoC 代码 `CVE-2024-25641.py` 实现了漏洞利用的完整流程，包括:

*   获取 CSRF token
*   登录 Cacti
*   生成包含恶意 PHP 代码的 XML 数据包
*   上传恶意 XML 数据包

**投毒风险：**

分析 PoC 代码后，发现投毒风险极低。代码的主要功能是生成恶意 XML 文件并上传，目的是为了执行命令。虽然任何代码都存在潜在的风险，但根据目前的分析来看，该仓库的投毒风险较低。主要是因为以下几点：

*   代码功能相对集中且清晰，主要目标是利用漏洞实现 RCE。
*   未发现任何隐藏的恶意功能，如收集用户信息、传播恶意软件等。
*  该PoC 的目的是为了验证漏洞，而不是为了长期潜伏。

 综合评估，该仓库存在的投毒风险极低，但仍需要保持警惕。

**项目地址:** [StopThatTalace/CVE-2024-25641-CACTI-RCE-1.2.26](https://github.com/StopThatTalace/CVE-2024-25641-CACTI-RCE-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #4

**来源**: [CVE-2024-25641-XiaomingX_cve-2024-25641-poc.md](../2024/CVE-2024-25641-XiaomingX_cve-2024-25641-poc.md)

## CVE-2024-25641 - Cacti Package Import RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 1.2.27

**利用条件:** 需要拥有 'Import Templates' 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-25641 是 Cacti 中存在的一个远程代码执行漏洞，位于 `import_package()` 函数 (`/lib/import.php`) 中。攻击者（需要具有 'Import Templates' 权限的已认证用户）可以利用 Package Import 功能上传恶意构造的 XML 文件，该 XML 文件包含恶意的文件名和文件内容，由于程序没有充分验证文件名和内容，导致任意文件写入漏洞。攻击者可以利用此漏洞在 Cacti web 服务器上写入或覆盖任意文件，包括 PHP 文件，从而执行任意 PHP 代码。漏洞利用方式如下：

1.  **认证：**  攻击者首先需要以具有 'Import Templates' 权限的用户身份登录 Cacti。
2.  **构造恶意 XML：**  攻击者构造一个恶意的 XML 文件，该文件定义了要写入的目标文件路径和文件内容。文件路径可以包含路径遍历序列（如 `../`）以尝试写入 Cacti 安装目录之外的文件。文件内容可以包含恶意的 PHP 代码。
3.  **上传恶意 XML：**  攻击者使用 Cacti 的 Package Import 功能上传构造的 XML 文件。
4.  **执行代码：**  Cacti 将根据 XML 文件中的定义，将文件写入到指定路径。如果攻击者成功地将包含恶意 PHP 代码的文件写入到 Web 可访问的目录下，就可以通过 Web 浏览器访问该文件，从而执行恶意代码。

根据提供的漏洞利用代码来看，它仅仅是一个开源协议，本身并不具备漏洞利用能力，因此，不存在投毒风险，Poison概率为0%.

**项目地址:** [XiaomingX/cve-2024-25641-poc](https://github.com/XiaomingX/cve-2024-25641-poc)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #5

**来源**: [CVE-2024-25641-regantemudo_CVE-2024-25641-Exploit-for-Cacti-1.2.26.md](../2024/CVE-2024-25641-regantemudo_CVE-2024-25641-Exploit-for-Cacti-1.2.26.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行

**影响应用:** Cacti

**危害等级:** 高危，允许攻击者在服务器上执行任意代码

**影响版本:** < 1.2.27

**利用条件:** 需要Cacti后台’导入模板’权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25641是Cacti 1.2.27之前版本中的一个远程代码执行漏洞。该漏洞源于`/lib/import.php`中的`import_package()`函数对导入的包文件未进行充分的验证。攻击者可以通过上传恶意构造的XML包，在服务器上写入任意文件，最终导致远程代码执行。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞的POC代码已经公开。GitHub上存在相关的POC，并且Rapid7 Metasploit也已经包含了利用模块，表明该漏洞利用的有效性较高。

**投毒风险分析：**

提供的POC代码包含以下文件：

*   `README.md`: 包含漏洞描述，利用方法，安装说明。
*   `cacti_exploit.py`:  Python脚本，用于自动化漏洞利用。
*   `requirements.txt`:  包含Python依赖。
*   `php/reverse_shell.php`: 默认的PHP反弹shell Payload。

审查`cacti_exploit.py`脚本，其主要功能如下：

1.  身份验证：通过提供的用户名和密码登录Cacti。
2.  CSRF Token获取：解析登录页面获取CSRF Token以绕过CSRF保护。
3.  恶意XML构造：构造包含恶意PHP Payload的XML数据。
4.  利用Package Import功能上传XML：将构造的XML数据通过Cacti的Package Import功能上传。
5.  执行Payload： 通过访问上传的PHP文件触发反弹shell。

在`cacti_exploit.py`中，没有明显的恶意代码或后门。但是，仍然存在一定的投毒风险，例如：

*   依赖风险：`requirements.txt`文件中可能包含恶意库，虽然可能性较低，但是存在。
*   Payload替换：攻击者可能使用更复杂的PHP payload，导致更严重的后果，但这不是代码本身的投毒，而是使用者行为。
*   代码混淆：虽然此POC未做代码混淆，但攻击者可能添加混淆来隐藏恶意行为。

综合评估，此POC的投毒风险为10%。主要来自于潜在的依赖风险，以及使用者行为可能导致的payload替换。

**利用方式：**

1.  **环境准备：** 安装Cacti 1.2.26 (或更早版本)，并配置好运行环境 (PHP, MySQL等)。
2.  **权限获取：** 获得一个拥有’导入模板’权限的Cacti用户账号密码。
3.  **Payload生成：**  修改`php/reverse_shell.php`中的IP地址和端口，配置反弹shell的目标。
4.  **执行Exploit：** 运行`cacti_exploit.py`脚本，提供目标Cacti URL，用户名，密码，以及Payload路径。
5.  **触发Payload：**  脚本执行成功后，通过浏览器访问上传的PHP文件，或者通过脚本直接访问URL触发Payload。
6.  **获取Shell：**  在攻击者主机上监听配置的端口，等待反弹shell连接。

**项目地址:** [regantemudo/CVE-2024-25641-Exploit-for-Cacti-1.2.26](https://github.com/regantemudo/CVE-2024-25641-Exploit-for-Cacti-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #6

**来源**: [CVE-2024-25641-thisisveryfunny_CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26.md](../2024/CVE-2024-25641-thisisveryfunny_CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许攻击者执行任意PHP代码，完全控制受影响的系统。

**影响版本:** < 1.2.27

**利用条件:** 需要具有 'Import Templates' 权限的已认证用户。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 存在于 Cacti 1.2.27 之前的版本中。这是一个通过“Package Import”功能利用的任意文件写入漏洞，允许具有“Import Templates”权限的认证用户在Web服务器上执行任意 PHP 代码。漏洞位于 `/lib/import.php` 脚本中的 `import_package()` 函数中。该函数盲目信任 XML 数据中提供的文件名和文件内容，并将这些文件写入 Cacti 基本路径（甚至外部，因为未过滤路径遍历序列）。这可用于在Web服务器上写入或覆盖任意文件，从而导致执行任意 PHP 代码或其他安全影响。

**漏洞利用方式：**

1.  攻击者首先需要拥有一个 Cacti 实例的有效账户，并且该账户具有“Import Templates”权限。
2.  攻击者构造一个恶意的 XML 文件，该文件包含要写入的文件的路径和内容。该 XML 文件旨在利用 `import_package()` 函数中的漏洞，通过路径遍历写入任意文件，或覆盖已经存在的文件。
3.  XML 文件中的文件内容包含恶意 PHP 代码，例如，Webshell 或用于执行系统命令的代码。
4.  攻击者通过 Cacti 的 Web 界面上传恶意 XML 文件，触发 `import_package()` 函数。
5.  `import_package()` 函数将恶意 PHP 代码写入指定位置。
6.  攻击者可以通过访问写入的 PHP 文件来执行恶意代码，从而获得对 Cacti 服务器的远程代码执行权限。

**POC 代码分析：**
提供的 `exploit.py` 脚本自动化了漏洞利用过程。该脚本执行以下步骤：

1.  使用提供的用户名和密码登录到 Cacti Web 界面。
2.  构造一个恶意的 XML 文件，其中包含用于执行反向 shell 的 PHP 代码。
3.  使用 `msfvenom` 生成反向shell的elf文件
4.  通过模拟上传包过程发送恶意 XML 文件到 Cacti 服务器。
5.  在本地启动一个 Netcat 监听器，等待反向 shell 连接。

**投毒风险评估：**

该代码的主要目的是利用 CVE-2024-25641 漏洞实现远程代码执行。检查该仓库并未发现明显的恶意行为或隐藏的后门。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现其他潜在的风险。投毒风险较低。

**结论：**

此漏洞利用代码有效，可用于在易受攻击的 Cacti 实例上实现远程代码执行。虽然存在一定的投毒风险，但通过代码审计和分析，该风险较低。建议用户谨慎使用该代码，并确保只在授权的环境中进行测试。

**项目地址:** [thisisveryfunny/CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26](https://github.com/thisisveryfunny/CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---



---

## POC #3

**来源**: [CVE-2024-25641-Safarchand_CVE-2024-25641.md](../2024/CVE-2024-25641-Safarchand_CVE-2024-25641.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Cacti

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** < 1.2.27

**利用条件:** 需要Cacti的管理权限（Import Templates）和网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25641是Cacti中存在的一个远程代码执行漏洞。该漏洞位于`/lib/import.php`脚本中的`import_package()`函数中。具有“Import Templates”权限的已认证用户可以通过“Package Import”功能，利用此漏洞在web服务器上执行任意PHP代码。漏洞的根本原因是`import_package()`函数未对XML数据中提供的文件名和文件内容进行充分验证，允许攻击者写入任意文件，包括位于Cacti基础路径之外的文件。利用方式如下：

1.  **身份验证：** 使用具有“Import Templates”权限的账户登录Cacti。
2.  **构造恶意软件包：** 创建一个包含恶意PHP代码的文件，并将其压缩成.xml.gz格式的软件包（例如test.xml.gz）。恶意文件中包含webshell，或者可以执行系统命令的PHP代码。
3.  **上传恶意软件包：** 通过Cacti的“Package Import”功能上传构造的恶意软件包。
4.  **触发漏洞：** Cacti在处理软件包时，由于未对文件名和文件内容进行充分验证，会将恶意PHP文件写入服务器，通常写入到web可访问的目录。上传的webshell文件被执行导致RCE。
5.  **反弹shell：** POC中的exploit.py脚本可以自动完成上述步骤，并尝试通过上传webshell的方式获取反弹shell。攻击者需要指定目标Cacti的URL、用户名、密码、本地IP和监听端口。

**关于投毒风险的评估：**
尽管POC代码的主要目的是利用该漏洞，但仍需注意潜在的投毒风险。分析代码后，发现该脚本主要功能是自动化漏洞利用流程，没有明显的恶意代码。然而，用户在使用该脚本时，应仔细检查test.xml.gz的内容，确保其是安全的。此外，使用未经授权的IP地址和端口进行反弹shell可能构成安全风险。 总体估计投毒风险为10%。

**项目地址:** [Safarchand/CVE-2024-25641](https://github.com/Safarchand/CVE-2024-25641)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #4

**来源**: [CVE-2024-25641-StopThatTalace_CVE-2024-25641-CACTI-RCE-1.2.26.md](../2024/CVE-2024-25641-StopThatTalace_CVE-2024-25641-CACTI-RCE-1.2.26.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.2.27

**利用条件:** 需要具有 "Import Templates" 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 是 Cacti 1.2.27 之前版本中存在的一个远程代码执行漏洞。该漏洞位于 `/lib/import.php` 脚本的 `import_package()` 函数中。具有 "Import Templates" 权限的已认证用户可以通过“Package Import”功能利用此漏洞，在 web 服务器上执行任意 PHP 代码。 

**漏洞利用方式：**

1.  攻击者需要具有 Cacti 实例的有效帐户，并且该帐户必须具有 "Import Templates" 权限。
2.  攻击者构造一个包含恶意 PHP 代码的特制 XML 数据包。该 XML 数据包包含一个指向恶意 php 文件的文件路径，绕过了输入验证。
3.  攻击者使用 Cacti 的“Package Import”功能上传构造的 XML 数据包。
4.  `import_package()` 函数不正确地处理 XML 数据包中的文件内容和文件名，允许攻击者将任意 PHP 代码写入 Cacti 服务器的文件系统。
5.  攻击者可以通过访问上传的 PHP 文件来触发恶意代码的执行，从而在服务器上实现远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的利用已被证实，并且存在公开可用的 PoC 代码 (https://github.com/Safarchand/CVE-2024-25641)。提供的 PoC 代码 `CVE-2024-25641.py` 实现了漏洞利用的完整流程，包括:

*   获取 CSRF token
*   登录 Cacti
*   生成包含恶意 PHP 代码的 XML 数据包
*   上传恶意 XML 数据包

**投毒风险：**

分析 PoC 代码后，发现投毒风险极低。代码的主要功能是生成恶意 XML 文件并上传，目的是为了执行命令。虽然任何代码都存在潜在的风险，但根据目前的分析来看，该仓库的投毒风险较低。主要是因为以下几点：

*   代码功能相对集中且清晰，主要目标是利用漏洞实现 RCE。
*   未发现任何隐藏的恶意功能，如收集用户信息、传播恶意软件等。
*  该PoC 的目的是为了验证漏洞，而不是为了长期潜伏。

 综合评估，该仓库存在的投毒风险极低，但仍需要保持警惕。

**项目地址:** [StopThatTalace/CVE-2024-25641-CACTI-RCE-1.2.26](https://github.com/StopThatTalace/CVE-2024-25641-CACTI-RCE-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #5

**来源**: [CVE-2024-25641-XiaomingX_cve-2024-25641-poc.md](../2024/CVE-2024-25641-XiaomingX_cve-2024-25641-poc.md)

## CVE-2024-25641 - Cacti Package Import RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 1.2.27

**利用条件:** 需要拥有 'Import Templates' 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-25641 是 Cacti 中存在的一个远程代码执行漏洞，位于 `import_package()` 函数 (`/lib/import.php`) 中。攻击者（需要具有 'Import Templates' 权限的已认证用户）可以利用 Package Import 功能上传恶意构造的 XML 文件，该 XML 文件包含恶意的文件名和文件内容，由于程序没有充分验证文件名和内容，导致任意文件写入漏洞。攻击者可以利用此漏洞在 Cacti web 服务器上写入或覆盖任意文件，包括 PHP 文件，从而执行任意 PHP 代码。漏洞利用方式如下：

1.  **认证：**  攻击者首先需要以具有 'Import Templates' 权限的用户身份登录 Cacti。
2.  **构造恶意 XML：**  攻击者构造一个恶意的 XML 文件，该文件定义了要写入的目标文件路径和文件内容。文件路径可以包含路径遍历序列（如 `../`）以尝试写入 Cacti 安装目录之外的文件。文件内容可以包含恶意的 PHP 代码。
3.  **上传恶意 XML：**  攻击者使用 Cacti 的 Package Import 功能上传构造的 XML 文件。
4.  **执行代码：**  Cacti 将根据 XML 文件中的定义，将文件写入到指定路径。如果攻击者成功地将包含恶意 PHP 代码的文件写入到 Web 可访问的目录下，就可以通过 Web 浏览器访问该文件，从而执行恶意代码。

根据提供的漏洞利用代码来看，它仅仅是一个开源协议，本身并不具备漏洞利用能力，因此，不存在投毒风险，Poison概率为0%.

**项目地址:** [XiaomingX/cve-2024-25641-poc](https://github.com/XiaomingX/cve-2024-25641-poc)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #6

**来源**: [CVE-2024-25641-regantemudo_CVE-2024-25641-Exploit-for-Cacti-1.2.26.md](../2024/CVE-2024-25641-regantemudo_CVE-2024-25641-Exploit-for-Cacti-1.2.26.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行

**影响应用:** Cacti

**危害等级:** 高危，允许攻击者在服务器上执行任意代码

**影响版本:** < 1.2.27

**利用条件:** 需要Cacti后台’导入模板’权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25641是Cacti 1.2.27之前版本中的一个远程代码执行漏洞。该漏洞源于`/lib/import.php`中的`import_package()`函数对导入的包文件未进行充分的验证。攻击者可以通过上传恶意构造的XML包，在服务器上写入任意文件，最终导致远程代码执行。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞的POC代码已经公开。GitHub上存在相关的POC，并且Rapid7 Metasploit也已经包含了利用模块，表明该漏洞利用的有效性较高。

**投毒风险分析：**

提供的POC代码包含以下文件：

*   `README.md`: 包含漏洞描述，利用方法，安装说明。
*   `cacti_exploit.py`:  Python脚本，用于自动化漏洞利用。
*   `requirements.txt`:  包含Python依赖。
*   `php/reverse_shell.php`: 默认的PHP反弹shell Payload。

审查`cacti_exploit.py`脚本，其主要功能如下：

1.  身份验证：通过提供的用户名和密码登录Cacti。
2.  CSRF Token获取：解析登录页面获取CSRF Token以绕过CSRF保护。
3.  恶意XML构造：构造包含恶意PHP Payload的XML数据。
4.  利用Package Import功能上传XML：将构造的XML数据通过Cacti的Package Import功能上传。
5.  执行Payload： 通过访问上传的PHP文件触发反弹shell。

在`cacti_exploit.py`中，没有明显的恶意代码或后门。但是，仍然存在一定的投毒风险，例如：

*   依赖风险：`requirements.txt`文件中可能包含恶意库，虽然可能性较低，但是存在。
*   Payload替换：攻击者可能使用更复杂的PHP payload，导致更严重的后果，但这不是代码本身的投毒，而是使用者行为。
*   代码混淆：虽然此POC未做代码混淆，但攻击者可能添加混淆来隐藏恶意行为。

综合评估，此POC的投毒风险为10%。主要来自于潜在的依赖风险，以及使用者行为可能导致的payload替换。

**利用方式：**

1.  **环境准备：** 安装Cacti 1.2.26 (或更早版本)，并配置好运行环境 (PHP, MySQL等)。
2.  **权限获取：** 获得一个拥有’导入模板’权限的Cacti用户账号密码。
3.  **Payload生成：**  修改`php/reverse_shell.php`中的IP地址和端口，配置反弹shell的目标。
4.  **执行Exploit：** 运行`cacti_exploit.py`脚本，提供目标Cacti URL，用户名，密码，以及Payload路径。
5.  **触发Payload：**  脚本执行成功后，通过浏览器访问上传的PHP文件，或者通过脚本直接访问URL触发Payload。
6.  **获取Shell：**  在攻击者主机上监听配置的端口，等待反弹shell连接。

**项目地址:** [regantemudo/CVE-2024-25641-Exploit-for-Cacti-1.2.26](https://github.com/regantemudo/CVE-2024-25641-Exploit-for-Cacti-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

## POC #7

**来源**: [CVE-2024-25641-thisisveryfunny_CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26.md](../2024/CVE-2024-25641-thisisveryfunny_CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26.md)

## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，允许攻击者执行任意PHP代码，完全控制受影响的系统。

**影响版本:** < 1.2.27

**利用条件:** 需要具有 'Import Templates' 权限的已认证用户。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 存在于 Cacti 1.2.27 之前的版本中。这是一个通过“Package Import”功能利用的任意文件写入漏洞，允许具有“Import Templates”权限的认证用户在Web服务器上执行任意 PHP 代码。漏洞位于 `/lib/import.php` 脚本中的 `import_package()` 函数中。该函数盲目信任 XML 数据中提供的文件名和文件内容，并将这些文件写入 Cacti 基本路径（甚至外部，因为未过滤路径遍历序列）。这可用于在Web服务器上写入或覆盖任意文件，从而导致执行任意 PHP 代码或其他安全影响。

**漏洞利用方式：**

1.  攻击者首先需要拥有一个 Cacti 实例的有效账户，并且该账户具有“Import Templates”权限。
2.  攻击者构造一个恶意的 XML 文件，该文件包含要写入的文件的路径和内容。该 XML 文件旨在利用 `import_package()` 函数中的漏洞，通过路径遍历写入任意文件，或覆盖已经存在的文件。
3.  XML 文件中的文件内容包含恶意 PHP 代码，例如，Webshell 或用于执行系统命令的代码。
4.  攻击者通过 Cacti 的 Web 界面上传恶意 XML 文件，触发 `import_package()` 函数。
5.  `import_package()` 函数将恶意 PHP 代码写入指定位置。
6.  攻击者可以通过访问写入的 PHP 文件来执行恶意代码，从而获得对 Cacti 服务器的远程代码执行权限。

**POC 代码分析：**
提供的 `exploit.py` 脚本自动化了漏洞利用过程。该脚本执行以下步骤：

1.  使用提供的用户名和密码登录到 Cacti Web 界面。
2.  构造一个恶意的 XML 文件，其中包含用于执行反向 shell 的 PHP 代码。
3.  使用 `msfvenom` 生成反向shell的elf文件
4.  通过模拟上传包过程发送恶意 XML 文件到 Cacti 服务器。
5.  在本地启动一个 Netcat 监听器，等待反向 shell 连接。

**投毒风险评估：**

该代码的主要目的是利用 CVE-2024-25641 漏洞实现远程代码执行。检查该仓库并未发现明显的恶意行为或隐藏的后门。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现其他潜在的风险。投毒风险较低。

**结论：**

此漏洞利用代码有效，可用于在易受攻击的 Cacti 实例上实现远程代码执行。虽然存在一定的投毒风险，但通过代码审计和分析，该风险较低。建议用户谨慎使用该代码，并确保只在授权的环境中进行测试。

**项目地址:** [thisisveryfunny/CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26](https://github.com/thisisveryfunny/CVE-2024-25641-RCE-Automated-Exploit-Cacti-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)

---

