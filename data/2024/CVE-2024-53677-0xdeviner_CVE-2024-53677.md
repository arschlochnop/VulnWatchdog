## CVE-2024-53677 - Apache Struts 2 RCE/路径穿越

**漏洞编号:** CVE-2024-53677

**漏洞类型:** RCE/路径穿越

**影响应用:** Apache Struts 2

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 2.0.0 至 6.4.0 之前的所有版本

**利用条件:** 远程网络访问，且目标应用启用了文件上传功能

**POC 可用性:** 9/10

**POC 类型:** 完整利用/实验环境

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2024-53677是一个由于Apache Struts2文件上传逻辑缺陷导致的严重漏洞。该漏洞的核心在于Struts2的文件上传拦截器未能正确过滤或处理用户控制的文件路径参数。攻击者可以通过操纵多部分表单数据（multipart/form-data）中的参数，实现路径穿越攻击。在特定配置下，攻击者可以将恶意文件（如Webshell或JSP文件）上传至Web服务器的敏感目录，如Web应用的根目录。一旦上传成功，攻击者即可通过访问该文件来执行任意代码，获取系统权限。POC有效性分析：提供的POC代码包含完整的Dockerfile环境、Maven构建脚本以及Tomcat配置。该环境构建了一个标准的Struts2漏洞复现靶场。通过Dockerfile可以看到，它将编译后的war包部署在Tomcat 9容器中，并开放了8080端口。这种端到端的实验环境对于防御性研究非常有效，因为它提供了一个可控的测试平台，能够稳定触发并观察漏洞利用过程。利用步骤：1. 使用Docker构建镜像并运行容器；2. 构造恶意的HTTP POST请求，利用Struts2的FileUpload拦截器缺陷；3. 在请求中加入路径穿越字符（如../../），指定文件保存到Web容器可执行目录；4. 访问上传成功的JSP后门文件以实现远程代码执行。投毒风险分析：该POC项目的投毒风险极低（约5%）。通过审查Dockerfile和README文件，所有操作均基于合法的开源组件（OpenJDK, Alpine, Tomcat, Maven）。Dockerfile中的构建逻辑透明，没有发现下载第三方不明二进制文件、执行混淆Shell脚本或向外部IP发送敏感数据的行为。代码逻辑清晰，主要用于自动化环境搭建。唯一需要注意的是，这类实验环境通常会关闭部分安全配置（如context.xml中禁用了RemoteAddrValve），这是为了方便测试而非恶意行为。在使用此类POC时，研究人员应始终保持在隔离的内网环境运行，并检查pom.xml中是否存在恶意的依赖投毒。总体而言，该POC是一个高质量、安全且可信的防御研究工具。

**项目地址:** [https://github.com/0xdeviner/CVE-2024-53677](https://github.com/0xdeviner/CVE-2024-53677)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
