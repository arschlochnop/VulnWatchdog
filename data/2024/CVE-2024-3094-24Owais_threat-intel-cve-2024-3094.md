## CVE-2024-3094 - xz-utils (liblzma) 供应链后门 / 远程代码执行 (RCE)

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门 / 远程代码执行 (RCE)

**影响应用:** xz-utils (liblzma)

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 运行受影响版本的 Linux 发行版，且 SSHD 链接了 libsystemd 以进行通知（常见于 Debian/Fedora 等）

**POC 可用性:** 4/10

**POC 类型:** 仅说明

**攻击复杂度:** 高

**投毒风险:** 10%

## 详情

POC有效性分析：本报告涉及的POC代码实际上是一份详尽的威胁情报报告和分析文档，而非可直接执行的利用脚本。文档准确描述了CVE-2024-3094的机理。该漏洞并非传统意义上的编码失误，而是一场长达数年的精心策划的供应链攻击。利用步骤极其复杂：首先，攻击者Jia Tan通过合法的维护者身份在xz项目源码中植入了混淆的测试文件（如bad-3-corrupt_lzma2.xz）。在构建（Build）过程中，特制的m4宏脚本会检测环境，如果满足特定条件（如x86_64 Linux、使用gcc和ld、通过systemd启动SSHD），则会将恶意目标文件链接到liblzma中。最终，该后门通过拦截RSA_public_decrypt函数，在SSH认证阶段解密攻击者发送的特定负载，从而绕过认证实现root权限的远程代码执行。由于该后门具有极强的隐蔽性和环境感知能力，普通的POC仅能实现检测（如检查库文件指纹或特定的符号表特征），而无法轻易重现完整的攻击流。利用步骤分析：1. 环境检测：脚本确认目标系统为x86-64 Linux并处于特定的deb/rpm构建流程。2. 提取有效负载：从混淆的测试文件中提取二进制片段并拼凑成.o文件。3. 运行时劫持：利用动态链接器的特性，在SSHD启动并调用liblzma时，劫持关键的解密函数。4. 指令触发：攻击者发送经过特定密钥签名的有效载荷，后门验证通过后执行内置的系统命令。投毒风险分析：该漏洞本身就是投毒攻击的顶级案例。在分析此类POC项目时，风险主要集中在以下几点：第一，分析脚本本身可能包含恶意逻辑。由于xz后门的特性是利用复杂的混淆手段隐藏在二进制测试文件中，任何宣称可以‘演示’或‘复现’该漏洞的非官方二进制文件都具有极高的风险，可能在分析者的系统中植入二次后门。第二，伪装POC。目前GitHub等平台上存在大量以CVE-2024-3094为名的虚假仓库，利用安全研究人员急于获取POC的心理，诱导用户下载运行含有恶意反弹Shell或木马的脚本。第三，防御性分析工具的风险。一些用于检测liblzma完整性的自制脚本可能未经充分审计，存在被利用的漏洞。基于提供的输入数据，该项目目前仅表现为文档形式，未发现恶意的自动化执行脚本或二进制投毒行为，投毒风险评级为低（10%），主要来源于引用外部不可信链接的可能性。

**项目地址:** N/A (Analysis Report)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
