## CVE-2024-5932 - GiveWP – Donation Plugin and Fundraising Platform PHP对象注入/RCE

**漏洞编号:** CVE-2024-5932

**漏洞类型:** PHP对象注入/RCE

**影响应用:** GiveWP – Donation Plugin and Fundraising Platform

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** <= 3.14.1

**利用条件:** 无需身份验证，需向受影响的WordPress站点发送精心构造的序列化PHP对象数据

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于GiveWP插件在处理特定表单输入时未对用户提供的序列化数据进行充分验证。攻击者可以通过构造特殊的PHP序列化字符串，通过`unserialize()`函数触发PHP对象注入（POP链）。分析POC代码片段，它采用了Python编写，利用了`requests`进行网络通信，`BeautifulSoup`进行页面解析，并引入了`faker`生成虚假测试数据，这表明POC具备自动定位目标参数和生成有效载荷的能力。代码逻辑包含Banner打印和针对特定端点的POST请求发送。该POC具有较高的实战价值，能够自动化地探测并利用该漏洞实现远程代码执行（RCE）。利用步骤：1. 识别目标站点是否安装了GiveWP插件且版本在3.14.1及以下。2. 构造包含恶意POP链的序列化数据，通常针对插件内可利用的类（如TCPDF或Stripe驱动类）。3. 将序列化后的Payload封装在POST请求参数中发送至GiveWP的处理接口。4. 漏洞触发后，Payload中的系统指令将在服务器环境执行。投毒风险分析：该POC使用了标准的Python安全研究库（如requests, click, faker），代码逻辑清晰，未见明显的恶意混淆或加密后的Shellcode下载器。然而，在脚本初始化部分存在大量的Banner艺术字输出（占用约3000字符），在某些情况下，攻击者可能利用冗长的非功能性代码段（如大型Banner）来隐藏恶意逻辑（如静默向第三方服务器上报成功利用的目标IP地址）。虽然当前可见部分未发现后门，但因代码被截断，仍需警惕后续隐藏的`eval()`或执行外部系统命令的恶意行为。总体而言，该POC本身属于安全研究性质的Exp工具，其主要风险在于被未授权人员滥用，而非针对研究员的投毒行为。建议在使用前严格审计所有网络请求目标，并在隔离环境中运行以规避潜在的供应链投毒风险。

**项目地址:** /tmp/vulnwatchdog_8b62d5f9addf44112fcc06cdd5e9502c/CVE-2024-5932-rce.py

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-5932](https://nvd.nist.gov/vuln/detail/CVE-2024-5932)
