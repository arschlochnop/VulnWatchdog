## CVE-2024-53677 - Apache Struts 2 RCE (远程代码执行)

**漏洞编号:** CVE-2024-53677

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Apache Struts 2

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Apache Struts 2.0.0 - 2.5.33, 6.0.0 - 6.3.0.2

**利用条件:** 目标应用需开启文件上传功能，且使用特定版本受影响的FileUploadInterceptor拦截器。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本POC代码提供了一个基于Docker的完整复现环境。分析其Dockerfile和README可知，该POC通过修改Struts 2的应用配置，将原始的文件上传逻辑替换为存在漏洞的FileUploadInterceptor，并显式禁用了文件类型校验。这种设置虽然降低了复现难度，但非常符合CVE-2024-53677的漏洞核心：利用文件上传逻辑缺陷进行路径穿越。攻击者可以通过操纵上传参数（如文件名或路径参数），使上传的JSP木马文件跳出预设目录，写入Tomcat的webapps/ROOT目录下。一旦文件被成功写入Web目录，攻击者即可通过浏览器或命令行工具直接访问并执行该JSP文件，从而获得系统的远程命令执行权限。该环境集成了Tomcat容器和Maven构建工具，对于漏洞机理研究和防御特征提取具有很高的参考价值。利用步骤：1. 使用Git克隆项目并进入目录；2. 执行docker build构建包含漏洞环境的镜像；3. 运行容器并映射8080端口；4. 使用curl或其他工具构造带有路径穿越Payload（如 ../../webapps/ROOT/shell.jsp）的多部分表单上传请求；5. 访问生成的shell地址执行系统命令。投毒风险分析：经过对提供的代码段（Dockerfile、README、部分XML配置）的审计，未发现明显的代码混淆或恶意二进制文件下载行为。POC主要依赖标准的开源镜像（openjdk:17-jdk-alpine, tomcat:9.0）和Maven官方源，其构建逻辑清晰，主要操作为重命名Tomcat默认应用并部署目标WAR包。README中提到的Git仓库路径为个人用户c4oocO的存储库，尽管目前代码表现为良性，但防御者在克隆此类未经官方认证的Reproduction环境时，仍需警惕其后续可能更新的外部脚本。该项目通过模拟CVE-2023-50164的利用方式来复现CVE-2024-53677，这属于常见的安全研究手段，不属于投毒范畴。主要的潜在风险在于用户手动运行其提供的docker run指令时，若环境中包含未公开的敏感挂载或特殊的网络转发配置，可能会造成轻微的信息泄露，但基于当前暴露的配置片段，该风险等级较低（15%）。建议在使用前仔细检查pom.xml中的依赖声明，防止依赖劫持（Dependency Confusion）风险。

**项目地址:** [https://github.com/c4oocO/CVE-2024-53677-Docker](https://github.com/c4oocO/CVE-2024-53677-Docker)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
