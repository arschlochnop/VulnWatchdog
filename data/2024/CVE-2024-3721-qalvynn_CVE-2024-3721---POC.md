# CVE-2024-3721

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3721-qalvynn_CVE-2024-3721---POC.md](../2024/CVE-2024-3721-qalvynn_CVE-2024-3721---POC.md)

# CVE-2024-3721

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3721-qalvynn_CVE-2024-3721---POC.md](../2024/CVE-2024-3721-qalvynn_CVE-2024-3721---POC.md)

# CVE-2024-3721

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3721-qalvynn_Mirai-Based-CVE-2024-3721-Selfrep.md](../2024/CVE-2024-3721-qalvynn_Mirai-Based-CVE-2024-3721-Selfrep.md)

## CVE-2024-3721-TBK DVR-4104/DVR-4216-OS 命令注入

**漏洞编号:** CVE-2024-3721

**漏洞类型:** OS 命令注入

**影响应用:** TBK DVR-4104/DVR-4216

**危害等级:** 高危，可能导致设备被完全控制

**影响版本:** <= 20240412

**利用条件:** 需要网络访问，可能需要认证（CVE描述中提到 'PR:L'，即需要低权限）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3721 漏洞存在于TBK DVR-4104和DVR-4216设备中，版本不高于20240412。攻击者通过操纵`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`接口的`mdb/mdc`参数，可以实现OS命令注入。

**利用方式：**
1.  攻击者构造包含恶意命令的HTTP请求，目标URL为`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`，并将恶意命令注入到`mdb`或`mdc`参数中。
2.  设备接收到请求后，由于未对`mdb/mdc`参数进行充分的过滤，直接将其传递给操作系统执行，从而导致命令注入。
3.  攻击者可以利用该漏洞执行任意系统命令，例如反弹shell、修改设备配置等，从而完全控制设备。

**POC代码分析：**
提供的C代码`/tmp/013dd0f65b893aad351e530c6c5ad5a5/tbk.c` 是一个扫描器，主要功能是随机扫描IP地址，尝试建立TCP连接到80端口，并非直接用于利用 CVE-2024-3721 漏洞的POC。它用于寻找暴露在网络上的TBK DVR设备。

**有效性：**
虽然提供的C代码不是直接的漏洞利用代码，但配合github上漏洞作者提供的exp，用于探测目标可以确定其有效性。

**投毒风险：**
此代码中存在一定的投毒风险，可能性评估为10%。理由如下：
1.  **扫描行为本身：** 扫描大量IP地址可能被用于建立僵尸网络，进行DDoS攻击等恶意活动。
2.  **后门植入的可能性：** 即使当前代码没有明显的后门，作者可以在后续版本中添加恶意代码，例如在成功建立连接后，执行特定的命令或上传敏感信息。
3.  **依赖项风险：** 代码依赖的`../headers/includes.h`, `../headers/rand.h`, `../headers/util.h` 如果这些自定义头文件包含恶意代码，可能会影响扫描器的行为。由于没有给出头文件的具体内容，这部分风险无法完全评估，需要分析相关头文件。
因此，虽然提供的代码主要功能是扫描，但其潜在的恶意用途以及后续被篡改的风险需要引起重视。

**项目地址:** [qalvynn/Mirai-Based-CVE-2024-3721-Selfrep](https://github.com/qalvynn/Mirai-Based-CVE-2024-3721-Selfrep)

**漏洞详情:** [CVE-2024-3721](https://nvd.nist.gov/vuln/detail/CVE-2024-3721)

---

## POC #2

**来源**: [CVE-2024-3721-vmhalt_CVE-2024-3721.md](../2024/CVE-2024-3721-vmhalt_CVE-2024-3721.md)

## CVE-2024-3721-TBK DVR-4104/DVR-4216-OS命令注入

**漏洞编号:** CVE-2024-3721

**漏洞类型:** OS命令注入

**影响应用:** TBK DVR-4104/DVR-4216

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** <= 20240412

**利用条件:** 需要网络访问设备，且Cookie中uid=1

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3721是一个存在于TBK DVR-4104和DVR-4216设备（版本至20240412）中的操作系统命令注入漏洞。攻击者可以通过操纵`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`接口中的`mdb`和`mdc`参数来执行任意系统命令。根据提供的POC代码，利用方式如下：

1.  **漏洞触发点：** `device.rsp`接口的`mdb`和`mdc`参数。
2.  **攻击方法：** 攻击者构造包含恶意命令的HTTP GET请求，通过`mdc`参数传递经过URL编码的操作系统命令。
3.  **利用条件：** 需要知道目标设备的IP地址和端口号，以及Cookie中`uid=1`，并且受影响的设备必须是TBK DVR-4104或DVR-4216，版本小于等于20240412。
4.  **POC有效性：** 提供的Python POC脚本利用`requests`库发送带有恶意命令的HTTP GET请求。它从文件中读取目标主机列表，并使用多线程加速漏洞利用过程，因此POC是有效的。
5. **投毒风险：** POC 代码主要是发送请求，风险较低。主要风险在于攻击者可以使用该脚本对大量设备进行批量攻击，产生规模效应。对于仓库投毒风险主要是防止作者在代码中隐藏后门，经过分析，代码中只存在`requests`进行get请求，无任何恶意代码。认为存在1%风险是因为可能后续版本存在风险。

**搜索引擎结果分析：**

*   搜索结果确认了漏洞的存在，并指向了NVD、CVE、INCIBE-CERT等权威漏洞信息源。
*   部分搜索结果提供了关于漏洞的描述、影响和技术细节，以及缓解策略。
*   `ogma.in` 的链接给出了CVE-2024-3721的缓解措施

**总结：**

该漏洞的利用较为简单，攻击者只需构造特定的HTTP请求即可触发。由于漏洞利用代码已经公开，且目标设备通常暴露在互联网上，因此该漏洞的威胁程度较高，建议及时修复。

**项目地址:** [vmhalt/CVE-2024-3721](https://github.com/vmhalt/CVE-2024-3721)

**漏洞详情:** [CVE-2024-3721](https://nvd.nist.gov/vuln/detail/CVE-2024-3721)

---



---

## POC #2

**来源**: [CVE-2024-3721-qalvynn_Mirai-Based-CVE-2024-3721-Selfrep.md](../2024/CVE-2024-3721-qalvynn_Mirai-Based-CVE-2024-3721-Selfrep.md)

## CVE-2024-3721-TBK DVR-4104/DVR-4216-OS 命令注入

**漏洞编号:** CVE-2024-3721

**漏洞类型:** OS 命令注入

**影响应用:** TBK DVR-4104/DVR-4216

**危害等级:** 高危，可能导致设备被完全控制

**影响版本:** <= 20240412

**利用条件:** 需要网络访问，可能需要认证（CVE描述中提到 'PR:L'，即需要低权限）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3721 漏洞存在于TBK DVR-4104和DVR-4216设备中，版本不高于20240412。攻击者通过操纵`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`接口的`mdb/mdc`参数，可以实现OS命令注入。

**利用方式：**
1.  攻击者构造包含恶意命令的HTTP请求，目标URL为`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`，并将恶意命令注入到`mdb`或`mdc`参数中。
2.  设备接收到请求后，由于未对`mdb/mdc`参数进行充分的过滤，直接将其传递给操作系统执行，从而导致命令注入。
3.  攻击者可以利用该漏洞执行任意系统命令，例如反弹shell、修改设备配置等，从而完全控制设备。

**POC代码分析：**
提供的C代码`/tmp/013dd0f65b893aad351e530c6c5ad5a5/tbk.c` 是一个扫描器，主要功能是随机扫描IP地址，尝试建立TCP连接到80端口，并非直接用于利用 CVE-2024-3721 漏洞的POC。它用于寻找暴露在网络上的TBK DVR设备。

**有效性：**
虽然提供的C代码不是直接的漏洞利用代码，但配合github上漏洞作者提供的exp，用于探测目标可以确定其有效性。

**投毒风险：**
此代码中存在一定的投毒风险，可能性评估为10%。理由如下：
1.  **扫描行为本身：** 扫描大量IP地址可能被用于建立僵尸网络，进行DDoS攻击等恶意活动。
2.  **后门植入的可能性：** 即使当前代码没有明显的后门，作者可以在后续版本中添加恶意代码，例如在成功建立连接后，执行特定的命令或上传敏感信息。
3.  **依赖项风险：** 代码依赖的`../headers/includes.h`, `../headers/rand.h`, `../headers/util.h` 如果这些自定义头文件包含恶意代码，可能会影响扫描器的行为。由于没有给出头文件的具体内容，这部分风险无法完全评估，需要分析相关头文件。
因此，虽然提供的代码主要功能是扫描，但其潜在的恶意用途以及后续被篡改的风险需要引起重视。

**项目地址:** [qalvynn/Mirai-Based-CVE-2024-3721-Selfrep](https://github.com/qalvynn/Mirai-Based-CVE-2024-3721-Selfrep)

**漏洞详情:** [CVE-2024-3721](https://nvd.nist.gov/vuln/detail/CVE-2024-3721)

---

## POC #3

**来源**: [CVE-2024-3721-vmhalt_CVE-2024-3721.md](../2024/CVE-2024-3721-vmhalt_CVE-2024-3721.md)

## CVE-2024-3721-TBK DVR-4104/DVR-4216-OS命令注入

**漏洞编号:** CVE-2024-3721

**漏洞类型:** OS命令注入

**影响应用:** TBK DVR-4104/DVR-4216

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** <= 20240412

**利用条件:** 需要网络访问设备，且Cookie中uid=1

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3721是一个存在于TBK DVR-4104和DVR-4216设备（版本至20240412）中的操作系统命令注入漏洞。攻击者可以通过操纵`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`接口中的`mdb`和`mdc`参数来执行任意系统命令。根据提供的POC代码，利用方式如下：

1.  **漏洞触发点：** `device.rsp`接口的`mdb`和`mdc`参数。
2.  **攻击方法：** 攻击者构造包含恶意命令的HTTP GET请求，通过`mdc`参数传递经过URL编码的操作系统命令。
3.  **利用条件：** 需要知道目标设备的IP地址和端口号，以及Cookie中`uid=1`，并且受影响的设备必须是TBK DVR-4104或DVR-4216，版本小于等于20240412。
4.  **POC有效性：** 提供的Python POC脚本利用`requests`库发送带有恶意命令的HTTP GET请求。它从文件中读取目标主机列表，并使用多线程加速漏洞利用过程，因此POC是有效的。
5. **投毒风险：** POC 代码主要是发送请求，风险较低。主要风险在于攻击者可以使用该脚本对大量设备进行批量攻击，产生规模效应。对于仓库投毒风险主要是防止作者在代码中隐藏后门，经过分析，代码中只存在`requests`进行get请求，无任何恶意代码。认为存在1%风险是因为可能后续版本存在风险。

**搜索引擎结果分析：**

*   搜索结果确认了漏洞的存在，并指向了NVD、CVE、INCIBE-CERT等权威漏洞信息源。
*   部分搜索结果提供了关于漏洞的描述、影响和技术细节，以及缓解策略。
*   `ogma.in` 的链接给出了CVE-2024-3721的缓解措施

**总结：**

该漏洞的利用较为简单，攻击者只需构造特定的HTTP请求即可触发。由于漏洞利用代码已经公开，且目标设备通常暴露在互联网上，因此该漏洞的威胁程度较高，建议及时修复。

**项目地址:** [vmhalt/CVE-2024-3721](https://github.com/vmhalt/CVE-2024-3721)

**漏洞详情:** [CVE-2024-3721](https://nvd.nist.gov/vuln/detail/CVE-2024-3721)

---



---

## POC #2

**来源**: [CVE-2024-3721-qalvynn_Mirai-Based-CVE-2024-3721-Selfrep.md](../2024/CVE-2024-3721-qalvynn_Mirai-Based-CVE-2024-3721-Selfrep.md)

## CVE-2024-3721-TBK DVR-4104/DVR-4216-OS 命令注入

**漏洞编号:** CVE-2024-3721

**漏洞类型:** OS 命令注入

**影响应用:** TBK DVR-4104/DVR-4216

**危害等级:** 高危，可能导致设备被完全控制

**影响版本:** <= 20240412

**利用条件:** 需要网络访问，可能需要认证（CVE描述中提到 'PR:L'，即需要低权限）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3721 漏洞存在于TBK DVR-4104和DVR-4216设备中，版本不高于20240412。攻击者通过操纵`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`接口的`mdb/mdc`参数，可以实现OS命令注入。

**利用方式：**
1.  攻击者构造包含恶意命令的HTTP请求，目标URL为`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`，并将恶意命令注入到`mdb`或`mdc`参数中。
2.  设备接收到请求后，由于未对`mdb/mdc`参数进行充分的过滤，直接将其传递给操作系统执行，从而导致命令注入。
3.  攻击者可以利用该漏洞执行任意系统命令，例如反弹shell、修改设备配置等，从而完全控制设备。

**POC代码分析：**
提供的C代码`/tmp/013dd0f65b893aad351e530c6c5ad5a5/tbk.c` 是一个扫描器，主要功能是随机扫描IP地址，尝试建立TCP连接到80端口，并非直接用于利用 CVE-2024-3721 漏洞的POC。它用于寻找暴露在网络上的TBK DVR设备。

**有效性：**
虽然提供的C代码不是直接的漏洞利用代码，但配合github上漏洞作者提供的exp，用于探测目标可以确定其有效性。

**投毒风险：**
此代码中存在一定的投毒风险，可能性评估为10%。理由如下：
1.  **扫描行为本身：** 扫描大量IP地址可能被用于建立僵尸网络，进行DDoS攻击等恶意活动。
2.  **后门植入的可能性：** 即使当前代码没有明显的后门，作者可以在后续版本中添加恶意代码，例如在成功建立连接后，执行特定的命令或上传敏感信息。
3.  **依赖项风险：** 代码依赖的`../headers/includes.h`, `../headers/rand.h`, `../headers/util.h` 如果这些自定义头文件包含恶意代码，可能会影响扫描器的行为。由于没有给出头文件的具体内容，这部分风险无法完全评估，需要分析相关头文件。
因此，虽然提供的代码主要功能是扫描，但其潜在的恶意用途以及后续被篡改的风险需要引起重视。

**项目地址:** [qalvynn/Mirai-Based-CVE-2024-3721-Selfrep](https://github.com/qalvynn/Mirai-Based-CVE-2024-3721-Selfrep)

**漏洞详情:** [CVE-2024-3721](https://nvd.nist.gov/vuln/detail/CVE-2024-3721)

---

## POC #3

**来源**: [CVE-2024-3721-vmhalt_CVE-2024-3721.md](../2024/CVE-2024-3721-vmhalt_CVE-2024-3721.md)

## CVE-2024-3721-TBK DVR-4104/DVR-4216-OS命令注入

**漏洞编号:** CVE-2024-3721

**漏洞类型:** OS命令注入

**影响应用:** TBK DVR-4104/DVR-4216

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** <= 20240412

**利用条件:** 需要网络访问设备，且Cookie中uid=1

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3721是一个存在于TBK DVR-4104和DVR-4216设备（版本至20240412）中的操作系统命令注入漏洞。攻击者可以通过操纵`/device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___`接口中的`mdb`和`mdc`参数来执行任意系统命令。根据提供的POC代码，利用方式如下：

1.  **漏洞触发点：** `device.rsp`接口的`mdb`和`mdc`参数。
2.  **攻击方法：** 攻击者构造包含恶意命令的HTTP GET请求，通过`mdc`参数传递经过URL编码的操作系统命令。
3.  **利用条件：** 需要知道目标设备的IP地址和端口号，以及Cookie中`uid=1`，并且受影响的设备必须是TBK DVR-4104或DVR-4216，版本小于等于20240412。
4.  **POC有效性：** 提供的Python POC脚本利用`requests`库发送带有恶意命令的HTTP GET请求。它从文件中读取目标主机列表，并使用多线程加速漏洞利用过程，因此POC是有效的。
5. **投毒风险：** POC 代码主要是发送请求，风险较低。主要风险在于攻击者可以使用该脚本对大量设备进行批量攻击，产生规模效应。对于仓库投毒风险主要是防止作者在代码中隐藏后门，经过分析，代码中只存在`requests`进行get请求，无任何恶意代码。认为存在1%风险是因为可能后续版本存在风险。

**搜索引擎结果分析：**

*   搜索结果确认了漏洞的存在，并指向了NVD、CVE、INCIBE-CERT等权威漏洞信息源。
*   部分搜索结果提供了关于漏洞的描述、影响和技术细节，以及缓解策略。
*   `ogma.in` 的链接给出了CVE-2024-3721的缓解措施

**总结：**

该漏洞的利用较为简单，攻击者只需构造特定的HTTP请求即可触发。由于漏洞利用代码已经公开，且目标设备通常暴露在互联网上，因此该漏洞的威胁程度较高，建议及时修复。

**项目地址:** [vmhalt/CVE-2024-3721](https://github.com/vmhalt/CVE-2024-3721)

**漏洞详情:** [CVE-2024-3721](https://nvd.nist.gov/vuln/detail/CVE-2024-3721)

---

