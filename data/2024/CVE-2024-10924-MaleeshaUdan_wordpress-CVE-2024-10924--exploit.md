## CVE-2024-10924 - Really Simple Security (Free, Pro, and Pro Multisite) 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress的Really Simple Security（原Really Simple SSL）插件中。漏洞的核心在于REST API处理逻辑中的'skip_onboarding'端点未对用户身份进行充分验证。提供的Python脚本POC展示了攻击者如何利用该漏洞：通过向'/reallysimplessl/v1/two_fa/skip_onboarding'发送一个精心构造的POST请求，并附带目标用户ID（通常管理员ID为1），即使在未提供有效login_nonce的情况下，受影响的插件版本仍会错误地验证该操作并生成有效的身份验证Cookie。经分析，此POC代码逻辑严谨，直接针对漏洞触发点，通过捕获返回的Set-Cookie响应头实现登录绕过，证明了漏洞的可利用性极高。利用步骤：首先，攻击者需确定目标WordPress站点是否安装了受影响版本的Really Simple Security插件。其次，通过枚举或猜测获取管理员用户的ID（常为1）。最后，运行此Python POC脚本，通过REST API接口发送模拟登录请求。若攻击成功，脚本将输出包含身份验证信息的Session Cookies，攻击者可直接将这些Cookies导入浏览器，从而以管理员身份接管站点。 投毒风险分析：该POC代码主要使用了Python的标准库requests、urllib和sys，代码结构透明，没有经过任何形式的代码混淆或加密处理。通过静态代码扫描，未发现存在下载外部恶意载荷、窃取本地环境变量、建立反向Shell或对非目标IP进行扫描的行为。代码中的逻辑仅限于发送特定的HTTP POST请求并打印响应中的Cookie信息，符合常规安全研究和渗透测试工具的规范。其潜在风险主要集中在社会工程学层面：README文件中提及了‘潜在的完全服务器控制’，虽然这符合RCE后的预期结果，但在某些环境下，此类描述常被恶意软件发布者用作诱饵（Scam-poc）。然而，就目前的代码内容而言，其投毒风险处于低位（约15%），主要风险点在于其依赖外部的requests库，若在不安全的环境下运行，需警惕库劫持风险。对于防御方，建议在隔离的沙箱环境中验证此类POC，并重点审计代码中是否存在动态执行函数如eval()或exec()，本代码未包含此类风险函数。

**项目地址:** [https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker](https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
