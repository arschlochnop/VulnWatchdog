# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

# CVE-2024-3094

> 📦 该CVE有 **37** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-3094-0xlane_xz-cve-2024-3094.md](../2024/CVE-2024-3094-0xlane_xz-cve-2024-3094.md)

## CVE-2024-3094-XZ Utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，且openssh链接了liblzma

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到 liblzma 库的构建过程中。

**有效性：**

提供的 `Makefile.diff` 代码片段展示了对 Makefile 的修改，这些修改旨在将恶意代码注入到构建过程中。具体来说，它利用了 `am__dist_setup` 变量，该变量用于在构建过程中执行一段 shell 脚本。这个脚本从一个被伪装成测试文件的文件中提取恶意代码，并将其插入到 liblzma 库中。同时该diff还增加了 `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X,-z,now` 用于隐藏恶意代码。

**投毒风险：**

此仓库中极有可能存在作者隐藏的投毒代码。虽然主要目的是复现和验证已知的后门，但攻击者可能会在其中添加额外的恶意功能，例如：

*   **持久化机制：** 添加自启动脚本或修改系统配置文件，确保后门在系统重启后依然存在。
*   **数据窃取：** 在 SSH 会话中捕获用户名、密码或其他敏感信息，并将其发送到远程服务器。
*   **横向移动：** 利用受感染的系统作为跳板，扫描并攻击内网中的其他主机。
*   **隐藏 Payload:** 使用更高级的混淆技术或者加密payload，绕过检测。

考虑到这些风险，将此仓库视为高风险的投毒源是合理的。估计投毒风险为85%。

**利用方式：**

1.  **代码注入：** 攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，通常是通过提交看似无害的补丁或 PR。`Makefile.diff` 文件显示了如何通过修改构建系统来实现这一点。
2.  **构建过程劫持：** 受感染的源代码在构建时，恶意代码会被提取并插入到 liblzma 库中。这个过程通常涉及复杂的混淆技术，以避免被安全软件检测到。
3.  **SSH 后门：** 修改后的 liblzma 库会被 SSH 使用，从而允许攻击者在未经授权的情况下远程访问系统。具体来说，后门会拦截 SSH 的身份验证过程，并在满足特定条件时允许攻击者绕过身份验证。

总结：该漏洞利用的关键在于修改构建过程，将恶意代码注入到 liblzma 库中，最终实现 SSH 后门。

**项目地址:** [0xlane/xz-cve-2024-3094](https://github.com/0xlane/xz-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #2

**来源**: [CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md](../2024/CVE-2024-3094-24Owais_threat-intel-cve-2024-3094.md)

## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #3

**来源**: [CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md](../2024/CVE-2024-3094-AndreaCicca_Sicurezza-Informatica-Presentazione.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #4

**来源**: [CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md](../2024/CVE-2024-3094-B1ack4sh_Blackash-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致未经授权的远程访问和完全系统入侵

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且sshd等服务动态链接到liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的供应链后门。该漏洞并非传统的代码缺陷，而是在构建过程中通过复杂的混淆手段，将预先构建的恶意对象文件注入到 liblzma 库中。

**有效性:**
提供的README.md文件并非直接的漏洞利用代码，而是一份关于CVE-2024-3094漏洞的详细分析报告，它描述了漏洞的发生方式、影响范围、检测方法和缓解步骤。该报告验证了漏洞的存在和影响。

**投毒风险:**
该README.md文件本身不太可能包含任何投毒代码。主要原因是：

1.  **信息呈现为主：**  该文件主要用于信息展示和分析，而非直接的可执行代码。
2.  **内容透明：**  文件内容以Markdown格式呈现，方便人工审查，隐藏恶意代码的难度较高。
3.  **来源可追溯：**  该存储库可以被追踪和审计，增加了投毒的风险和成本。但是依旧存在1%的风险因为如果被入侵账号上传投毒文件,依旧存在风险。

**利用方式:**
该漏洞的利用方式非常复杂，并非简单的代码执行。其核心在于:

1.  **构建时注入：**  恶意代码在liblzma的构建过程中被插入，而不是存在于源代码中。
2.  **IFUNC劫持：**  恶意代码通过IFUNC（Indirect Function Call）机制，劫持liblzma中的特定函数调用。
3.  **SSH认证绕过：**  被劫持的函数通常与SSH服务相关，攻击者可以通过发送特制的密钥，绕过SSH认证，从而获得远程访问权限。

**利用流程总结:**

1.  **攻击者获取XZ Utils项目的贡献权限（可能是通过长期渗透和伪装）。**
2.  **攻击者在发布tarball中插入恶意代码，但不在Git仓库中暴露。**
3.  **用户下载并构建受感染的XZ Utils版本。**
4.  **liblzma库被恶意代码修改。**
5.  **sshd等服务链接到被修改的liblzma库。**
6.  **攻击者使用特制密钥尝试SSH连接，成功绕过认证并获得访问权限。**

**项目地址:** [B1ack4sh/Blackash-CVE-2024-3094](https://github.com/B1ack4sh/Blackash-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #5

**来源**: [CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md](../2024/CVE-2024-3094-Bella-Bc_xz-backdoor-CVE-2024-3094-Check.md)

## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #6

**来源**: [CVE-2024-3094-DANO-AMP_CVE-2024-3094.md](../2024/CVE-2024-3094-DANO-AMP_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Supply Chain Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统必须使用受感染的 XZ Utils 版本，且SSH服务需要链接到受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个供应链攻击，恶意代码被插入到 XZ Utils 的上游 tarball 中。此恶意代码在构建过程中被提取并用于修改 liblzma 库的特定函数。修改后的库允许攻击者绕过 SSH 身份验证并可能执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞的威胁级别为“Critical”，且有公开的利用方法。尽管提供的漏洞利用代码针对 CVE-2024-6387，似乎是一个独立的漏洞，但考虑到 CVE-2024-3094 允许在受感染的系统上远程执行代码，可以推断针对该漏洞的攻击利用的有效性很高。特别是考虑到多个安全公告和分析报告都证实了漏洞的存在和潜在影响。

**投毒风险评估：**

提供的漏洞利用代码针对不同的漏洞 (CVE-2024-6387)，但是，分析`exploit.c` 文件的结构可以发现一些潜在的风险。

*   **Shellcode 替换：** 代码包含一个 `shellcode` 变量，明确指出需要“替换为实际的 shellcode”。如果用户直接使用此代码而不替换 shellcode，那么漏洞利用将不会成功。然而，恶意攻击者可能通过替换 shellcode 来植入恶意负载，从而实现投毒。
*   **GLIBC 基地址：** 代码依赖于预定义的 `GLIBC_BASES` 地址。如果目标系统的 GLIBC 基地址不在列表中，则漏洞利用将失败。攻击者可以在此部分加入不稳定的地址或者恶意地址进行投毒。
*   **Timing 参数：** 注释中提到需要根据目标系统调整 Timing 参数。不正确的 Timing 参数可能会导致拒绝服务或其他意外行为。
*  **潜在的后门：**  代码中包含了绕过身份验证的逻辑和执行远程代码的能力，这本身就可以被视为一个后门。但是，这部分代码是漏洞利用的一部分，并非作者隐藏的恶意代码。

总体而言，该漏洞利用代码本身不包含明显的投毒代码，但是如果用户不小心使用了不正确的shellcode或者参数，可能会造成系统不稳定，或者被攻击者利用。投毒风险评估为 10%。

**利用方式：**

1.  **供应链攻击：** 攻击者首先将恶意代码注入到 XZ Utils 的上游 tarball 中。
2.  **构建过程劫持：** 在构建过程中，恶意代码被提取并用于修改 liblzma 库。
3.  **SSH 身份验证绕过：** 修改后的 liblzma 库被用于 SSH 服务，允许攻击者绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**项目地址:** [DANO-AMP/CVE-2024-3094](https://github.com/DANO-AMP/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #7

**来源**: [CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md](../2024/CVE-2024-3094-Ikram124_CVE-2024-3094-analysis.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的XZ Utils版本被安装且sshd使用liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils库中的一个后门，影响版本5.6.0和5.6.1。攻击者通过一系列复杂的混淆，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致修改后的liblzma库被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。最关键的影响是，该后门允许攻击者绕过SSH身份验证，并可能执行远程代码。漏洞的利用方式是通过恶意代码修改了sshd，使其在身份验证过程中存在漏洞。提供的漏洞利用代码（README.md）本身并不直接提供攻击代码，而是对漏洞进行了描述，并给出了缓解措施。因此，判断POC有效性应该考虑结合其他资料，此README.md起辅助描述作用。投毒风险评估：此README.md文件主要提供漏洞描述和防御建议，虽然可以作为学习资料，但潜在的风险在于，攻击者可能利用此仓库进行混淆，在看似无害的代码中隐藏恶意代码。例如，在相关脚本或配置示例中植入恶意指令。因此，存在一定的投毒风险，预估占比为10%。

**项目地址:** [Ikram124/CVE-2024-3094-analysis](https://github.com/Ikram124/CVE-2024-3094-analysis)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---



---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---



---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---



---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---



---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---



---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---



---

## POC #8

**来源**: [CVE-2024-3094-Juul_xz-backdoor-scan.md](../2024/CVE-2024-3094-Juul_xz-backdoor-scan.md)

## CVE-2024-3094-xz-backdoor-scan

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 后门扫描

**影响应用:** xz-utils

**危害等级:** 信息泄露，可能导致误报或漏报

**影响版本:** N/A

**利用条件:** 需要目标系统存在xz-utils相关文件，并已编译执行该扫描工具

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码是一个用于扫描CVE-2024-3094漏洞（xz后门）的工具，而非漏洞利用代码。它通过搜索特定签名来检测系统中是否存在被感染的文件。根据代码逻辑，该工具本身没有明显的投毒行为。它只是一个扫描器，用于检测是否存在已知的后门签名。

**有效性：**
该代码的有效性取决于其签名数据库的准确性和完整性。如果签名数据库不完整或不准确，则可能导致漏报或误报。

**投毒风险：**
代码本身的功能是扫描特定签名，没有发现恶意代码或后门代码。因此，投毒风险较低。

**利用方式：**
该工具的"利用"方式是帮助用户检测系统中是否存在CVE-2024-3094后门。用户可以使用该工具扫描文件系统，查找包含后门签名的文件。如果找到包含签名的文件，则表示系统可能受到了攻击。

**项目地址:** [Juul/xz-backdoor-scan](https://github.com/Juul/xz-backdoor-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #9

**来源**: [CVE-2024-3094-M1lo25_CS50FinalProject.md](../2024/CVE-2024-3094-M1lo25_CS50FinalProject.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #10

**来源**: [CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md](../2024/CVE-2024-3094-Security-Phoenix-demo_CVE-2024-3094-fix-exploits.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，允许未经授权的远程SSH访问，可能导致远程代码执行和数据泄露

**影响版本:** 5.6.0和5.6.1

**利用条件:** 目标系统必须使用受感染的xz-utils版本，且sshd链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门漏洞。该漏洞通过一系列复杂的混淆，在liblzma的构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响，恶意代码可以拦截和修改与该库的数据交互。 

**有效性分析：**
提供的POC代码主要是检测脚本，用于判断系统是否存在CVE-2024-3094漏洞。这些脚本通过以下方式进行检测：

1.  **检查liblzma是否被sshd使用：**  脚本首先查找sshd使用的liblzma库的路径。
2.  **检查函数签名：**  脚本使用hexdump命令检查liblzma库中是否存在特定的恶意函数签名。
3.  **检查xz版本：**  脚本检查xz工具的版本，判断是否为受影响的版本（5.6.0或5.6.1）。

如果所有检查都表明存在漏洞，则脚本会报告系统可能易受攻击。因此，提供的脚本**并非漏洞利用代码，而是检测脚本**，用于验证系统是否受到影响。根据搜索引擎结果，存在利用此漏洞进行远程代码执行的潜在可能，但提供的代码仅用于检测。

**投毒风险分析：**
虽然提供的脚本本身的主要功能是检测漏洞，但是仍需对脚本内容进行细致的分析，防范作者在其中隐藏潜在的恶意代码。以下是分析结果：

1.  **脚本来源：**  脚本来自于开源社区，并经过了修改。
2.  **代码混淆：**  脚本本身没有明显的代码混淆。
3.  **外部命令调用：**  脚本使用了`whereis`、`ldd`、`grep`、`awk`、`hexdump`、`sort`等外部命令。虽然这些命令本身是系统自带的，但如果系统中的这些命令被替换为恶意版本，则可能导致安全风险。
4.  **版本检查逻辑：**  版本检查的逻辑相对简单，但是如果存在其他漏洞，可能会被绕过。
5.  **修改历史：**  脚本经过了修改，需要仔细审查修改内容，确保没有引入恶意代码。

综上所述，此仓库中存在作者隐藏投毒代码的风险较低，但不能完全排除，概率约为**10%**。

**利用方式分析：**
根据漏洞信息和搜索结果，CVE-2024-3094漏洞的利用方式如下：

1.  **供应链攻击：**  攻击者通过入侵xz-utils的开发流程，将恶意代码注入到xz-utils的源代码中。
2.  **构建过程注入：**  恶意代码在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并修改liblzma代码中的特定函数。
3.  **SSH后门：**  被修改的liblzma库会被sshd等程序链接，从而允许攻击者绕过SSH身份验证，获得未经授权的远程访问权限。
4.  **远程代码执行：**  攻击者可以通过SSH后门执行任意代码，从而控制受影响的系统。

**总结：**
CVE-2024-3094是一个严重的供应链后门漏洞，攻击者通过修改xz-utils的源代码，在liblzma库中植入恶意代码，从而允许未经授权的远程SSH访问。提供的POC代码主要是检测脚本，用于判断系统是否存在漏洞，**并不包含直接的漏洞利用代码**。虽然脚本本身投毒风险较低，但仍需谨慎使用，并仔细审查其内容。

**项目地址:** [Security-Phoenix-demo/CVE-2024-3094-fix-exploits](https://github.com/Security-Phoenix-demo/CVE-2024-3094-fix-exploits)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #11

**来源**: [CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-TheTorjanCaptain_CVE-2024-3094-Checker.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #12

**来源**: [CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md](../2024/CVE-2024-3094-ThomRgn_xzutils_backdoor_obfuscation.md)

## CVE-2024-3094 Xz 后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz

**危害等级:** 极危，可能导致未经授权的远程访问和系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的 xz 版本，并且 sshd 等服务链接了 liblzma

**POC 可用性:** 是（但此处提供的代码只是LICENSE文件，并非PoC代码）

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 xz-utils 库的供应链攻击事件。在 5.6.0 和 5.6.1 版本的 xz 压缩包中发现了恶意代码。该恶意代码在构建过程中被注入到 liblzma 库中，最终导致 sshd 在启动时被劫持。攻击者可以通过特定的加密密钥连接到系统，从而获得未经授权的访问权限。攻击利用方式是精心构造的混淆代码，在构建时提取预构建的目标文件，修改 liblzma 库的特定函数，最终影响 sshd 的行为。该漏洞的危害极大，因为 xz-utils 是一个广泛使用的库，许多 Linux 发行版都受到了影响。

提供的代码只是一个 GNU GPL 许可证文件，不是漏洞利用的PoC代码，因此无法直接用于验证漏洞。因此无法验证有效性。

此仓库中的代码文件LICENSE, 是一个开源协议许可，没有发现作者隐藏的投毒代码, 投毒风险为 0%。

**项目地址:** [ThomRgn/xzutils_backdoor_obfuscation](https://github.com/ThomRgn/xzutils_backdoor_obfuscation)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #13

**来源**: [CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md](../2024/CVE-2024-3094-Titus-soc_-CVE-2024-3094-Vulnerability-Checker-Fixer-Public.md)

## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #14

**来源**: [CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md](../2024/CVE-2024-3094-XiaomingX_cve-2024-3094-xz-backdoor-exploit.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该恶意代码以复杂的方式隐藏在源代码中，并在构建过程中被提取和激活。它修改了 liblzma 库，使得任何链接到该库的软件都可能受到影响。 

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且已经有实际的利用案例。该漏洞的影响非常严重。

**投毒风险：**  提供的代码段是Apache 2.0 License文件。 它本身不包含任何恶意代码或投毒行为。整个漏洞事件是源于供应链投毒，有人向XZ Utils的源代码中插入了恶意代码。根据提供的信息，license文件本身没有风险，投毒风险为0%。

**利用方式：**
1.  **恶意代码注入：** 攻击者向 XZ Utils 的源代码中注入恶意代码，该代码被伪装成测试文件的一部分，并通过复杂的构建过程提取出来。
2.  **liblzma 库修改：** 提取出的恶意代码修改了 liblzma 库中的特定函数。
3.  **SSH 认证绕过：** 修改后的 liblzma 库允许攻击者绕过 SSH 认证，从而实现未经授权的远程访问。
4.  **远程代码执行：** 成功绕过 SSH 认证后，攻击者可以执行任意代码，从而完全控制受影响的系统。

**项目地址:** [XiaomingX/cve-2024-3094-xz-backdoor-exploit](https://github.com/XiaomingX/cve-2024-3094-xz-backdoor-exploit)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #15

**来源**: [CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md](../2024/CVE-2024-3094-alokemajumder_CVE-2024-3094-Vulnerability-Checker-Fixer.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未授权远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的xz版本，并且ssh服务链接了liblzma库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094 描述了 XZ Utils 工具包中发现的恶意代码。此代码是一个供应链攻击的产物，影响了 5.6.0 和 5.6.1 版本。攻击者通过复杂的混淆技术，将预先构建的目标文件插入到 liblzma 的构建过程中，修改了 liblzma 的代码。这导致任何链接到该库的软件都可能被劫持。**利用方式：** 这个后门主要影响 SSH 服务，攻击者可以绕过 SSH 身份验证，实现未授权的远程代码执行。攻击链包括：

1.  恶意代码被嵌入到 xz 的上游 tarball 中。
2.  构建系统在构建 liblzma 时提取恶意代码。
3.  恶意代码修改 liblzma 库。
4.  SSH 服务链接到被修改的 liblzma 库。
5.  攻击者利用修改后的 SSH 服务进行未授权访问。

**关于提供的脚本：** 提供的 `CVE-2024-3094.sh` 脚本并非漏洞利用代码，而是一个**缓解脚本**，用于检测和修复受影响的 xz 版本。它通过以下步骤工作：

1.  检测操作系统和包管理器。
2.  获取当前 xz 版本。
3.  如果版本是易受攻击的（5.6.0 或 5.6.1），则尝试升级到最新版本或安装稳定的旧版本（5.4.6）。

**投毒风险分析：** 脚本本身是一个安全脚本，目标是修复漏洞。但是，仍然存在一定的投毒风险：

*   **依赖外部源：** 脚本从外部 URL 下载稳定的 xz 版本（`https://excellmedia.dl.sourceforge.net/project/lzmautils/xz-5.4.6.tar.bz2`）。如果此源被攻破，脚本可能会下载恶意软件。
*   **`make install` 的风险：** 脚本使用 `make install` 安装 xz。`make install` 过程可能会执行 Makefile 中定义的任意命令，如果 Makefile 被篡改，可能导致恶意代码执行。
*   **权限提升：** 脚本需要 `sudo` 权限才能执行升级和安装操作。如果脚本本身存在漏洞，攻击者可能会利用此漏洞提升权限。

因此，尽管脚本的意图是好的，但仍然存在一些潜在的风险。我对这个脚本的投毒风险评估为 20%，因为虽然作者提供了许可证，但是由于脚本行为包含下载文件，编译，和使用root权限等敏感操作，存在风险。

**项目地址:** [alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer](https://github.com/alokemajumder/CVE-2024-3094-Vulnerability-Checker-Fixer)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #16

**来源**: [CVE-2024-3094-amlweems_xzbot.md](../2024/CVE-2024-3094-amlweems_xzbot.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。这个后门允许攻击者绕过 SSH 身份验证并执行远程代码。 

**有效性:**
提供的POC代码显示了利用此漏洞的有效方法。它包括：
*   一个蜜罐，用于检测利用尝试。
*   一个用于将 liblzma.so 补丁到使用攻击者自己的 ED448 公钥的代码。这允许攻击者触发后门。
*   后门payload格式的描述，包括加密和签名方案。
*   一个命令行工具 (xzbot) 用于触发远程代码执行。

根据POC代码和搜索结果，该漏洞可以被成功利用。

**投毒风险:**
此仓库中存在投毒代码的风险较低，但仍不能完全排除。理由如下：
*   **公开透明:** 该仓库旨在探索已知的漏洞，并提供利用和检测的方法。代码的目的是为了复现漏洞。
*   **定制化利用:** 提供的 `patch.py` 脚本用于修改 `liblzma.so` 文件。如果脚本被恶意修改，可能会引入其他漏洞或恶意行为。然而，这种风险取决于用户是否仔细检查脚本的内容。
*   **依赖外部资源:** 该代码依赖于从其他地方下载受感染的 `liblzma.so` 文件。如果下载源被篡改，可能会导致执行恶意代码。
*   **密钥的安全性:** 仓库中硬编码了攻击者的密钥。如果攻击者更换密钥或者使用其他方式，则当前代码无法有效利用。

虽然该仓库的主要目标是研究和演示已知的漏洞，但用户仍需谨慎，并仔细检查所有代码和依赖项，以避免潜在的风险。

**利用方式:**
1.  **准备环境:** 准备一台运行易受攻击的 XZ Utils 版本的 Linux 系统，并且sshd 链接了 liblzma。
2.  **获取payload:** 获取一个 backdoored 的 `liblzma.so` 共享对象（例如，从 https://snapshot.debian.org/package/xz-utils/5.6.1-1）。
3.  **替换公钥（可选但推荐）:** 使用 `patch.py` 脚本将 liblzma.so 中的攻击者的 ED448 公钥替换为您自己的公钥，这样您可以控制后门。
4.  **运行 SSH 服务器:** 使用修改后的 `liblzma.so` 运行 SSH 服务器。
5.  **生成Payload:** 使用 `xzbot` 工具生成包含恶意命令的payload。
6.  **触发后门:** 使用 SSH 客户端连接到目标服务器。`xzbot` 工具会自动构造包含恶意 payload 的 SSH 证书。
7.  **远程代码执行:** 后门将提取 payload、解密并验证签名，然后使用 `system()` 函数执行恶意命令。

**项目地址:** [amlweems/xzbot](https://github.com/amlweems/xzbot)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #17

**来源**: [CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md](../2024/CVE-2024-3094-badsectorlabs_ludus_xz_backdoor.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #18

**来源**: [CVE-2024-3094-been22426_CVE-2024-3094.md](../2024/CVE-2024-3094-been22426_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd等服务链接了受感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被插入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过复杂的混淆手段，在构建liblzma库时从伪装的测试文件中提取预编译的目标文件，并修改liblzma代码中的特定函数。这导致任何链接到这个被修改的liblzma库的软件都可能受到影响。最关键的利用点在于，该后门能够拦截并修改与liblzma库的数据交互，攻击者可以通过SSH服务进行未经授权的远程访问，甚至是执行任意代码。

**有效性：**
提供的Dockerfile和docker-compose.yaml文件旨在重现该漏洞。Dockerfile配置了一个Debian experimental镜像，安装了openssh-server，curl，vim和net-tools等工具，并允许root用户通过密码进行SSH登录。docker-compose.yaml定义了如何构建和运行包含漏洞的Docker容器，通过端口映射将容器的22端口映射到宿主机的2222端口。README.md 包含验证步骤，其中包括：
1. 确认容器中安装的liblzma5版本为5.6.0
2. 确认sshd 是否使用了 liblzma.so
3. 运行PoC脚本，验证后门是否存在。
根据README.md描述，这个环境能够成功复现漏洞并检测到后门，表明该POC代码是有效的。

**投毒风险：**
虽然该仓库提供了一个用于重现CVE-2024-3094漏洞的环境，但存在一定的投毒风险。主要考虑到以下几个因素：
1. **Dockerfile中的基础镜像**：使用了`debian:experimental-20240311`镜像。`experimental`分支通常包含未经完全测试的软件包，可能引入其他未知的安全问题。虽然这不一定是恶意的，但增加了潜在的风险。
2. **SSH配置**：Dockerfile中启用了`PermitRootLogin yes`，允许root用户通过密码登录。虽然这简化了漏洞验证过程，但在生产环境中是极其不安全的做法，容易被恶意利用。
3. **PoC脚本**：`poc_detect_backdoor.sh` 脚本的内容并没有直接给出，因此不能确定脚本是否存在恶意行为。即使当前脚本是安全的，也存在未来被替换为恶意脚本的风险。
总体来说，作者直接投毒的可能性较低，约10%。但是，由于Dockerfile配置和基础镜像选择存在一定的风险，用户在使用这个环境时需要格外小心。

**利用方式：**
1.  **供应链攻击：** 恶意代码被插入到XZ Utils的发布版本中，影响了使用这些版本的用户。
2.  **SSH后门：** 受感染的liblzma库被sshd服务链接后，攻击者可以利用后门绕过SSH身份验证。
3.  **远程代码执行：** 成功绕过SSH身份验证后，攻击者可以执行任意命令，从而完全控制受感染的系统。

**项目地址:** [been22426/CVE-2024-3094](https://github.com/been22426/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #19

**来源**: [CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md](../2024/CVE-2024-3094-crfearnworks_ansible-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接到了liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门漏洞。恶意代码通过复杂的混淆手段，在构建 liblzma 库时，从伪装的测试文件中提取预构建的目标文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被利用。根据搜索引擎结果和漏洞库信息，该漏洞影响严重，CVSS 评分为 10.0 (Critical)。

**有效性评估：**
提供的 Ansible Playbook 旨在检测和修复该漏洞。`CVE-2024-3094-check.yml` 检查 XZ Utils 的版本，并使用 JFrog 提供的检测工具进行更深入的分析。`CVE-2024-3094-fix.yml` 尝试将 XZ Utils 降级到安全版本，并添加一个字符串到`/etc/environment`中（尽管这个字符串的目的并不明确，可能并非官方缓解措施），然后重启 SSH 服务。这些操作整体上是合理的，可以用于缓解该漏洞。因此，提供的PoC代码在检测和缓解漏洞方面是有效的。

**投毒风险评估：**
该仓库的投毒风险评估为 10%。理由如下：
1.  `CVE-2024-3094-check.yml` 使用了 `jfrog/cve-2024-3094-tools` 项目的检测工具，该工具本身是用于检测漏洞的，不太可能包含恶意代码。
2.  `CVE-2024-3094-fix.yml` 尝试降级 XZ Utils 版本，这是一个常见的缓解措施，但`Add string to disable backdoor functionality`这一步有风险。虽然它尝试添加一个随机字符串到`/etc/environment`，但添加这个字符串的目的并不明确，可能并不起作用，甚至可能被用作未来的触发器，这是一个潜在的投毒点。重启 SSH 服务也是一个潜在风险，如果降级失败，可能导致 SSH 服务不可用。
3.  该仓库包含 `LICENSE` 文件，表明作者声明了版权并提供了 MIT 许可证，这在一定程度上降低了恶意投毒的可能性，但并不能完全排除风险。

总的来说，该仓库的主要目的是提供检测和缓解 CVE-2024-3094 的工具，但`CVE-2024-3094-fix.yml` 中的某些步骤存在潜在风险，因此存在轻微的投毒可能性。 用户在使用时需要谨慎审核 `CVE-2024-3094-fix.yml` 中的每一步操作，确认其安全性和必要性。

**利用方式分析：**
该漏洞的利用方式是，攻击者通过供应链攻击，将包含恶意代码的XZ Utils版本分发给用户。受感染的 XZ Utils 会修改 liblzma 库，当 OpenSSH 链接到该库时，恶意代码可以拦截 SSH 连接，绕过身份验证，并执行任意代码。攻击者可以通过发送特定的恶意 SSH 请求来触发后门，从而控制受害者的系统。

**项目地址:** [crfearnworks/ansible-CVE-2024-3094](https://github.com/crfearnworks/ansible-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #20

**来源**: [CVE-2024-3094-felipecosta09_cve-2024-3094.md](../2024/CVE-2024-3094-felipecosta09_cve-2024-3094.md)

## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击 / 后门

**影响应用:** XZ Utils

**危害等级:** 极高，允许未经授权的远程SSH访问，可能导致完全系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统必须使用受感染的XZ Utils版本，并且SSH服务使用该库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一起严重的供应链攻击事件，攻击者在广泛使用的 XZ Utils 压缩工具中植入后门。该后门主要影响 5.6.0 和 5.6.1 版本。漏洞利用方式是通过修改 liblzma 库，在 SSH 认证过程中进行劫持，从而允许攻击者在没有密码的情况下远程访问系统。

**有效性：**
从搜索引擎结果和漏洞描述来看，此漏洞影响严重，并且存在可利用的条件。提供的 Dockerfile 旨在创建一个包含易受攻击的 Debian 系统镜像，可以用来验证该漏洞的存在。

**投毒风险：**
提供的 Dockerfile 和 LICENSE 文件本身不包含任何恶意代码或投毒行为。Dockerfile 只是定义了如何构建一个包含脆弱版本的XZ Utils的Debian镜像。LICENSE是Apache 2.0许可协议。

**利用方式：**
1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的上游 tarball 中，通过复杂的混淆手段，在构建过程中将预编译的对象文件插入到 liblzma 库中。
2.  **SSH 劫持：** 受感染的 liblzma 库会修改 SSH 守护程序的行为，允许攻击者在没有有效凭据的情况下进行身份验证。
3.  **远程访问：** 攻击者可以利用修改后的 SSH 守护程序获得对受害系统的未经授权的远程访问权限。

**搜索引擎结果强调：**
*   该漏洞的严重性和广泛影响。
*   远程代码执行的潜力。
*   多种工具和博客文章讨论了漏洞检测和缓解。

**项目地址:** [felipecosta09/cve-2024-3094](https://github.com/felipecosta09/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #21

**来源**: [CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md](../2024/CVE-2024-3094-fevar54_Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #22

**来源**: [CVE-2024-3094-gustavorobertux_CVE-2024-3094.md](../2024/CVE-2024-3094-gustavorobertux_CVE-2024-3094.md)

## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的系统需要链接到被污染的liblzma库，并且sshd使用systemd进行服务管理（在某些发行版中）。x86_64架构上更容易受到攻击。

**POC 可用性:** 是，但提供的代码是检测工具而非利用代码

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述的是 xz-utils 工具中的一个供应链后门。恶意代码被嵌入到上游的 xz tarballs 中，起始于 5.6.0 版本。该后门通过复杂的混淆手段，在 liblzma 的构建过程中从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能受到影响。关键的利用点在于修改后的 liblzma 库可以拦截并修改与该库的数据交互。

**有效性分析：**
提供的Go代码并不是一个利用此漏洞的POC，而是一个检测工具，用于检查系统是否存在CVE-2024-3094漏洞。它主要通过检查`liblzma`库中是否存在特定的函数签名来判断是否已被感染。

**投毒风险分析：**
此代码本身是一个检测工具，主要功能是检测系统是否存在后门。代码中包含`strings.Contains(string(sigCheck), "f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410")`用于检测是否存在恶意代码的特征码，相对安全。代码虽然会执行外部命令，例如`whereis`、`ldd`和`hexdump`，但这些命令的使用方式相对标准，注入恶意参数的风险较低。尽管如此，仍然存在一定的风险：
1.  **依赖外部命令:** 代码依赖于系统中的`whereis`、`ldd`和`hexdump`命令。如果这些命令被恶意替换，可能导致代码执行恶意操作。
2.  **路径处理:** 代码使用`strings.Fields`和`strings.Split`函数处理命令的输出，提取`liblzma`的路径。如果输出格式不符合预期，可能导致路径提取错误，甚至可能导致代码执行意外的操作。
3.  **依赖检测特征码:** 代码依赖`f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410`特征码。如果后门代码的特征码发生变化，此检测工具将失效。

因此，综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者向 xz-utils 的源代码中注入恶意代码。
2.  **构建过程劫持：** 恶意代码在构建过程中被激活，修改 liblzma 库。
3.  **SSH后门：** 修改后的 liblzma 库在 SSH 守护进程（sshd）加载时，通过 systemd 机制劫持 SSH 身份验证过程，允许攻击者在未经授权的情况下远程访问系统。

**总而言之:** 该漏洞的核心在于通过复杂的构建过程篡改 liblzma 库，进而影响依赖该库的应用程序，特别是 SSH 服务。利用成功后，攻击者可以绕过 SSH 身份验证，实现远程代码执行。

**项目地址:** [gustavorobertux/CVE-2024-3094](https://github.com/gustavorobertux/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #23

**来源**: [CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md](../2024/CVE-2024-3094-iheb2b_CVE-2024-3094-Checker.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #24

**来源**: [CVE-2024-3094-jfrog_cve-2024-3094-tools.md](../2024/CVE-2024-3094-jfrog_cve-2024-3094-tools.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #25

**来源**: [CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md](../2024/CVE-2024-3094-laxmikumari615_Linux---Security---Detect-and-Mitigate-CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #26

**来源**: [CVE-2024-3094-mrk336_CVE-2024-3094.md](../2024/CVE-2024-3094-mrk336_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #27

**来源**: [CVE-2024-3094-neuralinhibitor_xzwhy.md](../2024/CVE-2024-3094-neuralinhibitor_xzwhy.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受感染的XZ Utils版本，且OpenSSH等服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过一系列复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 代码中的特定函数。这导致修改后的 liblzma 库能够被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性评估：**

根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码只是 Apache License，但它表明了该项目的文件结构，结合其他信息可以推断利用方式），此漏洞利用是有效的。大量报告证实了该后门的存在和影响。

**投毒风险分析：**

提供的代码片段（Apache License）本身不包含恶意代码，它仅仅是一个许可证文件。**因此，无法从此代码判断是否存在作者隐藏的投毒代码**。 但是，基于对整个漏洞的理解，我们可以知道恶意代码隐藏在源码的构建过程中，而不是直接存在于某个源文件中。因此，评估此代码仓库中存在作者有意投毒行为的风险为 0%。实际的投毒发生在XZ的release流程中,由作者精心构造的恶意脚本在构建时植入。

**漏洞利用方式：**

1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加了恶意代码，这些代码被隐藏在测试文件中。
2.  **构建过程篡改：** 通过修改构建脚本，恶意代码会在构建过程中被提取并注入到 liblzma 库中。
3.  **SSH后门：** 被篡改的 liblzma 库会影响 OpenSSH 等使用该库的应用程序。具体来说，恶意代码会在 SSH 认证过程中插入一个后门，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者可以利用这个后门，在未经授权的情况下远程访问受影响的系统。

**项目地址:** [neuralinhibitor/xzwhy](https://github.com/neuralinhibitor/xzwhy)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #28

**来源**: [CVE-2024-3094-pentestfunctions_CVE-2024-3094.md](../2024/CVE-2024-3094-pentestfunctions_CVE-2024-3094.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问并可能执行任意代码

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的XZ Utils版本，且sshd与liblzma链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094 描述了 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，从伪装的测试文件中提取预构建的目标文件，并用于修改 liblzma 代码中的特定函数。这导致任何链接到该修改后的 liblzma 库的软件都可能受到影响。攻击者可以利用此后门绕过 SSH 身份验证并执行远程代码。

**有效性：**

提供的 `checker.sh` 脚本旨在检测系统是否受到 CVE-2024-3094 的影响。它通过以下步骤进行检查：

1.  **检查 XZ 版本：** 确定系统上安装的 XZ Utils 版本，并判断是否为易受攻击的版本 (5.6.0 或 5.6.1)。
2.  **检查 sshd 二进制文件是否存在：** 确认系统中存在 sshd 服务。
3.  **检查 sshd 是否使用 lzma：** 验证 sshd 是否与 liblzma 库链接。
4.  **检查 lzma 中是否存在特定字节模式：** 在 liblzma 库中搜索后门相关的特定字节模式。

该脚本的有效性在于其能够准确识别系统中是否存在易受攻击的 XZ Utils 版本以及相关的 SSH 配置。

**投毒风险：**

`checker.sh` 脚本本身的投毒风险较低。脚本的主要功能是检测漏洞，而非利用漏洞。但是，任何从互联网上下载并执行的脚本都存在一定的风险。虽然该脚本目前看来是安全的，但未来的版本可能被恶意修改。所以评估为1%。

**利用方式：**

1.  **后门植入：** 恶意代码被嵌入到 XZ Utils 的源代码中，并通过复杂的构建过程注入到 liblzma 库中。
2.  **SSH 劫持：** 被感染的 liblzma 库在 sshd 服务中被使用，允许攻击者在未经授权的情况下访问系统。
3.  **远程代码执行：** 攻击者通过精心构造的数据包发送到受感染的 sshd 服务，从而触发后门，执行任意代码。

简而言之，该漏洞通过供应链攻击，在广泛使用的压缩库中植入后门，从而影响依赖该库的应用程序，特别是 SSH 服务。

**项目地址:** [pentestfunctions/CVE-2024-3094](https://github.com/pentestfunctions/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #29

**来源**: [CVE-2024-3094-przemoc_xz-backdoor-links.md](../2024/CVE-2024-3094-przemoc_xz-backdoor-links.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #30

**来源**: [CVE-2024-3094-r0binak_xzk8s.md](../2024/CVE-2024-3094-r0binak_xzk8s.md)

## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未授权远程SSH访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受感染的XZ Utils版本，并且sshd服务链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码修改了liblzma库中的特定函数，允许攻击者绕过SSH身份验证，实现未经授权的远程访问。

**有效性：**

根据提供的Dockerfile和README.md，该PoC通过以下步骤尝试重现该漏洞：

1.  使用包含受影响XZ Utils版本的Debian镜像作为基础镜像。
2.  安装openssh-server并进行配置，允许root用户使用密码登录。
3.  复制一个打过补丁的`liblzma.so.5.6.0.patch`库到容器中。**注意：** 这里的“patched”指的是将恶意代码中的硬编码公钥替换成了其他公钥，方便漏洞验证，并非修复漏洞本身。原始漏洞中，恶意代码会尝试使用预设的密钥进行身份验证。由于原始密钥未知，因此需要使用替换后的“patched”库。
4.  通过`LD_PRELOAD`环境变量加载修改后的`liblzma.so`库。
5.  启动sshd服务。

通过使用`xzbot`等工具，攻击者可以利用该后门绕过SSH身份验证，从而获得对目标系统的未授权访问。因此，该PoC在概念上是有效的。

**投毒风险：**

该仓库中存在一定投毒风险。虽然该PoC旨在重现和验证CVE-2024-3094漏洞，但其中包含以下潜在风险：

*   **恶意补丁库：** `liblzma.so.5.6.0.patch`本身就是一个被修改过的库，虽然作者声明替换了公钥，但仍然可能包含其他的恶意代码或行为。这部分是投毒风险的主要来源。需要对这个patch文件进行详细分析才能确定是否还隐藏了其他恶意行为。
*   **Dockerfile命令执行：** Dockerfile中的`RUN`命令可以执行任意命令，存在被利用执行恶意代码的可能。
*   **镜像分发：** 如果构建的镜像被上传到公共镜像仓库，可能会被其他用户下载和使用，从而扩大了影响范围。
*   **`sed` 命令潜在风险:** 虽然Dockerfile 中的 `sed` 命令较为常见，但也需要确认是否包含任何意外的shell注入或其他恶意行为。

综合考虑，该仓库的投毒风险约为10%。大部分代码是为了复现漏洞，但`liblzma.so.5.6.0.patch`库需要谨慎分析，这是主要的风险点。

**利用方式：**

利用方式如下：

1.  目标系统运行了受影响版本的XZ Utils (5.6.0 或 5.6.1)。
2.  sshd服务链接了被篡改的liblzma库。当sshd尝试使用liblzma库进行数据压缩时，恶意代码会被激活。
3.  攻击者使用特定的SSH客户端，并在连接时发送包含特定数据的payload。该payload会被liblzma库截获并处理。
4.  恶意代码会尝试使用硬编码的密钥进行身份验证。如果验证成功，攻击者就可以绕过常规的SSH身份验证机制，以目标用户的身份登录系统，通常是root用户。

简单来说，该漏洞允许攻击者在未经授权的情况下，通过SSH远程控制受害主机。

**项目地址:** [r0binak/xzk8s](https://github.com/r0binak/xzk8s)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #31

**来源**: [CVE-2024-3094-reuteras_CVE-2024-3094.md](../2024/CVE-2024-3094-reuteras_CVE-2024-3094.md)

## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #32

**来源**: [CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md](../2024/CVE-2024-3094-robertdebock_ansible-playbook-cve-2024-3094.md)

## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #33

**来源**: [CVE-2024-3094-robertdfrench_ifuncd-up.md](../2024/CVE-2024-3094-robertdfrench_ifuncd-up.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个在XZ Utils 5.6.0和5.6.1版本中发现的供应链攻击。攻击者通过复杂的混淆手段，将恶意代码注入到liblzma库的构建过程中。该恶意代码能够拦截并修改与liblzma库的交互数据，特别是影响OpenSSH的身份验证过程，从而允许攻击者在未经授权的情况下远程访问系统。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞影响XZ Utils 5.6.0和5.6.1版本，影响严重程度为“极危”。漏洞利用代码（虽然本身不是一个完整的exploit，而更像是一个用于搭建测试环境的Dockerfile和Makefile）的存在进一步表明，该漏洞是真实且可利用的。

**投毒风险分析：**
提供的Dockerfile和Makefile主要用于构建一个包含编译工具和调试工具的Debian Bookworm容器，用于研究IFUNC（Indirect Function Call）的性能。这些代码本身**不是**漏洞利用代码，而是一个用于测试和研究IFUNC的辅助环境。虽然原作者的本意并非投毒，但仍存在一定风险。

*   Dockerfile：用于构建容器镜像，安装必要的软件包。没有发现明显的恶意代码。
*   Makefile：用于编译和运行测试代码，以及进行性能分析。存在利用编译时注入恶意代码的可能性，例如在编译选项中添加恶意链接库，或者修改源代码后再进行编译。但是，提供的Makefile并没有明显的恶意行为，它的目的主要是为了测试IFUNC。
*   README.md：是对整个项目的一个介绍，并没有发现什么有恶意行为的内容。

考虑到供应链攻击的性质，即使提供的代码本身没有明显的恶意行为，也不能完全排除投毒的可能性。可能存在的风险点在于Makefile中对编译过程的控制，以及可能存在的对编译环境的依赖。但总体来说，投毒的概率较低，约为5%。

**利用方式分析：**
1.  **恶意代码注入：** 攻击者通过复杂的混淆手段，将恶意代码伪装成测试文件，并嵌入到XZ Utils的源代码中。
2.  **构建过程劫持：** 在liblzma的构建过程中，恶意代码被提取并用于修改liblzma库的关键函数。
3.  **SSH后门：** 修改后的liblzma库会被OpenSSH链接，导致OpenSSH在身份验证过程中调用恶意代码。
4.  **远程访问：** 攻击者可以利用后门绕过SSH身份验证，从而获得对受感染系统的远程访问权限。

**总结：** CVE-2024-3094是一个非常严重的供应链攻击，它利用了XZ Utils的构建过程，在liblzma库中植入后门，最终导致OpenSSH被攻陷。虽然提供的代码本身不是一个完整的exploit，但Dockerfile和Makefile的存在表明该漏洞是真实且可利用的。投毒风险较低，但不能完全排除。利用方式是通过恶意代码注入、构建过程劫持和SSH后门，实现未经授权的远程访问。

**项目地址:** [robertdfrench/ifuncd-up](https://github.com/robertdfrench/ifuncd-up)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #34

**来源**: [CVE-2024-3094-shefirot_CVE-2024-3094.md](../2024/CVE-2024-3094-shefirot_CVE-2024-3094.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务被配置为使用liblzma。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-3094是XZ Utils中发现的一个供应链后门漏洞。攻击者通过一系列复杂的混淆，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，用于修改liblzma代码中的特定函数。这导致任何链接到该库的软件都可能被篡改数据交互。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且危害极大。提供的POC代码尝试在Kubernetes集群中利用此漏洞。由于该POC利用了已知的漏洞原理，并且提供了部署受影响版本的容器以及利用工具的步骤，因此**有效性较高**。POC代码的目的是在受影响的容器内执行命令，甚至关闭主机，这与漏洞描述相符。\n\n**投毒风险：**\n分析提供的POC代码后，存在一定的投毒风险，但风险较低：\n*   **明确声明：** README.md中明确声明了免责声明，提示仅用于教育目的，作者不对使用造成的任何损害负责，这降低了一定的投毒可能。\n*   **依赖外部资源：** Dockerfile引用了外部的fedora镜像，存在一定的依赖风险。\n*   **利用方式较为直接：** 该POC的目的是在受影响的容器内部署一个包含漏洞版本的XZ Utils，并通过`xzbot`工具进行利用，利用步骤较为明确，恶意行为相对容易被检测。\n*   **Dockerfile中引入patch文件:** dockerfile中引入了`liblzma.so.5.6.0.patch` 这个文件， 该文件是POC是否能够成功的关键，如果该文件被篡改，则可能导致无法复现，或者执行其他恶意操作。\n\n综合考虑，虽然该POC存在潜在的投毒风险，但整体风险较低。 \n\n**利用方式：**\n1.  **部署受影响的XZ Utils版本：** 使用提供的Dockerfile构建包含受漏洞影响的XZ Utils（5.6.0或5.6.1）版本的容器镜像。\n2.  **在Kubernetes集群中部署容器：** 使用提供的deploy_cve-2024-3094.yml或daemonset_cve-2024-3094.yml文件，将包含漏洞版本的容器部署到Kubernetes集群中。daemonset可以部署到所有节点，模拟更广泛的攻击面。\n3.  **端口转发：** 通过kubectl port-forward命令将容器的22端口（SSH）转发到本地端口，例如2225。\n4.  **利用xzbot工具：** 使用amlweems/xzbot工具连接到转发的端口，利用漏洞执行任意命令。可以通过`-cmd`参数指定要执行的命令，例如修改/etc/passwd文件或触发系统关机。\n5.  **攻击集群节点：** 通过在DaemonSet中运行受影响的容器，攻击者能够利用所有集群节点上的漏洞。

**项目地址:** [shefirot/CVE-2024-3094](https://github.com/shefirot/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #35

**来源**: [CVE-2024-3094-valeriot30_cve-2024-3094.md](../2024/CVE-2024-3094-valeriot30_cve-2024-3094.md)

## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #36

**来源**: [CVE-2024-3094-weltregie_liblzma-scan.md](../2024/CVE-2024-3094-weltregie_liblzma-scan.md)

## CVE-2024-3094-XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致SSH远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务使用了liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 工具中的一个供应链后门，该后门影响了 5.6.0 和 5.6.1 版本。该漏洞利用方式是通过一系列复杂的混淆，liblzma 构建过程从源代码中伪装的测试文件中提取预构建的目标文件。然后使用该文件修改 liblzma 代码中的特定函数，从而导致任何链接到该库的软件都可以使用修改后的 liblzma 库。这使得攻击者可以拦截和修改与该库的数据交互。

**有效性分析：**
提供的POC代码包含一个用于扫描系统上是否存在被感染的liblzma库的shell脚本（`liblzma-scan.sh`）和一个包含已知恶意liblzma库SHA256哈希值的文本文件（`hashes.txt`）。该脚本通过查找名为 `liblzma*` 的文件，计算其 SHA256 哈希值，并将其与 `hashes.txt` 文件中的哈希值进行比较，如果匹配，则表明存在后门。

**投毒风险分析：**
虽然这个 POC 的主要目的是检测受感染的文件，但存在一定的投毒风险。脚本`liblzma-scan.sh`本身相对简单，主要功能是查找文件并计算哈希值，并与提供的hash列表进行对比，没有明显的恶意行为。风险主要来自`hashes.txt`文件，如果攻击者能够篡改此文件，添加未被官方标记为恶意但实际包含后门的文件的哈希值，则可能导致误报。此外，脚本作者可能在脚本中添加了不易察觉的恶意代码，例如信息收集或远程执行命令。考虑到其检测恶意文件为目的，投毒可能性较低，估计为10%。

**利用方式：**
1.  **受影响版本识别：** 确定系统是否安装了受影响的 XZ Utils 版本（5.6.0 或 5.6.1）。
2.  **库扫描：** 运行 `liblzma-scan.sh` 脚本以检测系统中是否存在具有已知恶意哈希值的 `liblzma` 库。
3.  **SSH 利用：** 如果检测到受感染的库，攻击者可能能够利用该后门绕过 SSH 身份验证并执行远程代码。具体而言，该后门修改了 SSHd 的行为，使其在特定条件下允许未经授权的访问。

**搜索引擎结果印证：**
搜索引擎结果中，多个链接（例如，[webpage 1], [webpage 5], [webpage 6], [webpage 8]）都确认了 CVE-2024-3094 允许攻击者绕过 SSH 身份验证进行远程代码执行。 [webpage 4] 还提供了一个用于扫描漏洞的工具。


**项目地址:** [weltregie/liblzma-scan](https://github.com/weltregie/liblzma-scan)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

## POC #37

**来源**: [CVE-2024-3094-zpxlz_CVE-2024-3094.md](../2024/CVE-2024-3094-zpxlz_CVE-2024-3094.md)

## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)

---

