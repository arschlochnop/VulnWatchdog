## CVE-2024-53677 - Apache Struts2 RCE (远程代码执行)

**漏洞编号:** CVE-2024-53677

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Apache Struts2

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 2.0.0 至 6.3.0.2 (不含 6.4.0)

**利用条件:** 无需认证，可通过网络直接访问受影响的 Struts2 文件上传端点

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本POC代码（Check-CVE-2024-53677.py）主要针对Apache Struts2（S2-067）中的文件上传逻辑漏洞。该漏洞源于Struts2在处理多部分表单数据（multipart/form-data）时，对参数绑定的验证不足。攻击者可以通过显式传递如'top.uploadFileName'等参数，利用OGNL绑定机制覆盖后台的文件命名逻辑，从而实现目录遍历。POC通过构造一个特殊的Multipart请求，尝试将文件名修改为'../../vuln_test.txt'。如果服务器在响应中反射了该文件名或表现出路径解析异常，则判定存在漏洞。此POC属于无害化检测（Non-destructive），它并不真正上传Webshell，而是验证路径参数是否可被操纵。其核心逻辑在于利用了Struts2对ParameterAction映射的缺陷。该POC结构完整，使用了标准库requests和requests_toolbelt，逻辑清晰，能够有效识别目标是否存在S2-067漏洞。利用步骤：1. 识别目标系统中基于Struts2框架的文件上传接口（如.action结尾的端点）。2. 构造HTTP POST请求，Content-Type设为multipart/form-data。3. 在表单数据中，除了原始的文件字段外，注入一个控制文件名的参数名（如uploadFileName或top.uploadFileName），并将其值设置为包含路径遍历字符（../）的字符串。4. 发送请求并观察服务器响应或文件系统变化。若攻击成功，文件将被写入到预期目录之外（如Web目录），进而可通过访问上传的JSP文件执行系统命令。投毒风险分析：该POC代码具有较低的投毒风险。分析其源码可见，脚本主要依赖Python官方及社区公认的安全库（requests, argparse, logging, urllib, requests_toolbelt）。代码逻辑透明，所有操作均在控制台日志中可见。脚本中使用的'random'库仅用于生成随机的MIME边界字符串，不涉及恶意随机化或后门植入。没有发现eval()、exec()、base64混淆执行或动态远程下载脚本等高危行为。其网络交互仅限于用户指定的target_url，未发现秘密向第三方C2（控制端）发送数据的情况。唯一需要注意的是，在复杂的网络环境中使用此类扫描脚本时，其User-Agent虽然是模拟的，但由于其自动化的特性，可能会触发WAF警报。整体而言，该代码是一个典型的安全研究辅助工具，未见恶意意图或恶意代码注入。建议在使用前在沙箱环境运行，并核实其上传点参数是否与目标环境匹配，以避免意外的文件覆盖风险。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2024-53677-S2-067](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2024-53677-S2-067)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
