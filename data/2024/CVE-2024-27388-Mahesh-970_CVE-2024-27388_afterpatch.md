# CVE-2024-27388

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterPatch_validation.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterPatch_validation.md)

## CVE-2024-27388

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel (SUNRPC)

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= Linux Kernel < 6.9 (部分版本，具体参考CVE详情)

**利用条件:** 需要触发SUNRPC相关代码的执行，可能需要网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27388是Linux内核SUNRPC子系统中`gssx_dec_option_array`函数中的一个内存泄漏漏洞。根据漏洞描述，`creds`和`oa->data`在分配后，如果在错误处理路径中没有被正确释放，就会导致内存泄漏。提供的漏洞利用代码`gss_rpc_xdr.c`包含了该漏洞相关的函数的实现，但本身不是一个完整的利用程序。攻击者需要构造特定的RPC请求，触发存在漏洞的代码路径，才能造成内存泄漏。由于此代码为内核模块代码，需要编译安装到内核环境中才能被触发，存在一定的利用门槛。从代码本身来看，更多的是修复建议，所以投毒风险较低。虽然代码片段本身不包含恶意代码，但如果有人恶意修改该代码，例如在错误处理分支中故意跳过某些释放内存的步骤，或者在分配内存后不执行任何操作，从而加剧内存泄漏，则会增加投毒风险。此代码可能被恶意修改用来隐藏其他恶意行为，例如在其他地方打开后门。所以投毒风险不能完全排除。

**项目地址:** [Mahesh-970/CVE-2024-27388_afterPatch_validation](https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---

## POC #2

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterpatch.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterpatch.md)

# CVE-2024-27388

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterPatch_validation.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterPatch_validation.md)

## CVE-2024-27388

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel (SUNRPC)

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= Linux Kernel < 6.9 (部分版本，具体参考CVE详情)

**利用条件:** 需要触发SUNRPC相关代码的执行，可能需要网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27388是Linux内核SUNRPC子系统中`gssx_dec_option_array`函数中的一个内存泄漏漏洞。根据漏洞描述，`creds`和`oa->data`在分配后，如果在错误处理路径中没有被正确释放，就会导致内存泄漏。提供的漏洞利用代码`gss_rpc_xdr.c`包含了该漏洞相关的函数的实现，但本身不是一个完整的利用程序。攻击者需要构造特定的RPC请求，触发存在漏洞的代码路径，才能造成内存泄漏。由于此代码为内核模块代码，需要编译安装到内核环境中才能被触发，存在一定的利用门槛。从代码本身来看，更多的是修复建议，所以投毒风险较低。虽然代码片段本身不包含恶意代码，但如果有人恶意修改该代码，例如在错误处理分支中故意跳过某些释放内存的步骤，或者在分配内存后不执行任何操作，从而加剧内存泄漏，则会增加投毒风险。此代码可能被恶意修改用来隐藏其他恶意行为，例如在其他地方打开后门。所以投毒风险不能完全排除。

**项目地址:** [Mahesh-970/CVE-2024-27388_afterPatch_validation](https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---

## POC #2

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterpatch.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterpatch.md)

# CVE-2024-27388

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterPatch_validation.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterPatch_validation.md)

## CVE-2024-27388

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel (SUNRPC)

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= Linux Kernel < 6.9 (部分版本，具体参考CVE详情)

**利用条件:** 需要触发SUNRPC相关代码的执行，可能需要网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27388是Linux内核SUNRPC子系统中`gssx_dec_option_array`函数中的一个内存泄漏漏洞。根据漏洞描述，`creds`和`oa->data`在分配后，如果在错误处理路径中没有被正确释放，就会导致内存泄漏。提供的漏洞利用代码`gss_rpc_xdr.c`包含了该漏洞相关的函数的实现，但本身不是一个完整的利用程序。攻击者需要构造特定的RPC请求，触发存在漏洞的代码路径，才能造成内存泄漏。由于此代码为内核模块代码，需要编译安装到内核环境中才能被触发，存在一定的利用门槛。从代码本身来看，更多的是修复建议，所以投毒风险较低。虽然代码片段本身不包含恶意代码，但如果有人恶意修改该代码，例如在错误处理分支中故意跳过某些释放内存的步骤，或者在分配内存后不执行任何操作，从而加剧内存泄漏，则会增加投毒风险。此代码可能被恶意修改用来隐藏其他恶意行为，例如在其他地方打开后门。所以投毒风险不能完全排除。

**项目地址:** [Mahesh-970/CVE-2024-27388_afterPatch_validation](https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---

## POC #2

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterpatch.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_afterpatch.md)

## CVE-2024-27388 - SUNRPC GSSAPI内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel (SUNRPC)

**危害等级:** 中危，可能导致资源耗尽和拒绝服务

**影响版本:** Linux kernel versions 3.10 and later, before fixes addressing this issue

**利用条件:** 需要能够触发SUNRPC GSSAPI代码路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-27388 描述的是 Linux 内核 SUNRPC 组件中 `gssx_dec_option_array` 函数的一个内存泄漏问题。当解析 GSSAPI 选项数组时，如果出现错误，某些已分配的内存（`creds` 和 `oa->data`）可能不会被正确释放，导致内存泄漏。根据漏洞库信息和搜索引擎结果，该漏洞本身是一个内存泄漏，可能导致系统性能下降甚至拒绝服务。 

**有效性：**

提供的“漏洞利用代码”实际上是修复该漏洞的补丁前的代码片段。因此，这段代码**并非**漏洞利用代码，而是存在漏洞的代码。要利用该漏洞，需要构造恶意的 GSSAPI 请求，触发 `gssx_dec_option_array` 函数中的错误处理路径，并且确保在该路径下内存没有被正确释放。从`gssx_dec_option_array` 代码可以看出，如果 `xdr_inline_decode` 返回错误，或者在处理Linux creds时发生错误，内存可能会泄漏。

**投毒风险：**

提供的代码片段本身不太可能存在投毒代码。因为它只是漏洞存在处的原始代码，目的是展示漏洞的根源。不过，在真实的利用场景中，攻击者可能会通过发送特制的RPC请求来触发漏洞，而这个请求本身可以被视为“投毒”，因为它可能导致目标系统资源耗尽。这里评估存在极低的投毒风险(5%)，因为更多的是触发漏洞利用，而不是隐藏恶意代码。

**利用方式：**

1.  **触发漏洞：** 攻击者需要能够发送 SUNRPC 请求，并触发 GSSAPI 身份验证流程。攻击者需要精心构造 RPC 请求中的 GSSAPI 选项数组，使其在 `gssx_dec_option_array` 函数解析过程中，满足导致内存泄漏的错误条件。
2.  **资源耗尽：** 通过重复发送恶意构造的请求，持续触发内存泄漏，最终导致系统内存耗尽。
3.  **拒绝服务：** 当系统内存耗尽时，可能导致系统崩溃或无法响应正常请求，从而实现拒绝服务攻击。

**项目地址:** [Mahesh-970/CVE-2024-27388_afterpatch](https://github.com/Mahesh-970/CVE-2024-27388_afterpatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---

## POC #3

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_beforPatch.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_beforPatch.md)

## CVE-2024-27388-Linux Kernel-SUNRPC内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= version < 4.19.311, 3.10 <= version < 5.4.273, 3.10 <= version < 5.10.214, 3.10 <= version < 5.15.153, 3.10 <= version < 6.1.83, 3.10 <= version < 6.6.23, 3.10 <= version < 6.7.11, 3.10 <= version < 6.8.2, 3.10 <= version < 6.9

**利用条件:** 需要启用SUNRPC和GSS认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27388 是 Linux 内核 SUNRPC 子系统中的一个内存泄漏漏洞，位于 `gssx_dec_option_array` 函数中。当解析 GSS 安全选项数组时，如果发生错误，代码可能无法释放已分配的内存（`creds` 和 `oa->data`）。

**有效性：**
提供的代码是补丁修复前的 `gss_rpc_xdr.c` 文件的一部分，可以用来重现漏洞触发的代码环境。漏洞库信息和搜索引擎结果都证实了此漏洞的存在，并指出该漏洞会导致内存泄漏。

**投毒风险：**
仔细检查提供的 `gss_rpc_xdr.c` 代码，没有发现任何恶意代码或后门。代码逻辑是标准的 XDR 编解码操作，专注于 GSS 选项的处理。该漏洞是由于错误处理不当造成的内存泄漏，而不是故意设计的恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  攻击者需要能够触发 SUNRPC 协议，并且使用 GSS 安全认证。
2.  攻击者构造恶意的 GSS 协商请求，包含大量的或者格式错误的 GSS 选项数组。
3.  当内核解析这些恶意选项时，由于错误处理的缺陷，会发生内存泄漏。
4.  通过重复发送恶意请求，攻击者可以耗尽系统内存，导致拒绝服务。

漏洞利用的根本在于构造特殊的输入，使得 `gssx_dec_option_array` 函数在出错时未能正确释放内存。通过持续发送此类恶意请求来放大内存泄漏的影响。

**项目地址:** [Mahesh-970/CVE-2024-27388_beforPatch](https://github.com/Mahesh-970/CVE-2024-27388_beforPatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---



---

## POC #3

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_beforPatch.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_beforPatch.md)

## CVE-2024-27388-Linux Kernel-SUNRPC内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= version < 4.19.311, 3.10 <= version < 5.4.273, 3.10 <= version < 5.10.214, 3.10 <= version < 5.15.153, 3.10 <= version < 6.1.83, 3.10 <= version < 6.6.23, 3.10 <= version < 6.7.11, 3.10 <= version < 6.8.2, 3.10 <= version < 6.9

**利用条件:** 需要启用SUNRPC和GSS认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27388 是 Linux 内核 SUNRPC 子系统中的一个内存泄漏漏洞，位于 `gssx_dec_option_array` 函数中。当解析 GSS 安全选项数组时，如果发生错误，代码可能无法释放已分配的内存（`creds` 和 `oa->data`）。

**有效性：**
提供的代码是补丁修复前的 `gss_rpc_xdr.c` 文件的一部分，可以用来重现漏洞触发的代码环境。漏洞库信息和搜索引擎结果都证实了此漏洞的存在，并指出该漏洞会导致内存泄漏。

**投毒风险：**
仔细检查提供的 `gss_rpc_xdr.c` 代码，没有发现任何恶意代码或后门。代码逻辑是标准的 XDR 编解码操作，专注于 GSS 选项的处理。该漏洞是由于错误处理不当造成的内存泄漏，而不是故意设计的恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  攻击者需要能够触发 SUNRPC 协议，并且使用 GSS 安全认证。
2.  攻击者构造恶意的 GSS 协商请求，包含大量的或者格式错误的 GSS 选项数组。
3.  当内核解析这些恶意选项时，由于错误处理的缺陷，会发生内存泄漏。
4.  通过重复发送恶意请求，攻击者可以耗尽系统内存，导致拒绝服务。

漏洞利用的根本在于构造特殊的输入，使得 `gssx_dec_option_array` 函数在出错时未能正确释放内存。通过持续发送此类恶意请求来放大内存泄漏的影响。

**项目地址:** [Mahesh-970/CVE-2024-27388_beforPatch](https://github.com/Mahesh-970/CVE-2024-27388_beforPatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---



---

## POC #3

**来源**: [CVE-2024-27388-Mahesh-970_CVE-2024-27388_beforPatch.md](../2024/CVE-2024-27388-Mahesh-970_CVE-2024-27388_beforPatch.md)

## CVE-2024-27388-Linux Kernel-SUNRPC内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= version < 4.19.311, 3.10 <= version < 5.4.273, 3.10 <= version < 5.10.214, 3.10 <= version < 5.15.153, 3.10 <= version < 6.1.83, 3.10 <= version < 6.6.23, 3.10 <= version < 6.7.11, 3.10 <= version < 6.8.2, 3.10 <= version < 6.9

**利用条件:** 需要启用SUNRPC和GSS认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27388 是 Linux 内核 SUNRPC 子系统中的一个内存泄漏漏洞，位于 `gssx_dec_option_array` 函数中。当解析 GSS 安全选项数组时，如果发生错误，代码可能无法释放已分配的内存（`creds` 和 `oa->data`）。

**有效性：**
提供的代码是补丁修复前的 `gss_rpc_xdr.c` 文件的一部分，可以用来重现漏洞触发的代码环境。漏洞库信息和搜索引擎结果都证实了此漏洞的存在，并指出该漏洞会导致内存泄漏。

**投毒风险：**
仔细检查提供的 `gss_rpc_xdr.c` 代码，没有发现任何恶意代码或后门。代码逻辑是标准的 XDR 编解码操作，专注于 GSS 选项的处理。该漏洞是由于错误处理不当造成的内存泄漏，而不是故意设计的恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  攻击者需要能够触发 SUNRPC 协议，并且使用 GSS 安全认证。
2.  攻击者构造恶意的 GSS 协商请求，包含大量的或者格式错误的 GSS 选项数组。
3.  当内核解析这些恶意选项时，由于错误处理的缺陷，会发生内存泄漏。
4.  通过重复发送恶意请求，攻击者可以耗尽系统内存，导致拒绝服务。

漏洞利用的根本在于构造特殊的输入，使得 `gssx_dec_option_array` 函数在出错时未能正确释放内存。通过持续发送此类恶意请求来放大内存泄漏的影响。

**项目地址:** [Mahesh-970/CVE-2024-27388_beforPatch](https://github.com/Mahesh-970/CVE-2024-27388_beforPatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)

---

