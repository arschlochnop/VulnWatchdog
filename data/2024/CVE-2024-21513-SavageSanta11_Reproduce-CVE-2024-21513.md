# CVE-2024-21513

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-21513-SavageSanta11_Reproduce-CVE-2024-21513.md](../2024/CVE-2024-21513-SavageSanta11_Reproduce-CVE-2024-21513.md)

## CVE-2024-21513-langchain-experimental-ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-21513

**æ¼æ´ç±»å‹:** ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** langchain-experimental

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 0.0.15 <= version < 0.0.21

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä½¿ç”¨VectorSQLDatabaseChainï¼Œå¹¶èƒ½å¤Ÿå½±å“è¾“å…¥prompt

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-21513 æ˜¯ä¸€ä¸ªå­˜åœ¨äº langchain-experimental åŒ…ï¼ˆç‰ˆæœ¬ 0.0.15 åˆ°ä½äº 0.0.21ï¼‰ä¸­çš„ä»£ç æ‰§è¡Œæ¼æ´ã€‚æ¼æ´åŸå› æ˜¯å½“ä»æ•°æ®åº“æ£€ç´¢å€¼æ—¶ï¼Œä»£ç ä¼šå°è¯•å¯¹æ‰€æœ‰å€¼è°ƒç”¨ 'eval'ã€‚æ”»å‡»è€…å¦‚æœå¯ä»¥æ§åˆ¶è¾“å…¥promptï¼Œä¸”æœåŠ¡å™¨é…ç½®äº† VectorSQLDatabaseChainï¼Œå°±å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ PoC ä»£ç åªåŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œæè¿°äº† CVE-2024-21513ã€‚å› æ­¤ï¼Œä¸å­˜åœ¨æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚å½“ç„¶ï¼Œä¸æ’é™¤å…¶ä»–ä»“åº“æˆ–è€…payloadä¸­å­˜åœ¨ï¼Œä½†æ­¤å¤„è¯„ä¼°çš„è¿™ä¸ªä»“åº“æŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æä¾›ç»™ langchain-experimental çš„è¾“å…¥ promptã€‚
2.  ç›®æ ‡ç³»ç»Ÿå¿…é¡»é…ç½®äº† VectorSQLDatabaseChainã€‚
3.  æ”»å‡»è€…åœ¨ prompt ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼Œè¯¥ä»£ç ä¼šè¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚
4.  å½“ langchain-experimental ä»æ•°æ®åº“æ£€ç´¢è¯¥å€¼æ—¶ï¼Œä¼šä½¿ç”¨ `eval` å‡½æ•°æ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚

**ç¼“è§£æªæ–½ï¼š**
å‡çº§åˆ° langchain-experimental çš„ 0.0.21 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nskath/CVE-2024-21513](https://github.com/nskath/CVE-2024-21513)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-21513](https://nvd.nist.gov/vuln/detail/CVE-2024-21513)

---

## POC #2

**æ¥æº**: [CVE-2024-21513-nskath_CVE-2024-21513.md](../2024/CVE-2024-21513-nskath_CVE-2024-21513.md)

## CVE-2024-21513-langchain-experimental-ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2024-21513

**æ¼æ´ç±»å‹:** ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** langchain-experimental

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 0.0.15 <= version < 0.0.21

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä½¿ç”¨VectorSQLDatabaseChainï¼Œå¹¶èƒ½å¤Ÿå½±å“è¾“å…¥prompt

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-21513 æ˜¯ä¸€ä¸ªå­˜åœ¨äº langchain-experimental åŒ…ï¼ˆç‰ˆæœ¬ 0.0.15 åˆ°ä½äº 0.0.21ï¼‰ä¸­çš„ä»£ç æ‰§è¡Œæ¼æ´ã€‚æ¼æ´åŸå› æ˜¯å½“ä»æ•°æ®åº“æ£€ç´¢å€¼æ—¶ï¼Œä»£ç ä¼šå°è¯•å¯¹æ‰€æœ‰å€¼è°ƒç”¨ 'eval'ã€‚æ”»å‡»è€…å¦‚æœå¯ä»¥æ§åˆ¶è¾“å…¥promptï¼Œä¸”æœåŠ¡å™¨é…ç½®äº† VectorSQLDatabaseChainï¼Œå°±å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ PoC ä»£ç åªåŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œæè¿°äº† CVE-2024-21513ã€‚å› æ­¤ï¼Œä¸å­˜åœ¨æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚å½“ç„¶ï¼Œä¸æ’é™¤å…¶ä»–ä»“åº“æˆ–è€…payloadä¸­å­˜åœ¨ï¼Œä½†æ­¤å¤„è¯„ä¼°çš„è¿™ä¸ªä»“åº“æŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ§åˆ¶æä¾›ç»™ langchain-experimental çš„è¾“å…¥ promptã€‚
2.  ç›®æ ‡ç³»ç»Ÿå¿…é¡»é…ç½®äº† VectorSQLDatabaseChainã€‚
3.  æ”»å‡»è€…åœ¨ prompt ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼Œè¯¥ä»£ç ä¼šè¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚
4.  å½“ langchain-experimental ä»æ•°æ®åº“æ£€ç´¢è¯¥å€¼æ—¶ï¼Œä¼šä½¿ç”¨ `eval` å‡½æ•°æ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚

**ç¼“è§£æªæ–½ï¼š**
å‡çº§åˆ° langchain-experimental çš„ 0.0.21 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nskath/CVE-2024-21513](https://github.com/nskath/CVE-2024-21513)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-21513](https://nvd.nist.gov/vuln/detail/CVE-2024-21513)

---

