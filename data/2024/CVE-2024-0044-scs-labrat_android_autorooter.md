# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

# CVE-2024-0044

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md](../2024/CVE-2024-0044-007CRIPTOGRAFIA_c-CVE-2024-0044.md)

## CVE-2024-0044: Android PackageInstallerService 提权漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升，可能导致任意代码执行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，无需特殊权限，用户安装应用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息，CVE-2024-0044 漏洞存在于 Android 的 PackageInstallerService.java 中，由于不正确的输入验证，可能允许攻击者以任何应用程序的身份运行代码，导致本地权限提升。利用此漏洞不需要额外的执行权限，并且不需要用户交互。

**漏洞利用分析：**

根据提供的Python漏洞利用代码，该POC脚本的目的是利用CVE-2024-0044漏洞在目标Android设备上安装APK，并尝试以目标应用 UID 运行。脚本首先检查APK文件是否存在，然后将其推送到`/data/local/tmp/`目录。 接下来，该脚本会尝试使用`pm list packages -U`命令获取目标应用的UID。然后，该脚本生成一个payload（但代码不完整，缺失了生成payload的后半部分），并将该payload与`cmd package install-create`一起使用以安装APK。

**有效性评估：**
提供的代码片段是不完整的，关键的 payload 生成部分缺失，导致无法直接利用。根据 github 上 meta-redteam 发布的exp，可知该漏洞利用的关键在于构造恶意的 `PackageInstaller.SessionParams`，通过设置 `setSessionParams` 的 `installSourceInfo.mRequestingPackageUid` 为其他应用的uid，达到以该应用身份安装应用的目的。

**投毒风险评估：**

该脚本的投毒风险较低。虽然代码不完整，但主要操作是文件推送、命令执行。风险点在于：

*   **依赖外部APK：** 攻击者可以通过提供恶意APK来感染目标系统，但这不是POC本身的问题，而是APK本身的安全问题。

因此，判定投毒风险为1%。 尽管如此，使用任何第三方漏洞利用代码时，都应谨慎审查，以避免潜在的恶意行为。

**利用方式总结：**

1.  准备好需要安装的恶意 APK 文件。
2.  执行该 Python 脚本，输入目标应用的包名以及 APK 文件的路径。
3.  脚本会将 APK 文件推送到设备，获取目标应用的 UID。
4.  脚本构建特殊的 `PackageInstaller.SessionParams`，将待安装应用伪装成目标应用进行安装，从而以目标应用的权限运行。

**优先级排序:**
实际利用优先级应该以github上可用的POC为最高优先级，能够直接验证漏洞真实性。搜索引擎可以快速检索到相关的技术分析文章，例如meta-redteam发布的文章。漏洞库信息则提供了漏洞的基本信息，为漏洞分析提供了方向。

**项目地址:** [007CRIPTOGRAFIA/c-CVE-2024-0044](https://github.com/007CRIPTOGRAFIA/c-CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #2

**来源**: [CVE-2024-0044-0xbinder_CVE-2024-0044.md](../2024/CVE-2024-0044-0xbinder_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #3

**来源**: [CVE-2024-0044-Athexhacker_EXPLOITER.md](../2024/CVE-2024-0044-Athexhacker_EXPLOITER.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #4

**来源**: [CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md](../2024/CVE-2024-0044-Dit-Developers_CVE-2024-0044-.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #5

**来源**: [CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Kai2er_CVE-2024-0044-EXP.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 设备已连接ADB调试，目标应用已安装

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在Android 12, 12L, 13, 14 上利用 `PackageInstallerService.java` 中 `createSessionInternal` 函数的输入验证漏洞进行权限提升。该漏洞允许攻击者以任意应用的身份运行代码，从而可能读取或篡改其他应用的数据。从漏洞库信息来看，此漏洞无需用户交互即可利用。

**有效性:** 提供的POC代码尝试通过 `pm install` 命令，使用精心构造的 `payload`，欺骗系统以目标应用的UID安装APK。成功后，它会使用 `run-as` 命令以目标应用的身份创建该应用数据的tar归档文件，实现数据备份。
根据参考链接 (https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html 和 https://tinyhack.com/2024/06/07/extracting-whatsapp-database-or-any-app-data-from-android-12-13-using-cve-2024-0044/?s=03)，此POC代码是有效的，能够在受影响的Android版本上利用该漏洞导出应用数据。

**投毒风险:**  分析提供的POC代码，`/tmp/02f18dcd96cb8983cdb54c3b8b185bd9/CVE-2024-0044-EXP.sh` 脚本的主要功能是：

1.  获取目标应用的UID和APK路径。
2.  构造包含目标UID的`payload`，用于`pm install` 命令。
3.  使用`pm install`安装APK。
4.  使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。

代码中没有发现明显的恶意行为，例如上传数据、执行未授权操作等。代码逻辑主要集中在利用漏洞提取数据，而非植入恶意代码或后门。因此，投毒风险较低，可以认为投毒风险为0%。

**利用方式:**

1.  攻击者需要拥有ADB调试权限的设备。
2.  攻击者需要知道目标应用的包名。
3.  运行POC脚本，提供目标应用的包名作为参数。
4.  脚本将自动获取目标应用的UID和APK路径，构造payload，并尝试使用`pm install`命令安装APK。
5.  如果安装成功，脚本将使用`run-as`和`tar`命令创建目标应用数据的tar归档文件。
6.  攻击者可以从设备中提取该tar归档文件，并解压以访问应用数据。

**项目地址:** [Kai2er/CVE-2024-0044-EXP](https://github.com/Kai2er/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #6

**来源**: [CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md](../2024/CVE-2024-0044-MrW0l05zyn_cve-2024-0044.md)

## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #7

**来源**: [CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md](../2024/CVE-2024-0044-Re13orn_CVE-2024-0044-EXP.md)

## CVE-2024-0044 Android 权限提升漏洞

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要设备开启开发者模式，并且已经通过ADB 连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 允许攻击者在 Android 设备上进行权限提升。该漏洞位于 PackageInstallerService.java 的 createSessionInternal 函数中，由于不正确的输入验证，可能导致以任何应用程序的身份运行代码。利用该漏洞无需额外的执行权限，也无需用户交互。提供的POC脚本通过以下步骤利用该漏洞：

1.  **准备环境：** 创建临时目录 `/data/local/tmp/tempqazmkp/` 并设置权限，推送一个任意 APK 文件到该目录。
2.  **获取目标应用 UID：** 使用 `pm list packages -U` 命令获取目标应用（即想要窃取沙箱数据的应用）的 UID。
3.  **构造 Payload：** 构造一个特殊的 payload 字符串，其中包含目标应用的 UID 和沙箱路径。
4.  **安装 APK 并执行 run-as：** 使用 `pm install -i` 命令和一个包含换行符的 payload 来欺骗包管理器，使其相信安装是由目标应用程序发起的。安装后，使用 `run-as` 命令以目标应用的身份运行 `tar` 命令，将目标应用的沙箱目录打包成一个 tar 文件。
5.  **下载沙箱文件：** 将打包好的 tar 文件从设备下载到本地。
6.  **清理：** 删除设备上的临时文件和目录。

**有效性：**
该POC代码基于CVE描述和参考文章（Bypassing the "run-as" debuggability check on Android via newline injection），利用`pm install`和`run-as`命令组合来达到权限提升的目的。根据描述，该POC在Android 12/13上有效，且利用方式合理，因此判断该POC代码是有效的。

**投毒风险：**
分析POC代码后，未发现任何明显的恶意代码或隐藏的后门。脚本的主要功能是利用漏洞提取目标应用的沙箱数据，所有操作都集中在这个目标上。脚本中没有执行任何与此目标不相关的操作。因此，投毒风险较低，评估为0%。

**利用方式总结：**
攻击者利用 CVE-2024-0044 首先需要通过 adb 连接设备。然后，利用 `pm install -i` 命令注入换行符绕过 `run-as` 的调试检查，获取目标应用权限执行任意代码。最终，攻击者可以访问目标应用沙箱中的数据。

**项目地址:** [Re13orn/CVE-2024-0044-EXP](https://github.com/Re13orn/CVE-2024-0044-EXP)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #8

**来源**: [CVE-2024-0044-canyie_CVE-2024-0044.md](../2024/CVE-2024-0044-canyie_CVE-2024-0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #9

**来源**: [CVE-2024-0044-hunter24x24_cve_2024_0044.md](../2024/CVE-2024-0044-hunter24x24_cve_2024_0044.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #10

**来源**: [CVE-2024-0044-l1ackerronin_CVE-2024-0044.md](../2024/CVE-2024-0044-l1ackerronin_CVE-2024-0044.md)

## CVE-2024-0044-Android PackageInstallerService权限提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB访问权限和Root权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 是一个Android PackageInstallerService 中的权限提升漏洞。由于`PackageInstallerService.java`中的`createSessionInternal`方法对输入验证不当，可能导致攻击者可以以任何应用程序的身份运行。 这可能导致本地权限提升，而无需额外的执行权限。利用过程主要分为以下几个步骤：

1.  **APK推送:** 首先，将一个恶意的APK推送到目标设备的`/data/local/tmp/`目录下。
2.  **UID提取:** 提取目标应用程序的UID。
3.  **Payload生成:** 生成包含恶意负载的字符串，该负载利用`pm install`命令来模拟安装过程。
4.  **Payload执行:** 在`adb shell`中执行生成的payload。
5.  **run-as 利用:** 使用`run-as` 命令以目标应用的身份执行操作，进一步提取数据。
6.  **数据提取:** 使用`tar` 命令打包目标应用数据，然后使用`adb pull`命令将数据提取到攻击者设备。

**有效性评估：**
提供的POC代码似乎是有效的，因为它遵循了漏洞描述中提到的利用方式。通过推送恶意APK，伪造安装会话，并利用`run-as`命令，攻击者可以获得目标应用程序的权限。

**投毒风险评估：**
POC代码存在一定的投毒风险。虽然脚本的主要功能是利用漏洞，但脚本中也存在一些潜在的投毒点：
*   **恶意APK:** 脚本依赖于用户提供的APK文件，如果提供的APK文件本身包含恶意代码，则会导致设备被感染。
*   **payload.txt内容:** 脚本生成payload.txt 文件,如果payload构造不合理,可能导致设备崩溃或数据损坏。

总体而言，投毒风险较低，估计为10%。主要的风险在于用户提供的恶意APK。

**利用方式总结：**
CVE-2024-0044的利用方式是通过构造恶意的`PackageInstaller`会话来欺骗系统，使其认为攻击者拥有目标应用程序的权限。然后，攻击者可以使用`run-as`命令来执行操作，访问目标应用程序的数据目录。

**项目地址:** [l1ackerronin/CVE-2024-0044](https://github.com/l1ackerronin/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #11

**来源**: [CVE-2024-0044-scs-labrat_android_autorooter.md](../2024/CVE-2024-0044-scs-labrat_android_autorooter.md)

## CVE-2024-0044 - Android PackageInstallerService 特权提升

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 特权提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能导致本地提权

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 本地访问，需要用户安装包含恶意 payload 的应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService 中，由于不正确的输入验证，允许攻击者以任何应用的身份运行代码。这导致本地提权，无需额外权限，且无需用户交互。

**利用方式：**
1.  攻击者需要创建一个包含恶意 payload 的 APK 文件。Payload 的目的是利用 `PackageInstallerService` 的 `createSessionInternal` 函数中的漏洞。
2.  该 payload 包含一个精心构造的字符串，其中包含目标应用程序的 UID。攻击者通过 `pm list packages -U` 命令获取目标应用的 UID。
3.  `exploit.sh`脚本尝试使用`pm install`命令，-i参数传入构造的payload,以目标应用UID安装任何应用，实现模拟运行。
4.  由于该漏洞不需要额外的执行权限，攻击者只需要诱导用户安装这个恶意 APK 就可以实现提权。

**有效性：**
根据提供的漏洞信息和利用代码，可以判断 POC 代码大致有效，因为它试图利用 CVE-2024-0044。

**投毒风险：**
该仓库存在一定的投毒风险，风险值约为 10%。体现在以下几个方面：
* `commands.rc` 和 `execute_script.rc` 中的 IP 地址和路径需要用户手动修改，如果用户不小心使用了攻击者的地址，可能会被反向利用。
* `exploit.sh` 脚本中的 `victim_package` 需要用户指定，如果用户不了解 Android 应用的包名，可能会导致利用失败，甚至可能意外地影响其他应用。
* `exploit.sh`  脚本的用途看起来是提权，但脚本中使用了wget下载shell脚本等行为，存在一定的风险，如果攻击者在shell脚本中写入恶意代码，可能导致更严重的后果。
总的来说，这个仓库更像是一个漏洞利用的思路记录和初步尝试，还没有形成完全自动化和稳定的利用工具，需要用户进行一定的配置和修改，因此存在一定的投毒风险。

**搜索引擎结果**
由于没有给出搜索引擎结果，无法评估其对有效性和投毒风险的影响。若搜到更多可靠的分析报告，可用于判断poc的有效性。若搜到更多exp，则投毒风险降低，因为会有更多的参考实现。

**项目地址:** [scs-labrat/android_autorooter](https://github.com/scs-labrat/android_autorooter)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---



---

## POC #12

**来源**: [CVE-2024-0044-sridhar-sec_EvilDroid.md](../2024/CVE-2024-0044-sridhar-sec_EvilDroid.md)

## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)

---

