# CVE-2024-1709

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-1709-AMRICHASFUCK_Mass-CVE-2024-1709.md](../2024/CVE-2024-1709-AMRICHASFUCK_Mass-CVE-2024-1709.md)

## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 23.9.7

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709是ConnectWise ScreenConnect 23.9.7及更早版本中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的URL绕过身份验证，直接访问敏感信息或关键系统。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的PoC代码是有效的。 多个来源（如Huntress的博客、Palo Alto Networks的Unit 42报告）表明该漏洞容易被利用，并且已经存在公开可用的PoC。

**投毒风险：**
PoC代码本身的功能是利用身份验证绕过漏洞，上传一个恶意的扩展，该扩展包含一个Web shell。这个Web shell允许攻击者通过`cmd`参数执行任意命令。尽管PoC的目的是为了利用漏洞，但其中的恶意扩展的创建和上传过程本身具有潜在的风险，如果被恶意修改，可以被用于传播恶意软件或执行其他未授权操作。风险评估为10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过ScreenConnect的身份验证机制。
2.  **上传恶意扩展：** 绕过身份验证后，攻击者上传一个包含恶意Web shell的扩展。
3.  **远程代码执行：** 攻击者通过访问上传的Web shell，并利用`cmd`参数执行任意命令。

PoC代码中，首先生成一个随机的插件GUID、payload文件名以及handler class名称。然后，它创建了一个包含恶意代码的`.ashx`文件（payload_data），该文件包含一个Web shell，允许执行任意命令。同时，创建了一个manifest文件（manifest_data）来描述该插件。这些文件被打包成一个zip文件（resources.zip）。接下来，代码从目标ScreenConnect服务器获取反伪造令牌（anti_forgery_token）。最后，利用反伪造令牌将包含恶意Web shell的zip文件上传到ScreenConnect服务器。攻击者可以通过访问上传的Web shell，传递`cmd`参数来执行任意命令。

综上所述，CVE-2024-1709是一个严重的安全漏洞，攻击者可以利用该漏洞完全控制受影响的ScreenConnect服务器。强烈建议ScreenConnect管理员尽快升级到23.9.8或更高版本以修复该漏洞。

**项目地址:** [AMRICHASFUCK/Mass-CVE-2024-1709](https://github.com/AMRICHASFUCK/Mass-CVE-2024-1709)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #2

**来源**: [CVE-2024-1709-HussainFathy_CVE-2024-1709.md](../2024/CVE-2024-1709-HussainFathy_CVE-2024-1709.md)

# CVE-2024-1709

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-1709-AMRICHASFUCK_Mass-CVE-2024-1709.md](../2024/CVE-2024-1709-AMRICHASFUCK_Mass-CVE-2024-1709.md)

## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 23.9.7

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709是ConnectWise ScreenConnect 23.9.7及更早版本中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的URL绕过身份验证，直接访问敏感信息或关键系统。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的PoC代码是有效的。 多个来源（如Huntress的博客、Palo Alto Networks的Unit 42报告）表明该漏洞容易被利用，并且已经存在公开可用的PoC。

**投毒风险：**
PoC代码本身的功能是利用身份验证绕过漏洞，上传一个恶意的扩展，该扩展包含一个Web shell。这个Web shell允许攻击者通过`cmd`参数执行任意命令。尽管PoC的目的是为了利用漏洞，但其中的恶意扩展的创建和上传过程本身具有潜在的风险，如果被恶意修改，可以被用于传播恶意软件或执行其他未授权操作。风险评估为10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过ScreenConnect的身份验证机制。
2.  **上传恶意扩展：** 绕过身份验证后，攻击者上传一个包含恶意Web shell的扩展。
3.  **远程代码执行：** 攻击者通过访问上传的Web shell，并利用`cmd`参数执行任意命令。

PoC代码中，首先生成一个随机的插件GUID、payload文件名以及handler class名称。然后，它创建了一个包含恶意代码的`.ashx`文件（payload_data），该文件包含一个Web shell，允许执行任意命令。同时，创建了一个manifest文件（manifest_data）来描述该插件。这些文件被打包成一个zip文件（resources.zip）。接下来，代码从目标ScreenConnect服务器获取反伪造令牌（anti_forgery_token）。最后，利用反伪造令牌将包含恶意Web shell的zip文件上传到ScreenConnect服务器。攻击者可以通过访问上传的Web shell，传递`cmd`参数来执行任意命令。

综上所述，CVE-2024-1709是一个严重的安全漏洞，攻击者可以利用该漏洞完全控制受影响的ScreenConnect服务器。强烈建议ScreenConnect管理员尽快升级到23.9.8或更高版本以修复该漏洞。

**项目地址:** [AMRICHASFUCK/Mass-CVE-2024-1709](https://github.com/AMRICHASFUCK/Mass-CVE-2024-1709)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #2

**来源**: [CVE-2024-1709-Teexo_ScreenConnect-CVE-2024-1709-Exploit.md](../2024/CVE-2024-1709-Teexo_ScreenConnect-CVE-2024-1709-Exploit.md)

## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，允许未经身份验证的攻击者直接访问敏感信息或关键系统，并可能导致远程代码执行。

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行ConnectWise ScreenConnect，且版本为受影响版本，攻击者能够通过网络访问目标。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 23.9.7 及之前版本中存在的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者利用备用路径或通道绕过身份验证，从而获得对系统资源的访问权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码有效。漏洞库信息中CVSS评分为10分（CRITICAL），表明危害程度极高。搜索引擎结果中，多个链接提到该漏洞被积极利用，并且存在公开的POC。漏洞利用代码提供了检查目标是否易受攻击的功能，以及尝试利用漏洞访问管理端点的功能，进一步验证了该漏洞的可利用性。

**投毒风险分析：**

对提供的漏洞利用代码进行分析，发现其主要功能为检测漏洞是否存在以及尝试访问管理端点。代码中没有发现明显的恶意行为或后门植入行为。但是，需要注意以下几点：

*   该工具尝试访问管理端点，如果成功，可能会修改系统配置或执行其他恶意操作。这取决于攻击者的后续行为。
*   代码的LICENSE声明版权为2025年，与现在的时间2024年不符，代码作者声明为Security Researcher，并非漏洞披露的机构或个人，存在一定的可疑。
*   代码中使用了`verify=False` 参数，禁用SSL证书验证。这可能会使攻击者更容易进行中间人攻击，拦截或篡改通信。

综合考虑，认为该POC存在较低的投毒风险，大约为10%。

**利用方式分析：**

利用方式主要分为以下几个步骤：

1.  **漏洞检测：** 使用POC代码中的`check_vulnerability`函数，通过发送特制的HTTP请求到目标`/SetupWizard.aspx/RemoteSupport`路径，检测目标是否存在身份验证绕过漏洞。
2.  **管理端点发现：** 如果漏洞存在，利用代码会尝试访问常见的管理端点，例如`/Admin`、`/Administration`、`/SetupWizard.aspx`，以确定哪些端点可以未经身份验证访问。
3.  **利用：** 如果目标处于初始设置模式（SetupWizard.aspx），攻击者可以通过访问该页面创建管理员账户，进而完全控制系统。

总的来说，该漏洞利用相对简单，但危害巨大。成功利用该漏洞可以导致敏感信息泄露、系统配置被篡改，甚至远程代码执行。

**项目地址:** [Teexo/ScreenConnect-CVE-2024-1709-Exploit](https://github.com/Teexo/ScreenConnect-CVE-2024-1709-Exploit)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #3

**来源**: [CVE-2024-1709-W01fh4cker_ScreenConnect-AuthBypass-RCE.md](../2024/CVE-2024-1709-W01fh4cker_ScreenConnect-AuthBypass-RCE.md)

## CVE-2024-1709 - ConnectWise ScreenConnect 身份验证绕过与远程代码执行

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 严重，可能导致未授权访问、信息泄露和远程代码执行

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行受影响的 ConnectWise ScreenConnect 版本，且攻击者可访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，对 CVE-2024-1709 的有效性、投毒风险和利用方式进行评估分析。

**1. 有效性:**

*   漏洞库信息表明 CVE-2024-1709 是一个身份验证绕过漏洞，影响 ConnectWise ScreenConnect 23.9.7 及更早版本，允许攻击者直接访问敏感信息或关键系统。CVSS 评分高达 10 分，表明其严重性。CISA 已将其添加到已知被利用的漏洞目录中，证明该漏洞正在被积极利用。
*   搜索结果也确认了该漏洞的严重性，并指出存在公开可用的 PoC 利用代码。
*   提供的漏洞利用代码（ScreenConnect-AuthBypass-RCE.py）旨在利用 CVE-2024-1708 和 CVE-2024-1709 实现远程代码执行。该脚本允许攻击者添加具有指定用户名和密码的新管理员用户，从而绕过身份验证。README.md 文件中包含了使用说明和利用示例。
*   综上，该漏洞是有效的，并且存在可用的 PoC 代码，允许攻击者绕过身份验证并可能执行远程代码。

**2. 投毒风险:**

*   分析提供的 POC 代码（`ScreenConnect-AuthBypass-RCE.py`）：
    *   脚本的功能主要是身份验证绕过和添加新用户，以及尝试远程代码执行。
    *   脚本中包含创建 WebHandler 的逻辑,  使用 `ProcessRequest` 函数执行系统命令。
    *   代码中使用 `requests` 库发送 HTTP 请求，这本身并无恶意，但如果服务器响应被篡改或劫持，可能存在风险。
    *   代码逻辑较为清晰，没有明显的隐藏恶意代码的迹象。
*   对 `README.md` 文件的分析：
    *   文件包含安装依赖和使用说明，以及免责声明。没有发现任何可疑内容。
*   虽然主要的目的是漏洞利用，但仍然存在一些潜在的投毒风险，虽然很小，例如：
    *   **依赖项风险：**  虽然 `requests` 是一个常见的库，但恶意作者可能会通过替换 `pip install` 源或使用类似名称的恶意软件包来引入风险。
    *   **服务器端风险：** 脚本成功执行的前提是目标服务器存在漏洞。如果攻击者诱骗用户在受感染的服务器上运行该脚本，服务器本身可能被恶意控制，从而导致进一步的攻击。
    *   **代码篡改：**  在下载和运行脚本之间，攻击者可能会篡改代码，添加恶意功能。
*   因此，投毒风险评估为 10%。这个百分比反映了以下几点：代码本身看起来主要是漏洞利用，但仍然存在一些与依赖项、运行环境相关的潜在风险。

**3. 利用方式:**

1.  **身份验证绕过:** 攻击者利用 CVE-2024-1709 绕过 ConnectWise ScreenConnect 的身份验证机制。
2.  **创建管理员用户:** 使用 PoC 脚本添加一个新的管理员帐户，从而获得对系统的完全控制权。
3.  **远程代码执行 (RCE):** 攻击者利用 CVE-2024-1708 (path traversal) 上传恶意文件，从而在服务器上执行任意代码。
4.  **控制系统:** 攻击者获得系统控制权后，可以访问敏感信息、安装恶意软件或进行其他恶意活动。

总而言之，CVE-2024-1709 是一个严重的安全漏洞，利用难度低，影响范围广。系统管理员应尽快升级到 ConnectWise ScreenConnect 23.9.8 或更高版本，以修复此漏洞。

**项目地址:** [W01fh4cker/ScreenConnect-AuthBypass-RCE](https://github.com/W01fh4cker/ScreenConnect-AuthBypass-RCE)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #4

**来源**: [CVE-2024-1709-cjybao_CVE-2024-1709-and-CVE-2024-1708.md](../2024/CVE-2024-1709-cjybao_CVE-2024-1709-and-CVE-2024-1708.md)

## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行和控制关键系统

**影响版本:** <= 23.9.7

**利用条件:** 目标ScreenConnect实例可从网络访问，且版本低于或等于23.9.7

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 23.9.7 及更早版本中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL，绕过身份验证机制，从而直接访问敏感信息或关键系统。\n\n**漏洞利用有效性：**\n根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用具有很高的有效性。CISA已将其添加到已知被利用的漏洞目录(KEV)。搜索引擎结果也表明该漏洞被积极利用，并且存在公开的POC。\n\n**投毒风险评估：**\n该POC代码的投毒风险较低，约为1%。代码主要功能是创建并上传一个恶意扩展，该扩展包含一个webshell。webshell允许攻击者在目标系统上执行任意命令。虽然存在执行任意命令的风险，但代码本身没有明显的恶意行为，例如删除文件、传播恶意软件等。风险主要在于使用者利用此webshell进行恶意操作。\n\n**漏洞利用方式：**\n漏洞利用方式如下：\n1.  **身份验证绕过：** 攻击者利用身份验证绕过漏洞，无需有效凭据即可与ScreenConnect服务器交互。具体绕过方式可能涉及操纵URL路径或利用其他未公开的身份验证机制缺陷。\n2.  **上传恶意扩展：** 攻击者使用POC代码创建一个包含webshell的恶意扩展。扩展包含一个C# webshell，该webshell通过查询字符串参数`cmd`接收命令并在服务器上执行。\n3.  **远程代码执行：** 攻击者通过访问webshell的URL，并传递要执行的命令作为查询字符串参数，在服务器上执行任意代码。\n\n**总结：**\nCVE-2024-1709 是一个严重的安全漏洞，利用简单，影响广泛。受影响的组织应立即升级到 ConnectWise ScreenConnect 23.9.8 或更高版本。

**项目地址:** [cjybao/CVE-2024-1709-and-CVE-2024-1708](https://github.com/cjybao/CVE-2024-1709-and-CVE-2024-1708)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #5

**来源**: [CVE-2024-1709-sxyrxyy_CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass.md](../2024/CVE-2024-1709-sxyrxyy_CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass.md)

## CVE-2024-1709-ConnectWise ScreenConnect-Authentication Bypass

**漏洞编号:** CVE-2024-1709

**漏洞类型:** Authentication Bypass

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致未经授权访问和控制关键系统

**影响版本:** <= 23.9.7

**利用条件:** 需要网络访问 vulnerable ScreenConnect 实例

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 中的一个身份验证绕过漏洞。攻击者可以通过发送特制的请求到 `/SetupWizard.aspx/` 绕过身份验证。PoC 代码利用此漏洞创建一个新的管理员用户。PoC脚本首先访问SetupWizard.aspx页面，提取`__VIEWSTATE`和`__VIEWSTATEGENERATOR`，然后构造POST请求，模拟用户创建过程，最终添加恶意用户。根据搜索结果，该漏洞已遭到积极利用，并且PoC已公开可用。投毒风险较低，代码较为简单，没有明显的恶意行为，主要是利用了SetupWizard页面默认没有删除的功能来添加用户。不过仍然存在一些潜在风险,作者可以精心构造payload，利用用户创建的步骤执行恶意操作。或者在结果文件中添加恶意链接。

**项目地址:** [sxyrxyy/CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass](https://github.com/sxyrxyy/CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---



---

## POC #3

**来源**: [CVE-2024-1709-Teexo_ScreenConnect-CVE-2024-1709-Exploit.md](../2024/CVE-2024-1709-Teexo_ScreenConnect-CVE-2024-1709-Exploit.md)

## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，允许未经身份验证的攻击者直接访问敏感信息或关键系统，并可能导致远程代码执行。

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行ConnectWise ScreenConnect，且版本为受影响版本，攻击者能够通过网络访问目标。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 23.9.7 及之前版本中存在的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者利用备用路径或通道绕过身份验证，从而获得对系统资源的访问权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码有效。漏洞库信息中CVSS评分为10分（CRITICAL），表明危害程度极高。搜索引擎结果中，多个链接提到该漏洞被积极利用，并且存在公开的POC。漏洞利用代码提供了检查目标是否易受攻击的功能，以及尝试利用漏洞访问管理端点的功能，进一步验证了该漏洞的可利用性。

**投毒风险分析：**

对提供的漏洞利用代码进行分析，发现其主要功能为检测漏洞是否存在以及尝试访问管理端点。代码中没有发现明显的恶意行为或后门植入行为。但是，需要注意以下几点：

*   该工具尝试访问管理端点，如果成功，可能会修改系统配置或执行其他恶意操作。这取决于攻击者的后续行为。
*   代码的LICENSE声明版权为2025年，与现在的时间2024年不符，代码作者声明为Security Researcher，并非漏洞披露的机构或个人，存在一定的可疑。
*   代码中使用了`verify=False` 参数，禁用SSL证书验证。这可能会使攻击者更容易进行中间人攻击，拦截或篡改通信。

综合考虑，认为该POC存在较低的投毒风险，大约为10%。

**利用方式分析：**

利用方式主要分为以下几个步骤：

1.  **漏洞检测：** 使用POC代码中的`check_vulnerability`函数，通过发送特制的HTTP请求到目标`/SetupWizard.aspx/RemoteSupport`路径，检测目标是否存在身份验证绕过漏洞。
2.  **管理端点发现：** 如果漏洞存在，利用代码会尝试访问常见的管理端点，例如`/Admin`、`/Administration`、`/SetupWizard.aspx`，以确定哪些端点可以未经身份验证访问。
3.  **利用：** 如果目标处于初始设置模式（SetupWizard.aspx），攻击者可以通过访问该页面创建管理员账户，进而完全控制系统。

总的来说，该漏洞利用相对简单，但危害巨大。成功利用该漏洞可以导致敏感信息泄露、系统配置被篡改，甚至远程代码执行。

**项目地址:** [Teexo/ScreenConnect-CVE-2024-1709-Exploit](https://github.com/Teexo/ScreenConnect-CVE-2024-1709-Exploit)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #4

**来源**: [CVE-2024-1709-W01fh4cker_ScreenConnect-AuthBypass-RCE.md](../2024/CVE-2024-1709-W01fh4cker_ScreenConnect-AuthBypass-RCE.md)

## CVE-2024-1709 - ConnectWise ScreenConnect 身份验证绕过与远程代码执行

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 严重，可能导致未授权访问、信息泄露和远程代码执行

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行受影响的 ConnectWise ScreenConnect 版本，且攻击者可访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，对 CVE-2024-1709 的有效性、投毒风险和利用方式进行评估分析。

**1. 有效性:**

*   漏洞库信息表明 CVE-2024-1709 是一个身份验证绕过漏洞，影响 ConnectWise ScreenConnect 23.9.7 及更早版本，允许攻击者直接访问敏感信息或关键系统。CVSS 评分高达 10 分，表明其严重性。CISA 已将其添加到已知被利用的漏洞目录中，证明该漏洞正在被积极利用。
*   搜索结果也确认了该漏洞的严重性，并指出存在公开可用的 PoC 利用代码。
*   提供的漏洞利用代码（ScreenConnect-AuthBypass-RCE.py）旨在利用 CVE-2024-1708 和 CVE-2024-1709 实现远程代码执行。该脚本允许攻击者添加具有指定用户名和密码的新管理员用户，从而绕过身份验证。README.md 文件中包含了使用说明和利用示例。
*   综上，该漏洞是有效的，并且存在可用的 PoC 代码，允许攻击者绕过身份验证并可能执行远程代码。

**2. 投毒风险:**

*   分析提供的 POC 代码（`ScreenConnect-AuthBypass-RCE.py`）：
    *   脚本的功能主要是身份验证绕过和添加新用户，以及尝试远程代码执行。
    *   脚本中包含创建 WebHandler 的逻辑,  使用 `ProcessRequest` 函数执行系统命令。
    *   代码中使用 `requests` 库发送 HTTP 请求，这本身并无恶意，但如果服务器响应被篡改或劫持，可能存在风险。
    *   代码逻辑较为清晰，没有明显的隐藏恶意代码的迹象。
*   对 `README.md` 文件的分析：
    *   文件包含安装依赖和使用说明，以及免责声明。没有发现任何可疑内容。
*   虽然主要的目的是漏洞利用，但仍然存在一些潜在的投毒风险，虽然很小，例如：
    *   **依赖项风险：**  虽然 `requests` 是一个常见的库，但恶意作者可能会通过替换 `pip install` 源或使用类似名称的恶意软件包来引入风险。
    *   **服务器端风险：** 脚本成功执行的前提是目标服务器存在漏洞。如果攻击者诱骗用户在受感染的服务器上运行该脚本，服务器本身可能被恶意控制，从而导致进一步的攻击。
    *   **代码篡改：**  在下载和运行脚本之间，攻击者可能会篡改代码，添加恶意功能。
*   因此，投毒风险评估为 10%。这个百分比反映了以下几点：代码本身看起来主要是漏洞利用，但仍然存在一些与依赖项、运行环境相关的潜在风险。

**3. 利用方式:**

1.  **身份验证绕过:** 攻击者利用 CVE-2024-1709 绕过 ConnectWise ScreenConnect 的身份验证机制。
2.  **创建管理员用户:** 使用 PoC 脚本添加一个新的管理员帐户，从而获得对系统的完全控制权。
3.  **远程代码执行 (RCE):** 攻击者利用 CVE-2024-1708 (path traversal) 上传恶意文件，从而在服务器上执行任意代码。
4.  **控制系统:** 攻击者获得系统控制权后，可以访问敏感信息、安装恶意软件或进行其他恶意活动。

总而言之，CVE-2024-1709 是一个严重的安全漏洞，利用难度低，影响范围广。系统管理员应尽快升级到 ConnectWise ScreenConnect 23.9.8 或更高版本，以修复此漏洞。

**项目地址:** [W01fh4cker/ScreenConnect-AuthBypass-RCE](https://github.com/W01fh4cker/ScreenConnect-AuthBypass-RCE)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #5

**来源**: [CVE-2024-1709-cjybao_CVE-2024-1709-and-CVE-2024-1708.md](../2024/CVE-2024-1709-cjybao_CVE-2024-1709-and-CVE-2024-1708.md)

## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行和控制关键系统

**影响版本:** <= 23.9.7

**利用条件:** 目标ScreenConnect实例可从网络访问，且版本低于或等于23.9.7

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 23.9.7 及更早版本中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL，绕过身份验证机制，从而直接访问敏感信息或关键系统。\n\n**漏洞利用有效性：**\n根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用具有很高的有效性。CISA已将其添加到已知被利用的漏洞目录(KEV)。搜索引擎结果也表明该漏洞被积极利用，并且存在公开的POC。\n\n**投毒风险评估：**\n该POC代码的投毒风险较低，约为1%。代码主要功能是创建并上传一个恶意扩展，该扩展包含一个webshell。webshell允许攻击者在目标系统上执行任意命令。虽然存在执行任意命令的风险，但代码本身没有明显的恶意行为，例如删除文件、传播恶意软件等。风险主要在于使用者利用此webshell进行恶意操作。\n\n**漏洞利用方式：**\n漏洞利用方式如下：\n1.  **身份验证绕过：** 攻击者利用身份验证绕过漏洞，无需有效凭据即可与ScreenConnect服务器交互。具体绕过方式可能涉及操纵URL路径或利用其他未公开的身份验证机制缺陷。\n2.  **上传恶意扩展：** 攻击者使用POC代码创建一个包含webshell的恶意扩展。扩展包含一个C# webshell，该webshell通过查询字符串参数`cmd`接收命令并在服务器上执行。\n3.  **远程代码执行：** 攻击者通过访问webshell的URL，并传递要执行的命令作为查询字符串参数，在服务器上执行任意代码。\n\n**总结：**\nCVE-2024-1709 是一个严重的安全漏洞，利用简单，影响广泛。受影响的组织应立即升级到 ConnectWise ScreenConnect 23.9.8 或更高版本。

**项目地址:** [cjybao/CVE-2024-1709-and-CVE-2024-1708](https://github.com/cjybao/CVE-2024-1709-and-CVE-2024-1708)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

## POC #6

**来源**: [CVE-2024-1709-sxyrxyy_CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass.md](../2024/CVE-2024-1709-sxyrxyy_CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass.md)

## CVE-2024-1709-ConnectWise ScreenConnect-Authentication Bypass

**漏洞编号:** CVE-2024-1709

**漏洞类型:** Authentication Bypass

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致未经授权访问和控制关键系统

**影响版本:** <= 23.9.7

**利用条件:** 需要网络访问 vulnerable ScreenConnect 实例

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 中的一个身份验证绕过漏洞。攻击者可以通过发送特制的请求到 `/SetupWizard.aspx/` 绕过身份验证。PoC 代码利用此漏洞创建一个新的管理员用户。PoC脚本首先访问SetupWizard.aspx页面，提取`__VIEWSTATE`和`__VIEWSTATEGENERATOR`，然后构造POST请求，模拟用户创建过程，最终添加恶意用户。根据搜索结果，该漏洞已遭到积极利用，并且PoC已公开可用。投毒风险较低，代码较为简单，没有明显的恶意行为，主要是利用了SetupWizard页面默认没有删除的功能来添加用户。不过仍然存在一些潜在风险,作者可以精心构造payload，利用用户创建的步骤执行恶意操作。或者在结果文件中添加恶意链接。

**项目地址:** [sxyrxyy/CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass](https://github.com/sxyrxyy/CVE-2024-1709-ConnectWise-ScreenConnect-Authentication-Bypass)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)

---

