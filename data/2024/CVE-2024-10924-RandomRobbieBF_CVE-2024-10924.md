## CVE-2024-10924 - Really Simple Security (Free, Pro, and Pro Multisite) WordPress Plugin 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress Plugin

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 9.0.0 – 9.1.1.1

**利用条件:** 启用双因子身份验证 (Two-Factor Authentication) 功能（默认禁用）

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本漏洞源于Really Simple Security插件在处理双因子身份验证（2FA）REST API动作时的逻辑缺陷。核心问题在于'check_login_and_get_user'函数在验证用户登录凭证时，未能正确处理异常或错误的返回逻辑。根据提供的POC请求分析，攻击者通过发送一个构造好的POST请求至'/wp-json/reallysimplessl/v1/two_fa/skip_onboarding'接口，并在JSON负载中提供目标用户的'user_id'（通常管理员ID为1）和任意'login_nonce'，即可触发绕过。由于程序在验证nonce失败或处理登录逻辑时存在缺陷，它可能导致API错误地授予攻击者对该用户账号的访问权限。该POC清晰地展示了攻击入口点和参数结构，具有极高的利用参考价值，且不需要任何前置权限，证明了该漏洞在2FA功能开启的环境下是极其危险且易于利用的。利用步骤：1. 确认目标WordPress站点安装了受影响版本的Really Simple Security插件。2. 确认站点已开启双因子身份验证功能。3. 获取目标用户的ID（如通过WP-Scan或作者归档页面推断）。4. 构造一个包含user_id、login_nonce和redirect_to参数的JSON Payload。5. 使用HTTP工具向'/wp-json/reallysimplessl/v1/two_fa/skip_onboarding'发送POST请求。6. 成功执行后，攻击者将获得相应权限的登录会话，并重定向至后台。投毒风险分析：该POC代码本身表现为标准的HTTP请求定义，采用清晰的Markdown说明和简洁的JSON数据包，不包含任何外部脚本加载、混淆代码或二进制可执行文件，因此直接投毒风险极低。然而，从威胁情报角度看，此类高价值的CVE往往会吸引恶意行为者在Github等平台发布虚假的、带有后门的自动化利用脚本。这些虚假脚本通常打着‘批量检测工具’的旗号，实则在Python或Go代码中嵌入Base64加密的Shell反弹指令。在本研究中，提供的README.md和HTTP请求模版是纯粹的技术验证，其风险主要在于被初级黑客直接用于非法扫描，而非POC本身携带恶意软件。针对此类漏洞，建议管理员立即升级插件至9.1.2或更高版本。由于该漏洞利用门槛极低且影响面超过400万站点，防御者应密切监控针对REST API端点的异常POST请求。

**项目地址:** [https://github.com/really-simple-plugins/really-simple-ssl](https://github.com/really-simple-plugins/really-simple-ssl)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
