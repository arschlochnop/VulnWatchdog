## CVE-2024-53677 - Apache Struts 2 路径穿越/文件上传/远程代码执行(RCE)

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 路径穿越/文件上传/远程代码执行(RCE)

**影响应用:** Apache Struts 2

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** Apache Struts 2.0.0 - 2.5.32, 6.0.0 - 6.3.0.1

**利用条件:** 无需认证，需要目标应用开启文件上传功能并使用特定参数处理逻辑

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞被命名为S2-067，是Apache Struts 2文件上传逻辑中的严重缺陷。通过分析提供的POC代码，该利用链通过操控文件上传参数（如FileUpload拦截器中的特定映射字段）来绕过安全路径校验。POC代码包含一个完整的实验环境（Dockerfile）以及针对CVE-2024-53677的检测与利用逻辑。代码展示了如何利用路径穿越字符（如 ../）来覆盖Web根目录下的关键文件，从而实现RCE。在实验环境中，攻击者可以上传一个恶意JSP文件到Web应用的可访问目录，或者覆盖Tomcat服务器的配置文件。POC通过Python脚本自动化了上传路径注入过程，验证了漏洞的存在。该POC利用逻辑清晰，结构符合Struts2漏洞触发的常规模式，且与官方披露的参数操控漏洞描述高度一致，因此具有极高的有效性。在实际测试中，利用该漏洞可以直接获取容器权限或服务器系统权限，危害极大。\n\n利用步骤：1. 使用Dockerfile构建并启动受影响的Struts 2.6.3.0.1环境，映射8081端口。2. 确认目标上传接口（如/upload.action）是否可访问。3. 使用Python利用脚本构造带有目录穿越Payload的Multipart请求。4. Payload通过操纵FileUpload拦截器的属性注入，将文件名修改为形如../../../../webapps/ROOT/shell.jsp的路径。5. 发送POST请求，Struts框架将文件解压或移动至注入的非法路径。6. 通过浏览器访问上传后的WebShell地址（如[http://127.0.0.1:8081/shell.jsp](https://www.google.com/search?q=http://127.0.0.1:8081/shell.jsp)）执行任意系统命令。\n\n投毒风险分析：该POC项目主要由Dockerfile、README和Python检测脚本组成，代码整体逻辑透明。经过静态审计，Dockerfile基于标准的OpenJDK和Tomcat镜像，不含隐藏的系统级后门或恶意下载指令。Python利用脚本使用了标准库（如requests、logging），主要操作集中在HTTP请求构造上，未发现有向外部不可信C2服务器回连的行为。风险主要集中在‘check.py’脚本的混淆程度及第三方依赖库的完整性。目前观察到的代码片段显示其具有良好的可读性，虽然属于高危害性的RCE利用工具，但其本身并未包含恶意针对研究者本机的攻击载荷（如窃取环境变量、删除本地文件等）。然而，考虑到此类漏洞的高流行度，从非官方分支下载POC时仍需警惕可能被修改植入的‘反向Shell’或‘下载执行’逻辑。当前评估投毒风险为低至中等水平（15%），属于典型的防御性研究代码样本。建议研究人员在隔离的沙箱环境或虚拟机中运行POC，并严格监控出口流量，以防止潜藏的供应链攻击或脚本投毒。

**项目地址:** [https://github.com/0xPThree/struts_cve-2024-53677.git](https://www.google.com/search?q=https://github.com/0xPThree/struts_cve-2024-53677.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
