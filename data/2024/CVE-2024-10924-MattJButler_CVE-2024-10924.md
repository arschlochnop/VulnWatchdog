## CVE-2024-10924 - Really Simple Security (原 Really Simple SSL) 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (原 Really Simple SSL)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 9.0.0 至 9.1.1.1

**利用条件:** 远程网络访问，插件版本在受影响范围内，目标网站启用了双因子验证（2FA）功能

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：提供的Python代码是一个针对CVE-2024-10924的典型概念验证脚本。该漏洞存在于Really Simple Security插件的REST API端点中。漏洞的根源在于`skip_onboarding`函数未能正确验证用户身份和Nonce的合法性。在POC中，攻击者通过向`/wp-json/reallysimplessl/v1/two_fa/skip_onboarding`发送POST请求，并携带特定的`user_id`（通常管理员为1）和任意的`login_nonce`值，即可触发绕过逻辑。脚本中使用了`requests`库模拟该行为。如果服务器返回成功或在响应中包含了登录凭证/会话Cookie，则证明该漏洞可利用。此POC结构简单、逻辑清晰，直接指向了漏洞核心端点，有效性较高，但需要根据实际目标环境调整IP和可能的路径后缀。利用步骤：首先，识别目标WordPress站点是否安装了9.0.0至9.1.1.1版本的Really Simple Security插件。其次，确定目标管理员用户的ID（默认为1）。然后，构造一个JSON格式的POST请求，包含user_id、login_nonce和redirect_to字段。最后，发送请求至受影响的API端点。如果攻击成功，服务器将因为逻辑漏洞而错误地验证用户身份，允许攻击者以管理员权限登录。投毒风险分析：经过对POC代码的静态分析，该脚本属于低风险类别。代码主要由标准的Python `requests`库组成，用于发起HTTP POST请求。代码逻辑透明，不包含任何混淆代码（如Base64加密的Payload、十六进制转义字符或动态执行函数如eval、exec等）。脚本中没有发现尝试连接攻击者控制的外部命令与控制（C2）服务器的行为，也没有扫描本地敏感文件（如/etc/shadow或.env）或修改系统配置的动作。虽然POC中包含硬编码的IP地址占位符，但这属于合法的测试配置。由于该漏洞在WordPress生态中影响巨大，市面上可能存在以此漏洞为诱饵的‘虚假POC’。那些POC通常会包含混淆的Shellcode或自动下载执行恶意二进制文件的逻辑。然而，本案例中的POC代码非常简洁，专注于验证API端点响应，未发现恶意后门植入或环境破坏行为。总体而言，该代码是安全的防御性研究工具，但用户在使用时仍应在受控的实验室环境中运行，避免在未授权的生产资产上执行测试。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
