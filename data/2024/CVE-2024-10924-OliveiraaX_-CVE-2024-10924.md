## CVE-2024-10924 - WordPress Really Simple Security 插件 (原名 Really Simple SSL) 身份验证绕过

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** WordPress Really Simple Security 插件 (原名 Really Simple SSL)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.0.0 至 9.1.1.1

**利用条件:** 无需身份验证，目标网站需安装并激活受影响版本的插件，且通常开启了双重身份验证 (2FA) 功能。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：提供的Python POC代码展示了针对WordPress Really Simple Security插件中关键逻辑漏洞的直接利用方式。该漏洞源于插件在处理双重身份验证（2FA）跳过逻辑时，未能正确验证用户的身份凭证。通过向REST API端点 `/?rest_route=/reallysimplessl/v1/two_fa/skip_onboarding` 发送包含目标 `user_id` 和任意 `login_nonce` 的POST请求，插件的逻辑会错误地认为用户已通过验证。POC代码成功模拟了这一过程：它构造了一个包含 `user_id`、`login_nonce` 和 `redirect_to` 路径的JSON负载。当服务器响应200状态码时，POC会捕获并打印Set-Cookie头中的敏感会话信息。由于WordPress使用Cookie进行状态管理，攻击者只需获取这些Cookie，即可在浏览器中以目标用户（通常为ID为1的管理账户）的身份完全控制网站。此POC逻辑清晰，直接指向漏洞点，是高度有效的自动化利用脚本。利用步骤：首先，攻击者需确定目标WordPress站点是否运行受影响的插件版本。其次，通过简单的枚举或默认设置确定管理员用户的ID（通常为1）。接着，运行此Python脚本，传入目标URL和用户ID。脚本发送POST请求后，如果漏洞存在，服务器将返回该用户的登录凭证（Cookies）。最后，攻击者将这些Cookie导入浏览器即可登录后台。投毒风险分析：该POC代码的投毒风险极低，评分为5%。从代码结构来看，它仅使用了Python的标准库 `sys`、`urllib.parse` 以及常用的第三方库 `requests`。代码逻辑完全透明，没有任何混淆、加密或Base64编码的隐藏载荷。它不具备任何自我复制、删除系统文件或向第三方服务器回传受害者数据的恶意功能。代码中唯一敏感的操作是打印获取到的Cookie，这属于渗透测试脚本的标准行为，用于证明漏洞的可利用性。此外，该脚本没有包含任何 eval() 或 exec() 等危险函数，也没有尝试从远程服务器下载并执行未知的二进制文件。对于安全研究人员而言，这是一个典型的、纯粹的功能验证工具。尽管如此，在生产环境中运行此类脚本时，仍建议在受控的沙箱环境中进行，以确保其对目标系统的影响仅限于验证逻辑而不产生非预期的副作用。总的来说，该POC是安全的防御性研究工具。

**项目地址:** [https://github.com/wordfence/vulnerability-reports](https://www.google.com/search?q=https://github.com/wordfence/vulnerability-reports)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
