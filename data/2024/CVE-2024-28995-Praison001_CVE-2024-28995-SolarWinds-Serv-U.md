# CVE-2024-28995

> ğŸ“¦ è¯¥CVEæœ‰ **11** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2024-28995-0xc4t_CVE-2024-28995.md](../2024/CVE-2024-28995-0xc4t_CVE-2024-28995.md)

## CVE-2024-28995 - SolarWinds Serv-U ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSolarWinds Serv-Uä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä»¥åŠç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-28995 æ˜¯ä¸€ä¸ª SolarWinds Serv-U ä¸­çš„ç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´åˆ©ç”¨PoCæ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¡¨æ˜è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„PoCä»£ç ï¼Œè¯¥Pythonè„šæœ¬ä½¿ç”¨ `requests` åº“å‘é€ HTTP GET è¯·æ±‚ã€‚è„šæœ¬æ¥æ”¶ç›®æ ‡ URL å’Œæ–‡ä»¶åä½œä¸ºå‚æ•°ï¼Œå¹¶å°è¯•åˆ©ç”¨ç›®å½•éå†æ¼æ´è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨ä»£ç æˆ–æ¶æ„è¡Œä¸ºã€‚`README.md` æ–‡ä»¶æä¾›äº†ä½¿ç”¨è¯¥æ¼æ´çš„è¯´æ˜ï¼Œä¹Ÿæœªå‘ç°ä»»ä½•å¯ç–‘å†…å®¹ã€‚
å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚ `../`ï¼‰çš„æ¶æ„ URLã€‚
2.  æ”»å‡»è€…å°†è¯¥ URL å‘é€åˆ°å—å½±å“çš„ SolarWinds Serv-U æœåŠ¡å™¨ã€‚
3.  æœåŠ¡å™¨é”™è¯¯åœ°å¤„ç†è¯¥ URLï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
4.  æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶æˆ–æºä»£ç ã€‚

ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ URL è¯»å– `Serv-U-StartupLog.txt` æ–‡ä»¶ï¼š
`http://<target>/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`

PoCä»£ç çš„ `-t` å‚æ•°æŒ‡å®šç›®æ ‡åœ°å€ï¼Œ`-f` å‚æ•°æŒ‡å®šè¦è¯»å–çš„æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­çš„ç›¸å¯¹è·¯å¾„ã€‚ è„šæœ¬é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†çš„ URL æ¥åˆ©ç”¨æ¼æ´ï¼Œç„¶åæ‰“å°è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚



**é¡¹ç›®åœ°å€:** [0xc4t/CVE-2024-28995](https://github.com/0xc4t/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #2

**æ¥æº**: [CVE-2024-28995-Praison001_CVE-2024-28995-SolarWinds-Serv-U.md](../2024/CVE-2024-28995-Praison001_CVE-2024-28995-SolarWinds-Serv-U.md)

## CVE-2024-28995-SolarWinds-Serv-U ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** 15.4.2 HF 1 åŠä¹‹å‰ç‰ˆæœ¬

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSolarWinds Serv-Uï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®Serv-UæœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š

1.  **æœ‰æ•ˆæ€§ï¼š**
    *   æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªç›®å½•éå†æ¼æ´ï¼Œå…è®¸è¯»å–ä¸»æœºä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚
    *   æœç´¢ç»“æœä¸­å¤šä¸ªæ¥æºï¼ˆNVD, Rapid7, Tenable, Wizç­‰ï¼‰ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°ä¸ºé«˜å±æ¼æ´ï¼Œä¸”æœ‰åœ¨é‡åˆ©ç”¨ã€‚
    *   æä¾›çš„POCä»£ç  `exploit.py` å®ç°äº†å¯¹è¯¥æ¼æ´çš„åˆ©ç”¨ï¼Œé€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†çš„URLæ¥è¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚
    *   è¯¥POCä»£ç é¦–å…ˆé€šè¿‡æ¢æµ‹ç›®æ ‡æ˜¯Windowsç³»ç»Ÿè¿˜æ˜¯Linuxç³»ç»Ÿï¼Œåˆ†åˆ«å°è¯•è¯»å– `Serv-U-StartupLog.txt` æˆ–è€… `/etc/passwd` æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ç„¶åå…è®¸ç”¨æˆ·æŒ‡å®šè¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ã€‚
    *   æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

2.  **æŠ•æ¯’é£é™©ï¼š**
    *   åˆ†æ`exploit.py`ä»£ç ï¼Œè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚ï¼Œåˆ©ç”¨ç›®å½•éå†æ¼æ´è¯»å–æ–‡ä»¶å†…å®¹ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚ä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä¾èµ–äº`requests`åº“å‘é€è¯·æ±‚ã€‚
    *  README.mdæ–‡ä»¶ä¹Ÿåªæ˜¯æè¿°äº†æ¼æ´ä¿¡æ¯å’Œä½¿ç”¨æ–¹æ³•ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
    *   å› æ­¤ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©å¾ˆä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

3.  **åˆ©ç”¨æ–¹å¼ï¼š**
    *   æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†çš„URLï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„SolarWinds Serv-UæœåŠ¡å™¨ã€‚
    *   POCä»£ç é¦–å…ˆæ¢æµ‹ç›®æ ‡ç³»ç»Ÿç±»å‹ï¼ˆWindowsæˆ–Linuxï¼‰ï¼Œé€šè¿‡é¢„è®¾çš„æ–‡ä»¶è·¯å¾„åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚
    *   å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è¾“å…¥ä»»æ„æ–‡ä»¶è·¯å¾„ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯¥æ–‡ä»¶çš„å†…å®¹ï¼ˆå‰ææ˜¯Serv-Uè¿›ç¨‹æœ‰æƒé™è®¿é—®è¯¥æ–‡ä»¶ï¼‰ã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æ•æ„Ÿé…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ï¼Œç”šè‡³å¯èƒ½è·å–ç³»ç»Ÿç”¨æˆ·å‡­æ®ã€‚

4. **æ’åºä¼˜å…ˆçº§:** æœç´¢å¼•æ“ç»“æœ >  æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [Praison001/CVE-2024-28995-SolarWinds-Serv-U](https://github.com/Praison001/CVE-2024-28995-SolarWinds-Serv-U)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #3

**æ¥æº**: [CVE-2024-28995-Stuub_CVE-2024-28995.md](../2024/CVE-2024-28995-Stuub_CVE-2024-28995.md)

## CVE-2024-28995-SolarWinds Serv-U ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-28995 æ˜¯ SolarWinds Serv-U ä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Serv-U 15.4.2 HF 1 åŠä¹‹å‰çš„ç‰ˆæœ¬ã€‚CISAå·²å°†å…¶æ·»åŠ åˆ°å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´åˆ—è¡¨ä¸­ï¼Œè¡¨æ˜è¯¥æ¼æ´æ­£åœ¨è¢«ç§¯æåˆ©ç”¨ã€‚ 

æ¼æ´åˆ©ç”¨ä»£ç åˆ†æï¼š

1.  **æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ Python è„šæœ¬ `CVE-2024-28995.py` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ PoC (Proof of Concept) ä»£ç ï¼Œç”¨äºæµ‹è¯•å’Œåˆ©ç”¨è¯¥ç›®å½•éå†æ¼æ´ã€‚è¯¥è„šæœ¬é¦–å…ˆæ£€æŸ¥ç›®æ ‡ Serv-U æœåŠ¡å™¨çš„ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å°è¯•ä½¿ç”¨ç›®å½•éå†æŠ€æœ¯è¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚è„šæœ¬åŒ…å«ç‰ˆæœ¬æ£€æµ‹ã€è·¯å¾„éå†æµ‹è¯•ç­‰åŠŸèƒ½ï¼ŒéªŒè¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **æŠ•æ¯’é£é™©ï¼š** ç»è¿‡åˆ†æï¼Œè¯¥è„šæœ¬æœ¬èº«ä¸åŒ…å«æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚è¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®å½•éå†æ¼æ´ï¼Œå¹¶æœªå‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—åé—¨çš„è¿¹è±¡ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
    *   æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚åˆ° Serv-U æœåŠ¡å™¨ã€‚
    *   è¯·æ±‚çš„ URL åŒ…å«ç›®å½•éå†çš„ payloadï¼Œä¾‹å¦‚ `/?InternalDir=/../../../../../../../../../../../../../../`ï¼Œç”¨äºè®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
    *   æœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶ï¼Œæ²¡æœ‰æ­£ç¡®éªŒè¯è¯·æ±‚çš„è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `web.config` ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚

æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§å¾ˆé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä»è€Œå¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [Stuub/CVE-2024-28995](https://github.com/Stuub/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #4

**æ¥æº**: [CVE-2024-28995-bigb0x_CVE-2024-28995.md](../2024/CVE-2024-28995-bigb0x_CVE-2024-28995.md)

## CVE-2024-28995 - SolarWinds Serv-U Directory Traversal

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®Serv-UæœåŠ¡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-28995æ˜¯SolarWinds Serv-Uä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç›®æ ‡æœåŠ¡å™¨ç£ç›˜ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶å’Œæ•æ„Ÿé…ç½®æ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSSè¯„åˆ†ä¸º8.6ï¼Œå±äºé«˜å±æ¼æ´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«å…¬å¼€æŠ«éœ²å¹¶è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„PoCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ä¸»æœºæ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†çš„URLï¼Œå°è¯•è¯»å–Serv-Uçš„å¯åŠ¨æ—¥å¿—æ–‡ä»¶ï¼ˆServ-U-StartupLog.txtï¼‰æˆ–/etc/passwdæ–‡ä»¶ã€‚å¦‚æœæˆåŠŸè¯»å–ï¼Œåˆ™è¡¨æ˜ç›®æ ‡ä¸»æœºå­˜åœ¨æ¼æ´ã€‚PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å†…å®¹ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„HTTP GETè¯·æ±‚ï¼Œåœ¨URLä¸­åŒ…å«ç›®å½•éå†å­—ç¬¦ï¼Œä»è€Œç»•è¿‡Serv-Uçš„æ–‡ä»¶è®¿é—®é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [bigb0x/CVE-2024-28995](https://github.com/bigb0x/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #5

**æ¥æº**: [CVE-2024-28995-demoAlitalia_CVE-2024-28995.md](../2024/CVE-2024-28995-demoAlitalia_CVE-2024-28995.md)

## CVE-2024-28995-SolarWinds Serv-U-ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡æœåŠ¡å™¨è¿è¡Œå­˜åœ¨æ¼æ´çš„SolarWinds Serv-Uç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2024-28995 æ˜¯ SolarWinds Serv-U ä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç›®æ ‡æœåŠ¡å™¨ç£ç›˜ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®Rapid7çš„åšå®¢æ–‡ç« ï¼Œè¯¥æ¼æ´åˆ©ç”¨èµ·æ¥éå¸¸ç®€å•ã€‚ç»™å®šçš„POCä»£ç ï¼ˆCVE-2024-28995.goï¼‰é€šè¿‡å‘é€åŒ…å«ç›®å½•éå†payloadçš„HTTPè¯·æ±‚ï¼Œå°è¯•è¯»å–WindowsæœåŠ¡å™¨ä¸Šçš„`Serv-U-StartupLog.txt`æ–‡ä»¶æˆ–LinuxæœåŠ¡å™¨ä¸Šçš„`/etc/passwd`æ–‡ä»¶ï¼Œä»è€ŒéªŒè¯ç›®æ ‡æ˜¯å¦æ˜“å—æ”»å‡»ã€‚PoCä»£ç é¦–å…ˆä» `ips.txt` æ–‡ä»¶ä¸­è¯»å–ç›®æ ‡IPåœ°å€åˆ—è¡¨ï¼Œç„¶åå¹¶å‘åœ°å‘æ¯ä¸ªIPåœ°å€å‘é€æ¶æ„è¯·æ±‚ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼Œ'Operating System: Windows Server' æˆ– 'root:x'ï¼‰çš„å“åº”ï¼Œåˆ™è®¤ä¸ºè¯¥æœåŠ¡å™¨æ˜“å—æ”»å‡»ã€‚é£é™©è¯„ä¼°ï¼š

*   **æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥POCä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** è¯¥POCä»£ç ä¸»è¦åŠŸèƒ½æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æ½œåœ¨é£é™©ã€‚å¦‚ç¨‹åºå¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½è¢«ä¿®æ”¹ä¸ºä¸Šä¼ æ¶æ„è„šæœ¬æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„HTTPè¯·æ±‚ï¼Œåœ¨URLä¸­åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆå¦‚`/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`ï¼‰ï¼Œä»è€Œè®¿é—®å—é™åˆ¶çš„ç›®å½•å’Œæ–‡ä»¶ã€‚ç”±äºè¯¥æ¼æ´ä¸éœ€è¦èº«ä»½éªŒè¯ï¼Œå› æ­¤ä»»ä½•èƒ½å¤Ÿè®¿é—®Serv-UæœåŠ¡å™¨çš„æ”»å‡»è€…éƒ½å¯ä»¥åˆ©ç”¨å®ƒã€‚

**é¡¹ç›®åœ°å€:** [demoAlitalia/CVE-2024-28995](https://github.com/demoAlitalia/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #6

**æ¥æº**: [CVE-2024-28995-ggfzx_CVE-2024-28995.md](../2024/CVE-2024-28995-ggfzx_CVE-2024-28995.md)

## CVE-2024-28995 - SolarWinds Serv-U ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†/è·¯å¾„ç©¿è¶Š

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-28995 æ˜¯ SolarWinds Serv-U ä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è¯»å–ä¸»æœºä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Serv-U 15.4.2 HF 1 åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¹¶å·²è¢« CISA åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨çš„æ¼æ´æ¸…å• (KEV)ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯å¯åˆ©ç”¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€çš„åˆ©ç”¨ä»£ç ã€‚Rapid7 åšå®¢æåˆ°è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ç®€å•åˆ©ç”¨çš„ä¿¡æ¯æ³„éœ²æ¼æ´ã€‚GreyNoise çš„æ•°æ®è¡¨æ˜è¯¥æ¼æ´å·²ç»è¢«ç§¯æå°è¯•åˆ©ç”¨ã€‚å› æ­¤æä¾›çš„POCä»£ç å¤§æ¦‚ç‡æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­çš„ `README.md` æ–‡ä»¶æè¿°äº†ä¸€ä¸ªç”¨äºè¯»å–ä»»æ„æ–‡ä»¶çš„å·¥å…·ã€‚ä» `README.md` çš„å†…å®¹æ¥çœ‹ï¼Œä»£ç åŠŸèƒ½ç›¸å¯¹æ˜ç¡®ï¼Œä¸»è¦æä¾›äº†æŒ‡å®š URLã€æ‰¹é‡ URL æ–‡ä»¶ã€è¾“å‡ºæ–‡ä»¶ã€ä»£ç†è®¾ç½®å’Œçº¿ç¨‹æ•°ç­‰é€‰é¡¹ï¼Œç”¨äºæ‰«æç›®æ ‡å¹¶è¯»å–æ–‡ä»¶ã€‚**ä½†è¦æ³¨æ„çš„æ˜¯,æ²¡æœ‰æä¾›å®Œæ•´çš„PoCä»£ç ,ä»…ä»…æ˜¯usageè¯´æ˜,æ— æ³•åˆ¤å®šæ˜¯å¦å­˜åœ¨åé—¨ä»£ç **, ä» `README.md` çš„å†…å®¹çœ‹ï¼Œå­˜åœ¨æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºç”¨æˆ·å¯ä»¥ç›¸å¯¹å®¹æ˜“åœ°æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¶æ„ä»£ç ã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰å®é™…ä»£ç ï¼Œå› æ­¤æ— æ³• 100% æ’é™¤æŠ•æ¯’çš„å¯èƒ½ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½åœ¨ç”¨æˆ·ä¸æ³¨æ„çš„åœ°æ–¹æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ–‡ä»¶è¯»å–å’Œè¾“å‡ºçš„è¿‡ç¨‹ä¸­ï¼Œå› æ­¤è¯„ä¼°å­˜åœ¨ 10% çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ç›®å½•éå†æ¼æ´æ„é€ æ¶æ„çš„ URL è¯·æ±‚ï¼Œä¾‹å¦‚ä½¿ç”¨ `../` åºåˆ—æ¥è®¿é—®å—é™åˆ¶ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
2.  Serv-U æœåŠ¡å™¨åœ¨å¤„ç†åŒ…å«ç›®å½•éå†åºåˆ—çš„è¯·æ±‚æ—¶ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯è·¯å¾„ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–é…ç½®æ–‡ä»¶ã€å¯†ç æ–‡ä»¶æˆ–ä»»ä½•å…¶ä»–æ•æ„Ÿæ•°æ®ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚ææƒæˆ–æ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [ggfzx/CVE-2024-28995](https://github.com/ggfzx/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #7

**æ¥æº**: [CVE-2024-28995-gotr00t0day_CVE-2024-28995.md](../2024/CVE-2024-28995-gotr00t0day_CVE-2024-28995.md)

## CVE-2024-28995 - SolarWinds Serv-U ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è¯»å–ä¸»æœºä¸Šçš„æ•æ„Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡ŒSolarWinds Serv-Uï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå­˜åœ¨äºSolarWinds Serv-Uä¸­çš„ç›®å½•éå†æ¼æ´(CVE-2024-28995)ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„Python POCä»£ç  `CVE-2024-28995.py` çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚ä»£ç å°è¯•é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLæ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚ å®ƒå°è¯•è¯»å–å¤šä¸ªå¸¸è§æ–‡ä»¶ï¼Œä¾‹å¦‚`Serv-U-StartupLog.txt`ï¼Œ`/etc/passwd`å’Œ`win.ini`ã€‚POCä»£ç è¿˜æ£€æŸ¥å“åº”å†…å®¹ï¼Œä»¥ç¡®è®¤æ˜¯å¦æˆåŠŸè¯»å–äº†ç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨"root:"ã€"bin:x:" ç­‰å­—ç¬¦ä¸²ä»¥ç¡®è®¤æ˜¯å¦è¯»å–åˆ°`/etc/passwd`æ–‡ä»¶ï¼‰ã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†ææä¾›çš„Pythonè„šæœ¬ï¼Œ`requirements.txt`å’Œ`README.md`æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚è¯¥è„šæœ¬çš„ç›®çš„æ˜¯åˆ©ç”¨ç›®å½•éå†æ¼æ´ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç æˆ–åé—¨ã€‚`requirements.txt` åªåˆ—å‡ºäº† `requests`, `colorama` å’Œ `urllib3` è¿™äº›å¸¸ç”¨çš„pythonåº“ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡ŒSolarWinds Serv-Uä¸”ç‰ˆæœ¬<=15.4.2 HF 1çš„ç›®æ ‡æœåŠ¡å™¨ã€‚
2.  **æ„é€ æ¶æ„URLï¼š** æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š`/?InternalDir=/./../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`
3.  **å‘é€è¯·æ±‚ï¼š** ä½¿ç”¨HTTP GETè¯·æ±‚å°†æ¶æ„URLå‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **åˆ†æå“åº”ï¼š** å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡ä»¶å†…å®¹ã€‚æ£€æŸ¥è¿”å›çš„å†…å®¹ä»¥ç¡®è®¤æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚

POCä»£ç ä¸­ä½¿ç”¨äº†å¤šä¸ªè·¯å¾„ï¼Œå°è¯•è¯»å–ä¸åŒçš„æ–‡ä»¶ï¼Œæé«˜äº†åˆ©ç”¨æˆåŠŸç‡ã€‚

è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¯èƒ½ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç ã€é…ç½®æ–‡ä»¶ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2024-28995](https://github.com/gotr00t0day/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #8

**æ¥æº**: [CVE-2024-28995-huseyinstif_CVE-2024-28995-Nuclei-Template.md](../2024/CVE-2024-28995-huseyinstif_CVE-2024-28995-Nuclei-Template.md)

## CVE-2024-28995-SolarWinds Serv-U-ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF 1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2024-28995æ˜¯SolarWinds Serv-Uä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç›®æ ‡æœåŠ¡å™¨ç£ç›˜ä¸Šçš„ä»»ä½•æ–‡ä»¶ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯ã€‚æ ¹æ®æä¾›çš„Nucleiæ¨¡æ¿ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆå¦‚`..\`ï¼‰çš„ç‰¹åˆ¶URLæ¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œä¾‹å¦‚ï¼š`{{BaseURL}}/?InternalDir=\..\..\..\..\etc^&InternalFile=passwd`ã€‚è¯¥è¯·æ±‚å°è¯•è¯»å–`/etc/passwd`æ–‡ä»¶ã€‚å¦‚æœå“åº”çŠ¶æ€ç ä¸º200ï¼Œå¹¶ä¸”å“åº”ä½“åŒ…å«`root:x:`ã€`daemon:x:`å’Œ`bin:x:`ç­‰å­—ç¬¦ä¸²ï¼Œä¸”å“åº”å¤´åŒ…å«`Server: Serv-U`ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²ç»ç¡®è®¤å­˜åœ¨ä¸”è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„POCä»£ç ï¼ˆNucleiæ¨¡æ¿ï¼‰æ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥ç”¨æ¥æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„Nucleiæ¨¡æ¿å’ŒREADME.mdæ–‡ä»¶ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„ä»£ç æˆ–åé—¨ã€‚è¯¥æ¨¡æ¿ä»…ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„URLï¼Œä¾‹å¦‚ï¼š
    `http://target/?InternalDir=\..\..\..\..\etc^&InternalFile=passwd`
2.  Serv-UæœåŠ¡å™¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå­˜åœ¨ç›®å½•éå†æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
3.  æ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ç­‰ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2024-28995-Nuclei-Template](https://github.com/huseyinstif/CVE-2024-28995-Nuclei-Template)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #9

**æ¥æº**: [CVE-2024-28995-ibrahimsql_CVE-2024-28995.md](../2024/CVE-2024-28995-ibrahimsql_CVE-2024-28995.md)

## CVE-2024-28995 - SolarWinds Serv-U ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF1

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSolarWinds Serv-Uï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œéœ€è¦ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-28995æ˜¯ä¸€ä¸ªSolarWinds Serv-Uä¸­çš„ç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„POCä»£ç ï¼ˆ`cve_2024_28995.py`ï¼‰æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ„é€ ç‰¹å®šçš„URLæ¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œè®¿é—®Serv-Uçš„æ—¥å¿—æ–‡ä»¶å’Œå…¶ä»–ç³»ç»Ÿæ–‡ä»¶ã€‚è¯¥æ¼æ´åˆ©ç”¨çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨ç›®å½•éå†çš„æ–¹å¼ï¼Œé€šè¿‡`../`è¿™æ ·çš„è·¯å¾„è·³è½¬ç¬¦ï¼Œè·³å‡ºServ-Uçš„é™åˆ¶ç›®å½•ï¼Œä»è€Œè®¿é—®ç³»ç»Ÿä¸­çš„å…¶ä»–æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ä¸”å­˜åœ¨å¯ç”¨çš„PoCï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç çš„åˆ©ç”¨æ–¹å¼ç¬¦åˆè¯¥æ¼æ´æè¿°ï¼Œå› æ­¤æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

å¯¹æä¾›çš„PoCä»£ç è¿›è¡Œäº†åˆ†æï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€HTTPè¯·æ±‚å¹¶è¯»å–å“åº”ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ–‡ä»¶`LICENSE` ä½¿ç”¨çš„æ˜¯å…¬å…±é¢†åŸŸè®¸å¯ï¼Œè¿›ä¸€æ­¥é™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œå­˜åœ¨æä½çš„æ¦‚ç‡(1%)ä½œè€…åœ¨æœªæ¥ç‰ˆæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œå½“å‰ç‰ˆæœ¬æœªå‘ç°ã€‚

**é¡¹ç›®åœ°å€:** [ibrahimsql/CVE-2024-28995](https://github.com/ibrahimsql/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #10

**æ¥æº**: [CVE-2024-28995-ibrahmsql_CVE-2024-28995.md](../2024/CVE-2024-28995-ibrahmsql_CVE-2024-28995.md)

## CVE-2024-28995-SolarWinds Serv-U-ç›®å½•éå†

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <= 15.4.2 HF1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2024-28995 æ˜¯ SolarWinds Serv-U ä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ä¸»æœºä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´ä¿¡æ¯æè¿°äº†ç›®å½•éå†æ¼æ´ï¼Œå¤šä¸ªæœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜“äºåˆ©ç”¨ï¼Œå¹¶ä¸”åœ¨é‡å¤–å·²è¢«åˆ©ç”¨ã€‚æä¾›çš„ Python è„šæœ¬ä¼¼ä¹æ˜¯ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„åˆ©ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹å’Œæ“ä½œç³»ç»Ÿè¯†åˆ«ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œæ¯”å¦‚åå¼¹shellï¼Œæ¤å…¥åé—¨ç­‰ï¼Œä¸»è¦ä¸ºç›®å½•éå†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ¼æ´åŸç†ï¼š** æ¼æ´åˆ©ç”¨äº† SolarWinds Serv-U ä¸­å­˜åœ¨çš„ç›®å½•éå†ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« "../" ç­‰ç‰¹æ®Šå­—ç¬¦çš„ URLï¼Œç»•è¿‡è®¿é—®é™åˆ¶ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š**
    *   å‘é€ç‰¹åˆ¶çš„ HTTP GET è¯·æ±‚åˆ° SolarWinds Serv-U æœåŠ¡å™¨ã€‚
    *   åœ¨ URL ä¸­åŒ…å«ç›®å½•éå†payloadï¼ŒæŒ‡å‘æƒ³è¦è¯»å–çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œ`/../../../../windows/win.ini` æˆ– `/../../../../etc/passwd`ï¼‰ã€‚
    *   æœåŠ¡å™¨å¦‚æœå­˜åœ¨æ¼æ´ï¼Œå°†è¿”å›ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚
3.  **åˆ©ç”¨ä»£ç åˆ†æï¼š**
    *   `normalize_url(url)`: è§„èŒƒåŒ– URLï¼Œç¡®ä¿åŒ…å«åè®® (http/https)ã€‚
    *   `extract_server_version(headers)`: ä» HTTP å“åº”å¤´ä¸­æå– Serv-U çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚
    *   `is_vulnerable_version(version)`: æ£€æŸ¥æ£€æµ‹åˆ°çš„ç‰ˆæœ¬æ˜¯å¦æ˜“å—æ”»å‡»ï¼ˆ<= 15.4.2 HF1ï¼‰ã€‚
    *   `detect_os_type(content)`: æ ¹æ®æ–‡ä»¶å†…å®¹åˆ¤æ–­æ“ä½œç³»ç»Ÿç±»å‹ã€‚
    *   `get_default_payloads()`: ç”¨äºç”Ÿæˆç›®å½•éå†payloadã€‚

æ€»çš„æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ URL å³å¯è¯»å–æ–‡ä»¶ã€‚POC ä»£ç çš„è´¨é‡ç›¸å¯¹è¾ƒé«˜ï¼Œè€ƒè™‘äº†å¤šä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ã€æ“ä½œç³»ç»Ÿè¯†åˆ«å’Œå¤šç§payloadã€‚


**é¡¹ç›®åœ°å€:** [ibrahmsql/CVE-2024-28995](https://github.com/ibrahmsql/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

## POC #11

**æ¥æº**: [CVE-2024-28995-muhammetali20_CVE-2024-28995.md](../2024/CVE-2024-28995-muhammetali20_CVE-2024-28995.md)

## CVE-2024-28995 SolarWinds Serv-U ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2024-28995

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** SolarWinds Serv-U

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿæ–‡ä»¶æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 15.4.2 HF 1 åŠä¹‹å‰ç‰ˆæœ¬

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„SolarWinds Serv-U

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2024-28995 æ˜¯ SolarWinds Serv-U ä¸­çš„ä¸€ä¸ªç›®å½•éå†æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è¯»å–ç›®æ ‡æœåŠ¡å™¨ç£ç›˜ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `CVE-2024-28995.yaml` æ–‡ä»¶åŒ…å« nuclei æ¨¡æ¿ï¼Œè¯¥æ¨¡æ¿é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URL æ¥å°è¯•è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ `Serv-U-StartupLog.txt`ã€`win.ini` å’Œ `/etc/passwd`ã€‚`serv-u-version-detect.yaml` æ¨¡æ¿ç”¨äºæ£€æµ‹ Serv-U çš„ç‰ˆæœ¬ï¼Œä½†å…¶æœ¬èº«æ²¡æœ‰åˆ©ç”¨æ¼æ´ã€‚åœ¨ `README.md` ä¸­ï¼Œä½œè€…æä¾›äº†ä½¿ç”¨ nuclei æ‰§è¡Œæ¼æ´åˆ©ç”¨çš„å‘½ä»¤ï¼Œå¹¶å±•ç¤ºäº†æ¼æ´åˆ©ç”¨æˆåŠŸçš„æˆªå›¾ã€‚å­˜åœ¨æŠ•æ¯’é£é™©çš„åˆ†æï¼šè¯¥æ¼æ´åˆ©ç”¨ä»“åº“ä¸­ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨çš„ YAML é…ç½®æ–‡ä»¶å’Œä¸€ä¸ªç®€çŸ­çš„ READMEï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`serv-u-version-detect.yaml` æ–‡ä»¶åªæ˜¯ç”¨äºç‰ˆæœ¬æ£€æµ‹ï¼Œæœ¬èº«ä¸å…·å¤‡æ”»å‡»æ€§ã€‚`CVE-2024-28995.yaml` æ–‡ä»¶æ˜¯æ¼æ´åˆ©ç”¨çš„æ ¸å¿ƒï¼Œå…¶ä¸­åŒ…å«äº†æ”»å‡»è½½è·ã€‚ç”±äºä½œè€…æä¾›äº†æ˜ç¡®çš„æ¼æ´åˆ©ç”¨æ–¹æ³•å’Œç›®æ ‡æ–‡ä»¶ï¼Œå› æ­¤åˆ¤æ–­ä¸ºæŠ•æ¯’çš„æ¦‚ç‡è¾ƒä½ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å«çš„ä¿¡æ¯æœ‰é™ï¼Œä½œè€…å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹ï¼ˆä¾‹å¦‚ï¼Œæ„å»ºè„šæœ¬æˆ–ä¾èµ–é¡¹ï¼‰éšè—äº†æ¶æ„ä»£ç ï¼Œä½†å¯èƒ½æ€§ç›¸å¯¹è¾ƒä½ã€‚æ€»çš„æ¥è¯´ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¸º 10%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„ URLï¼ˆä¾‹å¦‚ `/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`ï¼‰æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ nuclei ç­‰å·¥å…·è‡ªåŠ¨æ‰§è¡Œæ¼æ´åˆ©ç”¨è¿‡ç¨‹ã€‚

**é¡¹ç›®åœ°å€:** [muhammetali20/CVE-2024-28995](https://github.com/muhammetali20/CVE-2024-28995)

**æ¼æ´è¯¦æƒ…:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)

---

