# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md](../2024/CVE-2024-38856-Praison001_CVE-2024-38856-ApacheOfBiz.md)

# CVE-2024-38856

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md](../2024/CVE-2024-38856-0x20c_CVE-2024-38856-EXP.md)

## CVE-2024-38856-Apache OFBiz-RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标系统运行Apache OFBiz，且存在/webtools/control/main/ProgramExport端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞，允许未经身份验证的端点执行屏幕渲染代码。攻击者通过向/webtools/control/main/ProgramExport端点发送精心构造的POST请求，其中包含恶意的groovyProgram参数，该参数经过URL编码，包含需要执行的命令的base64编码，从而实现远程代码执行。

**有效性：**
提供的POC代码，包含一个bash脚本和一个nuclei的yaml文件，可以通过发送包含恶意Groovy脚本的POST请求来利用此漏洞。脚本首先将要执行的命令进行Base64编码，然后将其嵌入到Groovy表达式中，并将表达式转换为\u00转义的Unicode序列，最后，构造包含groovyProgram参数的POST请求发送到目标端点。

**投毒风险：**
虽然整个仓库看起来专注于利用CVE-2024-38856，但仍存在小部分投毒风险，如脚本中可能存在的后门代码。虽然脚本的主要功能是执行命令，但需要仔细检查是否存在其他恶意行为，比如反弹shell或下载执行恶意文件。检查发现，脚本中并没有发现直接的投毒代码。风险主要在于，如果攻击者获取了脚本的所有权，可以随时植入恶意代码，所以判定投毒风险为5%。

**利用方式：**
1.  攻击者需要一个目标Apache OFBiz实例，版本小于等于18.12.14。
2.  攻击者构造一个包含恶意Groovy脚本的POST请求，该脚本利用`execute()`函数执行任意命令。为了绕过某些过滤，命令会被Base64编码。
3.  攻击者将构造的POST请求发送到`/webtools/control/main/ProgramExport`端点。
4.  如果目标系统存在漏洞，Groovy脚本将被执行，攻击者指定的命令也会被执行。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [0x20c/CVE-2024-38856-EXP](https://github.com/0x20c/CVE-2024-38856-EXP)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #2

**来源**: [CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md](../2024/CVE-2024-38856-AlissonFaoli_Apache-OFBiz-Exploit.md)

## CVE-2024-38856-Apache OFBiz-未授权RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放webtools端口，且目标OFBiz版本小于等于18.12.14。Screen definitions 未进行权限检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造特定的 HTTP POST 请求，利用 `ProgramExport` 端点执行任意代码。漏洞原因是由于未授权的端点能够执行屏幕渲染代码，而某些屏幕定义没有显式地检查用户权限，从而导致攻击者可以执行任意的Groovy代码。 

**利用方式：**

1.  攻击者发送一个POST请求到`/webtools/control/main/ProgramExport`端点。
2.  POST请求中包含一个名为`groovyProgram`的参数，该参数的值是经过Unicode编码的恶意Groovy代码。
3.  服务器执行该Groovy代码，从而导致远程代码执行。

**POC代码分析：**

提供的Python脚本利用了该漏洞，通过以下步骤实现远程代码执行：

1.  `generate_payload(cmd: str)`:  这个函数将要执行的命令作为参数，生成一个包含该命令的Groovy payload。该payload使用`ProcessBuilder`来执行命令，并将结果返回。
2.  `exploit(target:str, payload:str)`:  这个函数将目标URL和payload作为参数，发送一个POST请求到`/webtools/control/main/ProgramExport`端点，并将payload作为`groovyProgram`参数的值。
3.  `shell(target:str, lhost:str, lport:str)`:  这个函数用于生成反向shell的payload，并利用`exploit`函数执行该payload，从而在目标服务器上建立一个反向shell连接。

**投毒风险评估：**

代码中没有明显的恶意代码植入后门，但是经过Unicode编码，可以隐藏一些简单后门。

*   脚本会禁用SSL证书验证(`requests.urllib3.disable_warnings()`)，这在真实环境中是不安全的，可能导致中间人攻击。但这更可能是为了方便漏洞利用，而不是有意投毒。
*   代码结构比较简单，没有发现作者故意隐藏的恶意行为。
*   payload使用Unicode编码，方便绕过一些简单的过滤，但也增加了代码阅读的难度，可能隐藏了一些不明显的问题。

所以, 投毒风险不能完全排除，但也相对较低，约为5%。主要风险点在于Unicode编码可能隐藏一些简单的后门代码。

**项目地址:** [AlissonFaoli/Apache-OFBiz-Exploit](https://github.com/AlissonFaoli/Apache-OFBiz-Exploit)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #3

**来源**: [CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md](../2024/CVE-2024-38856-BBD-YZZ_CVE-2024-38856-RCE.md)

## CVE-2024-38856-Apache OFBiz-不正确的授权

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 不正确的授权

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标OFBiz实例，且目标实例存在未正确配置权限的Screen定义

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些先决条件（例如，当屏幕定义没有明确检查用户的权限，而是依赖于端点的配置）。

**有效性评估：**
根据漏洞信息，该漏洞允许未经身份验证的用户访问受保护的资源，如果目标OFBiz实例的屏幕定义没有正确配置权限。
根据提供的github图片显示，验证POC的方式是修改用户密码。

**投毒风险评估：**
提供的POC代码包含一个简单的Go程序，仅输出 "Hello, world!"，没有发现任何恶意行为或后门代码。此外，该仓库图片显示利用过程，未见存在投毒后门代码。
因此，投毒风险评估为0%。

**利用方式：**
1.  确定存在漏洞的Apache OFBiz实例，且版本低于或等于18.12.14。
2.  查找未正确配置权限的屏幕定义。
3.  利用未授权的端点，执行屏幕渲染代码，从而访问或修改受保护的资源。
   例如，根据github图片显示，可以直接通过未授权访问`/system/userManager/changePassword`修改用户密码。

**项目地址:** [BBD-YZZ/CVE-2024-38856-RCE](https://github.com/BBD-YZZ/CVE-2024-38856-RCE)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #4

**来源**: [CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md](../2024/CVE-2024-38856-FakesiteSecurity_CVE-2024-38856_Scen.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #5

**来源**: [CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md](../2024/CVE-2024-38856-Hex00-0x4_CVE-2024-38856-Apache-OFBiz.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要目标系统开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个未授权访问漏洞。未经身份验证的端点可以执行屏幕渲染代码，如果满足某些前提条件，例如屏幕定义没有明确检查用户权限。提供的Python脚本"Apache_bang.py"包含用于利用此漏洞的有效载荷。

**有效性：**

提供的漏洞利用代码似乎是有效的。它利用了`/webtools/control/main/ProgramExport`端点，该端点容易受到Groovy代码注入的影响。该脚本首先对命令进行Base64编码，然后将其转换为Unicode有效负载，并将其作为`groovyProgram`参数发送到目标。脚本能够执行系统命令，证明了漏洞的存在。

**投毒风险：**

代码包含一个`get_logo()`函数，其中包含有关作者的信息，这本身并不恶意。此外，代码包含用于验证目标的命令，然后通过解码执行进行命令执行，逻辑完整，因此没有明显的投毒迹象。 脚本中的风险主要在于其利用漏洞的能力，而不是隐藏的恶意代码。 整体投毒风险较低，估计为10%。

**利用方式：**

1.  **目标识别：** 确定运行易受攻击的Apache OFBiz版本的系统，版本必须等于或低于18.12.14。
2.  **构造有效负载：** 使用`commandEncoder`函数将要执行的命令进行Base64编码。然后，使用`payloadUnicode`函数将编码的命令转换为Unicode转义序列。例如，要执行`id`命令，该脚本首先会对其进行base64编码并添加标记，然后将编码后的结果转换为unicode格式的payload。
3.  **发送请求：** 通过HTTP POST请求将构造的有效负载发送到`/webtools/control/main/ProgramExport`端点。`groovyProgram`参数包含Unicode有效负载。
4.  **命令执行：** OFBiz服务器执行Groovy代码，执行解码后的命令。
5.  **输出提取：** 该脚本使用`extract_output`函数从服务器的响应中提取命令的输出。它查找`[result]`标记来标识输出的开始和结束。
6.  **漏洞扫描（可选）：**脚本包含`scan_vulnerability`函数，用于初步验证目标是否容易受到攻击，通过ping、wget、curl指令确认。

总而言之，提供的代码似乎是利用CVE-2024-38856漏洞的可靠PoC，允许未经身份验证的攻击者在易受攻击的Apache OFBiz实例上执行任意命令。

**项目地址:** [Hex00-0x4/CVE-2024-38856-Apache-OFBiz](https://github.com/Hex00-0x4/CVE-2024-38856-Apache-OFBiz)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #6

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #7

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---



---

## POC #7

**来源**: [CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md](../2024/CVE-2024-38856-ThatNotEasy_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #8

**来源**: [CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md](../2024/CVE-2024-38856-XiaomingX_cve-2024-38856-poc.md)

## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #9

**来源**: [CVE-2024-38856-emanueldosreis_CVE-2024-38856.md](../2024/CVE-2024-38856-emanueldosreis_CVE-2024-38856.md)

## CVE-2024-38856-Apache OFBiz-未授权访问导致代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问目标Apache OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息和POC代码，该漏洞是Apache OFBiz 18.12.14及更早版本中存在的未授权访问漏洞。未经身份验证的攻击者可以通过访问`/webtools/control/forgotPassword/ProgramExport`端点，并传递包含恶意代码的`groovyProgram`参数，来执行任意代码。POC代码通过发送GET请求到该端点，并在`groovyProgram`参数中嵌入执行`id`命令的Groovy代码来验证漏洞。如果响应体中包含"uid=0"，则表示漏洞存在，攻击成功。由于提供的POC代码只是执行`id`命令来验证漏洞，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。利用方式是通过发送特制的HTTP GET请求到存在漏洞的端点，并在`groovyProgram`参数中注入恶意代码以执行任意命令。

**项目地址:** [emanueldosreis/CVE-2024-38856](https://github.com/emanueldosreis/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

## POC #10

**来源**: [CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md](../2024/CVE-2024-38856-securelayer7_CVE-2024-38856_Scanner.md)

## CVE-2024-38856-Apache OFBiz-未授权访问

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放Apache OFBiz服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856 是 Apache OFBiz 中的一个未授权访问漏洞。未经身份验证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，屏幕定义没有显式检查用户权限，因为它们依赖于端点的配置）。

**利用方式：**
攻击者可以通过发送特制的 HTTP 请求到未授权访问的端点，执行恶意屏幕渲染代码，最终实现远程代码执行。POC代码提供了一个扫描器和一个漏洞利用工具，支持指定目标、端口、执行的命令等。

**有效性：**
根据提供的漏洞库信息，该漏洞的利用已经被公开，CISA 将其添加到已知被利用的漏洞目录中，表明该漏洞利用的有效性较高。POC代码的出现进一步证实了这一点。

**投毒风险：**
该POC代码由Securelayer7提供，在github上存在同名项目，作者有一定信誉。但是依旧存在投毒风险。代码中没有明显发现恶意代码，风险主要来自命令执行的安全性。如果攻击者滥用该工具，可能会执行恶意命令导致系统受损。此外扫描器中支持`-d`参数，这本身就存在一定的被滥用风险。
投毒风险评估：10%。

**总结：**
该漏洞风险较高，利用方式相对简单，存在公开的POC代码。建议及时升级到版本 18.12.15 或更高版本。

**项目地址:** [securelayer7/CVE-2024-38856_Scanner](https://github.com/securelayer7/CVE-2024-38856_Scanner)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)

---

