# CVE-2024-23334

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md)

# CVE-2024-23334

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md)

# CVE-2024-23334

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md)

# CVE-2024-23334

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md)

# CVE-2024-23334

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md)

# CVE-2024-23334

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Betan423_CVE-2024-23334-PoC.md)

# CVE-2024-23334

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-Arc4he_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #2

**来源**: [CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-BestDevOfc_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #3

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #4

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---



---

## POC #4

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #13

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---



---

## POC #4

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #13

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---



---

## POC #4

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #13

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---



---

## POC #4

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #13

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---



---

## POC #4

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #13

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---



---

## POC #4

**来源**: [CVE-2024-23334-Pylonet_CVE-2024-23334.md](../2024/CVE-2024-23334-Pylonet_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #5

**来源**: [CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-TheRedP4nther_LFI-aiohttp-CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #6

**来源**: [CVE-2024-23334-binaryninja_CVE-2024-23334.md](../2024/CVE-2024-23334-binaryninja_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #7

**来源**: [CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md](../2024/CVE-2024-23334-brian-edgar-re_poc-cve-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启了`follow_symlinks=True`的静态文件服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`设置`follow_symlinks=True`时，如果对输入路径没有进行充分校验，可能允许攻击者通过构造包含`../`的恶意URL来访问静态资源目录以外的文件。 

**有效性：**

提供的POC代码是有效的。它通过Dockerfile设置了一个存在漏洞的环境：

1.  创建了一个静态资源目录 `/workspace/static`。
2.  创建了一个指向 `/etc/shadow` 的符号链接 `/workspace/static/image.png`。
3.  `app/main.py`中使用`aiohttp.web.static` 并设置 `follow_symlinks=True`。

攻击者可以通过访问类似 `http://target:8080/static/image.png` 或 `http://target:8080/static/../../../../etc/shadow`的URL来读取 `/etc/shadow` 文件（如果直接利用目录遍历，需要绕过URL的normalize）。POC自带的 `exploit_path_traversal.py`脚本通过发送原始HTTP请求绕过了URL规范化。

**投毒风险：**

代码库中可能存在轻微的投毒风险，概率约为10%。 风险点在于以下几点：

1.  **`/etc/shadow`的符号链接：**  POC创建了一个指向`/etc/shadow`的符号链接。虽然这是为了演示漏洞，但在实际环境中，恶意用户可能会创建指向其他敏感文件的符号链接，以扩大攻击范围。
2.  **`exploit_path_traversal.py`：** 该脚本绕过了URL规范化，这在某些情况下是必要的，但同时也可能被用于更复杂的攻击。

虽然POC的目的主要是演示漏洞，但上述风险点表明，如果直接使用此POC而不进行适当的修改和安全审查，可能会对系统造成危害。

**利用方式：**

该漏洞的利用方式有两种：

1.  **符号链接利用：** 如果服务器上存在指向敏感文件的符号链接（例如，本POC中的 `/workspace/static/image.png -> /etc/shadow`），攻击者可以直接访问该符号链接来读取目标文件。
2.  **目录遍历：** 即使没有预先存在的符号链接，攻击者也可以尝试使用目录遍历（`../`）来访问静态资源目录以外的文件。但需要注意URL规范化的问题，可能需要使用原始HTTP请求绕过。

总而言之，POC代码是有效的，可以用来演示CVE-2024-23334漏洞。需要注意的是，存在少量的投毒风险，应谨慎使用。

**项目地址:** [brian-edgar-re/poc-cve-2024-23334](https://github.com/brian-edgar-re/poc-cve-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #8

**来源**: [CVE-2024-23334-jhonnybonny_CVE-2024-23334.md](../2024/CVE-2024-23334-jhonnybonny_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用静态文件服务，且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当aiohttp作为web服务器，并且配置了静态路由时，如果`follow_symlinks`选项设置为True，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件。

**有效性:**

提供的POC代码有效。根据漏洞描述和搜索引擎结果，该漏洞允许未经授权的访问，POC利用LFI从 `/etc/passwd` 读取用户数据，可以验证漏洞的存在。

**投毒风险:**

查看POC代码：

*   `server.py`: 该脚本启动一个简单的aiohttp web服务器，设置静态路由，并启用`follow_symlinks=True`， 漏洞利用的关键配置。
*   `exploit.py`: 该脚本通过构造包含多个`../`的URL来尝试访问`/etc/passwd`文件，验证漏洞。
*   `aiohttp.yaml`: nuclei 扫描模板定义，可以检测漏洞。
*   `requirements.txt`:  定义了aiohttp==3.9.1，说明存在漏洞。

所有代码都是漏洞利用相关的，没有发现恶意代码或后门，但是考虑到是互联网上下载的，还是存在一定的风险，因为可能存在隐藏的、未被发现的恶意代码。综上，投毒风险极低，估计为1%。

**利用方式:**

1.  服务器端需要使用aiohttp搭建web服务，并且配置静态资源目录，设置`follow_symlinks=True`，允许访问符号链接指向的目录。
2.  攻击者构造包含`../`的URL，例如 `/static/../../../../etc/passwd`，试图绕过静态文件根目录的限制。
3.  服务器如果未正确验证URL，则会返回`/etc/passwd`文件的内容，导致敏感信息泄露。

**项目地址:** [jhonnybonny/CVE-2024-23334](https://github.com/jhonnybonny/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #9

**来源**: [CVE-2024-23334-ox1111_CVE-2024-23334.md](../2024/CVE-2024-23334-ox1111_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #10

**来源**: [CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-s4botai_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #11

**来源**: [CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md](../2024/CVE-2024-23334-sxyrxyy_aiohttp-exploit-CVE-2024-23334-certstream.md)

## CVE-2024-23334-aiohttp-目录穿越

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 框架中存在的一个目录穿越漏洞。当 aiohttp 被用作 Web 服务器，并且配置了静态路由，同时 `follow_symlinks` 选项设置为 `True` 时，攻击者可以通过构造包含 `../` 的恶意 URL，绕过静态文件目录的限制，访问服务器上的任意文件。即使没有符号链接，也存在此漏洞。

**有效性分析：**
提供的 POC 代码尝试利用此漏洞。它首先从 `certstream.calidog.io` 收集域名，然后检查这些域名是否运行 aiohttp 服务器并启用了静态文件服务。如果确认服务器使用了 aiohttp，POC 会构造包含多个 `../` 的 URL，尝试读取 `/etc/passwd` 文件。如果成功读取到该文件（判断依据是响应中包含 `root:`），POC 会将 URL 和文件内容发送到预定义的 Discord webhook。

**投毒风险分析：**
代码中存在以下潜在的投毒风险：

*   **Discord Webhook:**  POC 代码包含一个 Discord webhook URL。虽然这本身不一定是恶意行为，但攻击者可能会利用此 webhook 收集目标信息。攻击者可能会监控此webhook来确定哪些目标容易受到攻击，并且提取有价值的信息。Webhook本身的存在并不直接表明投毒，但是它确实增加了额外的风险。可以被滥用以收集信息或进行进一步的攻击。
*   **域名收集：** `domain_collector.py`文件收集域名。收集的域名的意图可能用于其他恶意活动，例如网络钓鱼或垃圾邮件。
*   **证书流依赖：**代码依赖外部证书流服务，如果服务本身被攻陷或提供恶意信息，可能导致误报或者执行恶意操作。此外，对域名长度的限制（小于15个字符）非常奇怪，可能被用于绕过检测。

综合考虑，投毒风险评估为10%。主要风险点在于 Discord webhook 和 域名收集模块，以及对域名长度的限制。攻击者可以通过监控webhook来确定哪些目标服务器容易受到攻击，并且提取有价值的信息。

**利用方式：**
1.  **确定目标：** 扫描目标服务器，识别运行 aiohttp 且启用了静态文件服务的服务器。确认 `follow_symlinks` 选项设置为 `True`。
2.  **构造恶意 URL：**  构造包含 `../` 的 URL，例如 `/static/../../../../etc/passwd`。`../` 的数量需要根据静态文件目录的深度进行调整，确保能够穿越到根目录。
3.  **发送请求：**  向目标服务器发送构造好的 URL 的 HTTP GET 请求。
4.  **提取信息：**  如果服务器存在漏洞，将会返回被穿越访问的文件内容。攻击者可以提取其中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream](https://github.com/sxyrxyy/aiohttp-exploit-CVE-2024-23334-certstream)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #12

**来源**: [CVE-2024-23334-wizarddos_CVE-2024-23334.md](../2024/CVE-2024-23334-wizarddos_CVE-2024-23334.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了静态文件服务，并且设置了`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当`aiohttp.web.static`函数设置`follow_symlinks=True`时，会允许攻击者通过构造包含`../`的URL来访问静态文件根目录以外的文件。漏洞利用方式如下：

1.  **漏洞描述：** aiohttp在处理静态文件请求时，如果启用了`follow_symlinks`选项，则会跟随符号链接。但是，它没有正确验证符号链接是否指向静态文件根目录之外的位置，从而导致目录遍历漏洞。
2.  **利用方式：** 攻击者可以通过构造特殊的URL，例如`http://example.com/static/../../../../etc/passwd`，来访问`/etc/passwd`文件。其中，`/static`是静态文件根目录，`../../../../`用于向上遍历目录结构，最终到达根目录，然后访问`/etc/passwd`文件。
3.  **POC有效性：** 提供的POC代码通过HTTP请求发送构造好的payload，尝试读取目标文件。根据漏洞描述，如果服务器启用了静态文件服务并且设置了`follow_symlinks=True`，则POC代码可以成功读取文件内容，证明了该漏洞利用代码的有效性。
4.  **投毒风险分析：** 检查了提供的POC代码(`/tmp/1d893f94fb3ef20a17986f4c4260f619/exploit.py`)和README.md。该代码逻辑清晰，主要功能是构造包含`../`的payload进行目录遍历。没有发现任何可疑的代码或后门。因此，可以认为该仓库中不存在作者隐藏的投毒代码。代码仅实现了目录遍历，用于读取文件，没有发现任何其他恶意行为。
5.  **缓解措施：** 升级到aiohttp 3.9.2或更高版本，或禁用`follow_symlinks`选项，并使用反向代理。

**项目地址:** [wizarddos/CVE-2024-23334](https://github.com/wizarddos/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

## POC #13

**来源**: [CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md](../2024/CVE-2024-23334-z3rObyte_CVE-2024-23334-PoC.md)

## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)

---

