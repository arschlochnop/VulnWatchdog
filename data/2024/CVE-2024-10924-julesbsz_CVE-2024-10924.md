## CVE-2024-10924 - Really Simple Security (原 Really Simple SSL) 身份认证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份认证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (原 Really Simple SSL)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.0.0 至 9.1.1.1

**利用条件:** 受影响网站必须启用插件的二步验证 (2FA) 功能；攻击者需知道目标用户的 ID (通常管理员 ID 为 1)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞存在于 WordPress 插件 Really Simple Security 的 REST API 处理逻辑中。根据提供的 POC 代码（exploit.py），漏洞利用的核心在于利用了该插件在处理二步验证（2FA）登录请求时的一个严重逻辑缺陷。当 2FA 功能开启时，插件通过 REST API 端点处理用户登录。由于错误处理函数未能正确验证用户身份或在某些异常路径下直接返回了合法的身份验证 Cookie，导致攻击者可以通过构造特定的 POST 请求绕过正常的密码验证。POC 代码展示了攻击者只需提供目标 URL 和用户 ID（默认为管理员 ID 1），脚本会自动向目标的 REST API 发送精心构造的数据包。如果目标存在漏洞，服务器将直接返回包含有效登录 Session 的 Set-Cookie 响应头。该 POC 结构完整，包含了依赖项检查、URL 验证、Payload 发送以及响应解析逻辑，能够实现从远程直接获取管理员权限的完整闭环，证明了该漏洞极高的实用性和破坏性。【利用步骤】1. 环境准备：安装 Python 3 环境及 requests、validator-collection 等依赖库。2. 确定目标：确认目标 WordPress 网站安装了版本在 9.0.0 至 9.1.1.1 之间的 Really Simple Security 插件且启用了 2FA。3. 执行脚本：运行命令 `python exploit.py -id 1 http://target-site.com/`。4. 获取凭据：如果攻击成功，脚本将从服务器响应中提取 Set-Cookie 字段，其中包含 session_id。5. 权限维持：攻击者将该 Cookie 导入浏览器，即可无需密码直接进入 WordPress 后台管理员界面。【投毒风险分析】经过对 POC 代码的深度审计，该脚本逻辑清晰，使用了标准的 Python 库如 argparse、requests 和 random。代码中未发现明显的混淆、Base64 编码的恶意载荷或向第三方服务器发送敏感数据的行为。脚本的核心功能仅限于针对特定 API 端点发送 HTTP 请求并打印响应头，属于典型的防御性安全研究工具。然而，由于该 POC 提到的 readme 文件中诱导用户‘解压并上传 9.1.1.1 版本插件’，这种提供预编译二进制文件或插件包的行为在安全社区中存在潜在的供应链投毒风险。虽然 exploit.py 本身是安全的，但用户应严格避免安装来自非官方渠道的插件压缩包，防止被植入后门。综合评估，脚本代码层面的投毒风险极低（约 10%），主要风险点在于其随附的插件包分发方式。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
