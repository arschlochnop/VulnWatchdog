## CVE-2024-10924 - Really Simple Security (Free, Pro, and Pro Multisite) WordPress 插件 身份认证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份认证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress 插件

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.0.0 到 9.1.1.1

**利用条件:** 需要远程网络访问目标 WordPress 站点，且该站点必须启用 Really Simple Security 插件的 MFA 功能。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 Really Simple Security 插件在处理双因素认证（MFA）逻辑时存在缺陷，具体在于 rest_api_fallback 及其相关的身份验证校验过程中，由于未对用户的身份标识进行充分验证，导致攻击者可以通过精心构造的 REST API 请求直接登录为任意用户（包括管理员）。提供的 Python 代码片段显示，利用过程主要涉及向特定的 WordPress 后台端点（如 /wp-admin/profile.php 或 REST API 端点）发送包含伪造或特定 Cookie 的 POST 请求。代码中定义了详细的 HTTP 报头，模仿合法浏览器行为，这表明利用程序已经过调试。通过这种方式，攻击者可以绕过正常的登录凭据校验和 MFA 步骤，直接获取管理员权限的会话。此 POC 能够自动执行请求并尝试获取有效的登录 Cookie，随后使用 webbrowser 模块打开本地生成的 HTML 副本以展示攻击结果。其利用路径清晰，逻辑符合典型的 WordPress 插件认证绕过模式，具有极高的实战有效性。利用步骤如下：首先，定位安装了受影响版本插件的 WordPress 目标；其次，通过分析 REST API 响应或公开的端点找到触发 MFA 验证失败后的 fallback 逻辑；然后，利用 Python 脚本构造携带目标管理员用户名（通常为 admin）的请求；最后，脚本捕获服务器返回的 Set-Cookie 响应，并利用该会话令牌直接访问管理后台。 投毒风险分析：该 POC 代码主要使用了 Python 标准库如 requests、os 和 webbrowser。从代码逻辑上看，它主要执行的是合法的安全测试行为，即将捕获的响应保存为本地文件并打开。目前未发现明显的混淆代码、反连 Shell 或恶意删除本地文件的逻辑，因此基础代码的安全性较高。然而，投毒风险主要存在于 README 中提到的外部引用。PoC 文档指向了一个 GitHub 仓库 (Trackflaw/CVE-2024-10924-Wordpress-Docker) 用于部署环境，虽然这方便了研究，但也可能被攻击者用来分发含有后门的镜像。此外，代码中存在未完全显示的截断部分，在补全这些代码时，如果从不可信的来源获取，可能会被植入恶意的 payload。建议防御者在受控隔离的沙箱环境中使用此类 PoC，并对下载的所有 Docker 镜像进行层级扫描，以防范潜在的供应链投毒风险。代码本身清晰易懂，属于典型的研究类脚本，投毒风险处于低至中等水平。

**项目地址:** [https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker](https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2024-10924](https://nvd.nist.gov/vuln/detail/cve-2024-10924)
