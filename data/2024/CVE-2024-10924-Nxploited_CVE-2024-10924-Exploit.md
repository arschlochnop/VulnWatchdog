## CVE-2024-10924 - Really Simple Security (Free, Pro, and Pro Multisite) 插件 身份认证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份认证绕过 (Authentication Bypass)

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) 插件

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 9.0.0 至 9.1.1.1

**利用条件:** 远程网络访问，目标网站启用了双因子身份验证（2FA）功能且使用了受影响的插件版本

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

关于POC有效性分析：该POC代码针对CVE-2024-10924漏洞进行了完整的自动化实现。其核心逻辑在于利用了WordPress插件Really Simple Security在处理REST API请求时的逻辑缺陷。具体而言，该插件的`/wp-json/reallysimplessl/v1/two_fa/skip_onboarding`端点在验证用户身份时存在严重疏忽，允许攻击者通过传递特定的JSON payload（包含`user_id`且无需有效的`login_nonce`）来绕过身份校验。POC首先通过检查`readme.txt`文件的`Stable tag`来确认目标版本是否在受影响范围内。随后，它向漏洞端点发送POST请求，通过模拟跳过引导流程的操作，触发服务器端的逻辑错误，导致服务器在响应头中返回有效的身份验证Cookie（Set-Cookie）。代码进一步集成了Selenium自动化工具，展示了如何利用获取到的管理员Cookie（默认user_id为1通常对应管理员）直接注入浏览器会话，从而实现无需密码即可登录WordPress后台。分析表明，该POC在逻辑上是高度有效的，因为它直接针对了漏洞的根本原因，即REST API端点缺乏适当的授权检查和Nonce验证。利用步骤如下：1. 环境准备，安装Python requests和selenium库及对应驱动。2. 版本探测，访问目标路径确认版本为9.0.0-9.1.1.1。3. 构造Payload，发送包含目标用户ID的POST请求至API端点。4. 获取凭据，捕获响应头中的Cookie。5. 绕过登录，将Cookie导入浏览器访问wp-admin。关于投毒风险分析：该脚本的投毒风险评级为低（约10%）。代码逻辑清晰、透明，使用了标准的Python库如requests和argparse，以及合规的自动化工具selenium。脚本中没有发现任何经过混淆处理的代码块，也没有发现Base64加密的Payload或隐蔽的远程命令执行逻辑。所有的网络请求都指向用户提供的URL，不存在向攻击者控制的第三方服务器发送敏感数据（如窃取目标凭据并回传）的行为。虽然使用了`webdriver_manager`自动下载驱动，这在自动化脚本中属于标准操作，不视为恶意投毒。唯一需要注意的安全实践是，在使用此类脚本时，应确保在一个隔离的环境（如沙箱或虚拟机）中运行，以防止Selenium驱动被替换为恶意版本。总的来说，该POC是一个典型的、用于防御性安全研究的验证工具，其行为完全符合安全分析师对漏洞复现的需求，未发现恶意植入后门或投毒行为。

**项目地址:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)
