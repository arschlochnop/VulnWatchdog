## CVE-2024-51793 - Computer Repair Shop (WordPress Plugin) 任意文件上传 (Unrestricted File Upload)

**漏洞编号:** CVE-2024-51793

**漏洞类型:** 任意文件上传 (Unrestricted File Upload)

**影响应用:** Computer Repair Shop (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** n/a 至 3.8115

**利用条件:** 无需认证，远程网络访问受影响的WordPress站点

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WordPress插件'Computer Repair Shop'的特定版本中，主要原因是对上传文件的类型检查不严。提供的POC代码是一个基于Python 3编写的自动化利用脚本，使用了requests库和ThreadPoolExecutor。代码逻辑完整，涵盖了从Session初始化、自定义User-Agent设置、到生成包含简单Webshell的PHP负载（该负载包含一个文件上传表单，用于后续持久化控制）。该脚本不仅实现了单一目标的验证，还设计了多线程并发扫描的能力。代码结构清晰，通过自定义HTTP头部伪造真实浏览器行为，提高了绕过WAF的成功率。经分析，其上传点位于插件的公开处理接口，利用该POC可直接向服务器写入.php文件。利用步骤：1. 环境准备：安装Python 3及requests依赖。2. 配置目标：将受影响的WordPress站点URL填入脚本。3. 执行脚本：运行Python脚本，脚本会自动向插件上传接口发送Multipart请求。4. 获取权限：脚本若成功，会返回上传后Webshell的路径。5. 后续操作：通过访问生成的PHP页面执行系统命令。投毒风险分析：该POC代码具有一定的安全合规性。代码风格规范，使用了标准类结构，并没有发现明显的反连Shell、系统删除命令（如rm -rf）或敏感目录窃取（如读取/etc/shadow）等隐蔽恶意行为。脚本中虽然包含了Webshell Payload，但这是漏洞验证的常规部分，且该Payload（kill_the_net标签）主要用于验证文件写入权限，属于合法的安全研究范畴。脚本使用的库均为常用的requests、argparse和random，不包含未经审核的二进制文件或外部不可控的第三方库下载。主要风险点在于此类代码可能被恶意攻击者直接利用进行大规模自动化扫描，但从脚本本身逻辑来看，其行为透明。为了进一步降低风险，防御方在使用时应在隔离的沙箱环境中运行，并对网络出向流量进行审计，防止潜在的DNS泄露或信息外传。整体投毒风险评级为低（15%），属于高质量的防御性安全研究代码。

**项目地址:** [https://nvd.nist.gov/vuln/detail/CVE-2024-51793](https://nvd.nist.gov/vuln/detail/CVE-2024-51793)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-51793](https://nvd.nist.gov/vuln/detail/CVE-2024-51793)
