# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Kento-Sec_CVE-2024-34102.md](../2024/CVE-2024-34102-Kento-Sec_CVE-2024-34102.md)

# CVE-2024-34102

> 📦 该CVE有 **20** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-34102-0x0d3ad_CVE-2024-34102.md](../2024/CVE-2024-34102-0x0d3ad_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <=2.4.7, <=2.4.6-p5, <=2.4.5-p7, <=2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102是Adobe Commerce/Magento的一个XML外部实体注入（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞。利用成功后，可能导致任意代码执行和敏感信息泄露，例如读取服务器上的文件。根据漏洞库信息和搜索引擎结果，该漏洞危害极大，CVSS评分为9.8，且已被CISA列入已知被利用的漏洞。提供的PoC代码通过构造一个包含恶意XML的请求，尝试读取服务器上的文件（例如crypt key）。

**有效性:**

根据漏洞信息和提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息和搜索引擎结果都表明这是一个关键的XXE漏洞，无需身份验证即可利用。PoC代码模拟了攻击者发送恶意XML请求的行为，通过定义外部实体来读取服务器上的文件。

**投毒风险:**

PoC代码本身主要用于验证漏洞的存在和影响，但仍存在很小的投毒风险：

*   **Payload定制化风险:**  攻击者可能修改PoC中读取的文件路径，从而尝试窃取其他敏感信息，或者执行更具破坏性的操作。
*   **依赖风险:**  PoC依赖于目标系统存在特定的文件和配置，如果目标系统环境与预期不符，PoC可能无法成功执行，导致使用者产生误判。
*   **网络请求风险:**  PoC会发起网络请求到攻击者控制的服务器，存在被恶意利用的风险，例如窃取使用者IP地址等。

总的来说，该PoC代码的投毒风险较低，大约为5%。因为其主要目的是利用XXE漏洞读取文件，而不是执行恶意代码。然而，使用者仍然需要注意潜在的风险，并在安全的环境中测试和使用该PoC代码。

**利用方式:**

1.  **搭建恶意服务器:**  攻击者需要搭建一个HTTP服务器，用于接收来自受害服务器的请求。PoC代码中使用了`http.server`模块来启动一个简单的HTTP服务器。
2.  **构造恶意XML:**  攻击者构造一个包含恶意XML的请求。XML中定义了外部实体，指向攻击者控制的HTTP服务器。当受害服务器解析该XML时，会尝试从攻击者的服务器获取外部实体。
3.  **发送恶意请求:**  攻击者将包含恶意XML的请求发送到受害服务器的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点。请求的`Content-Type`为`application/json`。
4.  **读取文件:**  受害服务器解析XML时，会尝试从攻击者的服务器读取外部实体。攻击者的服务器接收到请求后，会将请求中的文件内容进行base64编码，并通过URL返回给受害服务器。
5.  **解码文件:**  攻击者的服务器接收到受害服务器返回的base64编码的文件内容后，进行解码，即可获得受害服务器上的文件内容。

利用此漏洞，攻击者可以读取受害服务器上的敏感文件，例如配置文件、数据库连接信息等，甚至可以执行任意代码，从而完全控制受害服务器。

**项目地址:** [0x0d3ad/CVE-2024-34102](https://github.com/0x0d3ad/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #2

**来源**: [CVE-2024-34102-11whoami99_CVE-2024-34102.md](../2024/CVE-2024-34102-11whoami99_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce中一个未经身份验证的XXE漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过发送精心构造的XML文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用代码中的`POST /rest/V1/guest-carts/1/estimate-shipping-methods`请求，通过修改`address`中的`totalsCollector`和`sourceData`，使得Magento尝试从攻击者控制的URL加载数据，从而触发XXE。

**有效性：**
提供的POC代码有效，因为它利用了Adobe Commerce中存在XXE漏洞的端点。虽然提供的两个文件，一个是POST请求数据,一个是xml文件，但是从描述来看，应该重点关注第一个POST请求，通过第一个POST请求将`data`指向恶意的`xml`文件，从而触发XXE。

**投毒风险：**
从提供的漏洞利用代码来看，主要包含一个README文件，一个POST请求示例，以及一个xxe.xml文件。xxe.xml 文件仅仅是读取了`/etc/passwd`文件。POST 请求中`http://YOUR-webhook`如果被替换成恶意地址,可能会存在风险，但是并不能算作仓库作者投毒, 因此推断仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **构造恶意XML:**  攻击者创建一个包含外部实体声明的XML文档，该实体指向攻击者控制的URL或者本地文件。在给定的例子中，`xxe.xml`文件尝试读取`/etc/passwd`。
2.  **发送恶意请求:** 攻击者构造一个HTTP POST请求到`/rest/V1/guest-carts/1/estimate-shipping-methods`，并在请求体中包含恶意的XML数据。`address.totalsCollector.collectorList.totalCollector.sourceData.data`字段的值被设置为攻击者控制的URL，Magento会尝试解析该URL返回的数据，从而触发XXE漏洞。
3.  **信息泄露/代码执行:** 如果成功利用XXE漏洞，攻击者可以读取服务器上的敏感文件（如`/etc/passwd`）或执行任意代码。

总的来说，该漏洞的利用相对简单，且危害严重，无需用户交互即可触发，因此需要及时修补。

**项目地址:** [11whoami99/CVE-2024-34102](https://github.com/11whoami99/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #3

**来源**: [CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md](../2024/CVE-2024-34102-ArturArz1_TestCVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #4

**来源**: [CVE-2024-34102-Chocapikk_CVE-2024-34102.md](../2024/CVE-2024-34102-Chocapikk_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞存在于Adobe Commerce的XML解析模块中，允许未经身份验证的攻击者通过发送精心构造的XML文档，引用外部实体，从而读取服务器上的任意文件，甚至可能执行任意代码。从搜索引擎结果和漏洞描述来看，这是一个严重的安全问题，利用代码的存在进一步证实了其风险。攻击者利用该漏洞获取敏感信息，如数据库配置、加密密钥等，从而完全控制系统。

**有效性：**
提供的POC代码看起来是有效的，因为它包含了利用XXE漏洞所需的关键步骤：

1.  **生成Callback URL：** 利用fars.ee在线服务托管包含恶意XML实体的DTD文件，指向攻击者的服务器。
2.  **获取Instance ID：** 从SSRF API获取一个实例ID，用于后续的攻击。
3.  **发送恶意请求：** 构造包含恶意DTD URL的请求，发送到目标URL。
4.  **检查Exploitation Success：** 检查实例日志，解码并显示提取的数据。

根据漏洞描述，无需用户交互即可利用该漏洞，进一步增加了其威胁性。

**投毒风险：**
此POC代码的投毒风险评估为20%。风险点在于：

1.  **依赖外部服务 (fars.ee, cvssadvisor.com)：**  POC依赖 `fars.ee` 托管 DTD 文件和 `cvssadvisor.com` 的SSRF API。 这些服务如果被恶意控制或停止服务，可能导致POC失效或被利用进行中间人攻击。
2.  **base64编码php://filter流：** POC使用base64编码可能绕过部分WAF检测，但如果攻击者更改`dtd_data`为反弹shell的代码，并且服务器端没有进行严格的输入验证,可能存在隐患。
3. **SSRF API使用风险:**  SSRF API可能会记录和分析攻击流量，存在被溯源的风险。

总体来说，代码主要利用了已知的XXE漏洞，并没有发现明显的后门或者恶意代码。 但使用过程中依赖外部服务存在一定的风险。

**利用方式：**

1.  攻击者首先需要找到存在XXE漏洞的Adobe Commerce实例。
2.  使用POC脚本，指定目标URL和要读取的文件（默认为`/etc/passwd`）。
3.  脚本会自动生成包含恶意XML实体的DTD文件，并将其托管在fars.ee上。
4.  脚本会发送包含恶意DTD URL的请求到目标服务器。
5.  目标服务器解析XML时，会尝试从fars.ee加载DTD文件，触发XXE漏洞，读取指定文件内容，并通过回调URL将内容发送到攻击者的服务器。
6.  攻击者可以从回调URL的日志中获取读取到的文件内容。

**项目地址:** [Chocapikk/CVE-2024-34102](https://github.com/Chocapikk/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #5

**来源**: [CVE-2024-34102-EQSTLab_CVE-2024-34102.md](../2024/CVE-2024-34102-EQSTLab_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #6

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #7

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---



---

## POC #7

**来源**: [CVE-2024-34102-Koray123-debug_CVE-2024-34102.md](../2024/CVE-2024-34102-Koray123-debug_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个影响 Adobe Commerce 和 Magento 的严重 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。漏洞利用无需身份验证。提供的 POC 代码 `README.md` 内容非常简单，只包含 CVE 编号。  这**不能**直接用来验证漏洞，但是考虑到其他搜索结果和漏洞信息，可以推断出真实可用的 POC 可能包含构造恶意 XML 负载，尝试读取服务器上的敏感文件(例如密钥文件)，或者尝试执行任意命令。由于`README.md`本身没有任何实际的利用代码，所以投毒风险很低，仅考虑存在钓鱼或者误导的可能性。搜索结果表明该漏洞已存在公开的利用方法。利用方式通常是构造包含恶意外部实体引用的 XML 请求发送到存在漏洞的 Adobe Commerce/Magento 实例，从而读取服务器本地文件或执行其他操作。

**项目地址:** [Koray123-debug/CVE-2024-34102](https://github.com/Koray123-debug/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #8

**来源**: [CVE-2024-34102-Phantom-IN_CVE-2024-34102.md](../2024/CVE-2024-34102-Phantom-IN_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #9

**来源**: [CVE-2024-34102-SamJUK_cosmicsting-validator.md](../2024/CVE-2024-34102-SamJUK_cosmicsting-validator.md)

## CVE-2024-34102 - Adobe Commerce XXE 漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8 (以及其他受影响版本)

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 和 Magento 中存在的 XML 外部实体注入 (XXE) 漏洞。攻击者可以发送特制的 XML 文档，其中包含对外部实体的引用，从而利用此漏洞。成功利用此漏洞可能允许攻击者执行任意代码，并公开加密密钥和其他敏感信息，从而获得完全管理员访问权限。

**利用方式：**

1.  **构造恶意的 XML Payload：** 攻击者需要构造一个包含外部实体声明的 XML 文档。这个外部实体指向攻击者控制的 URL。
2.  **利用外部实体读取文件：** 外部实体声明可以使用 `file://` 协议读取服务器上的任意文件。例如，可以读取包含加密密钥的文件。
3.  **使用 php://filter 包装器进行 Base64 编码：** 为了绕过某些限制，可以使用 `php://filter/convert.base64-encode/resource=` 包装器对读取的文件内容进行 Base64 编码。
4.  **通过 SSRF 回调将数据发送到攻击者服务器：** PoC 使用了 `https://api.cvssadvisor.com/ssrf/api/instance` API 作为一个回调服务器，将读取到的 Base64 编码数据发送到攻击者控制的服务器。
5.  **解码数据：** 攻击者接收到 Base64 编码的数据后，对其进行解码以获取文件内容。

**有效性：**

提供的 PoC 代码看起来是有效的，并且旨在利用 CVE-2024-34102 漏洞。它包含以下关键步骤：

*   创建一个回调 URL，该 URL 指向托管恶意 DTD 文件的远程服务器。
*   构造一个恶意的 XML Payload，其中包含对外部实体的引用。
*   发送 XML Payload 到易受攻击的 Adobe Commerce 实例。
*   检查回调 URL 的日志以确认漏洞利用成功。

**投毒风险：**

该仓库存在一定的投毒风险。主要体现在以下几个方面：

*   **依赖第三方 API：** PoC 依赖于 `https://api.cvssadvisor.com/ssrf/api/instance` 这个第三方 API 来进行 SSRF 回调。如果这个 API 被篡改或关闭，PoC 将无法正常工作。但这个不是投毒，只能说存在依赖风险。
*   **DTD 文件托管：** PoC 使用 `https://fars.ee/` 托管 DTD 文件。如果这个网站被恶意控制，攻击者可以修改 DTD 文件，从而在受害者服务器上执行恶意代码。这是潜在的投毒风险。
*   **`z_compromise_check` 脚本：** 虽然这个脚本的目的是监控站点是否被入侵，但也可能被用来植入后门或者篡改文件。需要仔细审查该脚本。
*   **`requirements.txt` 文件：**虽然`requirements.txt`看起来正常,但是存在被替换为包含恶意包的风险. 比如,拼写相似的恶意包。

综合分析，投毒风险不能排除，但可能性较低，约 10%。主要风险在于第三方依赖和可能被篡改的 DTD 文件。

**项目地址:** [SamJUK/cosmicsting-validator](https://github.com/SamJUK/cosmicsting-validator)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #10

**来源**: [CVE-2024-34102-bigb0x_CVE-2024-34102.md](../2024/CVE-2024-34102-bigb0x_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #11

**来源**: [CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md](../2024/CVE-2024-34102-bka_magento-cve-2024-34102-exploit-cosmicstring.md)

## CVE-2024-34102-Adobe Commerce/Magento-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, <= 2.4.6-p5, <= 2.4.5-p7, <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce和Magento中的XML外部实体（XXE）漏洞。攻击者可以通过发送特制的XML文档，该文档引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞无需身份验证即可利用，CVSS评分为9.8，属于高危漏洞。

**有效性:**

漏洞库信息和搜索结果表明该漏洞是真实存在的，且已经被公开利用。提供的POC代码包含利用该漏洞的演示和Exploit Demo。

**投毒风险:**

尽管POC代码主要是为了演示漏洞，但其中`cve-2024-34102-exploit/README.md`文档包含利用步骤，可能被恶意攻击者直接使用，使得漏洞更容易被利用。`/cve-2024-34102-exploit/change-crypt-key.p`文件可能包含更改加密密钥的操作,存在一定的风险。整体投毒风险较低，预估为10%。

**利用方式:**

1.  攻击者构造包含恶意外部实体引用的XML文档。
2.  将该XML文档发送到存在XXE漏洞的Adobe Commerce/Magento应用程序。
3.  应用程序解析XML文档时，会尝试解析外部实体。
4.  攻击者可以通过外部实体引用来读取服务器上的任意文件（例如，/etc/passwd）或执行任意代码。

从POC代码来看，利用方式主要是通过POST请求发送恶意的XML数据到`/rest/all/V1/guest-carts/{cartId}/estimate-shipping-methods`接口，提取服务器环境变量中的crypt key，然后利用crypt key构造JWT token，从而访问受保护的REST API。

搜索引擎结果也支持这一利用方式，例如网页4提到“nested deserialization”可能存在问题，意味着攻击者可以通过嵌套的XML结构触发漏洞。网页7提供了受影响的版本信息。

总而言之，该漏洞利用起来相对简单，危害巨大，需要及时修复。

**项目地址:** [bka/magento-cve-2024-34102-exploit-cosmicstring](https://github.com/bka/magento-cve-2024-34102-exploit-cosmicstring)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #12

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102-Python.md)

## CVE-2024-34102 - Adobe Commerce XXE漏洞

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行

**影响版本:** <= 2.4.4-p8

**利用条件:** 目标系统存在未授权的XML处理接口，攻击者可以通过网络直接访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个严重的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞读取服务器上的敏感文件，甚至可能导致任意代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞可能导致任意代码执行，CVSS 评分高达 9.8。搜索结果中也包含多个安全厂商对该漏洞的分析和描述，并将其定性为高危漏洞。提供的 Python 脚本（`cosmic_sting.py`）旨在自动化利用该漏洞，通过构造恶意 XML 请求来读取服务器上的文件。

**投毒风险分析：**

尽管该漏洞利用代码看起来是用于读取文件，但是仍然存在一定的投毒风险。

*   **依赖风险:**  脚本依赖 `requests`，`click`，和 `fake_useragent` 库。尽管这些库本身比较常用，但恶意作者仍然可能在 `requirements.txt` 文件中指定恶意版本，导致安装了包含后门的第三方库。
*   **Callback URL风险:**  脚本使用 `fars.ee`  来托管 DTD 文件,该操作存在一定的风险，因为攻击者无法控制该域名，可能被中间人攻击或者该服务提供商被恶意利用。
*   **SSRF API风险:** 脚本使用了 `api.cvssadvisor.com`这个SSRF API, 该服务可能会被滥用或停止服务.
*   **代码逻辑风险:** `cosmic_sting.py` 使用了`obtain_instance`函数,该函数调用了 `api.cvssadvisor.com` 的 SSRF API, 并使用了 User-Agent。 这有可能收集攻击者的User-Agent信息. 虽然看起来正常，但收集行为本身存在隐私风险。

综上，该仓库中存在投毒代码的可能性较低，估计为10%。 但是仍然需要人工审核代码，特别是检查所有依赖项和与外部服务交互的部分。

**利用方式分析：**

1.  **漏洞触发:** 攻击者发送包含恶意 XML 内容的 HTTP 请求到存在漏洞的 Adobe Commerce 服务器。该 XML 内容包含对外部实体的引用。
2.  **外部实体解析:**  Adobe Commerce 的 XML 解析器在处理 XML 请求时，会尝试解析外部实体。攻击者通过构造恶意的外部实体，使其指向攻击者控制的服务器。
3.  **信息泄露/代码执行:**  通过外部实体，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、数据库配置文件等，从而获取敏感信息。 在更复杂的场景下，攻击者可以通过 XXE 漏洞结合其他漏洞，例如 SSRF 或代码注入，实现远程代码执行。

`cosmic_sting.py` 脚本简化了这一过程，它会自动生成包含恶意外部实体引用的 XML 数据，并将其发送到目标服务器。脚本还会启动一个简单的 HTTP 服务器，用于托管恶意的 DTD 文件，从而引导目标服务器解析攻击者控制的外部实体。具体而言，该脚本首先创建一个 callback URL 用于托管 DTD 文件。这个 DTD 文件包含从目标服务器读取任意文件的指令，然后将文件内容发送到攻击者的服务器上。利用方式的关键在于精心构造的 XML 和 DTD 文件，它们能够利用 XML 解析器的特性，实现对服务器资源的非法访问。

**项目地址:** [bughuntar/CVE-2024-34102-Python](https://github.com/bughuntar/CVE-2024-34102-Python)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #13

**来源**: [CVE-2024-34102-bughuntar_CVE-2024-34102.md](../2024/CVE-2024-34102-bughuntar_CVE-2024-34102.md)

## CVE-2024-34102 - Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce / Magento

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 漏洞存在于 Adobe Commerce/Magento 的 XML 解析器中。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而执行任意代码或读取服务器上的敏感文件。由于漏洞是未授权的，无需用户交互，攻击者可以通过网络直接触发。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的 PoC 代码是有效的。漏洞库明确指出 CVE-2024-34102 是一个 XXE 漏洞，并且具有较高的 CVSS 评分（9.8）。搜索结果也表明该漏洞已被广泛讨论，并且存在公开可用的 PoC。提供的 PoC 代码实现了一个利用 CVE-2024-34102 读取任意文件的工具，进一步证明了其有效性。

**投毒风险分析：**

仔细分析了提供的 Go 代码 `cosmic_sting.go` 以及 `README.md` 文件。代码的主要功能是利用 XXE 漏洞读取文件，创建 Callback URL, 通过外带数据的方式获取文件内容。具体分析如下：

*   **代码逻辑：** 代码首先创建一个随机的 Callback URL，然后构造恶意的 XML 实体，当目标服务器解析该 XML 时，会尝试访问 Callback URL，从而将服务器上的文件内容外带出来。
*   **潜在风险：**代码中使用`fars.ee`这个域名来托管DTD文件，该域名存在潜在的风险，如果该域名被恶意人员控制，可能会投放恶意的DTD文件，进而导致被攻击的服务器执行恶意代码。代码中存在使用`api.cvssadvisor.com`获取instanceId的操作，增加了信息泄露的风险。代码中包含一些URL的硬编码，增加了被恶意利用的风险。
*   **结论：** 总体来看，代码的投毒风险较低，主要风险在于对第三方URL的依赖。 但是，鉴于代码的功能是读取文件内容，并无直接执行恶意代码的功能，因此代码的投毒风险较低，估计在5%左右。

**利用方式：**

1.  **构造恶意 XML：** 攻击者构造一个包含外部实体引用的恶意 XML 文档。
2.  **发送请求：** 将该 XML 文档作为请求的一部分发送到存在漏洞的 Adobe Commerce/Magento 服务器。
3.  **触发 XXE：** 服务器解析 XML 时，会尝试解析外部实体，从而发起对攻击者控制的服务器的请求。
4.  **读取文件/执行代码：** 攻击者可以通过外部实体引用读取服务器上的任意文件，或者通过特定的 payload 执行任意代码。
5.  **文件外带：** 通过 `fars.ee` 生成的 dtd 文件，读取目标文件内容，并且通过 `c5.rs` 域名将数据外带出去。

**项目地址:** [bughuntar/CVE-2024-34102](https://github.com/bughuntar/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #14

**来源**: [CVE-2024-34102-d0rb_CVE-2024-34102.md](../2024/CVE-2024-34102-d0rb_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #15

**来源**: [CVE-2024-34102-dream434_CVE-2024-34102.md](../2024/CVE-2024-34102-dream434_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 及更早版本

**利用条件:** 目标系统存在漏洞，攻击者需要能够发送 HTTP 请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce（Magento）中的一个 XML 外部实体注入（XXE）漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞无需用户交互，攻击复杂度低，允许未授权的远程攻击者读取服务器上的任意文件或执行任意代码。

**漏洞利用方式：**

1.  **构造恶意的XML请求：** 攻击者构造包含外部实体引用的恶意XML数据，该实体指向攻击者控制的外部资源或服务器上的本地文件。
2.  **发送请求到易受攻击的端点：** 将构造的XML数据通过HTTP请求发送到Adobe Commerce中存在XXE漏洞的`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。
3.  **利用外部实体读取文件：**  服务器解析XML时，会尝试解析外部实体，从而导致读取攻击者指定的文件或执行指定的命令。
4.  **数据泄露或代码执行：**  如果外部实体指向服务器上的敏感文件（如`/etc/passwd`），则文件内容将被泄露。更严重的，攻击者可以通过XXE执行任意代码。

**POC分析：**

POC代码首先生成一个包含外部实体定义的DTD文件，该文件会尝试读取`/etc/passwd`并将其base64编码后发送到攻击者的服务器（sabatnth.c5.rs）。然后，POC构造一个包含对该DTD文件引用的XML请求，并将其发送到`/rest/V1/guest-carts/1/estimate-shipping-methods`端点。如果目标服务器存在漏洞，它将执行DTD文件中的操作，并将`/etc/passwd`的内容发送到攻击者的服务器。

**投毒风险分析：**

代码中存在将`/etc/passwd`的内容发送到`sabatnth.c5.rs` 的行为，这在实际攻击中用于将敏感信息发送到攻击者控制的服务器。由于POC的设计目的是证明漏洞的存在，因此将`/etc/passwd`发送到外部服务器是正常的漏洞验证行为，不是恶意投毒行为。基于对代码的分析，没有发现隐藏的恶意代码或后门，因此，投毒风险为0%。

**有效性评估：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的，因为该POC能够读取服务器上的`/etc/passwd`文件内容。

**项目地址:** [dream434/CVE-2024-34102](https://github.com/dream434/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #16

**来源**: [CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md](../2024/CVE-2024-34102-jakabakos_CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #17

**来源**: [CVE-2024-34102-mksundaram69_CVE-2024-34102.md](../2024/CVE-2024-34102-mksundaram69_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意文件读取和潜在的远程代码执行

**影响版本:** <= 2.4.4-p8, 2.4.5-p7, 2.4.6-p5, 2.4.7

**利用条件:** 需要网络访问目标Magento实例，且实例存在未修复的XXE漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。根据漏洞信息，攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞。此漏洞不需要用户交互。

**有效性：**
提供的PoC代码利用了Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods` 接口，通过构造包含恶意XML的JSON payload来实现XXE。Payload中定义了外部实体，尝试从目标服务器读取指定文件，并通过HTTP请求将文件内容发送到攻击者控制的`exfil_url`。根据漏洞库信息和搜索结果，确认此漏洞利用方式是可行的，PoC代码是有效的。

**投毒风险：**
代码本身的主要功能是利用XXE漏洞进行文件读取。代码中唯一的网络请求是将读取的文件内容发送到`exfil_url`，这个URL由用户提供。README.md中包含的政治性声明与漏洞利用本身无关，但可能暗示了作者的某种倾向。检查代码后，并未发现明显的恶意代码或后门。但始终需要注意，任何来自外部来源的代码都存在一定的风险，所以投毒风险评估为5%。虽然主要功能是文件读取，但XXE也可能被用于DoS或RCE，具体取决于目标系统的配置。

**利用方式：**
1.  攻击者构造包含恶意XML的JSON payload。
2.  该payload被发送到Magento的`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`接口。
3.  Magento服务器解析XML时，会尝试解析payload中定义的外部实体。
4.  外部实体指向目标服务器上的文件，Magento服务器会尝试读取该文件。
5.  读取的文件内容通过HTTP请求发送到攻击者指定的`exfil_url`。
6.  攻击者在`exfil_url`上接收并解码文件内容，从而获取目标服务器上的敏感信息，例如`app/etc/env.php`文件，该文件包含Magento的加密密钥，可能导致完全控制。

**项目地址:** [mksundaram69/CVE-2024-34102](https://github.com/mksundaram69/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #18

**来源**: [CVE-2024-34102-th3gokul_CVE-2024-34102.md](../2024/CVE-2024-34102-th3gokul_CVE-2024-34102.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce/Magento 的 XXE 漏洞。攻击者可以通过发送精心构造的 XML 文档，其中包含指向外部实体的引用，来利用此漏洞。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别，攻击向量为网络，攻击复杂度低，无需权限且无需用户交互。成功利用此漏洞可能导致任意代码执行和敏感信息泄露，例如加密密钥。

**有效性：**

提供的 POC 代码（cvehunter.py）是一个 Python 脚本，旨在检测和利用 CVE-2024-34102。它使用 `httpx` 库发送 HTTP 请求，并可能使用 `aiofiles` 库处理文件。脚本的参数包括目标 URL、线程数、代理和输出文件。该脚本还引用了 cvssadvisor.com 的 SSRF 工具，暗示该漏洞可能与 SSRF 相关，或者是利用 SSRF 的一种方式。根据搜索结果，存在多个关于此漏洞的分析报告和利用示例，表明该漏洞是可利用的。

**投毒风险：**

在提供的POC代码中，存在潜在的投毒风险。虽然核心功能是利用 XXE 漏洞，但脚本中包含以下可疑点：

1.  **依赖项：** 使用了 `fake_useragent` 库，虽然常见，但可能被用于隐藏恶意行为或增加分析难度。
2.  **外部API调用:**调用了 `api.cvssadvisor.com` 的接口，这可能存在潜在风险。
3.  **代码结构：** 代码结构较为简单，但存在一些可以插入恶意代码的位置，例如在发送请求前后，或者在处理响应时。 

虽然无法确定是否包含恶意代码，但考虑到以上因素，存在一定的投毒风险。为了更加安全，建议仔细审查代码，并在隔离环境中运行。

综上所述，可以判定POC代码存在 10%的投毒风险。

**利用方式：**

1.  **构造恶意的 XML 文档：** 攻击者需要构造一个包含外部实体引用的 XML 文档。外部实体可以指向本地文件或远程 URL。
2.  **发送包含恶意 XML 的请求：** 攻击者将构造的 XML 文档作为请求的一部分发送到目标服务器。具体发送的位置需要根据 Adobe Commerce/Magento 的代码进行分析，搜索结果表明可能是通过反序列化或者特定的API接口。
3.  **利用 XXE 漏洞读取敏感信息或执行代码：** 如果目标服务器的 XML 解析器未正确配置，它将解析外部实体引用，从而允许攻击者读取服务器上的文件、执行任意代码或发起 SSRF 攻击。

根据漏洞信息和搜索结果，可以判断该漏洞的利用方式是向目标服务器发送包含恶意 XML 文档的请求，利用未安全配置的 XML 解析器读取敏感信息或执行代码。利用过程中可能涉及到对加密密钥的窃取，从而获取完整的管理员权限。

**项目地址:** [th3gokul/CVE-2024-34102](https://github.com/th3gokul/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #19

**来源**: [CVE-2024-34102-unknownzerobit_poc.md](../2024/CVE-2024-34102-unknownzerobit_poc.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个XML外部实体注入(XXE)漏洞。攻击者可以通过发送精心制作的XML文档，引用外部实体来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞无需用户交互，且影响严重。漏洞利用代码`unknownzerobit.dtd`定义了一个DTD文件，它首先使用`php://filter`流读取`/etc/hosts`文件内容，并对其进行base64编码。然后，它创建一个名为`exfil`的外部实体，该实体尝试将base64编码后的数据发送到攻击者控制的服务器`qzlvtoqxvjmymesicpui4qdycubl21vf6.oast.fun`。 

**有效性：** 提供的POC代码有效。它可以通过XXE漏洞读取服务器上的文件，并将其发送到攻击者的服务器。从NVD、Adobe安全公告和其他安全网站上的描述可以看出，攻击者可以通过发送特制的XML文档来触发此漏洞。

**投毒风险：** 代码中没有发现明显的投毒行为。该代码的功能明确且直接，旨在利用XXE漏洞读取文件。攻击者可能通过 DNS Log 获取服务器信息，这里认为投毒风险为0%。

**利用方式：** 攻击者需要构造一个包含恶意DTD引用的XML文档。当Adobe Commerce/Magento解析此XML文档时，它会尝试解析外部实体，从而导致：

1.  **文件读取：** 通过`php://filter`流，可以读取服务器上的任意文件，例如`/etc/hosts`，以及其他配置文件，从而获取敏感信息，例如数据库凭据、API密钥等。
2.  **信息泄露：** 读取到的文件内容会被base64编码并通过HTTP请求发送到攻击者控制的服务器。
3.  **远程代码执行（可能）：**  根据漏洞库信息，此XXE漏洞可能导致任意代码执行。这可能需要更复杂的攻击载荷，例如利用XXE漏洞上传恶意文件并执行，或者通过XXE漏洞触发其他漏洞。


**项目地址:** [unknownzerobit/poc](https://github.com/unknownzerobit/poc)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #20

**来源**: [CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md](../2024/CVE-2024-34102-wubinworks_magento2-cosmic-sting-patch.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

## POC #21

**来源**: [CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md](../2024/CVE-2024-34102-wubinworks_magento2-encryption-key-manager-cli.md)

## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102 是 Adobe Commerce (Magento) 中的一个 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送精心制作的 XML 文档，其中包含指向外部实体的引用来利用此漏洞。由于利用不需要用户交互且可导致任意代码执行和敏感信息泄露(例如数据库配置，加密密钥)，因此风险等级为严重。

**有效性：**
根据漏洞库信息，搜索引擎结果（例如 Vicarius 的文章）和CISA已经将该漏洞添加到了已知可被利用的漏洞列表中，可以判定该漏洞是可以被成功利用的。

**投毒风险：**
提供的代码片段仅包含许可文件（COPYING.txt 和 LICENSE.txt），它们是开源许可证的常见组成部分。这些文件本身不包含任何可执行代码或恶意指令，因此投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 XML 外部实体引用的 XML 文档。
2.  攻击者将该恶意 XML 文档发送到易受攻击的 Adobe Commerce 实例。
3.  Adobe Commerce 的 XML 解析器处理该 XML 文档时，会尝试解析外部实体引用。
4.  通过外部实体引用，攻击者可以读取服务器上的任意文件（例如，`/etc/passwd`）或执行任意代码。
5.  成功利用该漏洞可能导致敏感信息泄露、远程代码执行和完全控制受影响的系统。

**项目地址:** [wubinworks/magento2-encryption-key-manager-cli](https://github.com/wubinworks/magento2-encryption-key-manager-cli)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)

---

