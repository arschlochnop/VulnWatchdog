## CVE-2024-53677 - Apache Struts RCE (远程代码执行)

**漏洞编号:** CVE-2024-53677

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Apache Struts

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 2.0.0 to < 6.4.0

**利用条件:** 远程未经身份验证访问、存在文件上传接口

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2024-53677是一个影响Apache Struts2框架的严重漏洞，源于其文件上传逻辑中的缺陷。具体而言，当应用程序使用Struts2内置的文件上传拦截器时，攻击者可以通过操纵上传参数（如文件名）实现路径穿越（Path Traversal）。由于Struts2在处理多部分表单数据（multipart/form-data）时未能正确限制目标保存路径，攻击者可以将恶意脚本文件（如JSP Webshell）写入到Web服务器的可访问目录（如/webapps/root/uploads/）中。一旦文件成功上传，攻击者只需通过浏览器或脚本访问该文件的URL即可触发执行，从而获得服务器的完全控制权。该漏洞无需身份验证即可利用，风险极高。提供的POC代码包含一个Python自动化脚本和一个JSP Webshell。Python脚本通过requests库向目标端点发送带有路径穿越Payload的POST请求，并自动进入交互模式。JSP文件则是典型的Webshell，通过Runtime.exec()执行系统命令并返回输出。该POC虽然结构简单，但由于其逻辑与公开的漏洞原理高度吻合，在未修复的环境中具有极高的有效性。利用步骤如下：1. 确认目标存在Struts2上传接口；2. 修改exploit.py中的URL参数；3. 运行脚本上传shell.jsp；4. 通过脚本提供的交互式命令行执行OS指令。投毒风险分析：该POC代码目前表现为低风险。首先，Python脚本逻辑透明，仅使用了标准的requests和sys库，未发现混淆代码、Base64加密的恶意Payload或外部隐蔽通信逻辑。其核心功能是演示漏洞利用，而非在攻击者机器上执行恶意行为。其次，配套的shell.jsp代码极为精简，完全公开且功能单一，符合典型的POC验证需求，不包含任何自我隐藏或持久化后门。虽然该代码在攻击场景下极具威胁，但作为防御性研究工具，其代码本身不具备针对研究员环境的投毒特征。然而，考虑到此类高价值漏洞的关注度，防御者在下载类似仓库时仍需警惕那些包含编译好的二进制文件、混淆混淆的依赖库或带有'自动配置环境'脚本的项目，以防被植入窃取凭据或远控木马。当前POC为纯文本形式，审计成本低，安全性在可控范围内。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2024-53677-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2024-53677-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)
