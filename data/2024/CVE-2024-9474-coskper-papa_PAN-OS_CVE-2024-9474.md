# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md](../2024/CVE-2024-9474-coskper-papa_PAN-OS_CVE-2024-9474.md)

# CVE-2024-9474

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2024-9474-Chocapikk_CVE-2024-9474.md](../2024/CVE-2024-9474-Chocapikk_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面的暴露程度。若管理界面暴露于互联网，则风险较高。

**影响版本:** PAN-OS 10.1.0 < 10.1.14-h6, PAN-OS 10.2.0 < 10.2.12-h2, PAN-OS 11.0.0 < 11.0.6-h1, PAN-OS 11.1.0 < 11.1.5-h1, PAN-OS 11.2.0 < 11.2.4-h1

**利用条件:** 需要具备PAN-OS管理web界面的管理员权限，且管理界面可访问。互联网暴露的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞，该漏洞允许具有管理 Web 界面访问权限的 PAN-OS 管理员以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索结果，观察到该漏洞已被积极利用。提供的PoC代码（Go语言编写）看起来是一个利用此漏洞的工具。 该工具允许指定单个目标 URL 或从目标文件批量利用。PoC中存在一定的投毒风险。由于PoC工具代码简洁，主要功能是发送HTTP请求， 投毒风险在于攻击者可能修改PoC代码以在成功利用漏洞后执行恶意操作，例如植入后门或执行其他恶意命令。但直接在现有代码中添加恶意逻辑较为困难，需要较高水平的Go语言编程能力才能隐藏恶意代码。因此,投毒的可能性判断为10%。漏洞利用方式：攻击者首先需要获取PAN-OS管理Web界面的管理员权限。 然后，利用该漏洞执行OS命令注入，从而以root权限在防火墙上执行任意命令。建议缓解措施是限制对管理界面的访问，仅允许来自受信任内部IP地址的访问。

**项目地址:** [Chocapikk/CVE-2024-9474](https://github.com/Chocapikk/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #2

**来源**: [CVE-2024-9474-aratane_CVE-2024-9474.md](../2024/CVE-2024-9474-aratane_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** PAN-OS 10.1.0, 10.2.0, 11.0.0, 11.1.0, 11.2.0 受影响，小于各自修复版本号（10.1.14-h6, 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1）

**利用条件:** 需要PAN-OS管理员权限，且管理界面可访问，特别是暴露在互联网上的管理界面风险最高。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述和搜索结果，该漏洞是由于操作系统命令注入导致的，CVSS评分较高，表明其严重性。Palo Alto Networks 已经观察到针对暴露在互联网上的管理Web界面的攻击活动。

**POC代码分析：**

提供的POC代码（github.com/aratane/CVE-2024-9474）是一个Go编写的工具，包含扫描模式和利用模式。
*   **扫描模式:** 用于批量扫描URL列表，检测是否存在该漏洞。
*   **利用模式:**  用于交互式地利用单个存在漏洞的URL，允许攻击者执行任意命令。该脚本支持多线程扫描，并能将结果保存到文件中。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被积极利用，且存在公开的POC代码，因此该POC代码具有较高的有效性。

**投毒风险评估：**

分析提供的POC代码文件（README.md, go.mod, go.sum）：
*   **README.md:** 描述了工具的使用方法和功能，未发现可疑代码。
*   **go.mod 和 go.sum:**  定义了项目依赖，未发现异常依赖项。
*   **main.go (未提供):** 漏洞的核心代码，由于缺少此文件，无法进行详细的代码审计。

在没有`main.go`源码的情况下，无法完整评估投毒风险。但根据现有的文件，投毒风险较低，约为10%。由于利用代码需要管理员权限，因此，即便存在后门，也需要先成功利用漏洞才能触发。攻击者可能在`main.go`中加入恶意代码，例如植入webshell或反弹shell，实现持久化控制。

**利用方式：**

1.  **身份验证：**  攻击者需要具有PAN-OS管理员的凭据，并能访问管理Web界面。
2.  **漏洞触发：**  通过构造恶意的HTTP请求，利用Web管理界面中存在的操作系统命令注入漏洞。
3.  **命令执行：**  成功利用漏洞后，攻击者可以在PAN-OS设备上以root权限执行任意命令。
4.  **权限维持：**  攻击者可以通过植入后门或添加新的管理员账户等方式，实现对设备的长期控制。

**缓解措施：**

*   及时更新PAN-OS版本到修复版本。
*   限制管理Web界面的访问，仅允许来自可信内部IP地址的访问。
*   遵循Palo Alto Networks的最佳实践指南，加固管理界面的安全性。

**项目地址:** [aratane/CVE-2024-9474](https://github.com/aratane/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #3

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #4

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---



---

## POC #4

**来源**: [CVE-2024-9474-deathvu_CVE-2024-9474.md](../2024/CVE-2024-9474-deathvu_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 高危，允许具有Web管理界面访问权限的PAN-OS管理员以root权限执行操作

**影响版本:** 10.1.0 to 10.1.14-h5, 10.2.0 to 10.2.12-h1, 11.0.0 to 11.0.6-h0, 11.1.0 to 11.1.5-h0, 11.2.0 to 11.2.4-h0

**利用条件:** 需要PAN-OS管理员访问Web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞。该漏洞允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。根据漏洞描述，该漏洞是由于PAN-OS软件未能正确验证管理员的权限，从而允许攻击者利用该漏洞获取root权限。\n\n**有效性评估：**\n\n根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的利用代码。提供的POC代码（cve.py）利用了未经身份验证的访问漏洞，结合命令注入，可以执行任意命令。\n\n**投毒风险评估：**\n\n审查提供的POC代码，发现以下几点：\n\n*   **依赖性：** 该脚本依赖于Python3标准库以及`requests`库。标准库通常是安全的，`requests`库是一个常用的HTTP客户端库，被广泛使用。\n*   **代码逻辑：** 代码的总体逻辑是合理的，用于发送HTTP请求，利用漏洞。\n*   **输出：** 脚本会将结果输出到文件 (`output.txt`)，但这种行为本身不是恶意。\n*   **Webshell/后门：**  脚本本身并没有明显植入webshell或者持久性后门的行为。它通过命令注入执行命令并将结果写到`/var/appweb/htdocs/unauth/{output_name}`， 攻击者可以通过访问该URL获取命令执行结果。这是一个漏洞验证的手段，不应该被认为是投毒。\n\n虽然整体代码看起来没有明显的投毒行为，但依然存在一定风险：\n\n*   **恶意URL：**  攻击者可以修改脚本，将目标URL替换为恶意的URL，诱导用户执行。\n*   **依赖库风险：** `requests` 库本身若存在漏洞，或者被恶意篡改，也会间接影响此脚本的安全性。\n*   **命令注入风险：** 攻击者可能滥用命令注入，在目标系统执行恶意操作。\n\n综合评估，投毒风险较低，约为5%。主要风险在于使用者滥用漏洞本身，以及对第三方库的潜在安全风险。\n\n**利用方式：**\n\n1.  **确定目标：** 攻击者需要确定运行受影响PAN-OS版本的Palo Alto Networks防火墙，并且其Web管理界面可以从攻击者的位置访问。尤其需要关注暴露在公网上的管理界面。\n2.  **身份验证绕过：**  利用`/php/ztp_gate.php/.js.map` 路径绕过身份验证检查。\n3.  **命令注入：**  通过构造包含恶意命令的`payload`参数，利用`/php/utils/createRemoteAppwebSession.php/peppa.js.map` 接口进行命令注入。\n4.  **执行命令：** 注入的命令以root权限执行。命令执行的结果被重定向到Web服务器的可访问目录`/var/appweb/htdocs/unauth/`。\n5.  **获取结果：** 攻击者可以通过访问特定的URL（例如，`{url}/unauth/{output_name}`）来检索命令执行的结果。\n6.  **交互式Shell：** 该POC允许通过输入命令与目标系统进行交互， 形成一个简单的交互式shell。


**项目地址:** [deathvu/CVE-2024-9474](https://github.com/deathvu/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #5

**来源**: [CVE-2024-9474-experiencedt_CVE-2024-9474.md](../2024/CVE-2024-9474-experiencedt_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web 管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升

**影响应用:** PAN-OS

**危害等级:** 中危/高危，取决于管理界面是否暴露于互联网。如果暴露，则风险更高，可能导致系统被完全控制。

**影响版本:** 10.1.0 < version < 10.1.14-h6, 10.2.0 < version < 10.2.12-h2, 11.0.0 < version < 11.0.6-h1, 11.1.0 < version < 11.1.5-h1, 11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员权限和访问Web管理界面，如果管理界面暴露在互联网上，攻击更容易实现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。该漏洞风险最高的情况是，管理界面允许来自互联网或任何不受信任网络的访问。该漏洞的利用方式是通过Web管理界面进行OS命令注入（CWE-78）。

POC代码分析:

*   `README.md`: 提供了POC工具的使用方法，包括单目标和批量模式。
*   `go.mod` 和 `go.sum`: 定义了Go模块的依赖项。
*   `main.go`: 包含漏洞利用的主要逻辑，用于向目标PAN-OS设备发送恶意请求，实现命令注入。

投毒风险评估:

该POC工具本身结构简单，仅包含漏洞验证的功能。但由于缺乏具体的 `main.go` 代码，无法准确判断是否存在恶意代码。从目前的信息来看，投毒风险较低，评估为 1%。尽管该漏洞本身需要管理员权限，但攻击者可能利用该漏洞进行横向渗透或持久化操作。

**项目地址:** [experiencedt/CVE-2024-9474](https://github.com/experiencedt/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #6

**来源**: [CVE-2024-9474-k4nfr3_CVE-2024-9474.md](../2024/CVE-2024-9474-k4nfr3_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.1.0 < version < 10.1.14-h6
10.2.0 < version < 10.2.12-h2
11.0.0 < version < 11.0.6-h1
11.1.0 < version < 11.1.5-h1
11.2.0 < version < 11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户访问Web管理界面，并且管理界面能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9474是Palo Alto Networks PAN-OS软件中的一个权限提升漏洞。 具有Web管理界面访问权限的PAN-OS管理员可以利用此漏洞以root权限在防火墙上执行操作。根据漏洞信息和搜索结果，该漏洞的利用涉及到向易受攻击的Web管理界面发送特制的HTTP请求，从而注入操作系统命令。提供的Python POC代码通过构造包含恶意命令的`user`参数的POST请求，将命令执行结果写入`/var/appweb/htdocs/unauth/1.php`，然后通过访问此PHP文件获取命令执行结果。

**有效性:**
根据CISA已将此漏洞添加到已知被利用漏洞目录 (KEV) 中，并且搜索结果表明该漏洞已被积极利用，POC代码的有效性较高。

**投毒风险:**
POC代码本身看起来比较直接，主要功能是发送POST请求并在服务器上执行命令。 投毒风险较低，估计在10%左右。风险主要来自于:
1.  **脚本逻辑复杂性:** 代码相对简单，直接执行命令，隐藏恶意行为的空间有限。
2.  **文件写入位置:** 命令执行结果写入`/var/appweb/htdocs/unauth/1.php`， 比较明显。
3.  **作者信誉:** 无法评估作者信誉，存在潜在风险，但从代码本身看，恶意行为不太明显。

**利用方式:**
1.  **前提条件:** 攻击者需要具有PAN-OS Web管理界面的管理员权限。
2.  **漏洞触发:** 攻击者使用POC代码构造包含恶意命令的HTTP POST请求，发送到目标PAN-OS设备的`/php/utils/createRemoteAppwebSession.php/1.js.map`端点。
3.  **命令执行:** PAN-OS设备解析POST请求中的`user`参数，由于存在命令注入漏洞，恶意命令被执行，其结果被写入`/var/appweb/htdocs/unauth/1.php`。
4.  **结果获取:** 攻击者通过访问`/unauth/1.php`页面，获取命令执行的结果。
5.  **权限提升:** 攻击者利用执行的命令，可以进行任意操作，从而获得设备的完全控制权。

**项目地址:** [k4nfr3/CVE-2024-9474](https://github.com/k4nfr3/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #7

**来源**: [CVE-2024-9474-stupidgossi_CVE-2024-9474.md](../2024/CVE-2024-9474-stupidgossi_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

## POC #8

**来源**: [CVE-2024-9474-worthytop_CVE-2024-9474.md](../2024/CVE-2024-9474-worthytop_CVE-2024-9474.md)

## CVE-2024-9474 PAN-OS Web Management Interface Privilege Escalation

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS 命令注入

**影响应用:** PAN-OS

**危害等级:** 高危，允许经过身份验证的管理员以 root 权限执行操作

**影响版本:** PAN-OS 版本 10.1.0 到 10.1.14-h6 之前, 10.2.0 到 10.2.12-h2 之前, 11.0.0 到 11.0.6-h1 之前, 11.1.0 到 11.1.5-h1 之前, 以及 11.2.0 到 11.2.4-h1 之前

**利用条件:** 需要 PAN-OS 管理员权限和对 Web 管理界面的网络访问。如果管理界面暴露在互联网上，风险更高。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-9474 是 Palo Alto Networks PAN-OS 软件中的一个权限提升漏洞。攻击者需要具备 PAN-OS 管理员访问 Web 管理界面的权限。成功利用此漏洞后，攻击者可以 root 权限在防火墙上执行操作。根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的漏洞利用代码 (Go 语言) 似乎可以用于利用此漏洞，通过命令行参数指定目标 URL（单个目标或目标列表）。

**有效性：**根据提供的漏洞库信息,搜索引擎信息,及POC代码,该漏洞可以被利用。

**投毒风险分析：**代码中存在一定的投毒风险。虽然核心功能是利用漏洞，但`main.go`文件中的`exec.Command`函数允许执行任意系统命令，这为恶意行为者注入恶意代码提供了可能。 尽管有执行命令的需求,但作者可以隐藏任何的后门代码。 但是大部分是正常的漏洞利用,整体投毒风险预估为 30%。

**利用方式：**
1.  **前提条件：** 攻击者必须具有有效的 PAN-OS 管理员帐户凭据。
2.  **访问 Web 管理界面：** 攻击者需要能够通过网络访问 PAN-OS 设备的 Web 管理界面。
3.  **利用漏洞：** 攻击者使用漏洞利用代码，通过 Web 管理界面发送特制的请求，利用 OS 命令注入漏洞执行任意命令。
4.  **权限提升：** 成功利用漏洞后，攻击者可以 root 权限在防火墙上执行操作，从而完全控制受影响的系统。

**项目地址:** [worthytop/CVE-2024-9474](https://github.com/worthytop/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)

---

